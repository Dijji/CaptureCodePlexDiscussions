<?xml version="1.0" encoding="utf-8"?>
<DiscussionSet xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <Discussions>
    <Discussion Title="Assign colors to chart bars with a series ...">
      <Posts>
        <Post From="pgatto" When="17/09/2017 11:33:17">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi everyone, I've been working with EPPLUS for a few weeks but I can not assign any colors I have chosen to the bars of a series-based graph (only one).
&lt;br&gt;
Thank you&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Access from PHP">
      <Posts>
        <Post From="felixvandal" When="12/09/2017 19:52:57">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello there &lt;br&gt;
i really really like epplus &lt;br&gt;
i like it so much that i want to use it for a project i have in PHP &lt;br&gt;
its a website to generate Bills of Material &lt;br&gt;
I was able to create Excel with a c# application but now the project have moved to the web
&lt;br&gt;
i would like to know if you have an idea how to use it with PHP &lt;br&gt;
i have been working 2 days on this :( &lt;br&gt;
anything can help thank you!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="felixvandal" When="13/09/2017 14:03:14">
          <Html>
        &lt;div class="markDownOutput "&gt;I am asking because i am not able to register the dll to my computer &lt;br&gt;
since i intend to use it with codeigniter i need to register epplus to the assembly of a computer
&lt;br&gt;
is it possible?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title=".NET Core support?">
      <Posts>
        <Post From="gaui" When="19/08/2017 01:57:58">
          <Html>
        &lt;div class="markDownOutput "&gt;I'm curious to know, is there some roadmap to supporting .NET Core?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="tsahiasher" When="06/09/2017 09:45:19">
          <Html>
        &lt;div class="markDownOutput "&gt;It looks like the development of this great library is stalled, so any development will be appreciated.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Taylorh140" When="06/09/2017 19:03:00">
          <Html>
        &lt;div class="markDownOutput "&gt;I did see this project. &lt;br&gt;
&lt;br&gt;
&lt;a href="https://github.com/VahidN/EPPlus.Core" rel="nofollow"&gt;https://github.com/VahidN/EPPlus.Core&lt;/a&gt;
&lt;br&gt;
&lt;br&gt;
Maybe it is what you are looking for, I hope the move to github happens soon, it is much easier to participate.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="09/09/2017 21:54:11">
          <Html>
        &lt;div class="markDownOutput "&gt;It has not stalled, but we are in the midst of moving from codeplex to github, so nothing more will happen in this repo. During the fall we will launch a beta with support for .NET Core, stable version will probably await Microsoft releasing System.Drawing
 in .NET Core. See &lt;a href="https://github.com/JanKallman/EPPlus" rel="nofollow"&gt;
https://github.com/JanKallman/EPPlus&lt;/a&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Error throws while loading excel workbook using epplus if excel contains picture and empty row before the content">
      <Posts>
        <Post From="meygnanam" When="06/09/2017 06:22:00">
          <Html>
        &lt;div class="markDownOutput "&gt;We are tying to read excel using EPPLUS. In this scenario, if the excel in a format like image in a first row and second row as empty and from third row main content it throws error wile loading workbook.
&lt;br&gt;
&lt;br&gt;
If image is not there then error is not throwing even if we have an empty row in the workbook.
&lt;br&gt;
&lt;br&gt;
Suggest any options please&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="EPplus, Create Dependent Dropdownlist using C#">
      <Posts>
        <Post From="abhichaturvedi" When="28/08/2017 13:18:55">
          <Html>
        &lt;div class="markDownOutput "&gt;I'm working on MVC web app, I want to create new excel sheet with two drop down lists filled with data from a database. I want the second drop down list to be dependent on selection change of the first one. I already create a file and fill drop down list
 but I can't find a way to make them dependent. Any clue how to do this?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Save generated file but not open it">
      <Posts>
        <Post From="psilva83" When="25/08/2017 15:28:10">
          <Html>
        &lt;div class="markDownOutput "&gt;this was a silly question lol &lt;br&gt;
&lt;br&gt;
Thanks!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Opening spreadsheets Fail After 100 opens">
      <Posts>
        <Post From="DrPepper808" When="23/08/2017 21:21:28">
          <Html>
        &lt;div class="markDownOutput "&gt;After I open/edit/close about 100 spreadsheets My Class Stalls at &lt;br&gt;
ExcelWorkbook Workbook = package.Workbook; &lt;br&gt;
&lt;br&gt;
I am not sure why, plenty of cpu and memory, &lt;br&gt;
I get a ContextSwitchDeadlock while debugging. &lt;br&gt;
Any Ideas? &lt;br&gt;
&lt;br&gt;
Example Code&lt;br&gt;
&lt;pre&gt;&lt;code&gt;            FileStream file = new FileStream(NewFileName, FileMode.Create, FileAccess.Write);
            FileInfo SpreadSheetFileInfo = new FileInfo(SpreadSheetFile.Key.ToString());
            ExcelPackage package = new ExcelPackage(SpreadSheetFileInfo);
            ExcelWorkbook Workbook = package.Workbook;
            ExcelWorksheets Worksheets = package.Workbook.Worksheets;
            foreach (ExcelWorksheet Worksheet in Worksheets)
            {
                 //edit
            }
            package.SaveAs(file);
            file.Close();
            file.Dispose();
            Workbook.Dispose();
            Worksheets.Dispose();
            package.Dispose();





&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Functionalities missing for Chart">
      <Posts>
        <Post From="saurabhrajguru" When="11/08/2017 11:11:42">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello, &lt;br&gt;
&lt;br&gt;
I am creating scatter chart using epplus however i am not able to do following in it&lt;br&gt;
&lt;ul&gt;
&lt;li&gt;Add shadow to the chart &lt;/li&gt;&lt;li&gt;Align/Text-Direction/Angle specific Axis like Custom Angle for Y Axis &lt;/li&gt;&lt;li&gt;Add Custom data label &lt;/li&gt;&lt;li&gt;Add Border to data label &lt;/li&gt;&lt;li&gt;Add Shadow to data label&lt;br&gt;
&lt;/li&gt;&lt;/ul&gt;
Is there any way to do that via epplus ?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Create custom conditionnal formating - C#">
      <Posts>
        <Post From="Valentin92" When="07/08/2017 15:59:57">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi everybody ! &lt;br&gt;
&lt;br&gt;
I'm using Epplus and I have a question : I know in Excel is possible to create conditionnal formating ("CF"), but I don't find how to do this using Epplus library in C#, and apply it to cells.
&lt;br&gt;
I found some topics on web but nothing is relevant, because I want to create a custom CF with mixed default CF.
&lt;br&gt;
&lt;br&gt;
I attached pictures to show you what I want to do. The CF are directly created from Excel.
&lt;br&gt;
&lt;br&gt;
I hope any body can help me :) ! &lt;br&gt;
&lt;br&gt;
Thank you ! &lt;br&gt;
&lt;br&gt;
&lt;img alt="Image" src="https://img4.hostingpics.net/pics/724038one.jpg"&gt; &lt;br&gt;
&lt;img alt="Image" src="https://img4.hostingpics.net/pics/177456two.jpg"&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Valentin92" When="10/08/2017 07:49:48">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello, &lt;br&gt;
&lt;br&gt;
I found a solution which working fine for me. It is specific for me :&lt;br&gt;
&lt;pre&gt;&lt;code&gt;/// &amp;lt;summary&amp;gt;
        /// Permet d'appliquer la mise en forme conditionnelle (MeFC) pour une ou plusieurs cellule(s).
        /// &amp;lt;/summary&amp;gt;
        /// &amp;lt;param name="xlWorksheet"&amp;gt;Feuille dans laquelle appliquer la MeFC&amp;lt;/param&amp;gt;
        /// &amp;lt;param name="adresse"&amp;gt;Paramètre falcutatif précisant l'adresse d'une cellule en particulier.&amp;lt;/param&amp;gt;
        private static void AppliquerMiseEnFormeConditionnelleTableaux(ExcelWorksheet xlWorksheet, string adresse = "")
        {
            //Liste des cellules à mettre en forme
            List&amp;lt;ExcelRangeBase&amp;gt; lstCells = new List&amp;lt;OfficeOpenXml.ExcelRangeBase&amp;gt;();

            if (adresse == "")
            {
                //Récupération de toutes les cellules avec le style préparé pour un MeFC
                lstCells = xlWorksheet.Cells.Where(c =&amp;gt; (c.StyleID == _dicoStyles.ElementAt(23).Value) || 
                                                        (c.StyleID == _dicoStyles.ElementAt(24).Value)).ToList();
            }
            else
                lstCells.Add(xlWorksheet.Cells[adresse]); //Récupère seulement la cellule spécifiée

            foreach (var cell in lstCells)
            {
                bool isTendance = (cell.StyleID == _dicoStyles.ElementAt(23).Value); //Condition Tendance (flèche) ou objectif
                ExcelAddress addressCell = new ExcelAddress(cell.Address);
                AppliquerFormulesFeuille(xlWorksheet, addressCell.Address);
                double valueCell = Convert.ToDouble(cell.Value); //Valeur après application de la formule

                if (valueCell &amp;gt; 0)
                {
                    if (isTendance)
                    {
                        // Qn-1 (-) Qn = (&amp;gt; 0) -&amp;gt; Flèche en or vers le bas

                        var v = xlWorksheet.ConditionalFormatting.AddFourIconSet(addressCell, eExcelconditionalFormatting4IconsSetType.Arrows);
                        v.Reverse = true;
                        v.Icon4.Type = eExcelConditionalFormattingValueObjectType.Num;
                        v.ShowValue = false;
                    }
                    else
                    {
                        // YtdPays - Objectif = (&amp;gt; 0) -&amp;gt; Pastille 'v' verte

                        var v = xlWorksheet.ConditionalFormatting.AddThreeIconSet(addressCell, eExcelconditionalFormatting3IconsSetType.Symbols);
                        v.Reverse = true;
                        v.Icon1.Type = eExcelConditionalFormattingValueObjectType.Num;
                        v.ShowValue = false;
                    }
                }
                else if (valueCell == 0)
                {
                    if (isTendance)
                    {
                        // Qn-1 (-) Qn = (= 0) -&amp;gt; Rond rose

                        var v = xlWorksheet.ConditionalFormatting.AddFourIconSet(addressCell, eExcelconditionalFormatting4IconsSetType.RedToBlack);
                        v.Icon4.Type = eExcelConditionalFormattingValueObjectType.Num;
                        v.ShowValue = false;
                    }
                    else
                    {
                        // YtdPays - Objectif = (= 0) -&amp;gt; Pastille vide orange

                        var v = xlWorksheet.ConditionalFormatting.AddThreeIconSet(addressCell, eExcelconditionalFormatting3IconsSetType.TrafficLights1);
                        v.Icon3.Type = eExcelConditionalFormattingValueObjectType.Num;
                        v.ShowValue = false;
                    }
                }
                else if (valueCell &amp;lt; 0)
                {
                    if (isTendance)
                    {
                        // Qn-1 (-) Qn = (&amp;lt; 0) -&amp;gt; flèche en gris vers le haut
                        var v = xlWorksheet.ConditionalFormatting.AddFourIconSet(addressCell, eExcelconditionalFormatting4IconsSetType.ArrowsGray);
                        v.Reverse = false;
                        v.Icon4.Type = eExcelConditionalFormattingValueObjectType.Num;
                        v.ShowValue = false;
                    }
                    else
                    {
                        // YtdPays - Objectif = (&amp;gt; 0) -&amp;gt; Pastille 'x' rouge

                        var v = xlWorksheet.ConditionalFormatting.AddThreeIconSet(addressCell, eExcelconditionalFormatting3IconsSetType.Symbols);
                        v.Reverse = false;
                        v.Icon1.Type = eExcelConditionalFormattingValueObjectType.Num;
                        v.ShowValue = false;
                    }
                }
            }
        }&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Scatter Series Chart Custom DataLabel">
      <Posts>
        <Post From="saurabhrajguru" When="09/08/2017 14:08:46">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello, &lt;br&gt;
&lt;br&gt;
I am trying to create a scatter chart with the custom data labels. &lt;br&gt;
I see epplus only allowing the few bool flags but no way to set my own label. &lt;br&gt;
&lt;br&gt;
The excel interop is able to do this by following code&lt;br&gt;
&lt;pre&gt;&lt;code&gt;Chart.SeriesCollection(sSeriesName).Points(nLabelPoint).DataLabel.Text = sLabelText;
&lt;/code&gt;&lt;/pre&gt;
Is there any way i could do this using epplus ? &lt;br&gt;
Can anyone show me the correct path to do this ? &lt;br&gt;
&lt;br&gt;
Thanks&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="[Sample] Adding Conditional Formatting">
      <Posts>
        <Post From="SirG69" When="12/03/2012 03:52:02">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;hope this sample will help you to add&amp;nbsp;&lt;span style="color: rgb(0, 0, 255);"&gt;&lt;strong&gt;Conditional Formatting&lt;/strong&gt;&lt;/span&gt; to a Worksheet.&lt;/p&gt;
&lt;p&gt;There are many types of possible Conditional Formatting. I chose the "Color Scale" as an example.&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;using&lt;/span&gt; System;
&lt;span style="color: blue;"&gt;using&lt;/span&gt; System.Collections.Generic;
&lt;span style="color: blue;"&gt;using&lt;/span&gt; System.Text;
&lt;span style="color: blue;"&gt;using&lt;/span&gt; System.IO;
&lt;span style="color: blue;"&gt;using&lt;/span&gt; System.Xml;
&lt;span style="color: blue;"&gt;using&lt;/span&gt; OfficeOpenXml;

&lt;span style="color: blue;"&gt;namespace&lt;/span&gt; EPPlus
{
  &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;class&lt;/span&gt; Class1
  {
    &lt;span style="color: gray;"&gt;///&lt;/span&gt; &lt;span style="color: gray;"&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
    &lt;span style="color: gray;"&gt;///&lt;/span&gt;&lt;span style="color: green;"&gt; Sample of adding Conditional Formatting to a EPPlus Worksheet.&lt;/span&gt;
    &lt;span style="color: gray;"&gt;///&lt;/span&gt; &lt;span style="color: gray;"&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
    &lt;span style="color: gray;"&gt;///&lt;/span&gt; &lt;span style="color: gray;"&gt;&amp;lt;param name="args"&amp;gt;&lt;/span&gt;&lt;span style="color: gray;"&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
    &lt;span style="color: blue;"&gt;static&lt;/span&gt; &lt;span style="color: blue;"&gt;void&lt;/span&gt; Main(&lt;span style="color: blue;"&gt;string&lt;/span&gt;[] args)
    {
      FileInfo newFile = &lt;span style="color: blue;"&gt;new&lt;/span&gt; FileInfo(&lt;span style="color: rgb(163, 21, 21);"&gt;@"Conditional Formatting Sample.xlsx"&lt;/span&gt;);

      &lt;span style="color: blue;"&gt;if&lt;/span&gt; (newFile.Exists)
      {
        newFile.Delete();  &lt;span style="color: green;"&gt;// ensures we create a new workbook&lt;/span&gt;
        newFile = &lt;span style="color: blue;"&gt;new&lt;/span&gt; FileInfo(&lt;span style="color: rgb(163, 21, 21);"&gt;@"Conditional Formatting Sample.xlsx"&lt;/span&gt;);
      }

      &lt;span style="color: blue;"&gt;using&lt;/span&gt; (ExcelPackage package = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(newFile))
      {
        ExcelWorksheet worksheet = package.Workbook.Worksheets.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"Conditional Formatting"&lt;/span&gt;);

        &lt;span style="color: green;"&gt;// Fill the first 10 lines of the first column with sequencial numbers&lt;/span&gt;
        &lt;span style="color: blue;"&gt;for&lt;/span&gt; (&lt;span style="color: blue;"&gt;int&lt;/span&gt; i = 1; i &amp;lt;= 10; i++)
        {
          worksheet.Cells[i, 1].Value = i;
        }

        &lt;span style="color: green;"&gt;// Add Conditional Formatting for the cells we just filled&lt;/span&gt;
        AddConditionalFormatting(
          worksheet,
          &lt;span style="color: rgb(163, 21, 21);"&gt;"A1:A10"&lt;/span&gt;,
          &lt;span style="color: rgb(163, 21, 21);"&gt;"FFF8696B"&lt;/span&gt;,
          &lt;span style="color: rgb(163, 21, 21);"&gt;"FF63BE7B"&lt;/span&gt;);

        &lt;span style="color: green;"&gt;// Save the Excel Workbook&lt;/span&gt;
        package.Save();
      }
    }

    &lt;span style="color: gray;"&gt;///&lt;/span&gt; &lt;span style="color: gray;"&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
    &lt;span style="color: gray;"&gt;///&lt;/span&gt;&lt;span style="color: green;"&gt; Add Conditional Formatting to an EPPlus Worksheet, using the "colorScale" formatting option.&lt;/span&gt;
    &lt;span style="color: gray;"&gt;///&lt;/span&gt; &lt;span style="color: gray;"&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
    &lt;span style="color: gray;"&gt;///&lt;/span&gt; &lt;span style="color: gray;"&gt;&amp;lt;param name="inWorksheet"&amp;gt;&lt;/span&gt;&lt;span style="color: green;"&gt;EPPlus Worksheet object&amp;lt;/param&amp;gt;&lt;/span&gt;
    &lt;span style="color: gray;"&gt;///&lt;/span&gt; &lt;span style="color: gray;"&gt;&amp;lt;param name="inSqref"&amp;gt;&lt;/span&gt;&lt;span style="color: green;"&gt;Range of cells to format&amp;lt;/param&amp;gt;&lt;/span&gt;
    &lt;span style="color: gray;"&gt;///&lt;/span&gt; &lt;span style="color: gray;"&gt;&amp;lt;param name="inColor1"&amp;gt;&lt;/span&gt;&lt;span style="color: green;"&gt;From Color&amp;lt;/param&amp;gt;&lt;/span&gt;
    &lt;span style="color: gray;"&gt;///&lt;/span&gt; &lt;span style="color: gray;"&gt;&amp;lt;param name="inColor2"&amp;gt;&lt;/span&gt;&lt;span style="color: green;"&gt;To Color&amp;lt;/param&amp;gt;&lt;/span&gt;
    &lt;span style="color: blue;"&gt;static&lt;/span&gt; &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;void&lt;/span&gt; AddConditionalFormatting(
      ExcelWorksheet inWorksheet,
      &lt;span style="color: blue;"&gt;string&lt;/span&gt; inSqref,
      &lt;span style="color: blue;"&gt;string&lt;/span&gt; inColor1,
      &lt;span style="color: blue;"&gt;string&lt;/span&gt; inColor2)
    {
      &lt;span style="color: green;"&gt;// Example of a XML used to format A1:A10 cells, with a Color Scale:&lt;/span&gt;
      &lt;span style="color: green;"&gt;//&lt;/span&gt;
      &lt;span style="color: green;"&gt;//  &amp;lt;conditionalFormatting sqref="A1:A10"&amp;gt;&lt;/span&gt;
      &lt;span style="color: green;"&gt;//    &amp;lt;cfRule type="colorScale" priority="1"&amp;gt;&lt;/span&gt;
      &lt;span style="color: green;"&gt;//      &amp;lt;colorScale&amp;gt;&lt;/span&gt;
      &lt;span style="color: green;"&gt;//        &amp;lt;cfvo type="min"/&amp;gt;&lt;/span&gt;
      &lt;span style="color: green;"&gt;//        &amp;lt;cfvo type="max"/&amp;gt;&lt;/span&gt;
      &lt;span style="color: green;"&gt;//        &amp;lt;color rgb="FFF8696B"/&amp;gt;&lt;/span&gt;
      &lt;span style="color: green;"&gt;//        &amp;lt;color rgb="FF63BE7B"/&amp;gt;&lt;/span&gt;
      &lt;span style="color: green;"&gt;//      &amp;lt;/colorScale&amp;gt;&lt;/span&gt;
      &lt;span style="color: green;"&gt;//    &amp;lt;/cfRule&amp;gt;&lt;/span&gt;
      &lt;span style="color: green;"&gt;//  &amp;lt;/conditionalFormatting&amp;gt;&lt;/span&gt;

      &lt;span style="color: green;"&gt;// The WorksheetXml&lt;/span&gt;
      XmlDocument xmlDoc = inWorksheet.WorksheetXml;

      &lt;span style="color: green;"&gt;// Root element of the WorksheetXml&lt;/span&gt;
      XmlElement root = xmlDoc.DocumentElement;

      &lt;span style="color: green;"&gt;// Generic element&lt;/span&gt;
      XmlElement xmlElement;

      &lt;span style="color: green;"&gt;// -----------------------------------------&lt;/span&gt;
      &lt;span style="color: green;"&gt;// &amp;lt;conditionalFormatting sqref="A1:A10"&amp;gt;&lt;/span&gt;
      &lt;span style="color: green;"&gt;// -----------------------------------------&lt;/span&gt;
      XmlElement eleConditionalFormatting = xmlDoc.CreateElement(&lt;span style="color: rgb(163, 21, 21);"&gt;"conditionalFormatting"&lt;/span&gt;, root.NamespaceURI);
      AddAttribute(eleConditionalFormatting, &lt;span style="color: rgb(163, 21, 21);"&gt;"sqref"&lt;/span&gt;, inSqref);

      &lt;span style="color: green;"&gt;// -----------------------------------------&lt;/span&gt;
      &lt;span style="color: green;"&gt;// &amp;lt;cfRule type="colorScale" priority="1"&amp;gt;&lt;/span&gt;
      &lt;span style="color: green;"&gt;// -----------------------------------------&lt;/span&gt;
      XmlElement eleCfRule = xmlDoc.CreateElement(&lt;span style="color: rgb(163, 21, 21);"&gt;"cfRule"&lt;/span&gt;, root.NamespaceURI);
      AddAttribute(eleCfRule, &lt;span style="color: rgb(163, 21, 21);"&gt;"type"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"colorScale"&lt;/span&gt;);
      AddAttribute(eleCfRule, &lt;span style="color: rgb(163, 21, 21);"&gt;"priority"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"1"&lt;/span&gt;);

      &lt;span style="color: green;"&gt;// -----------------------------------------&lt;/span&gt;
      &lt;span style="color: green;"&gt;// &amp;lt;colorScale&amp;gt;&lt;/span&gt;
      &lt;span style="color: green;"&gt;// -----------------------------------------&lt;/span&gt;
      XmlElement eleColorScale = xmlDoc.CreateElement(&lt;span style="color: rgb(163, 21, 21);"&gt;"colorScale"&lt;/span&gt;, root.NamespaceURI);

      &lt;span style="color: green;"&gt;// -----------------------------------------&lt;/span&gt;
      &lt;span style="color: green;"&gt;// &amp;lt;cfvo type="min"/&amp;gt;&lt;/span&gt;
      &lt;span style="color: green;"&gt;// -----------------------------------------&lt;/span&gt;
      xmlElement = xmlDoc.CreateElement(&lt;span style="color: rgb(163, 21, 21);"&gt;"cfvo"&lt;/span&gt;, root.NamespaceURI);
      AddAttribute(xmlElement, &lt;span style="color: rgb(163, 21, 21);"&gt;"type"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"min"&lt;/span&gt;);
      eleColorScale.AppendChild(xmlElement);

      &lt;span style="color: green;"&gt;// -----------------------------------------&lt;/span&gt;
      &lt;span style="color: green;"&gt;// &amp;lt;cfvo type="max"/&amp;gt;&lt;/span&gt;
      &lt;span style="color: green;"&gt;// -----------------------------------------&lt;/span&gt;
      xmlElement = xmlDoc.CreateElement(&lt;span style="color: rgb(163, 21, 21);"&gt;"cfvo"&lt;/span&gt;, root.NamespaceURI);
      AddAttribute(xmlElement, &lt;span style="color: rgb(163, 21, 21);"&gt;"type"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"max"&lt;/span&gt;);
      eleColorScale.AppendChild(xmlElement);

      &lt;span style="color: green;"&gt;// -----------------------------------------&lt;/span&gt;
      &lt;span style="color: green;"&gt;// &amp;lt;color rgb="FFF8696B"/&amp;gt;&lt;/span&gt;
      &lt;span style="color: green;"&gt;// -----------------------------------------&lt;/span&gt;
      xmlElement = xmlDoc.CreateElement(&lt;span style="color: rgb(163, 21, 21);"&gt;"color"&lt;/span&gt;, root.NamespaceURI);
      AddAttribute(xmlElement, &lt;span style="color: rgb(163, 21, 21);"&gt;"rgb"&lt;/span&gt;, inColor1);
      eleColorScale.AppendChild(xmlElement);

      &lt;span style="color: green;"&gt;// -----------------------------------------&lt;/span&gt;
      &lt;span style="color: green;"&gt;// &amp;lt;color rgb="FF63BE7B"/&amp;gt;&lt;/span&gt;
      &lt;span style="color: green;"&gt;// -----------------------------------------&lt;/span&gt;
      xmlElement = xmlDoc.CreateElement(&lt;span style="color: rgb(163, 21, 21);"&gt;"color"&lt;/span&gt;, root.NamespaceURI);
      AddAttribute(xmlElement, &lt;span style="color: rgb(163, 21, 21);"&gt;"rgb"&lt;/span&gt;, inColor2);
      eleColorScale.AppendChild(xmlElement);

      &lt;span style="color: green;"&gt;// -----------------------------------------&lt;/span&gt;
      &lt;span style="color: green;"&gt;// &amp;lt;/colorScale&amp;gt;&lt;/span&gt;
      &lt;span style="color: green;"&gt;// -----------------------------------------&lt;/span&gt;
      eleCfRule.AppendChild(eleColorScale);

      &lt;span style="color: green;"&gt;// -----------------------------------------&lt;/span&gt;
      &lt;span style="color: green;"&gt;// &amp;lt;/cfRule&amp;gt;&lt;/span&gt;
      &lt;span style="color: green;"&gt;// -----------------------------------------&lt;/span&gt;
      eleConditionalFormatting.AppendChild(eleCfRule);

      &lt;span style="color: green;"&gt;// -----------------------------------------&lt;/span&gt;
      &lt;span style="color: green;"&gt;// &amp;lt;/conditionalFormatting&amp;gt;&lt;/span&gt;
      &lt;span style="color: green;"&gt;// -----------------------------------------&lt;/span&gt;
      root.InsertAfter(eleConditionalFormatting, root.LastChild);
    }

    &lt;span style="color: gray;"&gt;///&lt;/span&gt; &lt;span style="color: gray;"&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
    &lt;span style="color: gray;"&gt;///&lt;/span&gt;&lt;span style="color: green;"&gt; Add an attribute to a XML Element.&lt;/span&gt;
    &lt;span style="color: gray;"&gt;///&lt;/span&gt; &lt;span style="color: gray;"&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
    &lt;span style="color: gray;"&gt;///&lt;/span&gt; &lt;span style="color: gray;"&gt;&amp;lt;param name="inXmlElement"&amp;gt;&lt;/span&gt;&lt;span style="color: green;"&gt;XML Element to add the attribute to&amp;lt;/param&amp;gt;&lt;/span&gt;
    &lt;span style="color: gray;"&gt;///&lt;/span&gt; &lt;span style="color: gray;"&gt;&amp;lt;param name="inAttributeName"&amp;gt;&lt;/span&gt;&lt;span style="color: green;"&gt;Attribute name&amp;lt;/param&amp;gt;&lt;/span&gt;
    &lt;span style="color: gray;"&gt;///&lt;/span&gt; &lt;span style="color: gray;"&gt;&amp;lt;param name="inAttributeValue"&amp;gt;&lt;/span&gt;&lt;span style="color: green;"&gt;Attribute value&amp;lt;/param&amp;gt;&lt;/span&gt;
    &lt;span style="color: blue;"&gt;static&lt;/span&gt; &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;void&lt;/span&gt; AddAttribute(
      XmlElement inXmlElement,
      &lt;span style="color: blue;"&gt;string&lt;/span&gt; inAttributeName,
      &lt;span style="color: blue;"&gt;string&lt;/span&gt; inAttributeValue)
    {
      XmlAttribute xmlAttribute = inXmlElement.OwnerDocument.CreateAttribute(inAttributeName);
      xmlAttribute.Value = inAttributeValue;
      inXmlElement.SetAttributeNode(xmlAttribute);
    }
  }
}
&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="15/03/2012 21:39:59">
          <Html>
        
&lt;p&gt;Thanks!&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="pranay9th" When="01/06/2012 08:35:18">
          <Html>
        
&lt;p&gt;Hi All,&lt;/p&gt;
&lt;p&gt;I am just stuck on one issue.&lt;/p&gt;
&lt;p&gt;I am having a Pivot Table which is having &amp;nbsp;5 rows with 2 value columns. (e.g. value1 and value2)&lt;/p&gt;
&lt;p&gt;And my need is to color&amp;nbsp;&lt;strong&gt;RED&lt;/strong&gt;&amp;nbsp;all those cells of value1 column which is having corresponding value2 column value less then 50.&lt;/p&gt;
&lt;p&gt;e.g.:&lt;/p&gt;
&lt;table align="left" border="2" cellspacing="1" cellpadding="1"&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Value1&lt;/td&gt;
&lt;td&gt;Value2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td bgcolor="#ff0000"&gt;100&lt;span&gt; &lt;/span&gt;&lt;/td&gt;
&lt;td&gt;20&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;100&lt;/td&gt;
&lt;td&gt;70&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;span&gt;&lt;br&gt;
&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I know that I need to apply a conditional formatting for this. But no idea how to do.&lt;/p&gt;
&lt;p&gt;If some one can help with sample code.&lt;/p&gt;
&lt;p&gt;Note: number of value columns will always be 2 but number of rows may differ.&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Pranay...&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Valentin92" When="09/08/2017 08:21:28">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello, &lt;br&gt;
&lt;br&gt;
I want to create a custom conditional formatting with an Icon set. I have posted my request
&lt;a href="https://www.codeplex.com/EPPlus/discussions/663564" rel="nofollow"&gt;here&lt;/a&gt;.
&lt;br&gt;
I don't know all of the Xml attributes, but you are using "color" attribute : do you know which attribute I need to change to apply my custom CF ?
&lt;br&gt;
&lt;br&gt;
Thank you !&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Conditional Formatting With Icons">
      <Posts>
        <Post From="mikeferrer" When="02/02/2015 17:25:44">
          <Html>
        &lt;div class="markDownOutput "&gt;I need to achieve something like this with Epplus. &lt;br&gt;
&lt;img alt="Image" src="http://i.imgur.com/L8kGO4c.png"&gt; &lt;br&gt;
Can someone guide me with the code I need to use.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Valentin92" When="09/08/2017 08:01:25">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
I want to do the same thing (&lt;a href="http://epplus.codeplex.com/discussions/663564" rel="nofollow"&gt;here&lt;/a&gt;), so I updating this post if anybody can help us.
&lt;br&gt;
&lt;br&gt;
Thank you !&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="epplus pie chart colors customization in excels">
      <Posts>
        <Post From="AshwiniMetasys" When="21/07/2017 15:18:12">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
I am using epplus library 4.1 to create excel file using vb.net. Trying to create pie chart in excel sheetbut i am not able to customize colors used in pie chart, can you please help me with that? Please give me code sample if possible.
&lt;br&gt;
&lt;br&gt;
Thanks, &lt;br&gt;
Ashwini &lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Out of Memory Exception">
      <Posts>
        <Post From="Tabish" When="23/10/2015 17:07:09">
          <Html>
        &lt;div class="markDownOutput "&gt;Started using this library. Was very happy with it &lt;br&gt;
Unfortunately didn't find it good with large data. &lt;br&gt;
&lt;br&gt;
Out of Memory Exception when trying to export nearly 70000 rows with nearly 50 columns . Columns size may vary . Maximum data that a column may have is 4000 characters and there are many like that.
&lt;br&gt;
&lt;br&gt;
Works like a charm for a smaller dataset say 5000 rows. &lt;br&gt;
&lt;br&gt;
Using EPPlus 4.0.4.0 &lt;br&gt;
&lt;br&gt;
Sample code: &lt;br&gt;
&lt;br&gt;
Using excelPackage As New ExcelPackage&lt;br&gt;
&lt;pre&gt;&lt;code&gt;                    Dim worksheet = excelPackage.Workbook.Worksheets.Add("Exported Search List")
                    worksheet.Cells("A1").LoadFromCollection(objList)

                    Dim fInfo As New FileInfo(XlsPathAndFilename)
                    excelPackage.SaveAs(fInfo)
&lt;/code&gt;&lt;/pre&gt;
End Using &lt;br&gt;
&lt;br&gt;
Any clue if i missed anything somewhere?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="brian1204" When="09/11/2015 17:01:55">
          <Html>
        &lt;div class="markDownOutput "&gt;I am also using this version, and have had the same issue. In a couple of other places I found reference to the 65k row limit and so changed my usage for just datasets of less that 64k rows.
&lt;br&gt;
That worked for that particular use, however I'm not getting (on a different data set of 9200 rows) the error 'Store must be open for this operation' which is apparently related to some IsolationStorage API issue...
&lt;br&gt;
I'm about to drop the use of EPPlus for anything over about 5000 rows... :( Can't have my users continuing to hit errors like this.
&lt;br&gt;
Anyone else have solutions to these issues?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Misiu" When="07/12/2015 08:41:12">
          <Html>
        &lt;div class="markDownOutput "&gt;@brian1204 I have exact same problem when saving large files. &lt;br&gt;
For now my temporary solution is to cut dataset into chunks 200000 rows and saving then into separate excel files.
&lt;br&gt;
&lt;br&gt;
You wrote that You are dropping use of EPPlus, are You using other library? Could You write it name? Ideally I would like to save 1 million records per file, but EPPlus can't handle that :(&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="coremanster" When="21/07/2017 01:23:03">
          <Html>
        &lt;div class="markDownOutput "&gt;I'm using EPPlus with Powershell. So my code will reflect this...&lt;br&gt;
&lt;br&gt;
I'm using "SqlCommand" module in Powershell (from SSMS 2016) to run SQL Server queries...
&lt;br&gt;
&lt;br&gt;
So. Here's the gist of what I'm doing in Powershell:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;###################&amp;lt;start&amp;gt;##########
$res = Invoke-SqlCmd ... -OutputAs DataTables
#$res is a System.Data.DataTable object

#$ws is setup already to $Excel, $wb, etc. 

### Load worksheet in a column x row fashion, from a DataTable object ###

foreach ($c in $res.columns)
{
  $cn = $c.Ordinal  #this is the column number, 0-based... 
  $rn = 1 #row number... the DataRow object doesn't have a row number property... 
  
  #load the header row:
    $ws.Cells[$rn, $cn].Value = $c.ColumnName

  foreach($r in $res.Rows) 
  {
    $ws.Cells[(++$rn), ($cn+1)].Value = $r[$cn]
  }
}
$ws.Cells.AutoFitColumns()

##--&amp;gt; save the workbook... 

###################&amp;lt;end&amp;gt;##########&lt;/code&gt;&lt;/pre&gt;
This is loading ~500K records in about a minute for me now. no out of memory errors, etc., whereas Cells[].LoadFromDataTable() was bogging down for me on a result set of only about 30K records.
&lt;br&gt;
&lt;br&gt;
It shouldn't be too hard to make it work for C#, VB.Net, etc.&lt;br&gt;
&lt;br&gt;
sorry, the + should be&lt;br&gt;
&lt;pre&gt;&lt;code&gt;+ &lt;/code&gt;&lt;/pre&gt;
chars&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Issue Excel found unreadable content">
      <Posts>
        <Post From="sreddy" When="17/08/2010 17:15:36">
          <Html>
        Excel found unreadable content in 'sample1.xlsx'. Do you want to recover the contents of this workbook. I've download the code of EPPlusWebSample and executed and it runs perfectly and i can download excel file, no message , but when wrote same kind of
 code in my application and gave reference to (EPPlus.dll 2.7.0.1) and run the application . Now i am getting below message when download excel file . Excel found unreadable content in 'sample1.xlsx'. Do you want to recover the contents of this workbook. below
 code i am using using System; using System.Collections; using System.Configuration; using System.Data; using System.Linq; using System.Web; using System.Web.Security; using System.Web.UI; using System.Web.UI.HtmlControls; using System.Web.UI.WebControls; using
 System.Web.UI.WebControls.WebParts; using System.Xml.Linq; using OfficeOpenXml; using System.IO; using OfficeOpenXml.Style; using System.Drawing; private void Sample1() { ExcelPackage pck = new ExcelPackage(); var ws = pck.Workbook.Worksheets.Add("Sample1");
 ws.Cells["A1"].Value = "Sample 1"; ws.Cells["A1"].Style.Font.Bold = true; var shape = ws.Drawings.AddShape("Shape1", eShapeStyle.Rect); shape.SetPosition(50, 200); shape.SetSize(200, 100); shape.Text = "Sample 1
 saves to the Response.OutputStream"; pck.SaveAs(Response.OutputStream); Response.ContentType = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"; Response.AddHeader("content-disposition", "attachment; filename=Sample1.xlsx");
 } What could be the issue, really appreciate your help Thanks In Advance reddy
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="17/08/2010 17:30:16">
          <Html>
        
&lt;p&gt;Call response.clear before send stream back to client.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Response.Clear();&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Response.AddHeader(&lt;span style="color: rgb(163, 21, 21);"&gt;"content-disposition"&lt;/span&gt;,
&lt;span style="color: rgb(163, 21, 21);"&gt;"attachment;&amp;nbsp; filename=file&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;.xlsx"&lt;/span&gt;);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Response.ContentType =
&lt;span style="color: rgb(163, 21, 21);"&gt;"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"&lt;/span&gt;;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Response.BinaryWrite(pck.GetAsByteArray());&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Response.End();&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="sreddy" When="17/08/2010 17:33:43">
          <Html>
        Thanks a lot, it works Really appreciate your quick response 
        
    </Html>
        </Post>
        <Post From="popgugu" When="13/10/2011 03:54:08">
          <Html>
        
&lt;p&gt;Confirmed. This works!!! Thanks.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="gbranchaud" When="01/02/2012 21:47:04">
          <Html>
        
&lt;p&gt;The clear/end pair of calls did the trick for me.&lt;/p&gt;
&lt;p&gt;It would be great if the web samples worked out of the box. I wasted time looking for the cause of that issue.&lt;/p&gt;
&lt;p&gt;Would it be possible to update the web samples so they properly handle the response?&lt;/p&gt;
&lt;p&gt;Thanks.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="d82krai" When="15/02/2012 18:43:39">
          <Html>
        
&lt;blockquote style="margin: 0.25em 1em 0px; padding: 0px 0.25em; border: 0.1em solid rgb(204, 204, 204); border-image: none; font-style: italic;"&gt;
&lt;strong&gt;mrxrsd wrote:&lt;/strong&gt;&lt;br&gt;
&lt;p&gt;Call response.clear before send stream back to client.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Response.Clear();&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Response.AddHeader(&lt;span style="color: rgb(163, 21, 21);"&gt;"content-disposition"&lt;/span&gt;,
&lt;span style="color: rgb(163, 21, 21);"&gt;"attachment;&amp;nbsp; filename=file&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;.xlsx"&lt;/span&gt;);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Response.ContentType =
&lt;span style="color: rgb(163, 21, 21);"&gt;"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"&lt;/span&gt;;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Response.BinaryWrite(pck.GetAsByteArray());&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Response.End();&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks mrxrsd, your code works fine in browser other than IE. I am using IE 8.0.&lt;/p&gt;
&lt;p&gt;I am populating pivot table through EPPlus. It works fine with other browser(Chrome, FF) but not working with IE.&lt;/p&gt;
&lt;p&gt;Seeking help on this.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="16/02/2012 14:33:27">
          <Html>
        
&lt;p&gt;Humm, strange, all my codes works fine in IE too. Maybe it is another problem, if you find out something, tell us here =)&lt;/p&gt;
&lt;p&gt;Did you try any code without pivot table ? &amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Audor27" When="30/05/2012 02:42:12">
          <Html>
        
&lt;p&gt;Im having the same problem, is there any alternative to clear/end?, Im currently unable to use Response.End() because of an updatePanel I have, and I can´t take this outside the updatePanel.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="30/05/2012 12:18:51">
          <Html>
        
&lt;p&gt;I didn´t understand your problem, What´s the relantionship between Response.End() and updatePanel ?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Audor27" When="30/05/2012 18:20:16">
          <Html>
        
&lt;p&gt;Thank you for your time.&lt;br&gt;
Im trying to export to excel from ms sql 2005 database, using a dataset with 2 dataTables in C# visual studio 2008&amp;nbsp;&lt;/p&gt;
&lt;p&gt;code snippet:&lt;span style="background-color: white;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="white-space: pre;"&gt;&amp;nbsp;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="white-space: pre;"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt; &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;static&lt;/span&gt; MemoryStream DataSetToXlsx(DataSet ds)
        {
           
                MemoryStream Result = &lt;span style="color: blue;"&gt;new&lt;/span&gt; MemoryStream();
                ExcelPackage pack = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage();

                &lt;span style="color: blue;"&gt;foreach&lt;/span&gt; (DataTable tbl &lt;span style="color: blue;"&gt;in&lt;/span&gt; ds.Tables)
                {
                    ExcelWorksheet ws = pack.Workbook.Worksheets.Add(tbl.TableName);
                    ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;].LoadFromDataTable(tbl, &lt;span style="color: blue;"&gt;true&lt;/span&gt;);
                }

 		pack.SaveAs(Result);
                &lt;span style="color: blue;"&gt;return&lt;/span&gt; Result;
      }
&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;&lt;/p&gt;
&lt;p&gt;finally...&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;Response.Clear();
                &lt;span style="color: green;"&gt;//ExcelStream is the result from the DataSetToXlsx method&lt;/span&gt;
				OnlineExportResultStatic.ExcelStream.WriteTo(Response.OutputStream);
                Response.ContentType = &lt;span style="color: rgb(163, 21, 21);"&gt;"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"&lt;/span&gt;;
                Response.AddHeader(&lt;span style="color: rgb(163, 21, 21);"&gt;"Content - Disposition"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"attachment;filename=dataSet.xlsx"&lt;/span&gt;);
                &lt;span style="color: green;"&gt;//Response.End();                &lt;/span&gt;
	HttpContext.Current.ApplicationInstance.CompleteRequest();
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;I don´t now if the response clear/end is the actual problem to my unreadable content issue but i can´t use Response.End due to some thread abort exception.Excel throws the unreadable content message, I choose "yes" recover information,
 diplays a message saying that something was repaired, nothing in specific:&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;&amp;lt;?&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;xml&lt;/span&gt; &lt;span style="color: red;"&gt;version&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;1.0&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: red;"&gt;encoding&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;UTF-8&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: red;"&gt;standalone&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;yes&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: blue;"&gt;?&amp;gt;&lt;/span&gt; 
&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;recoveryLog&lt;/span&gt; &lt;span style="color: red;"&gt;xmlns&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;http://schemas.openxmlformats.org/spreadsheetml/2006/main&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
  &lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;logFileName&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;error011720_01.xml&lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;logFileName&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt; 
  &lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;summary&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;Se han detectado errores en el archivo "C:\Documents and Settings\My Documents\dataSet.xlsx"&lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;summary&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt; 
&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;additionalInfo&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
  &lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;info&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;blabla spanish for: Excel completed some validation and repairing, someparts may have been excluded.&lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;info&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt; 
  &lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;additionalInfo&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
  &lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;recoveryLog&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;The result is 2 sheets with correct column name and values&lt;/p&gt;
&lt;p&gt;I am using this dll: EPPlus 3.0 Binaries&lt;/p&gt;
&lt;p&gt;I appreciate your help.&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="30/05/2012 18:31:37">
          <Html>
        
&lt;p&gt;Response.End() will raise a ThreadAbortException, wrap your code with try-catch block.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Audor27" When="30/05/2012 18:57:40">
          <Html>
        
&lt;p&gt;It works, thank you very much.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="nickcr" When="26/06/2012 03:13:17">
          <Html>
        
&lt;p&gt;I created an account with Codeplex just to say this worked - Thanks!!!&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Clyde1010" When="28/06/2012 17:21:34">
          <Html>
        
&lt;p&gt;I was running into this issue. &amp;nbsp;After inspecting the generated XLSX file, it appears an error message from my catch block was being appended to the XLSX file. &amp;nbsp;I solved the issue by ignoring ThreadAbortExceptions.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;try&lt;/span&gt;
{
    &lt;span style="color: blue;"&gt;byte&lt;/span&gt;[] reportData = GetReportData();
    Response.Clear();
    Response.AddHeader(&lt;span style="color: rgb(163, 21, 21);"&gt;"content-disposition"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"attachment;  filename="&lt;/span&gt; + reportTitle);
    Response.ContentType = &lt;span style="color: rgb(163, 21, 21);"&gt;"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"&lt;/span&gt;;
    Response.BinaryWrite(reportData);
    Response.End();

}
&lt;span style="color: blue;"&gt;catch&lt;/span&gt; (Exception ex)
{
    &lt;span style="color: blue;"&gt;if&lt;/span&gt; (!(ex &lt;span style="color: blue;"&gt;is&lt;/span&gt; System.Threading.ThreadAbortException))
    {
        &lt;span style="color: green;"&gt;//Other error handling code here&lt;/span&gt;
    }
}
&lt;/pre&gt;
&lt;/div&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="tudorb" When="06/09/2012 16:26:43">
          <Html>
        
&lt;p&gt;Clyde, you sorted me out.&lt;/p&gt;
&lt;p&gt;I was originally using "Response.End()" but was getting the "Thread was being aborted" error. So followed Microsoft advise and replaced it with "HttpContext.Current.ApplicationInstance.CompleteRequest()". This allowed me to create the Excel file but when
 opening the file it started throwing the error "Excel found unreadable content in...". The content of the Excel file was just basic table with a few columns and text in them. Nothing fancy. However using "Response.End()" with the ignorring of the ThreadAbortException
 solved all issues (for the moment ;) )&lt;/p&gt;
&lt;p&gt;Once again thanks,&lt;/p&gt;
&lt;p&gt;/t&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="pinna_hari" When="07/02/2013 06:02:36">
          <Html>
        &lt;div class="markDownOutput "&gt;Works like charm..!! thank you very much..!!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="NINiki" When="31/05/2013 11:26:12">
          <Html>
        &lt;div class="markDownOutput "&gt;In case someone else has the same problem... &lt;br&gt;
&lt;br&gt;
For me, the issue continued until I removed the output from within a Using statement, i.e.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;Using pck As New ExcelPackage
       'do lots of stuff to create package
       Response.Clear()
        Response.ContentType = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"
        Response.AddHeader("content-disposition", "attachment;  filename=ExcelDemo.xlsx")
        Response.BinaryWrite(pck.GetAsByteArray())
        Response.End()
End Using&lt;/code&gt;&lt;/pre&gt;
needs to be replaced with&lt;br&gt;
&lt;pre&gt;&lt;code&gt; Dim pck As New ExcelPackage
 'do lots of stuff to create package
 Response.Clear()
 Response.ContentType = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"
 Response.AddHeader("content-disposition", "attachment;  filename=ExcelDemo.xlsx")
 Response.BinaryWrite(pck.GetAsByteArray())
 Response.End()&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="akshaywalkhade" When="10/07/2013 09:50:37">
          <Html>
        &lt;div class="markDownOutput "&gt;&lt;strong&gt;mrxrsd wrote:&lt;/strong&gt;&lt;br&gt;
&lt;blockquote&gt;Call response.clear before send stream back to client. &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Response.Clear();&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
 Response.AddHeader("content-disposition", "attachment;&amp;nbsp; filename=file.xlsx");&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Response.ContentType = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
 &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Response.BinaryWrite(pck.GetAsByteArray());&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
 Response.End();&lt;br&gt;
&lt;/blockquote&gt;
Perfect... Thank you so much...&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="icoxfog417" When="13/09/2013 05:26:13">
          <Html>
        &lt;div class="markDownOutput "&gt;I also solved my problem!! Thank you. &lt;br&gt;
&lt;br&gt;
First , my code like below , it was not work ( downloaded excel is broken ).&lt;br&gt;
&lt;pre&gt;&lt;code&gt;Dim file As MemoryStream = New MemoryStream()
_pkg.SaveAs(file)
file.GetBuffer()&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="OlliRanta" When="21/08/2015 07:18:47">
          <Html>
        &lt;div class="markDownOutput "&gt;I had the same error from EPPlus based files for another reason: The format of a data grid view column was copied to ExcelPackage column like this:
&lt;br&gt;
sheet.Column(col).Style.Numberformat.Format = c.DefaultCellStyle.Format &lt;br&gt;
Format "N2" caused this error situation when opening the created file in Excel 2013. Instead the format "#,###.00" worked fine.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="saketh86" When="23/01/2016 16:01:19">
          <Html>
        &lt;div class="markDownOutput "&gt;Hey there, &lt;br&gt;
&lt;br&gt;
I'm facing the same problem - "Excel found unreadable content. Click Yes if you trust the source". When I click on yes, a pop-up window shows up saying "Removed Records: Table from xl/Tables/table1.xml part(Table)". But the contents in the
 excel are just fine. But I want to avoid this warning/message when my end-user opens it.
&lt;br&gt;
&lt;br&gt;
I'm using OfficeOpenXml dll of EPPlus in my c# code and i suspect this problem could be because of Merging few rows together:
&lt;br&gt;
&lt;br&gt;
My code looks something like this:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;var package = new ExcelPackage();
var worksheet = package.Workbook.Worksheets.Add("Sample Excel");
worksheet.Cells[1,1,2,1].Merge = true;
worksheet.Cells[1,1].Value = "Column1";
worksheet.Cells[1, 2, 2, 2].Merge = true;
worksheet.Cells[1,2].Value = "Column2";
worksheet.Cells[1,3].Value = "Column3Row1";
worksheet.Cells[2,3].Value = "Column3Row2";
 worksheet.Tables.Add(new ExcelAddressBase(1, 1, 2, 3), "Sample Excel");
worksheet.Tables[0].ShowFilter = false;                
this.Response.Clear();
this.Response.ContentType = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";
this.Response.AddHeader("content-disposition", "attachment;  filename=SampleExcel.xlsx");
this.Response.BinaryWrite(package.GetAsByteArray());
this.Response.End();
 this.Response.SuppressContent = true;&lt;/code&gt;&lt;/pre&gt;
I tried putting my actual data and dummy data like above. it failed in both the cases. And if I get rid of merging, it works fine
&lt;br&gt;
&lt;br&gt;
Any help is much appreciated. &lt;br&gt;
&lt;br&gt;
Regards, &lt;br&gt;
Saketh&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="royiouu91" When="26/01/2016 18:47:13">
          <Html>
        &lt;div class="markDownOutput "&gt;Thank you! Having this problem too, now it is fixed.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="PE" When="16/07/2017 13:54:59">
          <Html>
        &lt;div class="markDownOutput "&gt;After reading all proposed solutions, I found that using ExcelPackage.Save will garble the Excel output!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="axis reverse order">
      <Posts>
        <Post From="lulik" When="06/07/2017 10:08:42">
          <Html>
        &lt;div class="markDownOutput "&gt;I do an export in Excel and draw charts using Epplus:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;var chart = (ExcelChart)wksh.Drawings.AddChart("Chart", eChartType.Line);
chart.SetSize(500, 300);
chart.SetPosition(5, 800);
chart.Title.Text = "myChart";
chart.Series.Add(ExcelRange.GetAddress(2, 26, rowIndex, 26), ExcelRange.GetAddress(2, 25, rowIndex, 25));&lt;/code&gt;&lt;/pre&gt;
And get the chart from left to right by default: &lt;br&gt;
&lt;img alt="Image" src="https://i.stack.imgur.com/JNA8a.png"&gt; &lt;br&gt;
&lt;br&gt;
How do I get the chart from right to left?? &lt;br&gt;
&lt;img alt="Image" src="https://i.stack.imgur.com/zhBhu.png"&gt; &lt;br&gt;
&lt;br&gt;
For example, in excel in properties there is a parameter "categories in reverse order":
&lt;br&gt;
&lt;strong&gt;how it is done in the Epplus?&lt;/strong&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="EPPLUS : Is it possible to get calculated values from macro enabled excel file(.xlsm)??">
      <Posts>
        <Post From="vineetraikumar" When="06/05/2017 10:51:08">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
I am trying to get the calculated value of the particular cell which has not simple formula like this Cell C =(1+A1+B1), It has easily calculated to call Calculate(). But if cell has reference of another sheet in the place of simple fomula, this one not calculating,
 i am using Calculate() to calculate this but the result is 0. &lt;br&gt;
&lt;br&gt;
I have provided the excel which has lot's sheet. I need to care about only one MainSheet. In this sheet i need to put the value get the corresponding output. Some where cell has simple formula which is working fine , but somewhere cell has reference another
 worksheet this one getting problem for me. i am not getting exact result.. Please help me . Is there any solution ??&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="01/07/2017 20:47:37">
          <Html>
        &lt;div class="markDownOutput "&gt;The formula parser should be able to resolve references to other worksheets. Have a look at the documentation and see if the logging functionality can help you.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Move to GitHub?">
      <Posts>
        <Post From="gsbell" When="07/06/2017 21:17:26">
          <Html>
        &lt;div class="markDownOutput "&gt;With CodePlex shutdown, is EPPlus going to be moved to GitHub or elsewhere? &lt;br&gt;
&lt;br&gt;
Or what's the plan, man?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="r_beacroft" When="14/06/2017 11:17:53">
          <Html>
        &lt;div class="markDownOutput "&gt;I'm also interested to know the outcome from this...&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="sidecut" When="14/06/2017 15:41:15">
          <Html>
        &lt;div class="markDownOutput "&gt;If no action is taken by, say, November, someone should clone it and post it on Github, license permitting, of course.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mkonstantin" When="27/06/2017 23:44:23">
          <Html>
        &lt;div class="markDownOutput "&gt;gitlab.com is also one of the valid options. anynow have you guys figured out at least date (plus/minus a week or so) when the move is going to happen?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="01/07/2017 20:44:27">
          <Html>
        &lt;div class="markDownOutput "&gt;we have no date, but it will happen before codeplex disappears... we are currently evaluating how to handle the existing pullrequests here on codeplex. When this is done it will be a small thing to move EPPlus to github.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="ExcelRange/ ExcelRangeBase do really not contain an equals operator?">
      <Posts>
        <Post From="SeSpoon" When="21/06/2017 15:59:07">
          <Html>
        &lt;div class="markDownOutput "&gt;if so, should I add one?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="AutoFitColumns error: Not a legal OleAut date">
      <Posts>
        <Post From="jalbertomd15" When="12/06/2017 17:07:41">
          <Html>
        &lt;div class="markDownOutput "&gt;I am getting an error, the message is: "Not a legal OleAut date". &lt;br&gt;
&lt;br&gt;
I get this error when I call this function: Worksheet.Cells.AutoFitColumns(). &lt;br&gt;
&lt;br&gt;
I have some columns with values that are beign represented as date, when I comment the AutoFitColumns function I get the excel exported but with wrong values:
&lt;br&gt;
&lt;br&gt;
Original value Excel value &lt;br&gt;
1171-2 -266229 &lt;br&gt;
1.1 42736 &lt;br&gt;
1.2 42767 &lt;br&gt;
1.3 42795 &lt;br&gt;
2.1 42737 &lt;br&gt;
2.2 42768 &lt;br&gt;
&lt;br&gt;
I am trying to set format like this: &lt;br&gt;
&lt;br&gt;
Worksheet.Cells[row, column].Style.Numberformat.Format = "@" &lt;br&gt;
&lt;br&gt;
to process the value as text, but it is not working. &lt;br&gt;
&lt;br&gt;
How can I avoid values being represented as date?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Different datetime formats in columns">
      <Posts>
        <Post From="miramares" When="30/05/2017 17:32:38">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
In my export I have columns with datetime, string and decimal values. For every datetime column I defined "Style.Numberformat.Format" as date only "mm-dd-yy". But now I need for some columns date and time. So I changed format to "mm-dd-yy
 hh:mm:ss". But this not worked. In xlsx style is only first definition for date only. Is possible this somehow defined?
&lt;br&gt;
&lt;br&gt;
Thanks&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="EPPlus 4.1.0 Excel Unreadable content issue">
      <Posts>
        <Post From="AnandRB" When="25/05/2017 11:01:58">
          <Html>
        &lt;div class="markDownOutput "&gt;Basically i am building Dynamic Excel using EPPlus 4.1.0. The problem am facing is when i download the excel and click open. Its throwing error as "&lt;strong&gt;Excel found unreadable content in .xlsx. Do you want to recover the contents of this workbook&lt;/strong&gt;?
 If you trust the source of this workbook,click Yes" &lt;br&gt;
&lt;br&gt;
I am using below steps to generate excel : &lt;br&gt;
1.Creating new Excel Package -- ExcelPackage ex = new ExcelPackage() &lt;br&gt;
2.Creating new worksheet -- ExcelWorksheet ws = ex.Workbook.Worksheets.Add("Demo");
&lt;br&gt;
3.Working on that worksheet -- Content,alignment,coloring etc.. &lt;br&gt;
4.Saving the response&lt;br&gt;
&lt;pre&gt;&lt;code&gt;    ex.Save();
    Response.Clear();
    Response.ClearHeaders();
    Response.ContentType = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";
    Response.AddHeader("content-disposition", "attachment;  filename=ExcelDemo.xlsx");
    Response.BinaryWrite(ex.GetAsByteArray());
    Response.End();&lt;/code&gt;&lt;/pre&gt;
5.On click of Download, ill get options to save open etc. When i select Open,it throws the above error.
&lt;br&gt;
This error not happening in EPplus3. versions. But we need to use latest versions for building dynamic excel data with formatting in it.
&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="InsertRow, Copy worked not correct">
      <Posts>
        <Post From="evgnib123" When="20/05/2017 21:42:19">
          <Html>
        &lt;div class="markDownOutput "&gt;Why is this happening ?&lt;br&gt;
&lt;br&gt;
There is row pattern B2:F2&lt;br&gt;
&lt;br&gt;
Cell B2 = "Text"&lt;br&gt;
Cell C2 = "Text"&lt;br&gt;
Cell D2:E2 is merged = "Text"&lt;br&gt;
Cell F2 = "Text"&lt;br&gt;
&lt;br&gt;
If this is done without "method IinsertRow", it works correctly and the row template is copied as necessary (including merged cells )&lt;br&gt;
&lt;pre&gt;&lt;code&gt; using (ExcelPackage pkg = new ExcelPackage(new FileInfo(@"c:\input.xlsx")))
            {
                // correct work
                var ws = pkg.Workbook.Worksheets[1];
                var pattern = ws.Cells["B2:F2"];
                pattern.Copy(ws.Cells["B3:F3"]);
                pattern.Copy(ws.Cells["B4:F4"]);
                pattern.Copy(ws.Cells["B5:F5"]);
                pkg.SaveAs(new FileInfo(@"c:\output.xlsx"));
            }&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;            using (ExcelPackage pkg = new ExcelPackage(new FileInfo(@"c:\input.xlsx")))
            {
                // not correct work
                var ws = pkg.Workbook.Worksheets[1];
                // add three rows
                ws.InsertRow(2, 3);
                // go to pattern row after insert
                var pattern1 = ws.Cells["B5:F5"];
                // all is good here
                pattern1.Copy(ws.Cells["B2:F2"]);
                pattern1.Copy(ws.Cells["B3:F3"]); // Exception: Can't delete merged cells. A range is partly merged with the deleted range. D5:E5
                pkg.SaveAs(new FileInfo(@"c:\output.xlsx"));
            }&lt;/code&gt;&lt;/pre&gt;
In this case (below), merged cells correct copied only in row= 2. &lt;br&gt;
Why?&lt;br&gt;
&lt;pre&gt;&lt;code&gt; using (ExcelPackage pkg = new ExcelPackage(new FileInfo(@"c:\input.xlsx")))
            {
                var ws = pkg.Workbook.Worksheets[1];
                var startRow = 2;
                var rowCount = 5;
                ws.InsertRow(startRow, rowCount);
                var copyRow = startRow+rowCount;
                for (int i = 0; i &amp;lt; rowCount; i++)
                {
                    var row = startRow + i;
                    ws.Cells[copyRow, 2, copyRow, ws.Dimension.End.Column].Copy(ws.Cells[row, 2, row, ws.Dimension.End.Column]);
                    ws.Row(row).StyleID = ws.Row(copyRow).StyleID;
                }
                pkg.SaveAs(new FileInfo(@"c:\output.xlsx"));
            }&lt;/code&gt;&lt;/pre&gt;
What am I doing wrong ? &lt;br&gt;
I need to use the methods InsertRow and Copy together.&lt;br&gt;
&lt;br&gt;
ps. Used lastest EPPlus version via Nuget &lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="evgnib123" When="23/05/2017 19:05:49">
          <Html>
        &lt;div class="markDownOutput "&gt;downloaded the latest build, problem solved! &lt;br&gt;
I apologize...&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="EPPLUS Pivot Table disable refresh on load">
      <Posts>
        <Post From="neves82" When="22/05/2017 11:04:45">
          <Html>
        &lt;div class="markDownOutput "&gt;I have a very large amount of data in the source data sheet that I would like to delete after the PivotTable is build, no problem here...
&lt;br&gt;
&lt;br&gt;
But if the option 'Refresh data when opening the file' is enable, which is by default', every time one opens the file, it gets the error that it cannot find the data source. I need to disable this option, but I cant find anything related... Anyone knows if
 it is even possible, and how to do it? &lt;br&gt;
&lt;br&gt;
Thnks&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="EPPlus: group rows in nested way">
      <Posts>
        <Post From="Yegorych" When="14/05/2017 10:53:30">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
Can you please tell whether its possible to have group of rows inside another group of rows in EPPlus? Problem is that only 1 group is created in such way:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;    //Row Group 2
    for (var i = 5; i &amp;lt;= 10; i++)
    {
        worksheet.Row(i).OutlineLevel = 2;
        worksheet.Row(i).Collapsed = true;
    }

    //Row Group 1
    for (var i = 1; i &amp;lt;= 10; i++)
    {
        worksheet.Row(i).OutlineLevel = 1;
        worksheet.Row(i).Collapsed = true;
    }
&lt;/code&gt;&lt;/pre&gt;
In Excel its possible to do this.. &lt;br&gt;
&lt;br&gt;
Thanks!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="EPPlus: dynamic pivot table using external connection">
      <Posts>
        <Post From="jeanie77" When="09/05/2017 09:54:46">
          <Html>
        &lt;div class="markDownOutput "&gt;I read that EPPlus is supporting pivot tables, but I would need something like the Excel.interop property
&lt;a href="https://msdn.microsoft.com/en-us/library/microsoft.office.interop.excel.pivottable.sourcedata.aspx" rel="nofollow"&gt;
PivotTable.SourceData&lt;/a&gt;, to generate a dynamic sheet which updates its data using the given connection.
&lt;br&gt;
Is this feature available in EPPlus? Or could you please help me in setting up an external connection on a pivot object? I've written a 'create connection' method using pure OpenXML but I'm having some difficulties in associating this connection to a pivot...&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Can I draw freeform with EPPlus?">
      <Posts>
        <Post From="zumejp" When="06/05/2017 04:17:30">
          <Html>
        &lt;div class="markDownOutput "&gt;Can I draw freeform with EPPlus? &lt;br&gt;
&lt;br&gt;
I want to draw freeform like below at serverside. &lt;br&gt;
&lt;a href="http://www.java2s.com/Tutorial/Microsoft-Office-Excel-2007/0160__Wordart-Clip-Art-Shape-Picture/DrawaFreeformPolygon.htm" rel="nofollow"&gt;http://www.java2s.com/Tutorial/Microsoft-Office-Excel-2007/0160__Wordart-Clip-Art-Shape-Picture/DrawaFreeformPolygon.htm&lt;/a&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Get calculated values of the particular cell which has formula to reference the another worksheet">
      <Posts>
        <Post From="vineetraikumar" When="05/05/2017 16:32:58">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
I need to get the calculated value of those cell which has reference of the another worksheet.I am not getting the result. I have excel sheet which has multiple sheet and i am using mainsheet to get all calculated value and in the main sheet i have lot of formula
 applying. if i have formula like this &lt;br&gt;
C1 = (A1 - A2) then it is get calculated using &lt;br&gt;
worksheet.Cells["C1"].Calculate(); but when C1 doesn't have formula like this its has reference of another sheet worksheet2. in this worksheet2 suppose A1 cell has the formula to get calculate.
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;strong&gt;So how to get calculated values of that cell which has reference of another worksheet cell&lt;/strong&gt;
&lt;br&gt;
&lt;br&gt;
Please help me to get rid of this. it very urgent i am using epplus library to solve all this&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Not supported vertical text orientation in CellStyles?">
      <Posts>
        <Post From="ryunakai" When="29/04/2017 11:05:36">
          <Html>
        &lt;div class="markDownOutput "&gt;I want to set vertical text orientation cell styles. &lt;br&gt;
&lt;br&gt;
I means like this &lt;br&gt;
&lt;br&gt;
&lt;img alt="Image" src="https://www.pluslus.com/wp-content/uploads/2017/04/screenshot.png"&gt;
&lt;br&gt;
&lt;br&gt;
that can be written in VBA&lt;br&gt;
&lt;pre&gt;&lt;code&gt;Range["A1"].Orientation = xlVertical&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="ryunakai" When="29/04/2017 12:29:05">
          <Html>
        &lt;div class="markDownOutput "&gt;generated styles.xml by Excel&lt;br&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;alignment vertical="center" textRotation="255"/&amp;gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to set GapWidth for bar chart?">
      <Posts>
        <Post From="Aluniquad" When="28/04/2017 11:35:05">
          <Html>
        &lt;div class="markDownOutput "&gt;I'm creating histograms with EPPlus (great library, by the way!). I'd like to set the gap between the individual bars to 0%, so that they appear directly side by side, no space between the bars. This is easy inside Excel, but I couldn't find a way to do
 it with EPPlus.&lt;br&gt;
&lt;br&gt;
Wanted: &amp;lt;c:gapWidth val="0"/&amp;gt; in the created xlsx.&lt;br&gt;
Any help?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Aluniquad" When="28/04/2017 13:35:30">
          <Html>
        &lt;div class="markDownOutput "&gt;A well, never mind, after browsing the source of EPPlus I found the right hint:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;        var chart = ws.Drawings.AddChart("Histo1", eChartType.ColumnClustered) as ExcelBarChart;
        chart.GapWidth = 0;
&lt;/code&gt;&lt;/pre&gt;
I looked for it at the series level. And I missed the cast to ExcelBarChart. Thanks again for this library!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="CodePlex will shutdown: will EPPlus moved to github?">
      <Posts>
        <Post From="LuciferSam86" When="06/04/2017 14:10:17">
          <Html>
        &lt;div class="markDownOutput "&gt;CodePlex will shutdown: will EPPlus moved to github? &lt;br&gt;
I know there is still some time for waiting, but will it do? &lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="10/04/2017 08:10:28">
          <Html>
        &lt;div class="markDownOutput "&gt;Yes, we will move EPPlus to github due to this. It will happen before CodePlex goes into readonly mode in October, but requires some preparations.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to Add Sheet from One Excel file to another File?">
      <Posts>
        <Post From="leokaplin" When="05/04/2017 16:24:58">
          <Html>
        &lt;div class="markDownOutput "&gt;Here is my code in VS2012 SSIS script:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;    Dim GLReconFile As String = Dts.Variables("User::v_TmpFile").Value
    Dim PBSummaryPath As String = Dts.Variables("User::v_OutputPath").Value
    Dim PBFileSearchPattern As String = Dts.Variables("User::v_PBFileSearchPattern").Value
    Dim PBSummaryFile As String = FindFile(PBSummaryPath, PBFileSearchPattern)

    Dim MasterPackage As ExcelPackage = New ExcelPackage(New FileInfo(GLReconFile))
    Dim SourcePackage As ExcelPackage = New ExcelPackage(New FileInfo(PBSummaryFile))

    MasterPackage.Workbook.Worksheets.Add("Test", SourcePackage.Workbook.Worksheets(1))
    MasterPackage.Save()

    Dts.TaskResult = ScriptResults.Success
&lt;/code&gt;&lt;/pre&gt;
I get "unable to save error" &lt;br&gt;
&lt;br&gt;
Thanks for any help, &lt;br&gt;
Leo &lt;br&gt;
&lt;br&gt;
FYI : i cant find any working examples anywhere.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to get value from cell when format is [h]:mm:ss">
      <Posts>
        <Post From="bob1000" When="30/03/2017 13:58:21">
          <Html>
        &lt;div class="markDownOutput "&gt;Hiall good people, &lt;br&gt;
Have question if i have column which format is: &lt;br&gt;
&lt;pre&gt;&lt;code&gt;[h]:mm:ss &lt;/code&gt;&lt;/pre&gt;
so means hours could exceed 24. For example i have two cells and that text for each:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;65:34:22    (value behind is 12:22:00 AM)                        --&amp;gt;K2 cell
0:22:00      (value behind is  1/2/1900  5:34:22 PM)          --&amp;gt;K3 cell
&lt;/code&gt;&lt;/pre&gt;
&lt;strong&gt;I want to get 65:34:22 and 0:22:00&lt;/strong&gt; &lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Now what i tried was: &lt;br&gt;
&lt;br&gt;
ws.Cells("K2").Text giving me: 12 &lt;br&gt;
ws.Cells("K3").Text giving me: 05 &lt;br&gt;
&lt;br&gt;
then i tried before get values set format like this:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;ws.Cells("K2").Style.Numberformat.Format = "h:mm:ss"
ws.Cells("K3").Style.Numberformat.Format = "h:mm:ss"&lt;/code&gt;&lt;/pre&gt;
ws.Cells("K2").Text giving me: 0:22:00 --&amp;gt; GOOD ! &lt;br&gt;
ws.Cells("K3").Text giving me: 17:34:22 --&amp;gt; WRONG &lt;br&gt;
&lt;br&gt;
i also tried with this formatting:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;ws.Cells("K2").Style.Numberformat.Format = "[h]:mm:ss"
ws.Cells("K3").Style.Numberformat.Format = "[h]:mm:ss"&lt;/code&gt;&lt;/pre&gt;
ws.Cells("K2").Text giving me: 12 --&amp;gt; WRONG &lt;br&gt;
ws.Cells("K3").Text giving me: 05 --&amp;gt; WRONG&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="bob1000" When="01/04/2017 14:03:22">
          <Html>
        &lt;div class="markDownOutput "&gt;is this not available in Epplus or anyone any feedback?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Ignore excel error checking or remove green tag on top left of the cell">
      <Posts>
        <Post From="jasonouellet" When="28/03/2017 16:59:47">
          <Html>
        &lt;div class="markDownOutput "&gt;Have you add solution to ignore excel error checking or remove green tag on top left of the cell like this solution ?
&lt;br&gt;
&lt;a href="http://stackoverflow.com/questions/11858109/using-epplus-excel-how-to-ignore-excel-error-checking-or-remove-green-tag-on-t" rel="nofollow"&gt;http://stackoverflow.com/questions/11858109/using-epplus-excel-how-to-ignore-excel-error-checking-or-remove-green-tag-on-t&lt;/a&gt;
&lt;br&gt;
&lt;br&gt;
I want to know if I have to fork EPPlus and apply this fix for my application. &lt;br&gt;
&lt;br&gt;
Thanks&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="30/03/2017 13:38:46">
          <Html>
        &lt;div class="markDownOutput "&gt;I dont think so, u're welcome to fork and submit ur pull request. I didnt test but maybe another way to "fix" that is input your value by formula with TEXT() function.
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
worksheet.Cell[1,1].Formula = "TEXT(" + cellvalue ")";&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Will this work on Azure Web Apps? We are getting an error...">
      <Posts>
        <Post From="raffertyuy" When="30/03/2017 11:58:05">
          <Html>
        &lt;div class="markDownOutput "&gt;Dear all,&lt;br&gt;
&lt;br&gt;
We are getting the error below when we deployed to Azure Web Apps.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;"The 'Microsoft.ACE.OLEDB.12.0' provider is not registered on the local machine"&lt;/code&gt;&lt;/pre&gt;
We can't install anything on Azure Web Apps as it is PaaS.&lt;br&gt;
Is this error normal? Any suggestions on how we can resolve this?&lt;br&gt;
&lt;br&gt;
Hope someone can reply as soon as possible.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Problem with EPPlus - it replaces excel column name contains full stop with hash (#) in DataTable">
      <Posts>
        <Post From="AkshayRaut" When="24/03/2017 01:03:31">
          <Html>
        &lt;div class="markDownOutput "&gt;I am using EPPlus library and my excel sheet contains some columns that has fullstop in them. So when i load it in DataTable in my c# project then it replaces the fullstop with a hash (#) character. Can i control whether this behavior should take place
 or not? Why does this even happen ? Is this a bug?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="DefaultRowHeight is incorrect">
      <Posts>
        <Post From="nayuchan" When="22/03/2017 13:40:31">
          <Html>
        &lt;div class="markDownOutput "&gt;Excel 2013 Book &lt;br&gt;
&amp;lt;sheetFormatPr defaultRowHeight="13.5" x14ac:dyDescent="0.15"/&amp;gt;
&lt;br&gt;
&lt;br&gt;
Reading with EPPlus results in DefaultRowHeight = 15. This is an error. &lt;br&gt;
Fix to ignore CustomHeight. &lt;br&gt;
Or set the default value of DefaultRowHeight to 13.5 &lt;br&gt;
Or &lt;br&gt;
1.Judge Excel version with rupBuild &lt;br&gt;
2.Decide DefaultRowHeight?&lt;br&gt;
&lt;h2&gt;(Excelworksheet.cs line 606 ver4.1.0)&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;    public double DefaultRowHeight
    {
        get
        {
            CheckSheetType();
            _defaultRowHeight = GetXmlNodeDouble("d:sheetFormatPr/@defaultRowHeight");
            //if (double.IsNaN(_defaultRowHeight) || CustomHeight == false) //FIX
            if (double.IsNaN(_defaultRowHeight)) //FIX
            {
                _defaultRowHeight = GetRowHeightFromNormalStyle();
            }
            return _defaultRowHeight;
        }
&lt;/code&gt;&lt;/pre&gt;
&lt;h2&gt;(Excelworksheet.cs line 631 ver4.1.0)&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;    private double GetRowHeightFromNormalStyle()
    {
        var ix = Workbook.Styles.NamedStyles.FindIndexByID("Normal");
        if (ix &amp;gt;= 0)
        {
            var f = Workbook.Styles.NamedStyles[ix].Style.Font;
            return ExcelFontXml.GetFontHeight(f.Name, f.Size) * 0.75;
        }
        else
        {
            //return 15;   //Default Calibri 11 FIX
            return 13.5;   //FIX
        }
    }&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="AddPicture and AddShape Error">
      <Posts>
        <Post From="nayuchan" When="22/03/2017 12:40:22">
          <Html>
        &lt;div class="markDownOutput "&gt;If DrawingXml already exists, AddPicture and AddShape will fail. DrawingXml seems to be created for each sheet, so we modified it to use it if it exists.&lt;br&gt;
&lt;h2&gt;(ExcelDrawings.cs 429 line ver4.1.0)&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;        private XmlElement CreateDrawingXml()
        {
            if (DrawingXml.OuterXml == "")
            {
                DrawingXml.LoadXml(string.Format("&amp;lt;?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?&amp;gt;&amp;lt;xdr:wsDr xmlns:xdr=\"{0}\" xmlns:a=\"{1}\" /&amp;gt;", ExcelPackage.schemaSheetDrawings, ExcelPackage.schemaDrawings));
                _uriDrawing = new Uri(string.Format("/xl/drawings/drawing{0}.xml", Worksheet.SheetID),UriKind.Relative);

                Packaging.ZipPackage package = Worksheet._package.Package;

                // FIX ----- 
                if (package.PartExists(_uriDrawing))
                {
                    _part = package.GetPart(_uriDrawing);
                }
                else
                {
                    _part = package.CreatePart(_uriDrawing, "application/vnd.openxmlformats-officedocument.drawing+xml", _package.Compression);
                }
                // FIX ----- &lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Source code does not build in VS 2012">
      <Posts>
        <Post From="jim_software" When="22/03/2017 01:21:43">
          <Html>
        &lt;div class="markDownOutput "&gt;The build fails at all lines with the =&amp;gt; &lt;br&gt;
error expected ; &lt;br&gt;
public IEnumerable&amp;lt;System.DateTime&amp;gt; AdditionalDates =&amp;gt; _holidayDates; &lt;br&gt;
public int NumberOfWorkdaysPerWeek =&amp;gt; 7 - _holidayDays.Count;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to read formula cell value where formula is accessing other formula cells?">
      <Posts>
        <Post From="nzedwin" When="08/03/2017 11:38:19">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi &lt;br&gt;
&lt;br&gt;
How to read cell value using EPPlus in the following excel example. (Stupid example but it illustrates the point)&lt;br&gt;
&lt;pre&gt;&lt;code&gt;                                                              COLUMNS
            A         B         C         D               E              F`
R   1       1         2         3         =SUM(A1..B1)   =SUM(B1..C1)    =SUM(D1..E1)
O
W
&lt;/code&gt;&lt;/pre&gt;
In this example i can get value of D1 and E1 correctly if call the Calculate() Method.
&lt;br&gt;
But calling Calculate() on Cell F1 does not return value of 8. It returns 0. &lt;br&gt;
&lt;br&gt;
I can change cell F1 formula to be SUM( SUM(A1..B1) , SUM(B1..C1) ) to make it work but i was wondering if there is way for EPPLus to calculate formulas that depend on other cell formulas? Or if that could be added to a future version?...
&lt;br&gt;
&lt;br&gt;
Kind Regards &lt;br&gt;
Edwin&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to get the conditional formatting applied to the cell?">
      <Posts>
        <Post From="maurice_hulsman" When="03/03/2017 15:03:24">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi all, &lt;br&gt;
&lt;br&gt;
I've been using EPPlus for a project to merge several Excel workbooks together into a single summary worksheet.
&lt;br&gt;
Each of these workbooks can have conditional formatting rules. &lt;br&gt;
The summary worksheet should get concrete formatting as you cannot just pile all conditional formatting onto one big heap.
&lt;br&gt;
&lt;br&gt;
Now I've been searching over the documentation but I found nothing on how to get the resulting formatting for a given cell.
&lt;br&gt;
&lt;br&gt;
Before version 4.0 and the implementation of the calculation engine such a feature was impossible, but now I can imagine this can be supported.
&lt;br&gt;
&lt;br&gt;
Is getting the resulting formatting of a cell possible using EPPlus or is this feature possibly on the roadmap?
&lt;br&gt;
&lt;br&gt;
Kind regards, &lt;br&gt;
&lt;br&gt;
Maurice&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Added sortcondition to filter, but filter is not active">
      <Posts>
        <Post From="mldz" When="23/02/2017 17:15:45">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
I wanted to sort my output using the autofilter in excel. I could not find the way to do so in the example files, so I took a look at the XML code of an excel file I saved after applying the sort method to it.
&lt;br&gt;
&lt;br&gt;
I noticed this in the XML:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;autoFilter ref="A2:L2"&amp;gt;
    &amp;lt;sortState ref="A3:L597"&amp;gt;
        &amp;lt;sortCondition ref="E2"/&amp;gt;
    &amp;lt;/sortState&amp;gt;
&amp;lt;/autoFilter&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
so I added it to C# the code like this: &lt;br&gt;
var filterDef = new XElement("sortState"); &lt;br&gt;
filterDef.Add(new XAttribute("ref", "A3:L597")); &lt;br&gt;
filterDef.Add(new XElement("sortCondition", new XAttribute("ref", "E2")));
&lt;br&gt;
autoFilterNode.InnerXml += filterDef.ToString(); &lt;br&gt;
&lt;br&gt;
build the excel file, using the C# code. When I opened the excel file, the sort seems to be applied when you see the autofilter drop down in the specific column. But the sorting was actually not done.
&lt;br&gt;
&lt;br&gt;
I checked the XML code of the code-written excel sheet and the autoFilter element attributes and sub elements are exactly the same.
&lt;br&gt;
&lt;br&gt;
Generated XML code via C#&lt;br&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;autoFilter ref="A2:L2"&amp;gt;
    &amp;lt;sortState ref="A3:L597"&amp;gt;
        &amp;lt;sortCondition ref="E2" /&amp;gt;
    &amp;lt;/sortState&amp;gt;
&amp;lt;/autoFilter&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
I also did a ws.Calculate() and _package.Workbook.Calculate() prior to saving the file.
&lt;br&gt;
What do I need to do to get the sorting right? &lt;br&gt;
Kind regards, &lt;br&gt;
&lt;br&gt;
Matthijs&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title=".NET Core">
      <Posts>
        <Post From="dannythomas13" When="03/10/2016 08:32:42">
          <Html>
        &lt;div class="markDownOutput "&gt;I am currently using this in a new application but have had to target the full framework due to this not being supported within a .NET application, is work ongoing to make this possible?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="LouisDK" When="12/10/2016 08:28:18">
          <Html>
        &lt;div class="markDownOutput "&gt;Same here. We've been using EPPlus for many years, but now have to support .NET Core. Would really appreciate EPPlus being adapted / ported to .NET Core!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="VahidN" When="20/10/2016 11:29:32">
          <Html>
        &lt;div class="markDownOutput "&gt;I've ported this library to .NET Core: &lt;br&gt;
&lt;a href="https://github.com/VahidN/EPPlus.Core" rel="nofollow"&gt;https://github.com/VahidN/EPPlus.Core&lt;/a&gt;
&lt;br&gt;
&lt;br&gt;
Here is the list of the changes (comparing to Sep 5, 2016, change set#b8f3cbcaec00)
&lt;br&gt;
&lt;a href="https://github.com/VahidN/EPPlus.Core/commit/0536a32f2bffba3d6062e8bb25f2135310206b39" rel="nofollow"&gt;https://github.com/VahidN/EPPlus.Core/commit/0536a32f2bffba3d6062e8bb25f2135310206b39&lt;/a&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="conniey" When="21/02/2017 22:31:52">
          <Html>
        &lt;div class="markDownOutput "&gt;&lt;strong&gt;VahidN wrote:&lt;/strong&gt;&lt;br&gt;
&lt;blockquote&gt;I've ported this library to .NET Core:&lt;br&gt;
&lt;a href="https://github.com/VahidN/EPPlus.Core" rel="nofollow"&gt;https://github.com/VahidN/EPPlus.Core&lt;/a&gt;&lt;br&gt;
&lt;br&gt;
Here is the list of the changes (comparing to Sep 5, 2016, change set#b8f3cbcaec00)&lt;br&gt;
&lt;a href="https://github.com/VahidN/EPPlus.Core/commit/0536a32f2bffba3d6062e8bb25f2135310206b39" rel="nofollow"&gt;https://github.com/VahidN/EPPlus.Core/commit/0536a32f2bffba3d6062e8bb25f2135310206b39&lt;/a&gt;&lt;br&gt;
&lt;/blockquote&gt;
Awesome! Is it possible to get these changes merged into this project?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Server-side Excel library for use with C# and .NET ? Does EPPlus support the features below ?">
      <Posts>
        <Post From="CiC_Devid" When="14/02/2017 15:16:26">
          <Html>
        &lt;div class="markDownOutput "&gt;My question would be: Is EPPlus the Excel library I am looking for ? &lt;br&gt;
&lt;br&gt;
At our company we are using the [Telerik RadSpreadProcessing] Library with .NET C#. It can manipulate data on the server-side without the need for Office. Unfortunately the Telerik library is missing few features that we need. Such features are:
&lt;br&gt;
&lt;ul&gt;
&lt;li&gt;Add Graphic in Header and Footer &lt;/li&gt;&lt;li&gt;Rotation of Text in a cell &lt;/li&gt;&lt;li&gt;Charts should not be thrown away (Telerik library throws away)&lt;br&gt;
&lt;/li&gt;&lt;/ul&gt;
The library should support the .xlsx format but also Formulas to manipulate the data.
&lt;br&gt;
&lt;br&gt;
Furthermore it would be ideal if the library has the below functionalities: &lt;br&gt;
&lt;br&gt;
• OpenWorkbook &lt;br&gt;
• AddNewWorkbook &lt;br&gt;
• AddNewSheet &lt;br&gt;
• RemoveSheetByName &lt;br&gt;
• RemoveSheetByIndex &lt;br&gt;
• SelectSheetByName &lt;br&gt;
• SelectSheetByIndex &lt;br&gt;
• GetSheetNames &lt;br&gt;
• SetSheetName &lt;br&gt;
• GetCellValue &lt;br&gt;
• SetCellValue &lt;br&gt;
• SetCellText &lt;br&gt;
• SetCellTextFromClipboard &lt;br&gt;
• SetRowValues &lt;br&gt;
• SetColumnValues &lt;br&gt;
• AutoFit &lt;br&gt;
• SetHeader &lt;br&gt;
• SetFooter &lt;br&gt;
• SetCellStyles &lt;br&gt;
• SetCellStyle &lt;br&gt;
• SetCellBorders &lt;br&gt;
• SetCellBorder &lt;br&gt;
• SetCellAlignments &lt;br&gt;
• SetCellAlignment &lt;br&gt;
• SetCellProtections &lt;br&gt;
• SetCellProtection &lt;br&gt;
• SetSheetProtection &lt;br&gt;
• SetCellFormat &lt;br&gt;
• SetCellFormats &lt;br&gt;
• Save &lt;br&gt;
• SaveAs &lt;br&gt;
• Close &lt;br&gt;
• GetSessions&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Format Cell Kilowatts / Hour">
      <Posts>
        <Post From="samael205" When="01/02/2017 14:54:58">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
I have a cell that contains a value that refers to a Kilowatts / Hour. &lt;br&gt;
&lt;br&gt;
How i can set the numberFormat.format with the string kwh? &lt;br&gt;
&lt;br&gt;
In the cell has to be one thing like this: 5 kWh &lt;br&gt;
&lt;br&gt;
thanks in advance&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="samael205" When="14/02/2017 09:16:27">
          <Html>
        &lt;div class="markDownOutput "&gt;Resolved with:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;wsData.Cells[2, (z + 1)].Style.Numberformat.Format = "&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;,0 \"kwh\"";
wsData.Cells[2, (z + 1)].Style.Numberformat.Format = "&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;,0 \"ºC\"";&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Copy Data To New Worksheet">
      <Posts>
        <Post From="chalupabatman" When="14/02/2017 02:19:31">
          <Html>
        &lt;div class="markDownOutput "&gt;I have a "Master" worksheet that holds data for all team members. For each unique name, I would like to copy the rows for that name and paste onto a worksheet created for them. Can this be completed through EPPlus?
&lt;br&gt;
&lt;br&gt;
Sample Data &lt;br&gt;
Player Game Date H SO W HBP &lt;br&gt;
One 01/01/2017 12 2 4 0 &lt;br&gt;
One 01/04/2017 3 1 0 0 &lt;br&gt;
One 01/05/2017 1 0 0 0 &lt;br&gt;
Two 01/01/2017 4 3 1 2 &lt;br&gt;
Two 01/04/2017 2 1 3 1 &lt;br&gt;
&lt;br&gt;
Pseudocode of what I am after &lt;br&gt;
1) On worksheet titled master, scan each cell in column A to find all names that are similar
&lt;br&gt;
2) Create a worksheet for that name &lt;br&gt;
3) Copy over that player data (including headers) &lt;br&gt;
4) Activate totals worksheet &lt;br&gt;
5) Repeat for each unique player name &lt;br&gt;
6) Once all players have their own worksheet activate Totals worksheet &lt;br&gt;
&lt;br&gt;
Using sample data above I would need to create a worksheet called one and have this data on it
&lt;br&gt;
Player Game Date H SO W HBP &lt;br&gt;
One 01/01/2017 12 2 4 0 &lt;br&gt;
One 01/04/2017 3 1 0 0 &lt;br&gt;
One 01/05/2017 1 0 0 0 &lt;br&gt;
&lt;br&gt;
Then create a worksheet called two that has this data on it &lt;br&gt;
Player Game Date H SO W HBP &lt;br&gt;
Two 01/01/2017 4 3 1 2 &lt;br&gt;
Two 01/04/2017 2 1 3 1 &lt;br&gt;
&lt;br&gt;
(&lt;strong&gt;Yes the data should be duplicated&lt;/strong&gt;)&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Importing from SpreadsheetML (2003 XML format)">
      <Posts>
        <Post From="bencurthoys" When="29/09/2016 14:33:17">
          <Html>
        &lt;div class="markDownOutput "&gt;A nice way of creating spreadsheets would be to start with an XML document, run it through an XSL transform, and have that transformed data be something that can be parsed into a spreadsheet.&lt;br&gt;
&lt;br&gt;
Generating XLSX style XML from XSL is clearly a non-starter. But the old 2003 SpreadsheetML format is perfectly achievable. The problem is that it's effort to convert SpreadsheetML to a useful spreadsheet; there's one tool I know of that does it, and that isn't
 cheap. &lt;br&gt;
&lt;br&gt;
So, I've spent the morning making a start on a SpreadsheetML importer for EPPlus. You give it an XML file and it gives you an ExcelPackage back. To test it, I start with an XSLX spreadsheet created with Excel, saving it as "XML Spreadsheet 2003",
 and running it through the code to turn it back into XLSX, and making sure it looks the same.&lt;br&gt;
&lt;br&gt;
I've got it doing all the bits that I need, which is a long way from 100% of what you can express, but enough to be useful.
&lt;br&gt;
&lt;br&gt;
Would anyone else like it? Should I contribute it to the project?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="SaschaM" When="03/02/2017 09:38:49">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
i'am searching for the same thing. Could you share your converter? &lt;br&gt;
Thank you.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="EPPlus Formula value resulting in #VALUE!">
      <Posts>
        <Post From="ashleyabraham" When="31/01/2017 06:27:04">
          <Html>
        &lt;div class="markDownOutput "&gt;I have an Excel file with a table &lt;code&gt;tblPhoneCode&lt;/code&gt; and with two columns
&lt;code&gt;Country&lt;/code&gt; and &lt;code&gt;Code&lt;/code&gt;, and I have a cell B1 with List Data Validation pointing to the
&lt;code&gt;Country&lt;/code&gt; column&lt;br&gt;
&lt;br&gt;
&lt;img alt="Image" src="https://i.stack.imgur.com/OfNFj.png"&gt;&lt;br&gt;
&lt;br&gt;
and a cell B2 basically it displays the &lt;code&gt;Code&lt;/code&gt; for the selected &lt;code&gt;
Country&lt;/code&gt;. &lt;br&gt;
&lt;br&gt;
&lt;img alt="Image" src="https://i.stack.imgur.com/Mlkzg.png"&gt;&lt;br&gt;
&lt;br&gt;
Cell B2 uses the following formula&lt;br&gt;
&lt;pre&gt;&lt;code&gt;OFFSET(INDIRECT("tblPhoneCode[#Headers]"),MATCH(B1,INDIRECT("tblPhoneCode[Country]"),0),1,1,1)

&lt;/code&gt;&lt;/pre&gt;
Everything in Excel works as it should, but the issue is when I am reading the value of B2 using EPPlus in C# I am getting
&lt;code&gt;#VALUE!&lt;/code&gt; instead of the actual Phone &lt;code&gt;Code&lt;/code&gt;. I've tried &lt;code&gt;
.Calculate()&lt;/code&gt; from workbook, worksheet, to cell and tried to access the value is still the same. I've attached the logger and it turns up empty and there is no error logged in it.&lt;br&gt;
&lt;br&gt;
C# Code&lt;br&gt;
&lt;pre&gt;&lt;code&gt;static void Main(string[] args)
{
    var excelFile = new FileInfo(@"C:\Users\Ash\Desktop\Epplus.xlsx");
    using (var package = new ExcelPackage(excelFile))
    {
        // Output from the logger will be written to the following file
        var logfile = new FileInfo(@"C:\Users\Ash\Desktop\EpplusLogFile.txt");
        // Attach the logger before the calculation is performed.
        package.Workbook.FormulaParserManager.AttachLogger(logfile);
        // Calculate - can also be executed on sheet- or range level.
        package.Workbook.Calculate();

        Debug.Print(String.Format("Country: \t{0}", package.Workbook.Worksheets[1].Cells["B1"].Value));
        Debug.Print(String.Format("Phone Code:\t{0}", package.Workbook.Worksheets[1].Cells["B2"].Value));

        // The following method removes any logger attached to the workbook.
        package.Workbook.FormulaParserManager.DetachLogger();
    }
}
&lt;/code&gt;&lt;/pre&gt;
Output:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;Country:    US
Phone Code: #VALUE!

&lt;/code&gt;&lt;/pre&gt;
Any help or insight is much appreciated, I am using MS Excel 2010, .NET 4.0, EPPlus 4.1.0, and Windows 10 64bit&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="31/01/2017 22:29:38">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
It could be that the Indirect function in EPPlus cannot handle tablereferences. Have you tried without it?
&lt;br&gt;
&lt;br&gt;
If possible, create an issue and attach your workbook so we can reproduce the error.
&lt;br&gt;
&lt;br&gt;
/Mats&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="ashleyabraham" When="01/02/2017 05:37:34">
          <Html>
        &lt;div class="markDownOutput "&gt;I tried your suggestion and removed the table reference and used direct reference
&lt;code&gt;=OFFSET(G2:G5,MATCH(B1,F2:F5,0)-1,0,1,1)&lt;/code&gt; and it still returns &lt;code&gt;
#VALUE!&lt;/code&gt;, next I tried using named ranges &lt;code&gt;=OFFSET(PhoneCodes,MATCH(B1,Countries,0)-1,0,1,1)&lt;/code&gt; and it also returns
&lt;code&gt;#VALUE!&lt;/code&gt; instead of the actual content&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="ashleyabraham" When="01/02/2017 06:10:51">
          <Html>
        &lt;div class="markDownOutput "&gt;Opened a new issue &lt;a href="https://epplus.codeplex.com/workitem/15585" rel="nofollow"&gt;
work item&lt;/a&gt;&lt;br&gt;
&lt;br&gt;
Weirdly, it works when you don't have the &lt;code&gt;package.Workbook.Calculate();&lt;/code&gt;
&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Format Pivot Table">
      <Posts>
        <Post From="jendar" When="31/01/2017 17:01:18">
          <Html>
        &lt;div class="markDownOutput "&gt;I am using the pivot table functionality, which is working out great except I'm having issues with formatting.
&lt;br&gt;
&lt;ul&gt;
&lt;li&gt;Is it possible to apply specific formatting on a pivot table outside of using the built in TableStyles? For example, I have requirements to make the font in the pivot table Arial Narrow with a size of 10 font and text centered. I can easily do this on the
 worksheet itself, but I have yet to find a way to do this on the pivot table. I see the OfficeOpenXml.Table.TableStyles.Custom, but I don't quite understand what that does, same with ExcelPivotTable.StyleName.
&lt;/li&gt;&lt;li&gt;Is there any way to set the Banded Rows and Banded Columns to true/on in the pivot table? Is there another way to basically show the gridlines on the pivot table?&lt;br&gt;
&lt;/li&gt;&lt;/ul&gt;
Any help would be much appreciated. If the above is not possible in EPPlus, can someone please let me know?
&lt;br&gt;
&lt;br&gt;
Thanks!!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Slicer and Collapse Row on Pivot Table">
      <Posts>
        <Post From="jendar" When="25/01/2017 22:19:13">
          <Html>
        &lt;div class="markDownOutput "&gt;I have been using EPPlus to create a pivot table. So far, things are working great, but I have a few questions.&lt;br&gt;
&lt;ol&gt;
&lt;li&gt;Is there a way to add a Slicer to the worksheet? &lt;/li&gt;&lt;li&gt;Also, is there a way to collapse a row in a pivot table? I have tried numerous ways to do this within EPPlus, but it seems like the pivot table isn't recognized until Excel has fully rendered.&lt;br&gt;
&lt;/li&gt;&lt;/ol&gt;
Thanks!!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Copying Drawings">
      <Posts>
        <Post From="daufderh" When="25/01/2017 03:10:49">
          <Html>
        &lt;div class="markDownOutput "&gt;I'm looking to copy a Chart (or any Drawing for that matter) from one ExcelWorksheet to another. What is the suggested way to go about doing this? Using the epplus API it looks like I have to create a new Chart using AddChart then copy all the attributes
 one at a time. Worse, it's not intuitive to get at things like the position/size from the source chart.
&lt;br&gt;
&lt;br&gt;
I've seen code on StackOverflow in which "CloneShape" was added to the ExcelDrawings class. Is building a custom epplus dll with calls like that in it my best option?
&lt;br&gt;
&lt;br&gt;
Thanks &lt;br&gt;
Dave&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="merging xlsx">
      <Posts>
        <Post From="x20833" When="25/01/2017 00:19:24">
          <Html>
        &lt;div class="markDownOutput "&gt;I have a situation where I have multiple xlsx (e..g 5 xlsx and 1 worksheet on each one) and would like to create a master xlsx with one worksheet by combing all 5 xlsx worksheets into one). I noticed there is an overloading Add(string Name, ExcelWorksheet).
 However, this is adding a new worksheet instead of appending to the current worksheet.
&lt;br&gt;
&lt;br&gt;
Is there a way of accomplishing that ?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="VB6">
      <Posts>
        <Post From="hostwap" When="24/01/2017 23:36:31">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi &lt;br&gt;
&lt;br&gt;
Is it possible to use epplus to export datagrid in vb6 to excel? &lt;br&gt;
&lt;br&gt;
Thanks&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Autoit Language">
      <Posts>
        <Post From="Virgilio381" When="24/01/2017 21:28:13">
          <Html>
        &lt;div class="markDownOutput "&gt;I would use the dll with a written application with Autoit but I have not the power to make a wraper with dllcall().
&lt;br&gt;
Have you already tried?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Convert a generated Excel (with OpenXml) to a regular excel format ?">
      <Posts>
        <Post From="GregoryBisschops" When="24/01/2017 13:03:42">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
I have a situation where a customer is rejecting my excel files (generated with epplus) because of a filter on their email servers.
&lt;br&gt;
Indeed, they accepts "classics" excel files, but the ones created with the OpenXml format, they reject it (thinking it is not an excel but some malicious code).
&lt;br&gt;
&lt;br&gt;
Is there anyway that I can "convert" the generated one into a regular one without using Excel ? Just with .net code ?
&lt;br&gt;
&lt;br&gt;
Else I'll have to use the com interop and use excel right onto the server just for that customer :(
&lt;br&gt;
&lt;br&gt;
Greg&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="EPPLUS names note saved">
      <Posts>
        <Post From="jugurtha" When="23/01/2017 15:44:35">
          <Html>
        &lt;div class="markDownOutput "&gt;I encountered a surprising problem with the Epplus Library. My concern is that when I rewrite to an existing (.xlsx) file, all of the namespaces are not typed. Example:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;string ws_name = "name1”; 
ExcelWorksheet old = package.Workbook.Worksheets[ws_name];
package.Workbook.Worksheets.Delete(old);
newSheet = package.Workbook.Worksheets.Add(ws_name, package.Workbook.Worksheets["name2"]);
...
Package.Save(); &lt;/code&gt;&lt;/pre&gt;
The "name2" sheet contains name fields that are not written to newSheet. And my problem is there because I use them afterwards. Thank you in advance,&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Change Order yAxys with EPPlus">
      <Posts>
        <Post From="samael205" When="20/01/2017 08:47:37">
          <Html>
        &lt;div class="markDownOutput "&gt;I'm doing an excel with epplus that requires generating two graphs in vertical bars like those shown in the following image:
&lt;br&gt;
&lt;br&gt;
&lt;img alt="Image" src="https://i.stack.imgur.com/U0fIn.jpg"&gt; &lt;br&gt;
&lt;br&gt;
As you can see, on the Y-axis, the labels appear disordered, starting with P6 and ending with P1. I want to get the opposite effect. Start at P1 and end at P6
&lt;br&gt;
&lt;br&gt;
Is there any property with which I can change the order? Or should I order it with some sort of sort algorithm?
&lt;br&gt;
&lt;br&gt;
This is the function related to generate the chart&lt;br&gt;
&lt;pre&gt;&lt;code&gt;public void dibujarGrafica6Periodos(ExcelWorksheet ws, CultureInfo idioma)
    {
        CultureInfo cultureInfo = Thread.CurrentThread.CurrentCulture;
        TextInfo textinfo = cultureInfo.TextInfo;
        var chart = ws.Drawings.AddChart("barChart2", OfficeOpenXml.Drawing.Chart.eChartType.BarClustered);
        chart.SetPosition(34, 0, 10, 10);
        chart.SetSize(940, 20*14);
        var serie1 = chart.Series.Add(ws.Cells["E36:E41"], ws.Cells["A36:A41"]);
        var serie2 =chart.Series.Add(ws.Cells["C36:C41"], ws.Cells["A36:A41"]);
        chart.Title.Text = "Consumo por Periodos - " + textinfo.ToUpper(DateTime.Now.ToString("MMMM", idioma));
        chart.Title.Font.Color = System.Drawing.ColorTranslator.FromHtml("&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/4"&gt;#4&lt;/a&gt;F81BD");
        chart.Border.Fill.Style = eFillStyle.NoFill;
        chart.Title.Font.Size = 6;
        chart.YAxis.Font.Size = 5;
        chart.XAxis.Font.Size = 5;
        chart.Legend.Font.Size = 5;
        chart.Legend.Font.Color = System.Drawing.ColorTranslator.FromHtml("&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/4"&gt;#4&lt;/a&gt;F81BD");
        chart.YAxis.Font.Color = System.Drawing.ColorTranslator.FromHtml("&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/4"&gt;#4&lt;/a&gt;F81BD");
        chart.XAxis.Font.Color = System.Drawing.ColorTranslator.FromHtml("&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/4"&gt;#4&lt;/a&gt;F81BD");
        chart.Legend.Position = OfficeOpenXml.Drawing.Chart.eLegendPosition.Bottom;
        chart.Style = OfficeOpenXml.Drawing.Chart.eChartStyle.Style10;
        serie1.Header = DateTime.Now.ToString("yyyy");
        serie2.Header = DateTime.Now.AddYears(-1).ToString("yyyy");
    }&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="samael205" When="20/01/2017 09:30:08">
          <Html>
        &lt;div class="markDownOutput "&gt;Resloved with: &lt;br&gt;
&lt;pre&gt;&lt;code&gt; chart.YAxis.LabelPosition = OfficeOpenXml.Drawing.Chart.eTickLabelPosition.High;
 chart.XAxis.Orientation = OfficeOpenXml.Drawing.Chart.eAxisOrientation.MaxMin;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Reading cell that calls VBA function returns wrong result">
      <Posts>
        <Post From="rbish5280" When="17/01/2017 06:27:41">
          <Html>
        &lt;div class="markDownOutput "&gt;I have a XLSM file that I am trying to read into a database. One of the cells calls a VBA function and returns a price. The VBA function is complex and actually calls another function to help calculate the price. The spreadsheet shows the correct price,
 but when I try to read the cell with EPPlus it does not return the same value. &lt;br&gt;
&lt;br&gt;
I use the following to read the cell: &lt;br&gt;
object c51 = currentWorksheet.Cells[3, 51].Value; &lt;br&gt;
&lt;br&gt;
I also tried running the calculate method before reading the cell, but that made the value return as #Name.
&lt;br&gt;
currentWorksheet.Cells[3, 51].Calculate(); &lt;br&gt;
object c51 = currentWorksheet.Cells[3, 51].Value; &lt;br&gt;
&lt;br&gt;
When using the FormulaParserManager logging method, it returns the following: &lt;br&gt;
Timestamp: 1/16/2017 3:53:15 PM &lt;br&gt;
Worksheet: Data &lt;br&gt;
Address: BJ3 &lt;br&gt;
'GetDensityFactor' is not a supported function &lt;br&gt;
&lt;br&gt;
Is there a way to read a cell whose value is derived from a VBA function?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="XLSB File Support">
      <Posts>
        <Post From="bmd174s" When="07/08/2013 14:51:10">
          <Html>
        &lt;div class="markDownOutput "&gt;I have a client that converted their XLSX files to XLSB for speed, and now I can't use my epplus application to view and extract data from those files. Any idea how to make this work?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="07/08/2013 14:55:16">
          <Html>
        &lt;div class="markDownOutput "&gt;EPPlus does not support the binary format. We are currently focusing on implementing new features in the .xlsx format.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="jmunkberg" When="12/01/2017 17:35:25">
          <Html>
        &lt;div class="markDownOutput "&gt;This post is fairly old now, wondering if the XLSB Format supported in the latest version? If so, how is it implemented?
&lt;br&gt;
&lt;br&gt;
Thank you.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Pivot Table Slicers">
      <Posts>
        <Post From="michaelbradley" When="12/01/2017 12:52:39">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi &lt;br&gt;
Is there functionality in EPPlus to add a slicer(s) to a pivot table. If not is this something that may be added in future releases.
&lt;br&gt;
&lt;br&gt;
Thank you&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="TimeSpan longer than 24 hours">
      <Posts>
        <Post From="n0e" When="09/01/2017 14:14:00">
          <Html>
        &lt;div class="markDownOutput "&gt;I am having problem when there is TimeSpan which is longer than 24 hours. It is displayed on the sheet as trimmed to under 24 hours, for example '30:00:00' is displayed in final xlsx as '6:00:00'.
&lt;br&gt;
&lt;br&gt;
Anyone can patch this or tell me which file to look into?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="File corrupted upon saving">
      <Posts>
        <Post From="docsaintly" When="13/12/2016 10:08:50">
          <Html>
        &lt;div class="markDownOutput "&gt;I have a 9 MB Excel file that loads in and is able to read all data properly. I am even able to edit the data and save the file. However, once I save the file the size is reduced to 5 MB and Excel reports it as corrupted. After repairing it, I can see
 that most formulas that reference other sheets have been replaced with #REF. There are no links to other files.
&lt;br&gt;
&lt;br&gt;
I have simplified my test by just opening and saving the file, and the result is the same. This workbook is quite complex with many references. I suspect this is what is causing the issue.
&lt;br&gt;
&lt;br&gt;
Is there a limit to the "depth" of these inter-sheet references? &lt;br&gt;
&lt;br&gt;
Is there some sort of log that will show me errors that are occurring while saving so I can clean it up?
&lt;br&gt;
&lt;br&gt;
Is there some way to defer the calculation of formulas and do a "write only" to the cells to avoid damaging the formulas?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="docsaintly" When="09/01/2017 08:10:03">
          <Html>
        &lt;div class="markDownOutput "&gt;After cleaning up the file a bit I found this is related to: &lt;a href="http://epplus.codeplex.com/workitem/15538" rel="nofollow"&gt;
http://epplus.codeplex.com/workitem/15538&lt;/a&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Filters in Pivot Table">
      <Posts>
        <Post From="peketo96" When="20/07/2016 21:08:20">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi guys, I recently check this project and it's so good. Well, i have a question: How I can add filters to row or columns fields in Pivot Tables, i saw a property in RowField that names "IncludeNewItemsInFilter", is this something related with
 filters? Thanks in advance.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="PipisCrew" When="02/08/2016 18:48:46">
          <Html>
        &lt;div class="markDownOutput "&gt;I dont know, how you cook it^ &lt;br&gt;
&lt;br&gt;
check my sample at : &lt;br&gt;
&lt;a href="http://bit.ly/2aKOczm" rel="nofollow"&gt;external link&lt;/a&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mmstephenson" When="06/01/2017 05:26:29">
          <Html>
        &lt;div class="markDownOutput "&gt;Assuming you have a List&amp;lt;string&amp;gt; of column names that you want to create filters for and a variable for the pivot table (e.g., pivotTable in the text below), you just add a field to the PageFields collection for each filter that you want to create.
 The sort is optional; if your data is already sorted you can leave it out.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;foreach (string filter in filterColumns)
{
    var field = pivotTable.Fields[filter];
    pivotTable.PageFields.Add(field);
    field.Sort = eSortType.Ascending;
}&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Possible to move to Git?">
      <Posts>
        <Post From="richardtallent" When="06/01/2016 16:39:35">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
I'm curious if the team has considered moving changing from Mercurial to Git? &lt;br&gt;
&lt;br&gt;
My personal experience has been that git a lot easier to work with, especially with the new Visual Studio integration.
&lt;br&gt;
&lt;br&gt;
I'm happy to try to contribute either way, just seeing if the idea had been tossed around yet...&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="08/01/2016 13:15:40">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
we have been discussing this, every now and then we get requests to move from Codeplex to Github and from Mercurial to Git. But so far we are quite happy with Mercurial, we are using VisualHg/TortoiseHg that we think provides a quite good experience in VS.
 Both Jan and myself are using Git/Github in other contexts, so we´ll see what happens in the future. Nothing planned for now though.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="CADbloke" When="19/02/2016 12:34:59">
          <Html>
        &lt;div class="markDownOutput "&gt;Would this convince you to move to Github / Bitbucket? I have been emailing Codeplex's outsource support for months about their broken Hg. They have already admitted they can't fix their SVN - it is beyond broken.&lt;br&gt;
&lt;br&gt;
FYI - KilnHg.com is an easy way to convert for free... &lt;br&gt;
&lt;pre&gt;&lt;code&gt;http://stackoverflow.com/questions/1389307/convert-a-mercurial-repository-to-git/22189212&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/22189212"&gt;#22189212&lt;/a&gt;&lt;/code&gt;&lt;/pre&gt;
.. if this f...n broken website experience isn't enough (it broke that link so I had to quote it as code, FFS)&lt;br&gt;
&lt;br&gt;
or ... duh, the Github importer - &lt;a href="https://import.github.com/new" rel="nofollow"&gt;
https://import.github.com/new&lt;/a&gt;&lt;br&gt;
&lt;br&gt;
Anyway, this is my view of your repo tonight, not for the first time (or first repo)...usually it's a 502...&lt;br&gt;
&lt;pre&gt;&lt;code&gt;hg clone --verbose https://hg.codeplex.com/epplus "D:\CodezOnD\Excel\epplus"
HTTP Error: 500 (URL Rewrite Module Error.)
[command returned code 255 Fri Feb 19 23:24:18 2016]&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Misiu" When="02/11/2016 14:40:59">
          <Html>
        &lt;div class="markDownOutput "&gt;Guys any news on this? &lt;br&gt;
It would be awesome t have this at GitHub. More of us can contribute.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="purekrome" When="22/11/2016 23:14:47">
          <Html>
        &lt;div class="markDownOutput "&gt;@Swmal and @Jan&lt;br&gt;
&lt;br&gt;
the move to Github (or BB if you are not a GH fan) is not so much about you two, but about OSS + community.
&lt;br&gt;
&lt;br&gt;
.&lt;br&gt;
&lt;blockquote&gt;"so far we are quite happy with Mercurial"&lt;br&gt;
&lt;/blockquote&gt;
Sure &lt;em&gt;you two&lt;/em&gt; are happy with HG, etc (and that's totally fine) but most people in the community are not.
&lt;br&gt;
&lt;br&gt;
IMO, if you want to get some really good OSS tracking (e.g. other people forking, fixing, pull requesting) then it really should be migrated to git.&lt;br&gt;
&lt;br&gt;
my 2c, if that helps.&lt;br&gt;
&lt;br&gt;
SIDE NOTE: great work on a really good project.&lt;br&gt;
&lt;br&gt;
-le me-&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="22/12/2016 13:48:45">
          <Html>
        &lt;div class="markDownOutput "&gt;EPPlus moving to Github or Bitbucket has been requested multiple times, in this thread but also in the issue tracker. Perhaps we should explain our standpoint on this and the so called "OSS traction" a little further.
&lt;br&gt;
&lt;br&gt;
First of all - Jan and I are brothers. Jan stared this project in 2010 and has basically written the core of EPPlus alone. After a few years I joined him and did the DataValidation and the formula engine. We both have full time dayjobs and families and whatever
 we do on EPPlus is on our sparetime. We could never predict how widely used EPPlus would become. The millionth download from Nuget happened some months ago and a lot of companies are heavily depending on it. Therefore we try to keep EPPlus as stable as possible
 and tests it throughly ourselves before we release a new version. &lt;br&gt;
&lt;br&gt;
If you look at our discussion forum and the issue tracker you can easily see that we have lost control over this long ago. Same thing goes for Stackoverflow. If we would try to handle this massive flow of questions, issues and feature request we should probably
 have to spend every second of our spare time on it. None of us is interested of "making a name" in the community and we get very few donations to the project in relation to the massive use of it. So we work on it mostly for fun and when we feel like
 it. &lt;br&gt;
&lt;br&gt;
Now, the interaction with the OSS community have so far certainly had its ups and downs. We have had people joining the project just to add a link to their bio somewhere on the Internet. We have had people that has promised to delivered certain features commiting
 half finished work and then suddenly disappears. At one single occation we were actually approached by a person who wanted to deliver a missing major feature (conditional formatting) and then did it. When it comes to pull requests we sometimes get contributions
 with beautiful, clean code with full unit test coverage, those makes us very happy. But we also get pull requests that doesn´t even compile, breaks hundreds of unit tests and then the worst ones - when someone has changed something that seems to makes sense,
 but totally breaks something else. Especially Jan has spent days on these ones. &lt;br&gt;
&lt;br&gt;
What I am trying to say is that we cannot handle more input from the community. We can easily see that moving to github would increase the amount of community input massively and we would not be able to handle that. To be frank, codeplex seems to reduce this
 input massively. &lt;br&gt;
&lt;br&gt;
So to the OSS as a whole - we are totally fine if you fork EPPlus, move it to github, maybe rename it to EPPlusPlus or something else. If you got what it takes you could easily keep a higher speed than we currently do. Or start to help us out here at codeplex
 in a structured way, and we can talk about github later. We could certainly need some help with people answering questions in the forum and fixing issues for us in the issue tracker. Contact Jan, who is the coordinator, via the contact form here on codeplex
 if you want to help out.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Adding columns to a header">
      <Posts>
        <Post From="aashish317" When="20/12/2016 06:11:23">
          <Html>
        &lt;div class="markDownOutput "&gt;Says I have columns A, B and C, I want to insert three columns between B and C, ending up with columns A,B,C,D,E,F. How can i achieve it? Is is possible using EPPlus?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Calculating formulas">
      <Posts>
        <Post From="baal80" When="19/10/2016 16:37:50">
          <Html>
        &lt;div class="markDownOutput "&gt;I am creating a spreadsheet by loading a lot of data from text file. One of the sheets contains around 500 columns and hundred or so rows filled with a (simple) formula.
&lt;br&gt;
&lt;br&gt;
The problem I'm facing is that populating this sheet programmatically takes about a minute, which is too long. I believe it's because everything is recalculated after each insertion?
&lt;br&gt;
&lt;br&gt;
How to simply fill the cell with formula and only let Excel recalculate the formula when the sheet is opened in Excel? It takes several seconds.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="PipisCrew" When="19/12/2016 20:37:42">
          <Html>
        &lt;div class="markDownOutput "&gt;use something like :&lt;br&gt;
&lt;pre&gt;&lt;code&gt;worksheet2.Cells[row, col].Formula = "SUMIFS(DATA!FN:FN,DATA!U:U,\"" + item.PRODUCT_NAME + "\")";&lt;/code&gt;&lt;/pre&gt;
find more example at &lt;a href="http://bit.ly/2aKOczm" rel="nofollow"&gt;external link&lt;/a&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Getting a cellvalue  in workbook slowing the performance in result">
      <Posts>
        <Post From="Hemantguptacest" When="14/11/2016 15:32:17">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi , &lt;br&gt;
dll version : 4.0.5 &lt;br&gt;
I am using countifs formula then calculate function and after that when trying to get the cell value like ( String val22 = (String)SummarysheetModel.Cells[k, 201, k, 201].Value.ToString(); ) , system getting slow at debugging and release mode.
&lt;br&gt;
&lt;br&gt;
I have lots of entries in Excel worksheet and want to calculate each cell and show in new worksheet.
&lt;br&gt;
&lt;br&gt;
Please let me know if this is a correct to get the cell value. &lt;br&gt;
sheet["B3"].Formula = "COUNTIFS(Data!V:V,\"CODE\",Data!AL:AL,\"MODEL\")";
&lt;br&gt;
sheet.Cells[k, 201, k, 201].Calculate(); &lt;br&gt;
String val22 = (String)sheet.Cells[k, 201, k, 201].Value.ToString();&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="16/11/2016 21:12:20">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
could you attach a logger to the formula parser before Calculate() is called? &lt;br&gt;
&lt;br&gt;
&lt;a href="https://epplus.codeplex.com/wikipage?title=About%20Formula%20calculation&amp;amp;referringTitle=Documentation" rel="nofollow"&gt;https://epplus.codeplex.com/wikipage?title=About%20Formula%20calculation&amp;amp;referringTitle=Documentation&lt;/a&gt;
&lt;br&gt;
&lt;br&gt;
Then look in the logfile and share the details of the log here; how many cells are calculated, how long time did the calculation take, etc?
&lt;br&gt;
&lt;br&gt;
Thanks, &lt;br&gt;
&lt;br&gt;
Mats&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Hemantguptacest" When="06/12/2016 14:46:54">
          <Html>
        &lt;div class="markDownOutput "&gt;Thanks for update. &lt;br&gt;
I will check and let you know the log details asap. &lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Regards, &lt;br&gt;
Hemant &lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Slow Access to Sheets in large excel packages">
      <Posts>
        <Post From="MIkeyG0727" When="04/12/2016 21:53:59">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
Fantastic library, cant live without it :) &lt;br&gt;
&lt;br&gt;
I am creating some pretty large spreadsheets to look at data (around 250 Meg) - &lt;br&gt;
&lt;br&gt;
One thing I notice is that when I load sheets , it takes really long - &lt;br&gt;
&lt;br&gt;
Code like: &lt;br&gt;
&lt;br&gt;
var worksheet = package.Workbook.Worksheets["Sheet1"]; &lt;br&gt;
I wouldn't expect that to take so long, is there a better way to get sheets by name?&lt;br&gt;
&lt;br&gt;
Thanks &lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Excel function PMT does not exist">
      <Posts>
        <Post From="tryggvig" When="02/12/2016 11:05:31">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
Im using the Calculate function on a couple of cells that use the PMT function in Excel but it returns #NAME, so my guess is it is not supported.
&lt;br&gt;
&lt;br&gt;
Any chance of including that function in future releases? &lt;br&gt;
&lt;br&gt;
Thanks &lt;br&gt;
&lt;br&gt;
Tryggvi&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Open a shared excel file that's in use">
      <Posts>
        <Post From="tamzak" When="30/11/2016 08:55:35">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
I'd like to know if it's possible to open an excel file thats constantly in use? &lt;br&gt;
&lt;br&gt;
I just need to read some data from it. &lt;br&gt;
If you open it in excel, you get a prompt to just open the file in read only mode. Can I do something similar in code?
&lt;br&gt;
&lt;br&gt;
This: &lt;br&gt;
&lt;br&gt;
using (ExcelPackage xlPackage = new ExcelPackage(existingFile)) &lt;br&gt;
&lt;br&gt;
generates a 'file in use' error. &lt;br&gt;
&lt;br&gt;
Thanks! &lt;br&gt;
Kenneth&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="tamzak" When="30/11/2016 09:23:45">
          <Html>
        &lt;div class="markDownOutput "&gt;Just solved my own question :) &lt;br&gt;
&lt;br&gt;
If anyone is interested : &lt;br&gt;
&lt;br&gt;
Read the file in a filestream where you set the right attributes on the stream. &lt;br&gt;
Then read the stream with excelpackage instead of the file : &lt;br&gt;
&lt;pre&gt;&lt;code&gt;        using (Stream st = new FileStream(fileLocation,
                             FileMode.Open,
                             FileAccess.Read,
                             FileShare.ReadWrite))
        {
            using (ExcelPackage xlPackage = new ExcelPackage(st))
            {
              //code
            }
         }

&lt;/code&gt;&lt;/pre&gt;
Greets, &lt;br&gt;
Kenneth&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="A generic error occurred in GDI+">
      <Posts>
        <Post From="mahendra72" When="24/11/2016 13:12:04">
          <Html>
        &lt;div class="markDownOutput "&gt;I created workflows which generating data in excel files using EPPLUS. these excel files are working fine but suddenly it got error in "&lt;strong&gt;Auto Fit Column method&lt;/strong&gt;". with error of
&lt;strong&gt;"A generic error occurred in GDI+"&lt;/strong&gt; &lt;br&gt;
&lt;br&gt;
Below is the code. &lt;br&gt;
&lt;br&gt;
var stream = Helper.ExportAllData(dTable, null) as MemoryStream; &lt;br&gt;
&lt;br&gt;
***********Helper Class ******************** &lt;br&gt;
&lt;br&gt;
public static class Helper&lt;br&gt;
&lt;pre&gt;&lt;code&gt;{
    internal static Stream ExportAllData(DataTable dt, Stream stream = null)
    {
        //var datarecords = dt
        using (var excelpackage = new ExcelPackage(stream ?? new MemoryStream()))
        {
            excelpackage.Workbook.Properties.Author = "CRM Administrator";
            excelpackage.Workbook.Properties.Title = " Report";
            excelpackage.Workbook.Properties.Comments = "This is an Exported Excel with CRM Data";
            // set some extended property values
            excelpackage.Workbook.Properties.Company = "zv";

            excelpackage.Workbook.Worksheets.Add("Report");
            var worksheet = excelpackage.Workbook.Worksheets[1];
            worksheet.Cells[1, 1].LoadFromDataTable(dt, true);
            //Create an autofilter for the range
            //worksheet.Cells["A1:D" + (dt.Rows.Count + 1)].AutoFilter = true;

            worksheet.Cells.AutoFitColumns(); //  __Error comes in this method__

&lt;/code&gt;&lt;/pre&gt;
*****************Auto fit Column Method *********************** &lt;br&gt;
&lt;br&gt;
public void AutoFitColumns(double MinimumWidth, double MaximumWidth) &lt;br&gt;
{ &lt;br&gt;
&lt;br&gt;
*&lt;br&gt;
&lt;hr&gt;
** &lt;br&gt;
&lt;br&gt;
var nf = styles.Fonts[styles.CellXfs[0].FontId]; &lt;br&gt;
var fs = FontStyle.Regular; &lt;br&gt;
if (nf.Bold) fs |= FontStyle.Bold; &lt;br&gt;
if (nf.UnderLine) fs |= FontStyle.Underline; &lt;br&gt;
if (nf.Italic) fs |= FontStyle.Italic; &lt;br&gt;
if (nf.Strike) fs |= FontStyle.Strikeout; &lt;br&gt;
&lt;br&gt;
var nfont = new Font(nf.Name, nf.Size, fs); __At this line it stops and getting A generic error
&lt;br&gt;
&lt;pre&gt;&lt;code&gt;                                                                                                                  occured in gdi+__
                      *&lt;/code&gt;&lt;/pre&gt;
*&lt;br&gt;
&lt;hr&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Applying MS Excel Chart Styles to generated Charts">
      <Posts>
        <Post From="dk2014" When="22/06/2016 10:45:09">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, first of all thank you for this great tool. &lt;br&gt;
&lt;br&gt;
I need help on applying MS Excel Chart Styles to EPPlus files during export. There are about 10 Styles available for Chart Area in MS Excel. I am using Office 2013. I noticed there are about 48 (and one Undefined) e-ChartStyles available in EPplus but I am
 not getting the same look and feel as the one offered by MS Excel Styles. &lt;br&gt;
&lt;br&gt;
&lt;img alt="Image" src="https://postimg.org/image/z0zfznyyp/"&gt;&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;img alt="Image" src="https://postimg.org/image/hc7p81n7l/"&gt;&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;a href="https://postimg.org/image/hc7p81n7l/" rel="nofollow"&gt;https://postimg.org/image/hc7p81n7l/&lt;/a&gt;&lt;br&gt;
&lt;br&gt;
&lt;a href="https://postimg.org/image/z0zfznyyp/" rel="nofollow"&gt;https://postimg.org/image/z0zfznyyp/&lt;/a&gt;&lt;br&gt;
&lt;br&gt;
Would appreciate any help. &lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="kevindmonte" When="17/11/2016 12:06:49">
          <Html>
        &lt;div class="markDownOutput "&gt;&lt;strong&gt;dk2014 wrote:&lt;/strong&gt;&lt;br&gt;
&lt;blockquote&gt;Hi, first of all thank you for this great tool. &lt;br&gt;
&lt;br&gt;
I need help on applying MS Excel Chart Styles to EPPlus files during export. There are about 10 Styles available for Chart Area in MS Excel. I am using Office 2013. I noticed there are about 48 (and one Undefined) e-ChartStyles available in EPplus but I am
 not getting the same look and feel as the one offered by MS Excel Styles. &lt;br&gt;
&lt;br&gt;
&lt;img alt="Image" src="https://postimg.org/image/z0zfznyyp/"&gt;&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;img alt="Image" src="https://postimg.org/image/hc7p81n7l/"&gt;&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;a href="https://postimg.org/image/hc7p81n7l/" rel="nofollow"&gt;https://postimg.org/image/hc7p81n7l/&lt;/a&gt;&lt;br&gt;
&lt;br&gt;
&lt;a href="https://postimg.org/image/z0zfznyyp/" rel="nofollow"&gt;https://postimg.org/image/z0zfznyyp/&lt;/a&gt;&lt;br&gt;
&lt;br&gt;
Would appreciate any help.&lt;br&gt;
&lt;/blockquote&gt;
Hi, can anyone please help me &lt;br&gt;
&lt;br&gt;
I had also posted this on Stack Overflow. &lt;a href="http://stackoverflow.com/questions/37951998/epplus-excel-pie-chart-style-query" rel="nofollow"&gt;
http://stackoverflow.com/questions/37951998/epplus-excel-pie-chart-style-query&lt;/a&gt;
&lt;br&gt;
&lt;br&gt;
Please advise.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Could not load file or assembly 'EPPlus, Version=4.1.0.0, Culture=neutral, PublicKeyToken=ea159fdaa78159a1' or one of its dependencies. The system cannot find the file specified.">
      <Posts>
        <Post From="deepsachan" When="07/11/2016 06:33:11">
          <Html>
        &lt;div class="markDownOutput "&gt;Could not load file or assembly 'EPPlus, Version=4.1.0.0, Culture=neutral, PublicKeyToken=ea159fdaa78159a1' or one of its dependencies. The system cannot find the file specified.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Access cell by cell name">
      <Posts>
        <Post From="Helbrax" When="04/11/2016 15:54:17">
          <Html>
        &lt;div class="markDownOutput "&gt;In excel you can change the name of a cell from the default "A1", "A2", "A3", etc to something more meaningful like "Payment" or "Salary".
&lt;br&gt;
&lt;br&gt;
It looks like you have to reference the cell by the "A1, A2" naming convention. Is there anyway to access by it's other name("payment", "salary") instead?
&lt;br&gt;
&lt;br&gt;
I can see in the code where the A1 type naming is created but I don't know enough about the open office xml format to understand where the custom names are stored and how to retreive/translate them.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Helbrax" When="05/11/2016 17:53:31">
          <Html>
        &lt;div class="markDownOutput "&gt;Looks like it's just as simple as&lt;br&gt;
&lt;pre&gt;&lt;code&gt; package.Workbook.Names.FirstOrDefault(x =&amp;gt; x.Name == "MyCellName");&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Grouping cells with Subtotals">
      <Posts>
        <Post From="domeg" When="05/11/2016 14:40:31">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
I need to grouping a set of cells including the subtotals. You can find the feature under the Menù Bar Data--&amp;gt;Outline--&amp;gt;Subtotal. Could you please help me on find the classes of EPPlus to use?
&lt;br&gt;
&lt;br&gt;
Thanks&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Cannot save .xlsm file">
      <Posts>
        <Post From="testuser13" When="04/11/2016 13:53:36">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi&lt;br&gt;
I have a file template (.xlsm) what has macro. I would like to create an excel file using the template. For some reason, I got error (Object reference not set to an instance of an object. ) when trying to save&lt;br&gt;
Here is the code&lt;br&gt;
&lt;pre&gt;&lt;code&gt;           HttpContext context = HttpContext.Current;
           FileInfo template = new FileInfo("C:\\test\\EXAMPLE.xlsm");
            MemoryStream ms = new MemoryStream();
            using (ExcelPackage pack = new ExcelPackage(template, true))
            {
                ExcelWorksheet ws = pack.Workbook.Worksheets.Add("SampleTab");  //line1
                ws.Drawings.AddShape("VBASampleRect", eShapeStyle.RoundRect);   //line 2
                pack.SaveAs(ms);
            }
&lt;/code&gt;&lt;/pre&gt;
The error occurs at pack.SaveAs(ms);&lt;br&gt;
If I comment out line1 and line2, it works fine.&lt;br&gt;
&lt;br&gt;
Thanks in advance,&lt;br&gt;
Kim&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Column AutoFit with non-standard DPI settings">
      <Posts>
        <Post From="roverell" When="03/11/2016 06:24:53">
          <Html>
        &lt;div class="markDownOutput "&gt;When using the ExcelColumn.AutoFit method with non-standard DPI settings, the width calculated is incorrect. With a setting of 150% (144dpi), the width is 50% more than it needs to be.
&lt;br&gt;
&lt;br&gt;
It's easy enough to calculate the scaling factor by looking at the system DPI settings and comparing with the default 96dpi, but would be nice to perform this inside EPPlus. This will likely affect row height also but I haven't checked.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Format Negative Numbers In Parenthesis">
      <Posts>
        <Post From="sandarminaye" When="17/10/2016 07:08:26">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello, I am trying to get negative numbers in parenthesis. &lt;br&gt;
&lt;br&gt;
for e.g. &lt;br&gt;
10.30 ===&amp;gt; 10.30 &lt;br&gt;
-10.30 ===&amp;gt; (10.30) &lt;br&gt;
&lt;br&gt;
I tried with below syntax but still not get right format. &lt;br&gt;
ws.Cells[].Style.Numberformat.Format = "(#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00)"; &lt;br&gt;
&lt;br&gt;
Kindly help me. Thanks.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Formula Calulate doen't return a value  if decimal">
      <Posts>
        <Post From="andreoslancio" When="14/10/2016 16:33:38">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello, &lt;br&gt;
I'm trying to get the value of some cells where there is a formula that return integers and decimals.
&lt;br&gt;
After calculate the formula I have no problem to get integer values, I have 0 when the the cells work with decimal values.
&lt;br&gt;
Here is an extract of my code:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;for (int i = 6; i &amp;lt; 10; i++)
            {
                ws.Cells[posY + 1, posX + i + 1].Formula = "IFERROR(SUMPRODUCT(" + getExcelColumnName(posX + 1 + i) + "" + (posY + 2) + ": " + getExcelColumnName(posX + 1 + i) + "" + (posY + 25) + ", " + getExcelColumnName(posX + 2) + "" + (posY + 2) + ": " + getExcelColumnName(posX + 2) + "" + (posY + 25) + ")/" + getExcelColumnName(posX + 2) + "" + (posY + 1) + ", 0)";
                ws.Cells[posY + 1, posX + i + 1].Calculate();
            }
using (var range = ws.Cells[posY + 1, posX + 6 + 1, posY + 25, posX + 15])
            {
                range.Style.Numberformat.Format = "0.00"; 
            }
for (int x = 0; x &amp;lt; 14; x++)
            {
                Console.WriteLine(ws.Cells[posY + 1, posX + x + 1].Value);
            }&lt;/code&gt;&lt;/pre&gt;
I've tried to parse to double, to work with strings, I don't know what to do more.
&lt;br&gt;
Did anyone of you face a similar problem? &lt;br&gt;
Thanks, in advance.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="andreoslancio" When="14/10/2016 17:00:54">
          <Html>
        &lt;div class="markDownOutput "&gt;Found the issue by myself: FORMULAS MUST NOT CONTAIN SPACES!!!!!! If you look in the code i had ...+ ": " + ... (a space after the semicolon).
&lt;br&gt;
Hope this can help.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Running EPPlusSamples project for first time">
      <Posts>
        <Post From="yhpoon" When="10/10/2016 04:46:44">
          <Html>
        &lt;div class="markDownOutput "&gt;When I try to run the project, the console shows &lt;em&gt;"outputDir does not exist!"&lt;/em&gt;
&lt;br&gt;
&lt;br&gt;
I suggest the documentation to add in an instruction to ask the developer who just downloaded and run the solution for first time to change the output path for the file
&lt;strong&gt;Sample_Main.cs&lt;/strong&gt; (line 49) to their preferred folder path.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;DirectoryInfo outputDir = new DirectoryInfo(@"C:\Users\yhpoon\Documents\Visual Studio 2015\Projects\SampleApp\temp");    // c:\temp\SampleApp&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="yhpoon" When="10/10/2016 08:17:30">
          <Html>
        &lt;div class="markDownOutput "&gt;In order to run Sample 3, 4 and 12 with AdventureWorks sample database, I modified the code as following:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;string SqlServerName = @".\SQLEXPRESS";&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="very ba doc">
      <Posts>
        <Post From="stefanomnn" When="09/10/2016 14:32:50">
          <Html>
        &lt;div class="markDownOutput "&gt;ops... documentation doesn't exist! &lt;br&gt;
i prefer to pay something but having a good and easy documented product, &lt;br&gt;
rather than a free but undocumented product &lt;br&gt;
&lt;br&gt;
i spent one hour to understund how to set active worksheet... your model class is simply horrible.
&lt;br&gt;
&lt;br&gt;
i hope o should never use your product in the future&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Generating Excel - missing theme1.xml">
      <Posts>
        <Post From="Chrzciciel" When="04/10/2016 16:50:01">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi! &lt;br&gt;
When I generate .xlsx file, xl\theme\theme1.xml file is missing. I don't want to code to zip it into the file and I was wandering is there any way to force epplus to create this file inside the excel file when creating it? I need this because 3rd part software
 converts this file later on and it asks for this xml.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Excel 2013 or 2016/O365?">
      <Posts>
        <Post From="klugerama" When="30/09/2016 18:27:45">
          <Html>
        &lt;div class="markDownOutput "&gt;I've made quite a few customizations to the code - all in charts - for my own use (series data labels, tick label rotation, error bars, bar series overlap, line dash for line series, etc). A few of these properties are new in Office 2013 - I think - and
 one even refers to Office 2016. &lt;br&gt;
&lt;br&gt;
Is there interest in adding those namespaces and functionality? &lt;br&gt;
&lt;br&gt;
I'd love to contribute what I've done, but the main page still says "Create advanced Excel 2007/2010 spreadsheets...". I don't want to create a pull request to submit these changes if the latest versions of Excel are not going to be supported.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Can you load XLTX">
      <Posts>
        <Post From="mettlus" When="27/09/2016 16:42:34">
          <Html>
        &lt;div class="markDownOutput "&gt;I have a CSV file and I want to apply a XLTX and save the final target as XLSX
&lt;br&gt;
I can do it manually, is there a way I can do it programatically? &lt;br&gt;
&lt;br&gt;
Thanks&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Assembly.LoadFrom doesn't work (4.04 -&amp;gt; 4.1).">
      <Posts>
        <Post From="Grzesiek23" When="27/09/2016 14:51:44">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello, &lt;br&gt;
&lt;br&gt;
Long time I was loading EPPlus library from the code:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;Assembly.LoadFrom(Utilities.GetMainDirectory + @"\Modules\Libraries\EPPlus.dll");&lt;/code&gt;&lt;/pre&gt;
This worked correctly with version 4.0.4. &lt;br&gt;
&lt;br&gt;
Today I thought, that I will update EPPlus to 4.1. &lt;br&gt;
Unfortunately all code is stoped now at this line. &lt;br&gt;
In outputs in Visual Studio, the only message is:&lt;br&gt;
&lt;blockquote&gt;'System.IO.FileLoadException' in mscorlib.dll&lt;br&gt;
&lt;/blockquote&gt;
Anyone can help me? What I'm doing wrong? &lt;br&gt;
In References I have "Copy Local" and "Specific version" set to False.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Trendline Properties">
      <Posts>
        <Post From="rbelknap" When="25/09/2016 23:07:34">
          <Html>
        &lt;div class="markDownOutput "&gt;Is there a way to modify the properties of a trend line? For instance the width or color?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="WEEKNUM &amp;lt;-works in formula vs ISOWEEKNUM &amp;lt;- does not work.">
      <Posts>
        <Post From="rbelknap" When="23/09/2016 21:24:58">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
If I use the code:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;worksheet.Cells["A" + i].Formula = "=WEEKNUM(B" + i + ")";&lt;/code&gt;&lt;/pre&gt;
my spreadsheet properly displays the WEEKNUM as calculated by =WEEKNUM(B2) &lt;br&gt;
&lt;br&gt;
However, if I use the code:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;worksheet.Cells["A" + i].Formula = "=ISOWEEKNUM(B" + i + ")";&lt;/code&gt;&lt;/pre&gt;
my spreadsheet displays. #NAME? stating an invalid name. The weird thing is that in the cell, it displays correctly as =ISOWEEKNUM(B2) and if I click on the cell and then click on the formula bar and press [enter] Excel displays the correct ISOWEEKNUM. (Without
 changing anything.) &lt;br&gt;
&lt;br&gt;
Is this a problem with Excel or Epplus? Any suggestions on how to workaround? &lt;br&gt;
&lt;br&gt;
Thanks in advance... &lt;br&gt;
&lt;br&gt;
Robert&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Size limitations in creating excel sheets">
      <Posts>
        <Post From="ThorPeto" When="22/09/2016 17:08:41">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi all &lt;br&gt;
&lt;br&gt;
I am considering this library for creating excel sheets in C# code. I wonder if there are any size limitations in how many rows can be generated in an xls sheet. I have been using excellib which is rather old, there I get memory problems when creating sheets
 with more than 200 thousand rows. Files that might be 100 - 200 Mb. should not be a proplem. I did it with CSV files, but I want to use regular xls sheets to preserve the numerical precision in the data.
&lt;br&gt;
&lt;br&gt;
regards &lt;br&gt;
&lt;br&gt;
Thor&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Formula is not working in Excel 2010 - Error message #¿NOMBRE? showed">
      <Posts>
        <Post From="leandrol" When="22/09/2016 15:41:58">
          <Html>
        &lt;div class="markDownOutput "&gt;I insert in the code the next line: &lt;br&gt;
.....Formula = String.Format("SUMA({0}:{1})", workSheet.Cells(Row + 1, col).Address, workSheet.Cells(Roe + totalRows, col).Address).ToUpper.Trim
&lt;br&gt;
&lt;br&gt;
--&amp;gt; Result: =SUMA(D3:D3) &lt;br&gt;
&lt;br&gt;
In the excel export the cell show the next message (Spanish version): #¿NOMBRE? &lt;br&gt;
&lt;br&gt;
But when I click on the formula and then click outside the formula appear without error.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="[Merge Request]Adding the possibility to obtain the width and height of an ExcelDrawing">
      <Posts>
        <Post From="Baccata" When="20/09/2016 09:51:07">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi guys,&lt;br&gt;
&lt;br&gt;
I'm using EPPlus to get some information from an Excel spreadsheet.&lt;br&gt;
&lt;br&gt;
One of this information is the size of an Excel shape. For inexplicable reasons I can only see the size of the width and height of an ExcelDrawing object while debugging using this fields:&lt;br&gt;
&lt;br&gt;
protected internal int _width&lt;br&gt;
and&lt;br&gt;
protected internal int _height&lt;br&gt;
&lt;br&gt;
I ended up using reflection within an extension method to get both values at runtime, which works like a charm. But we all know, that reflection comes with a bit of an overhead.&lt;br&gt;
&lt;br&gt;
Long story short - please add the following two read-only properties to the ExcelDrawing class:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;        /// &amp;lt;summary&amp;gt;
        /// Returns the height of this drawing. This field is read-only.
        /// &amp;lt;/summary&amp;gt;
        public int GetHeigth
        {
            get
            {
                return this._height;
            }
        }

        /// &amp;lt;summary&amp;gt;
        /// Returns the width of this drawing. This field is read-only.
        /// &amp;lt;/summary&amp;gt;
        public int GetWidth
        {
            get
            {
                return this._width;
            }
        }&lt;/code&gt;&lt;/pre&gt;
I would have created a proper merge request, but I'm unable to install Mercurial on my device.&lt;br&gt;
&lt;br&gt;
Kind regards&lt;br&gt;
Baccata&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to hide custom style names in Excel ?">
      <Posts>
        <Post From="donepudi" When="15/09/2016 09:43:40">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
I'm creating programatically more custom styles using Styles.CreateNamedStyle method and Excel report is very good.
&lt;br&gt;
&lt;br&gt;
The users can see all custom styles in Styles tab, is there any property to hide these styles ?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Formula not working when the formulas are in a table">
      <Posts>
        <Post From="Vsambhe" When="12/09/2016 16:38:59">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
&lt;br&gt;
I want to create a copy of a excel file [p.xlsx]. It has two spreadsheets - sheet1 and sheet2. I create another file perror.xlsx by using p.xlsx as a template file.
&lt;br&gt;
&lt;br&gt;
Sheet1 data is as follows (second column has a formula): &lt;br&gt;
COL1, COl2 &lt;br&gt;
MICK1,=A2 &lt;br&gt;
MICk2,=A3 &lt;br&gt;
&lt;br&gt;
The data in the Sheet1 is defined as a table - Table1 =$A:$B &lt;br&gt;
&lt;br&gt;
Sheet2 is "not defined" as a table, the data again is same &lt;br&gt;
&lt;br&gt;
COL1, COl2 &lt;br&gt;
MICK1,=A2 &lt;br&gt;
MICk2,=A3 &lt;br&gt;
&lt;br&gt;
Executed the code as follows:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;        string ErrFileName = @"C:\\TEMP\\pErrors.xlsx";  //Destination file
        FileInfo errorFile = new FileInfo(ErrFileName);

        string templatefile = @"C:\\TEMP\\p.xlsx";   //Source file
        FileInfo template = new FileInfo(templatefile);

        ExcelPackage errorExcelFile = new ExcelPackage(errorFile, template);

        errorExcelFile.Save();
        errorExcelFile.Dispose();

&lt;/code&gt;&lt;/pre&gt;
When I open the perror.xlsx file, I see the data in the sheet1 as &lt;br&gt;
COL1, COl2 &lt;br&gt;
MICK1,MICK1 &lt;br&gt;
MICk2,MICK1 &lt;br&gt;
&lt;br&gt;
Analyzed the formula so it was found as: &lt;br&gt;
COL1, COl2 &lt;br&gt;
MICK1,=A2 &lt;br&gt;
MICk2,=A2 &lt;br&gt;
&lt;br&gt;
But the sheet2 was populated properly. &lt;br&gt;
COL1, COl2 &lt;br&gt;
MICK1,MICK1 &lt;br&gt;
MICk2,MICK2 &lt;br&gt;
&lt;br&gt;
So does that mean the EPPLUS does not bring the formula correctly when the data is in the table?
&lt;br&gt;
&lt;br&gt;
I could bring the data correctly in the sheet1 only when in the source file I opened it in excel clicked on sheet1, visited Design menu, convert to range, saved.
&lt;br&gt;
&lt;br&gt;
Let me know please how to bring the data correctly when the formula is in a table?
&lt;br&gt;
&lt;br&gt;
Thanks, &lt;br&gt;
&lt;br&gt;
Vijay&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Vsambhe" When="13/09/2016 10:20:31">
          <Html>
        &lt;div class="markDownOutput "&gt;When the data was in a table, the formula need to be changed in the COL2 in the Excel file
&lt;br&gt;
&lt;br&gt;
COL1, COl2 &lt;br&gt;
&lt;br&gt;
MICK1,=[COL1] &lt;br&gt;
&lt;br&gt;
MICk2,=[COL1] &lt;br&gt;
&lt;br&gt;
It brought the correct result.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Reading the Used Range">
      <Posts>
        <Post From="talktodale" When="09/03/2016 21:59:59">
          <Html>
        &lt;div class="markDownOutput "&gt;After I open the Excel spreadsheet is there a way to determine the USED Cell Range like there is in the Excel Interop tools?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="freedevc" When="29/05/2016 04:30:02">
          <Html>
        &lt;div class="markDownOutput "&gt;A straightforward approach is to base on the first start cell &amp;amp; the last end cell.
&lt;br&gt;
Hope it helps :)&lt;br&gt;
&lt;pre&gt;&lt;code&gt;using (ExcelPackage package = new ExcelPackage(new FileInfo(file)))
                {
                   var cells = package.Workbook.Worksheets[1].Cells;
                   var start = cells.First().Start; // find first initialized cell
                   var end = cells.Last().End; // find the last initialized cell
                   int startRow = start.Row;
                   int startColumn = start.Column;
                   int endRow = end.Row;
                   int endColumn = end.Column;

                   List&amp;lt;MyModel&amp;gt; models = new List&amp;lt;MyModel&amp;gt;(endRow - startRow);
                   int curRowIndex = startRow;
                   MyModel model = new MyModel();
                   foreach (var cell in cells)
                   {
                       if (cell.Start.Row != curRowIndex) // difference row =&amp;gt; requires a new instance of MyModel
                       {
                           model = new MyModel();
                           curRowIndex = cell.Start.Row;
                           models.Add(model);
                       }
                       PopulateModel(model, cell);
                   }
                }

private void PopulateModel(MyModel model, ExcelRangeBase cell)
        {
            switch(cell.Start.Column)
            {
                case 1:
                    {
                        model.Id = Convert.ToInt64(cell.Value);
                        break;
                    }
                case 2:
                    {
                        model.Name = Convert.ToString(cell.Value);
                    }
                    //
                    //
            }
        }&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="NielsPeterGibe" When="08/07/2016 09:39:28">
          <Html>
        &lt;div class="markDownOutput "&gt;Sadly, that method won't work, if you have blanked cells. &lt;br&gt;
Say, that you have a worksheet containing 10 rows of data - from 1 to 10. In your code, startRow will equal 1 and endRow equals 10.
&lt;br&gt;
If you then delete (using the delete key, so i guess the correct term is "blank the content") the 8 last row in the worksheet and run the code again, they you will still see, that endRow contains the value 10.
&lt;br&gt;
If you mark the 8 columns, right click and choose delete, then endRow contains the expected value 2 and not 10.
&lt;br&gt;
&lt;br&gt;
It is an annoying "feature" of Excel. I would really like to know the dimensions of the sheet, that contains REAL data, and not just formatted cells&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="freedevc" When="13/07/2016 01:18:22">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi,&lt;br&gt;
It was just a way to loop through the used range of cells.&lt;br&gt;
In your case (blanked cells), the main magic should be done inside PopulateModel to ignore or specially handle blank row(s)/cell(s)&lt;br&gt;
&lt;br&gt;
I'm not saying that the method can handle all scenarios but for case by case we can add some tricks :)&lt;br&gt;
&lt;br&gt;
Cheers,&lt;br&gt;
Doanh&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="BillMenees" When="08/09/2016 18:24:43">
          <Html>
        &lt;div class="markDownOutput "&gt;You should also consider Worksheet.Dimension. Its Start and End properties get the top left and bottom right cells used on a worksheet. See this discussion:
&lt;a href="http://epplus.codeplex.com/discussions/257072" rel="nofollow"&gt;http://epplus.codeplex.com/discussions/257072&lt;/a&gt;.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Windows form is resized when setting size/location of image/chart/row in excel worksheet">
      <Posts>
        <Post From="midddle" When="01/09/2016 09:02:09">
          <Html>
        &lt;div class="markDownOutput "&gt;I'm using epplus to export excel files from a windows forms application. It all works fine except if I run the application on a laptop with non standard font size, the form is resized when I modify certain things in the generated excel worksheets, e.g.
 position an image, resize a chart or set height of a row. What can be the reason, and how to prevent this from happening?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="midddle" When="01/09/2016 10:06:40">
          <Html>
        &lt;div class="markDownOutput "&gt;Found the problem: it seems some libraries are loaded in these situations that change the dpi awareness of the process (see
&lt;a href="http://www.telerik.com/blogs/winforms-scaling-at-large-dpi-settings-is-it-even-possible-" rel="nofollow"&gt;
http://www.telerik.com/blogs/winforms-scaling-at-large-dpi-settings-is-it-even-possible-&lt;/a&gt;). The solution is to change dpi awareness (for me it was sufficient to call it in the form's constructor):
&lt;br&gt;
&lt;br&gt;
[DllImport("shcore.dll")] &lt;br&gt;
static extern int SetProcessDpiAwareness(int value); &lt;br&gt;
&lt;br&gt;
SetProcessDpiAwareness(0)&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Does EPPlus supports Excel's Goal seek feature?">
      <Posts>
        <Post From="Nsb_MarkB" When="29/08/2016 02:34:39">
          <Html>
        &lt;div class="markDownOutput "&gt;Looks like EPPlus supports a lot of Excel features that would be helpful to me. I don't see Goal Seek on the list. Is Goal Seek supported? If so, please, advise. Otherwise, is there a way to encourage support for Goal Seek?
&lt;br&gt;
&lt;br&gt;
Thanks, Mark&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Formula for comparing values from two different worksheets">
      <Posts>
        <Post From="mmn_stellar" When="01/07/2016 22:55:56">
          <Html>
        &lt;div class="markDownOutput "&gt;I am creating a workbook that consists of two worksheets. The data from the first sheet is just output from the database for certain weeks, whereas the second worksheet contains a different set of data from different weeks from the database and additionally
 columns added with formulas to compare to the data in the first worksheet to see the differences.
&lt;br&gt;
&lt;br&gt;
When writing the code &lt;br&gt;
&lt;br&gt;
Worksheet2.Cells(row, newColumn).Formula = "=" &amp;amp; Worksheet2.Cells(row, column).FullAddress &amp;amp; "-" &amp;amp; WorkSheet1.Cells(row, column).FullAddress
&lt;br&gt;
&lt;br&gt;
When using .Value for the Cell instead of .Formula, I get the correct formula outputted as text to the worksheet, but when I switch it to .Formula, it seems to remove the worksheet names.
&lt;br&gt;
&lt;br&gt;
&lt;strong&gt;.Text version:&lt;/strong&gt; ='2016-03-27 to 2016-04-09'!H2-'2016-03-13 to 2016-03-26'!H2
&lt;br&gt;
'2016-03-27 to 2016-04-09' is the worksheet name &lt;br&gt;
&lt;br&gt;
&lt;strong&gt;.Formula version:&lt;/strong&gt; =H2-H2 &lt;br&gt;
&lt;br&gt;
It appears that the Formula only supports inter-worksheet cells being specified. Is there a way to get the Formulas to work with across worksheets within a same workbook?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="08/07/2016 16:55:41">
          <Html>
        &lt;div class="markDownOutput "&gt;I am not sure if I understand your problem entirely, but there should not be any problem to reference data between worksheets.
&lt;br&gt;
&lt;br&gt;
Anyways, you should remove the leading "=" from the formula. &lt;br&gt;
&lt;br&gt;
/Mats&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="PipisCrew" When="02/08/2016 18:50:55">
          <Html>
        &lt;div class="markDownOutput "&gt;I think you searching for function &lt;strong&gt;VLOOKUP&lt;/strong&gt; &lt;br&gt;
&lt;a href="http://bit.ly/2attRxa" rel="nofollow"&gt;external link&lt;/a&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="vijayagarwal" When="18/08/2016 15:50:57">
          <Html>
        &lt;div class="markDownOutput "&gt;&lt;a href="http://www.talktalkwebmail.org/2016/08/talktalk-webmail-talktalk-mail-login-signup.html" rel="nofollow"&gt;http://www.talktalkwebmail.org/2016/08/talktalk-webmail-talktalk-mail-login-signup.html&lt;/a&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Does not seem to support SSRS Charts">
      <Posts>
        <Post From="firasjabur" When="09/08/2016 21:02:08">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
So I am using .net Microsoft.Reporting.WinForms.LocalReport to render Stream of bytes of an xlsx file with Image Charts (designed with SSRS)
&lt;br&gt;
I am then converting to an ExcelPackage: &lt;br&gt;
&lt;br&gt;
var excelDoc = new ExcelPackage(Stream); &lt;br&gt;
&lt;br&gt;
excelDoc.Save(); &lt;br&gt;
But, when I attempt to Save, it throws an exception &lt;br&gt;
&lt;br&gt;
"An exception of type 'System.Collections.Generic.KeyNotFoundException' occurred in EPPlus.dll but was not handled in user code
&lt;br&gt;
&lt;br&gt;
Additional information: The given key was not present in the dictionary." &lt;br&gt;
&lt;br&gt;
Note: this only happens when the xlsx Stream contains Charts (charts are rendered as images)&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="vijayagarwal" When="18/08/2016 15:50:35">
          <Html>
        &lt;div class="markDownOutput "&gt;&lt;a href="http://www.talktalkwebmail.org/2016/08/talktalk-webmail-talktalk-mail-login-signup.html" rel="nofollow"&gt;http://www.talktalkwebmail.org/2016/08/talktalk-webmail-talktalk-mail-login-signup.html&lt;/a&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Symbols for the module 'EPPlus.dll' were not loaded. No Worksheets visible in Excel 2013">
      <Posts>
        <Post From="aktivo" When="17/08/2016 13:40:09">
          <Html>
        &lt;div class="markDownOutput "&gt;I build web application with this code:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;ExcelPackage EP = new ExcelPackage();
            ExcelWorkbook EW = EP.Workbook;
            ExcelWorksheet wsUsers = EW.Worksheets.Add( "Users" );
            ExcelWorksheet wsGroups = EW.Worksheets.Add( "Groups" );
            ExcelWorksheet wsRelation = EW.Worksheets.Add( "Relation" );

            wsUsers.Cells[ 1, 1 ].Value = "ID USER";
            wsUsers.Cells[ 1, 2 ].Value = "FIRST NAME";
            wsUsers.Cells[ 1, 3 ].Value = "LAST NAME";

            wsUsers.View.FreezePanes( 2, 1 );

            ExcelRange ER = wsUsers.Cells[ "A1:C1" ];
            ER.Style.Font.Name = "Arial";
            ER.Style.Font.Size = 20;
            ER.Style.Font.Bold = true;

            Response.BinaryWrite( EP.GetAsByteArray() );
            Response.ContentType = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";
            Response.AddHeader( "content-disposition", "attachment;  filename=ExcelDemo.xlsx" );&lt;/code&gt;&lt;/pre&gt;
After start web application, visual studio 2013 says: "Symbols for the module 'EPPlus.dll' were not loaded." ... Web application started. After click on button, code will create excel file.
&lt;br&gt;
But after open it - no worksheets visible in Excel 2013 (no errors, no worksheets).
&lt;br&gt;
In Excel 2007 says: &lt;br&gt;
Program Excel found unreadable content in 'ExcelDemo.xlsx'. Do you want to repair ? ...
&lt;br&gt;
After repair it - i will see what i was expected.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="vijayagarwal" When="18/08/2016 15:49:35">
          <Html>
        &lt;div class="markDownOutput "&gt;o I am using .net Microsoft.Reporting.WinForms.LocalReport to render Stream of bytes of an xlsx file with Image Charts (designed with SSRS)
&lt;br&gt;
``` I am then converting to an ExcelPackage: &lt;a href="http://www.talktalkwebmail.org/2016/08/talktalk-webmail-talktalk-mail-login-signup.html" rel="nofollow"&gt;
http://www.talktalkwebmail.org/2016/08/talktalk-webmail-talktalk-mail-login-signup.html&lt;/a&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Pivot table creation from downloaded excel file does not give expected result">
      <Posts>
        <Post From="mohnkhan97" When="31/07/2016 15:22:35">
          <Html>
        &lt;div class="markDownOutput "&gt;We are allowing user to download the report as an excel format, we are using epplus to provide the end user the download facility. When user download the report as an excel format and try to create a Pivot Table then they empty cells are also consider
 in the count. &lt;br&gt;
&lt;br&gt;
But after downloading the excel and user manually select the excel cell with empty value and press the delete button then pivot table gives the expected result.
&lt;br&gt;
&lt;br&gt;
I think epplus add an empty value in the cell for the null field but it should keep the cell as blank.
&lt;br&gt;
&lt;br&gt;
Is there any work around to fix this issue.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="PipisCrew" When="02/08/2016 18:46:37">
          <Html>
        &lt;div class="markDownOutput "&gt;I dont know, how you cook it^ &lt;br&gt;
&lt;br&gt;
check my sample at : &lt;br&gt;
&lt;a href="http://bit.ly/2aKOczm" rel="nofollow"&gt;external link&lt;/a&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Problem with row header that has a line feed">
      <Posts>
        <Post From="faujong" When="27/07/2016 21:09:12">
          <Html>
        &lt;div class="markDownOutput "&gt;I have XLS file whose column header has a line feed (char(10)) &lt;br&gt;
"Open/ &lt;br&gt;
Closed" &lt;br&gt;
&lt;br&gt;
I refer to it on the pivot table and add it to RowFields. &lt;br&gt;
But, when I open the XLS file, it didn't add that to the pivot table. &lt;br&gt;
How can I fix it ? &lt;br&gt;
&lt;br&gt;
var OpenClosedField = pivotTable1.Fields[1]; //--&amp;gt; this is the column whose header has the line feed
&lt;br&gt;
pivotTable1.RowFields.Add(OpenClosedField); &lt;br&gt;
var countField = pivotTable1.Fields[1]; &lt;br&gt;
pivotTable1.DataFields.Add(countField); &lt;br&gt;
pivotTable1.DataFields[0].Function = OfficeOpenXml.Table.PivotTable.DataFieldFunctions.Count;
&lt;br&gt;
package.Save(); &lt;br&gt;
&lt;br&gt;
Thank you.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Erreur when deploying DLL on the server">
      <Posts>
        <Post From="Shadwise" When="27/07/2016 17:27:37">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi,&lt;br&gt;
&lt;pre&gt;&lt;code&gt;I receive this error when I try to access to my page :  'First' is not a member of 'OfficeOpenXml.ExcelWorksheets'.

Here is a sample of my code :

 Dim wksWorkSeet As ExcelWorksheet = xlPackage.Workbook.Worksheets.First &amp;lt;-- This line made the error
 wksWorkSeet.Name = "welcome letter Report"
 Dim dttTableInfo As DataTable

  My Server is Windows Server 2012 and we have install FrameWork 3.5.
  I just put the DLL into my Bin repertory of my websites.
&lt;/code&gt;&lt;/pre&gt;
Anyone have an Idea to what can give me this error. &lt;br&gt;
&lt;br&gt;
Everything work fine on other Server with Windows Server 2012 also. &lt;br&gt;
&lt;br&gt;
Thanks you&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Bug in Source Code">
      <Posts>
        <Post From="csribeiro" When="19/07/2016 15:42:50">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello people, the actual source code not compile.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="20/07/2016 00:06:28">
          <Html>
        &lt;div class="markDownOutput "&gt;Thanks for the heads up, I will have a look!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="20/07/2016 03:27:58">
          <Html>
        &lt;div class="markDownOutput "&gt;I just cloned the &lt;a href="https://hg.codeplex.com/epplus" rel="nofollow"&gt;https://hg.codeplex.com/epplus&lt;/a&gt; and compiled it without errors.
&lt;br&gt;
&lt;br&gt;
What kind of error do you get?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="csribeiro" When="21/07/2016 12:56:33">
          <Html>
        &lt;div class="markDownOutput "&gt;I'm sorry, I'm using vs2013 and I realized that this version is designed for C # 6.0. Some commands are not recognized in the previous version. There is a version for C # 5.0?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="27/07/2016 12:19:27">
          <Html>
        &lt;div class="markDownOutput "&gt;No, sorry - C# 6 only.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Copy validation">
      <Posts>
        <Post From="sable102" When="20/07/2016 05:26:41">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi. I copy cells&lt;br&gt;
&lt;pre&gt;&lt;code&gt; ws.Cells[rowIdxStart, 1, rowIdxEnd, colCount].Copy(ws.Cells[rowIdx, 1]);&lt;/code&gt;&lt;/pre&gt;
How to copy the data validation of the "base" cells to the copied cells?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="20/07/2016 14:07:49">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
unfortunately datavalidations are not copied in this function. You have to recreate them for the new cells.
&lt;br&gt;
&lt;br&gt;
Datavalidations are always on worksheetlevel, so you have to find out if there are any datavalidation colliding with your cellrange and then you have to decide how you want to handle collisions of types exact match(Equal), Partly and Inside the range your copying.
&lt;br&gt;
&lt;br&gt;
We could probably make this easier to copy in future releases, but for the moment the only thing you can do is to copy the data validations "the hard way". In this example I only copy datavalidations if the range of the datavalidations are exactly
 the same as the range you are copying. You could easily change this behaviour in the DataValidations.FindAll call.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;var validations = sheet1.DataValidations.FindAll(
    x =&amp;gt; x.Address.Collide(new ExcelAddressBase("A1:C3")) == ExcelAddressBase.eAddressCollition.Equal);
foreach (var validation in validations)
{
    switch (validation.ValidationType.Type)
    {
        case eDataValidationType.List:
            var sourceListValidation = (IExcelDataValidationList) validation;
            var newListValidation = sheet1.DataValidations.AddListValidation("D1:F3");
            // copy field for field
            newListValidation.ErrorStyle = sourceListValidation.ErrorStyle;
            newListValidation.Error = sourceListValidation.Error;
            // and so on...
            break;
    }
}&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Get columnType as a date from worksheet cell">
      <Posts>
        <Post From="blueGiraffe" When="12/07/2016 15:26:17">
          <Html>
        &lt;div class="markDownOutput "&gt;I've noticed that for Date cells the Text Value will be "07/02/2016" but the Value will be a number "377002". I assume this is because Excel stores dates internally as a number masked to a date. Is there a way to reliably detect if
 a cell is a "date"? That way I can use the textValue (for everything else I think I just want value).
&lt;br&gt;
&lt;br&gt;
So far my only guess is to try and parse the format (looking for "dd", "mm", etc.) but I'd love something a little more reliable.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Would like to disable compatibility check when creating a worksheet">
      <Posts>
        <Post From="fai1012" When="12/07/2016 11:27:35">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi all, I am using EPPlus to generate .xlsx in a Http request. &lt;br&gt;
After adding list validation, it will prompt me the compatibility checker. How can i disable that checker when i create my workbook? Thanks in advance!
&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Lost data from Name when insert Row">
      <Posts>
        <Post From="gabry90" When="29/06/2016 17:39:55">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, new merged version 28/06/2016 have an issue with named range. &lt;br&gt;
&lt;br&gt;
After inserting new 58 rows the named ranged "'example_page'!$A$11" becomes "A69" instead "'example_page'!$A$69" (as it was before last commit). So it does not keep the full format. Please can investigate?
&lt;br&gt;
&lt;br&gt;
tnks&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Setting Password For Excel Spreadhsheet">
      <Posts>
        <Post From="YipeYaYeah" When="29/06/2016 06:38:51">
          <Html>
        &lt;div class="markDownOutput "&gt;I am currently trying to set password for my generated excel from my ASP.net web app
&lt;br&gt;
My source code are as below:&lt;br&gt;
&lt;pre&gt;&lt;code&gt; protected void ExportBtn_Click(object sender, System.EventArgs e)
{
    ExcelPackage excel = new ExcelPackage();
    var workSheet = excel.Workbook.Worksheets.Add("test");

    using (var memoryStream = new MemoryStream())
    {


        Response.Clear();
        Response.ClearHeaders();
        Response.ContentType = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";
        Response.AddHeader("content-disposition", "attachment;  filename=Test.xlsx");


        excel.SaveAs(memoryStream , "Password");

        memoryStream.WriteTo(Response.OutputStream);
        Response.Flush();
        Response.End();
    }

}

&lt;/code&gt;&lt;/pre&gt;
I have tried using the above codes to generate a password protected excel spreadsheet, however after entering the correct password, I am faced with an error:
&lt;br&gt;
&lt;br&gt;
Excel cannot open the file 'filename.xlsx' because the file format for the file extension is not valid. Verify that the file has not been corrupted and that the file extension matches the format of the file
&lt;br&gt;
&lt;br&gt;
I have tried changing this line of source code and it works perfectly &lt;br&gt;
&lt;pre&gt;&lt;code&gt; excel.SaveAs(memoryStream);
&lt;/code&gt;&lt;/pre&gt;
Can anyone tell me what's wrong and how to generate a password protect excel spreadsheet. Any help will be greatly appreciated&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Setting range value in bulk with 2D object array">
      <Posts>
        <Post From="upretiraman" When="23/06/2016 13:41:05">
          <Html>
        &lt;div class="markDownOutput "&gt;I am using Microsoft.Office.Interop.Excel to copy a 2D object array to a predefined range in an excelsheet.
&lt;br&gt;
&lt;br&gt;
Here is the code: &lt;br&gt;
Excel.Range r1 = (Excel.Range)xlWorkSheet.Cells[1, 1]; &lt;br&gt;
Excel.Range r2 = (Excel.Range)xlWorkSheet.Cells[50000, 4]; &lt;br&gt;
Excel.Range range = xlWorkSheet.get_Range(r1, r2); &lt;br&gt;
&lt;br&gt;
object[,] myArray = new object[50000, 4]; &lt;br&gt;
//Data added to myArray. I have normally more that 50000 rows. &lt;br&gt;
range.Value = myArray; &lt;br&gt;
&lt;br&gt;
This gave me very good performance unlike other "LoadFrom.." methods of EPPlus.
&lt;br&gt;
Is there anyway to do this in EPPlus ?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Can checkbox controls be accessed to read their value?">
      <Posts>
        <Post From="marspd" When="16/06/2016 08:50:37">
          <Html>
        &lt;div class="markDownOutput "&gt;I've seen this question asked back in 2012 on the discussion and wondered if there has been any work done in this area.
&lt;br&gt;
&lt;br&gt;
Basically I have a number of CheckBoxes on my spreadsheet (form controls) and I would like to be able to see what the current checked state is of each checkbox along with its position on the spreadsheet so I know which checkbox it is (cell reference).
&lt;br&gt;
&lt;br&gt;
Is this something that can be done with this library. &lt;br&gt;
&lt;br&gt;
Thank you for any help. &lt;br&gt;
Paul&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Create Array Formula Fail.">
      <Posts>
        <Post From="AllenLin" When="22/08/2014 07:30:20">
          <Html>
        &lt;div class="markDownOutput "&gt;I try to create an array formula , but it doesn't work, only first cell show the value, others are empty.
&lt;br&gt;
&lt;br&gt;
code:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;worksheet.Cells["E2:E5"].CreateArrayFormula("FREQUENCY(B2:B18,C2:C5)");&lt;/code&gt;&lt;/pre&gt;
Excel: &lt;br&gt;
&lt;img alt="Image" src="http://h.hiphotos.bdimg.com/album/s%3D1600%3Bq%3D90/sign=fc6f4599d258ccbf1fbcb13c29e8874f/10dfa9ec8a1363272d612e18928fa0ec08fac709.jpg"&gt;
&lt;br&gt;
&lt;br&gt;
you can see that Cells["E3:E5"] has array formula but empty. &lt;br&gt;
Help~~~&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="moristtran" When="15/06/2016 07:53:53">
          <Html>
        &lt;div class="markDownOutput "&gt;I got this issue, the same case, please help me&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Excel Data Formatting">
      <Posts>
        <Post From="farooqmushtaq" When="14/06/2016 12:47:50">
          <Html>
        &lt;div class="markDownOutput "&gt;I want to format excel column data by implementing Custom number format but the data is in form of text. So, first I have to use
&lt;strong&gt;Conver to Number&lt;/strong&gt; option. Please let me know how can I perform this by selecting a column data for example from C1:C10 using epplus with C#.
&lt;br&gt;
Thanks&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="New version coming?">
      <Posts>
        <Post From="viciopt" When="10/06/2016 13:55:23">
          <Html>
        &lt;div class="markDownOutput "&gt;First of all, thanks to all the developers of this fantastic dll, it's being very useful!
&lt;br&gt;
&lt;br&gt;
One of the biggest know problems of all the existing excel libraries is the memory usage, especially when generating big files (&amp;gt;200 000 rows). The OutOfMemory exception is well known and EPPlus, although better then others, still cannot run away from them,
 but there is a fork, created by @kazy111 that drastically improves performance and memory usage and that has allowed me to create enormous files (&amp;gt;400 000 rows)!
&lt;br&gt;
&lt;br&gt;
&lt;a href="http://epplus.codeplex.com/SourceControl/network/forks/kazy111/EPPMemoryOptimization/contribution/8725" rel="nofollow"&gt;http://epplus.codeplex.com/SourceControl/network/forks/kazy111/EPPMemoryOptimization/contribution/8725&lt;/a&gt;
&lt;br&gt;
&lt;br&gt;
I saw that there is a merge request and I think it was already approved but there is still no oficial release version?
&lt;br&gt;
&lt;br&gt;
Is there any prediction of when this will happen? It's very important to my company and, if necessary, we can release some resources to help you with whatever you need.
&lt;br&gt;
&lt;br&gt;
Please reply. &lt;br&gt;
&lt;br&gt;
Kind regards, &lt;br&gt;
Tiago&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="12/06/2016 18:06:50">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
thank you for your kind words! We are working on a new minor version, but I cannot give you any estimations on when this will be released - we are currently evaluating pull requests and merging them into the main branch. You can always download and build the
 latest code your, the pull request by kazy111 has been approved and merged. &lt;br&gt;
&lt;br&gt;
Best regards, &lt;br&gt;
&lt;br&gt;
Mats&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="viciopt" When="13/06/2016 07:58:40">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
thank you for your answer. Good to know that there is some progress going on. &lt;br&gt;
&lt;br&gt;
Due to stability and also future-proof reasons, we would prefer to use an oficial stable release, preferably via nuget so we can keep everything up-to-date.
&lt;br&gt;
&lt;br&gt;
We will wait for the new release, hope it doesn't take long. &lt;br&gt;
&lt;br&gt;
Kind regards, &lt;br&gt;
Tiago&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Zoom to selection">
      <Posts>
        <Post From="mldz" When="09/06/2016 15:46:55">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
(thanks for the create LIB!) &lt;br&gt;
&lt;br&gt;
how can I set the created sheet to zoom to a specific selection like the excel function "Zoom to Selection" using column numbers?
&lt;br&gt;
Kind regards, &lt;br&gt;
&lt;br&gt;
Matthijs&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Adding shapes to Comments">
      <Posts>
        <Post From="Jazzaid" When="08/06/2016 09:08:53">
          <Html>
        &lt;div class="markDownOutput "&gt;Is it possible to add a shape to a comment using EPPlus. I can use Excel Interop to do something like:
&lt;br&gt;
&lt;br&gt;
myRange=xlWorkSheet.Range["H14"]; &lt;br&gt;
myrange.Cells.ClearComments(); &lt;br&gt;
myrange.AddComment(" "); &lt;br&gt;
myrange.Comment.Shape.Fill.UserPicture(picturepath); &lt;br&gt;
myrange.Comment.Shape.Width = 500; &lt;br&gt;
myrange.Comment.Shape.Height = 400; &lt;br&gt;
&lt;br&gt;
I've looked in the documentation and can't see anything, and tried some test code, but don't seem to be able to link the shape to the comment. It's a useful feature, because you can link an image to a comment but you don't see the image until you hover over
 the comment. &lt;br&gt;
&lt;br&gt;
Thanks.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Duration shows as string">
      <Posts>
        <Post From="elukenwork" When="02/12/2014 17:21:52">
          <Html>
        &lt;div class="markDownOutput "&gt;I'm using the following bit of code:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;                    Case "Duration"
                        sheet.Cells(sheetRow, columnIndex + 1).Value = dc.ConvertedString 'ts.ToString
                        sheet.Cells(sheetRow, columnIndex + 1).Style.Numberformat.Format = "[h]:mm:ss"&lt;/code&gt;&lt;/pre&gt;
to put values that are duration related into an XLSX sheet. The value appears, but is a text value, rather than a number value. I cannot open the sheet and perform calculations on the field, i.e. SUM does not work.
&lt;br&gt;
&lt;br&gt;
And ideas? or is this some obscure bug? The version of EPPlus in use is 4.0.0.1 and this was exhibited in 3.x versions also.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="elukenwork" When="07/06/2016 22:34:56">
          <Html>
        &lt;div class="markDownOutput "&gt;This is still an issue for me. &lt;br&gt;
&lt;br&gt;
For some clarification, the object "dc" is a dll that determines the datatype that is passed to it, and returns the value in ConvertedString, along with the datatype in another property. It is being returned as a string as it was my assumption that
 by setting the format as I have, it would convert it to a time datatype. This works when I have an actual time, i.e. "3:07:56 pm" but not for a duration, i.e. "0:47:22.128".
&lt;br&gt;
&lt;br&gt;
Is there anything to resolve this?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to use code generated with Open XML SDK 2.5 with EPPLUS">
      <Posts>
        <Post From="mzorola" When="07/06/2016 05:11:12">
          <Html>
        &lt;div class="markDownOutput "&gt;EPPLUS is great! It has really been a fantastic tool. My current project is in need of some chart tweeks that are not supported by EPPLUS. These tweeks are bar chart gap, data label values displayed at top of bar and finally the ability to color individual
 bars in the same series. I have not been very successful manipulating the xml code so I was hoping to be able to make use of the code gen'd through the open xml sdk 2.5. I just don't know how to use the objects generated by the SDK in my EPPLUS code. Is this
 even possible? I know in the end its all just xml. &lt;br&gt;
&lt;br&gt;
Thank a million on a great project.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="generate pdf from a generated excel">
      <Posts>
        <Post From="jvam90" When="20/09/2012 13:34:56">
          <Html>
        
&lt;p&gt;Hello everyone. I've used epplus for excel generation and it worked out great. Now, i have to generate the same excel, but in pdf format.&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Is there a way that i can do this using epplus?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="punitganshani" When="24/01/2013 04:00:23">
          <Html>
        
&lt;p&gt;Is this facility available in EPPlus to Save it as PDF?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="24/01/2013 10:26:44">
          <Html>
        
&lt;p&gt;No, only OOXML Excel files.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="bmaximus" When="01/06/2016 12:36:25">
          <Html>
        &lt;div class="markDownOutput "&gt;&lt;strong&gt;mrxrsd wrote:&lt;/strong&gt;&lt;br&gt;
&lt;blockquote&gt;No, only OOXML Excel files.&lt;br&gt;
&lt;/blockquote&gt;
is it going too be available? &lt;br&gt;
it would be very helpful. &lt;br&gt;
&lt;br&gt;
Thank you&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="LGPL License">
      <Posts>
        <Post From="Muthuraj" When="13/06/2012 10:11:02">
          <Html>
        
&lt;p&gt;I would like to use this component in a commercial application. is this allowed?. I could not understand what permissions LGPL license gives the users of this component?. &amp;nbsp;Do we need to provide our commercial application as open source in order to use
 this component?. clarification would be appreciated. thanks in advance.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="13/06/2012 12:16:56">
          <Html>
        
&lt;p&gt;Yes, it is allowed. No, your application can be a proprietary software.&amp;nbsp;&lt;/p&gt;
&lt;p&gt;http://www.gnu.org/licenses/lgpl-3.0.txt&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Muthuraj" When="13/06/2012 12:56:37">
          <Html>
        
&lt;p&gt;Thanks a lot sir. Really appreciate the contributions made by people like you which helped technology to&amp;nbsp;evolve. Thanks again. :-)&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="bmaximus" When="30/05/2016 07:48:43">
          <Html>
        &lt;div class="markDownOutput "&gt;&lt;strong&gt;mrxrsd wrote:&lt;/strong&gt;&lt;br&gt;
&lt;blockquote&gt;Yes, it is allowed. No, your application can be a proprietary software.&amp;nbsp;
&lt;a href="http://www.gnu.org/licenses/lgpl-3.0.txt" rel="nofollow"&gt;http://www.gnu.org/licenses/lgpl-3.0.txt&lt;/a&gt; &amp;nbsp;&lt;br&gt;
&lt;/blockquote&gt;
thank you very much. you saved a life! &amp;lt;3 &lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Licence Question">
      <Posts>
        <Post From="jlguitar287" When="04/03/2016 21:50:28">
          <Html>
        &lt;div class="markDownOutput "&gt;I know the latest version of EPPlus has an LGPL license. &lt;br&gt;
I would like to use EPPlus (downloaded through NuGet) in my web application. I sell software as a service on my web application - it's essentially an hours tracking system. I will not be distributing any code whatsoever.
&lt;br&gt;
&lt;br&gt;
Do I have to meet some conditions in order to use EPPlus in my web application? For example, do I need to state on my 'about' page that I use EPPlus or make the source code available in some way?
&lt;br&gt;
&lt;br&gt;
Thanks for the help! Really hope I can use EPPlus!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="bmaximus" When="30/05/2016 07:45:40">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello, this is very important, and i also would like to know about he license, as you said it is under GNU, but i would like to be 100% sure, that i can sell another product which contains some functionality granted from this library. please @swmal, we
 need an answer. &lt;br&gt;
Thank yo very much for the Library. &lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Create VBA Project inside MVC">
      <Posts>
        <Post From="ressario" When="26/05/2016 07:04:25">
          <Html>
        &lt;div class="markDownOutput "&gt;i've seen epplus can support vba. then how to create VBA project with epplus?
&lt;br&gt;
how to create it and how to compile it. &lt;br&gt;
&lt;br&gt;
thanks.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Script runs fine on laptop but not server">
      <Posts>
        <Post From="StuartBailie" When="04/05/2016 20:37:38">
          <Html>
        &lt;div class="markDownOutput "&gt;I have a pretty simple script right now:&lt;br&gt;
&lt;br&gt;
-=-=-=-=- -=-=-=-=- -=-=-=-=- -=-=-=-=- -=-=-=-=-&lt;br&gt;
$DLLPath = "E:\Scripts\Assembly\EPPlus.dll"&lt;br&gt;
[Reflection.Assembly]::LoadFile($DLLPath) | Out-Null&lt;br&gt;
&lt;br&gt;
$TodaysDate = Get-Date -Format D&lt;br&gt;
$ExcelTemplateFileName = "E:\Scripts\Templates\Report-Margin.xlsx"&lt;br&gt;
&lt;br&gt;
$ExcelApplication = New-Object OfficeOpenXml.ExcelPackage -ArgumentList $ExcelTemplateFileName&lt;br&gt;
$Workbook = $ExcelApplication.Workbook&lt;br&gt;
$ActiveWorksheet = $Workbook.Worksheets.Item("Sheet1")&lt;br&gt;
$ActiveWorksheet.Cells[1, 5].Value = $TodaysDate&lt;br&gt;
-=-=-=-=- -=-=-=-=- -=-=-=-=- -=-=-=-=- -=-=-=-=-&lt;br&gt;
&lt;br&gt;
Which when executed from my laptop it works fine but the moment I run the exact same file from the server it reports:&lt;br&gt;
Property 'Value' cannot be found on this object; make sure it exists and is settable.&lt;br&gt;
&lt;br&gt;
What should I be checking on the server to make sure everything is there and working fine? I have already checked to make sure .NET 3.5 is there and EPPlus.DLL is in the correct location.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="StuartBailie" When="20/05/2016 16:37:02">
          <Html>
        &lt;div class="markDownOutput "&gt;I made two changes to the script. The first which I think was the actual reason why it started to work was that in Windows I clicked on the File Properties and Unblocked the DLL from restricted list. I'm not sure why this let it work in a manual state
 but not an automatic one but none the less it was one of the major steps I did. &lt;br&gt;
&lt;br&gt;
The other major change I did was change the reference from Cells[1, 5].Value to Cells["E1"].Value.
&lt;br&gt;
&lt;br&gt;
Between the two I now have a fully functional report!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Any one know how to add Label small txt in charts">
      <Posts>
        <Post From="ranjithmurthy" When="18/05/2016 17:34:25">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello mates ,&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
I am completely new to Excel automation in C#&lt;br&gt;
&lt;br&gt;
Actually I am came across some of API for Excel generation in C# .net like CLOSED XML , EEPLUS , and spreadsheetlight by vincent ,Open XML by Microsoft , Interop excel by Microsoft&lt;br&gt;
&lt;br&gt;
According My Study&lt;br&gt;
&lt;br&gt;
CLOSED XML -- No charts supported&lt;br&gt;
&lt;br&gt;
EEPLUS - Charts supported&lt;br&gt;
&lt;br&gt;
Spread light- Very easy to use and Charts also supported&lt;br&gt;
&lt;br&gt;
Open XML- complex hard to work&lt;br&gt;
&lt;br&gt;
I was completely fine with Spread light light was good API , but i am not able to find a solution how to add label inside a Chart&lt;br&gt;
&lt;br&gt;
I hope this can be implement in EEPLUS &lt;br&gt;
I hope any one in EEPLus came across with same problem.&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
I need to add label like text inside chart like for example Company in chart.&lt;br&gt;
&lt;br&gt;
Please let me know how to find solution&lt;br&gt;
&lt;img alt="Image" src="http://i.stack.imgur.com/o8zrZ.jpg"&gt;&lt;br&gt;
Please find chart info here)&lt;br&gt;
&lt;br&gt;
Thanks Ranjith&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="AutoFitColumns - trying to convert String in ExcelColumn">
      <Posts>
        <Post From="oktay89" When="04/05/2016 09:47:04">
          <Html>
        &lt;div class="markDownOutput "&gt;Can't convert object of type "System.String" into type "OfficeOpenXml.ExcelColumn".
&lt;br&gt;
I get this error when i try to call the function AutoFitColumns(). Any ideas what i am doing wrong?My Excel file has 1 worksheet and 7 Columns with 24 rows.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Reading Charts from Spreadsheet File">
      <Posts>
        <Post From="jbouknight" When="03/05/2016 13:45:15">
          <Html>
        &lt;div class="markDownOutput "&gt;I have a spreadsheet template that takes embedded data and creates a line chart.
&lt;br&gt;
&lt;br&gt;
The chart has two line chart entries (one with two data series) and one with a single data series.
&lt;br&gt;
&lt;br&gt;
The chart displays with the correct data. however, when I try to use EPPLUS to read the worksheet data, it only shows one Drawing (not two) with the two data series in it.
&lt;br&gt;
&lt;br&gt;
I've looked at the XML description of the Chart from the Excel file (looked inside the file using ZIP and the Chart folder/file and it shows two lineChart elements, but only one of them appears in EPPLUS under the worksheet.Drawings collection.
&lt;br&gt;
&lt;br&gt;
I can email a copy of the spreadsheet file if someone wants to look at it. &lt;br&gt;
&lt;br&gt;
I'm currently using 4.0.4&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Generate XLSX file from XLSM template using EPPlus">
      <Posts>
        <Post From="ajaouadi" When="03/05/2016 10:54:57">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi all, &lt;br&gt;
&lt;br&gt;
Is it possible to create an excel file (extension .xlsx ) from an Excel template file ( .xlsm extension) containing macro.
&lt;br&gt;
I can not do it, I always this error message "The cachesource is not a worksheet ."
&lt;br&gt;
Thanks for your help. &lt;br&gt;
&lt;br&gt;
Best regards, &lt;br&gt;
Aymen&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Calculated element in a Pivot Table">
      <Posts>
        <Post From="orijuan0710" When="29/04/2016 16:11:51">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello. I created a pivot table with Epplus, but I need to insert a calculated element of one field of this Pivottable.
&lt;br&gt;
Can you tell me how to do it? &lt;br&gt;
&lt;br&gt;
pivotTable.RowFields.Add(pivotTable.Fields("SITUACIÓN EOP")) &lt;br&gt;
&lt;br&gt;
I need add a calculated element (not field) from the pivotTable.Fields("SITUACIÓN EOP").
&lt;br&gt;
&lt;br&gt;
Thanks.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="VLOOKUP Works Intermittently">
      <Posts>
        <Post From="kilkfoe" When="20/04/2016 18:24:58">
          <Html>
        &lt;div class="markDownOutput "&gt;&lt;strong&gt;This was the original question, although I figured out that this wasn't the case. I'm leaving it for history's sake, but you can skip reading this first part until the edit&lt;/strong&gt;&lt;br&gt;
Has anybody noticed certain functions, particularly VLOOKUP only work some times? Last night I was testing two separate workbooks that are nearly identical. I opened them with EPPlus, wrote some data, calculated a sheet, and extracted values from that sheet.
 The first workbook was working perfectly fine while the second workbook was getting a calculation error. I decided to go to sleep and see if I could figure anything out this morning, and now suddenly the first workbook is getting the same calculation error!&lt;br&gt;
&lt;br&gt;
If instead of trying to calculate the data and extract it through EPPlus I simply write it to a file, I can open the file and see all the formulas working perfectly.&lt;br&gt;
&lt;br&gt;
Has anybody noticed this before? It's very difficult for me to reproduce or give an example since one day a sheet works and the next day it doesn't.&lt;br&gt;
&lt;br&gt;
&lt;em&gt;EDIT&lt;/em&gt;&lt;br&gt;
So, I'm not sure if somehow I swapped out the workbooks last night, which may have led to my first workbook not working this morning, but I think that's the case.&lt;br&gt;
&lt;br&gt;
However, I did finally figure out what the issue is. I had a VLOOKUP with a MATCH inside. Both the VLOOKUP and MATCH functions refer to a different sheet. My formula was written something like:&lt;br&gt;
&lt;code&gt;=VLOOKUP(A35, OtherSheet!$A$1:OtherSheet!$C$42, MATCH($D$1, OtherSheet!$A$1:OtherSheet!$C$1, 0), FALSE)&lt;/code&gt;&lt;br&gt;
which works perfectly fine in Excel, but had calculation exception in EPPlus. When I changed the formulas to omit the 2nd reference to OtherSheet it worked in EPPlus:&lt;br&gt;
&lt;code&gt;=VLOOKUP(A35, OtherSheet!$A$1:$C$42, MATCH($D$1, OtherSheet!$A$1:$C$1, 0), FALSE)&lt;/code&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="27/04/2016 19:32:07">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
could you create an issue with the same description and attach your workbooks so we can recreate the error.
&lt;br&gt;
&lt;br&gt;
Alternatively you can try to see if you can find anything using the logger of the formula parser.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;workbook.ParserManager.AttachLogger(new FileInfo("c:\\mylogfile.txt"));&lt;/code&gt;&lt;/pre&gt;
and then run the calculate() method again.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="kilkfoe" When="27/04/2016 22:37:13">
          <Html>
        &lt;div class="markDownOutput "&gt;I have added the issue here &lt;a href="https://epplus.codeplex.com/workitem/15455" rel="nofollow"&gt;
https://epplus.codeplex.com/workitem/15455&lt;/a&gt;&lt;br&gt;
&lt;br&gt;
I used Workbook.FormulaParserManager and it gave the following:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;=================================
Timestamp: 4/27/2016 2:56:04 PM

Worksheet: Sheet1
Address: C3
OfficeOpenXml.FormulaParsing.Exceptions.ExcelErrorValueException: #VALUE!
   at OfficeOpenXml.FormulaParsing.Excel.Functions.IntArgumentParser.Parse(Object obj)
   at OfficeOpenXml.FormulaParsing.Excel.Functions.RefAndLookup.LookupArguments..ctor(IEnumerable`1 arguments, ArgumentParsers argumentParsers)
   at OfficeOpenXml.FormulaParsing.Excel.Functions.RefAndLookup.VLookup.Execute(IEnumerable`1 arguments, ParsingContext context)
   at OfficeOpenXml.FormulaParsing.ExpressionGraph.FunctionExpression.Compile()

=================================
Timestamp: 4/27/2016 2:56:04 PM

Worksheet: Sheet1
Address: C7
OfficeOpenXml.FormulaParsing.Exceptions.ExcelErrorValueException: #VALUE!
   at OfficeOpenXml.FormulaParsing.Excel.Functions.IntArgumentParser.Parse(Object obj)
   at OfficeOpenXml.FormulaParsing.Excel.Functions.RefAndLookup.LookupArguments..ctor(IEnumerable`1 arguments, ArgumentParsers argumentParsers)
   at OfficeOpenXml.FormulaParsing.Excel.Functions.RefAndLookup.VLookup.Execute(IEnumerable`1 arguments, ParsingContext context)
   at OfficeOpenXml.FormulaParsing.ExpressionGraph.FunctionExpression.Compile()&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="When using Package. GetAsByteArry the TableStyle is not seen">
      <Posts>
        <Post From="digimanus" When="26/04/2016 20:25:59">
          <Html>
        &lt;div class="markDownOutput "&gt;In my code I create a package using&lt;br&gt;
ws.Cells["A3"].LoadFromDataTable(dataTable, true, TableStyles.Light20);&lt;br&gt;
&lt;br&gt;
At the end of the method I state&lt;br&gt;
return pck.GetAsByteArray();&lt;br&gt;
&lt;br&gt;
Why does the TableStyle not show up in the downloadable XLSX?&lt;br&gt;
&lt;br&gt;
full method:&lt;br&gt;
&lt;br&gt;
public static Byte[] DataTables(DataTable dataTable, String SheetName, String ReportTitle, out FileInfo info)&lt;br&gt;
&lt;pre&gt;&lt;code&gt;    {
        dataTable = SesameCommon.ExportTo.DataTableToExcel2007.UpdateColumnNames(dataTable);
        info = new FileInfo(string.Format("{0}.xlsx", Guid.NewGuid().ToString()));
        using (ExcelPackage pck = new ExcelPackage(info))
        {
            ExcelWorksheet ws = pck.Workbook.Worksheets.Add(SheetName);
            ws.Cells["A1"].Value = string.Format("{0}. [rows: {1}]", ReportTitle, dataTable.Rows.Count);
            ws.Cells[1, 1, 1, dataTable.Columns.Count].Merge = true;
            ws.Cells[1, 1, 1, dataTable.Columns.Count].Style.Font.Bold = true;

            ws.Cells["A3"].LoadFromDataTable(dataTable, true, TableStyles.Light20);

            for (int kolNr = 0; kolNr &amp;lt; dataTable.Columns.Count; kolNr++)
            {
                using (ExcelRange col = ws.Cells[4, kolNr + 1, 4 + dataTable.Rows.Count, kolNr + 1])
                {
                    if (dataTable.Columns[kolNr].DataType == typeof(DateTime))
                    {
                        col.Style.Numberformat.Format = "dd-MMM-yyyy";
                        col.Style.HorizontalAlignment = ExcelHorizontalAlignment.Right;
                    }
                    else if (dataTable.Columns[kolNr].DataType == typeof(int))
                    {
                        col.Style.Numberformat.Format = "#,0";
                        col.Style.HorizontalAlignment = ExcelHorizontalAlignment.Right;
                    }
                    else if (dataTable.Columns[kolNr].DataType == typeof(Decimal))
                    {
                        col.Style.Numberformat.Format = "#,0.00";
                        col.Style.HorizontalAlignment = ExcelHorizontalAlignment.Right;
                    }
                }
            }
            int kolNo = 0;
            int Rowno = 4;
            StyleDataTable(dataTable, ws, kolNo, Rowno);
            // dispose unneeded objects
            dataTable.Dispose();

            ws.Cells[ws.Dimension.Address].AutoFitColumns();
            SetNegativeColors(ws);
            return pck.GetAsByteArray();
        }
    }
&lt;/code&gt;&lt;/pre&gt;
ASPX codebehind:&lt;br&gt;
protected void Page_Load(object sender, EventArgs e)&lt;br&gt;
&lt;pre&gt;&lt;code&gt;{
    DataTable table = (DataTable)Session["ExcelXmlDataTable"];
    String Sheetname = Session["ExcelXmlSheetName"].ToString();
    string ReportTitle = HttpContext.Current.Session["ExcelXmlReportTitle"].ToString();
    FileInfo myFile;


    HttpContext.Current.Response.Clear();
    HttpContext.Current.Response.ClearContent();
    HttpContext.Current.Response.ClearHeaders();
    HttpContext.Current.Response.Cookies.Clear();
    HttpContext.Current.Response.Cache.SetCacheability(HttpCacheability.Private);
    HttpContext.Current.Response.CacheControl = "private";
    HttpContext.Current.Response.Charset = UTF8Encoding.UTF8.WebName;
    HttpContext.Current.Response.ContentEncoding = UTF8Encoding.UTF8;

    Byte[] fileBytes = SesameCommon.ExcelXML.WebObjects.DataTables(table, Sheetname, ReportTitle, out myFile);
    HttpContext.Current.Response.ContentType = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";
    HttpContext.Current.Response.AppendHeader("Content-Disposition", string.Format("attachment; filename={0};size={1};", myFile.Name, fileBytes.Length.ToString()));
    HttpContext.Current.Response.AppendHeader("Content-Length", fileBytes.Length.ToString());
    HttpContext.Current.Response.AppendHeader("Pragma", "cache");
    HttpContext.Current.Response.AppendHeader("Expires", "60");

    //Write it back to the client
    HttpContext.Current.Response.BinaryWrite(fileBytes);
    HttpContext.Current.Response.End();
}&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="What is the best way to move a column?">
      <Posts>
        <Post From="VCUMelvin" When="26/04/2016 16:05:18">
          <Html>
        &lt;div class="markDownOutput "&gt;I'm using EPPlus 4.0.5. What is the best way to move (cut, insert) a column?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Delete an entire column">
      <Posts>
        <Post From="sunp" When="24/06/2011 22:19:11">
          <Html>
        
&lt;p&gt;I was trying to delete an entire column on a sheet but could not find any API method. There is a method to Hide the column.&lt;/p&gt;
&lt;p&gt;Any suggestion?&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="27/06/2011 13:37:15">
          <Html>
        
&lt;p&gt;Did you try "worksheet.Column(idx).Hide();" ?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="sunp" When="20/07/2011 15:42:49">
          <Html>
        
&lt;p&gt;Yes. As name says, it just hides the column. One can open the workbook and make the column visible.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Stompp" When="14/11/2011 15:11:39">
          <Html>
        
&lt;p&gt;I'm having the same issue. Depending on certain conditions I need to delete an entire column from the spreadsheet. "Worksheet.Column(n).Hidden = true;" isn't just enough.&lt;/p&gt;
&lt;p&gt;Is there a way to achieve that from EPPlus? The entire sheet is only values. No formulas that might crash.&lt;/p&gt;
&lt;p&gt;Thanks in advance&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="17/11/2011 06:35:40">
          <Html>
        
&lt;p&gt;No, not in this version.&lt;/p&gt;
&lt;p&gt;I haven't implemented&amp;nbsp;inserts and deletes&amp;nbsp;of columns mainly because it would not work well with large worksheets with the current design of the cell store.&lt;/p&gt;
&lt;p&gt;The only way to&amp;nbsp;delete a column&amp;nbsp;is to move the cells yourself.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="punitganshani" When="17/01/2013 03:47:34">
          <Html>
        
&lt;blockquote style="margin: 0.25em 1em 0px; padding: 0px 0.25em; border: 0.1em solid rgb(204, 204, 204); border-image: none; font-style: italic;"&gt;
&lt;strong&gt;JanKallman wrote:&lt;/strong&gt;&lt;br&gt;
&lt;p&gt;No, not in this version.&lt;/p&gt;
&lt;p&gt;I haven't implemented&amp;nbsp;inserts and deletes&amp;nbsp;of columns mainly because it would not work well with large worksheets with the current design of the cell store.&lt;/p&gt;
&lt;p&gt;The only way to&amp;nbsp;delete a column&amp;nbsp;is to move the cells yourself.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;If performance is the issue and moving is the only option, any plans of implementing the delete functionality that moves all the cells?&lt;/p&gt;
&lt;p&gt;Hiding is not close enough to deleting the column.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="harishlalwani" When="21/10/2013 09:31:00">
          <Html>
        &lt;div class="markDownOutput "&gt;Any update on this feature? Even I am looking for delete column functionality.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="aleyush" When="17/03/2014 09:03:21">
          <Html>
        &lt;div class="markDownOutput "&gt;Version 4 beta with new cell store is now available. Is delete column functionality available there?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="JanKallman" When="18/03/2014 20:14:25">
          <Html>
        &lt;div class="markDownOutput "&gt;It is in Cell Store, but I have not added the methods to the ExcelWorksheet class yet.
&lt;br&gt;
I'll add it to the next build, hopefully this week.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="bedantaguru" When="03/06/2014 10:33:02">
          <Html>
        &lt;div class="markDownOutput "&gt;Dear JanKallman,&lt;br&gt;
What is the Status now regrading this issue? Is it implemented?&lt;br&gt;
Is there a hack for the same?&lt;br&gt;
Please let me know.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Xenolith" When="14/08/2014 10:51:07">
          <Html>
        &lt;div class="markDownOutput "&gt;Any updates about the delete column feature?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="jdnichollsc" When="24/11/2014 14:54:09">
          <Html>
        &lt;div class="markDownOutput "&gt;Example to move cells with style, format and merged cells to simulate delete column please!&lt;br&gt;
PD: Sorry for my bad English :)&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="ghanchiasif" When="02/12/2014 06:17:49">
          <Html>
        &lt;div class="markDownOutput "&gt;Any updates?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="VCUMelvin" When="26/04/2016 16:01:23">
          <Html>
        &lt;div class="markDownOutput "&gt;The current version (I'm using 4.0.5, but it was also present in 4.0.4 and 4.0.3) does include the ability to write
&lt;br&gt;
sheet.DeleteColumn(i+1) &lt;br&gt;
&lt;br&gt;
In 4.0.4, DeleteColumn was broken (it was clearing the column instead of deleting it), but now that I've installed 4.0.5, it seems to be fixed.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Excel subtotal function">
      <Posts>
        <Post From="Joby003" When="22/04/2016 11:08:23">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi There, &lt;br&gt;
&lt;br&gt;
Is it possible to implement excel subtotal function using the epplus library? &lt;br&gt;
&lt;br&gt;
&lt;img alt="Image" src="https://www.google.co.in/imgres?imgurl=https://support.content.office.net/en-us/media/be6a87b4-3f03-4d0b-9eb8-9450f9109587.gif&amp;amp;imgrefurl=https://support.office.com/en-us/article/Insert-subtotals-in-a-list-of-data-in-a-worksheet-7881d256-b4fa-4f81-b71e-b0a3d4a52b3a&amp;amp;h=231&amp;amp;w=219&amp;amp;tbnid=Ih4XnPIKBUbDzM:&amp;amp;tbnh=160&amp;amp;tbnw=152&amp;amp;docid=6qtGV0oNqmRNlM&amp;amp;usg=__SIbUnKVyZGO9n_HRfH9iCKj90fU=&amp;amp;sa=X&amp;amp;ved=0ahUKEwi_pZvK_KHMAhXBqh4KHe2UCDYQ9QEIIDAA#h=231&amp;amp;tbnh=160&amp;amp;tbnw=152&amp;amp;w=219"&gt;
&lt;br&gt;
&lt;br&gt;
thanks, &lt;br&gt;
Joby&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="No worksheets in file?">
      <Posts>
        <Post From="ladams_ignew" When="15/04/2016 21:44:16">
          <Html>
        &lt;div class="markDownOutput "&gt;EDIT - &lt;br&gt;
Apparently EPPlus doesn't support .xls, only the XML format? That's a question because I've been all over the CodePlex project site looking into this and not found any explicit statement of this fact. If it's spelled out somewhere, it's not anywhere obvious.
 You might want to look at putting that somewhere on the home page, in big bold font. Would have saved me some time today. :)&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
I've tried several files, and EPPlus v4.0.5 (latest per nuget) seems to be unable to read any worksheets from any excel files I try to load using the following code.
&lt;br&gt;
&lt;br&gt;
Am I doing something wrong?&lt;br&gt;
&lt;pre&gt;&lt;code&gt;using OfficeOpenXml;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace ConsoleApplication1
{
    class Program
    {
        static void Main(string[] args)
        {

            var fi = new System.IO.FileInfo(@"c:\tmp\book1.xls");
            var package = new ExcelPackage(fi);
            var book = package.Workbook;
            Console.WriteLine("book.Worksheets Count: {0}", book.Worksheets.Count);
            if(book.Worksheets.FirstOrDefault() == null)
            {
                Console.WriteLine("book.Worksheets.FirstOrDefault() is null.");
            }

            Console.ReadLine();
        }
    }
}&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="richardtallent" When="20/04/2016 14:29:09">
          <Html>
        &lt;div class="markDownOutput "&gt;Home page title for this project: "Create advanced Excel 2007/2010 spreadsheets on the server".&lt;br&gt;
&lt;br&gt;
Not sure it could be much clearer.&lt;br&gt;
&lt;br&gt;
The legacy Excel 98/2000 XLS format ("BIFF" format) is not supported by EPPlus, it's wildly different from the OOXML (aka "XLSX") format that EPPlus is built around.&lt;br&gt;
&lt;br&gt;
To read or write old XLS files, I would recommend the NPOI library. It doesn't have the same level of functionality as EPPlus, but it works just fine for reading and writing old Excel files. But that library also doesn't support either the Excel 2002/2003 XML
 format or the 2007/2010/2013/2016 OOXML format, so if you're dealing with legacy Excel files from many sources, you'll need to use multiple libraries.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Will it be DNX compliant?">
      <Posts>
        <Post From="jppcl" When="07/04/2016 13:33:47">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello all, &lt;br&gt;
&lt;br&gt;
Would be good to have such a powerful lib to use with DNX Core 5 MVC, unfortunately, after getting the package, VS2015 Community says it is not compatible with framework DNX Core 5. Are there any plans for this support?
&lt;br&gt;
&lt;br&gt;
Thanks in advance&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="richardtallent" When="20/04/2016 14:23:17">
          <Html>
        &lt;div class="markDownOutput "&gt;I for one would fully support updating this package to be compatible with .NET Standard, which would then make it available across the board. I can't imagine it would be too difficult, especially if DotNetZip is or will be compatible.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Tip for using macro modules">
      <Posts>
        <Post From="richardtallent" When="20/04/2016 14:18:44">
          <Html>
        &lt;div class="markDownOutput "&gt;I posted a little blog about how I embed macro modules in my VS solution so I can include them in my EPPlus-derived workbooks. Nothing earth-shaking in novelty, but just a little twist on the usual approach. Thought it might be of interest to someone else:
&lt;br&gt;
&lt;br&gt;
&lt;a href="http://blog.tallent.us/?p=357" rel="nofollow"&gt;Managing EPPlus Macro Modules&lt;/a&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="COUNTIF returns #VALUE! while negative criteria">
      <Posts>
        <Post From="stranada" When="20/04/2016 11:35:27">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
I'm using EPPlus.dll version 4.0.5.0 to insert some data into existing excel worksheet. In the worksheet, the are some predefined formulas, which work with inserted data. Directly in MS Excel 2007 all works fine (all formulas are recalculated), but it seems
 that COUNTIF formula is not working after Calculate command in EPPlus. &lt;br&gt;
&lt;br&gt;
The COUNTIF formula doesn't work only if the criteria is a negative number, then the COUNTIF returns #VALUE!
&lt;br&gt;
&lt;br&gt;
Input range for COUNTIF is generated by another formula (some nested IFs). &lt;br&gt;
&lt;br&gt;
Has anyone else experienced this weird behaviour? Is there some workaround which can be used?
&lt;br&gt;
&lt;br&gt;
Thanks &lt;br&gt;
Adam &lt;br&gt;
&lt;br&gt;
P. S. Is here some option to append XLSS file as an example?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Subtotal with grouping">
      <Posts>
        <Post From="AmitShewani" When="20/04/2016 03:56:16">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi,&lt;br&gt;
&lt;br&gt;
I have been trying to carry out subtotal with grouping (the way excel does it when we click on subtotal under data).&lt;br&gt;
&lt;br&gt;
I tried going through sample 6, but it was a bit difficult to understand.&lt;br&gt;
&lt;br&gt;
I have attached the screenshot for reference, the data that I would get from database would be dynamic.&lt;br&gt;
&lt;br&gt;
&lt;img alt="Image" src="http://imgur.com/eRUJEg9"&gt;&lt;br&gt;
&lt;br&gt;
Edit: The image isn't visible, here's the link:&lt;br&gt;
&lt;br&gt;
&lt;a href="http://imgur.com/eRUJEg9" rel="nofollow"&gt;http://imgur.com/eRUJEg9&lt;/a&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Updata Pivot Table">
      <Posts>
        <Post From="mellospank" When="29/05/2012 13:06:01">
          <Html>
        
&lt;p&gt;Hi,&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I have a pivot table from a template file, i need to update the data from a datarange, there's no method in the Pivot class.&lt;/p&gt;
&lt;p&gt;How can i &lt;span&gt;achieve&amp;nbsp;&lt;/span&gt;this?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JasonSTX" When="30/05/2012 20:08:53">
          <Html>
        
&lt;pre&gt;This function is dynamic as far as length and width of the source data.  You could easily update datarange manually if you know the values.&lt;/pre&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: green; background-color: white;"&gt;//srcFile is the file to edit&lt;/span&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;span style="color: green;"&gt;//pivotSheet is the name of the sheet with the pivot table&lt;/span&gt;
&lt;span style="color: green;"&gt;//srcSheet is the data source sheet for the pivot table&lt;/span&gt;
&lt;span style="color: green;"&gt;//srcCell is the top left corner of the srcSheet (like A1)&lt;/span&gt;
&lt;span style="color: green;"&gt;//your srcCell should include the column header row&lt;/span&gt;

&lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;static&lt;/span&gt; &lt;span style="color: blue;"&gt;void&lt;/span&gt; UpdatePivotTable(&lt;span style="color: blue;"&gt;string&lt;/span&gt; srcFile, &lt;span style="color: blue;"&gt;string&lt;/span&gt; pivotSheet, &lt;span style="color: blue;"&gt;string&lt;/span&gt; srcSheet, &lt;span style="color: blue;"&gt;string&lt;/span&gt; srcCell)
        {            
            &lt;span style="color: blue;"&gt;try&lt;/span&gt;
            {      
                FileInfo file = &lt;span style="color: blue;"&gt;new&lt;/span&gt; FileInfo(srcFile);
                ExcelPackage package = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(file);
                &lt;span style="color: green;"&gt;//get a reference to the Pivot and Details tables&lt;/span&gt;
                ExcelWorksheet piv = package.Workbook.Worksheets.First(x=&amp;gt;x.Name==pivotSheet);
                ExcelWorksheet det = package.Workbook.Worksheets.First(x =&amp;gt; x.Name == srcSheet);

                &lt;span style="color: green;"&gt;//build the range from top left to the far right column and bottom row (removes blanks)               &lt;/span&gt;
                &lt;span style="color: blue;"&gt;var&lt;/span&gt; dataRange = det.Cells[srcCell+&lt;span style="color: rgb(163, 21, 21);"&gt;":"&lt;/span&gt; + det.Dimension.End.Address.ToString()];
                piv.PivotTables[0].CacheDefinition.SourceRange = dataRange;               
                package.Save();                
            }
            &lt;span style="color: blue;"&gt;catch&lt;/span&gt; (Exception ex)
            {
                &lt;span style="color: green;"&gt;//your error handling&lt;/span&gt;
            }
        }
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="thecolour" When="12/09/2014 11:14:36">
          <Html>
        &lt;div class="markDownOutput "&gt;This does not work in version 4. &lt;br&gt;
&lt;br&gt;
CacheDefinition.SourceRange always returns null so when you try to set it falls over (this is because it does some validation that the range you're trying to set has the same number of columns as the current source range.
&lt;br&gt;
&lt;br&gt;
From the source code:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;                var sr = SourceRange;
                if (value.End.Column - value.Start.Column != sr.End.Column - sr.Start.Column)
                {
                    throw (new ArgumentException("Can not change the number of columns(fields) in the SourceRange"));
                }&lt;/code&gt;&lt;/pre&gt;
SourceRange is null so you get a nullreferenceexception on the evaluation&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="BD98037" When="10/10/2014 05:44:44">
          <Html>
        &lt;div class="markDownOutput "&gt;So is there anyway to update the source range/data range for pivots via EPPLUS? I really need to update bunch of pivots from a template via epplus.
&lt;br&gt;
&lt;br&gt;
Thanks!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="thecolour" When="10/10/2014 16:34:32">
          <Html>
        &lt;div class="markDownOutput "&gt;Not unless you want to hack the source code. I ended up abandoning EPPlus - it's a great project but not really mature enough. My current solution uses OpenXML to change the connections on the spreadsheet, injecting connection string and sql command, and
 then refresh the sheet on open. This loads the data I want to display in the pivot for the user.
&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="BD98037" When="10/10/2014 16:44:14">
          <Html>
        &lt;div class="markDownOutput "&gt;&lt;strong&gt;thecolour wrote:&lt;/strong&gt;&lt;br&gt;
&lt;blockquote&gt;Not unless you want to hack the source code. I ended up abandoning EPPlus - it's a great project but not really mature enough. My current solution uses OpenXML to change the connections on the spreadsheet, injecting connection string and sql command,
 and then refresh the sheet on open. This loads the data I want to display in the pivot for the user.&lt;br&gt;
&lt;/blockquote&gt;
Would you please share your code of how you change the connections on the spreadsheet and refresh on open?
&lt;br&gt;
&lt;br&gt;
Thanks a lot for your help!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="do4urka" When="28/11/2014 00:41:16">
          <Html>
        &lt;div class="markDownOutput "&gt;This code works for me for setting Pivot Table data source:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;var sheet1 = pck.Workbook.Worksheets["Sheet1"];
var sourceRange = "$A$5:$AG25";
var pivotTable = sheet1.PivotTables.First();
pivotTable.CacheDefinition.SourceRange = new ExcelNamedRange("", sheet1, sheet1, sourceRange);&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Eyedia" When="18/04/2016 17:52:00">
          <Html>
        &lt;div class="markDownOutput "&gt;Seems like this is still a problem. Has anyone found the solution? In my case, I can find the pivot table, updating the sourcerange, saving it, but it does not get saved.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;var dataRange = sheet.Cells["A1:" + sheet.Dimension.End.Address.ToString()];
pivotTable.CacheDefinition.SourceRange = dataRange;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Hide zero value">
      <Posts>
        <Post From="boisnou" When="14/04/2016 09:03:57">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello, &lt;br&gt;
where is the option in EPPLUS : "Display or hide all zero values on a worksheet"?
&lt;br&gt;
&lt;br&gt;
thanks&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Images was stretched when the cell have multi rows">
      <Posts>
        <Post From="BinWang" When="08/04/2016 06:12:25">
          <Html>
        &lt;div class="markDownOutput "&gt;Images was stretched when we put multi rows into a cell. &lt;br&gt;
Even we used "Locked". &lt;br&gt;
&lt;br&gt;
Version:4.0.3 &lt;br&gt;
Code: &lt;br&gt;
MemoryStream ms = new MemorySteam(...); &lt;br&gt;
Bitmap image = new Bitmap(ms); &lt;br&gt;
ExcelPicture psp = workSheet.Drawings.AddPicture(...,...) &lt;br&gt;
psp.SetPosition(12, 0, 0, 0); &lt;br&gt;
psp.Locked = true; &lt;br&gt;
psp.EditAs = eEditAs.Absolute; &lt;br&gt;
psp.SetSize(image.Width,image.Height); &lt;br&gt;
&lt;br&gt;
Things we tried but failed: &lt;br&gt;
(1)insert the picture -&amp;gt; put the contents in cell -&amp;gt; resize the pictures to origin
&lt;br&gt;
(2)put all the contents in cell -&amp;gt; insert the picture &lt;br&gt;
&lt;br&gt;
We didn't find any solutions yet. &lt;br&gt;
We also tried 4.0.5,it didn't work. &lt;br&gt;
&lt;br&gt;
Waiting for your reply.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Load data from XML file">
      <Posts>
        <Post From="EAmez" When="28/03/2016 20:29:29">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi All, &lt;br&gt;
&lt;br&gt;
I have a project made by someone else with Microsoft PIA that takes an XML file an loads it as Excel file, and then appends it's content into an existing excel file. Well, I'm trying to change this functionality to be independent from Microsoft libraries and
 I'm trying to do this with EPPlus, but I'm not able to open or load XML file in order to append it to existing xlsx file.
&lt;br&gt;
&lt;br&gt;
Anyone can help, please? &lt;br&gt;
&lt;br&gt;
I recognize I haven't been programming lately so maybe this is a problem of forgotten knowledge. Thanks for your time!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Series Lines in Pivot Chart">
      <Posts>
        <Post From="Debkumar" When="25/03/2016 11:44:16">
          <Html>
        &lt;div class="markDownOutput "&gt;I am using the latest version 4.0.5 to generate EXCEL. &lt;br&gt;
I could not find the way to add "Series lines" in a column stack pivot chart.
&lt;br&gt;
The menu is available under the below path of Excel. &lt;br&gt;
PivotChart Tools -&amp;gt; Layout -&amp;gt; Analysis -&amp;gt; Lines -&amp;gt; Series Lines &lt;br&gt;
Is it a supported feature?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="X axis values alignment">
      <Posts>
        <Post From="Watcher01" When="01/02/2011 21:45:09">
          <Html>
        
&lt;p&gt;Hi all,&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I`ve noticed that in this same type&amp;nbsp;charts&amp;nbsp;there is sometimes different alignment of x values (for example dates):&lt;br&gt;
45 degrees or 90 degrees.&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Is there some kind of property that sets this to the fixed value - all charts have x axis with 90 degree alignment?&lt;/p&gt;
&lt;p&gt;I`ve tried&amp;nbsp;to find it but without success,&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;BR&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="03/02/2011 15:08:53">
          <Html>
        
&lt;p&gt;No, not in the current version, but it should not be to hard to add. I'll add that to my todo-list.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="carlos7999" When="23/03/2016 22:40:36">
          <Html>
        &lt;div class="markDownOutput "&gt;I have the same problem, here is a solution??? &lt;br&gt;
&lt;br&gt;
thanks&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to write to a merged cell">
      <Posts>
        <Post From="ManuBhai" When="22/03/2016 05:00:05">
          <Html>
        &lt;div class="markDownOutput "&gt;i am trying to replace some string literals in merged cells with their actual values,
&lt;br&gt;
Did following but neither its working nor throwing any error. Please help&lt;br&gt;
** I am able to read the merged cell contained but cant write to it.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;For Each mc As String In ws.MergedCells
            Dim s As String = ws.Cells(mc).Value(0, 0)
            If String.IsNullOrEmpty(s) Then Continue For

            If s.StartsWith("{") AndAlso s.EndsWith("}") Then
                If dicKeyValue.ContainsKey(s) Then
                    ws.Cells(mc).Value(0, 0) = dicKeyValue(s)
                End If
            End If
        Next&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="ManuBhai" When="22/03/2016 05:25:35">
          <Html>
        &lt;div class="markDownOutput "&gt;found the issue, following is working for me, sorry to put the question in hurry without enough research:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;For Each mc In ws.MergedCells
            Dim s As String = ws.Cells(mc).Value(0, 0)
            If String.IsNullOrEmpty(s) Then Continue For

            If s.StartsWith("{") AndAlso s.EndsWith("}") Then
                If dicKeyValue.ContainsKey(s) Then
                    Dim arr() As String = mc.Split(":")
                    ws.SetValue(arr(0), dicKeyValue(s))
                End If
            End If
        Next&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Open EPPlus-generated excel on-screen without file io permissions">
      <Posts>
        <Post From="ReneCDad" When="17/03/2016 00:36:02">
          <Html>
        &lt;div class="markDownOutput "&gt;I am trying to create an excel doc from a datatable and open it in excel for a user. Done in a webpage on a button click and I pass in a pre-populated datatable. The below code works excellent on my local machine, and in my company's development environment
 (which is full trust): when button clicked, I get a save or open dialog, which is what I want. I choose Open, and it opens in excel. The problem is it gives this error when I use it in our production environment (which is medium trust):
&lt;code&gt;System.Security.SecurityException Exception Message: Request for the permission of type 'System.Security.Permissions.FileIOPermission, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' failed.&lt;/code&gt;
&lt;br&gt;
&lt;br&gt;
I am not trying to create a file (an in fact cannot due to medium trust environment I am restricted to), just open the created excel on-screen in excel so they can view it and choose to save-as if they wish. Is there a way to do this which will work in a medium
 trust environment? I do not have access to alter any permissions /settings on the web server so cannot give FileIOPermission to get this to work.
&lt;br&gt;
&lt;br&gt;
Here is the code: &lt;br&gt;
&lt;br&gt;
ExcelPackage p = new ExcelPackage(); &lt;br&gt;
p.Workbook.Worksheets.Add(worksheetname); &lt;br&gt;
ExcelWorksheet workSheet = p.Workbook.Worksheets[1]; &lt;br&gt;
workSheet.Cells[1,1].LoadFromDataTable(dt, true); &lt;br&gt;
var range = workSheet.Cells[1,1,dt.Rows.Count,dt.Columns.Count]; &lt;br&gt;
var table = workSheet.Tables.Add(range, "results"); &lt;br&gt;
table.ShowTotal = false; &lt;br&gt;
table.TableStyle = TableStyles.Medium4; &lt;br&gt;
workSheet.Cells.AutoFitColumns(); &lt;br&gt;
workSheet.Cells.Style.HorizontalAlignment = ExcelHorizontalAlignment.Left; &lt;br&gt;
workSheet.View.ShowGridLines = false; &lt;br&gt;
Response.Clear(); &lt;br&gt;
Response.ClearHeaders(); &lt;br&gt;
Response.BinaryWrite(p.GetAsByteArray()); &lt;br&gt;
//Also tried this instead of above line with same error: p.SaveAs(Response.OutputStream);
&lt;br&gt;
Response.ContentType = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";
&lt;br&gt;
Response.AddHeader("content-disposition", "attachment; filename=" + filename + ".xlsx");
&lt;br&gt;
Response.End();&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Make Excel Right To Left">
      <Posts>
        <Post From="iPazooki" When="12/03/2016 08:15:07">
          <Html>
        &lt;div class="markDownOutput "&gt;is there any way to make excel layout Right to Left ?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Writing 4 Million cells quickly (not cell by cell, but e.g.  by column or by range)">
      <Posts>
        <Post From="MRanftelhuber" When="23/02/2016 12:55:12">
          <Html>
        &lt;div class="markDownOutput "&gt;I am rather new to EPPlus, but so far it worked great for me. &lt;br&gt;
&lt;br&gt;
I have measured about 4 Million data poins in an array in Visual C#. &lt;br&gt;
&lt;br&gt;
Now I need to write the into an Excel Spreadsheet. Doing this "Cell by Cell" works, but becomes very slow (many hours simply for writing the file in the end). In particular this line takes forever:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;            ExcelPkg.SaveAs(stream);
&lt;/code&gt;&lt;/pre&gt;
Is there a possibility to write a full range of cells, by creating a (2D) array of objects in C# and writing the full array to the Worksheet with EPPlus? This would be great! I found this way of speeding up the writing process within
&lt;br&gt;
&lt;br&gt;
using Microsoft.Office.Interop.Excel; &lt;br&gt;
&lt;br&gt;
Here the syntax is (where formattedSpectralData is the 2D array of doubles in this case):&lt;br&gt;
&lt;pre&gt;&lt;code&gt;        var startCell = (Range)spectraWorksheet.Cells[startSpecRow, startSpecCol];
        var endCell = (Range)spectraWorksheet.Cells[nSpectra, nWavelengthVals];
        var writeRange = spectraWorksheet.Range[startCell, endCell];

        writeRange.Value2 = formattedSpectralData;
&lt;/code&gt;&lt;/pre&gt;
Is there anything like this in EPPlus? I'd really love to continue using EPPlus, but at the moment this is just by far too slow.
&lt;br&gt;
&lt;br&gt;
Thanks a lot in advance!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="kazy111" When="11/03/2016 11:15:02">
          <Html>
        &lt;div class="markDownOutput "&gt;In ver. 4.0.5, EPPlus supports load data from Array, DataSet, DataReader, or Text.
&lt;br&gt;
But they are very slow (because simply loops range cell, in implementation). &lt;br&gt;
&lt;br&gt;
I need to work with huge excel data, too, &lt;br&gt;
so I've tried to improve implementation out of necessity, &lt;br&gt;
and created patch set &amp;amp; pull request. &lt;br&gt;
It supports 2D array set to Value (like your sample). &lt;br&gt;
&lt;br&gt;
You can take it if you like: &lt;br&gt;
&lt;a href="http://epplus.codeplex.com/SourceControl/network/forks/kazy111/EPPMemoryOptimization/contribution/8725" rel="nofollow"&gt;http://epplus.codeplex.com/SourceControl/network/forks/kazy111/EPPMemoryOptimization/contribution/8725&lt;/a&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Shapes/Drawings - parsing?">
      <Posts>
        <Post From="philipv" When="10/03/2016 20:21:56">
          <Html>
        &lt;div class="markDownOutput "&gt;I see that we can add shapes via &lt;a href="https://epplus.codeplex.com/wikipage?title=ContentSheetExample" rel="nofollow"&gt;
https://epplus.codeplex.com/wikipage?title=ContentSheetExample&lt;/a&gt; &lt;br&gt;
&lt;br&gt;
How can we parse that back when reading the sheet? There is a sheet I am trying to parse and the template it uses has 2 text boxes or drawing/shape objects. I can see the data I want to get to via the debugger, but don't know how to fully access the data in
 code.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Files are Read Only after using EPPlus">
      <Posts>
        <Post From="jonvh" When="02/03/2016 21:20:16">
          <Html>
        &lt;div class="markDownOutput "&gt;This is most likely a rookie question, but I've looked everywhere and I can't find the answer. I'm just starting to experiment with EPPlus, and it seems that no matter what I do, the file that gets created opens as Read-Only in Excel. Just to keep it simple,
 I stripped everything else out of my code and it still does it. Here is what I've got so far.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;        Dim FilePath As New System.IO.FileInfo("C:\test.xlsx")
        Dim EPPlusPackage As New OfficeOpenXml.ExcelPackage()

        EPPlusPackage.Workbook.Worksheets.Add("Sheet1")

        EPPlusPackage.SaveAs(FilePath)

        End&lt;/code&gt;&lt;/pre&gt;
Thanks for any help.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="jonvh" When="08/03/2016 00:05:34">
          <Html>
        &lt;div class="markDownOutput "&gt;well this was definitely a stupid mistake on my part. For any developers out there, don't save to a protected directory like "c:\". As soon as I redefined the save location to some other directory everything worked fine.
&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="CLR integration">
      <Posts>
        <Post From="grahamearmitage" When="24/09/2013 12:26:59">
          <Html>
        &lt;div class="markDownOutput "&gt;Dear all, &lt;br&gt;
&lt;br&gt;
I have a CLR stored procedure project where I need to create .xlsx spreadsheets. &lt;br&gt;
&lt;br&gt;
Does anyone know how to register the EPPlus.dll assembly so it's accessible from a CLR stored procedure?
&lt;br&gt;
&lt;br&gt;
On the SQL box I've run:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;CREATE ASSEMBLY EPPlus 
    FROM '&amp;lt;filepath&amp;gt;\EPPlus.dll'
    WITH PERMISSION_SET = EXTERNAL_ACCESS;&lt;/code&gt;&lt;/pre&gt;
but this error message is shown:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;Assembly 'EPPlus' references assembly 'windowsbase, version=3.0.0.0, culture=neutral, publickeytoken=31bf3856ad364e35.', which is not present in the current database. SQL Server attempted to locate and automatically load the referenced assembly from the same location where referring assembly came from, but that operation has failed (reason: 2(The system cannot find the file specified.)). Please load the referenced assembly into the current database and retry your request.
&lt;/code&gt;&lt;/pre&gt;
Where can I get "windowsbase" and what else do I need to do? &lt;br&gt;
&lt;br&gt;
Cheers, &lt;br&gt;
&lt;br&gt;
Grahame&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="richardtallent" When="01/10/2013 22:31:10">
          <Html>
        &lt;div class="markDownOutput "&gt;I'm not sure specifically about that particular issue, but EPPlus may reference a number of BCL methods that aren't available within the CLR context running in SQL Server.
&lt;br&gt;
&lt;br&gt;
For more information, see this TechNet document: &lt;br&gt;
&lt;br&gt;
&lt;a href="http://technet.microsoft.com/en-us/library/ms403276(v=sql.110).aspx" rel="nofollow"&gt;http://technet.microsoft.com/en-us/library/ms403276(v=sql.110).aspx&lt;/a&gt;
&lt;br&gt;
&lt;br&gt;
There may also be a disconnect between the version of .NET that your EPPlus DLL is compiled to and the one available within your MSSQL instance. I don't recall offhand how to switch the version in MSSQL.
&lt;br&gt;
&lt;br&gt;
Finally, have you enabled CLR hosting within your SQL Server instance? There's a procedure to doing so, and until you do, you won't be able to load any .NET libraries.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="grahamearmitage" When="07/10/2013 08:55:23">
          <Html>
        &lt;div class="markDownOutput "&gt;Thanks for getting back to me. &lt;br&gt;
&lt;br&gt;
Yes I've run the "CLR Enabled" option but to no avail. We've decided to go down the Console/Service/Library polling route as the project needed starting ASAP.
&lt;br&gt;
&lt;br&gt;
Cheers, &lt;br&gt;
&lt;br&gt;
Grahame&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="bb0165" When="24/02/2014 22:25:03">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi Grahame,&lt;br&gt;
&lt;br&gt;
Did you find a way to get around with this problem...&lt;br&gt;
I have the same issue ...&lt;br&gt;
&lt;br&gt;
Thanks&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="QFleurat" When="18/02/2016 19:19:39">
          <Html>
        &lt;div class="markDownOutput "&gt;I am running to a similar issue, is there a solution to getting a EPPlus to work in SQL CLR?
&lt;br&gt;
&lt;br&gt;
The steps I followed. &lt;br&gt;
&lt;ol&gt;
&lt;li&gt;I added EPPlus reference to my SQL CLR project "CLRExcel" in VS 2012 using .net framework 4
&lt;/li&gt;&lt;li&gt;Tested with a console app. CLRExcel works well, read xlsx files... &lt;/li&gt;&lt;li&gt;On SQL 2012 CREATED ASSEMBLY system.drawing from 'c:\Windows\Microsoft.NET\Framework64\v4.0.30319\system.drawing.dll' WITH PERMISSION_SET = UNSAFE; This is required by EEPlus
&lt;/li&gt;&lt;li&gt;Then CREATE ASSEMBLY [epplus] from [..HexStream] WITH PERMISSION_SET = UNSAFE;
&lt;/li&gt;&lt;li&gt;So far no errors &lt;/li&gt;&lt;li&gt;Now when I try to create my CLRExcel CLR Assembly on SQL I get the error "Assembly 'epplus, version=4.0.5.0, culture=neutral, publickeytoken=ea159fdaa78159a1.' was not found in the SQL catalog."
&lt;br&gt;
"using this code &lt;br&gt;
Create ASSEMBLY [CLRExcel]&lt;br&gt;
FROM 0x4D5A9000030........&lt;br&gt;
WITH PERMISSION_SET = UNSAFE&lt;br&gt;
&lt;/li&gt;&lt;/ol&gt;
Thanks &lt;br&gt;
Quentin&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="ExcelPackage.ToDataSet() extension method">
      <Posts>
        <Post From="mikecole" When="18/02/2016 14:37:27">
          <Html>
        &lt;div class="markDownOutput "&gt;Would the maintainers be interested in me committing an extension method that takes an ExcelPackage and easily converts it to a DataSet? If so, where in the solution should I add it? Thanks!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Unreadable content when creating a table with header columns that contain newline">
      <Posts>
        <Post From="lhorn" When="17/02/2016 15:40:38">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
I have created a custom table within a worksheet where multiple header columns contain a newline character with wraptext turned on the for the column. When I generate a spreadsheet based on the data excel finds unreadable content.
&lt;br&gt;
&lt;br&gt;
Through a quick look at the source and analyzing the sheet content it appears that the newline character is getting encoded with a _x005F_x005F within the contents for the cell and this is causing the bad data. I believe this is due to the fact that the ExcelEncodeString
 function in ExcelWorkBook.cs is expecting to read a \n for the newline character but the newline has already been converted to unicode _x000A and that value meets the regular expression which encodes it with _x005F_x005F.
&lt;br&gt;
&lt;br&gt;
I have tried specifying newline in different formats in c# (unicode etc) to no avail. If anyone else has encountered this problem or can offer any insights then it would be greatly appreciated
&lt;br&gt;
&lt;br&gt;
thanks &lt;br&gt;
&lt;br&gt;
Info: &lt;br&gt;
&lt;br&gt;
eg. Header column data for table: Cost\n2016-2\nTest &lt;br&gt;
&lt;br&gt;
I am generating my worksheet data cell by cell dynamically by setting the .Value property on each cell. After the cells with data have been filled then I am creating a new table based on the entire range of cells within my spreadsheet as below:
&lt;br&gt;
&lt;br&gt;
var range = m_workSheet.Cells[1, 1, rowIndex - 1, columnsInfo.Count];&lt;br&gt;
&lt;pre&gt;&lt;code&gt;        var table = m_workSheet.Tables.Add(range, "table1");
        table.ShowTotal = false;
        table.TableStyle = TableStyles.Light11;

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Remove named styles">
      <Posts>
        <Post From="JohannW" When="15/02/2016 10:38:26">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi! &lt;br&gt;
&lt;br&gt;
I have several excel files which all have a few hundred named styles; They are all copies of the standard styles. A screenshot to illustrate the situation:
&lt;br&gt;
&lt;br&gt;
&lt;img alt="Image" src="http://i.imgur.com/8p1tZKn.png"&gt; &lt;br&gt;
&lt;br&gt;
I have really no clue how they were created. &lt;br&gt;
&lt;br&gt;
Is there any way to remove these named styles? &lt;br&gt;
&lt;br&gt;
Thanks! &lt;br&gt;
&lt;br&gt;
Johann&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="JohannW" When="17/02/2016 08:14:57">
          <Html>
        &lt;div class="markDownOutput "&gt;Ok, after some extensive trial and error I found some things: &lt;br&gt;
&lt;br&gt;
I tried to delete all non-builtin style with the following code:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;        static void removeNonBuiltInStylesXml(ExcelPackage package)
        {
            var wkb = package.Workbook;
            var cellStyles = wkb.StylesXml["styleSheet"]["cellStyles"];
            var nodeList = new List&amp;lt;System.Xml.XmlElement&amp;gt;();

            foreach (System.Xml.XmlElement item in cellStyles)
            {
                var str = item.Attributes[0].Value;
                if (!item.HasAttribute("builtinId"))
                {
                    Console.WriteLine("Found XML: " + str);
                    nodeList.Add(item);
                }
            }
            foreach (System.Xml.XmlElement item in nodeList)
            {
                cellStyles.RemoveChild(item);
            }
        }&lt;/code&gt;&lt;/pre&gt;
I use the nodeList because if I try to call RemoveChild directly, the foreach loop immediately returns after the first element. But when I create a list with the found elements and delete them later, it seems to work at first glance: If I inspect the cellStyles
 tree after the loop with RemoveChild, only 41 entries remain. But the resulting excel file still has all the rogue styles in it - apparently the styles are saved somewhere else and rebuild before saving occurs (perhaps because of a call to UpdateXml()?)
&lt;br&gt;
&lt;br&gt;
My next attempt was really desperate but also somewhat successful;&lt;br&gt;
&lt;pre&gt;&lt;code&gt;        static void removeBuiltInStyles(ExcelPackage package)
        {
            var wkb = package.Workbook;
            var namedStyles = wkb.Styles.NamedStyles;

            foreach (var item in namedStyles)
            {
                if (item.BuildInId &amp;lt; 0)
                {
                    Console.WriteLine("Found standard: " + item.Name);
                    item.BuildInId = 0;
                }
            }
        }&lt;/code&gt;&lt;/pre&gt;
After opening the resulting excel file, everything looks ok - All non-builtin styles are gone! Wohoo!
&lt;br&gt;
But when I inspect the file contents during debugging, all the cellStyles are still there - That gets me a little worried....
&lt;br&gt;
&lt;br&gt;
I have the feeling I'm missing something fundamental here - Can someone offer some advice?
&lt;br&gt;
&lt;br&gt;
Thanks, &lt;br&gt;
&lt;br&gt;
Johann&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Setting XAxis labels' alignment to 45 degress or vertical">
      <Posts>
        <Post From="nikita93" When="17/02/2016 00:08:20">
          <Html>
        &lt;div class="markDownOutput "&gt;I am trying to alter the orientation of the XAxis labels. Currently the labels are displayed in a horizontal position which makes the x axis look very cluttered. Is it possible to change the axis' label alignment to 45 degrees, or if not then vertical?
&lt;br&gt;
&lt;br&gt;
I know that it is possible to change the XAxis' title to have a vertical orientation, but I have not found a way to do the same for the XAxis' labels.
&lt;br&gt;
&lt;br&gt;
var chart = chartWorksheet.Drawings.AddChart(entry.Key,eChartType.XYScatterLinesNoMarkers);
&lt;br&gt;
chart.XAxis.Title.TextVertical = eTextVerticalType.Vertical;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Multiple Fill Options">
      <Posts>
        <Post From="eburley" When="16/02/2016 01:07:14">
          <Html>
        &lt;div class="markDownOutput "&gt;I'm trying to set a cell's background to solid, light gray, and the pattern to light up, black.
&lt;br&gt;
The following code gives a black background, with light gray stripes. &lt;br&gt;
&lt;br&gt;
ws1.Cells["A7:E9"].Style.Fill.PatternType = OfficeOpenXml.Style.ExcelFillStyle.Solid;
&lt;br&gt;
ws1.Cells["A7:E9"].Style.Fill.PatternColor.SetColor(Color.LightGray); &lt;br&gt;
ws1.Cells["A7:E9"].Style.Fill.PatternType = OfficeOpenXml.Style.ExcelFillStyle.LightUp;
&lt;br&gt;
ws1.Cells["A7:E9"].Style.Fill.PatternColor.SetColor(Color.Black); &lt;br&gt;
&lt;br&gt;
I can't seem to find the combination that gives me the correct output. &lt;br&gt;
Can anyone help?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="eburley" When="16/02/2016 17:00:04">
          <Html>
        &lt;div class="markDownOutput "&gt;I've got it to work, but I'm pretty sure there is a bug somewhere. &lt;br&gt;
This is the code that works:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;        ws1.Cells["A7:E9"].Style.Fill.PatternType = OfficeOpenXml.Style.ExcelFillStyle.LightUp;
        ws1.Cells["A7:E9"].Style.Fill.PatternColor.SetColor(Color.LightGray);
        ws1.Cells["A7:E9"].Style.Fill.BackgroundColor.SetColor(Color.Black);
&lt;/code&gt;&lt;/pre&gt;
The pattern (the diagonal lines) are black, and the cell background is light gray.
&lt;br&gt;
This is what I want, but the code sure seems backwards.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Bubble plot">
      <Posts>
        <Post From="intermine" When="16/02/2016 02:39:44">
          <Html>
        &lt;div class="markDownOutput "&gt;Is the bubble plot on the roadmap anywhere? I'd like to be able to insert bubble plots into excel. Or is there a workaround?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Changing chart properties in c#">
      <Posts>
        <Post From="kchoeppner" When="11/02/2016 18:54:08">
          <Html>
        &lt;div class="markDownOutput "&gt;I'm trying to make my charts not move when cells resize, which can be done by an option in the chart formatting menu in excel. Is there anyway to do this programmatically?
&lt;br&gt;
&lt;br&gt;
thanks&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Is it possible to delete a cell and move up?">
      <Posts>
        <Post From="Corby" When="07/02/2016 04:43:05">
          <Html>
        &lt;div class="markDownOutput "&gt;Microsoft.Interop.Office.Excel has a real simple way to delete: &lt;br&gt;
&lt;br&gt;
// delete this cell &lt;br&gt;
range.Select(); &lt;br&gt;
range.Delete(Excel.XlDirection.xlUp); &lt;br&gt;
&lt;br&gt;
Is there any way to do this using this library? &lt;br&gt;
&lt;br&gt;
Thanks&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Expressions and conditional formatting">
      <Posts>
        <Post From="mulxbf" When="02/02/2016 11:53:24">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello. &lt;br&gt;
&lt;br&gt;
Can someone tell me how can I create conditional formatting rule based on excel formula?
&lt;br&gt;
I need to implement highlighting for empty cells. I am trying to use ISBLANK excel formula. My current code looks like this:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;IExcelConditionalFormattingExpression excelRule = sheet.ConditionalFormatting.AddExpression(range);
excelRule.Style.Fill.BackgroundColor.Color = color;
excelRule.Formula = "ISBLANK( ??? )";&lt;/code&gt;&lt;/pre&gt;
And I cannot figure (or google) a way to reference current cell for CF expression. Or am I entirely on the wrong track?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="nickdmax" When="05/02/2016 23:47:14">
          <Html>
        &lt;div class="markDownOutput "&gt;I think this works just as it does in Excel proper.&lt;br&gt;
All you need to do is place in the reference for the top-left cell. So for example if your range is 'A1:B10' then the formula is "ISBLANK(A1)"&lt;br&gt;
&lt;br&gt;
assuming that range is a ExcelAddress object.&lt;br&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;IExcelConditionalFormattingExpression excelRule = sheet.ConditionalFormatting.AddExpression(range);
excelRule.Style.Fill.BackgroundColor.Color = color;
excelRule.Formula = &lt;span style="color: rgb(163, 21, 21);"&gt;"ISBLANK("&lt;/span&gt; +range.Start.Address + &lt;span style="color: rgb(163, 21, 21);"&gt;")"&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Merge and resize columns">
      <Posts>
        <Post From="stolx10" When="26/01/2016 09:44:05">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi,&lt;br&gt;
&lt;br&gt;
I've taken the last version of EPPlus (4.0.5), I hoped my problems are solved. But No.&lt;br&gt;
&lt;br&gt;
I 've problems with merge and resize columns after all my data were filled.&lt;br&gt;
&lt;pre&gt;&lt;code&gt; using (ExcelPackage package = new ExcelPackage())
            {
                //ExcelWorkbook wkbook = new ExcelWorkbook();
                ExcelWorksheet currWkSheet ;

                int mancheId = 1;
                foreach (Manche manche in emission.Manches)
                { 
                    int questionID = 1;
                    foreach (Question question in manche.questions)
                    {
                        string worksheetName = "RD_" + mancheId.ToString();
                        if (mancheId &amp;gt; 1)
                        {
                            worksheetName += "." + questionID.ToString();
                        }

                        currWkSheet = package.Workbook.Worksheets.Add(worksheetName);

                        // LIGNE 1
                        currWkSheet.Cells["A1"].Value = manche.nom;
                        currWkSheet.Cells["B1"].Value = question.type;

                        currWkSheet.Cells["C1"].Value = emission.Nom;
                        //currWkSheet.Cells["C1"].Style.WrapText = true;

                        currWkSheet.Cells["D1"].Value = " ";
                        currWkSheet.Cells["E1"].Value = " ";
                        currWkSheet.Cells["F1"].Value = " ";
                        currWkSheet.Cells["G1"].Value = " ";
                        
                        currWkSheet.Cells["A1:G1"].Style.Font.Bold = true;

                        currWkSheet.Cells["A1:G1"].Style.VerticalAlignment = OfficeOpenXml.Style.ExcelVerticalAlignment.Center;
                        currWkSheet.Cells["A1:G1"].Style.HorizontalAlignment = OfficeOpenXml.Style.ExcelHorizontalAlignment.Center;
                        currWkSheet.Cells["A1:G1"].Style.Fill.PatternType = OfficeOpenXml.Style.ExcelFillStyle.Solid;
                        currWkSheet.Cells["A1:G1"].Style.Fill.BackgroundColor.SetColor(System.Drawing.Color.Transparent);
                        currWkSheet.Cells["A1"].Style.Fill.BackgroundColor.SetColor(System.Drawing.Color.Blue);
                        currWkSheet.Cells["C1"].Style.Fill.BackgroundColor.SetColor(System.Drawing.Color.Gray);

[...] bla bla bla

    

                        currWkSheet.Cells["B1:E1"].Merge = true;
                        currWkSheet.Cells["B2:E2"].Merge = true;
                        currWkSheet.Cells["B3:E3"].Merge = true;

                        currWkSheet.Column(1).Width = 10;
                        currWkSheet.Column(2).Width = 25;
                        currWkSheet.Column(3).Width = 10;
                        currWkSheet.Column(4).Width = 25;
                        currWkSheet.Column(5).Width = 10;
                        currWkSheet.Column(6).Width = 18;
                        currWkSheet.Column(7).Width = 10;

                        questionID++;
                    }
                    mancheId++;

                }
       }&lt;/code&gt;&lt;/pre&gt;
I tried to use currWkSheet.Cells["A:A"].AutoFitColumns(10) for exemple, but it doesn't work.&lt;br&gt;
&lt;br&gt;
After merging, I want to resize my columns for printing document.&lt;br&gt;
&lt;br&gt;
How do I suppose to do ?&lt;br&gt;
&lt;br&gt;
Thx&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="stolx10" When="26/01/2016 12:05:33">
          <Html>
        &lt;div class="markDownOutput "&gt;Sorry &lt;br&gt;
&lt;br&gt;
I've found my mystake. &lt;br&gt;
&lt;br&gt;
After create my XLSX file, I transform it onto a pdf file. &lt;br&gt;
&lt;br&gt;
In my code on pdf transformation, I had this code : "wsk.Columns.AutoFit();" so my column size was disabled. I have commented this, and it's ok now.
&lt;br&gt;
&lt;br&gt;
Sorry for disturb. You could to delete my tribute.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Reading in HTML?">
      <Posts>
        <Post From="jturk9" When="22/01/2016 17:29:16">
          <Html>
        &lt;div class="markDownOutput "&gt;I am trying to load html files and then send them to the user as Excel file on a web app. With Excel, you just open the html file and it converts it to an Excel file, retaining all the style.&lt;br&gt;
&lt;br&gt;
Is there a way with EPPlus to read in an html file that would keep all the style? For example, my html file looks like this:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;table cellspacing="0" cellpadding="0" rules="all" style="border-width:1px;border-style:solid;width:439px;border-collapse:collapse;"&amp;gt;
    &amp;lt;COLGROUP&amp;gt;&amp;lt;col width=200px&amp;gt;&amp;lt;col width=80px&amp;gt;&amp;lt;col width=80px&amp;gt;&amp;lt;col width=79px&amp;gt;&amp;lt;/COLGROUP&amp;gt;
    &amp;lt;tr style="height:17px;"&amp;gt;
        &amp;lt;td align="left" valign="top" style="color:windowtext;background-color:window;"&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td align="center" valign="middle" colspan="3" rowspan="1" style="color:White;background-color:DarkBlue;font-family:Arial;font-size:8pt;font-weight:normal;font-style:normal;text-decoration:none;"&amp;gt;Status&amp;lt;/td&amp;gt;
    &amp;lt;/tr&amp;gt;&amp;lt;tr style="height:28px;"&amp;gt;
        &amp;lt;td align="left" valign="top" style="color:windowtext;background-color:window;"&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td align="right" valign="top" style="color:Black;background-color:Tan;font-family:Arial;font-size:8pt;font-weight:normal;font-style:normal;text-decoration:none;"&amp;gt;#&amp;lt;/td&amp;gt;&amp;lt;td align="right" valign="top" style="color:Black;background-color:Tan;font-family:Arial;font-size:8pt;font-weight:normal;font-style:normal;text-decoration:none;"&amp;gt;Avg. Time (min)&amp;lt;/td&amp;gt;&amp;lt;td align="right" valign="top" style="color:Black;background-color:Tan;font-family:Arial;font-size:8pt;font-weight:normal;font-style:normal;text-decoration:none;"&amp;gt;Median (min)&amp;lt;/td&amp;gt;
    &amp;lt;/tr&amp;gt;&amp;lt;tr style="height:17px;"&amp;gt;
        &amp;lt;td align="left" valign="top" style="color:Black;background-color:AntiqueWhite;font-family:Arial;font-size:8pt;font-weight:normal;font-style:normal;text-decoration:none;"&amp;gt;Respondents&amp;lt;/td&amp;gt;&amp;lt;td align="right" valign="middle" style="color:windowtext;background-color:window;"&amp;gt;854&amp;lt;/td&amp;gt;&amp;lt;td align="right" valign="middle" style="color:Black;background-color:White;font-family:Arial;font-size:8pt;font-weight:normal;font-style:normal;text-decoration:none;"&amp;gt;6&amp;lt;/td&amp;gt;&amp;lt;td align="right" valign="middle" style="color:Black;background-color:White;font-family:Arial;font-size:8pt;font-weight:normal;font-style:normal;text-decoration:none;"&amp;gt;2&amp;lt;/td&amp;gt;
    &amp;lt;/tr&amp;gt;&amp;lt;tr style="height:17px;"&amp;gt;
        &amp;lt;td align="left" valign="top" style="color:Black;background-color:AntiqueWhite;font-family:Arial;font-size:8pt;font-weight:normal;font-style:normal;text-decoration:none;"&amp;gt;Completes&amp;lt;/td&amp;gt;&amp;lt;td align="right" valign="middle" style="color:windowtext;background-color:window;"&amp;gt;160&amp;lt;/td&amp;gt;&amp;lt;td align="right" valign="middle" style="color:Black;background-color:White;font-family:Arial;font-size:8pt;font-weight:normal;font-style:normal;text-decoration:none;"&amp;gt;21&amp;lt;/td&amp;gt;&amp;lt;td align="right" valign="middle" style="color:Black;background-color:White;font-family:Arial;font-size:8pt;font-weight:normal;font-style:normal;text-decoration:none;"&amp;gt;20&amp;lt;/td&amp;gt;
    &amp;lt;/tr&amp;gt;&amp;lt;tr style="height:17px;"&amp;gt;
        &amp;lt;td align="left" valign="top" style="color:Black;background-color:AntiqueWhite;font-family:Arial;font-size:8pt;font-weight:normal;font-style:normal;text-decoration:none;"&amp;gt;Incompletes&amp;lt;/td&amp;gt;&amp;lt;td align="right" valign="middle" style="color:windowtext;background-color:window;"&amp;gt;261&amp;lt;/td&amp;gt;&amp;lt;td align="right" valign="middle" style="color:Black;background-color:White;font-family:Arial;font-size:8pt;font-weight:normal;font-style:normal;text-decoration:none;"&amp;gt;2&amp;lt;/td&amp;gt;&amp;lt;td align="right" valign="middle" style="color:Black;background-color:White;font-family:Arial;font-size:8pt;font-weight:normal;font-style:normal;text-decoration:none;"&amp;gt;0&amp;lt;/td&amp;gt;
    &amp;lt;/tr&amp;gt;&amp;lt;tr style="height:17px;"&amp;gt;
        &amp;lt;td align="left" valign="top" style="color:Black;background-color:AntiqueWhite;font-family:Arial;font-size:8pt;font-weight:normal;font-style:normal;text-decoration:none;"&amp;gt;Terminates&amp;lt;/td&amp;gt;&amp;lt;td align="right" valign="middle" style="color:windowtext;background-color:window;"&amp;gt;406&amp;lt;/td&amp;gt;&amp;lt;td align="right" valign="middle" style="color:Black;background-color:White;font-family:Arial;font-size:8pt;font-weight:normal;font-style:normal;text-decoration:none;"&amp;gt;2&amp;lt;/td&amp;gt;&amp;lt;td align="right" valign="middle" style="color:Black;background-color:White;font-family:Arial;font-size:8pt;font-weight:normal;font-style:normal;text-decoration:none;"&amp;gt;2&amp;lt;/td&amp;gt;
    &amp;lt;/tr&amp;gt;

&amp;lt;/table&amp;gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Corrupted workbook when open/save workbook with table+totals">
      <Posts>
        <Post From="jsjslim" When="14/01/2016 06:03:17">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi&lt;br&gt;
&lt;br&gt;
I'm getting corrupted workbooks when opening/saving workbooks using epplus.&lt;br&gt;
&lt;br&gt;
Steps to replicate:&lt;br&gt;
&lt;ol&gt;
&lt;li&gt;Create a workbook in Excel with one table and show its total &lt;/li&gt;&lt;li&gt;Open the workbook using EPPlus and save immediately after &lt;/li&gt;&lt;li&gt;The saved workbook is corrupted.&lt;br&gt;
&lt;/li&gt;&lt;/ol&gt;
Code is as simple as this:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;    class Program
    {
        private static void Main(string[] args)
        {
            var file = new FileInfo(@"table.xlsx");
            using (var package = new ExcelPackage(file))
            {
                package.Save();
            }
        }
    }&lt;/code&gt;&lt;/pre&gt;
Can someone tell me if I'm missing something?&lt;br&gt;
Or is it an actual bug?&lt;br&gt;
&lt;br&gt;
Thanks&lt;br&gt;
Js&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Progmmatically printing a single worksheet from a package....how to do it?">
      <Posts>
        <Post From="mindoffury" When="13/01/2016 15:19:35">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello, &lt;br&gt;
Using C# &lt;br&gt;
&lt;br&gt;
I have been searching for how to print a single worksheet from a package and I must be having a brain fart because I cannot find anything for the life of me.
&lt;br&gt;
&lt;br&gt;
The excel interop has functions like PrintOut and PrintOutEx that allowed you to print out a single sheet.
&lt;br&gt;
&lt;br&gt;
What is the Epplus equivalent of this? &lt;br&gt;
&lt;br&gt;
Thanks is advance for any help you can offer.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Error when adding table">
      <Posts>
        <Post From="bjallemad" When="12/01/2016 06:30:17">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
The following code worked in 4.0.4, but an error occurs in 4.0.5:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;ExcelPackage pck = new ExcelPackage();
ExcelWorksheet ws = pck.Workbook.Worksheets.Add("Test");
OfficeOpenXml.Table.ExcelTable tbl = ws.Tables.Add(new ExcelAddress(1, 1, 2, 2), "");&lt;/code&gt;&lt;/pre&gt;
The error is: Range does not belong to worksheet. Parameter name: Range &lt;br&gt;
&lt;br&gt;
Regards &lt;br&gt;
Andreas&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Connections">
      <Posts>
        <Post From="mbulava" When="08/01/2016 15:02:59">
          <Html>
        &lt;div class="markDownOutput "&gt;I can't see that Connections or Queries are available in this, any plans to add?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="ExcelPackage.GetAsByteArray() performance">
      <Posts>
        <Post From="rparker_rti" When="31/12/2015 16:15:23">
          <Html>
        &lt;div class="markDownOutput "&gt;I'm writing an excel spreadsheet by cloning a template file &lt;br&gt;
&lt;pre&gt;&lt;code&gt;            FileInfo templateFile = new FileInfo(templateFilePath);
            using (ExcelPackage package = new ExcelPackage(templateFile, true))
            {...}

&lt;/code&gt;&lt;/pre&gt;
and then creating 4 worksheets. Each worksheet represents a category of data for a list of objects. The worksheets are constructed cell by cell like this:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;                ws.Cells[rowNumber, (int)GeneralColumns.SpouseFirstName].Value = student.SpouseFirstName;&lt;/code&gt;&lt;/pre&gt;
The worksheets have a varying number of columns, but on overage, say 40 columns. We use quite a few DataValidations, like this:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;                IExcelDataValidationList val = ws.DataValidations.AddListValidation(ws.Cells[rowNumber, (int)GeneralColumns.DobMonth].Address);
                val.Formula.ExcelFormula = "=Months";
&lt;/code&gt;&lt;/pre&gt;
All of this works fine when the number of rows on each sheet is small, but when we get up to about 100 rows per sheet, we start running into performance problems. Generating the workbook takes between 20 - 30 seconds in that case, but the real killer is the
 call to GetAsByteArray() to return results to the client. That call takes 50 - 60 seconds.
&lt;br&gt;
&lt;br&gt;
We upgraded from version 3.1.2 to 4.0.4 but, if anything, the performance got worse after that change.
&lt;br&gt;
&lt;br&gt;
My question is: are we seeing the expected behavior in terms of performance? Or am I doing something horribly wrong? I'm hoping it's the latter. Any insights or constructive suggestions are welcome.
&lt;br&gt;
&lt;br&gt;
Thanks, &lt;br&gt;
R.L.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="03/01/2016 08:02:03">
          <Html>
        &lt;div class="markDownOutput "&gt;I cannot see that this should be a general performance issue. The code below takes approx. 600 ms on my laptop:&lt;br&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;var&lt;/span&gt; stopwatch = &lt;span style="color: blue;"&gt;new&lt;/span&gt; Stopwatch();
stopwatch.Start();
&lt;span style="color: blue;"&gt;using&lt;/span&gt; (&lt;span style="color: blue;"&gt;var&lt;/span&gt; pck = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage())
{
    &lt;span style="color: blue;"&gt;for&lt;/span&gt; (&lt;span style="color: blue;"&gt;var&lt;/span&gt; ws = 0; ws &amp;lt; 4; ws++)
    {
        &lt;span style="color: blue;"&gt;var&lt;/span&gt; wsName = &lt;span style="color: rgb(163, 21, 21);"&gt;"worksheet"&lt;/span&gt; + ws;
        &lt;span style="color: blue;"&gt;var&lt;/span&gt; currentSheet = pck.Workbook.Worksheets.Add(wsName);
        &lt;span style="color: blue;"&gt;for&lt;/span&gt; (&lt;span style="color: blue;"&gt;var&lt;/span&gt; column = 1; column &amp;lt; 40; column++)
        {
            &lt;span style="color: blue;"&gt;for&lt;/span&gt; (&lt;span style="color: blue;"&gt;var&lt;/span&gt; row = 2; row &amp;lt; 101; row++)
            {
                currentSheet.Cells[row, column].Value = row + column;
            }
        }
        &lt;span style="color: blue;"&gt;for&lt;/span&gt; (&lt;span style="color: blue;"&gt;var&lt;/span&gt; dv = 1; dv &amp;lt; 10; dv++)
        {
            &lt;span style="color: blue;"&gt;var&lt;/span&gt; validation = currentSheet.Cells[1, dv].DataValidation.AddIntegerDataValidation();
            validation.ShowErrorMessage = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
            validation.Prompt = &lt;span style="color: rgb(163, 21, 21);"&gt;"Only numeric input here"&lt;/span&gt;;
            validation.ErrorStyle = ExcelDataValidationWarningStyle.stop;
            validation.Formula.Value = 1;
            validation.Formula2.Value = 10;
        }
                    
    }
    &lt;span style="color: blue;"&gt;var&lt;/span&gt; bytes = pck.GetAsByteArray();
}
stopwatch.Stop();
Console.WriteLine(&lt;span style="color: rgb(163, 21, 21);"&gt;"total milliseconds: {0}"&lt;/span&gt;, stopwatch.ElapsedMilliseconds);
Console.ReadKey();
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="03/01/2016 08:07:00">
          <Html>
        &lt;div class="markDownOutput "&gt;Does it make any difference if you use the LoadFromCollection method, instead of loading the cells explicitly?&lt;br&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;].LoadFromCollection(myCollection, ...);
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="rparker_rti" When="04/01/2016 21:18:38">
          <Html>
        &lt;div class="markDownOutput "&gt;Thanks for the reply. &lt;br&gt;
&lt;br&gt;
Haven't ever used LoadFromCollection, but I'll look into it. That said, would that change have any impact on the performance of GetAsByteArray()?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How can I commit my bugfix to EPPlus">
      <Posts>
        <Post From="horbach" When="21/10/2015 08:34:43">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi everyone, &lt;br&gt;
&lt;br&gt;
I closely work with EPPlus. I have found and fixed a few bugs (~10). For each of those fixes I created a ticket with "howto reproduce" and "howto fix (code)".
&lt;br&gt;
&lt;br&gt;
I am a bit confused, that those tickets are hanging around for months. Am I doing something wrong? I tryed to ask Jan Källman, he doesn't answer my e-mails.
&lt;br&gt;
&lt;br&gt;
I am not trying to hurry up the developers. I'm sure thay have a lot to do. I'm just wondering if there is another way to commit my bugfixes?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="horbach" When="14/12/2015 15:10:41">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, I'm still not loosing hope and commit my changes here. &lt;br&gt;
&lt;br&gt;
They are very usefull. I swear :) We process dozens of Excels every day. &lt;br&gt;
&lt;br&gt;
I have a Christmas wish: &lt;br&gt;
Dear Santa, please let other people vote for my tickets, so Jan Källman can see my commits. I was working so hard the whole year long!
&lt;br&gt;
&lt;br&gt;
Yours Ivan&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="26/12/2015 09:42:44">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi Ivan, &lt;br&gt;
&lt;br&gt;
Thanks for helping out with bug fixing - we will now start working on a new version of EPPlus.
&lt;br&gt;
&lt;br&gt;
It would be very helpful if you could submit your bugfixes as a pull request. Then it is much easier for us to review and merge them into the code. If possible - submit unit tests that covers the functionality that you have changed.
&lt;br&gt;
&lt;br&gt;
Here you can see how to create a pull request: &lt;a href="https://codeplex.codeplex.com/wikipage?title=Mercurial%20Forks" rel="nofollow"&gt;
https://codeplex.codeplex.com/wikipage?title=Mercurial%20Forks&lt;/a&gt; &lt;br&gt;
&lt;br&gt;
Cheers, &lt;br&gt;
&lt;br&gt;
Mats&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="horbach" When="04/01/2016 16:23:56">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi Mats, &lt;br&gt;
&lt;br&gt;
thank you for the answer! I will take my time to create the unit tests for the fixes.
&lt;br&gt;
&lt;br&gt;
It would be very good if our fixes will be awailable in new version of EPPlus, because we wanted to update as soon, as it is out.
&lt;br&gt;
&lt;br&gt;
Cheers, &lt;br&gt;
Ivan&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="[Solved] Error while use (double) Indirect function">
      <Posts>
        <Post From="alexvanb" When="22/12/2015 10:17:33">
          <Html>
        &lt;div class="markDownOutput "&gt;In a worksheet I have a table. In one of the columns there will be a code of 3 characters. Target is another column with data validation, based on the column with that code. Because I don't know what code will be entered, the formula in the validated column
 must be the same for the whole column.&lt;br&gt;
&lt;br&gt;
In Excel it works fine. For each possible code I create a named range. After that, I use the following code in the List Datavalidation source for the whole column:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;INDIRECT(INDIRECT(ADDRESS(ROW();1;3)))&lt;/code&gt;&lt;/pre&gt;
The code I try to use:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;Dim myValidat = mySheet.DataValidations.AddListValidation("A2:A7))
With myValidat
   .ErrorStyle = OfficeOpenXml.DataValidation.ExcelDataValidationWarningStyle.warning
   .ShowErrorMessage = True
   .ShowInputMessage = True
   .PromptTitle = "prompttitle"
   .Prompt = "prompt"
   .Formula.ExcelFormula = "INDIRECT(INDIRECT(ADDRESS(ROW();1;3)))"
End With&lt;/code&gt;&lt;/pre&gt;
The first indirect is to get the value in the addressed cell.&lt;br&gt;
The second indirect is to call the named range with the value in that cell&lt;br&gt;
&lt;br&gt;
In Excel it works fine, but after using it in VB.NET and opening in Excel, that worksheet in that document is in errorstate, starts repairing, and delete the validation of that column.&lt;br&gt;
&lt;br&gt;
What I want is to accomplish this with code in VB.NET and using epplus. Please tell me what I'm doing wrong!&lt;br&gt;
&lt;br&gt;
Edit; I posted accidentally a topic in the Issue forum. There you will find an attachment:
&lt;a href="https://epplus.codeplex.com/workitem/15398" rel="nofollow"&gt;https://epplus.codeplex.com/workitem/15398&lt;/a&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="25/12/2015 14:23:20">
          <Html>
        &lt;div class="markDownOutput "&gt;You should use comma instead of semicolon in your formula. Hope this helps. &lt;br&gt;
&lt;br&gt;
/Mats&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="alexvanb" When="28/12/2015 09:16:05">
          <Html>
        &lt;div class="markDownOutput "&gt;Thank you very much swmal, that was the issue! I already translated the formulas from Dutch to English, but did not think about the formula delimiter.
&lt;br&gt;
It's working great now!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Opening an Excel (created with EPPLUS) with OleDB">
      <Posts>
        <Post From="freddyy" When="11/08/2014 11:05:25">
          <Html>
        &lt;div class="markDownOutput "&gt;I have code from a colleague, this code creates a few excel sheets with Epplus. With my code I would like to add an database extract 10k+/- lines. Because of the large amount of data it takes too long with Epplus, because you need to write each cell. With
 OleDB it only takes a few seconds. But I can't open a previously created excel by Epplus with OleDB. Even with different connection strings.
&lt;br&gt;
&lt;br&gt;
This my code works perfect if you separate the two code blocks.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;var excelPath = "C:\\test_" + DateTime.Today.ToString("yyyyMMdd_") + DateTime.Now.ToString("hh") + DateTime.Now.Minute.ToString() + ".xlsx";
using (ExcelPackage xlPackage = new ExcelPackage(new FileInfo(excelPath)))
{
    ExcelWorksheet worksheet = xlPackage.Workbook.Worksheets.Add("Schedule V");
    worksheet.Cell(1, 1).Value = "test";
    xlPackage.Save();
    xlPackage.Dispose();
}
var strCn = "Provider=Microsoft.ACE.OLEDB.12.0;Data Source=" + excelPath + ";Extended Properties='Excel 12.0 Xml';";
using (OleDbConnection conn = new OleDbConnection(strCn))
{
    conn.Open();
    OleDbCommand cmd = new OleDbCommand();
    cmd.Connection = conn;
    cmd.CommandText = "CREATE TABLE [table1] (id INT, name VARCHAR, datecol DATE );";
    cmd.ExecuteNonQuery();
    cmd.CommandText = "INSERT INTO [table1](id,name,datecol) VALUES(1,'AAAA','2014-01-01');";
    cmd.ExecuteNonQuery();
    conn.Close();
}
&lt;/code&gt;&lt;/pre&gt;
I tried the following connection strings but they all give the same error: &lt;br&gt;
&lt;br&gt;
OleDbException was unhandled, External table is not in the expected &lt;br&gt;
format. &lt;br&gt;
&lt;br&gt;
My diffrent connection string I tried:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;var strCn = "Provider=Microsoft.ACE.OLEDB.12.0;Data Source=" + excelPath + ";Extended Properties='Excel 12.0';";
var strCn = "Provider=Microsoft.ACE.OLEDB.12.0;Data Source=" + excelPath + ";Extended Properties='Excel 12.0 Xml';";
var strCn = "Provider=Microsoft.ACE.OLEDB.12.0;Data Source=" + excelPath + ";Extended Properties='Excel 12.0 Xml;HDR=YES';";
var strCn = "Provider=Microsoft.ACE.OLEDB.12.0;Data Source=" + excelPath + ";Extended Properties='Excel 12.0 Xml;HDR=YES;IMEX=1';";
var strCn = "Provider=Microsoft.ACE.OLEDB.12.0;Data Source=" + excelPath + ";Extended Properties='Excel 8.0;HDR=YES';";
var strCn = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" + excelPath + ";Extended Properties='Excel 8.0;HDR=Yes;IMEX=1';";
&lt;/code&gt;&lt;/pre&gt;
What am I doing wrong here?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="lojikl" When="08/10/2015 08:48:57">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
I have experienced this also, the only solution I could find was to revert to version 3.1. Not ideal really.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="sharandeep11" When="16/11/2015 13:36:32">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
I am also facing same problem as mentioned above. &lt;br&gt;
&lt;br&gt;
need help&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="ranjananimesh44" When="16/11/2015 13:40:37">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi all, &lt;br&gt;
&lt;br&gt;
I am also facing same problem with epplus 4.0. if have solutions plz share. &lt;br&gt;
&lt;br&gt;
Thanks&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="martinbeers" When="03/12/2015 16:20:50">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello all, &lt;br&gt;
&lt;br&gt;
I had the same problem and I think I have a solution. &lt;br&gt;
&lt;br&gt;
It appears the Microsoft.ACE.OLEDB.12.0 OleDb provider does not like an EPPlus 4.0.4 generated Excel package because it's missing an
&lt;strong&gt;numFmtId&lt;/strong&gt; attribute in the &lt;strong&gt;xf&lt;/strong&gt; element of &lt;strong&gt;
xl\styles.xml&lt;/strong&gt; file. &lt;br&gt;
&lt;br&gt;
Bad, as generated by EPPlus 4.0.4:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;                  &amp;lt;cellXfs count="1"&amp;gt;
                    &amp;lt;xf fontId="0" applyFont="1" applyBorder="0" xfId="0"  /&amp;gt;
                  &amp;lt;/cellXfs&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
Good:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;                  &amp;lt;cellXfs count="1"&amp;gt;
                    &amp;lt;xf fontId="0" applyFont="1" applyBorder="0" xfId="0" numFmtId="0" /&amp;gt;
                  &amp;lt;/cellXfs&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
To fix this download the EPPLus sources, find the file &lt;strong&gt;ExcelXfsXml.cs&lt;/strong&gt; and change the
&lt;strong&gt;'&amp;gt;'&lt;/strong&gt; on &lt;strong&gt;line 818&lt;/strong&gt; to a &lt;strong&gt;'&amp;gt;='&lt;/strong&gt;:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;//            if (_numFmtId &amp;gt; 0)  
            if (_numFmtId &amp;gt;= 0)
            {
                SetXmlNodeString("@numFmtId", _numFmtId.ToString());
                if(doSetXfId) SetXmlNodeString("@applyNumberFormat", "1");
            }
&lt;/code&gt;&lt;/pre&gt;
This fixes the OleDb problem but I did not test it extensively, so I can't be sure it doesn't break anything else. I don't think so though.
&lt;br&gt;
&lt;br&gt;
Hope this helps..&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Astrophizz" When="11/12/2015 00:23:50">
          <Html>
        &lt;div class="markDownOutput "&gt;Thanks for the excellent find, that did the trick - at least for my simple scenario of dumping a csv into an xlsx and reading data back out with LinqToExcel!
&lt;br&gt;
&lt;br&gt;
I'm a little concerned about the LGPL license and modifying the code, but I'm not publically distributing the resulting software and the binary remains separate so I guess it's all good. If I knew Mercurial or had time to get familiar with it I'd submit a pull
 request.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="27/12/2015 21:40:50">
          <Html>
        &lt;div class="markDownOutput "&gt;Thanks, we'll add this fix in the next version. &lt;br&gt;
&lt;br&gt;
/Mats&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Compare cell's styles">
      <Posts>
        <Post From="mohamedamaa" When="21/12/2015 15:10:31">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi all, &lt;br&gt;
&lt;br&gt;
Is there a way to check that 2 cell's styles are equal or not ? There is an Id property in the ExcelStyle class which unfortunalty is private and could have been used I think to compare styles...
&lt;br&gt;
&lt;br&gt;
Thank you for your feedbacks.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="ExcelPicture size stays square">
      <Posts>
        <Post From="mleonelli" When="09/03/2015 09:34:53">
          <Html>
        &lt;div class="markDownOutput "&gt;Dear all, &lt;br&gt;
I am facing a strange behavior on the SetSize() method. &lt;br&gt;
I have got an Image icon in png format and add it to my spreadsheet as&lt;br&gt;
&lt;pre&gt;&lt;code&gt;int row = 1, col = 1;
var cell = ws.Cells[row, col, row, col + 11];
cell.Merge = true;
ws.Row(row).Height = 70;

 if (icon != null)
{
  OfficeOpenXml.Drawing.ExcelPicture pic = ws.Drawings.AddPicture("pic" + (row).ToString(), icon);
  pic.SetSize(10,10);
  pic.SetPosition(5, 400);
}&lt;/code&gt;&lt;/pre&gt;
in this case my image is resized correctly as a 10x10 png, but if I resize as&lt;br&gt;
&lt;pre&gt;&lt;code&gt;int row = 1, col = 1;
var cell = ws.Cells[row, col, row, col + 11];
cell.Merge = true;
ws.Row(row).Height = 70;

 if (icon != null)
{
  OfficeOpenXml.Drawing.ExcelPicture pic = ws.Drawings.AddPicture("pic" + (row).ToString(), icon);
  pic.SetSize(50,10);
  pic.SetPosition(5, 400);
}&lt;/code&gt;&lt;/pre&gt;
I still got a square image while I expected to be 50x10. &lt;br&gt;
&lt;br&gt;
The initial image is a 410x60 png, thus a square image leads to a big distorsion.
&lt;br&gt;
&lt;br&gt;
Any hint? &lt;br&gt;
&lt;br&gt;
Thank you!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="clmckinley" When="18/12/2015 15:50:33">
          <Html>
        &lt;div class="markDownOutput "&gt;It appears that setting the any row height mucks with any previously embedded images, even if they are in different rows. The work around for this is to set all of the row heights before embedding images.&lt;br&gt;
&lt;br&gt;
In my case it means that I have to loop through and set the row height then do a second loop and embed the images.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Upgraded to 4.04 from 3.1.1 and Excel file no longer works">
      <Posts>
        <Post From="silviudc" When="09/12/2015 12:03:45">
          <Html>
        &lt;div class="markDownOutput "&gt;I have an asp.net website which outputs an Excel file via the 3.1.1 EPPLUS.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;//Create Excel output.
                Response.Clear();
                Response.ContentType = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";
                Response.AddHeader("content-disposition", "attachment;  filename=Report " +
                                   DateTime.Today.Day.ToString() + "-" + DateTime.Today.Month.ToString() + "-" +
                                   DateTime.Today.Year.ToString() + " " + DateTime.Now.Hour + "-" +
                                   DateTime.Now.Minute + "-" + DateTime.Now.Second + ".xlsx");
                package.SaveAs(Response.OutputStream);
                Response.End();&lt;/code&gt;&lt;/pre&gt;
This works just fine in 3.1.1 but when I have updated to latest 4.0.4 release I get this exception: {"The cachesource is not a worksheet"} and the Excel fiel is corrupted.
&lt;br&gt;
&lt;br&gt;
Has the saving of the file changed since 3.1.1? If yes then how do I save with 4.0.4?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="jyparask" When="16/12/2015 10:53:27">
          <Html>
        &lt;div class="markDownOutput "&gt;This is how i am doing it:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;//Create Excel output.
                Response.Clear();
                Response.ContentType = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";
                Response.AddHeader("content-disposition", "attachment;  filename=Report " +
                                   DateTime.Today.Day.ToString() + "-" + DateTime.Today.Month.ToString() + "-" +
                                   DateTime.Today.Year.ToString() + " " + DateTime.Now.Hour + "-" +
                                   DateTime.Now.Minute + "-" + DateTime.Now.Second + ".xlsx");
                Response.BinaryWrite(package.GetAsByteArray())
                //package.SaveAs(Response.OutputStream);
                Response.End();&lt;/code&gt;&lt;/pre&gt;
Giannis&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to create a chart with multi chart type.">
      <Posts>
        <Post From="AllenLin" When="16/12/2015 06:18:44">
          <Html>
        &lt;div class="markDownOutput "&gt;Good afternoon everyone, I want to create a chart include line(eChartType) and column(eChartType), how to use EPPlus to achieve ?&lt;br&gt;
&lt;br&gt;
such as this following pic.&lt;br&gt;
&lt;img alt="Image" src="http://b.picphotos.baidu.com/album/s%3D1600%3Bq%3D90/sign=f0a76ce68d13632711edc635a1bf9b9d/6d81800a19d8bc3e504df6f0858ba61ea8d34547.jpg"&gt;&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Sorry, the answer as below:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;        var chart = sheet.Drawings.AddChart("chart2", eChartType.ColumnStacked);
        chart.SetPosition(0, 540);
        chart.SetSize(800, 600);


        var chartType2 = chart.PlotArea.ChartTypes.Add(eChartType.LineStacked);
        chartType2.UseSecondaryAxis = true;
        var serie3 = chartType2.Series.Add(range.Offset(1, 2, range.End.Row - 1, 1), range.Offset(1, 0, range.End.Row - 1, 1));
        serie3.Header = "Items in stock";&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="scatterchart line missing">
      <Posts>
        <Post From="nagendran27" When="11/12/2015 12:13:49">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi i created scatterchart excel from c# code.i got excel as needed.bt i need one help from you ,not connceted a points in graph.only show the points.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Add chart element Data table with legend">
      <Posts>
        <Post From="CPW" When="11/12/2015 11:23:12">
          <Html>
        &lt;div class="markDownOutput "&gt;We are able to generate a chart in the excel sheet. There is requirement to add chart element &amp;gt;&amp;gt; Data table with legend. Is there any way to add this using EPPlus? Following is the sample chart that we are looking for
&lt;br&gt;
&lt;br&gt;
&lt;img alt="Image" src="http://xlsxwriter.readthedocs.org/_images/chart_data_table2.png"&gt;
&lt;br&gt;
&lt;br&gt;
Thank you&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="ExcelWorksheet object falling apart after being returned from method">
      <Posts>
        <Post From="dbloch5800" When="09/12/2015 15:14:43">
          <Html>
        &lt;div class="markDownOutput "&gt;This is the strangest thing I have seen, ever.&lt;br&gt;
&lt;br&gt;
Using 4.0.4&lt;br&gt;
&lt;br&gt;
From method A, I'm calling a simple method that opens an excel file and returns the first worksheet. In that simple method the ExcelWorksheet object does exist and is fully populated. Once the ExcelWorksheet object is returned to the calling method the ExcelWorksheet
 object is only partial there. For example the Dimension and Cells sub object are null. There are more null objects but those are the ones I need. You can see from the code below it is pretty basic.&lt;br&gt;
&lt;br&gt;
This was all working great with EPPlus 3.1.3.3&lt;br&gt;
&lt;pre&gt;&lt;code&gt;        public static void Excel(string path, ref FileViewModel file)
        {

                    ........
            
                    // Calling simple method to get first worksheet
                    var worksheet = ProcessExcel(path);
                    //Once back here the worksheet variable is not fully populated

                    dt = WorksheetToDataTable(worksheet);
                   
                    ........

            }
            finally
            {
                if (_sqlConn.State == ConnectionState.Open)
                    _sqlConn.Close();
            }
        }

        private static ExcelWorksheet ProcessExcel(string fileName)
        {
            try
            {
                var fi = new FileInfo(fileName);
                using (ExcelPackage p = new ExcelPackage(fi))
                {
                    var dtSheets = p.Workbook.Worksheets;

                    // Get list of sheets
                    if (dtSheets != null &amp;amp;&amp;amp; dtSheets.Count &amp;gt; 1)
                        throw new ApplicationException("Too many sheets in file!");

                    // get the first worksheet in the workbook
                    ExcelWorksheet ws = dtSheets == null ? null : dtSheets.First();
                    //  Everything is good up to here.
                    return ws;
                }
            }
            catch (Exception ex)
            {
                if (ex.HResult == -2146233088)
                    throw new ApplicationException(Messages.OldExcelFile);
                throw;
            }
        }&lt;/code&gt;&lt;/pre&gt;
This seems to have started to happen with EPPlus 4.0.1.1 &lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="dbloch5800" When="09/12/2015 19:58:05">
          <Html>
        &lt;div class="markDownOutput "&gt;Though I believe it is still an issue with EPPlus I believe I have found a workaround. It seems to be caused by the "using" statement in my "ProcessExcel" method. If I leave the ExcelPackage variable floating in memory everything is
 fine.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;        private static ExcelPackage _p = null;
        public static void Excel(string path, ref FileViewModel file)
        {

                    ........
            
                    // Calling simple method to get first worksheet
                    var worksheet = ProcessExcel(path);
                    //Once back here the worksheet variable is not fully populated

                    dt = WorksheetToDataTable(worksheet);
                   
                    // dispose of object, clear memory
                    _p = null;
                    ........

            }
            finally
            {
                if (_sqlConn.State == ConnectionState.Open)
                    _sqlConn.Close();
            }
        }

        private static ExcelWorksheet ProcessExcel(string fileName)
        {
            try
            {
                var fi = new FileInfo(fileName);

                // This leaves the worksheet open, which isn't great.
                _p = new ExcelPackage(fi);
                    var dtSheets = p.Workbook.Worksheets;

                    // Get list of sheets
                    if (dtSheets != null &amp;amp;&amp;amp; dtSheets.Count &amp;gt; 1)
                        throw new ApplicationException("Too many sheets in file!");

                    // get the first worksheet in the workbook
                    ExcelWorksheet ws = dtSheets == null ? null : dtSheets.First();
                    //  Everything is good up to here.
                    return ws;
            }
            catch (Exception ex)
            {
                if (ex.HResult == -2146233088)
                    throw new ApplicationException(Messages.OldExcelFile);
                throw;
            }
        }&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to bound shape with Chart">
      <Posts>
        <Post From="mpulimi" When="09/12/2015 09:20:54">
          <Html>
        &lt;div class="markDownOutput "&gt;Thanks for the wonderful toolkit. I am having a problem with getting the shape bounded by a Chart. How to manipulate such an object? It is not directly under Drawings in Worksheet&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Calc VBA project hash for vbaProjectSignature.bin and vbaProjectSignatureAgile.bin">
      <Posts>
        <Post From="OleksiiD" When="30/11/2015 16:46:38">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
I noticed that EPPlus calculates MD5 hash of VBA project, which is written to ContentInfo object in the
&lt;strong&gt;vbaProjectSignature.bin&lt;/strong&gt;. Here is my first question: &lt;em&gt;Can you share some useful links to the specification of the the process of calculating this hash?&lt;/em&gt; In sources I see that you calculate md5 hash based on VBA project name, constants,
 references and modules (ExcelVbaSignature.GetContentHash method). &lt;br&gt;
&lt;br&gt;
But EPPlus does not read/create &lt;strong&gt;vbaProjectSignatureAgile.bin&lt;/strong&gt;. I want to write code, that calculates VBA project hash using SHA1 and writes it to vbaProjectSignatureAgile.bin. All I know here is that SpcIndirectDataContentV2 is used in this
 case, which has two fields: &lt;strong&gt;compiledHash&lt;/strong&gt; and &lt;strong&gt;sourceHash&lt;/strong&gt;. I cannot find any specification on how to calculate them.
&lt;em&gt;Do you have links to the specs?&lt;/em&gt; &lt;br&gt;
&lt;br&gt;
Thanks, Oleksii&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How can I use the [Display(Name=&quot;&quot;)] model attributes with LoadFromCollection?">
      <Posts>
        <Post From="Rubix_Revenge" When="24/11/2015 20:51:01">
          <Html>
        &lt;div class="markDownOutput "&gt;I am able to successfully load a worksheet with an IEnumerable in my controller function and the data exports correctly, but my users want the column titles to be "user-friendly". It turns out that even though I have [Display(Name="")]
 in annotations in my model, LoadFromCollection does not read those values -- instead, the true names of the columns are used.
&lt;br&gt;
&lt;br&gt;
Is there any way I can use LoadFromCollection and use the Display Name annotations?
&lt;br&gt;
&lt;br&gt;
This is what I currently have. &lt;br&gt;
&lt;pre&gt;&lt;code&gt;public ActionResult ExportToExcel(string _selectedCampus)
        {
            // This is the query result set the user wishes to export to file
            IEnumerable&amp;lt;Mia1aSec1FayExport&amp;gt; exportQuery = unitOfWork
                .Mia1aSec1FayRepository.Get().Select(n =&amp;gt; new Mia1aSec1FayExport
            {
                Campus = n.Campus,
                StudentName = n.StudentName,
                CreditsBeforeSchoolYear = n.CreditsBeforeSchoolYear,
                CreditsDuringSemester1 = n.CreditsDuringSemester1,
                EligibleFayCount = n.EligibleFayCount,
                EligibleFayMeetingGoal = n.EligibleFayMeetingGoal
            }).Where(n =&amp;gt; n.Campus == _selectedCampus).OrderBy(n =&amp;gt; n.StudentName)
            .AsEnumerable();

            // The current iteration saves the table contents, but without the 
            // [Display{Name"xxx)]annotation from the model.            
            byte[] response;   
            using (var excelFile = new ExcelPackage())
            {
                excelFile.Workbook.Properties.Title = "MIA 1A (i) Eligible FAY Students";                
                var worksheet = excelFile.Workbook.Worksheets.Add("Sheet1");                   
                worksheet.Cells["A1"]
                    .LoadFromCollection(Collection: exportQuery, PrintHeaders: true);
                response = excelFile.GetAsByteArray();
            }

            // Save dialog appears through browser for user to save file as desired.
            return File(response, "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet", 
                "Mia1aSec1Fay.xlsx");
        }&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Rubix_Revenge" When="30/11/2015 14:52:07">
          <Html>
        &lt;div class="markDownOutput "&gt;Using &lt;code&gt;[DisplayName("User-friendly name")]&lt;/code&gt; in the model worked perfectly. I needed to include
&lt;code&gt;using System.ComponentModel&lt;/code&gt;. Problem solved.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Create CustomUI xml with EPPLus">
      <Posts>
        <Post From="bt_programmer" When="30/11/2015 14:03:58">
          <Html>
        &lt;div class="markDownOutput "&gt;Is it possible to generate customUI.xml with EPPLUS?&lt;br&gt;
I need this for custom ribbon buttons.&lt;br&gt;
&lt;br&gt;
This xml should be in the root when xlsm file is unpacked,&lt;br&gt;
like here:&lt;br&gt;
(&lt;a href="http://www.rondebruin.nl/win/s2/win001.htm" rel="nofollow"&gt;http://www.rondebruin.nl/win/s2/win001.htm&lt;/a&gt;)&lt;br&gt;
&lt;br&gt;
There are some ways to do this with vba&lt;br&gt;
(&lt;a href="https://msdn.microsoft.com/en-us/library/office/ff861787.aspx" rel="nofollow"&gt;https://msdn.microsoft.com/en-us/library/office/ff861787.aspx&lt;/a&gt;)&lt;br&gt;
but I would like generate this customUI.xml with EPPLUS.&lt;br&gt;
&lt;br&gt;
Can I write xml directly to ExcelPackage object somehow?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="LoadFromDataTable and Formulas">
      <Posts>
        <Post From="rchorev" When="22/11/2015 15:22:58">
          <Html>
        &lt;div class="markDownOutput "&gt;I am using the method public ExcelRangeBase LoadFromDataTable(DataTable Table, bool PrintHeaders) to load files into sheets. In the file I have formulas. When the Excel file is generated these functions are not evaluated automatically. They are if I import
 the text file directly into Excel. What am I missing?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Getting the Formatted Text of a field.">
      <Posts>
        <Post From="travis_haws" When="20/11/2015 23:15:17">
          <Html>
        &lt;div class="markDownOutput "&gt;I am reading an existing value from an excel spreadsheet. &lt;br&gt;
&lt;pre&gt;&lt;code&gt;        ExcelPackage pack = new ExcelPackage(new FileInfo(@"MoneyTest.xlsx"));
        var sheet = pack.Workbook.Worksheets.First();
        var cell = sheet.Cells[sheet.Dimension.Start.Row + 1, sheet.Dimension.Start.Column];
        MessageBox.Show(cell.Text);
        MessageBox.Show(cell.Value.ToString());
&lt;/code&gt;&lt;/pre&gt;
The value in the cell is "5" and it contains the currency formatting so it displays as "$5.00" in excel.
&lt;br&gt;
&lt;br&gt;
The above code produces "$0.05" for the cell.Text and "5" for the cell.Value.
&lt;br&gt;
&lt;br&gt;
Is there a way to read the cell text as "$5.00" instead of "$0.05" without me manually parsing the cell.Value?
&lt;br&gt;
&lt;br&gt;
Thanks.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="travis_haws" When="20/11/2015 23:52:26">
          <Html>
        &lt;div class="markDownOutput "&gt;Disregard this. When I initially tested updating the package, I did it wrong. But after trying this again, Nuget package 4.0.4 resolved the issue.
&lt;br&gt;
&lt;br&gt;
Thanks. &lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="MS Access does not open generated by EPP Excel files">
      <Posts>
        <Post From="LukaszW" When="12/11/2015 10:36:07">
          <Html>
        &lt;div class="markDownOutput "&gt;Steps to reproduce:&lt;br&gt;
&lt;ol&gt;
&lt;li&gt;Get any file generated by EPP. (f.e. from provided Samples project ) &lt;/li&gt;&lt;li&gt;Try to import as a table to Access. &lt;/li&gt;&lt;li&gt;It fails with:&lt;br&gt;
"... Please check that file exists and is in the correct format".&lt;br&gt;
&lt;/li&gt;&lt;/ol&gt;
BUT it is enough to OPEN this file in MS Excel and save it back without any edit change&lt;br&gt;
and then TADA import to Access this very same file succeeds.&lt;br&gt;
&lt;br&gt;
Q is how to generate file from EPP to make it importable by MS ACCESS without involving Excel?&lt;br&gt;
&lt;br&gt;
Thanks in advance for any hint&lt;br&gt;
&lt;br&gt;
Lukasz Wilczynski&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="LukaszW" When="13/11/2015 10:36:51">
          <Html>
        &lt;div class="markDownOutput "&gt;Extra info. &lt;br&gt;
&lt;br&gt;
Assume you have Excel file which can be imported by Access (call it "valid excel").
&lt;br&gt;
&lt;br&gt;
So if you open this "valid excel" with EPP (as ExcelPackage from FileInfo - simplest way)....
&lt;br&gt;
&lt;br&gt;
ExcelPackage packEx = new ExcelPackage(existingValidFile); &lt;br&gt;
&lt;br&gt;
... and save it at once without any changes.... &lt;br&gt;
&lt;br&gt;
packEx.SaveAs(new FileInfo("c:\copyOfValidFile.xlsx")); &lt;br&gt;
&lt;br&gt;
... oops... it becomes "invalid" (read: MS Access can not import copyOfValidFile anymore).
&lt;br&gt;
Excel can open it. Access can not. &lt;br&gt;
&lt;br&gt;
Seems - at the moment - there is no way to save valid ExcelFile with EPP. &lt;br&gt;
&lt;br&gt;
&lt;strong&gt;EPP unintentionaly cuts some really important information from file.&lt;/strong&gt;
&lt;br&gt;
&lt;br&gt;
Regards &lt;br&gt;
&lt;br&gt;
Lukasz Wilczynski&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Dynamically create new worksheets based on table data">
      <Posts>
        <Post From="mham99" When="10/11/2015 02:41:02">
          <Html>
        &lt;div class="markDownOutput "&gt;I have a data set which consists of data of different types that I want to put into specific worksheets..
&lt;br&gt;
Data columns: &lt;br&gt;
SerialNumber, ProductType, Location, Date &lt;br&gt;
I need to loop through the record set sorted by column "Location" and then detect when that "Location" data changes so I can create a new worksheet and put data for each location in separate tabs.
&lt;br&gt;
&lt;br&gt;
I have been using the LoadFromTable method to pop data from my dataset into the cells but not sure this will work
&lt;br&gt;
&lt;br&gt;
I have used the examples so I know the functions for creating worksheets but not sure how to get looping through my dataset so I can dynamically trigger the new tab and LoadFromTable into each sheet.
&lt;br&gt;
&lt;br&gt;
I am a new programmer to C# and am teaching myself (basically starting the rebuild of my app with this one task of multi-tab excel exports) I am familiar with this type of looping in vb script and have this type of export to single worksheet functionality in
 my classic .asp app. &lt;br&gt;
&lt;br&gt;
Can anyone point me to an example of something like this in C# with dynamically spawned worksheets?
&lt;br&gt;
&lt;br&gt;
Thanks &lt;br&gt;
Mike &lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Read xlsx file with password protected sheet fail.">
      <Posts>
        <Post From="yuxinbo" When="08/10/2012 03:59:16">
          <Html>
        
&lt;p&gt;Dear Member,&lt;/p&gt;
&lt;p&gt;Would you please give me a help? I have written code to read xlsx without password on worksheet. The code ran well. Then I add password on excel sheet. The code throw "Password Invalid" exception. Through I used&lt;span style="color: blue;"&gt; new&lt;/span&gt;&amp;nbsp;&lt;span style="color: rgb(43, 145, 175);"&gt;ExcelPackage&lt;/span&gt;(path,
 password), and used the password on sheet as parameter.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="FabioTavares" When="29/10/2015 11:05:30">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi @yuxinbo, &lt;br&gt;
&lt;br&gt;
Did you figured it out? I have the same problem. I'm using EPPlus v3.1.3.0&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="FabioTavares" When="30/10/2015 10:32:43">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
The only way i managed so far is to not protect the workbook but only protect the sheets :S&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="ExcelPackage with password">
      <Posts>
        <Post From="speterson" When="03/12/2014 19:37:34">
          <Html>
        &lt;div class="markDownOutput "&gt;Kind of a long story, bear with me please. &lt;br&gt;
&lt;br&gt;
Our application allows the user to download an Excel document as a template to fill in data. This template is protected for structure with a password and was created in Excel 2013.
&lt;br&gt;
&lt;br&gt;
After filling out the document, the user can upload it, which gives an IHttpHandler implementation an HttpPostedFile. We then construct an ExcelPackage with the InputStream, and off we go...most of the time.
&lt;br&gt;
&lt;br&gt;
We have a client who only has Excel 2007, and that (apparently) treats protection differently. Attempting to upload a copy of the template they've created gives the exception "Package is an OLE compound document. If this is an encrypted package, please
 supply the password". We think 2007 is encrypting the contents instead of just protecting the sheet.
&lt;br&gt;
&lt;br&gt;
Of course, I only have the client's saved version of our template; I don't &lt;em&gt;really&lt;/em&gt; know how they got it in this state.&lt;br&gt;
&lt;br&gt;
So, we tried just adding our password to the ExcelPackage constructor, thinking this would un-encrypt what 2007 did to the contents, and we could read the document.
&lt;br&gt;
&lt;br&gt;
Sadly, no. Putting password in the constructor requires the stream to be read/write. So, a couple of questions:&lt;br&gt;
&lt;ul&gt;
&lt;li&gt;Why doesn't the no-password constructor require the stream to be the same way?
&lt;/li&gt;&lt;li&gt;Is there a way for us to try getting a read-only document with the password?&lt;br&gt;
&lt;/li&gt;&lt;/ul&gt;
(Of course, trying the password constructor also fails when I download the template and use 'normally', since the stream isn't read/write).
&lt;br&gt;
&lt;br&gt;
Poking through the ExcelPackage code, I see where you look for CanRead and CanWrite in the (stream, password) case, but I don't see any path to allow the caller to go read-only. I understand that the constructor cannot know whether the user
&lt;em&gt;might eventually&lt;/em&gt; do a write with this object, but why not delay that check until the write is attempted?
&lt;br&gt;
&lt;br&gt;
We were trying to use our password as a test, just to see if we could get their spreadsheet in the system. If it worked, we'd figure out how to use it (I suppose a backup if the no-password constructor failed or something).
&lt;br&gt;
&lt;br&gt;
We did find that taking the client's version, saving it with 2013, then having them upload
&lt;em&gt;that&lt;/em&gt; works just fine. We have a workaround, but we'd like to figure out a way to make the process smart enough to not have to do that.
&lt;br&gt;
&lt;br&gt;
Thanks in advance.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="FabioTavares" When="29/10/2015 11:04:39">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi @speterson, &lt;br&gt;
&lt;br&gt;
How did you managed to open you xlsx excel file with a password? &lt;br&gt;
I have an excel file with workbook proetction to password 1q2w3e4r5t (just testing) and a sheet protected with the same password. I then do
&lt;br&gt;
&lt;pre&gt;&lt;code&gt;using (ExcelPackage pck = new ExcelPackage(file, "1q2w3e4r5t"))
                {&lt;/code&gt;&lt;/pre&gt;
but i get an exception of password invalid. How did you managed to make it work? &lt;br&gt;
&lt;br&gt;
I'm using EPPlus v3.1.3.0&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="speterson" When="29/10/2015 16:35:18">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi Fabio, &lt;br&gt;
&lt;br&gt;
I'm looking at the code that we use to do the upload part I talked about. It appears that we're using some NPOI class to take the file's InputStream.
&lt;br&gt;
&lt;br&gt;
I don't think this is related to EPPlus; I want to say we moved away from EPPlus. I can't remember where we discovered this NPOI stuff to point you in that direction.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="FabioTavares" When="30/10/2015 10:32:27">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
The only way i managed so far is to not protect the workbook but only protect the sheets :S&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How can we insert DropDownList in Excel Sheet">
      <Posts>
        <Post From="vivekdeshmukh" When="23/10/2015 11:29:43">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello Team,&lt;br&gt;
&lt;pre&gt;&lt;code&gt;     we are using EPPLus in our application and there is a need to add dropdownlist in excel sheet but we haven;t found clue for it anywhere. Came across the link which contans the same question and int the answer is states as "Read the [full discussion online](http://epplus.codeplex.com/Thread/View.aspx?ThreadId=239587&amp;amp;ANCHOR#Post540560)." but this full discussion is not exists on the server.
&lt;/code&gt;&lt;/pre&gt;
Could you please provide any solution or any workaround for this? &lt;br&gt;
&lt;br&gt;
Thank you so much in advance!!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Girija123" When="23/10/2015 13:19:10">
          <Html>
        &lt;div class="markDownOutput "&gt;I have also the same problem , I want to add button , textbox and combobox into the xlx or xlsm. But currently I am unable to this with epplus. Please help me with this problem&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="jimpar" When="23/10/2015 15:07:28">
          <Html>
        &lt;div class="markDownOutput "&gt;I followed this post the other day and was able to create a dropdown list - &lt;a href="http://epplus.codeplex.com/discussions/275445?ProjectName=epplus" rel="nofollow"&gt;
http://epplus.codeplex.com/discussions/275445?ProjectName=epplus&lt;/a&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="vivekdeshmukh" When="27/10/2015 07:23:37">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi Jimpar,&lt;br&gt;
&lt;pre&gt;&lt;code&gt;Thanks for sharing the link here, I just tried the same code mentioned in above link into our web application but it's not working. &lt;/code&gt;&lt;/pre&gt;
This is how the data looks in excel sheet in individual cells- &lt;br&gt;
&lt;strong&gt;B2&lt;/strong&gt;- &amp;gt; Books&lt;br&gt;
&lt;strong&gt;B3&lt;/strong&gt;-&amp;gt; Magazines&lt;br&gt;
&lt;strong&gt;C2&lt;/strong&gt;-&amp;gt; Don Quixote &lt;br&gt;
&lt;strong&gt;C3&lt;/strong&gt;-&amp;gt; Robinson Carusoe&lt;br&gt;
&lt;strong&gt;C4&lt;/strong&gt;-&amp;gt; Jane Eyre&lt;br&gt;
&lt;strong&gt;C5&lt;/strong&gt;-&amp;gt; A Study In Scarlet&lt;br&gt;
&lt;strong&gt;D2&lt;/strong&gt;-&amp;gt; Time&lt;br&gt;
&lt;strong&gt;D3&lt;/strong&gt;-&amp;gt; Newsweek&lt;br&gt;
&lt;strong&gt;D4&lt;/strong&gt;-&amp;gt; MAD&lt;br&gt;
&lt;strong&gt;D5&lt;/strong&gt;-&amp;gt; PC World&lt;br&gt;
&lt;br&gt;
Could you please guide me on this if you have any idea?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="jimpar" When="27/10/2015 21:34:05">
          <Html>
        &lt;div class="markDownOutput "&gt;If you hover over F2 you will see a dropdown arrow. click that and you will see Books and Magazines as choices. select one of them. Hover over G2 , click the dropdown and you will see choices based on what you selected in F2
&lt;br&gt;
&lt;br&gt;
Try typing in A1 and enter a non-date value. You will get the error message&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="vivekdeshmukh" When="28/10/2015 06:02:52">
          <Html>
        &lt;div class="markDownOutput "&gt;Hey Jimpar,&lt;br&gt;
&lt;pre&gt;&lt;code&gt;   Thank you so much for the detailed description. I can see the dropdowns now. Just curious about can we make it by default visible as a dropdown?&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="jimpar" When="28/10/2015 13:48:12">
          <Html>
        &lt;div class="markDownOutput "&gt;You can set F2 to Books or Magazines at creation time&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to delete or resize ExcelTables?">
      <Posts>
        <Post From="Tipx" When="27/10/2015 19:19:57">
          <Html>
        &lt;div class="markDownOutput "&gt;Using {ExcelWorksheet}.Tables.Add( ... ), I created some tables in an ExcelWorksheet. If I add some data to the worksheet, and I want to include it in the ExcelTable, how can I do it?
&lt;br&gt;
I also tried to find a way around that by deleting and recreating a table, but I can't find a way to delete the table.
&lt;br&gt;
&lt;br&gt;
Thanks&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to create DropDown list">
      <Posts>
        <Post From="shrikanth" When="11/10/2011 13:33:36">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Am new to EPPlus and wrote some sample programs on this. I need to create a DropDown list and Dependency DropDown. Please let me know how to do using EPPlus.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks in advance.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Shrikanth&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="19/10/2011 06:23:23">
          <Html>
        
&lt;p&gt;You can use datavalidation to create a simple in-cell dropdown. You cant create a dependency dropbox in EPPlus. You have to use VBA for that.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="shrikanth" When="19/10/2011 07:07:18">
          <Html>
        
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Able to create dropdown as well Dependency drop down list. Took time to understand EPPlus on how to implement it. Posting the sample code here. One of my colleque helped me on creating worksheet.Cells object. This is working fine.&lt;/p&gt;
&lt;p&gt;-------------------------------------------------------------------------------------------------------------------------------&lt;/p&gt;
&lt;pre&gt;using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.IO;
using OfficeOpenXml;
using OfficeOpenXml.DataValidation;

namespace ConsoleApplication1
{
    class Program
    {
        static void Main(string[] args)
        {
            FileInfo newFile = new FileInfo(@"D:\Learning\DotNet\Test\mynewfile.xlsx");
            using (ExcelPackage excelPackage = new ExcelPackage(newFile))
            {
                ExcelWorksheet worksheet = excelPackage.Workbook.Worksheets.Add("Test");
                // Add a date time validation
                var validation = worksheet.DataValidations.AddDateTimeValidation("A1");
                // set validation properties
                validation.ShowErrorMessage = true;
                validation.ErrorTitle = "An invalid date was entered";
                validation.Error = "The date must be between 2011-01-31 and 2011-12-31";
                validation.Prompt = "Enter date here";
                validation.Formula.Value = DateTime.Parse("2011-01-01");
                validation.Formula2.Value = DateTime.Parse("2011-12-31");
                validation.Operator = ExcelDataValidationOperator.between;
               
                var val = worksheet.DataValidations.AddListValidation("A2");
                val.Formula.Values.Add("Test1");
                val.Formula.Values.Add("Test2");
                val.Formula.Values.Add("Test3");
                val.Formula.Values.Add("Test4");
                val.Formula.Values.Add("Test5");
                val.Formula.Values.Add("Test6");
                val.Formula.Values.Add("Test7");
                val.Formula.Values.Add("Test8");
                val.Formula.Values.Add("Test9");
                val.Formula.Values.Add("Test10");
                worksheet.Cells["B2"].Value = "Books";
                worksheet.Cells["B3"].Value = "Magazines";
                worksheet.Cells["C2"].Value = "Don Quixote";
                worksheet.Cells["C3"].Value = "Robinson Carusoe";
                worksheet.Cells["C4"].Value = "Jane Eyre";
                worksheet.Cells["C5"].Value = "A Study In Scarlet";
                worksheet.Cells["D2"].Value = "Time";
                worksheet.Cells["D3"].Value = "Newsweek";
                worksheet.Cells["D4"].Value = "MAD";
                worksheet.Cells["D5"].Value = "PC World";
                worksheet.Names.Add("Publications", worksheet.Cells["B2:B3"]);
                worksheet.Names.Add("Books", worksheet.Cells["C2:C5"]);
                worksheet.Names.Add("Magazines", worksheet.Cells["D2:D5"]);
                var val2 = worksheet.DataValidations.AddListValidation("F2");
                val2.Formula.ExcelFormula = "=Publications";

                var val3 = worksheet.DataValidations.AddListValidation("G2");
                val3.Formula.ExcelFormula ="=INDIRECT(F2)";
                val.ShowErrorMessage = true;
                val.Error = "Select from List of Values ...";
                excelPackage.Save();
                excelPackage.Dispose();
            }
        }
    }
}&lt;/pre&gt;
&lt;p&gt;-------------------------------------------------------------------------------------------------------------------------------&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Ravendarksky" When="18/06/2013 16:46:21">
          <Html>
        &lt;div class="markDownOutput "&gt;Thanks for this! You just saved me a lot of effort web searching and reaching the documentation!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="CellBent" When="18/06/2013 21:03:59">
          <Html>
        &lt;div class="markDownOutput "&gt;Thanks for sharing! This seems like a great addition to the code samples.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="vivekdeshmukh" When="27/10/2015 05:42:38">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi Shrikanth,&lt;br&gt;
&lt;pre&gt;&lt;code&gt;Thanks for sharing the code here, I just tried the same code in our web application but it's not working. &lt;/code&gt;&lt;/pre&gt;
This is how the data looks in excel sheet in individual cells- &lt;br&gt;
&lt;strong&gt;B2&lt;/strong&gt;- &amp;gt; Books&lt;br&gt;
&lt;strong&gt;B3&lt;/strong&gt;-&amp;gt; Magazines&lt;br&gt;
&lt;strong&gt;C2&lt;/strong&gt;-&amp;gt; Don Quixote &lt;br&gt;
&lt;strong&gt;C3&lt;/strong&gt;-&amp;gt; Robinson Carusoe&lt;br&gt;
&lt;strong&gt;C4&lt;/strong&gt;-&amp;gt; Jane Eyre&lt;br&gt;
&lt;strong&gt;C5&lt;/strong&gt;-&amp;gt; A Study In Scarlet&lt;br&gt;
&lt;strong&gt;D2&lt;/strong&gt;-&amp;gt; Time&lt;br&gt;
&lt;strong&gt;D3&lt;/strong&gt;-&amp;gt; Newsweek&lt;br&gt;
&lt;strong&gt;D4&lt;/strong&gt;-&amp;gt; MAD&lt;br&gt;
&lt;strong&gt;D5&lt;/strong&gt;-&amp;gt; PC World&lt;br&gt;
&lt;br&gt;
Could you please guide me on this if you have any idea?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to add macro in excel sheet using c#">
      <Posts>
        <Post From="vivekdeshmukh" When="23/10/2015 12:01:39">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello Team,&lt;br&gt;
&lt;pre&gt;&lt;code&gt;      We need to implement few macros in excel sheet while creating sheet by epplus. Is there any way which we can use to create macros in excel sheet? Can you please provide us the solution or guide us with the workaround if you have any?&lt;/code&gt;&lt;/pre&gt;
Thank You so much in advance!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="chart series colour">
      <Posts>
        <Post From="mtsatria" When="23/10/2015 10:45:37">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
It's possible to specify a specific colour for each series of a chart having more than one serie?
&lt;br&gt;
I know that it's possibile use this instruction for the built-in chart styles: &lt;br&gt;
&lt;br&gt;
chart.Style = eChartStyle.Style1; &lt;br&gt;
&lt;br&gt;
But i want to customize it. &lt;br&gt;
&lt;br&gt;
Thx&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Excel file download without save">
      <Posts>
        <Post From="rampblr" When="22/10/2015 16:46:27">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi All, &lt;br&gt;
&lt;br&gt;
I'm new this technology. i am using epplus it works greate. but i struggle in generate excel from ajax.. Actually i call excel generate function from ajax but the response doesnot return the files. please help me how to generate excel file from ajax without
 saving. &lt;br&gt;
&lt;br&gt;
Thanks in Advance&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Don't find method calculate in workbook">
      <Posts>
        <Post From="dsillero" When="20/03/2015 10:25:55">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
I'm evaluating the component but I have a problem with the method Calculate because the solution doesn't compile.
&lt;br&gt;
&lt;br&gt;
Dim excP As New OfficeOpenXml.ExcelPackage &lt;br&gt;
Dim fsFC As System.IO.FileStream &lt;br&gt;
excP.Load(fsFC) &lt;br&gt;
fsFC.Close() &lt;br&gt;
excP.Workbook.Calculate() --&amp;gt; The compiler doesn't find the method &lt;br&gt;
&lt;br&gt;
I'm using the latest version of EPPlus 4.0.3 &lt;br&gt;
&lt;br&gt;
Can anybody help me? &lt;br&gt;
&lt;br&gt;
Thanks.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="silahian" When="15/10/2015 04:33:57">
          <Html>
        &lt;div class="markDownOutput "&gt;Happened to me also... &lt;br&gt;
Just add the "using" statement instead of referencing on the instantiate:
&lt;br&gt;
&lt;br&gt;
using OfficeOpenXml; &lt;br&gt;
using OfficeOpenXml.FormulaParsing; &lt;br&gt;
&lt;br&gt;
&lt;br&gt;
That will bring you the Calculate() method. &lt;br&gt;
&lt;br&gt;
good luck&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="dsillero" When="17/10/2015 14:01:43">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
Do you have a small example? &lt;br&gt;
&lt;br&gt;
I'm trying to add in the top of the class Imports OfficeOpenXML and OfficeOpenXml.FormulaParsing like your using but it happens the same.
&lt;br&gt;
&lt;br&gt;
If you can send me a complete code of a small example it will be perfect for me. &lt;br&gt;
&lt;br&gt;
Sorry for the inconveniences. &lt;br&gt;
&lt;br&gt;
Regards&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="External File calculation.">
      <Posts>
        <Post From="conn_dev2007" When="15/10/2015 21:00:05">
          <Html>
        &lt;div class="markDownOutput "&gt;How can get the value of external cell calculation in excel sheet? I use .Calculate method but still It does not return any value.
&lt;br&gt;
=SUM('G:\RND\ReadWriteExcelFile\ReadWriteExcelFile\ExlFile[Test1.xlsx]Sheet1'!$A$4:$B$4)
&lt;br&gt;
&lt;br&gt;
We are using above formul. &lt;br&gt;
&lt;br&gt;
Is there any help for this?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Rgb property always return null?">
      <Posts>
        <Post From="jdnichollsc" When="21/01/2015 16:54:25">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi friends! :D &lt;br&gt;
&lt;br&gt;
One question, the Rgb property from styles always return null? &lt;br&gt;
&lt;br&gt;
See please &lt;br&gt;
&lt;br&gt;
&lt;a href="http://epplus.codeplex.com/workitem/15142" rel="nofollow"&gt;http://epplus.codeplex.com/workitem/15142&lt;/a&gt;
&lt;br&gt;
&lt;br&gt;
Does this also happens with the color of the borders? &lt;br&gt;
&lt;br&gt;
&lt;img alt="Image" src="http://content.screencast.com/users/jdnichollsc/folders/Jing/media/0044bf73-eff9-4db9-804c-529bdbd18a4c/issue%20Rgb%20property%20in%20Borders.png"&gt;
&lt;br&gt;
&lt;br&gt;
Regards, Nicholls&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="jcutburth" When="13/10/2015 20:30:29">
          <Html>
        &lt;div class="markDownOutput "&gt;I am also having this problem. I think it is related to the use of theme colors.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Epplus corrupt style after package save - Office 2013">
      <Posts>
        <Post From="qwerty321" When="21/07/2014 15:30:27">
          <Html>
        &lt;div class="markDownOutput "&gt;I am using EPPlus 4.0 beta 2 and writing in c#. I opened excel file (Office 2013), modified content and saved package with using EPPlus. Then I open file and file styles are corrupted. The Problem is after calling method save() on package.&lt;br&gt;
Is any way to fix it? Will EPPlus develop to compatible with Office 2013?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="MagierCapo" When="12/10/2015 15:51:15">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello, I'm facing the same problems, but with big files only (~10MB Size). (Version 4.0.4)&lt;br&gt;
&lt;ul&gt;
&lt;li&gt;It takes very long to open the xlsx-File (~15 Minutes) &lt;/li&gt;&lt;li&gt;Then Excel comment that the file seems corrupt &lt;/li&gt;&lt;li&gt;After repairing, the file has been opened but all hyperlinks have been removed
&lt;br&gt;
(there are a lot of hyperlinks)&lt;br&gt;
&lt;/li&gt;&lt;/ul&gt;
Is there a solution for Big Files (with hyperlinks) in Office 2013 with a new version on the way?&lt;br&gt;
&lt;br&gt;
thanks and kr&lt;br&gt;
Phil&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="MagierCapo" When="13/10/2015 12:05:59">
          <Html>
        &lt;div class="markDownOutput "&gt;Ok I've recognised that the root of the problem is the amount of hyperlinks in the xlsx-document.
&lt;br&gt;
&lt;br&gt;
In my case there were more than 118'000 rows and each row has had a cell with a hyperlink. =&amp;gt; 118'166 hyperlinks ...
&lt;br&gt;
&lt;br&gt;
In the c#-Code, I've limited the creation of hyperlinks to &amp;lt;=10'000 and this solved the problem..&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Performance difference between two computers (C#)">
      <Posts>
        <Post From="oram83" When="12/10/2015 12:55:20">
          <Html>
        &lt;div class="markDownOutput "&gt;I have an issue with exporting a datatable to a worksheet. there is an enormous difference between two different computers, and the weirdest thing is that the slow computer is much (much) stronger than the other.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;var wsDt = pck.Workbook.Worksheets.Add(sheetName);
                wsDt.Cells["A1"].LoadFromDataTable(sheetData, true);

                for (int i = 0; i &amp;lt; sheetData.Columns.Count; i++)
                {

                    if (sheetData.Columns[i].DataType == typeof(DateTime))
                        wsDt.Cells[2, i + 1, sheetData.Rows.Count + 1, i + 2].Style.Numberformat.Format = "mm-dd-yy";
                    else if (sheetData.Columns[i].DataType == typeof(decimal))
                        if (sheetData.Columns[i].ColumnName.ToLower().Contains("pct") ||
                            sheetData.Columns[i].ColumnName.ToLower().Contains("profit") ||
                            sheetData.Columns[i].ColumnName.ToLower().Contains("chg"))
                            wsDt.Cells[2, i + 1, sheetData.Rows.Count + 1, i + 1].Style.Numberformat.Format = "0.00%";
                        else wsDt.Cells[2, i + 1, sheetData.Rows.Count + 1, i + 1].Style.Numberformat.Format = "#,###.00";

                }&lt;/code&gt;&lt;/pre&gt;
The data table is big (~150,00 rows * 102 columns) &lt;br&gt;
On my computer (win7 - 64 bit, i5) the 'fill sheet' part takes 19 seconds and the formatting part 3m15s
&lt;br&gt;
On my server (win server 2012 - 64 bit, E5-2667) it took about 7 minutes to fill the sheet and the formatting part is still running as we speak, it finished 31 columns over the last 35 minutes.
&lt;br&gt;
&lt;br&gt;
On my computer I have office 2013, on the server there is office 2010, if it makes any difference.
&lt;br&gt;
&lt;br&gt;
Any thoughts?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to read a Range of cells (e.g.A1:G30) from Excel file to GridView in ASP.NET with C# via EPPlus">
      <Posts>
        <Post From="cgeorge2k15" When="09/10/2015 15:51:16">
          <Html>
        &lt;div class="markDownOutput "&gt;Good day,&lt;br&gt;
&lt;br&gt;
I have been looking for a solution all over the last days and I found that this library EPPlus allows retrieving in the same time formatting besides the actual data, plus charts,if needed, from Excel files which is what I am aiming at the moment.&lt;br&gt;
&lt;br&gt;
Could you please explain me step by step how to read a Range of cells from an Excel (like A1;P34) file that resides at a certain path , via ASP.NET/C#?&lt;br&gt;
&lt;blockquote&gt;PATH would be something like //ServerName/Folder1/Folder2/Folder3/ExcelFileName.xlsx&lt;br&gt;
&lt;/blockquote&gt;
I looked over the web, but there is not explicit documentation for my level of C# expertise on this. I tried several examples , but none displayed the Excel Range into the webpage. ( e.g this one
&lt;a href="http://funcodingbyme.blogspot.ro/2013/12/import-data-from-excel-sheet-into.html" rel="nofollow"&gt;
http://funcodingbyme.blogspot.ro/2013/12/import-data-from-excel-sheet-into.html&lt;/a&gt; )&lt;br&gt;
&lt;br&gt;
Note: the three examples I have tried all included an File Upload Control, I do not need such. I want to read the Excel file from a specified location over the local network.&lt;br&gt;
Please do not yell at me, I have searched for and skimmed over the previous posts with "Read from Excel to ASP via EPPlus".I just could not find anything to make me understand.&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Thank you in advance, additionally if you can recommend me any simpler resources and examples to understand EPPlus on&lt;br&gt;
-reading from Excel &lt;br&gt;
-writing from Excel &lt;br&gt;
-reading charts from Excel&lt;br&gt;
&lt;br&gt;
This EPPlus does seem wonderful in its functionality. Just that I am not an experienced programmer and I want to understand it so that I would be capable to use it on my own, rather than applying blind Copy/paste recipes.&lt;br&gt;
&lt;br&gt;
Thanks once more.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Issues saving to .xlsm file">
      <Posts>
        <Post From="Phakamani" When="30/09/2015 14:49:03">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi Guys, &lt;br&gt;
&lt;br&gt;
Does anyone know how to save changes to a .xlsm excel cell that has a formula using EPPLUS, Excelpackage.save() does not save the changes it merely puts them there until I physically open the file and save the changes using Excel,
&lt;br&gt;
&lt;br&gt;
Thanks in advance.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to open a worksheet in an Excel file using EPPlus">
      <Posts>
        <Post From="kcrsuresh" When="28/09/2015 15:08:27">
          <Html>
        &lt;div class="markDownOutput "&gt;There is a Default Excel Sheet. I want to Export data to the default Excel template which I can able to do using OledbCommand. I want some formatting to be done after exporting the data.
&lt;br&gt;
&lt;br&gt;
When I to try to open a worksheet in an Excel file, I am getting System.ArgumentException : An item with the same key has already been added.
&lt;br&gt;
&lt;br&gt;
Please find below the code I used for accessing the Excel file.&lt;br&gt;
&lt;br&gt;
using (OfficeOpenXml.ExcelPackage xlPackage = new OfficeOpenXml.ExcelPackage(new FileInfo(FilePathAndName)))&lt;br&gt;
&lt;pre&gt;&lt;code&gt;        {
            var worksheet = xlPackage.Workbook.Worksheets[3];

            if (worksheet != null)
            {
                //if (Worksheets.Count &amp;gt; 0)
                //{
               // var worksheet = xlPackage.Workbook.Worksheets["Accounts"];

                using (OfficeOpenXml.ExcelRange range = worksheet.Cells["C8:H8"])
                {
                    range.Style.Fill.PatternType = OfficeOpenXml.Style.ExcelFillStyle.Solid;
                    range.Style.Fill.BackgroundColor.SetColor(Color.White);
                    range.Style.Font.SetFromFont(new Font("Arial", 10));
                    range.Style.HorizontalAlignment = ExcelHorizontalAlignment.CenterContinuous;
                    worksheet.View.ShowGridLines = true;
                }
                xlPackage.Save();
                // }
            }


&lt;/code&gt;&lt;/pre&gt;
Thanks Suresh&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Page Layout and Scale To Width Rendering Issue">
      <Posts>
        <Post From="jkerb135" When="24/09/2015 14:50:09">
          <Html>
        &lt;div class="markDownOutput "&gt;I am currently attempting to generate an excel workbook where each sheets data has to fit to one page width and automatic height using the code below. The issue is that the sheets are not being rendered properly in excel.&lt;br&gt;
&lt;br&gt;
printerSettings.FitToPage = true&lt;br&gt;
printerSettings.FitToWidth = 1;&lt;br&gt;
printerSettings.FitToHeight = 0;&lt;br&gt;
printerSettings.Orientation = eOrientation.Landscape;&lt;br&gt;
&lt;br&gt;
&lt;strong&gt;Solutions Tried:&lt;/strong&gt;&lt;br&gt;
&lt;ul&gt;
&lt;li&gt;Formatting the document programmatically before data is entered and manipulated
&lt;/li&gt;&lt;li&gt;Formatting the document programmatically after data is entered and manipulated
&lt;/li&gt;&lt;li&gt;Generating the document in normal view then switching it to page layout view programmatically
&lt;/li&gt;&lt;li&gt;Generating the document in normal view then switching it to page layout in excel&lt;br&gt;
&lt;/li&gt;&lt;/ul&gt;
The document is not being rendered properly when opened, see picture below&lt;br&gt;
&lt;img alt="Image" src="http://i.imgur.com/aQOc9Mn.png"&gt;&lt;br&gt;
&lt;br&gt;
If any settings are changed within excel that re-renders the document it is displayed correctly see image below.&lt;br&gt;
&lt;br&gt;
&lt;strong&gt;Examples:&lt;/strong&gt;&lt;br&gt;
Going to print in the file menu shows the document rendered correctly and then the document is shown correctly&lt;br&gt;
Changing the font size in a cell&lt;br&gt;
Changing the font color in a cell&lt;br&gt;
Checking the option to print or view gridlines/heading&lt;br&gt;
&lt;br&gt;
&lt;img alt="Image" src="http://i.imgur.com/oBgUPya.png"&gt;&lt;br&gt;
&lt;br&gt;
Any help on resolving the issue would be appreciated&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Rangecells.Merge method">
      <Posts>
        <Post From="prem_rajani" When="17/08/2015 13:06:00">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
I'm new to EPPlus and with help of samples and documentation able to create and merge excel rows. But the problem that I face is while merging rows for a column, it shows up merged and if I copy the data to notepad, I see the values repeated for number of rows
 that were merged. &lt;br&gt;
&lt;br&gt;
Please can someone help me on this. Below is part of code that merges the rows.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;                    for (int k = startCount; k &amp;lt;= endCount; k++)
                    {
                        string columnName = GetExcelColumnName(k);
                        ExcelRange rangeCells = workSheet.Cells[columnName + startValue + ":" + columnName + endValue];
                        System.Array cellValue = (System.Array)rangeCells.Value;

                        List&amp;lt;string&amp;gt; listCells = cellValue.OfType&amp;lt;string&amp;gt;().ToList();

                        rangeCells.Clear();
                        //Merge the cells.
                        rangeCells.Merge = true;
                        rangeCells.Style.WrapText = true;
                        // Set the value of the cell range with single value
                        rangeCells.Value = listCells.Distinct().FirstOrDefault();
                    }&lt;/code&gt;&lt;/pre&gt;
Thanks, &lt;br&gt;
Prem&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="prem_rajani" When="19/08/2015 10:00:36">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
Any updates, please or is this a flaw in EPPlus. &lt;br&gt;
&lt;br&gt;
Thanks, &lt;br&gt;
Prem&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="prem_rajani" When="24/09/2015 06:48:55">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
When I unmerge the cells, I see all the values. Is there any way to get proper usage of merge functionality? Any suggestion is also helpful.
&lt;br&gt;
&lt;br&gt;
Thanks, &lt;br&gt;
Prem&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Does EPPLus support coding in Visual Basic 2012?">
      <Posts>
        <Post From="vbright" When="23/09/2015 15:38:30">
          <Html>
        &lt;div class="markDownOutput "&gt;That is my question. &lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to read cell that has dropdown list (datavalidations)">
      <Posts>
        <Post From="RicardoLLLLLLLLLL" When="23/09/2015 12:53:44">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi there, &lt;br&gt;
&lt;br&gt;
I created an excel workbook that has a worksheet in wich I added a dropdown list &lt;br&gt;
&lt;br&gt;
The code I used to create the dropdown: &lt;br&gt;
var validationCell = worksheet.DataValidations.AddListValidation("C3");
&lt;br&gt;
&lt;br&gt;
Usually to read a cell it's only required: &lt;br&gt;
string value = worksheet.Cells["C3"].Value &lt;br&gt;
&lt;br&gt;
But since it was created using a datavalidation, the worksheet.Cells["C3"].Value it always returns ""
&lt;br&gt;
&lt;br&gt;
Can anyone help me? :) &lt;br&gt;
&lt;br&gt;
Kind regards.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="EPPlus.dll failure,VB">
      <Posts>
        <Post From="spagg86" When="21/09/2015 21:55:40">
          <Html>
        &lt;div class="markDownOutput "&gt;Our developer had quite recently and a week ago and our application runs a daily report that's stopped running. Whenever attempt to run it gives error:
&lt;br&gt;
&lt;br&gt;
Exception thrown: 'System.InvalidOperationException' in EPPlus.dll &lt;br&gt;
The program '[13388] Stuffstuff.vshost.exe' has exited with code 2 (0x2). &lt;br&gt;
The program '[13388] Stuffstuff.vshost.exe: Program Trace' has exited with code 0 (0x0).
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
The code: &lt;br&gt;
&lt;br&gt;
/*&lt;br&gt;
&lt;ul&gt;
&lt;li&gt;I will try to explain what needs to be changed here as best as I can. &lt;/li&gt;&lt;li&gt;The underscore SKUs are identified by what number they appear in inventory in alphabetical order.
&lt;/li&gt;&lt;li&gt;For example: _Actacel60ct = 0, _ActacelCream = 1, _BookletOptimize = 4 &lt;/li&gt;&lt;li&gt;&lt;/li&gt;&lt;li&gt;If a new "_" SKU was added to inventory, determine what number it is.
&lt;/li&gt;&lt;li&gt;&lt;/li&gt;&lt;li&gt;Please see below for more green comment texts on what needs to be added/changed
&lt;br&gt;
*/ &lt;br&gt;
using System; &lt;br&gt;
using System.Collections.Generic; &lt;br&gt;
using System.Configuration; &lt;br&gt;
using System.Data.SqlClient; &lt;br&gt;
using System.IO; &lt;br&gt;
using System.Linq; &lt;br&gt;
using System.Net.Mail; &lt;br&gt;
using System.Reflection; &lt;br&gt;
using System.Text; &lt;br&gt;
using System.Threading.Tasks;&lt;br&gt;
&lt;/li&gt;&lt;/ul&gt;
using OfficeOpenXml; &lt;br&gt;
&lt;br&gt;
namespace StuffstuffReturns &lt;br&gt;
{&lt;br&gt;
&lt;pre&gt;&lt;code&gt;class Program
{
    static void Main(string[] args)
    {
        string sqlClients = "SELECT SKU, ItemName, Description, OnHand, BillQty " +
                            "FROM tblfscInventory " +
                            "WHERE ClientNumber = 1470;";
        /*
         *  Increment the number inside the "[]" by 1
         */
        string[][] items = new string[31][];
        bool check = true;

        FileInfo file = new FileInfo(@"C:\Tools\Stuffstuff\Reports\fsc Inventory " + DateTime.Now.ToString("MM-dd-yyyy") + ".xlsx");
        if (file.Exists)
            file.Delete();

        ExcelPackage excel = new ExcelPackage(file);
        ExcelWorksheet worksheet = CreateSheet(excel, "Inventory");

        worksheet.Cells[1, 1].Value = "SKU";
        worksheet.Cells[1, 2].Value = "ItemName";
        worksheet.Cells[1, 3].Value = "Descrption";
        worksheet.Cells[1, 4].Value = "OnHand";

        using (SqlConnection con = new SqlConnection(ConfigurationManager.ConnectionStrings["SQL"].ToString()))
        using (SqlCommand com = new SqlCommand(sqlClients, con))
        {
            con.Open();
            using (SqlDataReader read = com.ExecuteReader())
            {
                while (read.Read())
                {
                    string item = read["ItemName"].ToString();

                    while (check)
                    {
                        /*
                         *  Increment the 2nd number by 1.  Leave the 0 alone
                         */
                        for (int i = 0; i &amp;lt; 31; i++)
                        {
                            items[i] = new string[4];
                            items[i][0] = read["SKU"].ToString();
                            items[i][1] = read["ItemName"].ToString();
                            items[i][2] = read["Description"].ToString();
                            items[i][3] = read["OnHand"].ToString();
                            read.Read();
                        }
                        check = false;
                        break;
                    }

                    /*
                     *  When you have determined the number for the new SKU, you need to do the following:
                     *  
                     *  If you see ANY number in the first set of "[]" at the beginning of each row that EQUALS OR GREATER THAN the number for the new SKU,
                     *  you MUST increment that number by 1.
                     *  For example:
                     *       If the line begins with "items[15][3]" and your number is 15, change the 15 to a 16 in the first "[]".  LEAVE THE 3 ALONE!
                     *       
                     *  You need to go line by line and do these changes.
                     *  
                     *  If the number is LESS THAN your number, LEAVE IT ALONE!
                     *  
                     *  One more comment lies near the end of this block.
                     */
                    if (read["ItemName"].ToString().Contains("Neurocet"))
                        items[16][3] = (Int32.Parse(items[16][3]) + Int32.Parse(read["OnHand"].ToString()) * Int32.Parse(read["BillQty"].ToString())).ToString();
                    else if (read["ItemName"].ToString().Contains("Eucalyptus"))
                    {
                        for (int i = 9; i &amp;lt; 14; i++)
                            items[i][3] = (Int32.Parse(items[i][3]) + Int32.Parse(read["OnHand"].ToString())).ToString();
                    }
                    else if (read["ItemName"].ToString().Contains("Peppermint") &amp;amp;&amp;amp; !read["ItemName"].ToString().Contains("Eucalyptus"))
                    {
                        for (int i = 12; i &amp;lt; 14; i++)
                            items[i][3] = (Int32.Parse(items[i][3]) + Int32.Parse(read["OnHand"].ToString())).ToString();
                    }
                    else if (read["ItemName"].ToString().Contains("Hydraburst"))
                    {
                        if (read["ItemName"].ToString().Contains("Booklet"))
                        {
                            items[3][3] = (Int32.Parse(items[3][3]) + Int32.Parse(read["OnHand"].ToString())).ToString();
                            items[5][3] = (Int32.Parse(items[5][3]) + Int32.Parse(read["OnHand"].ToString())).ToString();
                            if (read["ItemName"].ToString().Contains("All 3"))
                            {
                                items[4][3] = (Int32.Parse(items[4][3]) + Int32.Parse(read["OnHand"].ToString())).ToString();
                                items[15][3] = (Int32.Parse(items[15][3]) + (Int32.Parse(read["OnHand"].ToString()) * (Int32.Parse(read["BillQty"].ToString()) - 3))).ToString();
                            }
                            else
                                items[15][3] = (Int32.Parse(items[15][3]) + (Int32.Parse(read["OnHand"].ToString()) * (Int32.Parse(read["BillQty"].ToString()) - 2))).ToString();
                        }
                        else
                            items[15][3] = (Int32.Parse(items[15][3]) + Int32.Parse(read["OnHand"].ToString()) * Int32.Parse(read["BillQty"].ToString())).ToString();
                    }
                    else if (item.Contains("Thin 7"))
                    {
                        if (item.Contains("Vial"))
                        {
                            if (item.Contains("Apple"))
                                items[25][3] = (Int32.Parse(items[25][3]) + Int32.Parse(read["OnHand"].ToString()) * Int32.Parse(read["BillQty"].ToString())).ToString();
                            else if (item.Contains("Carmel"))
                                items[26][3] = (Int32.Parse(items[26][3]) + Int32.Parse(read["OnHand"].ToString()) * Int32.Parse(read["BillQty"].ToString())).ToString();
                            else if (item.Contains("Chocolate"))
                                items[27][3] = (Int32.Parse(items[27][3]) + Int32.Parse(read["OnHand"].ToString()) * Int32.Parse(read["BillQty"].ToString())).ToString();
                            else if (item.Contains("Cotton"))
                                items[28][3] = (Int32.Parse(items[28][3]) + Int32.Parse(read["OnHand"].ToString()) * Int32.Parse(read["BillQty"].ToString())).ToString();
                            else if (item.Contains("Bubble"))
                                items[29][3] = (Int32.Parse(items[29][3]) + Int32.Parse(read["OnHand"].ToString()) * Int32.Parse(read["BillQty"].ToString())).ToString();
                            else if (item.Contains("Peanut"))
                                items[30][3] = (Int32.Parse(items[30][3]) + Int32.Parse(read["OnHand"].ToString()) * Int32.Parse(read["BillQty"].ToString())).ToString();

                        }
                        else if (item.Contains("Inhaler"))
                            items[24][3] = (Int32.Parse(items[24][3]) + Int32.Parse(read["OnHand"].ToString())).ToString();
                        else if (item.Contains("Warranty"))
                            items[23][3] = (Int32.Parse(items[23][3]) + Int32.Parse(read["OnHand"].ToString())).ToString();
                        else
                            items[22][3] = (Int32.Parse(items[22][3]) + Int32.Parse(read["OnHand"].ToString()) * Int32.Parse(read["BillQty"].ToString())).ToString();
                    }
                    else if (item.Contains("Reset"))
                        items[21][3] = (Int32.Parse(items[21][3]) + Int32.Parse(read["OnHand"].ToString()) * Int32.Parse(read["BillQty"].ToString())).ToString();
                    else if (item.Contains("Actacel"))
                    {
                        if (item.Contains("Cream"))
                            items[1][3] = (Int32.Parse(items[1][3]) + Int32.Parse(read["OnHand"].ToString()) * Int32.Parse(read["BillQty"].ToString())).ToString();
                        else
                            items[0][3] = (Int32.Parse(items[0][3]) + Int32.Parse(read["OnHand"].ToString()) * Int32.Parse(read["BillQty"].ToString())).ToString();
                    }
                    else if (item.Contains("Regenify"))
                        items[19][3] = (Int32.Parse(items[19][3]) + Int32.Parse(read["OnHand"].ToString()) * Int32.Parse(read["BillQty"].ToString())).ToString();
                    else if (item.Contain

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="spagg86" When="21/09/2015 21:57:31">
          <Html>
        &lt;div class="markDownOutput "&gt;Nothing has changed since the following week, same issue with VB 2013 and VB 2015. The path for EPPlus.dll has not changed and the paths are correct. At the moment running out of ideas and I am not really a developer.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="EPPlus Compatibility with Windows 10 Universal App">
      <Posts>
        <Post From="Martooo" When="15/09/2015 08:24:13">
          <Html>
        &lt;div class="markDownOutput "&gt;
&lt;h2&gt;I am trying to use EPPlus in an Windows 10 Universal App. However, it seems the FileInfo class cannot be used to create the pacakge. For example, I am using:&lt;/h2&gt;
FileInfo newFile = new FileInfo("..."); &lt;br&gt;
&lt;br&gt;
using (ExcelPackage package = new ExcelPackage(newFile))&lt;br&gt;
&lt;h2&gt;{ ... }&lt;/h2&gt;
Visual Studio 2015 prompts an error saying "Reference to type 'FileInfo' claims it is defined in 'mscorlib', but it could not be found".
&lt;br&gt;
&lt;br&gt;
I guess it is caused by the big difference between traditional .net framework / Win32 and the new universal platform. Any suggestion to overcome this?
&lt;br&gt;
&lt;br&gt;
Thanks.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Are there any plans to add enum Number Formatting?">
      <Posts>
        <Post From="krillgar" When="16/07/2014 17:44:17">
          <Html>
        &lt;div class="markDownOutput "&gt;I was just tasked to add "Accounting" formatting to the one column of a spreadsheet I've been making with your library.
&lt;br&gt;
&lt;br&gt;
Seeing as there's a NumFormat readonly property on the Cell's Style.NumberFormat property, is there any chance of adding an enum of the predefined cell styles that Excel has and using that enum to set the formatting on cells instead of having to find that the
 string format for "Accounting" is "&lt;em&gt;($* #,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00&lt;/em&gt;);_($* (#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00);_($* \"-\"??_);_&lt;a href='mailto:??_);_(@_)".&amp;amp;&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/10"&gt;#10&lt;/a&gt;;&amp;amp;&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/10"&gt;#10&lt;/a&gt;;I' rel="nofollow"&gt;??_);_(@_)". I&lt;/a&gt; just think that'd be something simple to implement (aside from getting those
 string values), and would even be willing to help work on implementing that for you.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="bthomason" When="14/09/2015 17:30:18">
          <Html>
        &lt;div class="markDownOutput "&gt;I would like a reply to this as well. I also would be willing to help with this as I was just given the same task.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="bthomason" When="14/09/2015 17:49:24">
          <Html>
        &lt;div class="markDownOutput "&gt;Just for reference, and this could be the reason they haven't done this yet, I am using Excel 2007. The format I used is slightly different than the one you provided, code below.&lt;br&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;const&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; ACCOUNTING_FORMAT = &lt;span style="color: rgb(163, 21, 21);"&gt;"_($* #,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00_);_($* (#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00);_($ \" - \"??_);_(@_)"&lt;/span&gt;;
worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"B3"&lt;/span&gt;].Style.Numberformat.Format = ACCOUNTING_FORMAT;
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="EPPlus 4.0.4 changes the height of some rows">
      <Posts>
        <Post From="evgnib123" When="14/09/2015 14:04:58">
          <Html>
        &lt;div class="markDownOutput "&gt;The &lt;a href="https://epplus.codeplex.com/workitem/15344" rel="nofollow"&gt;template&lt;/a&gt; has a rows of varying heights, EPPlus 4.0.4 resize rows without my participation.
&lt;br&gt;
&lt;br&gt;
For example, in the template file "template_2.xlsx" rows: 1,2,4,5 have a height: 0.3cm, but in the resulting file, we see that the height of rows changed.
&lt;br&gt;
&lt;pre&gt;&lt;code&gt;OfficeOpenXml.ExcelPackage pkg = 
 new OfficeOpenXml.ExcelPackage( new FileInfo(@"C:\Test\Out\out_file.xlsx")
   , new FileInfo(@"C:\Test\template_2.xlsx"));
pkg.Save();&lt;/code&gt;&lt;/pre&gt;
Why is that?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Chart HAxis Label Orientation">
      <Posts>
        <Post From="jordansinko" When="11/09/2015 15:48:51">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello,&lt;br&gt;
&lt;br&gt;
We are trying to rotate text on the Horizontal Axis of a chart so that it is 90 degrees. Is there functionality in EPPlus that allows for this? I am unable to find a way to complete this.&lt;br&gt;
&lt;br&gt;
Thank you in advance.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Contributor list">
      <Posts>
        <Post From="costea32" When="09/09/2015 14:51:12">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi guys, I think you should include a contributors file to the repo, to update with contributors. This would show a lot of respect for the contributors, and seems to be a practice adopted by some other communities like NUnit.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Dimension is throwing null reference">
      <Posts>
        <Post From="TanvirHussainAbir" When="01/09/2015 15:55:29">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi All, &lt;br&gt;
&lt;br&gt;
Can anybody please help why my Dimension object is null? &lt;br&gt;
&lt;br&gt;
public class ExcelWorksheet : XmlHelper, IDisposable&lt;br&gt;
&lt;pre&gt;&lt;code&gt;{
    // Summary:
    //     A worksheet
    //
    // Parameters:
    //   ns:
    //     Namespacemanager
    //
    //   excelPackage:
    //     Package
    //
    //   relID:
    //     Relationship ID
    //
    //   uriWorksheet:
    //     URI
    //
    //   sheetName:
    //     Name of the sheet
    //
    //   sheetID:
    //     Sheet id
    //
    //   positionID:
    //     Position
    //
    //   hide:
    //     hide
    public ExcelWorksheet(XmlNamespaceManager ns, ExcelPackage excelPackage, string relID, Uri uriWorksheet, string sheetName, int sheetID, int positionID, eWorkSheetHidden hide);



    // Summary:
    //     Dimension address for the worksheet. Top left cell to Bottom right.  If the
    //     worksheet has no cells, null is returned
    public ExcelAddressBase Dimension { get; }
&lt;/code&gt;&lt;/pre&gt;
Thaanks&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Add Calculated Field to Pivot Table, How to use eShowDataAs enum for ExcelPivotTableField">
      <Posts>
        <Post From="vb21" When="30/05/2014 08:08:24">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi,&lt;br&gt;
&lt;pre&gt;&lt;code&gt;I am creating a pivot table from a range from another sheet in same workbook. I need to add calculated field to pivot table. For example, if the source range has 2 fields 'Purchase' and 'Sell' both numeric and if i need to calculate profit in pivot table as sell - purchase. How to add the calculated field to pivot table using epplus since my calculation is bit complex type one.&lt;/code&gt;&lt;/pre&gt;
Also, in pivot table if i wanna add one more column as percent of column total then how to add it using enum eShowDataAs which already exists in the epplus' ExcelPivotTableField Namespace.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="epplusrox123" When="24/07/2015 18:53:26">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi,&lt;br&gt;
&lt;br&gt;
I had the same two problems and here's two extension methods what I came up it. Hope it helps. These are largely untested but work for me in v.4.04 and applying these after I've created the pivot table in EPPlus.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;    /// &amp;lt;summary&amp;gt;
    /// Add a calculated field to EPPlus pivot table.
    /// &amp;lt;/summary&amp;gt;
    /// &amp;lt;param name="pivotTable"&amp;gt;&amp;lt;/param&amp;gt;
    /// &amp;lt;param name="name"&amp;gt;Name for the created data field&amp;lt;/param&amp;gt;
    /// &amp;lt;param name="formula"&amp;gt;Formula&amp;lt;/param&amp;gt;
    /// &amp;lt;param name="numFmtId"&amp;gt;Id for number format
    /// 
    /// Build in ID's
    /// 
    /// 0   General 
    /// 1   0 
    /// 2   0.00 
    /// 3   #,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt; 
    /// 4   #,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00 
    /// 9   0% 
    /// 10  0.00% 
    /// 11  0.00E+00 
    /// 12  # ?/? 
    /// 13  # ??/?? 
    /// 14  mm-dd-yy 
    /// 15  d-mmm-yy 
    /// 16  d-mmm 
    /// 17  mmm-yy 
    /// 18  h:mm AM/PM 
    /// 19  h:mm:ss AM/PM 
    /// 20  h:mm 
    /// 21  h:mm:ss 
    /// 22  m/d/yy h:mm 
    /// 37  #,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt; ;(#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;) 
    /// 38  #,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt; ;[Red](#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;) 
    /// 39  #,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00;(#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00) 
    /// 40  #,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00;[Red](#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00) 
    /// 45  mm:ss 
    /// 46  [h]:mm:ss 
    /// 47  mmss.0 
    /// 48  #&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.0E+0 
    /// 49  @
    /// &amp;lt;/param&amp;gt;
    /// &amp;lt;param name="index"&amp;gt;Position of dataField. Zero based.&amp;lt;/param&amp;gt;
    /// &amp;lt;param name="caption"&amp;gt;Caption if different from name.&amp;lt;/param&amp;gt;
    public static void AddCalculatedField(this OfficeOpenXml.Table.PivotTable.ExcelPivotTable pivotTable, string name, string formula, int numFmtId = 10, int? index = 0, string caption = null)
    {
        if (!pivotTable.WorkSheet.Workbook.Styles.NumberFormats.Where(nf =&amp;gt; nf.NumFmtId == numFmtId).Any())
            throw new ArgumentOutOfRangeException("Not a valid numFmtId.");

        //First, add the calculated field cacheFields element as a childr of the cacheFields element in the pivotCacheDefinition1.xml
        XmlElement cacheFieldsElement = pivotTable.CacheDefinition.CacheDefinitionXml.GetElementsByTagName("cacheFields")[0] as XmlElement;

        //Add the cacheField element and take note of the index 
        XmlAttribute cacheFieldsCountAttribute = cacheFieldsElement.Attributes["count"];
        int count = Convert.ToInt32(cacheFieldsCountAttribute.Value);
        cacheFieldsElement.InnerXml += String.Format("&amp;lt;cacheField name=\"{0}\" numFmtId=\"0\" formula=\"{1}\" databaseField=\"0\"/&amp;gt;\n", name, formula);
        int cacheFieldIndex = ++count;
        //update cachefields count attribute
        cacheFieldsCountAttribute.Value = count.ToString();

        //Next, update pivotTable1.xml and insert pivotField element as a child of the pivotFields element
        XmlElement pivotFieldsElement = pivotTable.PivotTableXml.GetElementsByTagName("pivotFields")[0] as XmlElement;
        XmlAttribute pivotFieldsCountAttribute = pivotFieldsElement.Attributes["count"];
        pivotFieldsElement.InnerXml += "&amp;lt;pivotField dataField=\"1\" compact=\"0\" outline=\"0\" subtotalTop=\"0\" dragToRow=\"0\" dragToCol=\"0\" dragToPage=\"0\" showAll=\"0\" includeNewItemsInFilter=\"1\" defaultSubtotal=\"0\"/&amp;gt; \n";
        //update pivotFields count attribute
        pivotFieldsCountAttribute.Value = (int.Parse(pivotFieldsCountAttribute.Value) + 1).ToString();

        //Also in pivotTable1.xml, insert the &amp;lt;dataField&amp;gt; to the correct position, the fld here points to cacheField index
        XmlElement dataFields = pivotTable.PivotTableXml.GetElementsByTagName("dataFields")[0] as XmlElement;

        //Create the dataField element with the attributes
        XmlElement dataField = pivotTable.PivotTableXml.CreateElement("dataField", pivotTable.PivotTableXml.DocumentElement.NamespaceURI);
        dataField.RemoveAllAttributes();
        XmlAttribute nameAttrib = pivotTable.PivotTableXml.CreateAttribute("name");

        //cacheField cannot have same name attribute as dataField
        if (caption == null || caption == name)
            nameAttrib.Value = " " + name;
        else 
            nameAttrib.Value = caption;
        dataField.Attributes.Append(nameAttrib);

        XmlAttribute fldAttrib = pivotTable.PivotTableXml.CreateAttribute("fld");

        fldAttrib.Value = (cacheFieldIndex - 1).ToString();
        dataField.Attributes.Append(fldAttrib);
        XmlAttribute baseFieldAttrib = pivotTable.PivotTableXml.CreateAttribute("baseField");
        baseFieldAttrib.Value = "0";
        dataField.Attributes.Append(baseFieldAttrib);
        XmlAttribute baseItemAttrib = pivotTable.PivotTableXml.CreateAttribute("baseItem");
        baseItemAttrib.Value = "0";
        dataField.Attributes.Append(baseItemAttrib);
        XmlAttribute numFmtIdAttrib = pivotTable.PivotTableXml.CreateAttribute("numFmtId");
        numFmtIdAttrib.Value = numFmtId.ToString();
        dataField.Attributes.Append(numFmtIdAttrib);

        //Insert dataField element to the correct position.
        if (index &amp;lt;= 0)
        { 
            dataFields.PrependChild(dataField);
        }
        else if (index &amp;gt;= dataFields.ChildNodes.Count)
        {
            dataFields.AppendChild(dataField);
        }
        else
        {
            XmlNode insertBeforeThis = dataFields.ChildNodes.Item(index.Value);
            if (insertBeforeThis != null)
                dataFields.InsertBefore(dataField, insertBeforeThis);
            else
                dataFields.AppendChild(dataField);
        }

    }



    /// &amp;lt;summary&amp;gt;
    /// Possible values for the ShowDataAs attribute. 
    /// Values got from http://www.ecma-international.org/publications/files/ECMA-ST/ECMA-376,%20Fourth%20Edition,%20Part%201%20-%20Fundamentals%20And%20Markup%20Language%20Reference.zip 
    /// Section 18.8.70
    /// &amp;lt;/summary&amp;gt;
    public enum DataFieldShowDataAs
    {
        difference,
        index,
        normal,
        percentDiff,
        percent,
        percentOfCol,
        percentOfRow,
        percentOfTotal,
        runTotal
    }

    /// &amp;lt;summary&amp;gt;
    /// EPPlus doesn't support the Show Data As for pivot data fields. Set the xml for it with this method.
    /// &amp;lt;/summary&amp;gt;
    /// &amp;lt;param name="dataField"&amp;gt;&amp;lt;/param&amp;gt;
    /// &amp;lt;param name="pivot"&amp;gt;&amp;lt;/param&amp;gt;
    /// &amp;lt;param name="showDataAs"&amp;gt;&amp;lt;/param&amp;gt;
    public static void SetDataFieldShowDataAsAttribute(this ExcelPivotTableDataField dataField, ExcelPivotTable pivot, DataFieldShowDataAs showDataAs)
    {
        if (pivot != null &amp;amp; pivot.DataFields != null &amp;amp;&amp;amp; pivot.DataFields.Contains(dataField))
        {
            string showDataAsAttributeValue = Enum.GetName(typeof(DataFieldShowDataAs), showDataAs);
            var xml = pivot.PivotTableXml;
            XmlNodeList elements = xml.GetElementsByTagName("dataField");

            foreach (XmlNode elem in elements)
            {
                XmlAttribute fldAttribute = elem.Attributes["fld"];
                if (fldAttribute != null &amp;amp;&amp;amp; fldAttribute.Value == dataField.Index.ToString())
                {
                    XmlAttribute showDataAsAttribute = elem.Attributes["showDataAs"];
                    if (showDataAsAttribute == null)
                    {
                        showDataAsAttribute = xml.CreateAttribute("showDataAs");
                        elem.Attributes.InsertAfter(showDataAsAttribute, fldAttribute);
                    }
                    showDataAsAttribute.Value = showDataAsAttributeValue;
                }
            }

        }
    }&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="grajesh115" When="13/08/2015 11:14:40">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
Could you please let me know how we can use formula parameter..in my requirement I have a calculated field and the value will be derived from other two columns in the excel..please let me know how we can achieve the same.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="epplusrox123" When="28/08/2015 16:34:06">
          <Html>
        &lt;div class="markDownOutput "&gt;Easiest is to create the calculated field in excel and copy paste the formula it generates.
&lt;br&gt;
&lt;br&gt;
For example pivotTable.AddCalculatedField("Percentage", "'ColA' / 'ColB'", 10, 2);
&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="DataLabel.Position in BarChart">
      <Posts>
        <Post From="montella" When="26/08/2015 16:04:52">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello, &lt;br&gt;
&lt;br&gt;
how can i set position of datalabels in BarChart, please? &lt;br&gt;
&lt;br&gt;
In PIeChart etc., there is DataLabel property that contains Position property, but there isn't any Position property in ExcelBarChart and there is no ExcelBarSerie with DataTable.Position property..
&lt;br&gt;
&lt;br&gt;
I have tried to modify manually XML like this.. &lt;br&gt;
&lt;br&gt;
chart.ChartXml.InnerXml = chart.ChartXml.InnerXml.Replace("&amp;lt;c:dLbls&amp;gt;",&lt;br&gt;
&lt;pre&gt;&lt;code&gt;             "&amp;lt;c:dLbls&amp;gt;&amp;lt;c:dLblPos val=\"outEnd\"/&amp;gt;");
&lt;/code&gt;&lt;/pre&gt;
But the file is corrupted. Please help me if you can. &lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Not able to copy the cell formula">
      <Posts>
        <Post From="pkranthi" When="26/08/2015 14:25:20">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
I am trying to copy rows from one sheet to another workbook sheet. some of the cells contain formulae which I want them to be updated as per the new sheet's relative location.
&lt;br&gt;
&lt;br&gt;
However,setting the cell's formula or FormulaR1C1 property does not seem to work.
&lt;br&gt;
here is what I am doing to copy the row.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;                                       {
                                           string  emp_id = srcWorksheet.Cells[i,1].Value.ToString();
                                           Console.WriteLine("Employee ID= "+emp_id);
                                           if(i%2==0)
                                           {
                                            worksheet.InsertRow(row,1);
                                               for(int col=1;col&amp;lt;endCol;col++){
                                                if(srcWorksheet.Cells[i,col].FormulaR1C1!=null &amp;amp;&amp;amp; srcWorksheet.Cells[i,col].FormulaR1C1.Length&amp;gt;0)
                                                    worksheet.Cells[row,col].FormulaR1C1=srcWorksheet.Cells[i,col].FormulaR1C1;
                                                    else
                                                    worksheet.Cells[row,col].Value=srcWorksheet.Cells[i,col].Value;
                                               }
                                               row++;
                                               
                                               
                                            }   
                                       }&lt;/code&gt;&lt;/pre&gt;
Original formula: &lt;br&gt;
IF(OR(W100="USA",W100="IRL"),VLOOKUP(G100,Guidance!$B$16:$C$25,2,0),VLOOKUP(G100,Guidance!$B$16:$D$25,3,0))
&lt;br&gt;
&lt;br&gt;
Formula in the copied cell: &lt;br&gt;
=IF(OR(W13="USA",W13="IRL"),VLOOKUP(G13,$B$179:$C$188,2,0),VLOOKUP(G13,$B$179:$D$188,3,0))
&lt;br&gt;
&lt;br&gt;
It looks like the reference to the sheet is lost and the formula is corrupted in the process.
&lt;br&gt;
&lt;br&gt;
Could anybody please let me know how I can solve this issue? &lt;br&gt;
&lt;br&gt;
Thanks in advance.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="ArgumentOutOfRange exception with ExcelStyles.CreateNamedStyle()">
      <Posts>
        <Post From="SpooRancher" When="25/08/2015 17:07:09">
          <Html>
        &lt;div class="markDownOutput "&gt;EPPlus is fantastically useful, so many thanks to everyone concerned to start.
&lt;br&gt;
&lt;br&gt;
I have a problem with named styles in 4.0.4, though. I pulled the default source branch today and built to do some digging. Using some of the code from EPPlus\Worksheet.cs, I've boiled it down to this fragment:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;using ( ExcelPackage _pck = new ExcelPackage())
{
  var wsSheet = _pck.Workbook.Worksheets.Add("NamedStyles");
  var firstNamedStyle = _pck.Workbook.Styles.CreateNamedStyle("templateFirst");
  var s = firstNamedStyle.Style;
  s.HorizontalAlignment = ExcelHorizontalAlignment.CenterContinuous;

  var secondNamedStyle _pck.Workbook.Styles.CreateNamedStyle("first",firstNamedStyle.Style).Style;
}&lt;/code&gt;&lt;/pre&gt;
Run this, and the final call to CreateNamedStyle() throws ArgumentOutOfRangeException.
&lt;br&gt;
&lt;br&gt;
However, if you omit setting the HorizontalAlignment property, so the first style is unmodified, it works:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;using ( ExcelPackage _pck = new ExcelPackage())
{
  var wsSheet = _pck.Workbook.Worksheets.Add("NamedStyles");
  var firstNamedStyle = _pck.Workbook.Styles.CreateNamedStyle("templateFirst");
  var s = firstNamedStyle.Style;
 
  var secondNamedStyle _pck.Workbook.Styles.CreateNamedStyle("first",firstNamedStyle.Style).Style;
}&lt;/code&gt;&lt;/pre&gt;
The exception comes from ExcelStyles.cs @ line 881:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;xfs = style.CellXfs[styleID];&lt;/code&gt;&lt;/pre&gt;
In the working case, styleID is 0 and the CellXfs collection contains 1 member. &lt;br&gt;
&lt;br&gt;
In the failed case, styleID is 2 and the CellXfs collection contains 2 members. &lt;br&gt;
&lt;br&gt;
Looking at the style objects, the properties of firstNamedStyle.Style are fine until something is modified, and then all except the one set throw ArgumentOutOfRangeException in the debugger.
&lt;br&gt;
&lt;br&gt;
I didn't find this as a known issue. &lt;br&gt;
&lt;br&gt;
Thanks &lt;br&gt;
&lt;br&gt;
Alan&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="JohannesH" When="26/08/2015 14:21:23">
          <Html>
        &lt;div class="markDownOutput "&gt;I'm having problems with styles as well. If I call: &lt;br&gt;
&lt;br&gt;
pck.Workbook.Styles.CreateNamedStyle("TableNumber"): &lt;br&gt;
&lt;br&gt;
and then try to save the package I get a NullreferenceException "Object reference not set to an instance of an object." somewhere in ExcelPackage.Save().&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Sparklines">
      <Posts>
        <Post From="CellBent" When="14/04/2013 19:35:17">
          <Html>
        &lt;div class="markDownOutput "&gt;Curious whether there has been any thought to supporting sparklines in EPPlus. My understanding is that they were first introduced in Excel 2010, which may make it a non-starter if EPPlus has to support Excel 2007.
&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="dukech" When="05/01/2015 05:54:59">
          <Html>
        &lt;div class="markDownOutput "&gt;Also curious about this. Haven't found any reference to sparklines using EPPlus however an alternate product (SpreadsheetLight) does support them so they must be possible?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="05/01/2015 13:33:38">
          <Html>
        &lt;div class="markDownOutput "&gt;Currently our focus is to stabilize the 4.0 release with the new Cell store and the Formula Parser. We might look into adding new features such as sparklines after that.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="andreqb" When="16/08/2015 16:16:17">
          <Html>
        &lt;div class="markDownOutput "&gt;Has there been progress toward adding this feature?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Can you return arrays from ExcelFunction?">
      <Posts>
        <Post From="ebeiler" When="08/08/2015 13:21:51">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
I am trying to implement the LINEST function in an Excel Function. I can get the single slope value to work fine. However, when I try to return an array for the statistics option by returning CreateResult(statisticsMatrix, DataType.Enumerable); it isn't working
 all that well. Should this be possible with the current build? If so, is there an example on how to implement this somewhere?
&lt;br&gt;
&lt;br&gt;
Thanks for the help,&lt;br&gt;
&lt;ul&gt;
&lt;li&gt;Eric&lt;br&gt;
&lt;/li&gt;&lt;/ul&gt;
Below is my entire class:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;    internal class LinestFunction : ExcelFunction
    {
        private const int knowYsIndex = 0;
        private const int knowXsIndex = 1;
        private const int interceptIndex = 2;
        private const int statisticsIndex = 3;
        private const int slopeIndex = 0;
        private const int standardDeviationIndex = 1;
        private const int correlationCoefficientIndex = 2;

        public override CompileResult Execute(IEnumerable&amp;lt;FunctionArgument&amp;gt; arguments, ParsingContext context)
        {
            CompileResult result = CreateResult("Error", DataType.ExcelError);
            FunctionArgument[] _arguments = arguments.ToArray();
            ExcelDataProvider.IRangeInfo knownYsArgument = _arguments[knowYsIndex].ValueAsRangeInfo;
            ExcelDataProvider.IRangeInfo  knownXsArgument = _arguments[knowXsIndex].ValueAsRangeInfo;
            if (knownYsArgument != null &amp;amp;&amp;amp; knownXsArgument != null)
            {
                double[] xValues = knownXsArgument.Select(cell =&amp;gt; cell.ValueDouble).ToArray();
                double[] yValues = knownYsArgument.Select(cell =&amp;gt; cell.ValueDouble).ToArray();

                Tuple&amp;lt;double,double&amp;gt; lineFitParameters = SimpleRegression.Fit(xValues, yValues);
                double slope = lineFitParameters.Item2;
                if (!double.IsNaN(slope))
                {
                    FunctionArgument statisticsArgument = _arguments.Length &amp;gt; statisticsIndex ? _arguments[statisticsIndex] : null;
                    if (statisticsArgument != null &amp;amp;&amp;amp; (bool)statisticsArgument.Value)
                    {
                        double intercept = lineFitParameters.Item1;
                        double[] yInterpolated = xValues.Select(x =&amp;gt; slope * x + intercept).ToArray();

                        double[] statisticMatrix = new double[3];
                        statisticMatrix[slopeIndex] = slope;
                        statisticMatrix[standardDeviationIndex] = 0;
                        statisticMatrix[correlationCoefficientIndex] = Correlation.Pearson(yValues, yInterpolated);
                        result = CreateResult(statisticMatrix, DataType.Enumerable);
                    }
                    else
                        result = CreateResult(slope, DataType.Decimal);
                }
            }
            return result;
        }
    }&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="how to add documentation to VS">
      <Posts>
        <Post From="ofirarzi" When="06/08/2015 10:07:34">
          <Html>
        &lt;div class="markDownOutput "&gt;Is there a way I can add the EPPlus 4.0.chm documentation file to VS so I could access it easily using F1 like any other documentation files?
&lt;br&gt;
&lt;br&gt;
Thanks.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Find Last Cell with Text">
      <Posts>
        <Post From="roh0987" When="25/07/2015 07:59:57">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello Everybody. How can we get address of last cell with any text written in it ?? Thanks in advance..&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="ShapeRange.LockAspectRatio?">
      <Posts>
        <Post From="ova2010" When="19/07/2015 23:18:49">
          <Html>
        &lt;div class="markDownOutput "&gt;In EPPlus equivalent to the operator Excel: Selection.ShapeRange.LockAspectRatio = msoFalse?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Is there a way to tell if a cell is part of a frozen pane?">
      <Posts>
        <Post From="VB_" When="17/07/2015 15:49:05">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
I was wondering if anyone could tell if there is currently a way to tell if a cell is frozen?
&lt;br&gt;
&lt;br&gt;
I've checked the Workseet.View.Panes but the SelectedRange property appears to only have a single cell address and I've seen the Freeze and Unfreeze functions in Worksheet.View, but I haven't seen any way of telling whether a cell is already part of a frozen
 range. &lt;br&gt;
&lt;br&gt;
Thanks.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How can I adjust the width of columns by pixel?">
      <Posts>
        <Post From="KenHuang" When="16/07/2015 09:27:24">
          <Html>
        &lt;div class="markDownOutput "&gt;Here is my code when I do this: &lt;br&gt;
WorkSheet.Column(1).Width = pixel / 8; &lt;br&gt;
&lt;br&gt;
When the pixel is 72 here, then this "WorkSheet.Column(1)" in the outcoming excel file is 72 pixels wide. But I have no idea what this proportion, which is 8 here, stands for. Although 8 works well in my computer, it seems that this proportion varies
 among different machines.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Scroll to the latest cell modified">
      <Posts>
        <Post From="jsa4000" When="09/07/2015 10:37:32">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello and thanks for your awsome work! &lt;br&gt;
&lt;br&gt;
By the way, I would want to know if there is a way to positioning the document in the last cell you modifed when you open it again since your last saved.
&lt;br&gt;
&lt;br&gt;
In the Microsoft.Office.Interop.Excel you can do this with the following commands:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;            xlApp.ActiveWindow.ScrollRow = 100
            xlApp.ActiveWindow.ScrollColumn = 2
&lt;/code&gt;&lt;/pre&gt;
This will position the cursor to that cell (100,2) scrolling the document automatically in the active tab when you opened.
&lt;br&gt;
&lt;br&gt;
Thanks in advance, &lt;br&gt;
&lt;br&gt;
Javier&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="09/07/2015 12:42:32">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi,&lt;br&gt;
&lt;br&gt;
Yes, you can achieve this with ActiveCell property.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;            var pck = new ExcelPackage(new FileInfo(@"c:\test.xlsx"));
            var ws = pck.Workbook.Worksheets.Add("Sample1");
            ws.View.ActiveCell = "H1";
            ws.Cells["A1"].Value = "Sample 1";
            ws.Cells["A1"].Style.Font.Bold = true;

            pck.Save();&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="jsa4000" When="09/07/2015 14:09:37">
          <Html>
        &lt;div class="markDownOutput "&gt;Thanks for your answer, &lt;br&gt;
&lt;br&gt;
I already managed to set the active cell using this sentence instead: &lt;br&gt;
&lt;br&gt;
xlWorkSheet.Select(xlWorkSheet.Cells(RowIndex, 1).Address, True) &lt;br&gt;
&lt;br&gt;
However I want to scroll automatically to that position once I open the document but I cannot find the solution in any of the examples you provide with the solution. Do you think this is possible using EPPlus?
&lt;br&gt;
&lt;br&gt;
Thanks again in advance &lt;br&gt;
Javier&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="09/07/2015 14:48:04">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi,&lt;br&gt;
&lt;br&gt;
I was thinking that excel will scroll to active cell after opened a document, but it is not true. You can emulate this behaviour with TopLeftCell but there is no implementation of this attribute in EPPlus, so you'll need to edit our code and build your own
 dll.&lt;br&gt;
&lt;br&gt;
ExcelWorksheetView.cs&lt;br&gt;
&lt;pre&gt;&lt;code&gt;        public string TopLeftCell
        {
            get
            {
                return GetXmlNodeString("@topLeftCell");
            }
            set
            {
                SetXmlNodeString("@topLeftCell", string.IsNullOrEmpty(value) ? "A1" : value );
            }
        }&lt;/code&gt;&lt;/pre&gt;
Example: &lt;br&gt;
&lt;pre&gt;&lt;code&gt;            var pck = new ExcelPackage(new FileInfo(@"c:\temp\test1.xlsx"));
            var ws = pck.Workbook.Worksheets.Add("Sample1");
            ws.View.ActiveCell  = "A2000";
            ws.View.TopLeftCell = "A1910";
            ws.Cells["A1"].Value = "Sample 1";
            ws.Cells["A1"].Style.Font.Bold = true;

            pck.Save();&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="jsa4000" When="10/07/2015 08:37:31">
          <Html>
        &lt;div class="markDownOutput "&gt;Thanks again!,&lt;br&gt;
that works good with your example. However if you use freeze panes the behaviour is completely different. For example, if you add the following line to your code, you will see the table is being truncated until TopLeftCell.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;        Dim pck As New OfficeOpenXml.ExcelPackage(New System.IO.FileInfo("c:\test.xlsx"))
        Dim ws As OfficeOpenXml.ExcelWorksheet = pck.Workbook.Worksheets.Add("Sample1")
        ws.View.ActiveCell = "H100"
        ws.View.TopLeftCell = "A85"
        ws.Cells("A1").Value = "Sample 1"
        ws.Cells("A1").Style.Font.Bold = True

        ws.View.FreezePanes(2, 1)

        pck.Save()
&lt;/code&gt;&lt;/pre&gt;
I have tried a workaround commenting the folloinwg line in the method FreezePanes(int Row, int Column) but it's still not working.&lt;br&gt;
&lt;br&gt;
&lt;strong&gt;//paneNode.SetAttribute("topLeftCell", ExcelCellBase.GetAddress(Row, Column));&lt;/strong&gt;&lt;br&gt;
&lt;br&gt;
Do you have any idea how to solve this issue?&lt;br&gt;
&lt;br&gt;
Thanks in advance&lt;br&gt;
Javier&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="10/07/2015 14:18:45">
          <Html>
        &lt;div class="markDownOutput "&gt;I managed (somehow) to do this but I don't know if it will work for all cases...
&lt;br&gt;
&lt;br&gt;
class ExcelWorksheetPanes inside ExcelWorksheetView.cs&lt;br&gt;
&lt;pre&gt;&lt;code&gt;            string _paneNodePath = "d:pane";
            public string TopLeftCell
            {
                get
                {
                    var paneNode = TopNode.ParentNode.SelectSingleNode(_paneNodePath, NameSpaceManager) as XmlElement;
                    if (paneNode != null &amp;amp;&amp;amp; paneNode.HasAttribute("topLeftCell")) return paneNode.GetAttribute("topLeftCell");
                }

                set
                {                    
                    var paneNode = TopNode.ParentNode.SelectSingleNode(_paneNodePath, NameSpaceManager) as XmlElement;
                    if (paneNode != null &amp;amp;&amp;amp; !string.IsNullOrEmpty(value)) paneNode.SetAttribute("topLeftCell", value);
                }
            }&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;         var pck = new ExcelPackage(new FileInfo(@"c:\temp\test.xlsx"));
            var ws = pck.Workbook.Worksheets.Add("Sample1");            
            ws.Cells["A1"].Value = "Sample 1";
            ws.Cells["A1"].Style.Font.Bold = true;
            ws.View.FreezePanes(2, 1);
            ws.View.Panes[0].TopLeftCell = "A30";
            pck.Save();&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="jsa4000" When="14/07/2015 07:10:49">
          <Html>
        &lt;div class="markDownOutput "&gt;Thanks for your help! &lt;br&gt;
It works like a charm. &lt;br&gt;
Regards, &lt;br&gt;
Javier&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Need to confirm if certain features are available in EPPlus">
      <Posts>
        <Post From="TejasSutar" When="06/07/2015 11:22:22">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi readers,&lt;br&gt;
&lt;br&gt;
I just want to know if EPPlus provides following features or not:&lt;br&gt;
&lt;br&gt;
1) Styling in word and excel documents (e.g. changing font, colors etc.).&lt;br&gt;
2) Page number insertion after page break in word document.&lt;br&gt;
3) Creating hyperlinks, paragraphs and table of contents in word document.&lt;br&gt;
&lt;br&gt;
If you have any useful resources or code snippets, please share.&lt;br&gt;
&lt;br&gt;
One more question, does EPPlus have any limitations / characteristics in Azure environment?
&lt;br&gt;
&lt;br&gt;
Thanks.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="09/07/2015 14:53:37">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi,&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
EPPlus only handles Excel files. If you want to generate Word files please take a look at npoi project. I don't know about any limitations in Azure enviroment.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Cannot add hyperlink to ExcelShape object">
      <Posts>
        <Post From="KenHuang" When="08/07/2015 03:59:34">
          <Html>
        &lt;div class="markDownOutput "&gt;It seems currently ExcelShape object does not support hyperlink just as ExcelPicture object does.
&lt;br&gt;
&lt;br&gt;
Any plan to release a version that supports it?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Problem with using ROUND in a formula.">
      <Posts>
        <Post From="ThomasBraun66" When="10/06/2015 16:19:02">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
In one project I'm creating a total value with the following code: &lt;br&gt;
&lt;br&gt;
ws.Cells[row,8].Formula = string.Format("{0}&lt;em&gt;{1}&lt;/em&gt;{2}", new ExcelAddress(row,5,row,5), new ExcelAddress(row,6,row,6), new ExcelAddress(row,7,row,7));
&lt;br&gt;
&lt;br&gt;
Now I wanted to round the result to 2 decimals and changed the template to: &lt;br&gt;
&lt;br&gt;
string.Format("ROUND({0}&lt;em&gt;{1}&lt;/em&gt;{2};2)".... &lt;br&gt;
&lt;br&gt;
But when I open the resulting Excel file with Excel, it throws an error message...&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="12/06/2015 20:31:02">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, use comma instead of semicolon.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="ThomasBraun66" When="06/07/2015 13:08:58">
          <Html>
        &lt;div class="markDownOutput "&gt;&lt;strong&gt;swmal wrote:&lt;/strong&gt;&lt;br&gt;
&lt;blockquote&gt;Hi, use comma instead of semicolon.&lt;br&gt;
&lt;/blockquote&gt;
Works like a charm... thank you very much!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="EPPlus error with ajax request">
      <Posts>
        <Post From="ddepuemd" When="30/06/2015 11:52:15">
          <Html>
        &lt;div class="markDownOutput "&gt;
&lt;pre&gt;&lt;code&gt;I cannot seem to get the download to work - I keep getting garbage.  Here is my code:
public void DumpExcel(DataTable dt, string fileName)
        {
            using (ExcelPackage pck = new ExcelPackage())
            {
                Response.Clear();
                ExcelWorksheet ws = pck.Workbook.Worksheets.Add(fileName);
                ws.Cells["A1"].LoadFromDataTable(dt, true);
                Response.ContentType = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";
                Byte[] bytes = pck.GetAsByteArray();
                Response.AddHeader("content-disposition","attachment;filename=" + fileName + ".xlsx");
                Response.BinaryWrite(bytes);
                Response.End();
            }
        }&lt;/code&gt;&lt;/pre&gt;
But I get illegal characters in the response. I want to show a screen shot of the result but cannot insert a picture here. Please help!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="akronite" When="30/06/2015 12:05:46">
          <Html>
        
&lt;div dir="ltr"&gt;You could always upload the screenshot to &lt;a href="http://imgur.com/" rel="nofollow"&gt;
http://imgur.com/&lt;/a&gt; and linking it here.&lt;/div&gt;
&lt;br&gt;
&lt;div&gt;
&lt;div dir="ltr"&gt;&lt;/div&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="ddepuemd" When="30/06/2015 13:47:06">
          <Html>
        &lt;div class="markDownOutput "&gt;Does this work? &lt;br&gt;
&lt;br&gt;
&lt;a href="http://imgur.com/gallery/hpSN9Ow" rel="nofollow"&gt;http://imgur.com/gallery/hpSN9Ow&lt;/a&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="akronite" When="01/07/2015 08:48:56">
          <Html>
        
&lt;div dir="ltr"&gt;You're requesting it via AJAX?&lt;br&gt;
&lt;br&gt;
&lt;div&gt;Try doing it via a normal form post or redirect...&lt;/div&gt;
&lt;div&gt;It looks like AJAX is writing the byte[] down to text...&lt;/div&gt;
&lt;/div&gt;
&lt;br&gt;
&lt;div&gt;
&lt;div dir="ltr"&gt;&lt;/div&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="ExcelPackage Save erro">
      <Posts>
        <Post From="IsraelNicacio" When="24/06/2015 22:43:23">
          <Html>
        &lt;div class="markDownOutput "&gt;I'm reading an Excel Worksheet with three first two are only for data that'm feeding the third and last and PivotTable. Except when it does not occur except saying it was not possible to save.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Determine if a workbook contains a Chartsheet">
      <Posts>
        <Post From="chriscahill" When="23/06/2015 23:36:43">
          <Html>
        &lt;div class="markDownOutput "&gt;When I try to open a workbook that contains a Chartsheet an exception is thrown.
&lt;br&gt;
&lt;br&gt;
Is there a way to test for the existence of a Chartsheet in a workbook?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Add values in open workbook">
      <Posts>
        <Post From="RevitArkitek" When="22/06/2015 13:40:18">
          <Html>
        &lt;div class="markDownOutput "&gt;The Microsoft.Office.Interop.Excel interface allows you to add values in an open workbook so that the user can see them populate into the Excel. Can this be done with EPPlus? I've tried unsuccessfully to emulate code that works with Interop.Excel. It seems
 that EPPlus prefers the workbook to be "closed" in Windows and saved before it can be opened. Thanks.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How can I assign worksheet properties in a helper function?">
      <Posts>
        <Post From="Rubix_Revenge" When="22/06/2015 02:32:26">
          <Html>
        &lt;div class="markDownOutput "&gt;To provide more context, I am using EPPlus in an MVC ActionResult to export a model to an Excel file. If I simply want to export my model to an Excel file in my ActionResult, I have that worked out. I learned to assign values to the workbook properties
 and cell formatting and the exported Excel file appears correctly.&lt;br&gt;
&lt;br&gt;
My problem is that all that code exists within the ActionResult block. I would like to move out the code that assigns property values to a separate function. The problem I encounter is the null reference error. Below is the paste of the full ActionResult block
 to provide full context and in case it suggests any secondary issues I hadn't considered.&lt;br&gt;
&lt;br&gt;
I tried creating a function in the controller private &lt;strong&gt;&lt;em&gt;ExcelPackage AssignWorkbookProperties(ExcelPackage ep, string exportName)&lt;/em&gt;&lt;/strong&gt;, and while I had no compile time errors, there was a null argument exception. Essentially, the function
 either received nothing or returned nothing.&lt;br&gt;
&lt;br&gt;
Is there some way I can move the blocked code into a helper function? (I've indicated with comment blocks in the code shown here).&lt;br&gt;
&lt;pre&gt;&lt;code&gt;public ActionResult ExportToExcel()
        {
            string exportName = "FourCourseAudit";
            
            // This allows me to export only the columns I want.
            var exportQuery = query.Select(t =&amp;gt; new { t.Campus, t.Student_Name, t.Course_Count });
            
            // epp is the model where I gather the predefined property values
            var epp = new ExportToExcelProperties();
            var prop = epp.WorkbookProperties.Where(t =&amp;gt; t.ExportName == exportName);
                                    
            try
            {                                
                byte[] response;                
                using (var excelFile = new ExcelPackage())
                {   
                    // Define worksheet data.
                    var worksheet = excelFile.Workbook.Worksheets.Add("Sheet1");                    

                    /* ------------------------------------------------------------------ */
                    /* -------------Begin: Move to helper function ---------------------- */
                    /* ------------------------------------------------------------------ */

                    // Define workbook properties.
                    var workbookProperties = excelFile.Workbook.Properties;

                    workbookProperties.Author = HttpContext.User.Identity.Name;
                    workbookProperties.Title = prop.Select(t =&amp;gt; t.Title).ToString();
                    workbookProperties.Comments = prop.Select(t =&amp;gt; t.Comments).ToString();
                    workbookProperties.Created = DateTime.Now;
                    workbookProperties.Category = prop.Select(t =&amp;gt; t.Category).ToString();

                
                    // Define worksheet contextual data.
                    worksheet.Cells["A1"].Value = "Title: ";
                    worksheet.Cells["A2"].Value = "Export Date: ";

                    worksheet.Cells["A1:A2"].Style.Font.Bold = true;

                    worksheet.Cells["B1"].Value = prop.Select(t =&amp;gt; t.Title).ToString();
                    worksheet.Cells["B2"].Value = DateTime.Now;
                    worksheet.Cells["B2"].Style.Numberformat.Format = "mm/dd/yyyy hh:mm";

                    worksheet.Cells["A1:B2"].Style.Border.BorderAround(OfficeOpenXml.Style.ExcelBorderStyle.Medium);
                    worksheet.Cells["A1:B2"].AutoFitColumns();

                    Color bgColor = ColorTranslator.FromHtml("&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/2956"&gt;#2956&lt;/a&gt;B2");

                    worksheet.Cells["A1:B2"].Style.Fill.PatternType = ExcelFillStyle.Solid;
                    worksheet.Cells["A1:B2"].Style.Fill.BackgroundColor.SetColor(bgColor);
                    worksheet.Cells["A1:B2"].Style.Font.Color.SetColor(Color.White);

                    worksheet.Cells["D1:F1"].Style.Fill.PatternType = ExcelFillStyle.Solid;
                    worksheet.Cells["D1:F1"].Style.Fill.BackgroundColor.SetColor(bgColor);
                    worksheet.Cells["D1:F1"].Style.Font.Color.SetColor(Color.White);

                    /* ------------------------------------------------------------------ */
                    /* ---------------End: Move to helper function ---------------------- */
                    /* ------------------------------------------------------------------ */

                    worksheet
                        .Cells["D1"]
                        .LoadFromCollection(Collection: exportQuery, PrintHeaders: true)                        
                        .Style.Border.BorderAround(OfficeOpenXml.Style.ExcelBorderStyle.Thin);
                    
                    worksheet.Cells["A1:F200"].AutoFitColumns();

                    response = excelFile.GetAsByteArray();
                }
                return File(response, "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet", "Export.xlsx");
            }
            catch (NullReferenceException) {
                return ViewBag.Errormsg = "There was a null reference exception.";
            }
            catch (ArgumentNullException)
            {
                return ViewBag.Errormsg = "There was an argument null exception.";
            }
        }
    }&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Rubix_Revenge" When="22/06/2015 03:36:15">
          <Html>
        &lt;div class="markDownOutput "&gt;I figured it out. &lt;br&gt;
&lt;br&gt;
I found a &lt;a href='http://zeeshanumardotnet.blogspot.com/2011/06/creating-reports-in-excel-2007-using.html"' rel="nofollow"&gt;
resource&lt;/a&gt; that helped me figure out the problem. &lt;br&gt;
&lt;br&gt;
The problem was that my function was returning and accepting the wrong object. &lt;br&gt;
&lt;br&gt;
I created two different functions. The first function returns type &lt;code&gt;ExcelWorksheet&lt;/code&gt; and the second function returns type
&lt;code&gt;OfficeProperties&lt;/code&gt;. Both functions have &lt;code&gt;ExcelPackage&lt;/code&gt; as an input parameter.
&lt;br&gt;
&lt;br&gt;
So first, this is how clean the ActionResult is now:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;    public ActionResult ExportToExcel()
    {
        string exportName = "FourCourseAudit";

        // This allows me to export only the columns I want.
        var exportQuery = query.Select(t =&amp;gt; new { t.Campus, t.Student_Name, t.Course_Count });          

        try
        {                                
            byte[] response;                
            using (var excelFile = new ExcelPackage())
            {   
                // Use helper functions to fill worksheet and workbook definitions
                var worksheet = CreateSheet(excelFile,exportName);
                var workbook = AssignProperties(excelFile,exportName);

                // Fill worksheet with data to export
                worksheet
                    .Cells["D1"]
                    .LoadFromCollection(Collection: exportQuery, PrintHeaders: true)                        
                    .Style.Border.BorderAround(OfficeOpenXml.Style.ExcelBorderStyle.Thin);

                worksheet.Cells["A1:F200"].AutoFitColumns();

                response = excelFile.GetAsByteArray();
            }
            return File(response, "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet", "Export.xlsx");
        }
        catch (NullReferenceException) {
            return ViewBag.Errormsg = "There was a null reference exception.";
        }
        catch (ArgumentNullException)
        {
            return ViewBag.Errormsg = "There was an argument null exception.";
        }
    }
&lt;/code&gt;&lt;/pre&gt;
For now, these two functions are in the same controller. The more I work out how to generalize them, I might move them elsewhere.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;    private static ExcelWorksheet CreateSheet(ExcelPackage p,string exportName)
    {
        var epp = new ExportToExcelProperties().WorkbookProperties;
        var prop = epp.Where(t =&amp;gt; t.ExportName == "FourCourseAudit").Select(t=&amp;gt;t.Title).Single();

        string sheetName = "Sheet1";
        p.Workbook.Worksheets.Add(sheetName);
        ExcelWorksheet worksheet = p.Workbook.Worksheets[1];
        worksheet.Name = sheetName; //Setting Sheet's name
        worksheet.Cells.Style.Font.Size = 11; //Default font size for whole sheet
        worksheet.Cells.Style.Font.Name = "Calibri"; //Default Font name for whole sheet

        // Define worksheet contextual data.
        worksheet.Cells["A1"].Value = "Title: ";
        worksheet.Cells["A2"].Value = "Export Date: ";

        worksheet.Cells["A1:A2"].Style.Font.Bold = true;

        worksheet.Cells["B1"].Value = prop;
        worksheet.Cells["B2"].Value = DateTime.Now;
        worksheet.Cells["B2"].Style.Numberformat.Format = "mm/dd/yyyy hh:mm";

        worksheet.Cells["A1:B2"].Style.Border.BorderAround(OfficeOpenXml.Style.ExcelBorderStyle.Medium);
        worksheet.Cells["A1:B2"].AutoFitColumns();

        Color bgColor = ColorTranslator.FromHtml("&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/2956"&gt;#2956&lt;/a&gt;B2");

        worksheet.Cells["A1:B2"].Style.Fill.PatternType = ExcelFillStyle.Solid;
        worksheet.Cells["A1:B2"].Style.Fill.BackgroundColor.SetColor(bgColor);
        worksheet.Cells["A1:B2"].Style.Font.Color.SetColor(Color.White);

        worksheet.Cells["D1:F1"].Style.Fill.PatternType = ExcelFillStyle.Solid;
        worksheet.Cells["D1:F1"].Style.Fill.BackgroundColor.SetColor(bgColor);
        worksheet.Cells["D1:F1"].Style.Font.Color.SetColor(Color.White);

        return worksheet;
    }

    private static OfficeProperties AssignProperties(ExcelPackage p, string exportName)
    {
        // epp is the model where I gather the predefined property values
        var epp = new ExportToExcelProperties().WorkbookProperties;
        var query = from t in epp
                    where t.ExportName == exportName
                    select new { t.Title, t.Comments, t.Category };
        var title = query.Select(t=&amp;gt;t.Title).Single();
        var comments = query.Select(t=&amp;gt;t.Comments).Single();
        var category = query.Select(t=&amp;gt;t.Category).Single();

        OfficeProperties workbookProperties = p.Workbook.Properties;
        workbookProperties.Author = System.Web.HttpContext.Current.User.Identity.Name;
        workbookProperties.Title = title;
        workbookProperties.Comments = comments;
        workbookProperties.Created = DateTime.Now;
        workbookProperties.Category = category;

        return workbookProperties;
    }
&lt;/code&gt;&lt;/pre&gt;
This directly answers the question of how I can move the worksheet property code outside of the ActionResult, but I can clearly see there can be more done to generalize the code and make it more modular.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Horizonalalignment not working in LibreOffice calc">
      <Posts>
        <Post From="EAM9" When="18/06/2015 14:31:11">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
I know that the EPPlus library only supports Excel specific releases but I just wanted to let you know that there is an issue with LibreOffice calc. Also, even though it's not supported, is this something that might be looked into?
&lt;br&gt;
&lt;br&gt;
Thanks for any input.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="want to check excel sheet contains formula or not? IS it possible in Eppplus code?">
      <Posts>
        <Post From="kaku2050" When="12/06/2015 11:26:23">
          <Html>
        &lt;div class="markDownOutput "&gt;I want to check excel sheet contains formula or not? IS it possible in Eppplus code?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="[4.0.3] Can I copy ranges using &quot;Paste Special&quot;-like options?">
      <Posts>
        <Post From="sudrahnreb" When="18/02/2015 13:58:51">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
Is it possible to copy a range from one worksheet to another the way "Paste Special" does, out of the box?
&lt;br&gt;
ExcelRangeBase.Copy copies everything. If you want to copy only values or formats that does not help.
&lt;br&gt;
&lt;br&gt;
Regards&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="vzdesic" When="10/06/2015 14:33:36">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi,&lt;br&gt;
&lt;br&gt;
Did you find a solution?&lt;br&gt;
&lt;br&gt;
I also want to 'Paste Special' my HTML text as Unicode text, so that it is recogniized as HTML in excel file.&lt;br&gt;
Any help from anyone will be more than welcome!&lt;br&gt;
&lt;br&gt;
Thanks!&lt;br&gt;
Vedran&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="sudrahnreb" When="12/06/2015 10:41:12">
          <Html>
        &lt;div class="markDownOutput "&gt;Well, yes and no. &lt;br&gt;
&lt;br&gt;
I added/changed some code in the &lt;em&gt;ExcelRangeBase.cs&lt;/em&gt; file, but it's kind of a first shot and I did not really test it yet.
&lt;br&gt;
&lt;br&gt;
The main idea is to extend the &lt;em&gt;ExcelRangeBase.Copy&lt;/em&gt; method with an optional second parameter. This second parameter is of the new enumeration type
&lt;em&gt;ExcelPasteSpecialFlags&lt;/em&gt; and depending on the flags set (default: All, tested with new private method _&lt;em&gt;IsSet()&lt;/em&gt;) some things are copied while others are not. So this is not a PasteSpecial method but rather a CopySpecial.
&lt;br&gt;
&lt;br&gt;
I enclose the code here (hasn't there been a file upload option?). Feel free to use and/or change it. Would be nice to hear if it works as expected or what has to be changed.
&lt;br&gt;
&lt;br&gt;
Maybe the developers could take a look on it, too? &lt;br&gt;
&lt;br&gt;
Regards&lt;br&gt;
&lt;pre&gt;&lt;code&gt;[Flags]
public enum ExcelPasteSpecialFlags : ushort
{
    None = 0,
    Formulas = 1, Values = 2, Formats = 4, Comments = 8, Validation = 16, // Excel
    Hyperlinks = 32, Flags = 64,    // EPP
    AllUsingSourceTheme = 128, AllExceptBorders = 256, ColumnWidths = 512,  // Excel
    FormulasAndNumberFormats = 1025, // Excel, include formulas as well (1024 + 1)
    ValuesAndNumberFormats = 2050, // Excel, include values as well (2048 + 2)
    AllMergingConditionalFormats = 4096,    // Excel, ?
    All = 65535
}

public class ExcelRangeBase : ExcelAddress, IExcelCell, IDisposable, IEnumerable&amp;lt;ExcelRangeBase&amp;gt;, IEnumerator&amp;lt;ExcelRangeBase&amp;gt;
{
    /*
        code intentionally removed
    */
    
    private bool _IsSet(ExcelPasteSpecialFlags flags, ExcelPasteSpecialFlags flag)
    {
        return (flags &amp;amp; flag) &amp;gt; 0;
    }

    public void Copy(ExcelRangeBase Destination, ExcelPasteSpecialFlags pasteFlag = ExcelPasteSpecialFlags.All)
    {
            bool sameWorkbook = Destination._worksheet.Workbook == _worksheet.Workbook;
            ExcelStyles sourceStyles = _worksheet.Workbook.Styles,
                                    styles = Destination._worksheet.Workbook.Styles;
            Dictionary&amp;lt;int, int&amp;gt; styleCashe = new Dictionary&amp;lt;int, int&amp;gt;();

            //Delete all existing cells; 
            int toRow = _toRow - _fromRow + 1,
                    toCol = _toCol - _fromCol + 1;

            string s = "";
            int i=0;
            object o = null;
            byte flag=0;
            Uri hl = null;
            ExcelComment comment=null;

            var cse = new CellsStoreEnumerator&amp;lt;object&amp;gt;(_worksheet._values, _fromRow, _fromCol, _toRow, _toCol);
            var copiedValue = new List&amp;lt;CopiedCell&amp;gt;();
            while (cse.Next())
            {
                    var row=cse.Row;
                    var col = cse.Column;       //Issue 15070
                    var cell = new CopiedCell
                    {
                            Row = Destination._fromRow + (row - _fromRow),
                            Column = Destination._fromCol + (col - _fromCol),
                            Value = _IsSet(pasteFlag, ExcelPasteSpecialFlags.Values) ? cse.Value : null
                    };

                    //Destination._worksheet._values.SetValue(row, col, cse.Value);

                    if ((_IsSet(pasteFlag, ExcelPasteSpecialFlags.Values) || _IsSet(pasteFlag, ExcelPasteSpecialFlags.Formulas))
                        &amp;amp;&amp;amp; _worksheet._types.Exists(row, col, ref s))
                    {
                            //Destination._worksheet._types.SetValue(row, col,s);
                            cell.Type=s;
                    }

                    if (_IsSet(pasteFlag, ExcelPasteSpecialFlags.Formulas) 
                        &amp;amp;&amp;amp; _worksheet._formulas.Exists(row, col, ref o))
                    {
                            if (o is int)
                            {
                                 // Destination._worksheet._formulas.SetValue(row, col, _worksheet.GetFormula(cse.Row, cse.Column));    //Shared formulas, set the formula per cell to simplify
                                    cell.Formula=_worksheet.GetFormula(cse.Row, cse.Column);
                            }
                            else
                            {
                                    //Destination._worksheet._formulas.SetValue(row, col, o);
                                    cell.Formula=o;
                            }
                    }

                    if ((_IsSet(pasteFlag, ExcelPasteSpecialFlags.Formats))
                        &amp;amp;&amp;amp; _worksheet._styles.Exists(row, col, ref i))
                    {
                            if (sameWorkbook)
                            {
                                    //Destination._worksheet._styles.SetValue(row, col, i);
                                    cell.StyleID=i;
                            }
                            else
                            {
                                    if (styleCashe.ContainsKey(i))
                                    {
                                            i = styleCashe[i];
                                    }
                                    else
                                    {
                                            var oldStyleID = i;
                                            i = styles.CloneStyle(sourceStyles, i);
                                            styleCashe.Add(oldStyleID, i);
                                    }
                                    //Destination._worksheet._styles.SetValue(row, col, i);
                                    cell.StyleID=i;
                            }
                    }

                    if (_IsSet(pasteFlag, ExcelPasteSpecialFlags.Hyperlinks)
                        &amp;amp;&amp;amp; _worksheet._hyperLinks.Exists(row, col, ref hl))
                    {
                            //Destination._worksheet._hyperLinks.SetValue(row, col, hl);
                            cell.HyperLink=hl;
                    }

                    if (_IsSet(pasteFlag, ExcelPasteSpecialFlags.Comments)
                        &amp;amp;&amp;amp; _worksheet._commentsStore.Exists(row, col, ref comment))
                    {
                            cell.Comment=comment;
                    }

                    if (_IsSet(pasteFlag, ExcelPasteSpecialFlags.Flags)
                        &amp;amp;&amp;amp; _worksheet._flags.Exists(row, col, ref flag))
                    {
                            cell.Flag = flag;
                    }
                    copiedValue.Add(cell);
            }

            //Copy styles with no cell value
            var cses = new CellsStoreEnumerator&amp;lt;int&amp;gt;(_worksheet._styles, _fromRow, _fromCol, _toRow, _toCol);
            while (cses.Next())
            {
                    if (!_worksheet._values.Exists(cses.Row, cses.Column))
                    {
                            var row = Destination._fromRow + (cses.Row - _fromRow);
                            var col = Destination._fromCol + (cses.Column - _fromCol);
                            var cell = new CopiedCell
                            {
                                    Row = row,
                                    Column = col,
                                    Value = null
                            };

                            if (_IsSet(pasteFlag, ExcelPasteSpecialFlags.Formats)) {
                                i = cses.Value;
                                if (sameWorkbook) {
                                    cell.StyleID = i;
                                }
                                else {
                                    if (styleCashe.ContainsKey(i)) {
                                        i = styleCashe[i];
                                    }
                                    else {
                                        var oldStyleID = i;
                                        i = styles.CloneStyle(sourceStyles, i);
                                        styleCashe.Add(oldStyleID, i);
                                    }
                                    //Destination._worksheet._styles.SetValue(row, col, i);
                                    cell.StyleID = i;
                                }
                            }
                            copiedValue.Add(cell);
                    }
            }
            var copiedMergedCells = new Dictionary&amp;lt;int, ExcelAddress&amp;gt;();
            //Merged cells
            var csem = new CellsStoreEnumerator&amp;lt;int&amp;gt;(_worksheet.MergedCells._cells, _fromRow, _fromCol, _toRow, _toCol);
            while (csem.Next())
            {
                    if(!copiedMergedCells.ContainsKey(csem.Value))
                    {
                            var adr = new ExcelAddress(_worksheet.Name, _worksheet.MergedCells.List[csem.Value]);
                            if(this.Collide(adr)==eAddressCollition.Inside)
                            {                        
                                    copiedMergedCells.Add(csem.Value, new ExcelAddress(
                                            Destination._fromRow + (adr.Start.Row - _fromRow),
                                            Destination._fromCol + (adr.Start.Column - _fromCol),
                                            Destination._toRow + (adr.End.Row - _fromRow),
                                            Destination._toCol + (adr.End.Column - _fromCol)));
                            }
                            else
                            {
                                    //Partial merge of the address ignore.
                                    copiedMergedCells.Add(csem.Value, null);
                            }
                    }
            }

            Destination._worksheet.MergedCells.Delete(new ExcelAddressBase(Destination._fromRow, Destination._fromCol, Destination._fromRow+toRow, Destination._fromCol+toCol));

            if (_IsSet(pasteFlag, ExcelPasteSpecialFlags.Values)) 
                Destination._worksheet._values.Clear(Destination._fromRow, Destination._fromCol, toRow, toCol);
            if (_IsSet(pasteFlag, ExcelPasteSpecialFlags.Formulas))
                Destination._worksheet._formulas.Clear(Destination._fromRow, Destination._fromCol, toRow, toCol);
            if (_IsSet(pasteFlag, ExcelPasteSpecialFlags.Formats))
                Destination._worksheet._styles.Clear(Destination._fromRow, Destination._fromCol, toRow, toCol);
            if (_IsSet(pasteFlag, ExcelPasteSpecialFlags.Values) || _IsSet(pasteFlag, ExcelPasteSpecialFlags.Formulas))
                Destination._worksheet._types.Clear(Destination._fromRow, Destination._fromCol, toRow, toCol);
            if (_IsSet(pasteFlag, ExcelPasteSpecialFlags.Hyperlinks))
                Destination._worksheet._hyperLinks.Clear(Destination._fromRow, Destination._fromCol, toRow, toCol);
            if (_IsSet(pasteFlag, ExcelPasteSpecialFlags.Flags))
                Destination._worksheet._flags.Clear(Destination._fromRow, Destination._fromCol, toRow, toCol);
            if (_IsSet(pasteFlag, ExcelPasteSpecialFlags.Comments))
                Destination._worksheet._commentsStore.Clear(Destination._fromRow, Destination._fromCol, toRow, toCol);
         
            foreach(var cell in copiedValue)
            {
                if (_IsSet(pasteFlag, ExcelPasteSpecialFlags.Values))
                    Destination._worksheet._values.SetValue(cell.Row, cell.Column, cell.Value);

                if (_IsSet(pasteFlag, ExcelPasteSpecialFlags.Values) || _IsSet(pasteFlag, ExcelPasteSpecialFlags.Formulas))
                    if (cell.Type != null)
                    {
                            Destination._worksheet._types.SetValue(cell.Row, cell.Column, cell.Type);
                    }

                if (_IsSet(pasteFlag, ExcelPasteSpecialFlags.Formats))
                    if (cell.StyleID != null)
                    {
                            Destination._worksheet._styles.SetValue(cell.Row, cell.Column, cell.StyleID.Value);
                    }

                if (_IsSet(pasteFlag, ExcelPasteSpecialFlags.Formulas))
                    if (cell.Formula != null)
                    {
                            cell.Formula = UpdateFormulaReferences(cell.Formula.ToString(), Destination._fromRow - _fromRow, Destination._fromCol - _fromCol, 0, 0, true);
                            Destination._worksheet._formulas.SetValue(cell.Row, cell.Column, cell.Formula);
                    }

                if (_IsSet(pasteFlag, ExcelPasteSpecialFlags.Hyperlinks))
                    if (cell.HyperLink != null)
                    {
                            Destination._worksheet._hyperLinks.SetValue(cell.Row, cell.Column, cell.HyperLink);
                    }

                if (_IsSet(pasteFlag, ExcelPasteSpecialFlags.Comments))
                    if (cell.Comment != null)
                    {
                            //Destination._worksheet._commentsStore.SetValue(cell.Row, cell.Column, cell.Comment);
                    }

                if (_IsSet(pasteFlag, ExcelPasteSpecialFlags.Flags))
                    if (cell.Flag != null) {
                        Destination._worksheet._flags.SetValue(cell.Row, cell.Column, cell.Flag);
                    }
            }

            //Add merged cells
            foreach(var m in copiedMergedCells.Values)
            {
                    if(m!=null)
                    {
                            Destination._worksheet.MergedCells.Add(m, true);
                    }
            }
    }
    /*
        code intentionally removed
    */
}&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Printer settings doesn't work">
      <Posts>
        <Post From="pdavis68" When="11/06/2015 17:16:23">
          <Html>
        &lt;div class="markDownOutput "&gt;I have the following function:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;    private void SetDetailPrintSettings(Excel.ExcelWorksheet sheet, int rows)
    {
        sheet.PrinterSettings.Orientation = Excel.eOrientation.Landscape;
        sheet.PrinterSettings.Scale = 46;
        sheet.PrinterSettings.PrintArea = sheet.Cells[1, 1, rows, 22];
        sheet.PrinterSettings.FitToPage = true;
        sheet.PrinterSettings.FitToWidth = 0;
    }

&lt;/code&gt;&lt;/pre&gt;
I call it for each sheet in my spreadsheet. It doesn't seem to be doing anything. How do I set the printer settings? To elaborate, most obviously, it doesn't set the sheet as landscape, it doesn't set the scale, it doesn't set the print area, etc.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="pdavis68" When="11/06/2015 17:21:48">
          <Html>
        &lt;div class="markDownOutput "&gt;Nevermind. Works just fine. As soon as I posted this, I was reviewing the code some more and realized it was the function calling this that had the problem. It was passing the wrong sheet in.
&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Adding Listvalidation to Excel">
      <Posts>
        <Post From="Karthi89msc" When="09/12/2014 19:16:02">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi all , &lt;br&gt;
&lt;br&gt;
I was trying to do list validation using EPP plus. I tried the way be specifying formula as cell address.What happens is for each cell the list value decreases by a count.
&lt;br&gt;
&lt;br&gt;
EX the list has 1,2,3 &lt;br&gt;
&lt;br&gt;
First cell drop down 3 values ie . 1,2,3 .Second cell has only 2,3. and third cell only 3. I was able to replicate the same using the sample code by changing the "AddListValidation" to range ("A1:A4") . Thanks in advance.&lt;br&gt;
&lt;h1&gt;&lt;/h1&gt;
&lt;pre&gt;&lt;code&gt;private static void AddListValidationFormula(ExcelPackage package)
    {
        var sheet = package.Workbook.Worksheets.Add("list formula");
        sheet.Cells["B1"].Style.Font.Bold = true;
        sheet.Cells["B1"].Value = "Source values";
        sheet.Cells["B2"].Value = 1;
        sheet.Cells["B3"].Value = 2;
        sheet.Cells["B4"].Value = 3;

        // add a validation and set values
        var validation = sheet.DataValidations.AddListValidation("A1:A5");
        // Alternatively:
        // var validation = sheet.Cells["A1"].DataValidation.AddListDataValidation();
        validation.ShowErrorMessage = true;
        validation.ErrorStyle = ExcelDataValidationWarningStyle.warning;
        validation.ErrorTitle = "An invalid value was entered";
        validation.Error = "Select a value from the list";
        validation.Formula.ExcelFormula = "B2:B4";

        Console.WriteLine("Added sheet for list validation with formula");

    }&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mxolisiZondi" When="08/06/2015 13:16:26">
          <Html>
        &lt;div class="markDownOutput "&gt;Months later, no solution :(( &lt;br&gt;
ended up doing this:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;        validation.Formula.Values.Add(sheet.Cells["B2"].Value.ToString());
        validation.Formula.Values.Add(sheet.Cells["B3"].Value.ToString());
        validation.Formula.Values.Add(sheet.Cells["B4"].Value.ToString());&lt;/code&gt;&lt;/pre&gt;
i used a loop obviously in case i want to add a lot of items into the list&lt;br&gt;
&lt;pre&gt;&lt;code&gt;        var range = sheet.Cells["B2:B4"];

        for (int i = 0; i &amp;lt; range.Count(); i++)
        {
            validation.Formula.Values.Add(sheet.Cells["B"+(i+2).ToString()].Value.ToString());
        }&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="ThomasBraun66" When="10/06/2015 10:56:59">
          <Html>
        &lt;div class="markDownOutput "&gt;I can see two possible solutions: &lt;br&gt;
&lt;br&gt;
A) use absolute cell addresses: &lt;br&gt;
&lt;br&gt;
validation.Formula.ExcelFormula = "$B$2:$B$4"; &lt;br&gt;
&lt;br&gt;
B) use a named range: &lt;br&gt;
&lt;br&gt;
sheet.Names.Add("SourceValues", ws.Cells["B2:B4"]); &lt;br&gt;
.... &lt;br&gt;
validation.Formula.ExcelFormula = "=SourceValues";&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Working with merged cells">
      <Posts>
        <Post From="ghendric" When="08/06/2015 14:58:46">
          <Html>
        &lt;div class="markDownOutput "&gt;Are there any examples of how to list a collection of data down a spreadsheet using a custom template where you would want to show something like invoice data where the middle column is a merged column of 5 columns for example and the right most column
 is an extended amount? The LoadFromCollection method just puts data in at the starting column you give it but doesn't work correctly with a merged column. Any help is greatly appreciated.
&lt;br&gt;
&lt;br&gt;
Thanks, &lt;br&gt;
George&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="pdavis68" When="09/06/2015 19:26:08">
          <Html>
        &lt;div class="markDownOutput "&gt;Merging is as simple as selecting the range you want to merge and setting the Merge property to true. Example:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;var range = sheet.Cells[1, 2, 1, 5];
range.Merge = true;
&lt;/code&gt;&lt;/pre&gt;
where sheet is an ExcelWorksheet.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="ExcelPackage.GetAsByteArray() throws exception">
      <Posts>
        <Post From="pdavis68" When="09/06/2015 19:22:19">
          <Html>
        &lt;div class="markDownOutput "&gt;My code is a follows:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;using (Stream stream = File.OpenRead(@"C:\temp\myfile.xls"))
{
    using (Excel.ExcelPackage package = new Excel.ExcelPackage(stream))
    using (Excel.ExcelWorkbook wb = package.Workbook)
    {
        for (int index = 1; index &amp;lt; wb.Worksheets.Count; index++)
        {
            using (Excel.ExcelWorksheet ws = wb.Worksheets[index])
            {
                Excel.ExcelPrinterSettings prs = ws.PrinterSettings;
                prs.Orientation = Excel.eOrientation.Landscape;
                prs.Scale = 83;
            }
        }
        byte[] data = package.GetAsByteArray();
&lt;/code&gt;&lt;/pre&gt;
I get a NullReferenceException on the last line there. I initially had a ExcelPackage.SaveAs() call, which did the same thing. package, of course, isn't null, if it were, it would have died in the third using.&lt;br&gt;
&lt;br&gt;
I basically want to take an existing Excel file, set it for Landscape and scale it to 83%, so anything that accomplishes that will work for me.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Why is ExcelRangeBase IDisposable?">
      <Posts>
        <Post From="JocularJoe" When="23/02/2012 08:32:29">
          <Html>
        
&lt;p&gt;ExcelRangeBase is IDisposable, and some (but by no means all) samples use the `using` statement to dispose it.&lt;/p&gt;
&lt;p&gt;However from what I can see, Dispose doesn't do anything.&lt;/p&gt;
&lt;p&gt;Why is it IDisposable?&amp;nbsp; Should all acceses to an ExcelRangeBase be wrapped in a using statement?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Telliax" When="04/06/2015 07:55:14">
          <Html>
        &lt;div class="markDownOutput "&gt;I am curious as well. Looks like a really weird design decision. What Dispose method is supposed to dispose when it comes to collection of cells?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="DateTime">
      <Posts>
        <Post From="delly47" When="22/05/2015 22:40:34">
          <Html>
        &lt;div class="markDownOutput "&gt;I'm trying to set a Date to a cell but the client says it MUST be a date value and must not include time. C# doesnt have separate date and time data types so when i set the value of the cell to a datetime, the time is still in the value even though the
 custom formatting doesnt display time, so when they import it fails. &lt;br&gt;
running out of ideas, I've tried strings, datetime, OADates, might have to resort to pasting&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="delly47" When="25/05/2015 18:07:08">
          <Html>
        &lt;div class="markDownOutput "&gt;Think I got it. All I needed to do was use midnight as the time in C# and in excel that got rid of the time. and for a column with just time, I had to use a new DateTime(1,1,1).add(dateVal.TimeofDay) to get just the time to show up in excel.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="zippy1981" When="03/06/2015 13:33:17">
          <Html>
        &lt;div class="markDownOutput "&gt;&lt;a href="https://msdn.microsoft.com/en-us/library/system.datetime.date%28v=vs.110%29.aspx" rel="nofollow"&gt;`DateTime.Date will also do this.&lt;/a&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Banded rows">
      <Posts>
        <Post From="Nef_Nj0y" When="28/05/2015 09:25:58">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi all, &lt;br&gt;
&lt;br&gt;
Apparently no thread treats this feature. &lt;br&gt;
&lt;br&gt;
Can anyone help me to set this option please ? &lt;br&gt;
table.TableStyle enum just set header and border color. &lt;br&gt;
&lt;br&gt;
Thanks in advance.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Cells.LoadFromCollection not putting in correct dates">
      <Posts>
        <Post From="balkrishnajha" When="21/05/2015 22:34:21">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi,&lt;br&gt;
I am trying to put a collection of EmployeeBenefits in an Excel Sheet like this:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;using (var pck = new ExcelPackage())
{
var fixedBenefitQuery = from fb in fullRequest.EmployeeFixedBenefits ?? new Collection&amp;lt;EmployeeFixedBenefit&amp;gt;() orderby fb.AdoptionAgreementEffectiveFromDate ascending, fb.AdoptionAgreementSequenceNumber ascending
                                        select new 
                                        {
                                            CalculationId = calculationId,
                                            Ssn = fb.Ssn,
                                            fb.CoopNumber,
                                            fb.EmployerNumber,
                                            fb.PlanCode,
                                            fb.AdoptionAgreementEffectiveFromDate,                                            
                                            fb.AdoptionAgreementSequenceNumber,
                                            fb.AdoptionAgreementStartDate,                                            
                                            fb.FixedBenefitFormulaNumber,
                                            fb.FixedBenefitPercentage,
                                            fb.PredecessorPlanNormalFormFixedBenefitAmount,
                                            fb.RSNormalFormFixedBenefitAmount
                                            
                                        };
                var employeeFixedBenefits = fixedBenefitQuery.ToArray();
var employeeFixedBenefitWs = pck.Workbook.Worksheets.Add(WorksheetName.EmployeeFixedBenefits);
employeeFixedBenefitWs.Cells["A1"].LoadFromCollection(employeeFixedBenefits, true);
                    
}
&lt;/code&gt;&lt;/pre&gt;
The dates in AdoptionAgreementEffectiveFromDate and AdoptionAgreementStartDate is '1/1/1900 12:00:00 AM', but in Excel, I get both dates as '2'.
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
After formatting into Number-format (did not find DateTime format) as below, my Excel sheet showed a date, but this time as '01/02/1900' - which is 1 day ahead of my input date.&lt;br&gt;
&lt;pre&gt;&lt;code&gt; ws.Cells[1, head.Start.Column, ws.Cells.End.Row, head.Start.Column].Style.Numberformat.Format = "mm/dd/yyyy";&lt;/code&gt;&lt;/pre&gt;
Any suggestions on why this is happening and remedy?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="wtfinc" When="22/05/2015 14:20:53">
          <Html>
        &lt;div class="markDownOutput "&gt;It is my understanding that there are two issues affecting 01/01/1900 dates. The first is that EPPLUS returns dates as a string if a standard Date format is not used. The second is the old LOTUS 1900 Leap Year shortcut that reports an incorrect date offset
 for any dates preceding 3/1/1900. I have used the following logic to solve these two issues:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;                                    try
                                    {
                                        // For 01/01/1900, EPPLUS returns "12/31/1899 12:00:00 AM" as a string instead of the Date Offset as a Double
                                        strvalue = namedRange.Worksheet.Cells[rowIndex, 84].Value.ToString( );

                                        // Non-Standard Dates will come out as text; Standard dates will come out as Double
                                        if (strvalue.Contains("AM") || strvalue.Contains("PM"))
                                        {
                                            if (strvalue == "12/31/1899 12:00:00 AM")
                                                dtevalue = new DateTime(1900, 1, 1);
                                            else
                                                dtevalue = DateTime.Parse(strvalue);
                                        }
                                        else
                                            dtevalue = FromExcelSerialDate(double.Parse(strvalue));
                                        ....
                                    }
                                    catch (Exception ex)
                                    {
                                        .... report error;
                                    }


Here is the code for "FromExcelSerialDate"

        public static DateTime FromExcelSerialDate(double SerialDate)
        {
            if (SerialDate &amp;gt; 59)
                SerialDate -= 1;   // Excel/Lotus 2/29/1900 bug
            return new DateTime(1899, 12, 31).AddDays(SerialDate);
        }&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Uploading and reading Excel spreadsheets on Azure">
      <Posts>
        <Post From="windhoek2010" When="18/05/2015 19:35:12">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
How can I use EPPlus to upload Excel spreadsheets to Azure Storage? Is there any documentation for this? Thank you.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Work Item 14946 - reopen?">
      <Posts>
        <Post From="kslesinsky" When="13/05/2015 23:35:40">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi. I added a comment to workitem &lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/14946"&gt;14946&lt;/a&gt;. The item was closed but I'm requesting another modification. Should I create a new issue?
&lt;br&gt;
&lt;br&gt;
&lt;a href="https://epplus.codeplex.com/workitem/14946" rel="nofollow"&gt;https://epplus.codeplex.com/workitem/14946&lt;/a&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Bulk export performance tip">
      <Posts>
        <Post From="BenAmada" When="02/06/2013 01:12:50">
          <Html>
        &lt;div class="markDownOutput "&gt;In EPPlus v3.1.3, I was exporting 320K rows, 12 columns and it was very slow, about 6000 rows per minute ... using the standard Cells collection. On pace to take 54 minutes for all the rows.
&lt;br&gt;
&lt;br&gt;
While trying out some changes, I ended up with a notable breakthrough, getting all 320K rows to export in 20 seconds!
&lt;br&gt;
&lt;br&gt;
It required just one change. I had set a NumberFormat on a range of cells on just one of the columns before outputting the data. It looked roughly like this:&lt;br&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;ws.Cells[3, 1, 1048576, 1].Style.Numberformat.Format = &lt;span style="color: rgb(163, 21, 21);"&gt;"[$-409]mmm d yyyy h:mm AM/PM;@"&lt;/span&gt;;
&lt;span style="color: blue;"&gt;for&lt;/span&gt; (&lt;span style="color: blue;"&gt;int&lt;/span&gt; r = 0; r &amp;lt; items.Count; r++)
{
    ...
}
&lt;/pre&gt;
&lt;/div&gt;
The change was moving the Numberformat below the FOR loop. Apparently the Numberformat must have been getting re-applied or re-evaluated each time data was being output into a cell in the column &lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/1"&gt;#1&lt;/a&gt; where the Numberformat was set to. Basically the lesson learned
 is to apply any type of formatting after all the data has been output. &lt;br&gt;
&lt;br&gt;
Just wanted to share this in case it helps anyone.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mayerwin" When="13/05/2015 17:42:30">
          <Html>
        &lt;div class="markDownOutput "&gt;Thanks! This made my day.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Got error: file format or file extension is not valid. Verify that the file has been corrupted and that file extension matches the format of the file">
      <Posts>
        <Post From="hk2012" When="11/05/2015 22:59:38">
          <Html>
        &lt;div class="markDownOutput "&gt;DotNetNuke.Services.Exceptions.ModuleLoadException: Package object was closed and disposed, so cannot carry out operations on this object or any stream opened on a part of this package.
&lt;br&gt;
&lt;br&gt;
System.ObjectDisposedException: Package object was closed and disposed, so cannot carry out operations on this object or any stream opened on a part of this package.
&lt;br&gt;
at System.IO.Packaging.Package.PartExists(Uri partUri) &lt;br&gt;
at OfficeOpenXml.ExcelWorkbook.Save() &lt;br&gt;
at OfficeOpenXml.ExcelPackage.GetAsByteArray(Boolean save) &lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Any advise?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Fork to Enable FIPS Compliance for Encryption">
      <Posts>
        <Post From="mpolutta" When="08/05/2015 21:28:16">
          <Html>
        &lt;div class="markDownOutput "&gt;Please see issue 15263, &lt;a href="https://epplus.codeplex.com/workitem/15263" rel="nofollow"&gt;
https://epplus.codeplex.com/workitem/15263&lt;/a&gt;. I modified code on a fork so that the Encryption does not throw FIPS exceptions when the FIPS Registry setting is set. Let me know if I need to run more tests or other tasks to complete to tie this up properly.
 The modified code is attached to the Issue Reply. &lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="&quot;Part does not exist&quot; error  saving document using GetAsByteArray">
      <Posts>
        <Post From="Andrii_arvo" When="05/05/2015 09:11:41">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi there, &lt;br&gt;
&lt;br&gt;
I started using EPPlus and everything went fine until I tried to use the GetAsByteArray method to save a document to byte array:
&lt;br&gt;
&lt;br&gt;
using (MemoryStream memoout = new MemoryStream()) {&lt;br&gt;
&lt;pre&gt;&lt;code&gt;memoout.Write(datato, 0, datato.Length);
    using (ExcelPackage destExcel = new ExcelPackage(memoout))
{
    return destExcel.GetAsByteArray();
}&lt;/code&gt;&lt;/pre&gt;
} &lt;br&gt;
&lt;br&gt;
The compilation fails on the last line with the "Part does not exist." error.
&lt;br&gt;
&lt;br&gt;
Cheers, &lt;br&gt;
Andrii&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="&quot;Friend access was granted&quot; compilation error">
      <Posts>
        <Post From="AdditiveLabs" When="27/04/2015 09:41:47">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi there, &lt;br&gt;
&lt;br&gt;
I started using EPPlus and everything went fine until I tried to use the &lt;strong&gt;
Copy&lt;/strong&gt; method of the &lt;strong&gt;ExcelRange&lt;/strong&gt; class like that:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;var worksheet = package.Workbook.Worksheets.FirstOrDefault();
var cell = worksheet.Cells["A1"];
cell.Copy(new ExcelRangeBase(worksheet, "A2"));&lt;/code&gt;&lt;/pre&gt;
From the moment I had the last line, the compilation fails with the dreaded "Friend access was granted..." error. I googled that without any success. Any help appreciated!
&lt;br&gt;
&lt;br&gt;
Cheers, &lt;br&gt;
Thomas&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="AdditiveLabs" When="29/04/2015 07:29:09">
          <Html>
        &lt;div class="markDownOutput "&gt;Well I figured out that it was the call to the ExcelRangeBase ctor that raised the issue, because&lt;br&gt;
&lt;pre&gt;&lt;code&gt;cell.Copy(worksheet.Cells["A2"]);&lt;/code&gt;&lt;/pre&gt;
works fine... Don't know why it popped such a weird compilation error. &lt;br&gt;
&lt;br&gt;
Now on another topic, I was wondering if it is possible to copy a cell together with its conditional formatting. Any hints?
&lt;br&gt;
&lt;br&gt;
Cheers, &lt;br&gt;
Thomas&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Recover content from workbook when open generated xlsx (lost images from template)">
      <Posts>
        <Post From="chemafs" When="28/04/2015 16:19:29">
          <Html>
        &lt;div class="markDownOutput "&gt;I create a xlsx using Epplus 4.0.4 and gave me the warning " Excel found content can't write. Recover content from workbook?"
&lt;br&gt;
If I answer yes the images I have on my template that I use to create the xlsx and missing and it shows "Can't show image..."
&lt;br&gt;
&lt;br&gt;
I did the same with previos version of Epplus and it work perfect. &lt;br&gt;
&lt;br&gt;
Any ideas to solve this or its a bug? &lt;br&gt;
&lt;br&gt;
Thank you&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Access only ExcelShapes">
      <Posts>
        <Post From="nlevente" When="28/04/2015 11:29:25">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, I am trying to access checkboxes from my worksheet.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;foreach ( OfficeOpenXml.Drawing.ExcelShape ch in xlWorkSheetinc.Drawings)
                                    {
                                        Console.WriteLine(ch.Name);
                                    }&lt;/code&gt;&lt;/pre&gt;
unfortunately the code above returns ExcelPicture too, and gives an exception: &lt;br&gt;
System.InvalidCastException: Unable to cast object of type 'OfficeOpenXml.Drawing.ExcelPicture' to type 'OfficeOpenXml.Drawing.ExcelShape'.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="nlevente" When="28/04/2015 14:10:43">
          <Html>
        &lt;div class="markDownOutput "&gt;This is working:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;    foreach (OfficeOpenXml.Drawing.ExcelDrawing ch in xlWorkSheetinc.Drawings)
      {
        if (ch.Name.Contains("Check"))
        {
          OfficeOpenXml.Drawing.ExcelShape c = (OfficeOpenXml.Drawing.ExcelShape)ch;
        }
      }&lt;/code&gt;&lt;/pre&gt;
This way I can access the ExcelShape's properties. &lt;br&gt;
For my luck Excel has an incremental naming. So every Checkbox I create and not renaming it will look like Check Box 1, Check Box 2 and so on.
&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Problem when writing large files - OutOfMemoryException">
      <Posts>
        <Post From="aquanilium" When="08/10/2010 03:47:16">
          <Html>
        
&lt;p&gt;Hi everyone,&lt;/p&gt;
&lt;p&gt;I'm using EPPlus for writing large data to Excel file (with approximately 160,000 rows and 50 columns).&lt;/p&gt;
&lt;p&gt;I've used the following code as directive (because I'm developing an Asp.Net MVC 2.0 web app):&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;&lt;span style="white-space: pre;"&gt;	&lt;/span&gt;public&lt;/span&gt; ActionResult Export()
        {
            &lt;span style="color: blue;"&gt;var&lt;/span&gt; template = &lt;span style="color: blue;"&gt;new&lt;/span&gt; FileInfo(Path.Combine(Request.PhysicalApplicationPath, &lt;span style="color: rgb(163, 21, 21);"&gt;@"Content\template.xlsx"&lt;/span&gt;));
            &lt;span style="color: blue;"&gt;using&lt;/span&gt; (ExcelPackage package = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(template, &lt;span style="color: blue;"&gt;true&lt;/span&gt;))
            {
                &lt;span style="color: green;"&gt;// fill cells&lt;/span&gt;
                &lt;span style="color: green;"&gt;//...&lt;/span&gt;

                &lt;span style="color: blue;"&gt;return&lt;/span&gt; File(package.GetAsByteArray(), &lt;span style="color: rgb(163, 21, 21);"&gt;"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"Data.xlsx"&lt;/span&gt;);
            }
        }
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;But the 'System.OutOfMemoryException' was thrown.&lt;/p&gt;
&lt;p&gt;Furthermore, I'm using&amp;nbsp;&lt;a id="ctl00_ctl00_MasterContent_Content_PostRepeater_ctl10_UserNameLink" href="http://www.codeplex.com/site/users/view/jankallman" rel="nofollow"&gt;jankallman&lt;/a&gt;'s method to fill the data to cells: "The fastest way to add cells is always
 from Left to Right-Top to bottom." and the exported data is stored in List&amp;lt;T&amp;gt; object.&lt;/p&gt;
&lt;p&gt;I don't know how to writing large data to Excel file avoiding OutOfMemory exception.&lt;/p&gt;
&lt;p&gt;Any suggestions in this case?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks guy,&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="11/10/2010 18:02:35">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I did a performance test on my dev machine (8GB ram) with 650,000 rows and 40 columns (I duplicated the columns of sample 7 a few times).It&amp;nbsp;took around 10min. The result is a 237 MB xlsx. The sheet1.xml file is 1.3Gb, so it takes a lot of memory.&lt;/p&gt;
&lt;p&gt;If I increase the rows more than that things starts to go really slow (i guess the memory is swaped out to disk).&lt;/p&gt;
&lt;p&gt;Check the taskmanager when you generate the file and get the exception to see if you are out of memory.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="aquanilium" When="12/10/2010 05:38:11">
          <Html>
        
&lt;p&gt;Hi Jan,&lt;/p&gt;
&lt;p&gt;I'm currently exporting data using XML Spreadsheet 2003 (*.xml) format. The exported file is quite large (~400MB), but when I open it and save as Excel 2007 (*.xlsx) format, its size down to ~40MB.&lt;/p&gt;
&lt;p&gt;I'm using TextWriter.Write(Response.Output)&amp;nbsp;to append each row of the sheet&amp;nbsp;from an ASP.NET MVC app on my dev mechine (2GB RAM) and it's OK. I only want to using EPPlus for export to new format to reduce the file's size. I don't know why export
 to XML format with 400MB is OK but cannot export to XLSX fomat with 40MB.&lt;/p&gt;
&lt;p&gt;Does EPPlus support similar way to save file similar with saving XML as above? That doesn't need to load all the content of the file before save file out?&lt;/p&gt;
&lt;p&gt;Update: here is the stack trace output when I called "ExcelPackage.SaveAs(Response.OutputStream)"&lt;/p&gt;
&lt;pre&gt;[OutOfMemoryException: Exception of type 'System.OutOfMemoryException' was thrown.]
   System.IO.MemoryStream.set_Capacity(Int32 value) +63
   System.IO.MemoryStream.EnsureCapacity(Int32 value) +55
   System.IO.MemoryStream.Write(Byte[] buffer, Int32 offset, Int32 count) +245
   MS.Internal.IO.Packaging.PackagingUtilities.CopyStream(Stream sourceStream, Stream targetStream, Int64 bytesToCopy, Int32 bufferSize) +260
   MS.Internal.IO.Packaging.SparseMemoryStream.WriteToStream(Stream stream) +53
   MS.Internal.IO.Zip.ZipIOFileItemStream.Save() +583
   MS.Internal.IO.Zip.ZipIOLocalFileBlock.Save() +163
   MS.Internal.IO.Zip.ZipIOBlockManager.SaveContainer(Boolean closingFlag) +483
   MS.Internal.IO.Zip.ZipIOBlockManager.SaveStream(ZipIOLocalFileBlock blockRequestingFlush, Boolean closingFlag) +56
   MS.Internal.IO.Zip.ZipIOModeEnforcingStream.Dispose(Boolean disposing) +84
   System.IO.Stream.Close() +17
   System.IO.Packaging.PackagePart.Close() +114
   System.IO.Packaging.Package.DoClose(PackagePart p) +194
   System.IO.Packaging.Package.DoOperationOnEachPart(PartOperation operation) +261
   System.IO.Packaging.Package.System.IDisposable.Dispose() +139
   System.IO.Packaging.Package.Close() +8
   OfficeOpenXml.ExcelPackage.Dispose() +33
&lt;/pre&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="12/10/2010 18:54:30">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Epplus supports the Xlsx-format only.&lt;/p&gt;
&lt;p&gt;It's not the XML that consumes the most memory, it is the in-memory cell objects. Each cell is stored in the ExcelCell class that holds some properties about the cell, like the value, formula, styling, hyperlinks, comments etc. I'm note sure how large each
 object is but assume it is 200 bytes including the internal index, then&amp;nbsp;the&amp;nbsp;size will be 200*160,000*40≈1,2GB only to store the cells. Then you will have a memorystream for the package and a few other things. In the end it will require a lot
 of memory.&amp;nbsp;I guess the ExcelCell class can be optimized to use less memory , but that is something for the future.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="cowthespud" When="12/07/2011 03:31:18">
          <Html>
        
&lt;p&gt;Is there any way to do an incremental write, so that say every 100 rows the file is written to the database and the memory cleaned up?&lt;/p&gt;
&lt;p&gt;Would saving the file, disposing of the ExcelPackage and then loading the file and appending data in work?&lt;/p&gt;
&lt;p&gt;We're doing a data dump of 200,000 rows with 100-200 columns in ASP.NET/IIS6 x86 and sometimes get an out of memory exception and sometimes don't.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="emendezrivas" When="27/12/2011 14:12:45">
          <Html>
        
&lt;p&gt;Probably a little late, but I have this exact same issue. I made an article in my blog with a solution for this. Here is the link:&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;a href="http://blog.emendezrivas.com/?p=45" rel="nofollow"&gt;http://blog.emendezrivas.com/?p=45&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Hope this helps.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="tyrons" When="05/04/2013 23:32:55">
          <Html>
        &lt;div class="markDownOutput "&gt;I'm sorry, but I need to raise this question again. I am trying to write 11.000 columns with 900 rows each, which gives a total of nearly 10 million cells, and consumes like 1.5Gb of RAM.
&lt;br&gt;
&lt;br&gt;
I've tried everything: directly writing to "Cells[x, y].Value", writing everything to an Array and try to read with LoadFromCollection and now I've tried writing all my info to an array, create a CSV from it, and read it through LoadFromText, because
 I thought it would give me a better performance. &lt;br&gt;
&lt;br&gt;
The question is: how can I write such amount of information to a spreadsheet? If I write all my data to an array, the whole program consumes no more than 500Mb. Is it possible to write to "Cells" without this huge overhead? I have all information
 I need in one place, so I can do it in one-pass, or save the file little by little... Any suggestion will help!
&lt;br&gt;
&lt;br&gt;
Thank you in advance!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="z0mp" When="10/09/2013 10:44:12">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello &lt;br&gt;
&lt;br&gt;
I found myself in a similar situation some time ago. I needed to generate very large files (&amp;gt;200MB) and I always got an OutOfMemoryException
&lt;br&gt;
I finally found a workaround referencing DocumentFormat.OpenXml directly. The work is a two step process
&lt;br&gt;
&lt;br&gt;
Step 1. Create an Xml file with your data. I use a XmlWriter. Data format is as follows (this worked for me but I think format could be somehow different as defined by OpenXml)&lt;br&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main"&amp;gt;
  &amp;lt;sheetData&amp;gt;

    &amp;lt;row r="1"&amp;gt;
      &amp;lt;c r="A1" t="inlineStr"&amp;gt;
        &amp;lt;is&amp;gt;
          &amp;lt;t&amp;gt;Some Value row 1 column A&amp;lt;/t&amp;gt; 
        &amp;lt;/is&amp;gt;
      &amp;lt;/c&amp;gt;
      &amp;lt;c r="B1" t="inlineStr"&amp;gt;
        &amp;lt;is&amp;gt;
          &amp;lt;t&amp;gt;Other value row 1 column B&amp;lt;/t&amp;gt; 
        &amp;lt;/is&amp;gt;
      &amp;lt;/c&amp;gt;
      ...
    &amp;lt;/row&amp;gt;

    &amp;lt;row r="2"&amp;gt;
      &amp;lt;c r="A2" t="inlineStr"&amp;gt;
        &amp;lt;is&amp;gt;
          &amp;lt;t&amp;gt;Some Value row 2 column A&amp;lt;/t&amp;gt; 
        &amp;lt;/is&amp;gt;
      &amp;lt;/c&amp;gt;
      &amp;lt;c r="B2" t="inlineStr"&amp;gt;
        &amp;lt;is&amp;gt;
          &amp;lt;t&amp;gt;Other value row 2 column B&amp;lt;/t&amp;gt; 
        &amp;lt;/is&amp;gt;
      &amp;lt;/c&amp;gt;
      ...
    &amp;lt;/row&amp;gt;

    ....

  &amp;lt;/sheetData&amp;gt;
&amp;lt;/worksheet&amp;gt;&lt;/code&gt;&lt;/pre&gt;
Step 2. Once you have your xml file (as large as your drive capacity or your operating system can hold) you can use this code to create the xlsx file&lt;br&gt;
&lt;pre&gt;&lt;code&gt;using (SpreadsheetDocument oExcel = SpreadsheetDocument.Create(sFullNameDes, DocumentFormat.OpenXml.SpreadsheetDocumentType.Workbook))
{
    // Create workbook, worksheet
    WorkbookPart oWorkbook = oExcel.AddWorkbookPart();
    WorksheetPart oWorksheet = oWorkbook.AddNewPart&amp;lt;WorksheetPart&amp;gt;();
    string sheetId = oWorkbook.GetIdOfPart(oWorksheet);
    string XML = @"&amp;lt;?xml version=""1.0"" encoding=""UTF-8"" standalone=""yes""?&amp;gt;&amp;lt;workbook xmlns=""http://schemas.openxmlformats.org/spreadsheetml/2006/main"" xmlns:r=""http://schemas.openxmlformats.org/officeDocument/2006/relationships""&amp;gt;&amp;lt;sheets&amp;gt;&amp;lt;sheet name=""{1}"" sheetId=""1"" r:id=""{0}"" /&amp;gt;&amp;lt;/sheets&amp;gt;&amp;lt;/workbook&amp;gt;";
    XML = string.Format(XML, sheetId, "Content");
    using (Stream stream = oWorkbook.GetStream())
    {
        byte[] buffer = (new UTF8Encoding()).GetBytes(XML);
        stream.Write(buffer, 0, buffer.Length);
    }
    // Import sheet
    Stream oStremOut = oWorksheet.GetStream();
    // My buffer
    byte[] buffer = new byte[1000000];
    int nBytesRead = 0;
    FileStream oFileStream = new FileStream(sFullNameOfXmlGeneratedInStep1, FileMode.Open);
    do
    {
        // Read data
        nBytesRead = oFileStream.Read(buffer, 0, 1000000);
        if (nBytesRead &amp;gt; 0) oStremOut.Write(buffer, 0, nBytesRead);
    } while (nBytesRead &amp;gt; 0);
    // Close things
    oFileStream.Close();
    oExcel.Close();
}&lt;/code&gt;&lt;/pre&gt;
This code uses a buffer of 1MB to write data to generate the final xslx file. You can change that value to whatever you can depending of your memory availability.
&lt;br&gt;
&lt;br&gt;
Hope this will be useful.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="aldenquimby" When="05/10/2013 02:58:28">
          <Html>
        &lt;div class="markDownOutput "&gt;Has anyone found a way to handle the memory issue using EPPlus? I haven't tried @z0mp's solution because I have a massive CSV file already and don't want to generate XML from it, I want to go straight to XLSX. When I use LoadFromText I get an OutOfMemoryException,
 and when I iterate myself setting cell values I also get an OutOfMemoryException.
&lt;br&gt;
&lt;br&gt;
Is there a setting that will tell ExcelPackage not to hold all of the cells in memory?
&lt;br&gt;
&lt;br&gt;
There are python libraries that limit memory usage (&lt;a href="http://xlsxwriter.readthedocs.org/en/latest/working_with_memory.html" rel="nofollow"&gt;http://xlsxwriter.readthedocs.org/en/latest/working_with_memory.html&lt;/a&gt;), but I would rather stick with C#.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="chong1222" When="30/11/2013 14:19:03">
          <Html>
        &lt;div class="markDownOutput "&gt;Try this&lt;br&gt;
&lt;blockquote&gt;
&lt;pre&gt;&lt;code&gt;const int LIMIT = 1048576;
const int BUFFER = 100000;
var tempFile = new FileInfo(Path.GetTempFileName());
try
{
    var pck = new ExcelPackage();
    var ws = pck.Workbook.Worksheets.Add("Sheet1");
    // initialize Worksheet
    // Write header row etc.

    pck.SaveAs(tempFile);
    pck.Dispose();

    using (var stream = tempFile.OpenRead())
    {
        pck.Load(stream);
    }
    pck.Workbook.Worksheets.MoveToEnd(1);
    ws = pck.Workbook.Worksheets[1];
    var rowCount = 0;

    // reader = SqlReader
    var values = new object[reader.FieldCount];
    while (reader.Read())
    {
        if (++rowCount &amp;gt;= LIMIT)
        {
            break;
        }
        else if (rowCount % BUFFER == 0)
        {
            pck.Save();
            pck.Dispose();

            using (var stream = tempFile.OpenRead())
            {
                pck.Load(stream);
            }
            pck.Workbook.Worksheets.MoveToEnd(1);
            ws = pck.Workbook.Worksheets[1];
        }
        reader.GetValues(values);
        ws.Cells[1 + rowCount, 1].LoadFromArrays(new[] { values.Select(v =&amp;gt; (object)Convert.ToString(v)).ToArray() });
    }

    reader.Dispose();

    pck.Save();
    pck.Dispose();

    response.WriteFile(tempFile.FullName, true);
}
finally
{
    try { tempFile.Delete(); }
    catch { }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;/blockquote&gt;
-Steven Chong&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="darkchico" When="08/10/2014 14:35:34">
          <Html>
        &lt;div class="markDownOutput "&gt;I'm having the same issue, and I tried Steven's code, but I can't manage to write in the file past the first time (with the pck.SaveAs).
&lt;br&gt;
And I can't use SaveAs each time, because otherwise the entire file is rewritten, and the OOM exception comes back...
&lt;br&gt;
Anybody have another solution for this problem ? (I'm working with the 4.02 beta)&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Magy22" When="28/04/2015 08:17:51">
          <Html>
        &lt;div class="markDownOutput "&gt;I had this problem, but I fixed it by switching the option of "Platform target", from x86 to x64 or "Any CPU". ( right click on the project, then select "Properties", then the tab "Build", then on "Platform
 target" select "x64" ) &lt;br&gt;
&lt;br&gt;
The problem is that for platform x86 you can use only about 1.8 GB of RAM. For platform x64, you do not have this limitation.
&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How can we convert a range of cells to numeric format">
      <Posts>
        <Post From="ganesh_dks" When="27/04/2015 09:10:08">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
Can any one please provide information on how can we change the the cell format to numeric in EPPlus worksheet so that when a user select a range of cells in excel he would get the sum of it in the right bottom corner in excel. My data table gives numbers as
 string data. So what can I do. &lt;br&gt;
I have used the Numberformat property but it has no effect.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Transpose excel data">
      <Posts>
        <Post From="mruCoders" When="24/04/2015 09:17:17">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello, &lt;br&gt;
&lt;br&gt;
Is it possible to transpose data on EPPLUS? &lt;br&gt;
&lt;br&gt;
Actual Table Excel data: &lt;br&gt;
&lt;strong&gt;Item Quantity Price&lt;/strong&gt; &lt;br&gt;
Shirt 145 500 &lt;br&gt;
Jeans 100 50 &lt;br&gt;
&lt;br&gt;
Transposed Excel data: &lt;br&gt;
&lt;strong&gt;Item Shirt Jeans&lt;/strong&gt; &lt;br&gt;
Quantity 145 100 &lt;br&gt;
Price 500 50&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="25/04/2015 07:27:25">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
if you are asking if the TRANSPOSE function is implemented in the calc engine of EPPlus the answer is no. But you could achieve programatically if you write the transpose code yourself, accessing/modifying the spreadsheet via EPPlus.
&lt;br&gt;
&lt;br&gt;
/Mats&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Importing HTML">
      <Posts>
        <Post From="victor_a" When="22/11/2012 14:41:04">
          <Html>
        
&lt;p&gt;I have some data in HTML format. If I maually open the file in excel or paste the html content to a worksheet the chart gets drawn with all the right formatting.&lt;/p&gt;
&lt;p&gt;But I have not been able to import HTML using EPPlus. So far I've tried:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ExcelPackage package = new ExcelPackage("test.html")) --&amp;gt; Error saying the file is damaged
&lt;/li&gt;&lt;li&gt;Cells[1,1].Value = strHtmlData --&amp;gt; the raw html string is inserted into the cell
&lt;/li&gt;&lt;/ul&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Is there any other way to solve this?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="PrasadManam" When="22/04/2015 07:21:44">
          <Html>
        &lt;div class="markDownOutput "&gt;I have the same issue.... &lt;br&gt;
&lt;br&gt;
I further even tried copying to the clipboard but not able to paste it. &lt;br&gt;
&lt;br&gt;
Any ideas?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Pivot Table Collapse All Drilldowns on start and Hide Value columns">
      <Posts>
        <Post From="robinqueen94" When="24/03/2015 22:11:45">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
I am fairly new to the Pivot Table concept and I am having some issues with two separate parts.
&lt;br&gt;
&lt;br&gt;
I am developing this in .NET 4.5 and C# &lt;br&gt;
&lt;br&gt;
The first is when I start up by excel file, my pivot table has all the drill downs shown.
&lt;br&gt;
&lt;br&gt;
Example: &lt;br&gt;
&lt;img alt="Image" src="http://i62.tinypic.com/33c9e6g.png"&gt; &lt;br&gt;
&lt;br&gt;
I would like them to be suppressed so It shows a general Summary, then if the user wants to, they can drill down from there. Like so:
&lt;br&gt;
&lt;br&gt;
&lt;img alt="Image" src="http://i57.tinypic.com/29c51k3.png"&gt; &lt;br&gt;
&lt;br&gt;
Is there a property from the pivotable I am just not seeing? &lt;br&gt;
currently I have these set on my pivottable...&lt;br&gt;
&lt;pre&gt;&lt;code&gt;            pivotTable.DataOnRows = false;
            pivotTable.ColumGrandTotals = false;
            pivotTable.Compact = false;
            pivotTable.CompactData = false;
            pivotTable.MultipleFieldFilters = true;&lt;/code&gt;&lt;/pre&gt;
And for the other issue, As you can see in the first image, this pivot table just has Data columns. No Values.
&lt;br&gt;
&lt;br&gt;
Is there a way I can hide the value columns? So the table would not write onto 'P', 'Q', 'R', 'S', 'T', and 'U'?
&lt;br&gt;
&lt;br&gt;
I can do this on the Excel end but I didn't see any noticeable method in C#. &lt;br&gt;
&lt;br&gt;
Thanks for the help.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="valnuke" When="13/04/2015 23:40:37">
          <Html>
        &lt;div class="markDownOutput "&gt;I couldn't find any way to do it... it'd be extremely useful indeed. &lt;br&gt;
&lt;br&gt;
Meanwhile, if you don't mind working with an xlsm file you can read this : &lt;a href="http://stackoverflow.com/questions/12846334/epplus-pivot-table-collapse-entire-field" rel="nofollow"&gt;
http://stackoverflow.com/questions/12846334/epplus-pivot-table-collapse-entire-field&lt;/a&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="EPPlus - setting the font / text size on Headers &amp;amp; Footers">
      <Posts>
        <Post From="hamble" When="12/04/2015 11:13:58">
          <Html>
        &lt;div class="markDownOutput "&gt;I have text in the footers of my worksheets but I need to adjust the text size.
&lt;br&gt;
&lt;br&gt;
How can I do this? &lt;br&gt;
&lt;br&gt;
thanks!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="ExcelTextFormat Whitesapce">
      <Posts>
        <Post From="adnan_salah84" When="02/04/2015 12:28:31">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi Developer, &lt;br&gt;
&lt;br&gt;
I am using new EPPLUS library. I am having problem with different whitespace in input text file.
&lt;br&gt;
&lt;strong&gt;Here is my sample program code:&lt;/strong&gt; &lt;br&gt;
FileInfo newFile = new FileInfo("output.xlsx"); &lt;br&gt;
using (ExcelPackage package = new ExcelPackage()) &lt;br&gt;
{ &lt;br&gt;
var worksheet = package.Workbook.Worksheets.Add("SheetName"); &lt;br&gt;
var format = new ExcelTextFormat(); &lt;br&gt;
&lt;strong&gt;format.Delimiter = ' ';&lt;/strong&gt; &lt;br&gt;
worksheet.Cells["A1"].LoadFromText(new FileInfo("input.txt"), format);
&lt;br&gt;
package.SaveAs(newFile); &lt;br&gt;
} &lt;br&gt;
&lt;br&gt;
&lt;strong&gt;Here is my Input text file:&lt;/strong&gt; &lt;br&gt;
AA____BB______BB___MM &lt;br&gt;
&lt;br&gt;
It has different space or cap so how to format delimiter all whitespace? &lt;br&gt;
I tried format.Delimiter = '@\s+'; but not working &lt;br&gt;
I am trying from 2-3 hours continuously still i have no clue :( &lt;br&gt;
&lt;br&gt;
i want input read (as above) to xlsx file write (output) like this: &lt;br&gt;
AA BB BB MM &lt;br&gt;
&lt;br&gt;
Any Idea? &lt;br&gt;
I am waiting for your response. &lt;br&gt;
&lt;br&gt;
Thanks&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Export to Excel">
      <Posts>
        <Post From="saraestrela" When="24/03/2015 13:11:21">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi. &lt;br&gt;
&lt;br&gt;
I'm using epplus to export data to excel in asp.net page, with success. &lt;br&gt;
But I need to send message to user that the export is completed. &lt;br&gt;
How I do that? &lt;br&gt;
&lt;br&gt;
Thanks in advance.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to unprotect a file after opening it ?">
      <Posts>
        <Post From="frliran" When="24/03/2015 08:20:55">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello,&lt;br&gt;
&lt;br&gt;
I'm brand new to EPPlus...&lt;br&gt;
I have an xls file which has some protected cells in it. I can open the file for read without the password but I need the password in order to edit the file.&lt;br&gt;
The thing is that the password is a database on my server and I need a hidden value from the file in order to get the password from the database.&lt;br&gt;
&lt;br&gt;
So my question is, how can I insert the password to unprotect the file after it is alread open ?&lt;br&gt;
The only place to insert the password is in the constructor of the package:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;ExcelPackage package = new ExcelPackage(fileInfo, password)&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Issue setting existing textbox's text">
      <Posts>
        <Post From="MattOakley" When="17/03/2015 16:53:59">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
I'm trying to update and existing textbox's text, but the following has no effect:&lt;br&gt;
&lt;pre&gt;&lt;code&gt; private void SetShapeText(ExcelWorksheet sheet, string shapeName, string value)
        {
            var shape = sheet.Drawings[shapeName] as ExcelShape;
            if (shape != null)
            {
                // Doesnt work??
                shape.Text = value;
            }
        }&lt;/code&gt;&lt;/pre&gt;
Any help would be greatly appreciated. &lt;br&gt;
&lt;br&gt;
Matt&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="MattOakley" When="23/03/2015 18:27:44">
          <Html>
        &lt;div class="markDownOutput "&gt;I found a workaround for this, which leads to think it was a defect. &lt;br&gt;
&lt;br&gt;
The work around was to set the textboxs text in the template and then overwrite it in the code&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title=".Calculate fails for IF &amp;amp; Vlookup statements">
      <Posts>
        <Post From="Shav" When="27/08/2014 10:17:33">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, I'm currently using EPPlus 4.0 Beta 2 and I'm having a problem, whereby the .Calculate Method doesn't work for cells that have IF statements. If I run .Calculate on a worksheet (i.e. worksheet.Calculate()) and then try to find get the value within
 the cell that contains the IF statement, the value returned is #VALUE!. The IF statement works fine within Excel and the spreadsheet itself so it's just the Calculate Method that doesn't seem to be able to work out the correct value. The syntax that I'm using
 for the IF statement is as follows&lt;br&gt;
&lt;pre&gt;&lt;code&gt;XLS_Modules.Cells[rowid, column_ao].Formula = "IF(" + XLS_Modules.Cells[(row + 11), column_internal_parameter_values].Address + "," + XLS_Modules.Cells[(input_row + 1), column_ao].Address + ",0)";&lt;/code&gt;&lt;/pre&gt;
Any ideas on what could be causing this? &lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Additionally I think the problem also exists for Vlookup statements. I haven't done as much investigation yet but for a cell with a Vlookup statement, I'm getting a returned value of #N/A. Again, the vlookup statement works fine within the Excel spreadsheet
 itself.&lt;br&gt;
&lt;br&gt;
Cheers&lt;br&gt;
Shav&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="RagingKore" When="28/08/2014 16:24:37">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi dude, &lt;br&gt;
&lt;br&gt;
I can confirm it does not work at all, I get #N/A everytime. &lt;br&gt;
&lt;br&gt;
Just found out, THE HARD WAY... Today... &lt;br&gt;
&lt;br&gt;
Cheers, &lt;br&gt;
&lt;br&gt;
Sergio&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="03/09/2014 08:39:49">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
could you create an issue and attach a workbook with and an example where this fails? I dont think there is any thing wrong with the IF function itself, but there might be errors that "bubbles up" from the cells that are referenced in the IF-statement.
&lt;br&gt;
&lt;br&gt;
/Mats&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Shav" When="03/09/2014 12:14:05">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi Mats, here's a simple example I created to replicate the problem. I've created a very basic worksheet with a number in B1, a TRUE in B3 and the IF statement in cell B5 referencing B3. The Excel worksheet works fine but unfortunately, I cannot assign
 the value of cell B5 to an internal string variable as it simply gets #VALUE!. Here's the code I've used to create the worksheet.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;
        public void XLS_Create_Testwb_Worksheet()
        {

            Trace.WriteLineIf(Debug_Toggle, "\r\n \r\n*************\r\nXLS_Testwb\r\n*************");
            Trace.WriteLineIf(Debug_Toggle, "In Method to create Testwb worksheet");

            string worksheet_name = "IF Test";
            Trace.WriteLineIf(Debug_Toggle, "Worksheet name is " + worksheet_name + " and location in Dimensioning Workbook is " + worksheet_number.ToString());
            Trace.WriteLineIf(Debug_Toggle, "Adding Worksheet to Workbook");
            XLS_Workbook.Workbook.Worksheets.Add(worksheet_name);
            XLS_Testwb = XLS_Workbook.Workbook.Worksheets[worksheet_number];
            XLS_Testwb.Name = worksheet_name;

            // Variable for result of .Calculate
            string result;

            // Column Identifier
            int columnlabel = 1;
            int columnid = 2;

            // Row Pointer
            int rowid = 1;

            XLS_Testwb.Cells[rowid, columnlabel].Value = "Number";
            XLS_Testwb.Cells[rowid, columnid].Value = 10;
            rowid +=2;

            XLS_Testwb.Cells[rowid, columnlabel].Value = "Boolean Value";
            XLS_Testwb.Cells[rowid, columnid].Value = true;
            rowid +=2;

            XLS_Testwb.Cells[rowid, columnlabel].Value = "Result";
            XLS_Testwb.Cells[rowid, columnid].Formula = "IF(" + XLS_Testwb.Cells[(rowid - 2), columnid].Address + "," + XLS_Testwb.Cells[(rowid - 4), columnid].Address + ",0)";

            XLS_Testwb.Cells.AutoFitColumns();
            
            XLS_Testwb.Calculate();
            result = XLS_Testwb.Cells[rowid, columnid].Value.ToString();
            Trace.WriteLineIf(Debug_Toggle, "The content of result is " + result);

        }
&lt;/code&gt;&lt;/pre&gt;
Another related issue I experienced when creating the above is that my result variable had to be of type string. If result was of type int and I tried result = Convert.ToInt16(XLS_Testwb.Cells[rowid, columnid].Value); my app would Build but not run due to A
 first chance exception of type 'System.IO.IOException'&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Question, how do I go about attaching the worksheet created to this thread? &lt;br&gt;
&lt;br&gt;
Cheers&lt;br&gt;
Shav&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Shav" When="09/09/2014 11:28:15">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi,&lt;br&gt;
&lt;pre&gt;&lt;code&gt;   is there anyone that can help/advise with this?
&lt;/code&gt;&lt;/pre&gt;
Thanks &lt;br&gt;
Shav&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="pimbrouwers" When="11/09/2014 16:40:28">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi everybody, &lt;br&gt;
&lt;br&gt;
I ran into this problem recently as well, specifically with if statements. For me, the cause of the problem was the fact that the formula was missing an expression (in my case the "False" expression). Excel handles this by displaying "False"
 in the cell. &lt;br&gt;
&lt;br&gt;
The EEPlus calc engine however has strict checks in several places (If.cs &amp;amp; IfFunctionCompiler.cs -- as far as I can tell) that will throw a ExcelErrorValueException if the expression count is not 3.
&lt;br&gt;
&lt;br&gt;
I'm not entirely sure how to view this problem. In one hand, the easy answer is just to write complete if statements in Excel. On the other hand, the better solution would be to program in better expression check for IF statements.
&lt;br&gt;
&lt;br&gt;
Example: &lt;br&gt;
&lt;br&gt;
This did not compute: &lt;br&gt;
=IF(E18=B16, E19) &lt;br&gt;
&lt;br&gt;
This does computer: &lt;br&gt;
=IF(E18=B16, E19, 0)&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="pimbrouwers" When="11/09/2014 17:11:52">
          <Html>
        &lt;div class="markDownOutput "&gt;A temporary workaround (if you're working with the source files) is to change the Compile() function at line 57 in IfFunctionCompiler.cs to the following:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;public override CompileResult Compile(IEnumerable&amp;lt;Expression&amp;gt; children, ParsingContext context)
        {
            //if(children.Count() &amp;lt; 3) throw new ExcelErrorValueException(eErrorType.Value);
            var args = new List&amp;lt;FunctionArgument&amp;gt;();
            Function.BeforeInvoke(context);
            var firstChild = children.ElementAt(0);
            var boolVal = (bool)firstChild.Compile().Result;
            args.Add(new FunctionArgument(boolVal));
            if (boolVal)
            {
                var val = new object();

                if(children.Count() &amp;lt; 3)
                    val = false;
                else
                    val = children.ElementAt(1).Compile().Result;

                args.Add(new FunctionArgument(val));
                args.Add(new FunctionArgument(null));
            }
            else
            {
                var val = new object();

                if(children.Count() &amp;lt; 3)
                    val = false;
                else
                    val = children.ElementAt(2).Compile().Result;

                args.Add(new FunctionArgument(null));
                args.Add(new FunctionArgument(val));
            }
            return Function.Execute(args, context);
        }&lt;/code&gt;&lt;/pre&gt;
The check for expression count has been commented out, and in its place a check is done within the value setters whereby if the children count is less than 3 a FALSE value is subbed in. I realize this isn't a perfect solution. However, FALSE values are the
 least destructive on the surrounding calculations as they are omitted from things like AVERAGE, SUM, MAX etc.
&lt;br&gt;
&lt;br&gt;
Enjoy.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Shav" When="11/09/2014 17:50:31">
          <Html>
        &lt;div class="markDownOutput "&gt;Ah, this is interesting.... Ok, I always had 3 arguments in my IF statements. Now, the first argument was simply the address of a cell that contained a Boolean true value.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;XLS_Testwb.Cells[rowid, columnid].Formula = "IF(" + XLS_Testwb.Cells[(rowid - 2), columnid].Address + "," + XLS_Testwb.Cells[(rowid - 4), columnid].Address + ",0)";&lt;/code&gt;&lt;/pre&gt;
If I update the above to have a equation for the first argument, i.e. E18=true, it gets a little better because .Calculate sort of works. It returns the false value. So while it can't find the match for the true statement and fails to assign the correct result
 to my integer result, it is at least able to equate the IF statement and return the false value because it hasn't found a match for the true statement. Therefore, there's something up with the evaluation of the true element of the IF statement and its struggling
 to match the cell against a Boolean true located in the reference cell. So here's my new statement
&lt;br&gt;
&lt;pre&gt;&lt;code&gt;XLS_Testwb.Cells[rowid, columnid].Formula = "IF(" + XLS_Testwb.Cells[(rowid - 2), columnid].Address + "=\"TRUE\"," + XLS_Testwb.Cells[(rowid - 4), columnid].Address + ",0)";&lt;/code&gt;&lt;/pre&gt;
Note, I made one edit to my originally posted code. I had &lt;br&gt;
&lt;pre&gt;&lt;code&gt;XLS_Testwb.Cells[rowid, columnid].Value = "TRUE";&lt;/code&gt;&lt;/pre&gt;
which I changed to the belowas I will assigning a Boolean value to a cell and not a string containing TRUE&lt;br&gt;
&lt;pre&gt;&lt;code&gt;XLS_Testwb.Cells[rowid, columnid].Value = true;&lt;/code&gt;&lt;/pre&gt;
Any ideas on why the evaluation of the true element of the IF statement is failing. I feel like I'm close and have tried a few different syntaxes for =true, etc..., but no joy.
&lt;br&gt;
&lt;br&gt;
Cheers &lt;br&gt;
Shav&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Shav" When="12/09/2014 17:00:10">
          <Html>
        &lt;div class="markDownOutput "&gt;So after a bit more testing and putting in =TRUE for element 1 of the IF statement, I think the problem is not now actually the evaluation of the true statement but when trying to return a value when the true statement for element 1 has a match. This is
 the IF statement and when the evaluation for element 1 is true, I'm getting #VALUE!&lt;br&gt;
&lt;pre&gt;&lt;code&gt;            XLS_Testwb.Cells[rowid, columnid].Formula = "IF(" + XLS_Testwb.Cells[(rowid - 2), columnid].Address + "=TRUE," + XLS_Testwb.Cells[(rowid - 4), columnid].Address + ",0)";&lt;/code&gt;&lt;/pre&gt;
Now, if I change the IF statement to return the Value as opposed to the Address for the true condition, .Calculate works and I get the correct value returned and assigned to my integer result within my program.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;            XLS_Testwb.Cells[rowid, columnid].Formula = "IF(" + XLS_Testwb.Cells[(rowid - 2), columnid].Address + "=TRUE," + XLS_Testwb.Cells[(rowid - 4), columnid].Value + ",0)";&lt;/code&gt;&lt;/pre&gt;
However, this won't work for me in reality because I need the IF statement within the Excel worksheet to reference the cell ((rowid - 4), columnid)) as opposed to having an IF statement using a static value upon program running. Basically, I need the IF statement
 to be dynamic within the Excel sheet &lt;br&gt;
&lt;br&gt;
I need this within the Excel sheet &lt;br&gt;
=IF(E18=TRUE, E19, 0) &lt;br&gt;
and not this &lt;br&gt;
=IF(E18=TRUE, 10, 0) &lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Is there anyone out there from Epplus that can shed some light on this. Is this a known or fixable thing within 4.0 Beta
&lt;br&gt;
&lt;br&gt;
Many thanks &lt;br&gt;
Shav&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Shav" When="18/09/2014 12:04:01">
          <Html>
        &lt;div class="markDownOutput "&gt;Anyone from the Epplus team could help me with this? I'm at a sticking point in my code and can't progress without some solution for this.
&lt;br&gt;
&lt;br&gt;
Cheers &lt;br&gt;
Shav&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="02/10/2014 14:22:23">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
the bug has now been found and eliminated... next version of 4.0 will contain the fix.
&lt;br&gt;
&lt;br&gt;
/Mats&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Shav" When="05/10/2014 21:02:35">
          <Html>
        &lt;div class="markDownOutput "&gt;Ah super, thanks for this Mats &lt;br&gt;
&lt;br&gt;
Shav&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Tydude4Christ" When="10/10/2014 16:21:14">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi Mats, &lt;br&gt;
&lt;br&gt;
Is this bug related to my issues 15067 and 15064 with using Excel Address's or were my fixes necessary?
&lt;br&gt;
&lt;br&gt;
Thanks, &lt;br&gt;
Tyler&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="23/10/2014 13:18:56">
          <Html>
        &lt;div class="markDownOutput "&gt;Sorry for this late reply, Tyler! As you might have seen I have merged your fixes into the code. There will be a Beta 3 release very soon that will contain the fixes.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Slip36" When="25/02/2015 09:07:24">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
This bug still appears to be an issue in the latest versions of EEPlus. &lt;br&gt;
&lt;br&gt;
Can you confirm that it's been resolved? &lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="petrmach" When="20/03/2015 20:24:29">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi.&lt;br&gt;
&lt;br&gt;
I have similar problem. These 2 versions of formula give different results:&lt;br&gt;
&lt;br&gt;
IF(K39-K164-(K39 * J156-J164)&amp;lt;-J40;-(K39-K164-(K39 * J156-J164)-J40);0) gives wrong result&lt;br&gt;
&lt;br&gt;
IF(K39-K164-(K39 * J156-J164)&amp;lt;-J40;-1 * (K39-K164-(K39 * J156-J164)-J40);0) gives right result&lt;br&gt;
&lt;br&gt;
I can send XLS workbook with real data.&lt;br&gt;
I have the latest version of EPPlus.&lt;br&gt;
&lt;br&gt;
Peter&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="23/03/2015 10:46:38">
          <Html>
        &lt;div class="markDownOutput "&gt;Thank you Peter. If I understand your issue correctly it seems to be related to negating an expression within a parenthesis. I will have a look at this.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="petrmach" When="23/03/2015 11:03:06">
          <Html>
        &lt;div class="markDownOutput "&gt;Yes. Correct.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Insert columns">
      <Posts>
        <Post From="Nyushechka" When="13/10/2011 11:32:00">
          <Html>
        
&lt;p&gt;Hi.&lt;/p&gt;
&lt;p&gt;How can I insert cells\columns &lt;span id="result_box" lang="en"&gt;&lt;span&gt;before or&lt;/span&gt;
&lt;span&gt;after&lt;/span&gt; &lt;span&gt;the specified address?&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span id="result_box" lang="en"&gt;&lt;span&gt;I need to&lt;/span&gt; &lt;span&gt;insert a&lt;/span&gt;
&lt;span&gt;certain number of columns&lt;/span&gt; &lt;span&gt;before&lt;/span&gt; &lt;span&gt;and&lt;/span&gt; &lt;span&gt;
after&lt;/span&gt; &lt;span&gt;specific addresses&lt;/span&gt;&lt;span&gt;,&lt;/span&gt; &lt;span&gt;so that&lt;/span&gt; &lt;span&gt;
the column&lt;/span&gt; &lt;span&gt;on the right&lt;/span&gt; &lt;span&gt;have not changed&lt;/span&gt; &lt;span&gt;their value&lt;/span&gt;&lt;span&gt;, and&lt;/span&gt;
&lt;span&gt;shifted&lt;/span&gt; &lt;span&gt;to the right.&lt;/span&gt;&lt;br&gt;
&lt;span&gt;Copying&lt;/span&gt; &lt;span&gt;too&lt;/span&gt; &lt;span&gt;slowly&lt;/span&gt; &lt;span&gt;in this case&lt;/span&gt;&lt;span&gt;, the files&lt;/span&gt;
&lt;span&gt;are very large.&lt;/span&gt;&lt;br&gt;
&lt;span&gt;Help, please.&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span lang="en"&gt;&lt;span&gt;Tatiana&lt;br&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="19/10/2011 06:26:22">
          <Html>
        
&lt;p&gt;No, there is no method to insert column yet.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="amwild" When="26/10/2011 05:15:43">
          <Html>
        
&lt;p&gt;Is there any plan to add ExcelWorksheet.InsertColumn?&lt;/p&gt;
&lt;p&gt;If so, when?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="28/10/2011 15:26:36">
          <Html>
        
&lt;p&gt;For performance reasons this has not been implemented. To get this to work I will have to rewrite the internal cell store, so it's quite a lot of work. When I have the time to&amp;nbsp;fix it I will, but&amp;nbsp;I cant give you a date.&lt;/p&gt;
&lt;p&gt;But feel free to implement it if you need it :)&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="L1Nk" When="11/12/2012 15:11:05">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;first of all many thanks for your lib? it helps me a lot.&amp;nbsp;Just wondering is there updates regarding inserting columns functionality? Or can you advice how it can be done better way using your lib?&amp;nbsp;Ive tried combine using epplus with interop, but
 last one is ugly and inconvenient, so i left that idea.&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks in advance&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="swmal" When="11/12/2012 19:10:34">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Inserting columns is on the long term roadmap. Jan is working on it, but it will not be ready until the next major version since it will include a total rewrite of the Cell storage.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="punitganshani" When="23/05/2013 08:15:02">
          <Html>
        &lt;div class="markDownOutput "&gt;Will it be included in the next release? and when?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="frliran" When="23/03/2015 07:53:59">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
Is the Insert functionality enabled yet ?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Template">
      <Posts>
        <Post From="junjimalaza" When="19/03/2015 16:02:50">
          <Html>
        &lt;div class="markDownOutput "&gt;Can someone direct me how to use EPPlus with a template. &lt;br&gt;
&lt;br&gt;
I was wondering if it is possible to have a ready excel file all I need is to replace the content in a cell or a merged cell.
&lt;br&gt;
&lt;br&gt;
For example I have something like this&lt;br&gt;
&lt;pre&gt;&lt;code&gt;using (var range = ws.Cells["A1:G3"]){
     range.Merge = true;
     range.Value = "Jhony Ded";
}&lt;/code&gt;&lt;/pre&gt;
Right now its static and I need to merge a lot of cells, which is a requirement for the project.
&lt;br&gt;
&lt;br&gt;
Is it possible that I do not have to do the merge thing if I have a ready Excel file? How do I add static data for now to an excel file.
&lt;br&gt;
&lt;br&gt;
I'm not even sure if I make any sense.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to hide a comment?">
      <Posts>
        <Post From="Moartl17" When="04/03/2015 15:23:25">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi guys, &lt;br&gt;
&lt;br&gt;
I am creating an Excel Sheet with a comment. I would like the comment to be hidden from the beginning, but after opening the file the comment is displayed until I do move the mouse cursor over it. When I leave the focus of the comment it behaves like expected
 and disappears. &lt;br&gt;
But I would need that from the very beginning. &lt;br&gt;
Here is a short sample I wrote in order to test this behavior: &lt;br&gt;
&lt;br&gt;
ExcelPackage package = new ExcelPackage();&lt;br&gt;
&lt;pre&gt;&lt;code&gt;        ExcelWorksheet mainExcelWorksheet = package.Workbook.Worksheets.Add("Sheet1");

        var comment = mainExcelWorksheet.Cells[10, 10].AddComment("This is my comment.", "Author");
        comment.Visible = false;

        using (FileStream fs = new FileStream("D:\\temp\\ExcelTest.xlsx", FileMode.Create))
            package.SaveAs(fs);
&lt;/code&gt;&lt;/pre&gt;
Any ideas? &lt;br&gt;
&lt;br&gt;
Much appreciated, &lt;br&gt;
Thanks, &lt;br&gt;
Martin&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="AaronCuff" When="17/03/2015 21:44:07">
          <Html>
        &lt;div class="markDownOutput "&gt;I'm having the exact some problem. I'm working from a template that has some comments on it to begin with. The comments that exist on my template (which all have Visible set to false) are hidden when the generated excel sheet is created. The new comments
 I create (while setting their Visible property to false) are always visible when opening the generated excel sheet.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How generate excel for this customized report?">
      <Posts>
        <Post From="ACUBE" When="15/03/2015 04:28:53">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello &lt;br&gt;
&lt;br&gt;
I have created a table(attendance_details) for storing every day attendance of Students in MySQL. Need to capture attendance for hourly(1-8hrs) for every day. I have the student details in separate table(Student_details). As of now fields created in attendance_details
 are attendance_No(Foreign_key) which is primary key in student_details table, Date, hour1, hour2, hour3, hour4, hour5, hour6, hour7, hour8. i need the report for each day attendance based on hours of a all students in a class for every month? Front end is
 C#. Also need to keep track of every hour attendance, can you help me in this in which the excel should generate report as below. Any help in this regard will be appreciated.
&lt;br&gt;
&lt;br&gt;
&lt;a href="http://dba.stackexchange.com/questions/94489/table-design-for-student-attendance-hourly-for-each-day" rel="nofollow"&gt;For IMAGE of Excel Report format and MySQL db fields click the link&lt;/a&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Calculate() throws error : Circular reference">
      <Posts>
        <Post From="prashantyadav" When="06/03/2015 09:12:25">
          <Html>
        &lt;div class="markDownOutput "&gt;HI, Have a sheet which have lot of formulas. When I invoke calculate on sheet or on particular cell I get Circular reference error.
&lt;br&gt;
But formulas does not have circular reference. &lt;br&gt;
&lt;br&gt;
Formula with Cell AJ19: &lt;br&gt;
=IF(ROWS(AJ$18:AJ19)=2,R19,IF(AI19=0,AJ18+R19-(G20="")&lt;em&gt;SUM(AF:AF),MAX(AJ18-AI19-(G20="")&lt;/em&gt;SUM(AF:AF),0)))
&lt;br&gt;
&lt;br&gt;
Please help.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="prashantyadav" When="06/03/2015 10:19:43">
          <Html>
        &lt;div class="markDownOutput "&gt;[Edited : Corrected]Downloaded the Code and figured out that ROWS function is causing the issue as it is referring same range.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="08/03/2015 07:10:35">
          <Html>
        &lt;div class="markDownOutput "&gt;You can try to set the property AllowCircularReference to true in ExcelCalculationOption (there are overloads on the Calculate methods that accepts this class as an argument).
&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="prashantyadav" When="08/03/2015 15:39:58">
          <Html>
        &lt;div class="markDownOutput "&gt;I tried with that, but it fails at this point. &lt;br&gt;
&lt;pre&gt;&lt;code&gt;
if (adr.WorkSheet == null &amp;amp;&amp;amp; adr.Collide(new ExcelAddressBase(f.Row, f.Column, f.Row, f.Column))!=ExcelAddressBase.eAddressCollition.No)
                    {
                        throw (new CircularReferenceException(string.Format("Circular Reference in cell {0}", ExcelAddressBase.GetAddress(f.Row, f.Column))));
                    }&lt;/code&gt;&lt;/pre&gt;
anyway I solved by updating my formula with sheet. and Have other issue and is quite starnge . Is there way I can send you my excel to have a look ?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="13/03/2015 15:35:00">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, yes you can create an issue here on codeplex and attach your workbook to that issue.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="DGET function">
      <Posts>
        <Post From="sonic_one" When="09/03/2015 08:19:21">
          <Html>
        &lt;div class="markDownOutput "&gt;We recently tested EPPlus and it's perfect for our project - Thanks! &lt;br&gt;
&lt;br&gt;
However there is one thing (really only one!) that is missing, and it's support of DGET function.
&lt;br&gt;
&lt;br&gt;
We succeeded in using VLOOKUP instead but it's not "classic" and since we have lots of excels that uses DGET, it's critical.
&lt;br&gt;
&lt;br&gt;
Can you please guide me how to add this? I didn't really get it from the docs... &lt;br&gt;
&lt;br&gt;
We use EPPlus on a web-app if this changes anything. &lt;br&gt;
&lt;br&gt;
Alternately, If it's a reasonable task that you guys can add for reasonable fee, this may be good solution for us!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="13/03/2015 15:34:15">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
you can add custom functions to the formula parser in runtime. Just inherit the class ExcelFunction and implement the function in c# code. Custom functions are added to the parser via Workbook.FormulaParserManager. You can see in the sample project (see the
 downloads section) how this can be done.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Tables are underlined">
      <Posts>
        <Post From="dixus" When="12/03/2015 16:59:58">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello,&lt;br&gt;
&lt;br&gt;
i am giving up my "investigation" and hope somebody can help me with my issue. I am using following statement to export a datatable to an excel template:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;wsDataSheet.Cells["B10"].LoadFromDataTable(data, true, TableStyles.Light15);&lt;/code&gt;&lt;/pre&gt;
The export works perfectly for empty excel templates. But as soon you are using an excel file that contains "links to other sheets" all table content is
&lt;strong&gt;underlined&lt;/strong&gt;.&lt;br&gt;
&lt;br&gt;
In the export excel it is not possibly to remove the underlines (they are also not marked as underlined in the font styles toolbar). Also it is not possible to remove them using the font style options.&lt;br&gt;
&lt;br&gt;
I tried setting the font style in excel excplicit for each cell but that had no effect. The underlined text stays. So my question is: How do I get rid of that underlined export output using TableStyles? If i dont export as Table (without giving a style) nothing
 is underlined. But that's not what I need..&lt;br&gt;
&lt;br&gt;
&lt;a href="http://kreissl.info/underlinedExport.xlsx" rel="nofollow"&gt;Here&lt;/a&gt; you can download an example output.&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Thanks and best regards&lt;br&gt;
Holger&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="dixus" When="13/03/2015 14:04:25">
          <Html>
        &lt;div class="markDownOutput "&gt;UPDATE:&lt;br&gt;
&lt;br&gt;
The issue occurs if you are using an existing excelfile with internal links to other sheets.&lt;br&gt;
&lt;br&gt;
It is reproducable. As soon as you are filling an excel file that contains a link to another sheet, the exported table's content will is underlined.&lt;br&gt;
&lt;br&gt;
I am not sure if this is an issue of epplus or excel, but it is an issue definetely.&lt;br&gt;
&lt;br&gt;
Does anyone has a workaround for this issue?&lt;br&gt;
&lt;br&gt;
Regards&lt;br&gt;
Holger&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Error using both RepeatColumns and RepeatRows">
      <Posts>
        <Post From="pnewport" When="17/10/2013 04:13:56">
          <Html>
        &lt;div class="markDownOutput "&gt;I'm getting an issue when I add both of these into a workbook, but either on their own works fine.&lt;br&gt;
&lt;pre&gt;&lt;code&gt; worksheet.PrinterSettings.RepeatColumns = new ExcelAddress("A:B"); 
 worksheet.PrinterSettings.RepeatRows = new ExcelAddress("1:1"); &lt;/code&gt;&lt;/pre&gt;
Comment out either line and it works fine, but if you leave them both in, I get an error message from Excel:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;Print titles must be contiguous and complete rows or columns.&lt;/code&gt;&lt;/pre&gt;
Anyone encounter this before?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Dukeman" When="18/10/2013 20:04:31">
          <Html>
        &lt;div class="markDownOutput "&gt;I've encoutered the same problem. &lt;br&gt;
&lt;br&gt;
When looking into the XML files (workbook.xml) I see the following line for the Titles:
&lt;br&gt;
&amp;lt;definedName name="_xlnm.Print_Titles" localSheetId="0"&amp;gt;'Inventory'!$1:$2,'Inventory'!$A:$G,'Inventory'!$1:$2&amp;lt;/definedName&amp;gt;
&lt;br&gt;
&lt;br&gt;
When opening the document in Excel I receive the error message above. &lt;br&gt;
&lt;br&gt;
After setting the titles in Excel again for this file, saving the file and looking into the XML files again, the line has been changed to:
&lt;br&gt;
&amp;lt;definedName name="_xlnm.Print_Titles" localSheetId="0"&amp;gt;Inventory!$A:$G,Inventory!$1:$2&amp;lt;/definedName&amp;gt;
&lt;br&gt;
&lt;br&gt;
The error is (somehow) caused because the rows are double added. &lt;br&gt;
&lt;br&gt;
I've not been able to debug code so far, but it somehow adds the rows again. &lt;br&gt;
&lt;br&gt;
This is the code I've been using for adding the Titles (it's the code from the sample code):
&lt;br&gt;
&lt;br&gt;
worksheet.PrinterSettings.RepeatRows = worksheet.Cells["1:2"]; &lt;br&gt;
worksheet.PrinterSettings.RepeatColumns = worksheet.Cells["A:G"];&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="ma7tz" When="12/03/2014 15:28:43">
          <Html>
        &lt;div class="markDownOutput "&gt;I have the same problem. It seems to be a problem with the setters. This unit test fails but should not, right?&lt;br&gt;
&lt;pre&gt;&lt;code&gt;    [TestMethod]
    public void TestRepeatRowsAndColumnsTest()
    {
        var p = new ExcelPackage();

        var w = p.Workbook.Worksheets.Add("RepeatRowsAndColumnsTest");

        w.PrinterSettings.RepeatColumns = new ExcelAddress("A:A");
        w.PrinterSettings.RepeatRows = new ExcelAddress("1:1");

        Assert.IsNotNull(w.PrinterSettings.RepeatColumns);
        Assert.IsNotNull(w.PrinterSettings.RepeatRows); // Fails!
    }
&lt;/code&gt;&lt;/pre&gt;
I use EPPlus in version 3.1.3.0.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="scda0001" When="19/09/2014 12:59:25">
          <Html>
        &lt;div class="markDownOutput "&gt;I have the same problem. Cannot set both at the same time with EPPlus. &lt;br&gt;
I use EPPlus 3.1.3.0 too. &lt;br&gt;
&lt;br&gt;
Any hope that this will be fixed. &lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Regards &lt;br&gt;
Daniel&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="ma7tz" When="19/09/2014 13:58:16">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi Daniel, &lt;br&gt;
&lt;br&gt;
in 4.0.0 it works. Even if it's called beta it is stable enough for me until now. Don't know, if it is an option for you, too.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="scda0001" When="20/09/2014 10:20:06">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
I tried 4.0.0 Beta and using both RepeatedColumns and RepeatedRows at the same time works.
&lt;br&gt;
But now I found this Bug in 4.0.0: &lt;a href="https://epplus.codeplex.com/workitem/14991" rel="nofollow"&gt;
https://epplus.codeplex.com/workitem/14991&lt;/a&gt; &lt;br&gt;
&lt;br&gt;
Is there any expected time frame for a RTM version of 4.0.0? &lt;br&gt;
&lt;br&gt;
Regards, &lt;br&gt;
Daniel&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="grimmdp" When="12/03/2015 18:41:06">
          <Html>
        &lt;div class="markDownOutput "&gt;Another workaround is to revert to 3.1.2, as this is working in that build&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Column exists function">
      <Posts>
        <Post From="amigoface" When="12/03/2015 16:42:42">
          <Html>
        &lt;div class="markDownOutput "&gt;hi, &lt;br&gt;
&lt;br&gt;
is there a way to determine if a column exists based on name , &lt;br&gt;
something like &lt;strong&gt;Findcolumn&lt;/strong&gt; or &lt;strong&gt;columnexists&lt;/strong&gt; ? &lt;br&gt;
&lt;br&gt;
thanks&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Does Epplus support excel 2013">
      <Posts>
        <Post From="shivadass" When="12/03/2015 07:11:41">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi ,&lt;br&gt;
Iam facing problem while reading data from an excel sheet in which the cell value was read as 0.5 instead of 50% and for another cell its reading correctly .Iam using excel 2013.&lt;br&gt;
&lt;br&gt;
Regards&lt;br&gt;
Shivadass&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="LoadFromDataTable and Formulas">
      <Posts>
        <Post From="jderouse" When="11/03/2015 21:45:50">
          <Html>
        &lt;div class="markDownOutput "&gt;After upgrading from version 3.1.xx I noticed the hyperlinks I was creating in stored procedures were no longer showing as hyperlinks but as plain text. So I add the if .. Set_Formula in ExcelRangeBase.LoadFromDataTable. It seems easy enough but I am curious
 if there is a reason you haven't done this? I know you have a lot more test cases then I do so I figured you might have a reason why this shouldn't be done.
&lt;br&gt;
&lt;br&gt;
Thanks for all your hard work on this tool, it is very helpful..&lt;br&gt;
&lt;pre&gt;&lt;code&gt;                if (value != null &amp;amp;&amp;amp; value != DBNull.Value &amp;amp;&amp;amp; !string.IsNullOrEmpty(value.ToString()))
                {
                           if (value.ToString().StartsWith("="))
                    {
                        Set_Formula(value, row, col++);
                    }
                    else
                    {
                        _worksheet._values.SetValue(row, col++, value);
                    }
                }
                else
                {
                    col++;
                }&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Trouble with ExcelPivotTableField.AddDateGrouping when some dates are blank">
      <Posts>
        <Post From="mingot" When="11/03/2015 15:55:49">
          <Html>
        &lt;div class="markDownOutput "&gt;I am having trouble using ExcelPivotTableField.AddDateGrouping when some of the dates in my spreadsheet are blank. When use the date grouping it "just doesn't work". No error, but no grouping is done at all.
&lt;br&gt;
&lt;br&gt;
I have determined that this only happens when there are blank fields. &lt;br&gt;
&lt;br&gt;
Any ideas on how to work around?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Load From Remote sources, EPPlus 4.0.3">
      <Posts>
        <Post From="AndersWithKaas" When="10/03/2015 21:14:43">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi &lt;br&gt;
I have downloaded the EPPlus 4.0.3 to create an Excel fil, but I, who is a beginner :- ) get the warning Loadfromremotesources......, then I have two questions
&lt;br&gt;
1) What do I do to avoid the warning ? and &lt;br&gt;
2) What is my program trying to load from a remote source ? ;-) &lt;br&gt;
&lt;br&gt;
Regards &lt;br&gt;
Anders&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="The type initializer for 'MS.Utility.EventTrace' threw an exception.">
      <Posts>
        <Post From="jonathangraci" When="10/03/2015 15:56:28">
          <Html>
        &lt;div class="markDownOutput "&gt;Good Morning &lt;br&gt;
&lt;br&gt;
I created a class library that uses EPPlus.dll. &lt;br&gt;
If the call from a console application works correctly. &lt;br&gt;
&lt;br&gt;
This library I have to call from an asp page. When the call me the following error:
&lt;br&gt;
&lt;br&gt;
The type initializer for 'MS.Utility.EventTrace' threw an exception. &lt;br&gt;
Requested registry access is not allowed. &lt;br&gt;
&lt;br&gt;
I searched the internet but have not found the solution to my problem. &lt;br&gt;
Can you help? &lt;br&gt;
&lt;br&gt;
Thank You.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Dropdownlist with checkboxes">
      <Posts>
        <Post From="tjanssens" When="10/03/2015 12:25:36">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
Is it possible to setup a Cell as an dropdown with different options to chose from?
&lt;br&gt;
The value after the selection should be a comma separated list. &lt;br&gt;
Example: &lt;br&gt;
&lt;img alt="Image" src="https://docs.google.com/uc?authuser=1&amp;amp;id=0Bz514uZ4OCt1aURtQUFQbXlTdk0&amp;amp;export=download"&gt;
&lt;br&gt;
&lt;br&gt;
Thank you, &lt;br&gt;
Tom&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Write causes warning that the file is corrupt when trying to open it in Excel">
      <Posts>
        <Post From="imran7799" When="09/03/2015 17:03:53">
          <Html>
        &lt;div class="markDownOutput "&gt;I am trying to generate the Simple Excel file using the plugin in ASP.Net with following Code.
&lt;br&gt;
&lt;br&gt;
The file gets generated successfully, however, after downloading when user open the file it gets a warning message indicating the file is corrupt, do you want excel to fix it ? How do I remove this message ? Below is my code.
&lt;br&gt;
&lt;br&gt;
private void CreateExcel()&lt;br&gt;
&lt;pre&gt;&lt;code&gt;    {
        using (pck = new ExcelPackage())
        {
            MemoryStream memory = new MemoryStream();

            String tmpFile = Path.GetTempFileName();
            FileStream liveStream = new FileStream(tmpFile, FileMode.Create, FileAccess.ReadWrite);

            pck.Load(liveStream);
            //Create the worksheet
            ExcelWorksheet ws = pck.Workbook.Worksheets.Add("Log");

            ws.Cells["A1"].Value = "Test";

            //Write it back to the client
            Response.ContentType = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";
            Response.AddHeader("content-disposition", "attachment;  filename=ExcelDemo.xlsx");
            Response.BinaryWrite(pck.GetAsByteArray());
        }
    }


&lt;/code&gt;&lt;/pre&gt;
When I checked the details of the fix that Excel is performing, I found below XML
&lt;br&gt;
&lt;br&gt;
&amp;lt;?xml version="1.0" encoding="UTF-8" standalone="true"?&amp;gt;
&lt;br&gt;
-&amp;lt;recoveryLog xmlns="&lt;a href='http://schemas.openxmlformats.org/spreadsheetml/2006/main"&gt;&lt;logFileName&gt;error036720_01.xml&lt;/logFileName&gt;&lt;summary&gt;Errors' rel="nofollow"&gt;http://schemas.openxmlformats.org/spreadsheetml/2006/main"&amp;gt;&amp;lt;logFileName&amp;gt;error036720_01.xml&amp;lt;/logFileName&amp;gt;&amp;lt;summary&amp;gt;Errors&lt;/a&gt;
 were detected in file 'C:\Users\ipatel\Downloads\ExcelDemo (1).xlsx'&amp;lt;/summary&amp;gt;-&amp;lt;additionalInfo&amp;gt;&amp;lt;info&amp;gt;Excel completed file level validation and repair. Some parts of this workbook may have been repaired or discarded.&amp;lt;/info&amp;gt;&amp;lt;/additionalInfo&amp;gt;&amp;lt;/recoveryLog&amp;gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="09/03/2015 17:12:46">
          <Html>
        &lt;div class="markDownOutput "&gt;Please, take a look at this thread and tell us if it work &lt;br&gt;
&lt;br&gt;
&lt;a href="http://epplus.codeplex.com/discussions/223843" rel="nofollow"&gt;http://epplus.codeplex.com/discussions/223843&lt;/a&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="imran7799" When="09/03/2015 17:54:33">
          <Html>
        &lt;div class="markDownOutput "&gt;It works perfectly!!!!! &lt;br&gt;
&lt;br&gt;
Thank you very much for a quick response.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="imran7799" When="09/03/2015 17:55:25">
          <Html>
        &lt;div class="markDownOutput "&gt;Just copying the answer from the suggested thread. &lt;br&gt;
&lt;br&gt;
Call response.clear before send stream back to client.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;                Response.Clear();
                Response.AddHeader("content-disposition", "attachment;  filename=file.xlsx");
                Response.ContentType = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";                    
                Response.BinaryWrite(pck.GetAsByteArray());
                Response.End();&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Read From Excel">
      <Posts>
        <Post From="Ali_b" When="03/03/2015 07:07:33">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi. &lt;br&gt;
I use asp.net and I want to read from excel and insert into Database. &lt;br&gt;
My .xlsx file has several sheets and I want to read from an special sheet. &lt;br&gt;
All of cells in this sheet contains Formula. &lt;br&gt;
When I read from This, some cells return #VALUE! instead of value.(ex: #VALUE! instead of 0.456)
&lt;br&gt;
What is the problem? What should I do? &lt;br&gt;
Thanks&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="prashantyadav" When="06/03/2015 09:13:58">
          <Html>
        &lt;div class="markDownOutput "&gt;did you try to invoke Calculate() function on sheet?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Ali_b" When="07/03/2015 04:57:19">
          <Html>
        &lt;div class="markDownOutput "&gt;yes.&lt;br&gt;
I found an Error.&lt;br&gt;
I think it may be a bug.&lt;br&gt;
it can not calculate some formula for example COUNTIF()&lt;br&gt;
I change this formula to SUM() and it worked correctly&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="prashantyadav" When="08/03/2015 15:44:13">
          <Html>
        &lt;div class="markDownOutput "&gt;please check documentation for the formulas which are implemented. it will help you.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to save excel worksheet to html">
      <Posts>
        <Post From="shivadass" When="05/03/2015 18:25:47">
          <Html>
        &lt;div class="markDownOutput "&gt;hi Guys, &lt;br&gt;
&lt;br&gt;
Is it possible to convert excel worksheet to html...&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="05/03/2015 18:38:09">
          <Html>
        &lt;div class="markDownOutput "&gt;EPPlus doesn't have any built-in method to do this, but if you want a simple online sheet it's very simple, just go through all cells and generate rows and cells. If you need to convert styles to css class it will be a little more tricky.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to Save excel file as Html using Epplus">
      <Posts>
        <Post From="shivadass" When="05/03/2015 18:26:58">
          <Html>
        &lt;div class="markDownOutput "&gt;HI Guys &lt;br&gt;
&lt;br&gt;
Can anyone How to Save excel file as Html using Epplus&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Cell date validation and format">
      <Posts>
        <Post From="uhcnamufpy" When="05/03/2015 18:08:02">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, can someone help me? I want to make certain cells to take only date, and in this format dd/MM/yyyy this is my code now
&lt;br&gt;
&lt;br&gt;
int columnNumber = worksheet.Cells[nroPreguntas, i].Start.Column; &lt;br&gt;
&lt;br&gt;
string cell = getColumnLetter(columnNumber ) +Convert.ToString(nQuestions); &lt;br&gt;
&lt;br&gt;
var validation = worksheet.Cells[cell].DataValidation.AddDateTimeDataValidation();
&lt;br&gt;
validation.ShowErrorMessage = true; &lt;br&gt;
validation.ErrorStyle = ExcelDataValidationWarningStyle.stop; &lt;br&gt;
validation.Error = "invalid date"; &lt;br&gt;
validation.ShowInputMessage = true; &lt;br&gt;
validation.Prompt = "insert date here"; &lt;br&gt;
validation.Operator = ExcelDataValidationOperator.greaterThan; &lt;br&gt;
worksheet.Cells[celda].Style.Numberformat.Format = "dd/MM/yyyy"; &lt;br&gt;
validation.Formula.Value = DateTime.Now.Date; &lt;br&gt;
&lt;br&gt;
for now, it only takes dates, but in MM/dd/yyyy format, &lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="EPPlus and Unity3D">
      <Posts>
        <Post From="mickwa" When="04/03/2015 23:45:23">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello, &lt;br&gt;
I'm trying to display xlsx file in Unity3D. &lt;br&gt;
is EPPlus compatible with Unity3D? &lt;br&gt;
I have an issues while draging dll to Assets directory: &lt;br&gt;
&lt;br&gt;
Internal compiler error. See the console log for more information. output was: &lt;br&gt;
Unhandled Exception: System.Reflection.ReflectionTypeLoadException: The classes in the module cannot be loaded.
&lt;br&gt;
&lt;br&gt;
at (wrapper managed-to-native) System.Reflection.Assembly:GetTypes (bool) &lt;br&gt;
&lt;br&gt;
at System.Reflection.Assembly.GetTypes () [0x00000] in &amp;lt;filename unknown&amp;gt;:0
&lt;br&gt;
&lt;br&gt;
at Mono.CSharp.RootNamespace.ComputeNamespaces (System.Reflection.Assembly assembly, System.Type extensionType) [0x00000] in &amp;lt;filename unknown&amp;gt;:0
&lt;br&gt;
&lt;br&gt;
at Mono.CSharp.RootNamespace.ComputeNamespace (Mono.CSharp.CompilerContext ctx, System.Type extensionType) [0x00000] in &amp;lt;filename unknown&amp;gt;:0
&lt;br&gt;
&lt;br&gt;
at Mono.CSharp.GlobalRootNamespace.ComputeNamespaces (Mono.CSharp.CompilerContext ctx) [0x00000] in &amp;lt;filename unknown&amp;gt;:0
&lt;br&gt;
at Mono.CSharp.Driver.LoadReferences () [0x00000] in &amp;lt;filename unknown&amp;gt;:0 &lt;br&gt;
at Mono.CSharp.Driver.Compile () [0x00000] in &amp;lt;filename unknown&amp;gt;:0 &lt;br&gt;
at Mono.CSharp.Driver.Main (System.String[] args) [0x00000] in &amp;lt;filename unknown&amp;gt;:0
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Any ideas how can I use this dll with Unity3D?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Remove autofilter in Table">
      <Posts>
        <Post From="Phinehas" When="14/02/2013 08:43:53">
          <Html>
        &lt;div class="markDownOutput "&gt;I set a range as a Table "Test". But, when I set it, the table header shows autofilter. Can I remove autofilter from a table header? Or, can I disable it when adding a new table?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="xav2075" When="14/02/2013 23:28:02">
          <Html>
        &lt;div class="markDownOutput "&gt;This code will create a table and remove the autofilter:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;      ExcelRange range1 = excel_worksheet_1.Cells["A1:B20"]; 
      ExcelTable table1 = excel_worksheet_1.Tables.Add(range1, "table1"); 
      table1.TableStyle = OfficeOpenXml.Table.TableStyles.Light1; 
      table1.ShowFilter = false;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Phinehas" When="15/02/2013 00:44:34">
          <Html>
        &lt;div class="markDownOutput "&gt;I have tried but fail to remove the autofilter. &lt;br&gt;
&lt;br&gt;
My coding is the following:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;            ws.Tables.Add(range, "Data");
            ws.Tables[0].TableStyle= OfficeOpenXml.Table.TableStyles.None;
            ws.Tables[0].ShowHeader = true;
            ws.Tables[0].ShowTotal = false;
            ws.Tables[0].ShowFilter = false;&lt;/code&gt;&lt;/pre&gt;
Is there any other settings are required for remove table autofilter?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="xav2075" When="15/02/2013 04:04:04">
          <Html>
        &lt;div class="markDownOutput "&gt;I did this code which does give a table with a given color scheme and autofilters are off:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;      excel_worksheet_1.Tables.Add(range_2, "table1");
      excel_worksheet_1.Tables[0].TableStyle = OfficeOpenXml.Table.TableStyles.Medium1;
      excel_worksheet_1.Tables[0].ShowHeader = true;
      excel_worksheet_1.Tables[0].ShowTotal = false;
      excel_worksheet_1.Tables[0].ShowFilter = false;&lt;/code&gt;&lt;/pre&gt;
Btw TableStyles.None visibly at least produces no visual table.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Phinehas" When="15/02/2013 05:32:52">
          <Html>
        &lt;div class="markDownOutput "&gt;Thanks. &lt;br&gt;
After some checking, I find this work. However, when I add TotalRowFunctions, the autofilter will appear. How can I stop it?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="paulgostelow" When="02/03/2015 20:24:51">
          <Html>
        &lt;div class="markDownOutput "&gt;Try this extension method. Works with v4.0.3&lt;br&gt;
&lt;pre&gt;&lt;code&gt;        public static void SetStyle(this ExcelWorksheet sheet, OfficeOpenXml.Table.TableStyles style)
        {
            var range = sheet.Cells[1, 1, sheet.Dimension.Rows + 1, sheet.Dimension.Columns];
            var table = sheet.Tables.Add(range, sheet.Name);
            table.TableStyle = style;
            table.ShowFilter = false;
        }&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Issue with case sensitive">
      <Posts>
        <Post From="mendel129" When="02/03/2015 16:33:41">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi! &lt;br&gt;
&lt;br&gt;
Today I spend some time trying to import multiple csv-files into a single excel with multiple worksheets.
&lt;br&gt;
I was using "$Worksheet.Cells.LoadFromText" for this. &lt;br&gt;
I had the issue EPPlus wouldn't save the file. The Following error popped up (using powershell btw)&lt;br&gt;
&lt;pre&gt;&lt;code&gt;Exception calling "SaveAs" with "1" argument(s): "Error saving file filename.xlsx"
At .\create-excel.ps1:102 char:1
+ $ExcelPackage.SaveAs($FileNameExcel)
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: (:) [], MethodInvocationException
    + FullyQualifiedErrorId : InvalidOperationException
&lt;/code&gt;&lt;/pre&gt;
In the end, this was caused by having a "True" value in the csv... Replacing all "True" with "TRUE" solved the issue...&lt;br&gt;
&lt;pre&gt;&lt;code&gt;"FALSE";"TRUE";"True"
replaced by
"FALSE";"TRUE";"TRUE"&lt;/code&gt;&lt;/pre&gt;
Any idea how this can can happen? Or is their a solution/workaround for this?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Workbook.Worksheets.Count == 0">
      <Posts>
        <Post From="virzak" When="27/02/2015 21:36:19">
          <Html>
        &lt;div class="markDownOutput "&gt;Can anyone advise why I can't see any worksheets when there is 1 sheet? &lt;br&gt;
&lt;br&gt;
&lt;a href="https://www.dropbox.com/s/t5qvpnp80y3vrdt/nosheets.xlsx?dl=0" rel="nofollow"&gt;https://www.dropbox.com/s/t5qvpnp80y3vrdt/nosheets.xlsx?dl=0&lt;/a&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="EPPLus With Classic ASP">
      <Posts>
        <Post From="ScottPendleton" When="24/12/2014 14:39:35">
          <Html>
        &lt;div class="markDownOutput "&gt;I want to use EPPLus with Classic ASP, like so: &lt;br&gt;
&lt;br&gt;
Server.CreateObject("EPPlus.Application") &lt;br&gt;
&lt;br&gt;
To do this, I need to register the dll. But using regsvr32 fails. &lt;br&gt;
&lt;br&gt;
Is this impossible? Can EPPlus only be used with ASP.Net?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="27/12/2014 09:28:29">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
EPPlus does not have a COM interface, so you can not register it using regsvr32 or call it from Classic ASP.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="ScottPendleton" When="27/12/2014 14:10:12">
          <Html>
        &lt;div class="markDownOutput "&gt;It turns out to be easy to reference EPPlus in a C# project that serves as a COM wrapper.
&lt;br&gt;
&lt;br&gt;
However, perhaps it is wiser to have an ASP Web site that uses a single ASPX (ASP.Net) page to communicate with EPPlus?
&lt;br&gt;
&lt;br&gt;
Also, if I want to run a script on my Windows 2008 RS server as a scheduled task, is there a way to have that script communicate directly with EPPlus?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="jainmanis" When="27/02/2015 14:47:15">
          <Html>
        &lt;div class="markDownOutput "&gt;Did you made it working using COM wrapper?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="ScottPendleton" When="27/02/2015 17:05:43">
          <Html>
        &lt;div class="markDownOutput "&gt;Yes, I created a C# DLL to be a COM wrapper that I called ExcelReport. &lt;br&gt;
&lt;br&gt;
It has two public methods, one for getting data from MS Access and one for SQL Server. I pass it the connection string and the location of a spreadsheet to populate with data. The COM object then e-mails the spreadsheet to a list of people.
&lt;br&gt;
&lt;br&gt;
I wrote a VB script in which this is the key line:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;sAttachment = oExcelReport.Make5SReportSQL(strDest, strSQLConn)&lt;/code&gt;&lt;/pre&gt;
The VB script makes a copy of a template spreadsheet that has formatting and tabs but no data. The location of that copy is passed in to the COM object's method.
&lt;br&gt;
&lt;br&gt;
A scheduled task calls the VB script using the following command:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;C:\Windows\SysWOW64\cscript.exe "Drive:\\My\Script\Location\ScriptName.vbs"&lt;/code&gt;&lt;/pre&gt;
So, to reiterate: &lt;br&gt;
&lt;ol&gt;
&lt;li&gt;The Windows task scheduler calls cscript. (This addresses 32/64 bit issues.) &lt;/li&gt;&lt;li&gt;Cscript launches the VB script. &lt;/li&gt;&lt;li&gt;The script copies the template, creates the COM object, and then passes the copy location.
&lt;/li&gt;&lt;li&gt;The COM object uses EPPlus to put data into the copied template and then uses C# to e-mail the copy as an attachment.&lt;br&gt;
&lt;/li&gt;&lt;/ol&gt;
Scott&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Support for classic ASP">
      <Posts>
        <Post From="jainmanis" When="27/02/2015 14:43:54">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
Is there any way to use EPPlus in classic ASP? &lt;br&gt;
&lt;br&gt;
Regards, &lt;br&gt;
Manish&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Recalculating Worksheets on Save Problem">
      <Posts>
        <Post From="dcernosia" When="26/02/2015 16:58:02">
          <Html>
        &lt;div class="markDownOutput "&gt;I am having problems getting the Calculate() function to work in EEPlus.&lt;br&gt;
&lt;br&gt;
Basically, I have an Excel file with multiple worksheets ... Sheet1 has the data, and Sheet2 is a summary page with the formulas and calculations.&lt;br&gt;
&lt;br&gt;
After populating the data in Sheet1 with EEPlus, I am trying to trigger the formulas on Sheet2 to recalculate before I save, but nothing is happening. This is the code I am using to calculate.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;                pck.Workbook.CalcMode = ExcelCalcMode.Automatic;
                var ExcelWS2 = pck.Workbook.Worksheets["Summary"];
                ExcelWS2.Calculate();&lt;/code&gt;&lt;/pre&gt;
I tried to trigger the Calculate function on the workbook, but it hangs ... example:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;                pck.Workbook.Calculate();&lt;/code&gt;&lt;/pre&gt;
I really am stumped ... any help would be appreciated.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Need help, I'm struggling with pivot creation">
      <Posts>
        <Post From="ThomasBraun66" When="26/02/2015 15:11:39">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
I'm new to EPPlus and already managed to create simple Excel tables. &lt;br&gt;
&lt;br&gt;
But now I'm struggling with creating a pivot table and need help. &lt;br&gt;
&lt;br&gt;
I'm importing data from a csv file into a table like this:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;while (csv.ReadNextRecord())
{
    ws.Cells[zeile,1].Value = csv[dheaders["Modul - Dokumentname"]];
    ws.Cells[zeile,3].Value = csv[dheaders["Leistungsart - Leistungsartenname"]];
    ws.Cells[zeile,5].Value = float.Parse(csv[dheaders["Anzahl"]]);
    ws.Cells[zeile,7].Value = float.Parse(csv[dheaders["Verkaufspreis"]]);
    ws.Cells[zeile,7].StyleName = "EuroAmount";
    ws.Cells[zeile,8].Formula = string.Format("{0}*{1}", new ExcelAddress(zeile,5,zeile,5), new ExcelAddress(zeile,7,zeile,7));
    ws.Cells[zeile,8].StyleName = "EuroAmount";                     
    
    zeile++;
}&lt;/code&gt;&lt;/pre&gt;
Then I create the pivot like this:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;var dataRange = ws.Cells[ExcelRange.GetAddress(5,1,line,8)];

var pivotTable1 = wsPivot.PivotTables.Add(wsPivot.Cells["A1"], dataRange, "PerWorkstream");
pivotTable1.RowFields.Add(pivotTable1.Fields[0]);
pivotTable1.DataFields.Add(pivotTable1.Fields[7]);&lt;/code&gt;&lt;/pre&gt;
But this causes Excel (2013) to crash when I open the excel file. &lt;br&gt;
&lt;br&gt;
When I omit the last line the file can be opened, but the pivot does not show any
&lt;br&gt;
&lt;br&gt;
I would also like to know how to make the the datarange "named", so that the pivot can be properly updated when someone adds rows to the table in Excel.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Internal Packaging API">
      <Posts>
        <Post From="TorstenOhm" When="25/02/2015 19:53:53">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
first, this is a really great project. &lt;br&gt;
&lt;br&gt;
Most part of the new packaging API is made internal. Would it be possible to make it public?
&lt;br&gt;
&lt;br&gt;
So, it would be more easy to add a CustomXML part to Excel files in order to store additional data.
&lt;br&gt;
&lt;br&gt;
Thanks a lot &lt;br&gt;
&lt;br&gt;
Torsten&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Problem creating an ExcelPackage from a template: calculated columns are messed up.">
      <Posts>
        <Post From="ericjaviersaura" When="25/02/2015 15:44:32">
          <Html>
        &lt;div class="markDownOutput "&gt;&lt;a href="http://stackoverflow.com/questions/28722945/epplus-with-a-template-is-not-working-as-expected" rel="nofollow"&gt;I have added a question to stackoverflow about my problem.&lt;/a&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How do I get rid of the xmlns=&quot;&quot; in autoFilter/filterColumn?">
      <Posts>
        <Post From="JayAchTee" When="24/02/2015 17:00:59">
          <Html>
        &lt;div class="markDownOutput "&gt;I am creating an autoFilter and the saved XML looks like this:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;autoFilter ref="A1:E114"&amp;gt;
    &amp;lt;filterColumn colId="2" xmlns=""&amp;gt;
        &amp;lt;filters blank="1" /&amp;gt;
    &amp;lt;/filterColumn&amp;gt;
&amp;lt;/autoFilter&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
and the code used to create it:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;        XmlNamespaceManager ns = new XmlNamespaceManager(Parent.OwnerDocument.NameTable);

        XmlElement result = Parent.OwnerDocument.CreateElement(Name, ns.LookupNamespace(""));

        Parent.AppendChild(result);

        return (result);
&lt;/code&gt;&lt;/pre&gt;
where Parent is the autoFilter element from the WorksheetXml.SelectSingleNode("//d:autoFilter").
&lt;br&gt;
&lt;br&gt;
So, how do I get rid of the xmlns=""???&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="JayAchTee" When="24/02/2015 20:47:45">
          <Html>
        &lt;div class="markDownOutput "&gt;I figured it out.&lt;br&gt;
&lt;br&gt;
Drop the &lt;strong&gt;XmlNamespaceManager&lt;/strong&gt; as it is not needed. Add &lt;strong&gt;Parent.NamespaceURI&lt;/strong&gt; as the second parameter to
&lt;strong&gt;CreateElement&lt;/strong&gt; (...) and it workds.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="ExcelRange row height">
      <Posts>
        <Post From="memmo77" When="24/02/2015 14:56:59">
          <Html>
        &lt;div class="markDownOutput "&gt;When I do the merge of columns, how to set the row height if WrapText = true?
&lt;br&gt;
Thank You&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Set cell format to &quot;Date&quot;">
      <Posts>
        <Post From="jburkett" When="21/11/2012 16:42:51">
          <Html>
        
&lt;p&gt;This looks like a great library and really powerful. I have one &lt;span style="text-decoration: underline;"&gt;
requirement&lt;/span&gt;&amp;nbsp;for which I've seen a variety of work-arounds suggested, but no solution.&lt;/p&gt;
&lt;p&gt;When the end-user opens the workbook and navigates to the cell in question (say: E2), the formatting drop-down in the Number area of the ribbon
&lt;span style="text-decoration: underline;"&gt;must&lt;/span&gt;&amp;nbsp;say "Date", not "General" or "Custom".&lt;/p&gt;
&lt;p&gt;How do I do that?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="21/11/2012 17:15:26">
          <Html>
        
&lt;p&gt;There is a list of all ( I think so ) built-in number formats for OOXML here &amp;gt;&amp;nbsp;&lt;a href="http://polymathprogrammer.com/2011/02/15/built-in-styles-for-excel-open-xml/" rel="nofollow"&gt;http://polymathprogrammer.com/2011/02/15/built-in-styles-for-excel-open-xml/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Just set any of them. Ex.:&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;            FileInfo  arq = &lt;span style="color: blue;"&gt;new&lt;/span&gt; FileInfo(&lt;span style="color: rgb(163, 21, 21);"&gt;@"c:\test.xlsx"&lt;/span&gt;);

            &lt;span style="color: blue;"&gt;using&lt;/span&gt; (ExcelPackage p = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(arq))
            {

                &lt;span style="color: blue;"&gt;var&lt;/span&gt; ws = p.Workbook.Worksheets.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"w1"&lt;/span&gt;);

                ws.Cells[1,1].Value = DateTime.Now;
                ws.Cells[1, 1].Style.Numberformat.Format = &lt;span style="color: rgb(163, 21, 21);"&gt;"mm-dd-yy"&lt;/span&gt;;

                p.Save();
            
            }
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jburkett" When="21/11/2012 17:33:49">
          <Html>
        
&lt;p&gt;Thank you, kindly. I had not realized that would do the trick -- it sure looks like a hack. I just confirmed that that does, indeed, show up as "Date" in the resulting Excel sheet.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="CellBent" When="22/11/2012 12:39:26">
          <Html>
        
&lt;p&gt;Thank you for posting this list. of built-in Excel styles.&lt;/p&gt;
&lt;p&gt;I noticed that the Accounting format is not in this list, yet when I set the numberformat.format to the following string it does seem to match the Excel format for Accounting:&lt;/p&gt;
&lt;p&gt;_("$"* #,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00_);_("$"* \(#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00\);_("$"* "-"??_);_(@_)&lt;/p&gt;
&lt;p&gt;Reading his blog post, I wonder whether this will be available to users in other regions/localizations&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="22/11/2012 12:51:58">
          <Html>
        
&lt;p&gt;humm, I think all non custom styles are culture-variant. After run my example, when I opened it, Excel still displayed it as&amp;nbsp;"dd-MM-yyyy" (brazilian format).&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="AbdulJabbar" When="04/02/2014 12:36:10">
          <Html>
        &lt;div class="markDownOutput "&gt;Use this &lt;br&gt;
&lt;br&gt;
&lt;br&gt;
worksheet.Cells[1,1].Formula = "=Date(" +DateTime.Now + ")"; &lt;br&gt;
worksheet.Cells[1, 1].Style.Numberformat.Format = "mm-dd-yy";&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="PeterB" When="24/02/2015 04:14:10">
          <Html>
        &lt;div class="markDownOutput "&gt;If I'm using a reflected collection (e.g. via Worksheet::Cells.LoadFromCollection&amp;lt;T&amp;gt;), how do I specify the Date format for a column?
&lt;br&gt;
&lt;br&gt;
Or perhaps there's a way to specify a global format for all Date columns? e.g. yyyy-MM-dd.&lt;br&gt;
&lt;br&gt;
Thanks.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Illegal characters (XML) in WorkSheet sheet name">
      <Posts>
        <Post From="jengstro" When="23/02/2015 11:33:15">
          <Html>
        &lt;div class="markDownOutput "&gt;I wondered a loong time, why my Excel creation corrupted with multiple sheets.
&lt;br&gt;
The reason was illegal characters in sheet name. &lt;br&gt;
Maybe the EPPlus should just do the validation on given string or then brutally take out illegal characters of the given string.
&lt;br&gt;
&lt;br&gt;
// Replace invalid XML characters with empty strings. Dunno are these all illegal or full list.
&lt;br&gt;
sheetName=Regex.Replace(sheetName, @"[!@#$%_*]", ""); &lt;br&gt;
// Create a new sheet &lt;br&gt;
currentSheet=pck.Workbook.Worksheets.Add(sheetName);&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Need to read an open excel file">
      <Posts>
        <Post From="jvargh" When="20/02/2015 18:48:07">
          <Html>
        &lt;div class="markDownOutput "&gt;Is this possible to have EPPlus read an open XLSX and if so how? Currently it throws an exception 'process cannot access file used by another process'&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Remove gap between bars in Chart">
      <Posts>
        <Post From="syedatifimtiaz" When="17/04/2012 07:32:06">
          <Html>
        
&lt;p&gt;Hi Everyone,&lt;/p&gt;
&lt;p&gt;Is there any way we can remove the gap between the bars drawn on a chart?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="02/05/2012 18:54:49">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;No, not at the moment, unless you update the ChartXml yourself (or use a template). I think you meen the gapWidth element. I'll see if I can add it to the next version.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="brianestey17" When="20/02/2015 00:29:32">
          <Html>
        &lt;div class="markDownOutput "&gt;Has this been done? I can't seem to find it.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="syedatifimtiaz" When="20/02/2015 10:02:18">
          <Html>
        
&lt;div dir="ltr"&gt;
&lt;div style="font-family: tahoma,sans-serif;"&gt;​quite a long time ago i was working on this solution. not anymore :)​&lt;/div&gt;
&lt;/div&gt;
&lt;div&gt;&lt;br clear="all"&gt;
&lt;div&gt;
&lt;div&gt;
&lt;div&gt;&lt;span style="font-family: tahoma,sans-serif;"&gt;Regards,&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="tahoma, sans-serif"&gt;&lt;b&gt;Syed Atif Imtiaz&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;br&gt;
&lt;div&gt;&lt;/div&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Conditional Formatting in Pivot table">
      <Posts>
        <Post From="BorisPazin" When="19/02/2015 08:22:44">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
Please let me know if it is possible in EPPlus to do conditional formatting of pivot table?
&lt;br&gt;
&lt;br&gt;
I noticed there is an option to do conditional formatting of worksheet. &lt;br&gt;
&lt;br&gt;
But, is there a way to do conditional formatting of pivot table? &lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Thanks!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Protect a sheet from deleting columns">
      <Posts>
        <Post From="DisolverOfSouls" When="19/02/2015 07:50:06">
          <Html>
        &lt;div class="markDownOutput "&gt;I made a C# Windows Forms Application that creates an excel file. &lt;br&gt;
Depending on what fields the user selects in the form, the columns representing those fields are made visible, so that the user can start to fill in his data in the columns he needs.
&lt;br&gt;
This works fine, however users should not be able to delete columns ! &lt;br&gt;
If the order of columns is changed, the data from the user will not be converted correctly...&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Column width default units">
      <Posts>
        <Post From="rhoward99" When="18/02/2015 23:53:17">
          <Html>
        &lt;div class="markDownOutput "&gt;I have looked at the source code, and still cannot figure out what the defaults units are when setting a column width using the .Column(n).Width property.
&lt;br&gt;
&lt;br&gt;
Can anyone tell me what the units are? (cm, 1/72 in, etc.) &lt;br&gt;
&lt;br&gt;
Thanks! &lt;br&gt;
Rick&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Powershell Documentation">
      <Posts>
        <Post From="forensicsgyuy2001" When="18/02/2015 19:42:31">
          <Html>
        &lt;div class="markDownOutput "&gt;Been using the solution for a couple months now..wonderfull stuff...Just wondering if there could be some Powershell documentation...I have been able to produce very basic excel spreadsheets...based on TSQL outputs...
&lt;br&gt;
&lt;br&gt;
I would like to have some documentation on how to change the color of entire row based off the results of a field/cell...
&lt;br&gt;
&lt;br&gt;
I must be missing something...thank you for any help &lt;br&gt;
&lt;br&gt;
Keep up the good work... &lt;br&gt;
&lt;br&gt;
Thanks, &lt;br&gt;
Matt &lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="OutlineLevel troubles - some rows stay collapsed even if all surrounding rows in the same OutlineLevel are expanded">
      <Posts>
        <Post From="petrmach" When="18/02/2015 14:00:32">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi everyone.&lt;br&gt;
&lt;br&gt;
I have XLSX table (1 sheet) with some groups of rows, which are in 3 OutlineLevels. If I open table in Excel, everything is ok. But, immediately following the opening of this table in the .NET program (using EPPlus) are some rows collapsed and despite the fact
 that all the surrounding rows in the same OutlineLevel (the same group) are not collapsed. So that after some changes in the sheet and saving of the table in .NET program, these rows remain collapsed. Any ideas?&lt;br&gt;
&lt;br&gt;
I can send this table for testing, but I don't know how...&lt;br&gt;
&lt;br&gt;
Thanks.&lt;br&gt;
Peter&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="[4.0.3] VBA CurrentRegion equivalent">
      <Posts>
        <Post From="sudrahnreb" When="18/02/2015 13:53:30">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
since I'm new to EPPlus maybe I've missed something. I was looking for an equivalent to the CurrentRegion property as it exists in Excel VBA. I did not find something like that, so I coded it myself.
&lt;br&gt;
&lt;br&gt;
My question: Is there a property or a method like CurrentRegion? &lt;br&gt;
&lt;br&gt;
If not and if this is of interest I can upload the code (here?). &lt;br&gt;
&lt;br&gt;
Regards&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to use PieOfPie">
      <Posts>
        <Post From="Akemi" When="18/02/2015 10:02:26">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello all, &lt;br&gt;
I need to represent two groups of the same data in a unique graph, if possible. &lt;br&gt;
A pie (TOTAL_DATA) with a normal row (Item), column(Nr) data &lt;br&gt;
and another pie (GROUPED_DATA) with the same data grouped. &lt;br&gt;
&lt;br&gt;
TOTAL_DATA: &lt;br&gt;
Item ......................................... Nr &lt;br&gt;
Item_ONE ..................................12 &lt;br&gt;
Item_TWO..................................45 &lt;br&gt;
item_THREE...............................14 &lt;br&gt;
item_FOUR.................................62 &lt;br&gt;
item_FIVE....................................98 &lt;br&gt;
&lt;br&gt;
GROUPED_DATA: &lt;br&gt;
Item ......................................... Nr &lt;br&gt;
item_NOK...................................71 ----&amp;gt; (Item_ONE + Item_TWO + Item_THREE)
&lt;br&gt;
item_OK.....................................160 ----&amp;gt;(Item_FOUR + Item_FIVE) &lt;br&gt;
&lt;br&gt;
The goal is to show how many % the GOOD items represents inside all data. &lt;br&gt;
&lt;br&gt;
So I thought use PieOfPie graph but there's no documentation to do this. Could anyone show a sample how to use PieOfPie chart? Or there's another way to represent this situation?
&lt;br&gt;
&lt;br&gt;
Thanks in advance&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to set specific image properties in EPPlus?">
      <Posts>
        <Post From="JohanDamen" When="13/05/2014 15:25:11">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
I try to insert images into a worksheet using the ExcelWorkSheet: Drawings.AddPicture. It all works fine except when I try to filter rows in excel. The inserted images will not disappear when the specific row is filtered.
&lt;br&gt;
&lt;br&gt;
The filtering works fine when I manually change the "Object positioning" (Size and Properties... --&amp;gt;Properties) to "Move and size with cells". I'm using Excel 2010 &amp;amp; EPPlus 3.1
&lt;br&gt;
&lt;br&gt;
Of course, I want this settings to be applied using EPPlus, but I don't know how. Who can help ?
&lt;br&gt;
&lt;br&gt;
Regards, &lt;br&gt;
Johan&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="xmaurer" When="17/02/2015 23:52:27">
          <Html>
        &lt;div class="markDownOutput "&gt;Try setting ExcelPicture EditAs property. Set it to eEditAs.TwoCell &lt;br&gt;
&lt;br&gt;
Example:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;pic.EditAs = eEditAs.TwoCell;&lt;/code&gt;&lt;/pre&gt;
Here's how these properties are translated in excel Image properties &lt;br&gt;
eEditAs.Absolute -&amp;gt; Don't move or size with cells &lt;br&gt;
eEditAs.OneCell -&amp;gt; Move but don't size with cells &lt;br&gt;
eEditAs.TwoCell -&amp;gt; Move and size with cells &lt;br&gt;
&lt;br&gt;
Regards &lt;br&gt;
&lt;br&gt;
Xavier&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="XML Encode/Decode?">
      <Posts>
        <Post From="ryang13" When="17/02/2015 16:54:58">
          <Html>
        &lt;div class="markDownOutput "&gt;We have Excel spread sheets that are populated from SSIS and we wanted to apply some more formatting after population, so we are trying EPPlus. Unfortunately, if the cell contains a an XML character like "&amp;gt;" or "&amp;lt;" it gets encoded
 to "&amp;amp;gt;" and "&amp;amp;lt;". More specifically, I guess I should say, after EPPlus manipulated the document and it is opened with Excel, Excel shows &amp;amp;gt; rather than the &amp;gt; character.
&lt;br&gt;
&lt;br&gt;
Is there a way to prevent this sort of encoding or to apply a decode before saving or some other setting that needs to be set to avoid this?
&lt;br&gt;
&lt;br&gt;
Thanks!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Help Setting Chart Y-Axis &quot;Horizontal axis crosses&quot; to &quot;At maximum category&quot;">
      <Posts>
        <Post From="ganamede" When="17/02/2015 04:06:30">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello, I am having some trouble with my X-Axis. I want my Y-Axis to display numbers starting with the lowest numbers at the top, which I have done using:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;chart.XAxis.Orientation = OfficeOpenXml.Drawing.Chart.eAxisOrientation.MaxMin;&lt;/code&gt;&lt;/pre&gt;
However, once I did that, it made the X-Axis move to the top of the chart. I want the X-Axis to be at the bottom of the chart. I can do this in Excel by right clicking on the Y-Axis, selecting "Format Axis", then under "Axis Options" I would
 set "Horizontal axis crosses" to "At maximum category". &lt;br&gt;
&lt;br&gt;
The closest thing I can find to do this with EPPlus is this:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;chart.YAxis.CrossesAt = chart.XAxis.MaxValue;&lt;/code&gt;&lt;/pre&gt;
But this doesn't have the desired effect, the X-Axis appears to be near the bottom but still within the data of chart. Upon looking at the setting within Excel you can see that this command actually sets "Horizontal axis crosses" to "At category
 number" with the value set to the maximum value on that axis. As mentioned, what I really need is to set "Horizontal axis crosses" to "At maximum category".
&lt;br&gt;
&lt;br&gt;
Any ideas on how to achieve this? &lt;br&gt;
&lt;br&gt;
Thanks in advance.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Insertign line breaks">
      <Posts>
        <Post From="pdavis1968" When="16/02/2015 18:57:39">
          <Html>
        &lt;div class="markDownOutput "&gt;According to this post: &lt;a href="http://epplus.codeplex.com/discussions/238692" rel="nofollow"&gt;
http://epplus.codeplex.com/discussions/238692&lt;/a&gt; using "\r\n" in a string should produce a line break in the Excel spreadsheet.
&lt;br&gt;
&lt;br&gt;
I'm not seeing this behavior. I've just converted my system from using Excel Interop to using EPPlus (it's so much faster! LOVE it!)
&lt;br&gt;
&lt;br&gt;
But, for example I have this line:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;        cell = sheet.Cells[2, 1];
        cell.Value = "AGGREGATED\r\nSUMMARY";
&lt;/code&gt;&lt;/pre&gt;
But what I see in the spreadsheet is: "AGGREGATEDSUMMARY" &lt;br&gt;
&lt;br&gt;
I have a number of places where I need line breaks. &lt;br&gt;
&lt;br&gt;
Thanks for any help.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="pdavis1968" When="16/02/2015 19:03:15">
          <Html>
        &lt;div class="markDownOutput "&gt;Nevermind. Dug a bit deeper. My first searches in the discussion didn't turn it up, but continued searching shows I needed to set cell.Style.WrapText = true;
&lt;br&gt;
&lt;br&gt;
Awesome library. Thanks for creating it!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Reading and writing RichText values">
      <Posts>
        <Post From="aleyush" When="26/05/2014 20:12:40">
          <Html>
        &lt;div class="markDownOutput "&gt;I need to read RichText value from a cell, modify it and write to another cell.&lt;br&gt;
&lt;br&gt;
The following code nearly works (with version 4.0 Beta 2):&lt;br&gt;
&lt;pre&gt;&lt;code&gt;using (var p = new ExcelPackage(new FileInfo(OutputFileName)))
{
    var sheet = p.Workbook.Worksheets.First();

    var sourceCell = sheet.Cells[1, 1];
    var resultCell = sheet.Cells[2, 1];

    foreach (var rt in sourceCell.RichText)
    {
        var rtNew = resultCell.RichText.Add(rt.Text.Replace('a', 'b'));
        rtNew.Bold = rt.Bold;
        rtNew.Color = rt.Color;
        if (!String.IsNullOrEmpty(rt.FontName)) rtNew.FontName = rt.FontName;
        rtNew.Italic = rt.Italic;
        rtNew.PreserveSpace = rt.PreserveSpace;
        if (rt.Size &amp;gt; 0) rtNew.Size = rt.Size;
        rtNew.Strike = rt.Strike;
        rtNew.UnderLine = rt.UnderLine;
        rtNew.VerticalAlign = rt.VerticalAlign;
    }

    p.Save();
}&lt;/code&gt;&lt;/pre&gt;
&lt;ol&gt;
&lt;li&gt;When RichText consists of 2 parts, first ending with spaces, the spaces are lost in the result.
&lt;/li&gt;&lt;li&gt;When the first part of RichText has no custom styles applied, for the first element rt.FontName is an empty string and rt.Size is zero, so without my if statements the result is corrupted. Is that a bug or feature?
&lt;/li&gt;&lt;li&gt;Is there a more simple way to do this, without copying RichText elements with all properties one-by-one?&lt;br&gt;
&lt;/li&gt;&lt;/ol&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="aleyush" When="16/02/2015 10:54:39">
          <Html>
        &lt;div class="markDownOutput "&gt;The following code seems to work well with version 4.0.3.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;using (var p = new ExcelPackage(new FileInfo(OutputFileName)))
{
    var sheet = p.Workbook.Worksheets.First();

    var sourceCell = sheet.Cells[1, 1];
    var resultCell = sheet.Cells[2, 1];

    sourceCell.Copy(resultCell);
    resultCell.IsRichText = true;

    foreach (var rt in resultCell.RichText)
    {
        rt.Text = rt.Text.Replace("text", "supertext");
    }

    p.Save();
}&lt;/code&gt;&lt;/pre&gt;
But if I do not set IsRichText property for the result cell, I see xml markup in the sell instead of RichText value.
&lt;br&gt;
Why isn't this property set by the Copy function? Is that a bug or feature?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Stacked Bar Graph Gap">
      <Posts>
        <Post From="jackalclone1" When="13/02/2015 20:45:33">
          <Html>
        &lt;div class="markDownOutput "&gt;I saw an old thread a couple of years old asking about using EPPlus to remove the gap between bars in a bar graph. I'm wondering if any progress has ever been made on this? Specifically, I'm looking to programmatically remove the gap between bars in a
 stacked bar graph (eChartType.BarStacked100). &lt;br&gt;
&lt;br&gt;
Is this possible? If not, is there a way to achieve this using ChartXML?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Is there is any way we can render the HTML text in CELL?">
      <Posts>
        <Post From="harshkaushal" When="12/02/2015 14:54:36">
          <Html>
        &lt;div class="markDownOutput "&gt;I have requirement from my client to render the HTML from database to excel. Design of the cell will be same as we have mentioned in the HTML style tag. Please help me to resolve this issue.
&lt;br&gt;
&lt;br&gt;
Thanks&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Calculate() Method is slow">
      <Posts>
        <Post From="prashantyadav" When="09/02/2015 12:38:07">
          <Html>
        &lt;div class="markDownOutput "&gt;Have a template which contains formulas , I dump lot if data from SQL Server to sheet and then need to read few values.
&lt;br&gt;
when I invoke mySheet.Calculate() it takes too much time. any suggestion(s) to increase performance for Calculate.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="10/02/2015 13:33:50">
          <Html>
        &lt;div class="markDownOutput "&gt;One thing you can do is to calculate only the value you want to read.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;mySheet.Cells["A1"].Calculate();&lt;/code&gt;&lt;/pre&gt;
You can also try to download the lastest code of EPPlus and build it. The lastest code has some performance improvements of the formula parser compared to version 4.0.0.2. If you do this, be sure to build in release mode since the Caluclate() method is much
 slower in debug mode.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="prashantyadav" When="11/02/2015 03:58:36">
          <Html>
        &lt;div class="markDownOutput "&gt;swmal , thanks for response. I tried same and have better performance but I have to optimize bit more.
&lt;br&gt;
Wanted to know how calculate parser works. for e.g. &lt;br&gt;
Cell["A1"] has formula which refers another cell Cell["B1"] which too had formula. if I invoke Calculate on Cell["B1"] first and then on Cell["A1"] will it be faster than invoking calculate directly on Cell[A1"].
 or I can say if calculate is invoke on Cell[B1"] does the value persist ? &lt;br&gt;
Please let me know If I had to provide some sample sheet ? Thanks in advance.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="11/02/2015 20:14:25">
          <Html>
        &lt;div class="markDownOutput "&gt;It might be useful to know that every call to Calculate will reset the values on the worksheet. Therefore this:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;mySheet.Cells["A1:B2"].Calculate();&lt;/code&gt;&lt;/pre&gt;
...will be faster than this:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;mySheet.Cells["A1"].Calculate();
mySheet.Cells["A2"].Calculate();
mySheet.Cells["B1"].Calculate();
mySheet.Cells["B2"].Calculate();&lt;/code&gt;&lt;/pre&gt;
The formula parser will start by building a calc chain and calculate the formulas in the appropriate order, so you don't need to think about that.
&lt;br&gt;
&lt;br&gt;
How many formulas do you have in your worksheet?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Problems reading excel files until Excel opens and saves those source files">
      <Posts>
        <Post From="dmaidlow" When="10/02/2015 23:20:01">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello, &lt;br&gt;
&lt;br&gt;
I'm using EPP 4.0.2. I have an excel spreadsheet that was generated using another piece of code that is using spreadsheet gear 7.1.2.102. My process is to create the empty file using SSG - return out a byte array of the xlsx file then open that byte array with
 EPP. There is no disk involved. &lt;br&gt;
&lt;br&gt;
For some reason these files all return null for the cell values when accessing the data from EPP. If one of these excel files is saved to disk, opened in Excel and saved then processed throughthis code, EPP has no problem reading the data.
&lt;br&gt;
&lt;br&gt;
Any suggestions would be greatly appreciated. &lt;br&gt;
&lt;br&gt;
thanks &lt;br&gt;
darrin&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="prashantyadav" When="11/02/2015 04:37:20">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, Does your file have formulas ? if so then formulas cells will not have values. until they are calculated. Once you open file with excel ,it calculates all the values and save formulas as well as formulas.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="dmaidlow" When="11/02/2015 16:26:14">
          <Html>
        &lt;div class="markDownOutput "&gt;Aha. It does indeed and these are the fields that are coming in null. I'll investigate the calculate call.
&lt;br&gt;
thanks! &lt;br&gt;
darrin &lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Expand Excel Table">
      <Posts>
        <Post From="NickWard" When="17/05/2013 14:10:06">
          <Html>
        &lt;div class="markDownOutput "&gt;I would like populate an excel table within a template. &lt;br&gt;
&lt;br&gt;
The table will be linked to charts and pivots that exist within the template prior to population by EP plus.
&lt;br&gt;
&lt;br&gt;
When I try to expand the excel table using insert row method the new rows are inserted into the spread sheet but the table row count remains the same (3 rows)
&lt;br&gt;
&lt;br&gt;
How can I expand an existing excel table to the datatable record count? &lt;br&gt;
&lt;br&gt;
Thanks &lt;br&gt;
&lt;br&gt;
Nick&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="patwolf" When="11/02/2015 09:27:49">
          <Html>
        &lt;div class="markDownOutput "&gt;Hey Nick, &lt;br&gt;
you'll find some answers here: &lt;a href="https://epplus.codeplex.com/discussions/253630#" rel="nofollow"&gt;
https://epplus.codeplex.com/discussions/253630#&lt;/a&gt; &lt;br&gt;
Best, &lt;br&gt;
Patrick&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Reuse existing table in Template : A feature that would make this project even more awesome than it already is">
      <Posts>
        <Post From="buckley" When="12/04/2011 22:32:51">
          <Html>
        
&lt;p&gt;Hi EPPlus!,&lt;br&gt;
&lt;br&gt;
&lt;/p&gt;
&lt;p&gt;First a well meant thank you for saving me :) Really, its in the middle of the night and I believe I can pull my requirements off with EPPlus.&lt;/p&gt;
&lt;p&gt;&lt;br&gt;
I have tried the Openxml SDK V2 which is nice if you have a month to spare and so went for another codeplex project called ExtremeML
&lt;a href="http://www.extrememl.com/index.php/knowledge-center/concepts/the-importance-of-templates" rel="nofollow"&gt;
which uses a template approach&lt;/a&gt; to excel generation.&lt;/p&gt;
&lt;p&gt;This template approach is what I was after as it allows me to create the Excel like I'm used to leveraging the power of conditional formatting, pivots, charts and all the other good stuff.&lt;br&gt;
ExtremeML would then just inject the data in the template and be done with it. This allows for creation of insightful spreadsheets in no time ... This is awesome and drove me to ExtremeML in the first place.&lt;br&gt;
&lt;br&gt;
However, I was doing my tests with 100 records / 20 columns and it ran fine. Once it was time to plug in the real data performance degraded enormously. 10000 records took 20 minutes all of a sudden and 1,5 gig of memory was consumed.&lt;br&gt;
&lt;br&gt;
I then considered 2 options &lt;br&gt;
&lt;br&gt;
1. use the sax approach blogged at http://blogs.msdn.com/b/brian_jones/archive/2010/06/22/writing-large-excel-files-with-the-open-xml-sdk.aspx&lt;/p&gt;
&lt;p&gt;This seems feasible and it looks interesting to give it a try&lt;br&gt;
&lt;br&gt;
2. EPPlus&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Enter EPPlus which I believe will save my day :)&lt;/p&gt;
&lt;p&gt;&lt;br&gt;
BTW for what does PLus stand for? &lt;br&gt;
&lt;br&gt;
My questions is about how far we can go with the template approach using EPPlus. When converting my ExtremeML code I noticed that in the current version (please correct me if wrong) tables have to constructed and can't be reused.&lt;br&gt;
With EPPlus it isn't possible to have a table in the template where the custom formats are set, conditional formatting is applied, etc and let EPPlus inject the data in it.&lt;br&gt;
&lt;br&gt;
It is my understanding that to use a table one has to write code like this&lt;br&gt;
&lt;br&gt;
ExcelPackage excelPackage = new ExcelPackage(new FileInfo(@"c:\temp\template.xlsx"));&lt;br&gt;
excelPackage.Workbook.Worksheets["Sheet1"].Cells["A1"].LoadFrom DataTable(dataTable, true);&lt;br&gt;
excelPackage.Workbook.Worksheets["Sheet1"].Tables.Add(new ExcelAddressBase(1, 1,dataTable.Rows.Count+1,dataTable.Columns.Count),"table1");&lt;br&gt;
FileInfo output File = new FileInfo(@"c:\temp\out.xlsx");&lt;br&gt;
excelPackage.Save(output File);&lt;br&gt;
&lt;br&gt;
My humble question:&lt;/p&gt;
&lt;p&gt;Is it possible that EPPlus injects data in an existing table? I saw that the current API has a dimension property with an internal setter. This makes me believe that resizing an existing table isn't supported.&lt;br&gt;
I believe that by resizing a table the full power of templates can be achieved...&lt;br&gt;
&lt;br&gt;
For now I can use pivots and charts in my template which is awesome. Only tables seem out of reach.&lt;br&gt;
&lt;br&gt;
&lt;a href="http://content.screencast.com/users/buckleyXP/folders/Jing/media/0e3083bc-22dd-4183-b279-7309c8a9101a/2011-04-12_2300.png" rel="nofollow"&gt;Here is an example&lt;/a&gt; of an excel that I would like to generate. Currently I have no clue to get to such a table.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks for your awesome contribution to our .NET community!&lt;/p&gt;
&lt;p&gt;Looking forward to see this project flourish&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Tom&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="14/04/2011 14:51:21">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Currently the Address method off the ExcelTable class is readonly (to simplify), but I guess&amp;nbsp;it could be allow&amp;nbsp;to be&amp;nbsp;changed&amp;nbsp;as long as the start&amp;nbsp;row is the same and the number of colums is intact. I'll add that to my TODO list.&lt;/p&gt;
&lt;p&gt;If you need a fix now you&amp;nbsp;can&amp;nbsp;set the &lt;a href="mailto:table/@Ref" rel="nofollow"&gt;table/@Ref&lt;/a&gt;&amp;nbsp;attribute and the
&lt;a href="mailto:table/autoFilter/@ref" rel="nofollow"&gt;table/autoFilter/@ref&lt;/a&gt;&amp;nbsp; to the wanted range-address (use the Table.TableXml property).&lt;/p&gt;
&lt;p&gt;The "plus" is just ExcelPackage+ (but it's not much left from the startup project :) ).&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="buckley" When="14/04/2011 22:36:23">
          <Html>
        
&lt;p&gt;Hello Jan,&lt;/p&gt;
&lt;p&gt;Thanks for your reply&lt;/p&gt;
&lt;p&gt;I hope I got my suggestion across. I will try the xpath solution tomorrow when I behind my developer box&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;The template solution would work as follows. We are in Excel designing our table with conditional formatting:&lt;/p&gt;
&lt;p&gt;http://content.screencast.com/users/buckleyXP/folders/Jing/media/91ba5c83-064b-4def-84ff-524e75408664/2011-04-14_2325.png&lt;/p&gt;
&lt;p&gt;Next we clear the data and save it&lt;/p&gt;
&lt;p&gt;http://content.screencast.com/users/buckleyXP/folders/Jing/media/738e69fb-0b01-4d53-8fdf-65b447aecacf/2011-04-14_2326.png&lt;/p&gt;
&lt;p&gt;After that we just let EPPlus inject the data and we have our awesome table in no time.&lt;/p&gt;
&lt;p&gt;Can I suggest you give some thought about the branding of this project? EPPlus doesnt communicate what the project is about unless you know its history :)&lt;/p&gt;
&lt;p&gt;Maybe "Excel Generation" or "Excel Evolved" or "Lightspeed Excel" ? I have to admit I choose ExtremeML because of its name and would have sticked without if it was so slow bause of the underlying SDK&lt;/p&gt;
&lt;p&gt;The edge that EPPlus currently had over all the other options is its speed&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Can't wait to try your suggestion :)&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Kind Regards, Tom&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="zippy1981" When="25/04/2014 23:07:22">
          <Html>
        &lt;div class="markDownOutput "&gt;&lt;a href="https://epplus.codeplex.com/discussions/253630" rel="nofollow"&gt;I gave a code example here&lt;/a&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="wrummler" When="05/08/2014 22:27:21">
          <Html>
        &lt;div class="markDownOutput "&gt;The preceding link simply loads this same discussion page. I have a feeling it might have been meant to go
&lt;a href="http://stackoverflow.com/questions/23303704/how-do-i-edit-an-existing-table-with-epplus" rel="nofollow"&gt;
here&lt;/a&gt;.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="patwolf" When="11/02/2015 09:17:45">
          <Html>
        &lt;div class="markDownOutput "&gt;My +10 for altering existing tables. I got it working now with the XML hack in the link above but it would be great if it was just part of the library so I can be confident it will always work! Thanks!!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="FormulaR1C1 increasing row value.">
      <Posts>
        <Post From="mikeferrer" When="04/02/2015 18:28:19">
          <Html>
        &lt;div class="markDownOutput "&gt;I have set a formula as follows: &lt;br&gt;
RMWorksheet.Cells[3, 2, (dt3.Rows.Count + 2), 2].FormulaR1C1 = "'Dados Projeto'!R[-1]C";
&lt;br&gt;
&lt;br&gt;
The problem is it increases the value of the Row to -2,-3,... and as so references the same value. How can I make it stick as -1 for all cells.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Selecting one column to set format, selects the whole sheet">
      <Posts>
        <Post From="joopstringer" When="03/02/2015 21:09:35">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi,&lt;br&gt;
&lt;br&gt;
If i want to add a format to lets say only column A ... I tried this ws.Cells["A:A"].Style.Numberformat.Format = "DD/MM/YYYY";&lt;br&gt;
&lt;br&gt;
However, this sets the style for the whole sheet. &lt;br&gt;
Any ideas how to do this ?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="File In Use When Trying To Create a New ExcelPackage">
      <Posts>
        <Post From="jdausten" When="02/02/2015 14:10:03">
          <Html>
        &lt;div class="markDownOutput "&gt;After I use the Ajax asyncfileupload tool to grab my user's file I save it to a directory on the webserver via the fileupload.saveas method. Then I use your sample code to open a file and create an ExcelPackage to read the contents and it always says the
 file is in use.&lt;br&gt;
&lt;br&gt;
Here are the two lines that get it started and it fails on the using statement.&lt;br&gt;
&lt;br&gt;
FileInfo existingFile = new FileInfo(file);&lt;br&gt;
&lt;pre&gt;&lt;code&gt;    using (ExcelPackage package = new ExcelPackage(existingFile))
    {
        ...mycode
     }
&lt;/code&gt;&lt;/pre&gt;
I'm always told the existingFile is in use. Why? When i use the ExcelDataReader project found here on CodePlex it works fine when opening and reading but your project always fails.&lt;br&gt;
&lt;br&gt;
I want to use your project for reading as well as writing but only the writing works.
&lt;br&gt;
&lt;br&gt;
Has anyone else run into this and have a solution?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Can't Change Value of a Cell">
      <Posts>
        <Post From="hristo_penchev" When="01/02/2015 12:04:17">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi guys, &lt;br&gt;
I am trying to study EPPlus library. I am trying to change value of a cell but it doesn't work. I don't know why. I open the file correctly, no error reports appear, but when I close the program nothing is changed into the file. Here is my code"
&lt;br&gt;
&lt;br&gt;
using System; &lt;br&gt;
using System.Collections.Generic; &lt;br&gt;
using System.IO; &lt;br&gt;
using System.Linq; &lt;br&gt;
using System.Reflection; &lt;br&gt;
using OfficeOpenXml; &lt;br&gt;
&lt;br&gt;
class Program &lt;br&gt;
{&lt;br&gt;
&lt;pre&gt;&lt;code&gt;static void Main()
{
    var ExistFile = "file.xlsx";
    var File = new FileInfo(ExistFile);

    using (ExcelPackage package = new ExcelPackage(File))
    {            
        ExcelWorkbook workBook = package.Workbook;
        ExcelWorksheet cSheet = workBook.Worksheets.First();
        cSheet.Cells[15, 5].Value = 1;
        package.Save();            
    }
}&lt;/code&gt;&lt;/pre&gt;
}&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Setting Colors in WPF Application">
      <Posts>
        <Post From="rbelknap" When="01/02/2015 09:46:45">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello, &lt;br&gt;
&lt;br&gt;
I am wondering if there is a way to set colors in an application written in WPF.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;lusterHoursDetail.Cells[1,1,2,1].Style.Fill.BackgroundColor.SetColor(Color.White);&lt;/code&gt;&lt;/pre&gt;
The .SetColor appears to take System.Drawing.Color. &lt;br&gt;
&lt;br&gt;
I have tried adding a using to System.Drawing, but that did not help. &lt;br&gt;
&lt;br&gt;
Any assistance will be appreciated.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="very slow any ideas to speed up">
      <Posts>
        <Post From="insomniac4104" When="27/01/2015 13:34:02">
          <Html>
        &lt;div class="markDownOutput "&gt;A Data Table of 3000 rows takes almost 10 seconds a row. This means the job will take over 8 hours to run. I really like this tool but this performance hit is killing me. Any ideas to speed it up.
&lt;br&gt;
&lt;br&gt;
Here is my dump routine.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;private static void CreateData(ExcelWorksheet workSheet, ref int rowIndex, DataTable dt)
        {
            int colIndex = 0;
            int intNumberCheck;

            foreach (DataRow dr in dt.Rows) // Adding Data into rows
            {
                colIndex = 1;                
                rowIndex++;
                               
                foreach (DataColumn dc in dt.Columns)
                {                    
                    var cell = workSheet.Cells[rowIndex, colIndex];                    

                    bool isNumber = Int32.TryParse(dr[dc.ColumnName].ToString(), out intNumberCheck);

                    if (isNumber == true)
                    {
                        //Setting Value in cell
                        cell.Value = Convert.ToInt32(dr[dc.ColumnName]);
                    }
                    else
                    {
                        //Setting Value in cell
                        cell.Value = Convert.ToString(dr[dc.ColumnName]);
                    }

                    //Setting borders of cell
                    var border = cell.Style.Border;
                    border.Left.Style = border.Right.Style = ExcelBorderStyle.None;

                    workSheet.Cells.AutoFitColumns(colIndex);
                    cell.Style.HorizontalAlignment = ExcelHorizontalAlignment.Right;

                    colIndex++;                                       

                }
            }
        }&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="ffeldhaus" When="29/01/2015 06:57:01">
          <Html>
        &lt;div class="markDownOutput "&gt;I would recommend to use LoadFromDataTable to import the datatable to a worksheet. Maybe you can also directly use a TableStyle during LoadFromDataTable instead of setting borders manually?
&lt;br&gt;
You can call AutoFitColumns on all columns (workSheet.Cells[workSheet.Dimension.Address].AutoFitColumns()) after you loaded the DataTable.
&lt;br&gt;
I would also recommend to format complete columns as Numbers after you importet the datatable into the worksheet. That should also speed it up a lot.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="29/01/2015 11:36:52">
          <Html>
        &lt;div class="markDownOutput "&gt;I think your major issue is call AutoFit in each step, if you do that your algorithm will be a O(4). Call after load all your cells and it will be O(2).
&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="insomniac4104" When="29/01/2015 13:57:55">
          <Html>
        &lt;div class="markDownOutput "&gt;Thanks so much. &lt;br&gt;
I took out the formatting and now the loop is incredibly fast.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;private static void CreateData(ExcelWorksheet workSheet, ref int rowIndex, DataTable dt)
        {
            int colIndex = 0;
            int intNumberCheck;

            foreach (DataRow dr in dt.Rows) // Adding Data into rows
            {
                colIndex = 1;                
                rowIndex++;
                                
                foreach (DataColumn dc in dt.Columns)
                {                    
                    var cell = workSheet.Cells[rowIndex, colIndex];                    

                    bool isNumber = Int32.TryParse(dr[dc.ColumnName].ToString(), out intNumberCheck);

                    if (isNumber == true)
                    {
                        //Setting Value in cell
                        cell.Value = Convert.ToInt32(dr[dc.ColumnName]);
                    }
                    else
                    {
                        //Setting Value in cell
                        cell.Value = Convert.ToString(dr[dc.ColumnName]);
                    }                   

                    colIndex++;                                       

                }
            }
        }&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Formula Evaluation error">
      <Posts>
        <Post From="denisplex" When="13/01/2015 17:58:24">
          <Html>
        &lt;div class="markDownOutput "&gt;I have an xlsx file written by a customer. It contains some formulas using italian syntax.
&lt;br&gt;
From my vb net application I've to write some values into a worksheet of the file and then read some values of formula cells. The results are calculated using values written by me previously.
&lt;br&gt;
&lt;br&gt;
All work well using the excel file, not using EPPLUS library from visual studio &lt;br&gt;
&lt;br&gt;
What I've done is this:&lt;br&gt;
&lt;ol&gt;
&lt;li&gt;Write values in 3 cells of the worksheet &lt;/li&gt;&lt;li&gt;Call the calculate method of the worksheet &lt;/li&gt;&lt;li&gt;Read value from a formula cell. This is the formula: =SE.ERRORE(CERCA.VERT(CONCATENA(1;E3);'MECCANISMI BLUM AVENTOS'!$A:$H;3;0);"")&lt;br&gt;
&lt;/li&gt;&lt;/ol&gt;
... and this is the properties read from immediate window: &lt;br&gt;
? cvExcelWorksheet_CalcoloMeccanismo.Cells(lvRiga, 6) &lt;br&gt;
{F2}&lt;br&gt;
&lt;pre&gt;&lt;code&gt;_address: "F2"
_addresses: Nothing
_fromCol: 6
_fromRow: 2
_toCol: 6
_toRow: 2
_wb: Nothing
_workbook: {OfficeOpenXml.ExcelWorkbook}
_worksheet: {CALCOLO MECCANISMO}
_ws: "CALCOLO MECCANISMO"
Address: "F2"
Address (ExcelAddressBase): "F2"
Addresses: Nothing
AddressSpaceSeparated: "F2"
AutoFilter: False
Columns: 1
Comment: Nothing
ConditionalFormatting: {OfficeOpenXml.ConditionalFormatting.RangeConditionalFormatting}
Current: {"Riferimento a un oggetto non impostato su un'istanza di oggetto."}
DataValidation: {OfficeOpenXml.DataValidation.RangeDataValidation}
End: {OfficeOpenXml.ExcelCellAddress}
FirstAddress: "F2"
Formula: "IFERROR(VLOOKUP(CONCATENATE(1,E2),'MECCANISMI BLUM AVENTOS'!$A:$H,3,0),"")"
FormulaR1C1: "IFERROR(VLOOKUP(CONCATENATE(1,RC[-1]),'MECCANISMI BLUM AVENTOS'!$A:$H,3,0),"")"
FullAddress: "'CALCOLO MECCANISMO'!F2"
FullAddressAbsolute: "'CALCOLO MECCANISMO'!$F$2"
FullAddressAbsoluteNoFullRowCol: "'CALCOLO MECCANISMO'!$F$2"
Hyperlink: Nothing
IsArrayFormula: False
IsName: False
IsRichText: False
Item: In order to evaluate an indexed property, the property must be qualified and the arguments must be explicitly supplied by the user.
Item: In order to evaluate an indexed property, the property must be qualified and the arguments must be explicitly supplied by the user.
Item: In order to evaluate an indexed property, the property must be qualified and the arguments must be explicitly supplied by the user.
Merge: False
RichText: {OfficeOpenXml.Style.ExcelRichTextCollection}
Rows: 1
Start: {OfficeOpenXml.ExcelCellAddress}
Style: {OfficeOpenXml.Style.ExcelStyle}
StyleID: 22
StyleName: "Normale"
Table: Nothing
Text: "#NAME?"
TextForWidth: "#NAME?"
Value: "#NAME?" {String}
Worksheet: {CALCOLO MECCANISMO}
WorkSheet (ExcelAddressBase): "CALCOLO MECCANISMO"
Results: Expanding will process the collection
&lt;/code&gt;&lt;/pre&gt;
As you can see Value returned is #VALUE &lt;br&gt;
&lt;br&gt;
Why? &lt;br&gt;
&lt;br&gt;
Thank you in advance&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="13/01/2015 19:19:29">
          <Html>
        &lt;div class="markDownOutput "&gt;Since I dont have access to your workbook its not so easy to know exactly what is going wrong, but the functions IFERROR, VLOOKUP and CONCATENATE are allsupported by EPPlus. However your VLOOKUP call seems to refer to another worksheet and perhaps the
 range there contains an error. You say that the error is #VALUE, but it looks like it is #NAME? The #NAME? error normally means that there is a call to an Excel function not yet supported by EPPlus.
&lt;br&gt;
&lt;br&gt;
What you can try is the following:&lt;br&gt;
&lt;ol&gt;
&lt;li&gt;Call Calculate() on the workbook instead of the worksheet, to ensure that all worksheets are calculated in the right order.
&lt;/li&gt;&lt;li&gt;If this still does not work, make sure that the ranges that are referred does not contain unsupported functions. In the "Documentation" section above you can find a list of the functions supported by EPPlus.
&lt;/li&gt;&lt;li&gt;Download the latest code and compile, we have added more functions and fixed a few bugs lately.
&lt;/li&gt;&lt;/ol&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="denisplex" When="13/01/2015 23:15:49">
          <Html>
        &lt;div class="markDownOutput "&gt;Thank you for the interest to my problem. You are right, the error is #NAME? I’ve tried the 3 solutions proposed but no one solve the problem. I've tried to enclose the excel file but I think it's not possible. What I do from my application is, for example,
 this: 1. Write value 357 in cell 2, 1 2. Write value 497 in cell 2, 2 3. Call workbook.calculate() 4. I read values in column F from row 2 to 8. When I read cell 2, 6 #NAME? is returned. If I compile manually in the same way the excel worksheet values in column
 F are calculated correctly. Denis Basei &lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="14/01/2015 07:53:46">
          <Html>
        &lt;div class="markDownOutput "&gt;You can enclose the Excel file if you create an issue (see the "Issues" link in the top menu)..
&lt;br&gt;
&lt;br&gt;
/Mats&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="denisplex" When="14/01/2015 08:32:13">
          <Html>
        &lt;div class="markDownOutput "&gt;Hy swmal &lt;br&gt;
&lt;br&gt;
I create an issue a moment ago. &lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Thank you&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="denisplex" When="19/01/2015 10:27:16">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi swmal &lt;br&gt;
&lt;br&gt;
Do you remember the problem with IFERROR of last week? &lt;br&gt;
Today using the new release of EPPLUS I've noticed that the formula doen't return error but Always return empty string.
&lt;br&gt;
&lt;br&gt;
Now I open an issue. &lt;br&gt;
Can you check it? &lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Thank you.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="denisplex" When="19/01/2015 22:06:59">
          <Html>
        &lt;div class="markDownOutput "&gt;Do to the urgency to find a solution I give you more details: &lt;br&gt;
&lt;br&gt;
The formula giving the problem is this: IFERROR(VLOOKUP(CONCATENATE(1,E4),'MECCANISMI BLUM AVENTOS'!
&lt;br&gt;
A2:C26,3,FALSE),"") &lt;br&gt;
&lt;br&gt;
The problem is that VLOOKUP Always return #N/D and consiquently string.empty &lt;br&gt;
This happened only using EPPlus library, in the workbook the calculation is correct.
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Thank you &lt;br&gt;
Denis&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="denisplex" When="20/01/2015 07:36:10">
          <Html>
        &lt;div class="markDownOutput "&gt;Do you think my problem will be examinated today? &lt;br&gt;
Excuse me for the question. &lt;br&gt;
I think EPPlus is a very good library and probably my problem is an oversight but I've to solve very urgently. If no I'll search another way.
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Thanks a lot.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="20/01/2015 14:52:36">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi Denis, &lt;br&gt;
&lt;br&gt;
I might find the time to take a look at this tonight CET. The time we spend on this project is sparetime (non-workrelated), so it is hard to make comittments.
&lt;br&gt;
&lt;br&gt;
/Mats&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="20/01/2015 18:55:55">
          <Html>
        &lt;div class="markDownOutput "&gt;I have now tried to recreate your problem. First I wrote two unittests that concatenated an int with a string using the CONCATENATE function. Both succeeds to concatenate the int and string.&lt;br&gt;
&lt;br&gt;
Then I opened the Excel workbook that you have supplied with the issue - Excel02.xlsx. In cell F2 in the first worksheet I find the following formula:
&lt;br&gt;
&lt;br&gt;
=IFERROR(VLOOKUP(CONCATENATE(1;E2),'MECCANISMI BLUM AVENTOS'!$A:$H;3;FALSE),"")&lt;br&gt;
&lt;br&gt;
...which I guess is the formula that fails. However this returns the empty string both opened by Excel and when I use the Calculate method of EPPlus.&lt;br&gt;
&lt;br&gt;
The VLOOKUP searches for the string "1HF - PACCHETTO" in the range MECCANISMI BLUM AVENTOS'!$A:$H, which it - correctly - fails to find. Therefore IFERROR it returns the empty string.&lt;br&gt;
&lt;br&gt;
I will try to help you, but I need your help with a clear description on how to recreate the error.
&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="20/01/2015 19:07:00">
          <Html>
        &lt;div class="markDownOutput "&gt;When I change CONCATENATE(1,E2) to CONCATENATE(0,E2) it returns "20F2201". Dont know if this is the exptected result, but it seems like EPPlus can compile the formula.
&lt;br&gt;
&lt;br&gt;
I am using the latest commit of the EPPlus source code - 349b0e32e7c7.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="denisplex" When="20/01/2015 22:45:45">
          <Html>
        
&lt;div&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;Hi swmal and thanks a lot for the answers&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;I try to explain with an example:&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;in the xlsx file try this: write 389 in A2 and 1000 in B2; automatically in F4 you read 20L2500&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;in the xlsx file try this: write 357 in A2 and 597 in B2; automatically in F4 you read 20L2300&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;If I made the same thing using EPPLUS in F4 I read always string empty&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;This is the peace of vb net code:&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;Try&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;Dim lvStrMorfologiaFiglio = Par_CodiceFiglio.Trim.Substring((Par_CodiceFiglio.Trim.Length - 2), 2)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;' Scrivo le dimensioni nel foglio "CALCOLO MECCANISMO" in questo ordine:&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;' Cella A2 = Par_DimensioneZ&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;' Cella B2 = Par_DimensioneX&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;cvExcelWorksheet_CalcoloMeccanismo.Cells(2, 1).Value = Par_DimensioneZ.ToString&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;cvExcelWorksheet_CalcoloMeccanismo.Cells(2, 2).Value = Par_DimensioneX.ToString&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;' Ricerco una corrispondenza di modello nel foglio "MODELLO-TIPO PANNELLO"&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;Dim lvStrCodiceModelloAnta As String = ChiaveModello(Par_CodiceModello)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;If (lvStrCodiceModelloAnta &amp;lt;&amp;gt; String.Empty) Then&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;cvExcelWorksheet_CalcoloMeccanismo.Cells(2, 3).Value = lvStrCodiceModelloAnta&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;cvExcelWorksheet_CalcoloMeccanismo.Calculate()&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;cvExcelWorksheet_MeccanismiBlum.Calculate()&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;'cvExcelPackage.Workbook.Calculate()&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;' ... a questo punto le formule impostate nel foglio scrivono nell'intervallo di celle F2:F8 i codici BLUM.&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;Dim lvListaMeccanismiBlum As New List(Of Class_MeccanismoBlum)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;Dim lvListaMeccanismiBlumTraslati As New List(Of Class_MeccanismoBlum)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;Dim lvListaMeccanismiBlumBasculanti As New List(Of Class_MeccanismoBlum)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;' Variabile temporanea dove scrivo la lista di stringhe che ritornerà la funzione.&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;Dim lvStrMeccanismiBlum As New List(Of String)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;For lvRiga As Byte = 4 To 8&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;'cvExcelWorksheet_CalcoloMeccanismo.Cells(lvRiga, 6).Calculate()&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;&lt;span style="background: yellow;"&gt;If Not (cvExcelWorksheet_CalcoloMeccanismo.Cells(lvRiga, 6).Value&lt;/span&gt; = String.Empty) Then&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;Dim lvCodiceBlum As String = cvExcelWorksheet_CalcoloMeccanismo.Cells(lvRiga, 6).Value.ToString.Trim&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;For lvIndMecc As Byte = 2 To 50&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;If (cvExcelWorksheet_MeccanismiBlum.Cells(lvIndMecc, 3).Value.ToString.Trim = lvCodiceBlum) AndAlso (cvExcelWorksheet_MeccanismiBlum.Cells(lvIndMecc, 5).Value = 1) Then&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;' Controllo se lvIndMecc cade nell'intervallo del tipo meccanismo "TRASLATO"&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;If ((lvIndMecc &amp;gt;= 5) AndAlso (lvIndMecc &amp;lt;= 18)) Then ………&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;……………………………..&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;highlighted line always return stirng empty.&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;div&gt;
&lt;div style="border-width: 1pt medium medium; border-style: solid none none; border-color: rgb(225, 225, 225) currentColor currentColor; padding: 3pt 0cm 0cm; border-image: none;"&gt;
&lt;p&gt;&lt;b&gt;&lt;span style="font-family:; font-size: 11pt;"&gt;Da:&lt;/span&gt;&lt;/b&gt;&lt;span style="font-family:; font-size: 11pt;"&gt; swmal [email removed]
&lt;br&gt;
&lt;b&gt;Inviato:&lt;/b&gt; martedì 20 gennaio 2015 20:59&lt;br&gt;
&lt;b&gt;A:&lt;/b&gt; [email removed]&lt;br&gt;
&lt;b&gt;Oggetto:&lt;/b&gt; Re: Formula Evaluation error [EPPlus:577630]&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 9pt;"&gt;From: swmal&lt;/span&gt;&lt;/p&gt;
&lt;div id="ThreadNotificationPostBody" style="margin-bottom: 24pt;"&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 9pt;"&gt;I have now tried to recreate your problem. First I wrote two unittests that concatenated an int with a string using the CONCATENATE function. Both succeeds to concatenate the int and string.&lt;br&gt;
&lt;br&gt;
Then I opened the Excel workbook that you have supplied with the issue - Excel02.xlsx. In cell F2 in the first worksheet I find the following formula:
&lt;br&gt;
&lt;br&gt;
=IFERROR(VLOOKUP(CONCATENATE(1;E2),'MECCANISMI BLUM AVENTOS'!$A:$H;3;FALSE),"")&lt;br&gt;
&lt;br&gt;
...which I guess is the formula that fails. However this returns the empty string both opened by Excel and when I use the Calculate method of EPPlus.&lt;br&gt;
&lt;br&gt;
The VLOOKUP searches for the string "1HF - PACCHETTO" in the range MECCANISMI BLUM AVENTOS'!$A:$H, which it - correctly - fails to find. Therefore IFERROR it returns the empty string.&lt;br&gt;
&lt;br&gt;
I will try to help you, but I need your help with a clear description on how to recreate the error.
&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="swmal" When="21/01/2015 06:02:30">
          <Html>
        &lt;div class="markDownOutput "&gt;Thank you. I have now managed to recreate the error, but it is quite a long calculation chain... I can now see that EPPlus fails to calculate cell H11 on the second worksheet. I will continue trying to resolve this asap.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="21/01/2015 13:55:09">
          <Html>
        &lt;div class="markDownOutput "&gt;I think I have found the error now. You have a worksheet named MODELLO-TIPO PANNELLO. If you remove the - in other words rename the worksheet to MODELLO TIPO PANNELLO it seems to work.
&lt;br&gt;
&lt;br&gt;
It seems like EPPlus currently cannot handle the - character in worksheet names. &lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="denisplex" When="27/01/2015 09:25:24">
          <Html>
        
&lt;div&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;Good morning swmal&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;I’ve used Office.Interop library for the urgency to deliver my application.&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;Formulas are very complex and I can’t change it because excel file was developed by my customer.&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;This time I prefer to use Office.Interop.&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;Thank you &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;div&gt;
&lt;div style="border-width: 1pt medium medium; border-style: solid none none; border-color: rgb(225, 225, 225) currentColor currentColor; padding: 3pt 0cm 0cm; border-image: none;"&gt;
&lt;p&gt;&lt;b&gt;&lt;span style="font-family:; font-size: 11pt;"&gt;Da:&lt;/span&gt;&lt;/b&gt;&lt;span style="font-family:; font-size: 11pt;"&gt; swmal [email removed]
&lt;br&gt;
&lt;b&gt;Inviato:&lt;/b&gt; lunedì 26 gennaio 2015 22:46&lt;br&gt;
&lt;b&gt;A:&lt;/b&gt; [email removed]&lt;br&gt;
&lt;b&gt;Oggetto:&lt;/b&gt; Re: Formula Evaluation error [EPPlus:577630]&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 9pt;"&gt;From: swmal&lt;/span&gt;&lt;/p&gt;
&lt;div id="ThreadNotificationPostBody" style="margin-bottom: 24pt;"&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 9pt;"&gt;I think I have found the error now. You have a worksheet named MODELLO-TIPO PANNELLO. If you remove the - in other words rename the worksheet to MODELLO TIPO PANNELLO it seems to work.
&lt;br&gt;
&lt;br&gt;
It seems like EPPlus currently cannot handle the - character in worksheet names. &lt;/span&gt;
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="swmal" When="27/01/2015 10:05:08">
          <Html>
        &lt;div class="markDownOutput "&gt;Ok, thanks for your feedback anyway. Thanks to the workbook you supplied we managed to fix a few bugs and performance issues- next version of EPPlus will be able to parse your entire workbook in some seconds and the problem with worksheet names is fixed.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="denisplex" When="27/01/2015 10:14:48">
          <Html>
        
&lt;div&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;I’ve downloaded source code, recompiled end referenced the EPPLus library to my project, just to try the library&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;Honestly it still does not work.&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;By.&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(34, 34, 34);"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;div&gt;
&lt;div style="border-width: 1pt medium medium; border-style: solid none none; border-color: rgb(225, 225, 225) currentColor currentColor; padding: 3pt 0cm 0cm; border-image: none;"&gt;
&lt;p&gt;&lt;b&gt;&lt;span style="font-family:; font-size: 11pt;"&gt;Da:&lt;/span&gt;&lt;/b&gt;&lt;span style="font-family:; font-size: 11pt;"&gt; swmal [email removed]
&lt;br&gt;
&lt;b&gt;Inviato:&lt;/b&gt; martedì 27 gennaio 2015 11:07&lt;br&gt;
&lt;b&gt;A:&lt;/b&gt; [email removed]&lt;br&gt;
&lt;b&gt;Oggetto:&lt;/b&gt; Re: Formula Evaluation error [EPPlus:577630]&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 9pt;"&gt;From: swmal&lt;/span&gt;&lt;/p&gt;
&lt;div id="ThreadNotificationPostBody" style="margin-bottom: 24pt;"&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 9pt;"&gt;Ok, thanks for your feedback anyway. Thanks to the workbook you supplied we managed to fix a few bugs and performance issues- next version of EPPlus will be able to parse your entire workbook in some seconds and
 the problem with worksheet names is fixed.&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="swmal" When="29/01/2015 12:40:36">
          <Html>
        &lt;div class="markDownOutput "&gt;Sorry to hear that this did not work out. Just wanted to share the tests that I performed on the workbooks you enclosed with the issue you created.
&lt;br&gt;
&lt;br&gt;
These tests both succeeds. If you have the time it would be valuable if you provided more detailed information about the error.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;        [TestMethod]
        public void Issue15173_1()
        {
            using (var pck = new ExcelPackage(new FileInfo(@"c:\temp\EPPlusIssues\Excel01.xlsx")))
            {
                var sw = new Stopwatch();
                pck.Workbook.FormulaParser.Configure(x =&amp;gt; x.AttachLogger(LoggerFactory.CreateTextFileLogger(new FileInfo(@"c:\Temp\log1.txt"))));
                sw.Start();
                var ws = pck.Workbook.Worksheets.First();
                //ws.Calculate();
                pck.Workbook.Calculate();
                Assert.AreEqual("20L2300", ws.Cells["F4"].Value);
                Assert.AreEqual("20K2E01", ws.Cells["F5"].Value);
                sw.Stop();
                Console.WriteLine(sw.Elapsed.TotalSeconds); // approx. 10 seconds

            }
        }

        [TestMethod]
        public void Issue15173_2()
        {
            using (var pck = new ExcelPackage(new FileInfo(@"c:\temp\EPPlusIssues\Excel02.xlsx")))
            {
                var sw = new Stopwatch();
                pck.Workbook.FormulaParser.Configure(x =&amp;gt; x.AttachLogger(LoggerFactory.CreateTextFileLogger(new FileInfo(@"c:\Temp\log1.txt"))));
                sw.Start();
                var ws = pck.Workbook.Worksheets.First();
                //ws.Calculate();
                pck.Workbook.Calculate();
                Assert.AreEqual("20L2300", ws.Cells["F4"].Value);
                Assert.AreEqual("20K2E01", ws.Cells["F5"].Value);
                sw.Stop();
                Console.WriteLine(sw.Elapsed.TotalSeconds); // approx. 10 seconds

            }
        }&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Cells with formula freeze">
      <Posts>
        <Post From="zonk_shtol" When="29/01/2015 12:04:27">
          <Html>
        &lt;div class="markDownOutput "&gt;I've created a simple spreadsheet with Excel:&lt;br&gt;
&lt;ul&gt;
&lt;li&gt;cell A1 set to 1 &lt;/li&gt;&lt;li&gt;cell B1 set to 2 &lt;/li&gt;&lt;li&gt;cell C1 set to =A1+B1&lt;br&gt;
&lt;/li&gt;&lt;/ul&gt;
Then I loaded this document using epplus, changed A1 value to 5 and saved the document.
&lt;br&gt;
After manipulations made with epplus I open the document with Excel and I see that cell C1 is showing a value of 3 instead of 7.
&lt;br&gt;
&lt;br&gt;
I'm using epplus 4.0.2 now. There was no such problem in epplus 4 beta 2.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Error in tokenizer?">
      <Posts>
        <Post From="niklasjansson" When="21/01/2015 12:48:38">
          <Html>
        &lt;div class="markDownOutput "&gt;I tried to use the (undocumented) formula parsing thing, I would like to know which worksheet a cell is linked to:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;var Formula = c.Formula;
var tokens = formulaParser.Lexer.Tokenize(Formula);
var references = tokens.Where(x =&amp;gt; x.TokenType == TokenType.ExcelAddress);&lt;/code&gt;&lt;/pre&gt;
For a worksheet with the following name: "A - B", I get a formula: &lt;br&gt;
'A - B'!A1 &lt;br&gt;
This is parsed as three tokens:&lt;br&gt;
&lt;ul&gt;
&lt;li&gt;'A &lt;/li&gt;&lt;li&gt;- &lt;/li&gt;&lt;li&gt;B'!A1&lt;br&gt;
&lt;/li&gt;&lt;/ul&gt;
Meaning only the last of them is considered being a reference.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="21/01/2015 16:15:40">
          <Html>
        &lt;div class="markDownOutput "&gt;Hej Niklas, &lt;br&gt;
&lt;br&gt;
I have just (in another issue) discovered a bug in EPPlus that causes this error when the worksheet name contains a "-". We will fix this in next version, but in the meantime you need to rename the worksheet, removing the "-".
&lt;br&gt;
&lt;br&gt;
/Mats&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="niklasjansson" When="28/01/2015 13:57:46">
          <Html>
        &lt;div class="markDownOutput "&gt;Hej,&lt;br&gt;
&lt;br&gt;
I solved it by backtracking through the tokens and stopping at anything that begins with '.&lt;br&gt;
A variation of the same problem, or possibly another and related;&lt;br&gt;
&lt;br&gt;
'A - B. C'!A10&lt;br&gt;
&lt;br&gt;
Seems to be interpreted as &lt;br&gt;
&lt;ul&gt;
&lt;li&gt;A &lt;/li&gt;&lt;li&gt;- &lt;/li&gt;&lt;li&gt;B. C'A10&lt;br&gt;
&lt;/li&gt;&lt;/ul&gt;
The difference here is that the last one is of type named range instead.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Any ways to increase speed when creating ExcelPackage from Dataset, or saving package to file?">
      <Posts>
        <Post From="derekj" When="24/07/2014 19:50:22">
          <Html>
        &lt;div class="markDownOutput "&gt;I recently updated my .NET application to stop using the Microsoft Excel interop library because it's slow for some actions, and now it's using EPPlus.&lt;br&gt;
&lt;br&gt;
Using EPPlus improved the speed of creating an Excel file by about 50%. All the actions involving editing worksheets are much faster, but is there any way to improve the speed of generating the ExcelPackage, or saving to a file? (In some cases, saving the ExcelPackage
 to a file is slower than saving an Excel file using MS Excel interop - but overall performance is still better).&lt;br&gt;
&lt;br&gt;
The spreadsheet has 32 worksheets, with about 1.2 million cells between them (average of about 60 columns per worksheet, with about 20,000 rows split between the worksheets). Excel file size is about 6.2 MB.&lt;br&gt;
&lt;br&gt;
After getting the Dataset, saving the Excel file takes ~16 seconds. This is about ~4 seconds to create the ExcelPackage from the DataSet, ~1 second for formatting (comments, dropdown formulas, worksheet protection, etc), and ~11 seconds for saving the Excel
 file.&lt;br&gt;
&lt;br&gt;
Here is the code for creating the ExcelPackage:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;Public Shared Function CreateExcelPackageFromDS(ByVal ds As DataSet) As ExcelPackage
    Dim xlPackage As New ExcelPackage()
    Dim oBook As ExcelWorkbook = xlPackage.Workbook

    'Load each table into worksheet
    For Each dt As System.Data.DataTable In ds.Tables
        Dim ws As ExcelWorksheet = oBook.Worksheets.Add(dt.TableName)
        ws.Cells.LoadFromDataTable(dt, True)
        ws.Cells.Style.Locked = False
    Next

    Return xlPackage
End Function

&lt;/code&gt;&lt;/pre&gt;
And the code for saving the Excel file, after all the formatting is done, is just:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;        Dim excelFile As New FileInfo(tempFilesPath &amp;amp; "\Export" &amp;amp; userID &amp;amp; ".xlsx")
        xlPackage.SaveAs(excelFile)

&lt;/code&gt;&lt;/pre&gt;
Is anyone aware of any things that could be changed, in order to improve the performance of creating the Excel package, or for saving the Excel file? Or is this level of performance about what should be expected, given this amount of worksheets, rows, cells,
 etc.?&lt;br&gt;
&lt;br&gt;
(Edit: This is running on my local machine. File path for saving Excel file is just a folder on C: drive. Computer has Intel Xeon dual core processor and 6 GB RAM.)&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="insomniac4104" When="27/01/2015 16:45:17">
          <Html>
        &lt;div class="markDownOutput "&gt;I also have the same problem. Writing a data table with 3500 rows is taking almost 10 seconds a row. I would like to find an answer. I also posted a similar questions.
&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="error when creating excel file from existing excel file">
      <Posts>
        <Post From="demirkeser" When="26/01/2015 21:15:38">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello, &lt;br&gt;
I am trying to create file from exists excel file. But i got an error message &lt;br&gt;
&lt;br&gt;
I have code such as ;&lt;br&gt;
&lt;pre&gt;&lt;code&gt;            string path = Server.MapPath("/");
            FileInfo dosya = new FileInfo(path + "personelbilgi.xlsx");
            if( dosya.Exists){
                Response.Write("dosya var");
            }
            ExcelPackage xlsDosya = new ExcelPackage(dosya, true);

            ExcelWorksheet sheet = xlsDosya.Workbook.Worksheets[1];

            sheet.Cells["C3"].Value = "SÜLEYMAN";

            Response.Clear();
            Response.ContentType = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";
            Response.AddHeader("content-disposition", "attachment;  filename=Analiz.xlsx");
            Response.BinaryWrite(xlsDosya.GetAsByteArray());
            Response.End();&lt;/code&gt;&lt;/pre&gt;
but i got this error message;&lt;br&gt;
&lt;blockquote&gt;[ArgumentException: Aynı anahtara sahip öğe zaten eklenmiş.]&lt;br&gt;
System.ThrowHelper.ThrowArgumentException(ExceptionResource resource) +52&lt;br&gt;
System.Collections.Generic.Dictionary&lt;code&gt;2.Insert(TKey key, TValue value, Boolean add) +11187358&lt;br&gt;
System.Collections.Generic.Dictionary&lt;/code&gt;2.Add(TKey key, TValue value) +10&lt;br&gt;
OfficeOpenXml.Packaging.ZipPackageRelationshipCollection.Add(ZipPackageRelationship item) +72&lt;br&gt;
OfficeOpenXml.Packaging.ZipPackageRelationshipBase.CreateRelationship(Uri targetUri, TargetMode targetMode, String relationshipType) +219&lt;br&gt;
OfficeOpenXml.Packaging.ZipPackagePart.CreateRelationship(Uri targetUri, TargetMode targetMode, String relationshipType) +58&lt;br&gt;
OfficeOpenXml.ExcelWorkbook.Save() +1218&lt;br&gt;
OfficeOpenXml.ExcelPackage.GetAsByteArray(Boolean save) +114&lt;br&gt;
OfficeOpenXml.ExcelPackage.GetAsByteArray() +41&lt;br&gt;
ExcelRead.Default2.Page_Load(Object sender, EventArgs e) in d:\proje\ExcelRead\ExcelRead\Default2.aspx.cs:27&lt;br&gt;
System.Web.Util.CalliEventHandlerDelegateProxy.Callback(Object sender, EventArgs e) +51&lt;br&gt;
System.Web.UI.Control.OnLoad(EventArgs e) +92&lt;br&gt;
System.Web.UI.Control.LoadRecursive() +54&lt;br&gt;
System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +772&lt;br&gt;
&lt;/blockquote&gt;
what could i do? &lt;br&gt;
&lt;br&gt;
thank you&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Unmerge a Range">
      <Posts>
        <Post From="jdnichollsc" When="22/01/2015 16:00:45">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi guys! &lt;br&gt;
&lt;br&gt;
In December had reported an error with unmerge a range: &lt;a href="https://epplus.codeplex.com/discussions/574716" rel="nofollow"&gt;
https://epplus.codeplex.com/discussions/574716&lt;/a&gt; &lt;br&gt;
&lt;br&gt;
And later another person also &lt;a href="http://epplus.codeplex.com/workitem/15134" rel="nofollow"&gt;
http://epplus.codeplex.com/workitem/15134&lt;/a&gt; &lt;br&gt;
&lt;br&gt;
Any progress on this? &lt;br&gt;
&lt;br&gt;
Regards, Nicholls&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="23/01/2015 18:08:30">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi Nicholls! &lt;br&gt;
&lt;br&gt;
If range A1:B1 is merged, you can remove the merging of the cells like this:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;ws.Cells["A1:B1"].Merge = false;&lt;/code&gt;&lt;/pre&gt;
Does this not work for you? If not, please create an issue with a reproducible error.
&lt;br&gt;
&lt;br&gt;
/Mats&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="jdnichollsc" When="23/01/2015 18:58:28">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi Mats! &lt;br&gt;
&lt;br&gt;
Thanks for your response, I will try to make a reproducible example. &lt;br&gt;
&lt;br&gt;
Meanwhile do you think of my solution? =&amp;gt; &lt;a href="https://epplus.codeplex.com/workitem/15179" rel="nofollow"&gt;
https://epplus.codeplex.com/workitem/15179&lt;/a&gt; &lt;br&gt;
&lt;br&gt;
Regards, Nicholls&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="23/01/2015 19:10:59">
          <Html>
        &lt;div class="markDownOutput "&gt;Ok, I did not get that this was related to deleting cells as well. I just tried to merge and then unmerge which seemed to work fine... I will ask Jan to have a look at this, he knows these things better than myself and he has done a lot of work on the
 cell store lately. &lt;br&gt;
&lt;br&gt;
Thanks for sharing your solution! &lt;br&gt;
&lt;br&gt;
/Mats&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="jdnichollsc" When="23/01/2015 21:21:14">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi Mats!&lt;br&gt;
&lt;br&gt;
Plase give me an email to send you the demo, I can't in CodePlex =&amp;gt; &lt;a href="https://epplus.codeplex.com/workitem/15182/" rel="nofollow"&gt;
https://epplus.codeplex.com/workitem/15182/&lt;/a&gt; &lt;br&gt;
My email is &lt;a href="mailto:jdnichollsc@hotmail.com&amp;amp;&lt;a class=" workitemlink"=""&gt;#10&lt;/a&gt;;&amp;amp;&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/10"&gt;#10&lt;/a&gt;;Thanks" rel="nofollow"&amp;gt;jdnichollsc@hotmail.com Thanks in advance, Nicholls&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="25/01/2015 12:29:44">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi Nicholls! &lt;br&gt;
&lt;br&gt;
I spoke to Jan about this today and he thinks that he has fixed it, he will push it to Codeplex today or tomorrow. We are planning to release a new version next week.
&lt;br&gt;
&lt;br&gt;
You can send the demo to &lt;a href="mailto:epplusproj@gmail.com." rel="nofollow"&gt;epplusproj@gmail.com.&lt;/a&gt;&lt;br&gt;
&lt;br&gt;
/Mats&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="jdnichollsc" When="26/01/2015 00:46:30">
          <Html>
        &lt;div class="markDownOutput "&gt;Ohhh nice! Thanks Mats for your help and I send greetings to Jan!&lt;br&gt;
&lt;br&gt;
Nicholls&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="jdnichollsc" When="26/01/2015 14:25:21">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi Mats&lt;br&gt;
&lt;br&gt;
I tryed with the last commit &lt;strong&gt;aa51fa8165f5&lt;/strong&gt; but when I try to open the excel file shows me error
&lt;a href="http://screencast.com/t/TKOd2I0xCA" rel="nofollow"&gt;http://screencast.com/t/TKOd2I0xCA&lt;/a&gt;&lt;br&gt;
&lt;br&gt;
&lt;img alt="Image" src="http://content.screencast.com/users/jdnichollsc/folders/Jing/media/68137513-fa15-41ea-a79f-9afc8616a2fa/error%20excel%20open%20file%20epplus.png"&gt;&lt;br&gt;
&lt;br&gt;
I could attach the file &lt;a href="https://epplus.codeplex.com/workitem/15182" rel="nofollow"&gt;
https://epplus.codeplex.com/workitem/15182&lt;/a&gt;&lt;br&gt;
&lt;br&gt;
Regards, Nicholls&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Can't copy columns from one sheet to another">
      <Posts>
        <Post From="jalalx" When="26/01/2015 09:14:05">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello&lt;br&gt;
Thank you for sharing this library :)&lt;br&gt;
I'm using following code to copy all columns from one sheet to another and mirror them. (mirror means first column in source worksheet will be last column in destination sheet):&lt;br&gt;
&lt;pre&gt;&lt;code&gt;            using (var package = new ExcelPackage(new FileInfo(@"C:\Users\Jalal\Desktop\Report.xlsx")))
            {
                var worksheet = package.Workbook.Worksheets.FirstOrDefault();
                if (worksheet == null)
                    return;

                var fixedWorksheet = package.Workbook.Worksheets.Add("Page2");

                int startRow = worksheet.Dimension.Start.Row;
                int startColumn = worksheet.Dimension.Start.Column;
                int endRow = worksheet.Dimension.End.Row;
                int endColumn = worksheet.Dimension.End.Column;
                //MessageBox.Show(String.Format("Rows:{0}, Columns:{1}", rows, columns));

                int currentColumn = 1;
                while (currentColumn &amp;lt;= endColumn)
                {
                    var localAddress = ExcelRangeBase.GetAddress(startRow, currentColumn, endRow, currentColumn);
                    var sourceColumnAddress = ExcelRangeBase.GetFullAddress(worksheet.Name, localAddress);

                    var targetAddress = ExcelRangeBase.GetAddress(startRow, endColumn, endRow, endColumn);
                    var targetColumnAddress = ExcelRangeBase.GetFullAddress(fixedWorksheet.Name, targetAddress);

                    var sourceRange = worksheet.Cells[sourceColumnAddress];
                    var targetRange = worksheet.Cells[targetColumnAddress];
                    
                    sourceRange.Copy(targetRange); // InvalidOperationException: Can't delete merged cells. A range is partly merged with the deleted range. A1:I1



                    backgroundWorker1.ReportProgress((int)((currentColumn * 1d / endColumn * 1d) * 100d));
                    currentColumn++;
                }

                package.SaveAs(new FileInfo(@"C:\Users\Jalal\Desktop\ReportMirrored.xlsx"));
            }
        }
&lt;/code&gt;&lt;/pre&gt;
Exception details:&lt;br&gt;
System.InvalidOperationException was unhandled by user code&lt;br&gt;
HResult=-2146233079&lt;br&gt;
Message=Can't delete merged cells. A range is partly merged with the deleted range. A1:I1&lt;br&gt;
Source=EPPlus&lt;br&gt;
StackTrace:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;   at OfficeOpenXml.ExcelWorksheet.MergeCellsCollection.Delete(ExcelAddressBase Destination)
   at OfficeOpenXml.ExcelRangeBase.Copy(ExcelRangeBase Destination)
   at ExcelAlignmentFixer.Form1.MirrorColumns(DoWorkEventArgs e) in c:\Users\Jalal\Documents\Visual Studio 2013\Projects\ExcelAlignmentFixer\ExcelAlignmentFixer\Form1.cs:line 67
   at ExcelAlignmentFixer.Form1.backgroundWorker1_DoWork(Object sender, DoWorkEventArgs e) in c:\Users\Jalal\Documents\Visual Studio 2013\Projects\ExcelAlignmentFixer\ExcelAlignmentFixer\Form1.cs:line 81
   at System.ComponentModel.BackgroundWorker.OnDoWork(DoWorkEventArgs e)
   at System.ComponentModel.BackgroundWorker.WorkerThreadStart(Object argument)&lt;/code&gt;&lt;/pre&gt;
InnerException: null&lt;br&gt;
&lt;br&gt;
Sample excel file: &lt;a href="http://ge.tt/5zawbH92/v/0" rel="nofollow"&gt;http://ge.tt/5zawbH92/v/0&lt;/a&gt;&lt;br&gt;
EPPlus version: 4.0.2&lt;br&gt;
Thanks in advance&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="EPPlus and PowerShell examples">
      <Posts>
        <Post From="ffeldhaus" When="24/01/2015 11:32:14">
          <Html>
        &lt;div class="markDownOutput "&gt;Recently I needed to create and modify Excel Files with PowerShell on a server which didn't have Excel installed. As I couldn't find much information on the web, I created a few examples using EPPlus and posted them as answers to fitting StackOverflow
 questions. &lt;br&gt;
&lt;br&gt;
Maybe they are helpful for others as well:&lt;br&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="http://stackoverflow.com/questions/17688468/how-to-export-a-csv-to-excel-using-powershell/27691757&lt;a class=" workitemlink"=""&gt;#27691757&lt;/a&gt;" rel="nofollow"&amp;gt;Import CSV to Excel with PowerShell
&lt;/li&gt;&lt;li&gt;&lt;a href="http://stackoverflow.com/questions/19638185/powershell-convert-csv-to-xls-without-excel-installed/27692671&lt;a class=" workitemlink"=""&gt;#27692671&lt;/a&gt;" rel="nofollow"&amp;gt;Encrypt and lock down Excel file with PowerShell
&lt;/li&gt;&lt;li&gt;&lt;a href="http://stackoverflow.com/questions/20011481/powershell-excel-access-without-installing-excel/27710299&lt;a class=" workitemlink"=""&gt;#27710299&lt;/a&gt;" rel="nofollow"&amp;gt;Password protection on Excel files with PowerShell&lt;br&gt;
&lt;/li&gt;&lt;/ul&gt;
If there's interest in more detailed PowerShell examples, I'd be happy to help create them. Just post to this thread what examples would be useful.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Save prompt when opening file with formulas">
      <Posts>
        <Post From="STiLeTT" When="19/12/2014 18:31:25">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello! &lt;br&gt;
I have a problem: when I save excel with formulas and open it, and then immediately close it without making any changes, it asks me to save changes.
&lt;br&gt;
&lt;br&gt;
I have found old threads about this behavior, and the reason was because EPPlus didn't have a calculation engine and it's Excel who calculates formulas on load, what is considered as changes. But now in v4 EPPlus have a calculation engine and this problem must
 disappear, but calling Calculate() doesn't help. &lt;br&gt;
&lt;br&gt;
How can I overcome this issue? &lt;br&gt;
&lt;br&gt;
You can reproduce this by opening Excel file generated by sample 1 and immediately close it.
&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="STiLeTT" When="23/01/2015 11:27:52">
          <Html>
        &lt;div class="markDownOutput "&gt;There's also an issue about this: &lt;a href="https://epplus.codeplex.com/workitem/15157" rel="nofollow"&gt;
https://epplus.codeplex.com/workitem/15157&lt;/a&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="multiple sheets not getting data after first sheet">
      <Posts>
        <Post From="insomniac4104" When="22/01/2015 16:06:36">
          <Html>
        &lt;div class="markDownOutput "&gt;So I created an excel sheet works fine. If I add more than one excel sheet the sheet gets created.
&lt;br&gt;
However there is no data or even headers on the 2nd and 3rd sheets. &lt;br&gt;
&lt;br&gt;
I am guessing some how I have to set which is current active sheet? &lt;br&gt;
&lt;br&gt;
Can someone tell me how to do this? &lt;br&gt;
If you need my code I can reply with it. &lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Thanks. &lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="22/01/2015 21:55:49">
          <Html>
        &lt;div class="markDownOutput "&gt;I dont really get what the problem is, but hopefully this can help:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;using(var pck = new ExcelPackage())
{
   pck.Workbook.Worksheets.Add("WS 1");
   pck.Workbook.Worksheets.Add("WS 2");

   var currentSheet = pck.Workbook.Worksheets["WS 1"];
   // change sheet
   currentSheet = pck.Workbook.Worksheets["WS 2"];
}&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="insomniac4104" When="22/01/2015 22:09:27">
          <Html>
        &lt;div class="markDownOutput "&gt;I found my problem. &lt;br&gt;
It was putting the data on the page. &lt;br&gt;
Just way down. I forgot to set the row start back to 1. oops :-). &lt;br&gt;
&lt;br&gt;
Thanks anyways.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Wraptext = true problem">
      <Posts>
        <Post From="jvam90" When="08/08/2012 15:28:18">
          <Html>
        
&lt;p&gt;Hello everyone. I'm generating an excel report through EPPLUS and there's one column that is particularly big (lots of words) and i'd like to after some words inside the cell, add a line break for a better legibility. I've searched a bit and i've came across
 this property wraptext.&lt;/p&gt;
&lt;p&gt;But, instead of something like this:&lt;/p&gt;
&lt;p&gt;"This is some random text inside a cell.&lt;/p&gt;
&lt;p&gt;It was supposed to go like this."&lt;/p&gt;
&lt;p&gt;it goes like this:&lt;/p&gt;
&lt;p&gt;"This&lt;/p&gt;
&lt;p&gt;is&lt;/p&gt;
&lt;p&gt;some&lt;/p&gt;
&lt;p&gt;random&lt;/p&gt;
&lt;p&gt;text&lt;/p&gt;
&lt;p&gt;inside&lt;/p&gt;
&lt;p&gt;a&lt;/p&gt;
&lt;p&gt;cell"&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Any solutions for this one? (i'm using the latest epplus version)&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="17/08/2012 14:08:28">
          <Html>
        
&lt;p&gt;Wraptext property will not resize your column, maybe your column is really tight.&lt;/p&gt;
&lt;p&gt;&lt;a href="http://i.imgur.com/4qtEm.png" target="_blank" rel="nofollow"&gt;http://i.imgur.com/4qtEm.png&lt;/a&gt;&amp;nbsp;( code below will produce this excel )&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;            &lt;span style="color: blue;"&gt;using&lt;/span&gt; (ExcelPackage p = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(&lt;span style="color: blue;"&gt;new&lt;/span&gt; FileInfo(&lt;span style="color: rgb(163, 21, 21);"&gt;@"c:\test.xlsx"&lt;/span&gt;)))
            {

                &lt;span style="color: blue;"&gt;var&lt;/span&gt; w = p.Workbook.Worksheets.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"test"&lt;/span&gt;);

                w.Column(1).Width = 10;
                w.Column(2).Width = 15;
                w.Column(3).Width = 20;
                w.Column(3).Width = 30;

                w.Cells[1, 1].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"This is a random text inside cell."&lt;/span&gt;;
                w.Cells[1, 2].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"This is a random text inside cell."&lt;/span&gt;;
                w.Cells[1, 3].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"This is a random text inside cell."&lt;/span&gt;;
                w.Cells[1, 4].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"This is a random text inside cell."&lt;/span&gt;;

                w.Cells[1, 1].Style.WrapText = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
                w.Cells[1, 2].Style.WrapText = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
                w.Cells[1, 3].Style.WrapText = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
                w.Cells[1, 4].Style.WrapText = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;


                p.Save();

            }
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="sarisetty" When="22/01/2015 05:44:08">
          <Html>
        &lt;div class="markDownOutput "&gt;How do we compute the cell width? &lt;br&gt;
&lt;br&gt;
Is it computed based on the font size, as well as the text width? &lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Cell with newline does not show text on multiple lines">
      <Posts>
        <Post From="wroopy" When="22/08/2011 15:41:52">
          <Html>
        
&lt;p&gt;Hi!&lt;/p&gt;
&lt;table width="100%" border="0" cellspacing="0" cellpadding="0"&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td valign="bottom"&gt;
&lt;p&gt;I'm getting the data from a SQL-table. One field is adressinformation where name, address, postal address is separated with newline (i.e. Environment.Newline).&lt;/p&gt;
&lt;p&gt;First I got the problem that newlines where shown as _x00D_, but I solved by compiling the latest version from source.&lt;/p&gt;
&lt;p&gt;Now I have the problem that the text is printed on one line. If I double click on a cell with a newline and then clicks on another cell, the text is show on multiple lines.&lt;/p&gt;
&lt;p&gt;Is there a property or similiar to set that does nor require the user to doubleclick a cell to see the content on multiple lines?&lt;/p&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;/Andreas&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="23/08/2011 20:01:59">
          <Html>
        
&lt;p&gt;Have you set the &lt;strong&gt;Style.WrapText&lt;/strong&gt; property for the range?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="wroopy" When="24/08/2011 08:08:58">
          <Html>
        
&lt;blockquote style="margin: 0.25em 1em 0px; padding: 0px 0.25em; border: 0.1em solid rgb(204, 204, 204); border-image: none; font-style: italic;"&gt;
&lt;strong&gt;JanKallman wrote:&lt;/strong&gt;&lt;br&gt;
&lt;p&gt;Have you set the &lt;strong&gt;Style.WrapText&lt;/strong&gt; property for the range?&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;No i didn't &amp;nbsp;set Style.WrapText. &amp;nbsp;Now I've done it and it works as expected.&lt;/p&gt;
&lt;p&gt;Thank you!&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="bassvix" When="11/01/2012 04:44:47">
          <Html>
        
&lt;p&gt;Same problem.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="sarisetty" When="22/01/2015 05:39:08">
          <Html>
        &lt;div class="markDownOutput "&gt;If the text is lets say "Testing line breaks in Epplus /r/n Not Working"
&lt;br&gt;
&lt;br&gt;
Setting the Style.WrapText=true is rendering the column as &lt;br&gt;
&lt;br&gt;
Testing &lt;br&gt;
line &lt;br&gt;
breaks &lt;br&gt;
in &lt;br&gt;
Epplus &lt;br&gt;
Not &lt;br&gt;
Working &lt;br&gt;
&lt;br&gt;
However, I would like to view it as &lt;br&gt;
&lt;br&gt;
Testing line breaks in Epplus &lt;br&gt;
Not working&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Is it possible to access the styleid from the Style object?">
      <Posts>
        <Post From="jdnichollsc" When="21/01/2015 14:41:49">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi guys! :D &lt;br&gt;
&lt;br&gt;
In my project I need to copy the style from one cell to another from the Style object like this&lt;br&gt;
&lt;pre&gt;&lt;code&gt;var styleCell =  worksheet.Cells[3, 7].Style;

//More more code

worksheet.Cells[3, 8].Style = styleCell; //error because Style is read only&lt;/code&gt;&lt;/pre&gt;
How I can access the styleid from styleCell object? &lt;br&gt;
&lt;br&gt;
&lt;strong&gt;Thanks in advance, Nicholls&lt;/strong&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Concatenate int value with string is the cause of formula evaluation error">
      <Posts>
        <Post From="denisplex" When="20/01/2015 10:50:13">
          <Html>
        &lt;div class="markDownOutput "&gt;In this thread I refer to my previous thread FORMULA EVALUATION ERROR &lt;br&gt;
&lt;br&gt;
Doing a lot of tests I notice that if I use CONCATENATE to union int value with string value something in EPPLUS goes wrong. Combining string value with string value formula calculate correctly.
&lt;br&gt;
&lt;br&gt;
Maybe the problem is in function ConvertUtil.IsNumericString that return True instead of False.
&lt;br&gt;
&lt;br&gt;
I hope to receive some information soon. &lt;br&gt;
&lt;br&gt;
Denis&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="20/01/2015 15:01:59">
          <Html>
        &lt;div class="markDownOutput "&gt;Ok, thats good information and helps me narrowing down to the problem. I will try to fix this asap.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="load xml from file or stream">
      <Posts>
        <Post From="rajkob" When="17/01/2015 19:37:19">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
Is there any way to load xml into a workbook from an xml file or a memory stream? Preferably the same way excel would import it.
&lt;br&gt;
&lt;br&gt;
TIA&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Open xlsx over http">
      <Posts>
        <Post From="carlosfreitas" When="15/01/2015 09:36:49">
          <Html>
        &lt;div class="markDownOutput "&gt;In version 3.0.x of the library I use to open a xlsx document from a webserver, make the desired changes and then send it to the browser.
&lt;br&gt;
&lt;br&gt;
While trying to migrate to version 4.0.2 the part of the code that loads the initial file started throwing the exception:
&lt;br&gt;
&lt;br&gt;
An unhandled exception of type 'System.NotSupportedException' occurred in System.dll
&lt;br&gt;
&lt;br&gt;
Additional information: This stream does not support seek operations. &lt;br&gt;
&lt;br&gt;
The code:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;  ExcelPackage p = new ExcelPackage();
  System.Net.HttpWebRequest request = (HttpWebRequest)WebRequest.Create(FullUrl);
  HttpWebResponse response = (HttpWebResponse)request.GetResponse();
  p.Load(response.GetResponseStream());

&lt;/code&gt;&lt;/pre&gt;
To exclude any problem with the template file, I've copied it locally and was able to read it without any issue.
&lt;br&gt;
&lt;br&gt;
Any idea? &lt;br&gt;
&lt;br&gt;
Thanks&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Thanks for the updates to EPPlus">
      <Posts>
        <Post From="jdnichollsc" When="14/01/2015 19:15:14">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi guys! &lt;br&gt;
&lt;br&gt;
I want to thank you for the fixes made to EPPlus!! :D &lt;br&gt;
&lt;br&gt;
PD: One question... When these changes will be included in the EPPlus 4.0.1 stable version?
&lt;br&gt;
&lt;br&gt;
Regards, Nicholls&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="14/01/2015 20:45:08">
          <Html>
        &lt;div class="markDownOutput "&gt;Thanks Nicholls! &lt;br&gt;
&lt;br&gt;
There will be a new version with the latest changes any day now - I spoke with Jan about this yesterday.
&lt;br&gt;
&lt;br&gt;
/Mats&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="jdnichollsc" When="14/01/2015 20:53:51">
          <Html>
        &lt;div class="markDownOutput "&gt;woowww! haha excellent!! &lt;br&gt;
&lt;br&gt;
Thanks for all my friend! :) &lt;br&gt;
&lt;br&gt;
Regards, Nicholls&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Formating lines in a LineChart">
      <Posts>
        <Post From="rbasniak" When="30/01/2012 17:19:00">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I just downloaded EPPlus 3.0 beta and started playing around. But I couldn't find a way to change the colors of lines and markers of a Line Chart. Is there any to do this?&lt;/p&gt;
&lt;p&gt;Thanks in advance,&lt;/p&gt;
&lt;p&gt;Rodrigo Basniak&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="31/01/2012 18:32:07">
          <Html>
        
&lt;p&gt;No, I haven't implemented that yet. But it shoulden't be to hard to implement. (A new property on the ExcelLineChartSerie is my guess).&lt;/p&gt;
&lt;p&gt;Feel free to have a look at it, otherwise I will put it on my todo list.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="ilbarzo" When="20/05/2013 13:00:51">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
I also need these functions, different lines color, line styles (dotted, dashed, solid...).
&lt;br&gt;
Any news about this?? &lt;br&gt;
&lt;br&gt;
Best regards &lt;br&gt;
Cristian Barzaghi&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Kaptein" When="28/05/2013 11:44:11">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi,&lt;br&gt;
&lt;br&gt;
I also needed to set custom line colors for different series in one chart, so I went ahead and added this to ExcelLineChartSerie.cs:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;string LINECOLOR_PATH = "c:spPr/a:ln/a:solidFill/a:srgbClr/@val";
/// &amp;lt;summary&amp;gt;
/// Line color
/// &amp;lt;/summary&amp;gt;
public string LineColor
{
    get
    {
        return GetXmlNodeString(LINECOLOR_PATH);
    }
    set
    {
        SetXmlNodeString(LINECOLOR_PATH, value, true);
    }
}
&lt;/code&gt;&lt;/pre&gt;
It only works with RGB color codes, i.e. using chartSerieObject.LineColor = "FF0000" for a red line, but that's fine for my purpose.&lt;br&gt;
&lt;br&gt;
Cheers,&lt;br&gt;
&lt;br&gt;
Kaptein&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="ilbarzo" When="28/05/2013 12:38:57">
          <Html>
        &lt;div class="markDownOutput "&gt;Thanks Kaptein!! &lt;br&gt;
&lt;br&gt;
this will usefull. &lt;br&gt;
can you tell me were I can found a full xml reference for excel chart path definition??
&lt;br&gt;
&lt;br&gt;
Best regards &lt;br&gt;
Cristian&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Kaptein" When="28/05/2013 14:00:28">
          <Html>
        &lt;div class="markDownOutput "&gt;No problem, hope it was useful. &lt;br&gt;
&lt;br&gt;
I don't know where to find a full reference - and I would probably not use it if I had it for the sake of time. I just created two .xlsx files, with and without custom colors, extracted the xml and compared the chart1.xml files in Notepad++. Found the path
 and used that to update the library code. &lt;br&gt;
&lt;br&gt;
Cheers, &lt;br&gt;
&lt;br&gt;
Kaptein&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="ilbarzo" When="28/05/2013 14:37:44">
          <Html>
        &lt;div class="markDownOutput "&gt;Tnx for tips! &lt;br&gt;
&lt;br&gt;
for a dashed line style the path is similar to color: c:spPr/a:ln/a:prstDash/@val
&lt;br&gt;
for the values refer to the OOXML datatype: &lt;br&gt;
&lt;a href="http://www.schemacentral.com/sc/ooxml/a-val-84.html" rel="nofollow"&gt;http://www.schemacentral.com/sc/ooxml/a-val-84.html&lt;/a&gt;
&lt;br&gt;
&lt;br&gt;
I implemented it like the Marker property. &lt;br&gt;
That worked for me!! &lt;br&gt;
Hope this help someone. &lt;br&gt;
&lt;br&gt;
Cristian&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="tomercagan" When="05/03/2014 13:43:24">
          <Html>
        &lt;div class="markDownOutput "&gt;Is this going to be integrated into the main source (or maybe it is but not available via Nuget?)&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="markhalonen" When="11/08/2014 22:26:45">
          <Html>
        &lt;div class="markDownOutput "&gt;Kaptein, &lt;br&gt;
&lt;br&gt;
Thank you very much. You saved me many painful hours of work.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="wvd_vegt" When="18/09/2014 12:31:50">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi&lt;br&gt;
&lt;br&gt;
Here some code (based on Kaptein's code for which thanks). It van be added to both ExcelScatterSeries and ExcelLineSeries to add LineColor, LineWith and MarkerSize support to these two chart series.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;       #region EXTENSIONS

        string LINECOLOR_PATH = "c:spPr/a:ln/a:solidFill/a:srgbClr/@val";

        /// &amp;lt;summary&amp;gt;
        /// Line color.
        /// &amp;lt;/summary&amp;gt;
        ///
        /// &amp;lt;value&amp;gt;
        /// The color of the line.
        /// &amp;lt;/value&amp;gt;
        public Color LineColor
        {
            get
            {
                string color = GetXmlNodeString(LINECOLOR_PATH);
                if (color == "")
                {
                    return Color.Black;
                }
                else
                {
                    return Color.FromArgb(Convert.ToInt32(color, 16));
                }
            }
            set
            {
                SetXmlNodeString(LINECOLOR_PATH, value.ToArgb().ToString("X").Substring(2), true);
            }
        }

        string MARKERSIZE_PATH = "c:marker/c:size/@val";

        /// &amp;lt;summary&amp;gt;
        /// Gets or sets the size of the marker.
        /// &amp;lt;/summary&amp;gt;
        ///
        /// &amp;lt;remarks&amp;gt;
        /// value between 2 and 72.
        /// &amp;lt;/remarks&amp;gt;
        ///
        /// &amp;lt;value&amp;gt;
        /// The size of the marker.
        /// &amp;lt;/value&amp;gt;
        public int MarkerSize
        {
            get
            {
                string size = GetXmlNodeString(MARKERSIZE_PATH);
                if (size == "")
                {
                    return 5;
                }
                else
                {
                    return Int32.Parse(GetXmlNodeString(MARKERSIZE_PATH));
                }
            }
            set
            {
                int size = value;
                size = Math.Max(2, size);
                size = Math.Min(72, size);
                SetXmlNodeString(MARKERSIZE_PATH, size.ToString(), true);
            }
        }

        string LINEWIDTH_PATH = "c:spPr/a:ln/@w";

        /// &amp;lt;summary&amp;gt;
        /// Gets or sets the width of the line in pt.
        /// &amp;lt;/summary&amp;gt;
        ///
        /// &amp;lt;value&amp;gt;
        /// The width of the line.
        /// &amp;lt;/value&amp;gt;
        public double LineWidth
        {
            get
            {
                string size = GetXmlNodeString(LINEWIDTH_PATH);
                if (size == "")
                {
                    return 2.25;
                }
                else
                {
                    return double.Parse(GetXmlNodeString(LINEWIDTH_PATH)) / 12700;
                }
            }
            set
            {
                SetXmlNodeString(LINEWIDTH_PATH, ((int)(12700 * value)).ToString(), true);
            }
        }

        #endregion EXTENSIONS&lt;/code&gt;&lt;/pre&gt;
regards&lt;br&gt;
wvdv&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="cooljustin" When="23/10/2014 17:20:15">
          <Html>
        &lt;div class="markDownOutput "&gt;The code shared by wvd_vegt works great (don't forget to add "using System.Drawing;")
&lt;br&gt;
&lt;br&gt;
It would be great if this could be incorporated into EPPlus at some point. The default width / marker size on Excel line charts is HUGE. If you any substantial amount of data to chart, the resolution of the data points get lost in the thickness of the lines.
 This code is quite helpful! &lt;br&gt;
&lt;br&gt;
Thanks for everyone's work on this. Thanks for such a great .dll!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="cooljustin" When="24/10/2014 04:58:31">
          <Html>
        &lt;div class="markDownOutput "&gt;MARKER COLOR. &lt;br&gt;
&lt;br&gt;
The last feature that would make it complete. Being able to change the line color without the marker color looks a bit silly on marker-type charts.
&lt;br&gt;
&lt;br&gt;
Just a request. If I had the knowledge, I'd gladly contribute myself! &lt;br&gt;
&lt;br&gt;
Thanks!!!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mayerwin" When="07/01/2015 06:23:01">
          <Html>
        &lt;div class="markDownOutput "&gt;While waiting for Kaptein's code to be part of a future release, I have posted extension methods on
&lt;a href="http://stackoverflow.com/a/27813439/541420" rel="nofollow"&gt;this StackOverflow topic&lt;/a&gt;, which can be helpful if you don't want to recompile EPPlus yourself. They allow setting the color and thickness of a line chart series, and the color of a pie
 chart data point, but can easily be tweaked for other needs.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="thestorms" When="10/01/2015 03:08:32">
          <Html>
        &lt;div class="markDownOutput "&gt;The examples here were very useful and allowed line color, etc modification. I'm struggling with marker colors though. I was able to modify the marker border color, but cannot quite get the fill color to work. The following example works for MarkerBorderColorPath,
 but I have tried many combinations of MarkerFillColorPath. The latest shown below. Does anyone know the correct xpath for this? Thanks,
&lt;br&gt;
&lt;pre&gt;&lt;code&gt;private const string MarkerBorderColorPath = "c:marker/c:spPr/a:ln/a:solidFill/a:srgbClr/@val";
private const string MarkerFillColorPath = "c:marker/c:spPr/a:group[2]/a:solidFill/a:srgbClr/@val";

public Color MarkerColor
{
    get
    {
        string color = GetXmlNodeString(MarkerBorderColorPath);
        if (color == "")
        {
            return Color.Black;
        }
        return Color.FromArgb(Convert.ToInt32(color, 16));
    }
    set
    {
        SetXmlNodeString(MarkerBorderColorPath, value.ToArgb().ToString("X").Substring(2), true);
        SetXmlNodeString(MarkerFillColorPath, value.ToArgb().ToString("X").Substring(2), true);
    }
}&lt;/code&gt;&lt;/pre&gt;
Thank you,&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="thestorms" When="10/01/2015 18:12:44">
          <Html>
        &lt;div class="markDownOutput "&gt;Ok, I found the tutorial at &lt;a href="https://epplus.codeplex.com/discussions/346525" rel="nofollow"&gt;
https://epplus.codeplex.com/discussions/346525&lt;/a&gt;. That was the information I needed. The following xpath is the result.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;private const string MarkerBorderColorPath = "c:marker/c:spPr/a:ln/a:solidFill/a:srgbClr/@val";
private const string MarkerFillColorPath = "c:marker/c:spPr/a:solidFill/a:srgbClr/@val";&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Can't recreate Charts">
      <Posts>
        <Post From="qwerty93" When="09/01/2015 19:20:06">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi,&lt;br&gt;
I have problem with the charts, if my xlsx has more than 1 sheet, i do the following:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;if (excel.Workbook.Worksheets.Count == 0)
{
    excel.Workbook.Worksheets.Add("Data");
}
else
{
    int count = excel.Workbook.Worksheets.Count;
    for (int i = 0; i &amp;lt; count - 1; i++)
    {
        excel.Workbook.Worksheets.Delete(2);
    }
}&lt;/code&gt;&lt;/pre&gt;
so I delete all sheets except one, the first (first contains the data, others one chart), and after that I recreate the deleted sheets&lt;br&gt;
&lt;pre&gt;&lt;code&gt;ExcelWorksheet ws_data = excel.Workbook.Worksheets["Data"];
ArrayList ws_graphs = new ArrayList();
ws_graphs.Add(excel.Workbook.Worksheets.Add("Graph"));
for (int i = 0; i &amp;lt; DataXs.Count; i++)
{
    ws_graphs.Add(excel.Workbook.Worksheets.Add(((DataX)DataXs[i]).title));
}&lt;/code&gt;&lt;/pre&gt;
this part of my program is working fine, but when I want to create a chart on the recreated sheets with the following code:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;for (int index = 0; index &amp;lt; ws_graphs.Count; index++)
{
    ExcelWorksheet ws_graph = (ExcelWorksheet)ws_graphs[index];
    ExcelChart chart = ws_graph.Drawings.AddChart(ws_graph.Name, OfficeOpenXml.Drawing.Chart.eChartType.LineMarkers);
}&lt;/code&gt;&lt;/pre&gt;
after with the first run everything is going well, because there is 0 sheet, but after the firs run, during the the others (2. 3. ...) when I already have sheets in the workbook and I delete and recreate them on the&lt;br&gt;
&lt;pre&gt;&lt;code&gt; ExcelChart chart = ws_graph.Drawings.AddChart(ws_graph.Name, OfficeOpenXml.Drawing.Chart.eChartType.LineMarkers);&lt;/code&gt;&lt;/pre&gt;
row I get an exception&lt;br&gt;
&lt;pre&gt;&lt;code&gt;Cannot add part for the specified URI because it is already in the package.
   at System.IO.Packaging.Package.CreatePart(Uri partUri, String contentType, CompressionOption compressionOption)
   at OfficeOpenXml.Drawing.ExcelDrawings.CreateDrawingXml()
   at OfficeOpenXml.Drawing.ExcelDrawings.AddChart(String Name, eChartType ChartType, ExcelPivotTable PivotTableSource)
   at OfficeOpenXml.Drawing.ExcelDrawings.AddChart(String Name, eChartType ChartType)&lt;/code&gt;&lt;/pre&gt;
How can I fix it? I hope it is understandable. :)&lt;br&gt;
&lt;br&gt;
Thanks in advence!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="No Worksheets found">
      <Posts>
        <Post From="NicolasSyselio" When="09/01/2015 09:46:20">
          <Html>
        &lt;div class="markDownOutput "&gt;&lt;strong&gt;EDIT : After further investigation, the problem was not EPPlus related. My apologies for wasting your time.&lt;/strong&gt;&lt;br&gt;
&lt;br&gt;
Hi,&lt;br&gt;
&lt;br&gt;
I am currently facing a weird issue while trying to manipulate an Excel file with EPPlus.&lt;br&gt;
I have a file that I was provided which I managed to succesfully access and read. However, when I open this file with Excel on my computer and then save it, EPPlus does not find Worksheets in the document anymore.&lt;br&gt;
&lt;br&gt;
Here is how I manipulate the file :&lt;br&gt;
&lt;pre&gt;&lt;code&gt;public static void ImportFile(string filePath) {
            var existingFile = new FileInfo(filePath);

            using (var package = new ExcelPackage(existingFile)) {
                ExcelWorkbook workBook = package.Workbook;
                if (workBook != null) {
                    if (workBook.Worksheets.Count &amp;gt; 0) {
                        ExcelWorksheet currentWorksheet = workBook.Worksheets.First();

                        [...]

                    }
                }
            }
        }&lt;/code&gt;&lt;/pre&gt;
The if statement is successful when I import the file untouched (workBook.Worksheets.Count = 2) and I can manipulate the data.&lt;br&gt;
After opening the Excel file and saving it again without touching data, workBook.Worksheets.Count = 0 which prevents me going further.&lt;br&gt;
&lt;br&gt;
I am working on Windows 7 64bit, using the version 4.0.1.1 of EPPlus and the Office365 version of Excel 2013.&lt;br&gt;
&lt;br&gt;
If someone has already faced a similar problem, any help would be much appreciated.&lt;br&gt;
&lt;br&gt;
Nicolas F&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="NicolasSyselio" When="09/01/2015 12:25:20">
          <Html>
        &lt;div class="markDownOutput "&gt;My bad, the problem was located before trying to read the file. My uploader did not save the file properly which caused the emply worksheet list when reading a non existing file.
&lt;br&gt;
&lt;br&gt;
This topic can therefore be closed. &lt;br&gt;
&lt;br&gt;
Nicolas F&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Formatting TotalsRow">
      <Posts>
        <Post From="AtronSeige" When="09/01/2015 12:10:55">
          <Html>
        &lt;div class="markDownOutput "&gt;I apply a format to a column that has a "Totals Row". It is a NumberFormat ("#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00") and it applies to the column, but not the "Totals Row" (Sum).
&lt;br&gt;
&lt;br&gt;
Is there a way to apply formatting to a specific cell in the "Totals Row"?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Setting GapWidth, BaseUnit and TickLabels.Orientation for ColumnStacked charts">
      <Posts>
        <Post From="mayerwin" When="09/01/2015 11:17:50">
          <Html>
        &lt;div class="markDownOutput "&gt;I need to be able to accomplish the following VBA operations on a ColumnStacked chart (the XAxis values are end of month dates, so it needs to be set up as months, otherwise the bars correspond to a single day and are very thin).&lt;br&gt;
&lt;pre&gt;&lt;code&gt;ActiveChart.Axes(xlCategory).BaseUnit = xlMonths
ActiveChart.ChartGroups(1).GapWidth = 10
ActiveChart.Axes(xlCategory).TickLabels.Orientation = xlVertical
&lt;/code&gt;&lt;/pre&gt;
Is it supported? I couldn't find any way to do it, but I may have overlooked some properties.
&lt;br&gt;
Thanks.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Not able to change the TickLable Orienation">
      <Posts>
        <Post From="gauravelixir" When="04/11/2014 07:26:01">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
I am trying to change the tick label orientation on the axis to 45 so that they don't overlap .Right now the ticklabels on the axis have date and time which becomes a long string and they are overlapping.I could not find a way to do it in EPPlus it can be done
 in excel &lt;br&gt;
probably using &lt;br&gt;
ActiveChart.Axes(xlCategory).TickLabels.Orientation = 45 &lt;br&gt;
&lt;br&gt;
Is this missing from EPPLus or I have not been looking in the correct place. &lt;br&gt;
&lt;br&gt;
Reagrds &lt;br&gt;
Gaurav&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mayerwin" When="09/01/2015 10:59:22">
          <Html>
        &lt;div class="markDownOutput "&gt;I am also trying to find how to replicate the following VBA in EPPlus: &lt;br&gt;
&lt;br&gt;
ActiveChart.Axes(xlCategory).BaseUnit = xlMonths&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Create copies of a worksheet template with charts, then delete it after">
      <Posts>
        <Post From="kenchi09" When="15/04/2013 13:04:54">
          <Html>
        &lt;div class="markDownOutput "&gt;Setting:&lt;br&gt;
&lt;ul&gt;
&lt;li&gt;Library: EPPlus &lt;/li&gt;&lt;li&gt;Language: C# &lt;/li&gt;&lt;li&gt;Microsoft Excel 2010&lt;br&gt;
&lt;/li&gt;&lt;/ul&gt;
Hi guys, &lt;br&gt;
&lt;br&gt;
I'm developing a YTD report generating application, and I'm having a problem with it.
&lt;br&gt;
&lt;br&gt;
A report template contains worksheet templates, and some of them have pre-embedded charts in it. I create copies of that worksheet template over a number of times, and then it's deleted after.
&lt;br&gt;
&lt;br&gt;
When I open the generated report, an error message appears saying that Excel found unreadable content (Removed Feature: Named range.....) and asks if I wish to recover/repair them. I click Yes, and it seems that the values in all worksheets are accurate. I
 save and overwrite the existing generated report as a repaired one. When I open it again, the error message doesn't show. The client insists that it would be better if the end-user won't see any error messages at all even though the values are all accurate.
&lt;br&gt;
&lt;br&gt;
I feel the error originates in the part where the template is reproduced then deleted because it has charts in it. I also opened the generated report using an archive explorer to see the xl/workbook.xml file. I saw that the copies of the worksheet template
 has named ranges that still has references to the deleted one.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;// Get data from the database.
DataTable dtResults = Database.Read(@"SELECT [Retailer]
                                      FROM [" + Database.RETAILERS + @"]
                                      WHERE [Trade Class] = 'Department / Specialty'
                                      ORDER BY [Retailer] ASC");
if (dtResults.Rows.Count &amp;gt; 0)
{
    foreach (DataRow row in dtResults.Rows)
    {
        if (worker.CancellationPending)
        {
            booCancel = true;
        }
        else
        {
            intRowCounter += 1;
            // Display worksheet title in progress bar.
            worker.ReportProgress(((6 * 100) / intTotalReports), "[" + row["Retailer"].ToString() + "]");

            // Filter invalid characters in string used as worksheet name.
            string wsName = Util.formatAsExcelTabName(row["Retailer"].ToString() + " - Fragrance");
            // Copy the worksheet template with the validated name above.
            package.Workbook.Worksheets.Copy("Dept-Spec Retailer - Fragrance", wsName);
            // This is where the charts in the copied worksheet are edited.  Definition found below.
            ws = rDetail(package, "Fragrance", "Department / Specialty", row["Retailer"].ToString(), row["Retailer"].ToString().ToUpper() + " - FRAGRANCE");
            // Move the copied worksheet to the end of the workbook.
            package.Workbook.Worksheets.MoveToEnd(wsName);
        }
    }
}
// Delete the worksheet template after.
package.Workbook.Worksheets.Delete("Dept-Spec Retailer - Fragrance");

=====================================================================

protected static ExcelWorksheet rDetail(ExcelPackage p, string strMajorCategory, string strTradeClass, string strRetailer, string strSheetTitle)
{
    [...]

    string strSpacesToCenter = "                             ";
    ExcelChart chart = ((ExcelChart)ws.Drawings[0]);
    chart.Series.Chart.Locked = false;
    chart.Title.Text = strSpacesToCenter.Substring(0, strSpacesToCenter.Length - strSheetTitle.Length) + "Monthly Trend - \"" + strSheetTitle + "\"";
    chart.Series[0].Header = strSheetTitle;
    chart.Series[0].Series = "$C$89:$O$89";

    chart = ((ExcelChart)ws.Drawings[2]);
    chart.Series.Chart.Locked = false;
    chart.Title.Text = strSpacesToCenter.Substring(0, strSpacesToCenter.Length - strSheetTitle.Length) + "Monthly Blend - \"" + strSheetTitle + "\"";
    chart.Series[0].Series = "$C$93:$N$93";
    chart.Series[1].Series = "$C$94:$N$94";

    chart = ((ExcelChart)ws.Drawings[3]);
    chart.Series.Chart.Locked = false;
    chart.Title.Text = strSpacesToCenter.Substring(0, strSpacesToCenter.Length - strSheetTitle.Length) + "\"" + strSheetTitle + "\" - Last Year Share";
    chart.Series[0].Series = "$V$41:$V$" + (intRowCounter - 1).ToString();
    chart.Series[0].XSeries = "$S$41:$S$" + (intRowCounter - 1).ToString();

    chart = ((ExcelChart)ws.Drawings[1]);
    chart.Series.Chart.Locked = false;
    chart.Title.Text = strSpacesToCenter.Substring(0, strSpacesToCenter.Length - strSheetTitle.Length) + "\"" + strSheetTitle + "\" - This Year Share";
    chart.Series[0].Series = "$X$41:$X$" + (intRowCounter - 1).ToString();
    chart.Series[0].XSeries = "$T$41:$T$" + (intRowCounter - 1).ToString();

    [...]
}&lt;/code&gt;&lt;/pre&gt;
I would appreciate any light shed on this matter. &lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Thanks,&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="flyte" When="07/01/2015 22:57:07">
          <Html>
        &lt;div class="markDownOutput "&gt;I have the exact same problem.. however I have an Image on my template worksheet, and not charts. I am using 4.0.1&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Not reproducible error when I delete a column or row">
      <Posts>
        <Post From="jdnichollsc" When="05/01/2015 19:42:33">
          <Html>
        &lt;div class="markDownOutput "&gt;I have a project where I generate a excel file but when I delete rows or columns, sometimes the formulas of some cells are damaged. For example:&lt;br&gt;
&lt;br&gt;
&lt;img alt="Image" src="http://content.screencast.com/users/jdnichollsc/folders/Jing/media/b64db87a-b985-4f2e-9ba1-6b5875bc0423/Error%20in%20formulas%20references%20when%20I%20delete%20a%20column.png"&gt;&lt;br&gt;
&lt;br&gt;
I try to reproduce this issue in a new project with the file generated until to delete the column, but the error is no reproducible&lt;br&gt;
&lt;br&gt;
&lt;img alt="Image" src="http://content.screencast.com/users/jdnichollsc/folders/Jing/media/9476b9e5-9365-44f6-8011-bfa3bd35a486/Correct%20formula%20in%20new%20project.png"&gt;&lt;br&gt;
&lt;br&gt;
Any help will be much appreciated.&lt;br&gt;
&lt;br&gt;
Regards, Nicholls :)&lt;br&gt;
Skype: jdnichollsc&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="jdnichollsc" When="07/01/2015 16:35:51">
          <Html>
        &lt;div class="markDownOutput "&gt;I think that this error could be caused by this bug I reported &lt;a href="http://epplus.codeplex.com/workitem/15158" rel="nofollow"&gt;
http://epplus.codeplex.com/workitem/15158&lt;/a&gt; &lt;br&gt;
&lt;br&gt;
Regards&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Refresh Pivot Tables using EPPlus">
      <Posts>
        <Post From="tomab" When="06/01/2015 13:11:43">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello, &lt;br&gt;
&lt;br&gt;
I have a multiple pivot tables per worksheet (multiple worksheets) in one excel file. The sources of the pivot tables are hidden worksheets.
&lt;strong&gt;Is there any way to refresh all pivot tables using EPPlus?&lt;/strong&gt; &lt;br&gt;
Actually I need to refresh pivot tables and delete hidden worksheets inside the excel file situated on my server(where I don't want excel to be installed). Deletion of the worksheets is trivial but couldn't find anywhere if it's possible to refresh pivot tables
 and how. &lt;br&gt;
&lt;br&gt;
Thanks.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Hyperlink function does not work after calculated.">
      <Posts>
        <Post From="ent" When="04/12/2014 05:45:11">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi , I am using EPPlus 4.0.1.1 . &lt;br&gt;
&lt;br&gt;
I have a problem where Hyperlink function in my template excel file . &lt;br&gt;
When saved template file after worksheet.calculated it results in #NAME?. &lt;br&gt;
&lt;br&gt;
For example : &lt;br&gt;
Cell formula : "M33" = HYPERLINK("#'Person'!A1","[Person]")
&lt;br&gt;
Displaying : #NAME? &lt;br&gt;
&lt;br&gt;
Thanks!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="05/12/2014 12:42:29">
          <Html>
        &lt;div class="markDownOutput "&gt;If I understand this correctly you are calling worksheet.Calculate() first?&lt;br&gt;
&lt;br&gt;
The Hyperlink function is not yet supported by EPPlus, you can see the supported functions here:&lt;br&gt;
&lt;br&gt;
&lt;a href="http://epplus.codeplex.com/wikipage?title=Supported%20Functions&amp;amp;referringTitle=Documentation" rel="nofollow"&gt;http://epplus.codeplex.com/wikipage?title=Supported%20Functions&amp;amp;referringTitle=Documentation&lt;/a&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="ent" When="08/12/2014 01:10:59">
          <Html>
        &lt;div class="markDownOutput "&gt;I see. Then I found a workaround about that. &lt;br&gt;
&lt;br&gt;
Bad : OfficeOpenXml.CalculationExtension.Calculate(worksheet) &lt;br&gt;
&lt;br&gt;
Good: OfficeOpenXml.CalculationExtension.Calculate(specificRange) 'Excluding hyperlink cells
&lt;br&gt;
&lt;br&gt;
Thanks !&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="05/01/2015 13:24:08">
          <Html>
        &lt;div class="markDownOutput "&gt;Hyperlink is now included in the latest code. Will be included in next release.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="ent" When="06/01/2015 04:31:03">
          <Html>
        &lt;div class="markDownOutput "&gt;I have confirmed it from commit of 202eaad0219f, it was good. &lt;br&gt;
&lt;br&gt;
Thank you.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Inserting Page Break">
      <Posts>
        <Post From="ianjas" When="05/01/2015 18:55:57">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
Any geniuses out there know how to insert a page break based on a condition ? &lt;br&gt;
&lt;br&gt;
Thanks in advance for all your help, &lt;br&gt;
Ian&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to setup reservation passowrd for Excel workbook">
      <Posts>
        <Post From="kanagasabapathy" When="02/01/2015 15:26:00">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
Is there any way to create read-only workbooks(Needs password for editing) using EPPlus.
&lt;br&gt;
I have tried opening the workbook.xml file inside the workbook which already has reservation passowrd but it was encrypted with a 32bit algorithm.
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Thanks, &lt;br&gt;
Saba&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Errors and changed styles after save.">
      <Posts>
        <Post From="bad_j" When="09/11/2012 15:31:29">
          <Html>
        
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt; &lt;span style="color: blue;"&gt;using&lt;/span&gt; (ExcelPackage package = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(templateFile))
 {
       package.Save();
 }
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I've created from scratch simple xlsx template - selected few cels and set borders on it. After saving with above code I get borders set on all cells to the bottom and also alert about errors detected and repaired by excel.&lt;/p&gt;
&lt;p&gt;Any ideas?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;thanks&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="darkthread" When="05/12/2012 06:19:35">
          <Html>
        
&lt;p&gt;Similar issue: Excel 2010 complained about invalid /xl/styles.xml after package.Save() (without any change).&lt;/p&gt;
&lt;p&gt;I unzip the saved XLSX file and checked styles.xml under xl folder, and found some unreasonable XML nodes:&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(0, 0, 255);"&gt;&amp;lt;cellStyleXfs count="&lt;span style="color: rgb(255, 0, 0);"&gt;2&lt;/span&gt;"&amp;gt;&lt;/span&gt;&lt;br&gt;
&lt;span style="color: rgb(0, 0, 255);"&gt;&amp;nbsp; &amp;lt;&lt;span style="color: rgb(255, 0, 0);"&gt;xf&lt;/span&gt; numFmtId="0" fontId="0" fillId="0" borderId="0"&amp;gt;&lt;/span&gt;&lt;br&gt;
&lt;span style="color: rgb(0, 0, 255);"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;lt;alignment vertical="center" /&amp;gt;&lt;/span&gt;&lt;br&gt;
&lt;span style="color: rgb(0, 0, 255);"&gt;&amp;nbsp; &amp;lt;/xf&amp;gt;&lt;/span&gt;&lt;br&gt;
&lt;span style="color: rgb(0, 0, 255);"&gt;&amp;lt;/cellStyleXfs&amp;gt;&lt;/span&gt;&lt;br&gt;
&lt;span style="color: rgb(0, 0, 255);"&gt;&amp;lt;cellXfs count="&lt;span style="color: rgb(255, 0, 255);"&gt;3&lt;/span&gt;"&amp;gt;&lt;/span&gt;&lt;br&gt;
&lt;span style="color: rgb(0, 0, 255);"&gt;&amp;nbsp; &amp;lt;&lt;span style="color: rgb(255, 0, 255);"&gt;xf&lt;/span&gt; numFmtId="0" fontId="0" fillId="0" borderId="0" xfId="&lt;span style="color: rgb(255, 0, 255);"&gt;1&lt;/span&gt;"&amp;gt;&lt;/span&gt;&lt;br&gt;
&lt;span style="color: rgb(0, 0, 255);"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;lt;alignment vertical="center" /&amp;gt;&lt;/span&gt;&lt;br&gt;
&lt;span style="color: rgb(0, 0, 255);"&gt;&amp;nbsp; &amp;lt;/xf&amp;gt;&lt;/span&gt;&lt;br&gt;
&lt;span style="color: rgb(0, 0, 255);"&gt;&amp;nbsp; &amp;lt;&lt;span style="color: rgb(255, 0, 255);"&gt;xf&lt;/span&gt; numFmtId="0" fontId="0" fillId="0" borderId="0" xfId="&lt;span style="color: rgb(255, 0, 255);"&gt;1&lt;/span&gt;"&amp;gt;&lt;/span&gt;&lt;br&gt;
&lt;span style="color: rgb(0, 0, 255);"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;lt;alignment vertical="center" /&amp;gt;&lt;/span&gt;&lt;br&gt;
&lt;span style="color: rgb(0, 0, 255);"&gt;&amp;nbsp; &amp;lt;/xf&amp;gt;&lt;/span&gt;&lt;br&gt;
&lt;span style="color: rgb(0, 0, 255);"&gt;&amp;lt;/cellXfs&amp;gt;&lt;/span&gt;&lt;br&gt;
&lt;span style="color: rgb(0, 0, 255);"&gt;&amp;lt;cellStyles count="&lt;span style="color: rgb(128, 0, 0);"&gt;2&lt;/span&gt;"&amp;gt;&lt;/span&gt;&lt;br&gt;
&lt;span style="color: rgb(0, 0, 255);"&gt;&amp;nbsp; &amp;lt;&lt;span style="color: rgb(128, 0, 0);"&gt;cellStyle &lt;/span&gt;
name="一般" xfId="1" builtinId="0" /&amp;gt;&lt;/span&gt;&lt;br&gt;
&lt;span style="color: rgb(0, 0, 255);"&gt;&amp;lt;/cellStyles&amp;gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;cellStyleXfs count=2, but only one xf inside, cellXfs count=3, but only two xf with identical xfld inside, cellStyles count=2, but only one cellStyle inside.&lt;br&gt;
After changing styles.xml to the original version before EPPlus save, the /xl/styles.xml error message gone.&lt;/p&gt;
&lt;p&gt;I don't know why EPPlus get incorrect nodes count, but it seems one the the causes of "unreadable content" error.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="darkthread" When="05/12/2012 07:14:40">
          <Html>
        
&lt;p&gt;I traced the source and found the bug. (I guess so)&lt;/p&gt;
&lt;p&gt;EPPlus\ExcelStyles.cs Line 562 of UpdateXml() method:&lt;/p&gt;
&lt;p&gt;Line 561: &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;//NamedStyles&lt;br&gt;
Line 562: &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;count = 1; &lt;strong&gt;&lt;span style="color: rgb(255, 0, 0);"&gt;&amp;lt;== Should be count = 0;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;After changing the initial value to 0, the problem disappear in my case.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Josip84" When="13/03/2013 15:16:04">
          <Html>
        &lt;div class="markDownOutput "&gt;&lt;strong&gt;darkthread wrote:&lt;/strong&gt;&lt;br&gt;
&lt;blockquote&gt;I traced the source and found the bug. (I guess so) EPPlus\ExcelStyles.cs Line 562 of UpdateXml() method: Line 561: &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;//NamedStyles Line 562: &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;count = 1; &amp;lt;== Should
 be count = 0; After changing the initial value to 0, the problem disappear in my case.&lt;br&gt;
&lt;/blockquote&gt;
I also faced with the same problem. After changing initial value everything was ok.
&lt;br&gt;
&lt;br&gt;
Thanks a lot.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="warappa" When="23/12/2014 10:47:26">
          <Html>
        &lt;div class="markDownOutput "&gt;This is still not fixed in current release (4.0.1.1) &lt;br&gt;
&lt;br&gt;
Any plans for this?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How do create a diagonal cell using EPPlus?">
      <Posts>
        <Post From="waqas786" When="21/10/2014 07:20:46">
          <Html>
        &lt;div class="markDownOutput "&gt;How do I create a diagonal cell using EPPlus ASP.NET C#? &lt;br&gt;
&lt;br&gt;
I am using the following code, but a diagonal is not created in row 83 in Excel. &lt;br&gt;
&lt;br&gt;
worksheet.Cells[83, 3].Style.Border.Diagonal.Style = ExcelBorderStyle.Thin; &lt;br&gt;
worksheet.Cells[83, 3].Style.Border.DiagonalUp.ToString(); &lt;br&gt;
&lt;br&gt;
I want to create diagonol line in a cell which start up from top left border edge and end on bottom right border end&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="wenkaibin" When="23/12/2014 07:43:59">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
Use below code:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;worksheet.Cells[83, 3].Style.Border.Diagonal.Style = ExcelBorderStyle.Thin; 
worksheet.Cells[83, 3].Style.Border.DiagonalUp = true;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Suggestion on coding">
      <Posts>
        <Post From="StevenXi" When="17/12/2014 20:02:37">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
Very apperciated your work and I do enjoy working with it. &lt;br&gt;
&lt;br&gt;
Just noticed some coding practice issue, which make bug investigation somehow more difficult: There're quite a lot fields exposed as internal and are directly accessed instead of using the property.
&lt;br&gt;
&lt;br&gt;
I presume it's for performance consideration, but it's totally unnecessary. &lt;br&gt;
Although I understand, if you use any profiling tool; in VS debug mode, run a timed test; or run a test as debug builds, accessing fields instead of property may give you more than 50% of performance improvement. But in actual release build, they're almost
 identical in performance. &lt;br&gt;
&lt;br&gt;
The compiler optimized it for you. &lt;br&gt;
&lt;br&gt;
With property, it's easier to trace source of data, and easier to set breakpoints etc.
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Thanks. &lt;br&gt;
-Steven&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="22/12/2014 07:53:17">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
I have talked to Jan about this comment and we both agree that a class should expose its members via properties. Currently our main focus is to improve the 4.0 version, but we might look into this refactoring in the future.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="jdnichollsc" When="22/12/2014 22:06:30">
          <Html>
        &lt;div class="markDownOutput "&gt;Yes, this would be very useful! :D &lt;br&gt;
&lt;br&gt;
PD: and that the project will have documentation... I would donate for this! : P &lt;br&gt;
&lt;br&gt;
Regards, Nicholls&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Save As XLSM Memory Stream">
      <Posts>
        <Post From="cn982mj" When="22/12/2014 21:32:19">
          <Html>
        &lt;div class="markDownOutput "&gt;I need to save as XLSM. It's opens the xlsm file and modifies but saves it as xlsx. I need to know how to save it as XLSM. Thanks&lt;br&gt;
&lt;pre&gt;&lt;code&gt;            const string newPath = "ExcelFiles/70005070.xlsm";
            var fullPath = string.Format("{0}{1}", appPath, newPath);

            var existingFile = new FileInfo(fullPath);
            using (var package = new ExcelPackage(existingFile,true))
            {
                var ws = package.Workbook.Worksheets[1];
                ws.Cells["D2"].Value = contractinfo.MyVendorInfo.VendorName;
                ws.Cells["D4"].Value = contractinfo.ContractId;
                ws.Cells["K2"].Value = contractinfo.PrimeProjectId;
                ws.Cells["K4"].Value = contractinfo.FederalAidProjectNumber;
                ws.Cells["U4"].Value = contractinfo.Description;

                ws.Protection.SetPassword("dogwood");

                using (var ms = new MemoryStream())
                {
                    package.SaveAs(ms);

                    return ms;
                }
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="AutoFit with formatted cells">
      <Posts>
        <Post From="kabee" When="01/12/2014 20:23:56">
          <Html>
        &lt;div class="markDownOutput "&gt;I have a problem where AutoFit() won't work correctly on cells which have formatting applied.
&lt;br&gt;
&lt;br&gt;
In my case I apply following to Style &lt;br&gt;
.Style.Numberformat.Format = "#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00;\-\ #,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00;\ 0" &lt;br&gt;
&lt;br&gt;
So using styling I make sure I have 2 decimals and I have a thousand-separator. &lt;br&gt;
&lt;br&gt;
This means my numbers are wider then the original (e.g. 1000 becomes 1,000.00) &lt;br&gt;
&lt;br&gt;
How can I overcome this issue?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="01/12/2014 20:54:40">
          <Html>
        &lt;div class="markDownOutput "&gt;I don't know whether is your case, but if you are using formulas you need to call calculation engine method before.
&lt;br&gt;
&lt;br&gt;
&lt;a href="http://epplus.codeplex.com/discussions/543730" rel="nofollow"&gt;http://epplus.codeplex.com/discussions/543730&lt;/a&gt;
&lt;br&gt;
&lt;br&gt;
&lt;a href="http://epplus.codeplex.com/discussions/218294" rel="nofollow"&gt;http://epplus.codeplex.com/discussions/218294&lt;/a&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="kabee" When="02/12/2014 08:21:24">
          <Html>
        &lt;div class="markDownOutput "&gt;Nope that's not my case. There is no formula involved. &lt;br&gt;
&lt;br&gt;
I found a possible work-around: in stead of adding the value as decimal, I do a .ToString("#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00"), but then the cell gives a warning that there is a number stored as text (which makes sense of course)&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="bcouch" When="22/12/2014 20:21:36">
          <Html>
        &lt;div class="markDownOutput "&gt;I use &lt;br&gt;
&lt;pre&gt;&lt;code&gt;worksheet.Cells.AutoFitColumns(0);&lt;/code&gt;&lt;/pre&gt;
and it works well.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Error into GetStyleId method in ExcelStyles.cs">
      <Posts>
        <Post From="jdnichollsc" When="22/12/2014 17:07:34">
          <Html>
        &lt;div class="markDownOutput "&gt;The following line return null&lt;br&gt;
&lt;pre&gt;&lt;code&gt;var column=ws._values.GetValue(0,c) as ExcelColumn;&lt;/code&gt;&lt;/pre&gt;
and the next line show a Exception for this&lt;br&gt;
&lt;pre&gt;&lt;code&gt;if (column.ColumnMax &amp;gt;= col)&lt;/code&gt;&lt;/pre&gt;
Why can this be happening? &lt;br&gt;
Values:&lt;br&gt;
&lt;ul&gt;
&lt;li&gt;ws: is a new worksheet &lt;/li&gt;&lt;li&gt;row: 35 &lt;/li&gt;&lt;li&gt;col: 1&lt;br&gt;
&lt;/li&gt;&lt;/ul&gt;
Thanks in advance, Nicholls&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="jdnichollsc" When="22/12/2014 17:14:11">
          <Html>
        &lt;div class="markDownOutput "&gt;ohh this happens after inserting rows! This is a bug&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to rowspan and colspan by this library in excel 2007 format ( xlsx)">
      <Posts>
        <Post From="emadhamdi89" When="21/12/2014 05:55:46">
          <Html>
        &lt;div class="markDownOutput "&gt;Please I want to create xlsx sheet that contains rowspan and colspan.. &lt;br&gt;
Is this library can help me to do that??&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Fixed something in code, how can I contribute?">
      <Posts>
        <Post From="klugerama" When="19/12/2014 23:50:42">
          <Html>
        &lt;div class="markDownOutput "&gt;EPPlus was missing a feature that I needed, so I added it in the source. How can I submit it back into the project?
&lt;br&gt;
&lt;br&gt;
I'm not especially interested in becoming an active developer on this project; I just thought that if it's useful to me it may be useful to others.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="20/12/2014 08:15:58">
          <Html>
        &lt;div class="markDownOutput "&gt;You can create a pull request with Mercurial, which we will review and merge into the default branch if we find it useful.
&lt;br&gt;
&lt;br&gt;
&lt;a href="https://codeplex.codeplex.com/wikipage?title=Mercurial%20Forks" rel="nofollow"&gt;https://codeplex.codeplex.com/wikipage?title=Mercurial%20Forks&lt;/a&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Width from a Column return value in Pixels?">
      <Posts>
        <Post From="jdnichollsc" When="18/12/2014 04:42:12">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi people! :D &lt;br&gt;
One question, the width from a column return this value in pixels or that? Can I return the width in Pixels?
&lt;br&gt;
&lt;pre&gt;&lt;code&gt;var width = worksheet.Column(1).Width;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="msbrand" When="18/12/2014 08:23:35">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello,&lt;br&gt;
&lt;br&gt;
I setted the width with following formula:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;Sheet.Column(1).Width = (Pixel - 12 + 5) / 7.0 + 1&lt;/code&gt;&lt;/pre&gt;
How can I write a plus sign (+)?&lt;br&gt;
&lt;br&gt;
I think you can it transform for your needs.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="jdnichollsc" When="19/12/2014 03:53:24">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi Friend! Thanks for your response &lt;br&gt;
how you got this formula? :)&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Set columns header text">
      <Posts>
        <Post From="Unga" When="08/01/2013 07:36:50">
          <Html>
        
&lt;p&gt;I use next entity for employee data:&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;class&lt;/span&gt; Employee
{
    [Display(Name = &lt;span style="color: rgb(163, 21, 21);"&gt;"Employee Id"&lt;/span&gt;)]
    &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;int&lt;/span&gt; EMPLOYEE_ID { &lt;span style="color: blue;"&gt;set&lt;/span&gt;; &lt;span style="color: blue;"&gt;get&lt;/span&gt;; }
        
    [Display(Name = &lt;span style="color: rgb(163, 21, 21);"&gt;"Nam"&lt;/span&gt;)]
    &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; USERNAME { &lt;span style="color: blue;"&gt;set&lt;/span&gt;; &lt;span style="color: blue;"&gt;get&lt;/span&gt;; }
}
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;Next code works fine:&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;].LoadFromCollection&amp;lt;Employee&amp;gt;(EmpList, &lt;span style="color: blue;"&gt;true&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;I have a one problem - headers of columns. I don't want to see "EMPLOYEE_ID", a want to see&amp;nbsp;"Employee Id".&lt;/p&gt;
&lt;p&gt;Do I have a way to set custom text for headers?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Unga" When="09/01/2013 06:52:53">
          <Html>
        
&lt;p&gt;I wrote a extension method. In my environment it works fine&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;static&lt;/span&gt; ExcelRangeBase LoadFromCollectionWithHeaders&amp;lt;T&amp;gt;(&lt;span style="color: blue;"&gt;this&lt;/span&gt; ExcelRange excelRange, IEnumerable&amp;lt;T&amp;gt; list)
{
    excelRange.LoadFromCollection&amp;lt;T&amp;gt;(list, &lt;span style="color: blue;"&gt;true&lt;/span&gt;);

    &lt;span style="color: blue;"&gt;int&lt;/span&gt; Row = 1;
    &lt;span style="color: blue;"&gt;int&lt;/span&gt; ColumnsCount = excelRange.Worksheet.Cells.Count() / list.Count();
    &lt;span style="color: blue;"&gt;for&lt;/span&gt; (&lt;span style="color: blue;"&gt;int&lt;/span&gt; Column = 1; Column &amp;lt;= ColumnsCount; Column++)
    {
        &lt;span style="color: blue;"&gt;string&lt;/span&gt; IncorrectHeader = (((OfficeOpenXml.ExcelRangeBase)(excelRange.Worksheet.Cells[Row, Column]))).Text;

        PropertyInfo[] Properties = &lt;span style="color: blue;"&gt;typeof&lt;/span&gt;(T).GetProperties();
        &lt;span style="color: blue;"&gt;foreach&lt;/span&gt; (PropertyInfo Property &lt;span style="color: blue;"&gt;in&lt;/span&gt; Properties)
        {
            &lt;span style="color: blue;"&gt;if&lt;/span&gt; (IncorrectHeader == Property.Name.Replace(&lt;span style="color: rgb(163, 21, 21);"&gt;'_'&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;' '&lt;/span&gt;))
            {
                &lt;span style="color: blue;"&gt;object&lt;/span&gt;[] DisplayAttributes = Property.GetCustomAttributes(&lt;span style="color: blue;"&gt;typeof&lt;/span&gt;(DisplayAttribute), &lt;span style="color: blue;"&gt;true&lt;/span&gt;);

                &lt;span style="color: blue;"&gt;if&lt;/span&gt; (DisplayAttributes.Length == 1)
                {
                    (((OfficeOpenXml.ExcelRangeBase)(excelRange.Worksheet.Cells[Row, Column]))).Value = ((DisplayAttribute)(DisplayAttributes[0])).Name;
                            &lt;span style="color: blue;"&gt;break&lt;/span&gt;;
                }
                &lt;span style="color: blue;"&gt;else&lt;/span&gt;
                {
                    &lt;span style="color: blue;"&gt;continue&lt;/span&gt;;
                }
            }
        }
    }

    &lt;span style="color: blue;"&gt;return&lt;/span&gt; excelRange;
}
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="anthonyjshaw" When="14/04/2014 17:08:55">
          <Html>
        &lt;div class="markDownOutput "&gt;I recently forked and the pull request was recently approved for support of the DisplayNameAttribute, so you should be able to grab latest source and compile yourself for the following code to work.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;public class Employee
{
    [DisplayName("Employee Id")]
    public int EMPLOYEE_ID { set; get; }
        
    [DisplayName("Name")]
    public string USERNAME { set; get; }
}&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="allelopath" When="18/12/2014 15:31:35">
          <Html>
        &lt;div class="markDownOutput "&gt;Now in version 4, e.g.:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;worksheet.Cells["A1"].LoadFromCollection(myList, true);&lt;/code&gt;&lt;/pre&gt;
will use DisplayName attribute for column headers.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Tables/Relationship">
      <Posts>
        <Post From="elfmanne" When="17/12/2014 18:49:48">
          <Html>
        &lt;div class="markDownOutput "&gt;Is it possible to add a table to the worksheets Tables collection? And then establish a Relationship between the Tables??
&lt;br&gt;
&lt;br&gt;
I know how to do this in excel itself, however cant figure it out in code?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Created date">
      <Posts>
        <Post From="msbrand" When="17/12/2014 12:59:53">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello,&lt;br&gt;
I'm trying to set the created date in a new excel workbook but could not find any info for it.&lt;br&gt;
&lt;br&gt;
The dates are in the coreProperties:&lt;br&gt;
&amp;lt;dcterms:created xsi:type="dcterms:W3CDTF"&amp;gt;2014-12-17T09:33:49Z&amp;lt;/dcterms:created&amp;gt;&lt;br&gt;
&amp;lt;dcterms:modified xsi:type="dcterms:W3CDTF"&amp;gt;2014-12-17T09:33:59Z&amp;lt;/dcterms:modified&amp;gt;&lt;br&gt;
&lt;br&gt;
How can I set this dates?&lt;br&gt;
&lt;br&gt;
Thanks for your help&lt;br&gt;
ms brand&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="ExcelRangeBase.LoadFromDataTable  throws exception when Table.Rows.Count = 0 and PrintHeaders = False.">
      <Posts>
        <Post From="ent" When="15/12/2014 10:06:45">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi , I am using EPPlus 4.0.1.1 . &lt;br&gt;
&lt;br&gt;
I have a problem in using the method: ExcelRangeBase.LoadFromDataTable(DataTable Table, Boolean PrintHeaders, TableStyles TableStyle).
&lt;br&gt;
&lt;br&gt;
When Table.Rows.Count = 0 and PrintHeaders = False, it throws below exception: &lt;br&gt;
&lt;br&gt;
&lt;br&gt;
System.ArgumentException was catched:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;
  HResult=-2147024809
  Message=Row out of range
  Source=EPPlus
  StackTrace:
       at OfficeOpenXml.ExcelRange.ValidateRowCol(Int32 Row, Int32 Col)
       at OfficeOpenXml.ExcelRange.get_Item(Int32 FromRow, Int32 FromCol, Int32 ToRow, Int32 ToCol)
       at OfficeOpenXml.ExcelRangeBase.LoadFromDataTable(DataTable Table, Boolean PrintHeaders)
       at OfficeOpenXml.ExcelRangeBase.LoadFromDataTable(DataTable Table, Boolean PrintHeaders, TableStyles TableStyle)
&lt;/code&gt;&lt;/pre&gt;
Could you please confirm that? &lt;br&gt;
&lt;br&gt;
Thanks.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to create nested tables in excel using EPPlus.">
      <Posts>
        <Post From="mm_farahat" When="10/11/2014 15:54:51">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello , &lt;br&gt;
How can I create Nested tables using EPPlus (One cell contains another table) , is it possible ?
&lt;br&gt;
&lt;br&gt;
Thanks.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="JernejJerin" When="09/12/2014 13:24:29">
          <Html>
        &lt;div class="markDownOutput "&gt;I would like to know this as well.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mm_farahat" When="13/12/2014 19:19:49">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello "JernejJerin" , &lt;br&gt;
actually putting a table inside a cell is not supported by excel and it's not logical , what I did to workaround this is to do small visual hack.
&lt;br&gt;
&lt;br&gt;
just merge the header of the cell containing the sub-table (to make it look like 1 cell) then draw the sub-table under this merged header.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Why are all members of XmlHelper Internal?">
      <Posts>
        <Post From="aesalazar" When="12/12/2014 13:25:02">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi Guys. Big fan of epp. &lt;br&gt;
&lt;br&gt;
I had a question about XmlHelper class. What was the motivation to make all of members internal and not public? Seems like it would be a really handy thing to be able to access some of the methods (like adding xml nodes) to allow for things not yet support.
&lt;br&gt;
&lt;br&gt;
For example, I have series in a combo area/line chart that I want to set the fill colors on. Being able to call the SetXmlNodeString would make it very easy to do without having to modify the source code (cannot inherit the classes since most are sealed).
&lt;br&gt;
&lt;br&gt;
Thanks &lt;br&gt;
Ernie&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Unmerge a Range">
      <Posts>
        <Post From="jdnichollsc" When="11/12/2014 22:50:43">
          <Html>
        &lt;div class="markDownOutput "&gt;In EPPlus Version 4.0.1, commit 511716afdd4d not is possible to unmerge a range.
&lt;br&gt;
How do I can do this? &lt;br&gt;
&lt;br&gt;
Thanks, Nicholls.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="#VALUE! displays after calculated simple formula">
      <Posts>
        <Post From="ent" When="09/12/2014 04:39:05">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi , I am using EPPlus 4.0.1.1 . &lt;br&gt;
&lt;br&gt;
I have a problem in simple vertical cell referencing formula with calculation.&lt;br&gt;
&lt;pre&gt;&lt;code&gt; W72 =(( W60 -(- W63 )-( W29 + W30 + W31 ))/( W23 + W28 + W42 - W51 )* W4 )&lt;/code&gt;&lt;/pre&gt;
#VALUE! : After Calculated, actual result is number(after refreshing manually it becomes correct result)&lt;br&gt;
&lt;br&gt;
Each referencing cells have and displaying proper value.&lt;br&gt;
&lt;br&gt;
It was good when I used EPPlus 4.0 beta2.&lt;br&gt;
&lt;br&gt;
Thanks!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="11/12/2014 12:42:28">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
thanks for reporting this. Just want to let you know that I am working on this and are able to reproduce the error. Seems to be a tricky one though. We fixed some bugs on the formula calculation between RC and 4.0.1 so this is probably a new "feature".&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="What is the size limit of excel file?">
      <Posts>
        <Post From="chakravarti_b" When="11/12/2014 11:34:55">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello, &lt;br&gt;
&lt;br&gt;
What is the size limit of excel file EPPlus support in reading or writing? &lt;br&gt;
&lt;br&gt;
Currently I have a excel file of size 94.3MB. &lt;br&gt;
&lt;br&gt;
If I open this big file through EPPlus library, will this be part of running process memory?
&lt;br&gt;
&lt;br&gt;
Thanks &amp;amp; Regards, &lt;br&gt;
Chakravarti.B.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to create a complex chart">
      <Posts>
        <Post From="AllenLin" When="10/12/2014 08:45:09">
          <Html>
        &lt;div class="markDownOutput "&gt;I have a chart include line, column and stock, how to use epplus to create it ??&lt;br&gt;
&lt;img alt="Image" src="http://d.picphotos.baidu.com/album/s%3D1600%3Bq%3D90/sign=405e986c9013b07eb9bd540e3ce7aa52/9f510fb30f2442a7629fe2e8d243ad4bd01302ed.jpg"&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to filter a table based on another table cell value [Hyper link]">
      <Posts>
        <Post From="Jayakumar81" When="09/12/2014 18:22:03">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi All, &lt;br&gt;
&lt;br&gt;
I have 2 tables distributed in 2 different sheets for instance Sheet1 – Table 1 and Sheet 2 – Table 2, if I click on the cell ID in Table 1, I need to navigate to sheet 2 and filter the Table 2 based on ID value.
&lt;br&gt;
&lt;br&gt;
&lt;a href="https://www.flickr.com/photos/128245827@N08/15799223797/" rel="nofollow"&gt;Sheet 1 Table 1&lt;/a&gt;
&lt;br&gt;
&lt;a href="https://www.flickr.com/photos/128245827@N08/15984290982/" rel="nofollow"&gt;Sheet 2 Table 2&lt;/a&gt;
&lt;br&gt;
&lt;br&gt;
Please help me to identify the solution for this problem. &lt;br&gt;
&lt;br&gt;
Kind regards, &lt;br&gt;
Jayakumar A&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How can I get a range of columns and a range of rows?">
      <Posts>
        <Post From="jdnichollsc" When="04/12/2014 19:25:17">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi People! Is possible to get a range of columns and a range of rows? &lt;br&gt;
&lt;br&gt;
Thanks!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="jdnichollsc" When="09/12/2014 16:18:19">
          <Html>
        &lt;div class="markDownOutput "&gt;I Found then Answer to my question&lt;br&gt;
&lt;ol&gt;
&lt;li&gt;Get a range of Rows:&lt;br&gt;
&lt;/li&gt;&lt;li&gt;Obtain row 7 =&amp;gt; var row = worksheet.Cells[7, 1, 7, ExcelPackage.MaxColumns];&lt;br&gt;
&lt;/li&gt;&lt;li&gt;Obtain rows 2-4 =&amp;gt; var rows = worksheet.Cells[2, 1, 4, ExcelPackage.MaxColumns];&lt;br&gt;
&lt;/li&gt;&lt;li&gt;Get a range of Columns:&lt;br&gt;
&lt;/li&gt;&lt;li&gt;Obtain column 3 =&amp;gt; var column = worksheet.Cells[1, 3, ExcelPackage.MaxRows, 3];&lt;br&gt;
&lt;/li&gt;&lt;li&gt;Obtain columns 5-7 =&amp;gt; var columns = worksheet.Cells[1, 5, ExcelPackage.MaxRows, 7];&lt;br&gt;
&lt;/li&gt;&lt;/ol&gt;
Happy coding! ;)&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="using ActiveWindow.SplitColumn">
      <Posts>
        <Post From="elockshine" When="08/12/2014 15:45:37">
          <Html>
        &lt;div class="markDownOutput "&gt;I have code in a VB6 program that I need to convert to .NET. I have everything but the following: using a VBA function ActiveWindow.SplitColumn call. This call takes a column number and will show data on both the left and right. It is NOT Freeze Column
 which locks the left side. How can I do this with EPPlus? I have not seen a way to do this.
&lt;br&gt;
sample code from Microsoft:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;Workbooks("BOOK1.XLS").Worksheets("Sheet1").Activate 
ActiveWindow.SplitColumn = 1.5&lt;/code&gt;&lt;/pre&gt;
Thanks!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Error creating password protected workbook">
      <Posts>
        <Post From="deserialized" When="08/12/2014 13:12:55">
          <Html>
        &lt;div class="markDownOutput "&gt;I am simply trying to save a ExcelPackage with password like p.Save("123456") when this exceptions is raised:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;A first chance exception of type 'System.MethodAccessException' occurred in EPPlus.dll

Additional information: Attempt by security transparent method 'OfficeOpenXml.Utils.EncryptedPackageHandler.EncryptPackage(Byte[], OfficeOpenXml.ExcelEncryption)' to call native code through method 'OfficeOpenXml.Utils.EncryptedPackageHandler.CreateILockBytesOnHGlobal(IntPtr, Boolean, OfficeOpenXml.Utils.ILockBytes ByRef)' failed.  Methods must be security critical or security safe-critical to call native code.&lt;/code&gt;&lt;/pre&gt;
It is raised on this row in EncryptedPackageHandler.cs:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;        var iret = CreateILockBytesOnHGlobal(IntPtr.Zero, true, out lb);
&lt;/code&gt;&lt;/pre&gt;
Any ideas?&lt;br&gt;
&lt;br&gt;
Running x64 version of Windows 8.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Add Embedded object">
      <Posts>
        <Post From="d00mo" When="08/12/2014 12:31:43">
          <Html>
        &lt;div class="markDownOutput "&gt;Is it possible to add embedded objects (pdf, txt, png etc.) to Excel, using the latest release of EPPlus?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="PieChart DataLabel Format Code">
      <Posts>
        <Post From="needo2" When="06/12/2014 13:57:56">
          <Html>
        &lt;div class="markDownOutput "&gt;I want to apply a format code to the percentage values on chart to hide zeros&lt;br&gt;
But I can't find any options for FormatCode in DataLabel or anywhere in a chart &lt;br&gt;
Below code did no help either, it ads the c:numFmt but zeroes are still visible and number format is General&lt;br&gt;
&lt;pre&gt;&lt;code&gt;var xml = excelChart.ChartXml;
XmlElement xmlElement = xml.CreateElement("c", "numFmt", http://schemas.openxmlformats.org/drawingml/2006/chart");
XmlAttribute formatCode = xml.CreateAttribute("formatCode");
XmlAttribute sourceLinked = xml.CreateAttribute("sourceLinked");
sourceLinked.Value = "1";
formatCode.Value = "%0,&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;;-0;";
xmlElement.Attributes.Append(formatCode);
xmlElement.Attributes.Append(sourceLinked);
xml.GetElementsByTagName("c:dLbls")[0].AppendChild(xmlElement);&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Prepare Excel File Then Print to PDF Document">
      <Posts>
        <Post From="btillman99" When="06/12/2014 01:39:47">
          <Html>
        &lt;div class="markDownOutput "&gt;I am just getting into EPPlus using C# and would like to ask if it's possible to prepare an Excel file and then print it using a Windows PDF Print Driver. And I want to do this all with C# code. No user input allowed.
&lt;br&gt;
&lt;br&gt;
As I talk myself through this I can see that creating the file, formatting the cells and entering the data can be handled by EPPlus. Still learning but it looks like that I can get done. Then I'd like to create a PDF file of the printout with the grid lines,
 borders, cell shading, etc...and of course the data entered. &lt;br&gt;
&lt;br&gt;
Okay, here's the real caveat I guess. I want to do this on a computer that will not have Excel. That's the reason I'm researching this in the first place. The objective is to do this without needing license for other software.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Excel Range Base">
      <Posts>
        <Post From="harshkaushal" When="04/12/2014 03:54:30">
          <Html>
        &lt;div class="markDownOutput "&gt;I am facing one problem with this version. When I am using the excel range base like this:&lt;br&gt;
ws.Cells[2, i + 1, rowCount + 1, i + 1]&lt;br&gt;
it give me the range but remove the empty columns. For example i have range q1-q88 and only two cells have value it will give me that cell only. I need the whole cell either it is empty or have value. Actually I am using this version for delete columns. In
 3.1 version my code is working perfect but does not have delete columns. &lt;br&gt;
&lt;br&gt;
Please review this issue I need this as soon as possible.&lt;br&gt;
&lt;br&gt;
Thanks&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="[Solved] Copy Range to another workbook">
      <Posts>
        <Post From="MaxMelcher" When="07/07/2011 21:41:37">
          <Html>
        
&lt;p&gt;Hi,&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;when trying an excel range from one workbooks sheet to another (ideal would be worksheet.Copy) I get "Index &amp;nbsp;0 or negative Exception". I checked the docu and the discussions but found nothin.&lt;/p&gt;
&lt;p&gt;Is it possible to copy from one workbook to another or do I have to enumerate the values and copy them somehow?&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Cheers and thanks for your support&lt;/p&gt;
&lt;p&gt;Max&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="MaxMelcher" When="08/07/2011 11:46:58">
          <Html>
        
&lt;p&gt;I got it working not as elegant as copying the first range on the second range but it works (and is still super performant).&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;foreach&lt;/span&gt; (ExcelRangeBase sourceCell &lt;span style="color: blue;"&gt;in&lt;/span&gt; sheetSource.Cells[sourceStart + &lt;span style="color: rgb(163, 21, 21);"&gt;":"&lt;/span&gt; + sourceEnd])
                {
                    &lt;span style="color: blue;"&gt;if&lt;/span&gt; (&lt;span style="color: blue;"&gt;string&lt;/span&gt;.IsNullOrEmpty(sheetTarget.Cells[sourceCell.Address].Formula))
                    {
                        sheetTarget.Cells[sourceCell.Address].Value = sourceCell.Value;
                    }
                    &lt;span style="color: blue;"&gt;else&lt;/span&gt;
                    {
                        sheetTarget.Cells[sourceCell.Address].Formula = sourceCell.Formula;
                    }
                }
&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="PabloKc" When="03/12/2014 14:48:58">
          <Html>
        &lt;div class="markDownOutput "&gt;Thanks Max,&lt;br&gt;
&lt;br&gt;
I have a question, if I wanted to change the "sourceCell.Address" to begin writing from another position, for example A30, and follow the flow like your code. You know how could I? please :)&lt;br&gt;
&lt;br&gt;
regards&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="MaxMelcher" When="03/12/2014 15:23:45">
          <Html>
        &lt;div class="markDownOutput "&gt;Wow, this post is over 3 years old :) &lt;br&gt;
&lt;br&gt;
The following goes over every cell in between A30 and Z30 - is it that what you meant?
&lt;br&gt;
sourceCell.Address comes from the range iteration / foreach. &lt;br&gt;
&lt;br&gt;
foreach (ExcelRangeBase sourceCell in sheetSource.Cells["A30" + ":" + "Z30"])&lt;br&gt;
&lt;pre&gt;&lt;code&gt;            {
                if (string.IsNullOrEmpty(sheetTarget.Cells[sourceCell.Address].Formula))
                {
                    sheetTarget.Cells[sourceCell.Address].Value = sourceCell.Value;
                }
                else
                {
                    sheetTarget.Cells[sourceCell.Address].Formula = sourceCell.Formula;
                }
            }&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="PabloKc" When="03/12/2014 17:05:02">
          <Html>
        &lt;div class="markDownOutput "&gt;Thanks Max,&lt;br&gt;
&lt;br&gt;
But my problem is with the target excel, i think that "foreach (ExcelRangeBase sourceCell in sheetSource.Cells["A30" + ":" + "Z30"])" is for select range from the source, so i need help please for the target . This is
 beacuse i need add more rows to the excel of target , i have data before.&lt;br&gt;
&lt;br&gt;
i am sorry for my english, i am noob in english and C# ; :(&lt;br&gt;
&lt;br&gt;
Thanks &lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Recipients of xls cannot add formulas manually">
      <Posts>
        <Post From="daveloper80" When="02/12/2014 18:59:13">
          <Html>
        &lt;div class="markDownOutput "&gt;I have an excel that gets generated and emailed nightly that works correctly. However just recently the xls that gets generated will not allow the user to, for example, insert a new column and put in a formula. The formula only shows up as text. If you
 click on "Evaluate Formula" it will show the value.&lt;br&gt;
&lt;br&gt;
However, if you enter the formula outside of the Inserted Range (so if there are 200 rows of data, you put the formula in Row 201) it will Evaluate as expected.&lt;br&gt;
&lt;br&gt;
It does not matter if the file is opened from the hard drive, via email, is read only or completely unprotected, all with the same result.&lt;br&gt;
&lt;br&gt;
EPP dll is 4.1.0.1&lt;br&gt;
Office v15&lt;br&gt;
Project Targeted Framework 4.5.1&lt;br&gt;
&lt;br&gt;
Line 8 shows a failed Evaluation. Line 11, after the inserted range, shows a successful calculation of the same formula:&lt;br&gt;
&lt;img alt="Image" src="http://i61.tinypic.com/30k839k.jpg"&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to change the gridline color or style in epplus">
      <Posts>
        <Post From="zzc" When="01/12/2014 18:56:39">
          <Html>
        &lt;div class="markDownOutput "&gt;I am trying to change the default gridline color of columnclustered from black to darkgray.
&lt;br&gt;
But i failed to find a way to fulfill this. &lt;br&gt;
Does anyone have idea about it? &lt;br&gt;
Thank you very much.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Keeps track of the inserts/deletes and adjusts index cells">
      <Posts>
        <Post From="jdnichollsc" When="28/11/2014 13:41:14">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi! Is possible to track insertions and deletions of rows and columns for indexes of the cells are automatically updated? Thanks! :D&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="01/12/2014 08:45:24">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
I dont think so, but I am not sure that I understand what you want to achieve. Are you looking for some kind of event that is published at insertions and deletions?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="showing grid and format number using comma seperation in pivot table">
      <Posts>
        <Post From="ankur230" When="05/11/2014 19:27:27">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
I want to make pivot table where I can make visble the border for all the columns.
&lt;br&gt;
Also want to show numbers in comma seperated format. &lt;br&gt;
&lt;br&gt;
Presently I am using format #,###.###### &lt;br&gt;
&lt;br&gt;
Which is causing issue like if the number is 10000 it displays it as 10,000. a dot after last zero
&lt;br&gt;
&lt;br&gt;
What I want to show is 10,000 and if number is 10000.50 it should be like 10,000.50.
&lt;br&gt;
&lt;br&gt;
Can someone please help on this. I am using Epplus version 3.1.2.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="ankur230" When="27/11/2014 07:29:19">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
I want to make pivot table where I can make visible the border for all the columns.
&lt;br&gt;
Also want to show numbers in comma seperated format. &lt;br&gt;
&lt;br&gt;
Presently I am using format #,###.###### &lt;br&gt;
&lt;br&gt;
Which is causing issue like if the number is 10000 it displays it as 10,000. a dot after last zero
&lt;br&gt;
&lt;br&gt;
What I want to show is 10,000 and if number is 10000.50 it should be like 10,000.50.
&lt;br&gt;
&lt;br&gt;
Can someone please Suggest on this. I am using Epplus version 3.1.2.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Excel to CSV with Powershell utility">
      <Posts>
        <Post From="rscarseth" When="26/11/2014 16:49:11">
          <Html>
        &lt;div class="markDownOutput "&gt;.\ExcelToCSV.ps1 &amp;lt;somefile.xlsx&amp;gt; | out-file -filepath &amp;lt;somefile.csv&amp;gt; -Encoding ASCII&lt;br&gt;
&lt;pre&gt;&lt;code&gt;# ExcelToCSV.ps1
# 11/26/2014 rscarseth
param($inputfile)
Write-Host ("ExcelToCSV.ps1`n--------------")

$PSScriptRoot = Split-Path -Parent -Path $MyInvocation.MyCommand.Definition

# The wonderful DLL...
# http://epplus.codeplex.com/
$RequiredDLL = "EPPlus.dll"
$DLLpath = ($PSScriptRoot + "\" + $RequiredDLL)

if(!(Test-Path $DLLpath)){
    Write-Host ($RequiredDLL + " must be in same directory as this script.")
    exit
}

if(!($inputfile)){
    Write-Host ("You must provide an XLSX file to use.")
    exit
}

if(Test-Path $inputfile){
    [System.IO.FileInfo]$fileinfo = $inputfile
    [Reflection.Assembly]::LoadFrom($DLLpath) | Out-Null

    $E = New-Object OfficeOpenXml.ExcelPackage $fileinfo 
    $WS = $E.Workbook.Worksheets[1]
    $cols = $WS.Dimension.End.Column
    $rows = $WS.Dimension.End.Row

    for($i = 1;$i -lt $rows;$i++){
        $line = ""
        for($j = 1;$j -le $cols-1;$j++){
            [string]$val = $WS.getvalue($i,$j)
            if($i -eq 1){$val = $val.replace(" ","_")}
            $line += ($val + ";")
        }
        [string]$val = $WS.getvalue($i, $cols)
        if($i -eq 1){$val = $val.replace(" ","_")}
        $line += $val
        Write-Output $line
    }
    $E.Dispose()
}&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Width of the Column as a number of characters">
      <Posts>
        <Post From="jdnichollsc" When="21/11/2014 23:57:47">
          <Html>
        &lt;div class="markDownOutput "&gt;With EPPlus Can I get the width of the column as a number of '0' characters in the font of the 'Normal' style, like WidthInChars in ExcelWriter
&lt;a href="http://docs.softartisans.com/officewriterwindows/3.0.4/ExcelWriter/reference/ColumnProperties-WidthInCharsProperty.aspx" rel="nofollow"&gt;
http://docs.softartisans.com/officewriterwindows/3.0.4/ExcelWriter/reference/ColumnProperties-WidthInCharsProperty.aspx&lt;/a&gt;?
&lt;br&gt;
&lt;br&gt;
Thanks! :D&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Insert and Delete Columns">
      <Posts>
        <Post From="jdnichollsc" When="21/11/2014 20:17:00">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello People! :D&lt;br&gt;
Can I Insert and Delete Columns? Why not support it? And there is any possibility modifying the XML to do this?
&lt;br&gt;
Thanks!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="I want to migrate ExcelWriter to EPPlus">
      <Posts>
        <Post From="jdnichollsc" When="21/11/2014 16:50:16">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi people! :D I want to know if I Can migrate From ExcelWriter to EPPlus... &lt;br&gt;
So I need to know what is the object into EPPlus similar to Area Object of ExcelWriter
&lt;a href="http://docs.softartisans.com/officewriterwindows/3.0.4/ExcelWriter/reference/Area.aspx" rel="nofollow"&gt;
http://docs.softartisans.com/officewriterwindows/3.0.4/ExcelWriter/reference/Area.aspx&lt;/a&gt;?
&lt;br&gt;
&lt;br&gt;
Thanks and Sorry for my bad English! :)&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="21/11/2014 16:55:19">
          <Html>
        &lt;div class="markDownOutput "&gt;I've never used ExcelWriter, but I think Area is the same as ExcelRange of EPPlus.
&lt;br&gt;
&lt;br&gt;
Regards, &lt;br&gt;
Thiago&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="jdnichollsc" When="21/11/2014 17:08:16">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi Thiago, thanks for your prompt response! :) &lt;br&gt;
&lt;br&gt;
Respect the ExcelRange Object:&lt;br&gt;
&lt;ul&gt;
&lt;li&gt;I can sets the width of all Columns in this? &lt;/li&gt;&lt;li&gt;I cant sets the height of all Rows in this?&lt;br&gt;
&lt;/li&gt;&lt;/ul&gt;
Thanks again and have a happy day!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="21/11/2014 17:37:50">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi,&lt;br&gt;
&lt;br&gt;
I'm almost sure that you can't do this with ExcelRange but you can set width and height in other ways. ExcelRange is a set of cells, I think you can define settings of cells like font, color, border, etc but not width and height, because you can have merged
 cells.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;       using (ExcelRange r = worksheet.Cells["A2:G2"])
                    {
                        r.Merge = true;
                        r.Style.Font.SetFromFont(new Font("Britannic Bold", 18, FontStyle.Italic));
                        r.Style.Font.Color.SetColor(Color.Black);
                        r.Style.HorizontalAlignment = ExcelHorizontalAlignment.CenterContinuous;
                        r.Style.Fill.PatternType = ExcelFillStyle.Solid;
                        r.Style.Fill.BackgroundColor.SetColor(Color.FromArgb(184,204,228));
                    }&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;                            worksheet.Column(1).Width = 25;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Add image to comment/Embed images">
      <Posts>
        <Post From="lanks" When="30/09/2010 11:33:13">
          <Html>
        
&lt;p&gt;Hello&lt;/p&gt;
&lt;p&gt;I am wanting to have an image per each row in an excel spreadsheet. One solution would be to add the image to the comment of the cell as shown
&lt;a href="http://www.contextures.com/xlcomments02.html#Picture" rel="nofollow"&gt;here &lt;/a&gt;. Is it possible to add an image to a comment using Epplus?&lt;/p&gt;
&lt;p&gt;If this isn't possible, is it possible to embed images into the excel documents and then just have a link to the image in the cell, so when the user clicks the link the image is displayed using their default image app?&lt;/p&gt;
&lt;p&gt;If anyone has any other solutions that I could implement using Epplus please share them.&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;
&lt;p&gt;Liam&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="oazevedo" When="30/09/2010 12:48:53">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I've done that already. Here's&amp;nbsp;an example of how you can add&amp;nbsp;one picture per row and adjust the row height to accommodate the picture. In my case al images have the same size.&lt;/p&gt;
&lt;p&gt;I've also added my ExcelHelper class that I use to deal width unit conversion from pixel to MTU to column width...(just a mess)...that is the hardest part to deal with.&lt;/p&gt;
&lt;p&gt;So here it goes:&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;	&lt;span style="color: blue;"&gt;int&lt;/span&gt; pictureCol = 3;
	&lt;span style="color: blue;"&gt;int&lt;/span&gt; pictureWidth = 41;
	&lt;span style="color: blue;"&gt;int&lt;/span&gt; pictureHeight = 44;
	&lt;span style="color: blue;"&gt;int&lt;/span&gt; currentRow = 1;

	&lt;span style="color: green;"&gt;//set picture column width to accommodate the picture&lt;/span&gt;
	ws.Column(pictureCol).Width = ExcelHelper.Pixel2ColumnWidth(ws, pictureWidth + 1);

	&lt;span style="color: blue;"&gt;using&lt;/span&gt; (System.Drawing.Image img = /*...Load image here...*/)
	{
		&lt;span style="color: blue;"&gt;if&lt;/span&gt; (img != &lt;span style="color: blue;"&gt;null&lt;/span&gt;)
		{
			&lt;span style="color: green;"&gt;//set row height to accommodate the picture&lt;/span&gt;
			ws.Row(currentRow).Height = ExcelHelper.Pixel2RowHeight(pictureHeight + 1);

			&lt;span style="color: green;"&gt;//add picture to cell&lt;/span&gt;
			ExcelPicture pic = ws.Drawings.AddPicture(&lt;span style="color: rgb(163, 21, 21);"&gt;"PictureUniqueName"&lt;/span&gt;, img);
			&lt;span style="color: green;"&gt;//position picture on desired column&lt;/span&gt;
			pic.From.Column = pictureCol - 1;
			pic.From.Row = currentRow - 1;
			pic.From.ColumnOff = ExcelHelper.Pixel2MTU(1);
			pic.From.RowOff = ExcelHelper.Pixel2MTU(1);
			&lt;span style="color: green;"&gt;//set picture size to fit inside the cell&lt;/span&gt;
			pic.SetSize(pictureWidth, pictureHeight);
		}
	}
		
		
		
&lt;span style="color: blue;"&gt;&lt;span style="color: rgb(0, 0, 0);"&gt;    &lt;/span&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;class&lt;/span&gt; ExcelHelper
    {
        &lt;span style="color: green;"&gt;//The correct method to convert width to pixel is:&lt;/span&gt;
        &lt;span style="color: green;"&gt;//Pixel =Truncate(((256 * {width} + Truncate(128/{Maximum DigitWidth}))/256)*{Maximum Digit Width})&lt;/span&gt;

        &lt;span style="color: green;"&gt;//The correct method to convert pixel to width is:&lt;/span&gt;
        &lt;span style="color: green;"&gt;//1. use the formula =Truncate(({pixels}-5)/{Maximum Digit Width} * 100+0.5)/100 &lt;/span&gt;
        &lt;span style="color: green;"&gt;//    to convert pixel to character number.&lt;/span&gt;
        &lt;span style="color: green;"&gt;//2. use the formula width = Truncate([{Number of Characters} * {Maximum Digit Width} + {5 pixel padding}]/{Maximum Digit Width}*256)/256 &lt;/span&gt;
        &lt;span style="color: green;"&gt;//    to convert the character number to width.&lt;/span&gt;

        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;const&lt;/span&gt; &lt;span style="color: blue;"&gt;int&lt;/span&gt; MTU_PER_PIXEL = 9525;

        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;static&lt;/span&gt; &lt;span style="color: blue;"&gt;int&lt;/span&gt; ColumnWidth2Pixel(ExcelWorksheet ws, &lt;span style="color: blue;"&gt;double&lt;/span&gt; excelColumnWidth)
        {
            &lt;span style="color: green;"&gt;//The correct method to convert width to pixel is:&lt;/span&gt;
            &lt;span style="color: green;"&gt;//Pixel =Truncate(((256 * {width} + Truncate(128/{Maximum DigitWidth}))/256)*{Maximum Digit Width})&lt;/span&gt;

            &lt;span style="color: green;"&gt;//get the maximum digit width&lt;/span&gt;
            &lt;span style="color: blue;"&gt;decimal&lt;/span&gt; mdw = ws.Workbook.MaxFontWidth;

            &lt;span style="color: green;"&gt;//convert width to pixel&lt;/span&gt;
            &lt;span style="color: blue;"&gt;decimal&lt;/span&gt; pixels = &lt;span style="color: blue;"&gt;decimal&lt;/span&gt;.Truncate(((256 * (&lt;span style="color: blue;"&gt;decimal&lt;/span&gt;)excelColumnWidth + &lt;span style="color: blue;"&gt;decimal&lt;/span&gt;.Truncate(128 / (&lt;span style="color: blue;"&gt;decimal&lt;/span&gt;)mdw)) / 256) * mdw);
            &lt;span style="color: green;"&gt;//double columnWidthInTwips = (double)(pixels * (1440f / 96f));&lt;/span&gt;

            &lt;span style="color: blue;"&gt;return&lt;/span&gt; Convert.ToInt32(pixels);

        }

        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;static&lt;/span&gt; &lt;span style="color: blue;"&gt;double&lt;/span&gt; Pixel2ColumnWidth(ExcelWorksheet ws, &lt;span style="color: blue;"&gt;int&lt;/span&gt; pixels)
        {
            &lt;span style="color: green;"&gt;//The correct method to convert pixel to width is:&lt;/span&gt;
            &lt;span style="color: green;"&gt;//1. use the formula =Truncate(({pixels}-5)/{Maximum Digit Width} * 100+0.5)/100 &lt;/span&gt;
            &lt;span style="color: green;"&gt;//    to convert pixel to character number.&lt;/span&gt;
            &lt;span style="color: green;"&gt;//2. use the formula width = Truncate([{Number of Characters} * {Maximum Digit Width} + {5 pixel padding}]/{Maximum Digit Width}*256)/256 &lt;/span&gt;
            &lt;span style="color: green;"&gt;//    to convert the character number to width.&lt;/span&gt;

            &lt;span style="color: green;"&gt;//get the maximum digit width&lt;/span&gt;
            &lt;span style="color: blue;"&gt;decimal&lt;/span&gt; mdw = ws.Workbook.MaxFontWidth;

            &lt;span style="color: green;"&gt;//convert pixel to character number&lt;/span&gt;
            &lt;span style="color: blue;"&gt;decimal&lt;/span&gt; numChars = &lt;span style="color: blue;"&gt;decimal&lt;/span&gt;.Truncate(&lt;span style="color: blue;"&gt;decimal&lt;/span&gt;.Add((&lt;span style="color: blue;"&gt;decimal&lt;/span&gt;)(pixels - 5) / mdw * 100, (&lt;span style="color: blue;"&gt;decimal&lt;/span&gt;)0.5)) / 100;
            &lt;span style="color: green;"&gt;//convert the character number to width&lt;/span&gt;
            &lt;span style="color: blue;"&gt;decimal&lt;/span&gt; excelColumnWidth = &lt;span style="color: blue;"&gt;decimal&lt;/span&gt;.Truncate((&lt;span style="color: blue;"&gt;decimal&lt;/span&gt;.Add(numChars * mdw, (&lt;span style="color: blue;"&gt;decimal&lt;/span&gt;)5)) / mdw * 256) / 256;

            &lt;span style="color: blue;"&gt;return&lt;/span&gt; Convert.ToDouble(excelColumnWidth);
        }

        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;static&lt;/span&gt; &lt;span style="color: blue;"&gt;int&lt;/span&gt; RowHeight2Pixel(&lt;span style="color: blue;"&gt;double&lt;/span&gt; excelRowHeight)
        {
            &lt;span style="color: green;"&gt;//convert height to pixel&lt;/span&gt;
            &lt;span style="color: blue;"&gt;decimal&lt;/span&gt; pixels = &lt;span style="color: blue;"&gt;decimal&lt;/span&gt;.Truncate((&lt;span style="color: blue;"&gt;decimal&lt;/span&gt;)(excelRowHeight / 0.75));

            &lt;span style="color: blue;"&gt;return&lt;/span&gt; Convert.ToInt32(pixels);
        }

        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;static&lt;/span&gt; &lt;span style="color: blue;"&gt;double&lt;/span&gt; Pixel2RowHeight(&lt;span style="color: blue;"&gt;int&lt;/span&gt; pixels)
        {
            &lt;span style="color: green;"&gt;//convert height to pixel&lt;/span&gt;
            &lt;span style="color: blue;"&gt;double&lt;/span&gt; excelRowHeight = pixels * (&lt;span style="color: blue;"&gt;double&lt;/span&gt;)0.75;

            &lt;span style="color: blue;"&gt;return&lt;/span&gt; excelRowHeight;
        }

        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;static&lt;/span&gt; &lt;span style="color: blue;"&gt;int&lt;/span&gt; MTU2Pixel(&lt;span style="color: blue;"&gt;int&lt;/span&gt; mtus)
        {
            &lt;span style="color: green;"&gt;//convert MTU to pixel&lt;/span&gt;
            &lt;span style="color: blue;"&gt;decimal&lt;/span&gt; pixels = &lt;span style="color: blue;"&gt;decimal&lt;/span&gt;.Truncate((&lt;span style="color: blue;"&gt;decimal&lt;/span&gt;)(mtus / MTU_PER_PIXEL));

            &lt;span style="color: blue;"&gt;return&lt;/span&gt; Convert.ToInt32(pixels);
        }

        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;static&lt;/span&gt; &lt;span style="color: blue;"&gt;int&lt;/span&gt; Pixel2MTU(&lt;span style="color: blue;"&gt;int&lt;/span&gt; pixels)
        {
            &lt;span style="color: green;"&gt;//convert pixel to MTU&lt;/span&gt;
            &lt;span style="color: blue;"&gt;int&lt;/span&gt; mtus = pixels * MTU_PER_PIXEL;

            &lt;span style="color: blue;"&gt;return&lt;/span&gt; mtus;
        }
	}
&lt;/pre&gt;
&lt;pre&gt;Hope this helps.&lt;/pre&gt;
&lt;pre&gt;Regards,&lt;/pre&gt;
&lt;pre&gt;Orlando&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="jdnichollsc" When="21/11/2014 16:23:57">
          <Html>
        &lt;div class="markDownOutput "&gt;With EPPlus Can I get the width of the column as a number of '0' characters in the font of the 'Normal' style, like WidthInChars in ExcelWriter
&lt;a href="http://docs.softartisans.com/officewriterwindows/3.0.4/ExcelWriter/reference/ColumnProperties-WidthInCharsProperty.aspx" rel="nofollow"&gt;
http://docs.softartisans.com/officewriterwindows/3.0.4/ExcelWriter/reference/ColumnProperties-WidthInCharsProperty.aspx&lt;/a&gt; ?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Column.Hidden does not work  after width property set">
      <Posts>
        <Post From="ent" When="20/11/2014 03:00:10">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello , I am utilizing 4.0 RC. &lt;br&gt;
&lt;br&gt;
It is OK&lt;br&gt;
&lt;pre&gt;&lt;code&gt;            With sheet.Column(5)
                .Width = 100
                .Hidden = True
            End With
&lt;/code&gt;&lt;/pre&gt;
But it does not work as I expected as above.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;            With sheet.Column(5)
                .Hidden = True
                .Width = 100
            End With
&lt;/code&gt;&lt;/pre&gt;
Please confirm it.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Formula Results not showing in Protected view">
      <Posts>
        <Post From="theshiznite" When="06/11/2014 22:37:54">
          <Html>
        &lt;div class="markDownOutput "&gt;When I create a new worksheet, We have a total column that sums a series of prices. That value shows as blank in protected view (when you it "enable editing" it immediately shows up). This does not occur when you create the file using the excel
 API.&lt;br&gt;
&lt;br&gt;
I figured it was because the value the tool hadn't calculated it yet, so I downloaded Version 4 Beta 2 and called the calculate method. I then checked via debugging that both the Value and Text properties now have the correct value (they do) after calling calculate,
 but still the value does not display in protected mode.&lt;br&gt;
&lt;br&gt;
I really need this to display by default because it used to deliver invoices, and many of the people receiving them are not competent enough to think to hit the "enable editing" button.&lt;br&gt;
&lt;br&gt;
Any help or thoughts on this?&lt;br&gt;
&lt;br&gt;
Thanks,&lt;br&gt;
Chris &lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="09/11/2014 09:27:36">
          <Html>
        &lt;div class="markDownOutput "&gt;The only advice I can give you is to try to find differences between the EPPlus generated workbook and the one you have generated via Excel API. Perhaps you already know this, but if you rename the workbook from
&lt;em&gt;.xlsx to &lt;/em&gt;.zip you will be able to navigate within the workbook and view the workbook/worksheet xml. Also, it would be helpful if you could describe in a little more detailed way how to reproduce - then I can have a look at it when we are done with
 the 4.0 release. &lt;br&gt;
&lt;br&gt;
/Mats&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="theshiznite" When="11/11/2014 01:47:25">
          <Html>
        &lt;div class="markDownOutput "&gt;Okay so I did what you said in regards to converting the xlsx to a zip and the difference in pretty simple.&lt;br&gt;
&lt;br&gt;
I'm just going to show the XML of the cell where the problem is occurring. And screen shots of what it's doing. I need to see the total&lt;br&gt;
&lt;br&gt;
In the version that EPPlus 4.0 Beta 2 created the XML for the summary/formula node looks like this. This is AFTER calculate is called, and I can read the value property on the cell programmatically.&lt;br&gt;
&lt;br&gt;
&amp;lt;c r="L17" s="12"&amp;gt;&lt;br&gt;
&amp;lt;f&amp;gt;SUM(L15:L15)&amp;lt;/f&amp;gt;&lt;br&gt;
&amp;lt;/c&amp;gt;&lt;br&gt;
&lt;img alt="Image" src="http://www.mylocalpaper.com/images/nototal.png"&gt;&lt;br&gt;
&lt;br&gt;
In the version where it renders the total the XML looks like this. As you can see a v node, mostly likely for value, exists.&lt;br&gt;
&lt;br&gt;
&amp;lt;c r="L17" s="12"&amp;gt;&lt;br&gt;
&amp;lt;f&amp;gt;SUM(L15:L15)&amp;lt;/f&amp;gt;&lt;br&gt;
&amp;lt;v&amp;gt;35&amp;lt;/v&amp;gt;&lt;br&gt;
&amp;lt;/c&amp;gt;&lt;br&gt;
&lt;br&gt;
&lt;img alt="Image" src="http://www.mylocalpaper.com/images/withtotal.png"&gt;&lt;br&gt;
&lt;br&gt;
I made just this change the EPPlus file and the total showed up.&lt;br&gt;
&lt;br&gt;
Any help would be greatly appreciated&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="11/11/2014 23:49:03">
          <Html>
        &lt;div class="markDownOutput "&gt;I just did a simple test with the new RC, installed via Nuget and when I look in the worksheet xml the value is set after calling Calculate(). Could it be that you are calling Save() before Calculate(), calling Calculate() on a specific range only or something
 like that? &lt;br&gt;
&lt;br&gt;
This is my code:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;using (var pck = new ExcelPackage(new FileInfo(file)))
{
        var ws = pck.Workbook.Worksheets.Add("test");
        ws.Cells["A1:A2"].Value = 3;
        ws.Cells["A3"].Formula = "SUM(A1:A2)";
        pck.Workbook.Calculate();
        pck.Save();
}&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="theshiznite" When="14/11/2014 01:00:35">
          <Html>
        &lt;div class="markDownOutput "&gt;Thanks for the code snippet, that gave me what I needed to get it work.&lt;br&gt;
&lt;br&gt;
I changed my code which (based on your example above) effectively called &lt;br&gt;
&lt;pre&gt;&lt;code&gt;ws.Calculate(); &lt;/code&gt;&lt;/pre&gt;
which would give me the value live, but not have it in the sheet when I saved it and changed it to
&lt;br&gt;
&lt;pre&gt;&lt;code&gt;pck.Workbook.Calculate();&lt;/code&gt;&lt;/pre&gt;
Is that by design? I can see where it could be, but it seems a little odd. Do you mind explaining?
&lt;br&gt;
&lt;br&gt;
Thanks a ton.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="15/11/2014 07:18:46">
          <Html>
        &lt;div class="markDownOutput "&gt;There are three ways to perform a formula calculation with EPPlus:&lt;br&gt;
&lt;ul&gt;
&lt;li&gt;Call Calculate on the Workbook - all formulas in the entire workbook will be evaluated.
&lt;/li&gt;&lt;li&gt;Call Calculate on a specific worksheet - all formulas and their dependencies on that specific worksheet will be evaluated.
&lt;/li&gt;&lt;li&gt;Call Calculate on a specific range - all formulas and their dependencies in that specific range will be evaluted.&lt;br&gt;
&lt;/li&gt;&lt;/ul&gt;
I tried to change pck.Workbook.Calculate() to ws.Calculate() in my example above, same result though (the value is set on A3). Since your workbook seems to have only one worksheet it shouldn´t matter which option you use. If you dont mind you can create an
 issue on this and enclose your workbook with that issue.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Tydude4Christ" When="18/11/2014 17:34:50">
          <Html>
        &lt;div class="markDownOutput "&gt;I can confirm this behavior was corrected with the new RC. Thanks.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Implementing LARGE function">
      <Posts>
        <Post From="jernejp" When="17/11/2014 13:32:36">
          <Html>
        &lt;div class="markDownOutput "&gt;How to add support for excel LARGE function &lt;br&gt;
&lt;a href="http://office.microsoft.com/en-us/excel-help/large-function-HP010062514.aspx" rel="nofollow"&gt;http://office.microsoft.com/en-us/excel-help/large-function-HP010062514.aspx&lt;/a&gt;
&lt;br&gt;
&lt;br&gt;
from: &lt;br&gt;
OfficeOpenXml.FormulaParsing.Excel.Functions.Math &lt;br&gt;
I can copy Sum.cs (for base logic) and Refactor to Large.cs and then change logic.
&lt;br&gt;
But I nead some guides where and how to add function detection.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="jernejp" When="17/11/2014 13:36:45">
          <Html>
        &lt;div class="markDownOutput "&gt;Do I only nead to add function in &lt;br&gt;
OfficeOpenXml.FormulaParsing.Excel.Functions.BuiltInFunctions()&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="17/11/2014 19:28:30">
          <Html>
        &lt;div class="markDownOutput "&gt;If you download the samples you can see how to add your own function or function module.
&lt;br&gt;
&lt;br&gt;
You can implement your function in your own codebase and then register it in EPPlus via ExcelPackage.FormulaParserManager (non static).&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Degrade in 4.0 RC  [range].calculate AVERAGE(empty) results in #NUM!">
      <Posts>
        <Post From="ent" When="13/11/2014 17:02:00">
          <Html>
        &lt;div class="markDownOutput "&gt;A1=empty &lt;br&gt;
A2= AVERAGE(A1) &lt;br&gt;
&lt;br&gt;
Beta2 : cells("A2").calculate resulted in "#DIV/0!" ( It is OK).
&lt;br&gt;
RC : cells("A2").calculate resulted in "#NUM!" (It is problem), when open the file by Excel.exe .
&lt;br&gt;
After editmode A2 cell and move next cell, then display string changed to "#DIV/0!".
&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="13/11/2014 21:17:34">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, thanks for reporting. I have fixed this in the latest source code and we will soon publish a new RC.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Border and BorderColor for ConditionalFormatting databar">
      <Posts>
        <Post From="BobRazowski" When="13/11/2014 12:44:40">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
I'm trying to create a databar, I use the following command that creates and sets the color of the databar.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;worksheet.Cells["A1:A20,E1:E20"].ConditionalFormatting.AddDatabar(color);&lt;/code&gt;&lt;/pre&gt;
All the data that seems to fit this border are from OfficeOpenXml.Style.Dxf.* and are not settable.
&lt;br&gt;
&lt;br&gt;
Does someone knows if there is a way to set a border around the databar and set its color ?
&lt;br&gt;
&lt;br&gt;
Thanks by advance&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="formula that references another sheet problem">
      <Posts>
        <Post From="wenkaibin" When="12/11/2014 09:14:17">
          <Html>
        &lt;div class="markDownOutput "&gt;I am trying to add formulas to a range. &lt;br&gt;
I have two sheets 'sheet1' and 'sheet2'. &lt;br&gt;
&lt;br&gt;
I need to set sheet2's formula like this: &lt;br&gt;
sheet2's A1 = sheet1!&lt;strong&gt;A1&lt;/strong&gt; * 10 &lt;br&gt;
sheet2's B1 = sheet1!&lt;strong&gt;B1&lt;/strong&gt; * 10 &lt;br&gt;
... &lt;br&gt;
sheet2's E1 = sheet1!&lt;strong&gt;E1&lt;/strong&gt; * 10 &lt;br&gt;
&lt;br&gt;
But result is :&lt;br&gt;
sheet2's A1 = sheet1!&lt;strong&gt;A1&lt;/strong&gt; * 10 &lt;br&gt;
sheet2's B1 = sheet1!&lt;strong&gt;A1&lt;/strong&gt; * 10 &lt;br&gt;
... &lt;br&gt;
sheet2's E1 = sheet1!&lt;strong&gt;A1&lt;/strong&gt; * 10 &lt;br&gt;
&lt;br&gt;
My code:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;ExcelWorksheet sheet2 = workbook.Worksheets["sheet2"];
sheet2.Cells["A1:E1"].Formula = "sheet1!A1 * 10";&lt;/code&gt;&lt;/pre&gt;
could some one help.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="13/11/2014 06:18:03">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
To achieve this you must set the formulas cell by cell.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="wenkaibin" When="13/11/2014 09:52:39">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, swmal&lt;br&gt;
&lt;br&gt;
Thanks for your response.&lt;br&gt;
&lt;br&gt;
Because the formula is dynamic, at last I use below code:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;//in formula, sheet1! --&amp;gt; [sheet1]
string formula =  "[sheet1]A1 * 10";

//change "[sheet1]" to "$AAA1*"
Regex reg = new Regex(@"\[[^\[]*\]");
MatchCollection mc = reg.Matches(formula);
foreach (Match m in mc)
{
    string v = m.Value;
    formula = formula.Replace(v, "$AAA" ＋ (m.Index ＋ 1) ＋ "*");
 }

//set range's formula
ExcelRange range = sheet2.Cells["A1:E1"];
range.Formula = formula;

//change "AAA1*" to "sheet1!"
foreach (ExcelRangeBase cell in range)
{
    string cellFormula = cell.Formula;

    foreach (Match m in mc)
    {
        string v = m.Value;
        cellFormula = cellFormula.Replace("$AAA" ＋ (m.Index ＋ 1) ＋ "*",  v.Replace("[", "").Replace(']', '!'));
    }

    cell.Formula = cellFormula;
 }&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Format cell as Currency?">
      <Posts>
        <Post From="MadBoy" When="04/07/2010 19:51:05">
          <Html>
        
&lt;p&gt;Is there a way so that I could pass decimal to cell and set it's field to currency? Or some other similar method to make sure it's type of currency. Otherwise if I just pass zł or € as currency symbol Excel doesn't want do any counting on that treating
 it as string. If i pass it as decimal counting can be done but i loose currency symbol.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;With regards,&lt;/p&gt;
&lt;p&gt;&lt;br&gt;
MadBoy&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="05/07/2010 07:23:28">
          <Html>
        
&lt;p&gt;User the Cells[xx].Style.Numberformat property. You can check out the format in Excel--&amp;gt; Format cells --&amp;gt; Custom&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="MadBoy" When="05/07/2010 09:50:52">
          <Html>
        
&lt;p&gt;Hello,&lt;/p&gt;
&lt;p&gt;Thanks for your advice but it doesn't seem to work as expected. I've first set the column to Currency, then i checked what's in Custom and it gave me: "# #&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;,00 zł"&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;So I've used it.&lt;/p&gt;
&lt;p&gt;ws.Cells[dataRows, dataColumns].Value = varValue;&lt;br&gt;
ws.Cells[dataRows, dataColumns].Style.Numberformat.Format = @"# #&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;,00 zł";&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Unfortunetly the results are most of the time rounded up and doesn't show everything. For example if I have value 26920,64 and I change in Excel type to currency i get: &amp;nbsp; 26 920,64zł but when I convert it to custom formatting using code it rounds things
 up to 26921 zł. This makes things very unpredictable. &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/p&gt;
&lt;table width="76" height="41" style="width: 57pt; border-collapse: collapse;" border="0" cellspacing="0" cellpadding="0"&gt;
&lt;colgroup&gt;&lt;col width="76" style="width: 57pt;"&gt;
&lt;tbody&gt;
&lt;tr height="20" style="height: 15pt;"&gt;
&lt;td width="76" height="20" align="right" style="width: 57pt; height: 15pt;"&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr height="20" style="height: 15pt;"&gt;
&lt;td height="20" align="right" style="height: 15pt;"&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="05/07/2010 11:29:44">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;The number format&amp;nbsp;uses&amp;nbsp;american format (thousand="," Decimal=".")&lt;/p&gt;
&lt;p&gt;try...&lt;/p&gt;
&lt;p&gt;ws.Cells[dataRows, dataColumns].Value = varValue;&lt;br&gt;
ws.Cells[dataRows, dataColumns].Style.Numberformat.Format = @"#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00zł";&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;If you want to check out the exact number format try this...&lt;/p&gt;
&lt;p&gt;Format the sheet in Excel&amp;nbsp;the way you want.&lt;/p&gt;
&lt;p&gt;Save&amp;nbsp;as Xlsx.&lt;/p&gt;
&lt;p&gt;Rename the&amp;nbsp;workbook *.zip and extract it.&lt;/p&gt;
&lt;p&gt;Have a look in the xl\Styles.xml file to see the exact number format.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="MadBoy" When="05/07/2010 11:47:51">
          <Html>
        Lovely. Thanks for the tip wit Styles.xml.&lt;br&gt;
&lt;br&gt;
For zł: &lt;br&gt;
&lt;pre&gt;ws.Cells[dataRows, dataColumns].Style.Numberformat.Format = @"#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00zł";
&lt;/pre&gt;
For euro: &lt;br&gt;
&lt;pre&gt;ws.Cells[dataRows, dataColumns].Style.Numberformat.Format = @"#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00\ [$€-1]";
&lt;/pre&gt;
&lt;br&gt;
Thanks again!
        
    </Html>
        </Post>
        <Post From="justinhimt" When="12/11/2014 08:03:37">
          <Html>
        &lt;div class="markDownOutput "&gt;tryt his...&lt;br&gt;
&lt;pre&gt;&lt;code&gt;Excel.Range formatRange;
formatRange = xlWorkSheet.get_Range("a1", "b1");
formatRange.NumberFormat = "€ #,###,###.00";
xlWorkSheet.Cells[1, 1] = "1234567890";
&lt;/code&gt;&lt;/pre&gt;
Source....&lt;a href="http://csharp.net-informations.com/excel/csharp-format-excel.htm" rel="nofollow"&gt;C# Excel cell formatting&lt;/a&gt;
&lt;br&gt;
&lt;br&gt;
Justin&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to apply Date Format for Excel Cell">
      <Posts>
        <Post From="diptidjadhav" When="03/10/2011 13:54:34">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I am using EPPlus for excel export purpose. I want to apply date format for cell . How should i do it. I have tried this way&lt;/p&gt;
&lt;p&gt;ws.Cells[rowNum, colNum].Style.Numberformat.Format = "DD/MM/YYYY"; But its not working. Still the cell have number format.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="04/10/2011 21:35:29">
          <Html>
        
&lt;p&gt;That should work. Make sure that the value of the cell isn't a string (have a look at the FAQ and the samples).&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="diptidjadhav" When="05/10/2011 11:01:36">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;when i implement this statement ws.Cells[rowNum, colNum].Style.Numberformat.Format = "DD/MM/YYYY".&lt;/p&gt;
&lt;p&gt;Cell value gets display as "10/05/2011". But once you double click on that cell its value get converted in number as 40821.00.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;As cell format is Number and not Date Format.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Could u please suggest what to do?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="09/10/2011 18:31:39">
          <Html>
        
&lt;p&gt;The standard date&amp;nbsp;format is &lt;strong&gt;mm-dd-yy, &lt;/strong&gt;it will show different formats depending on your regional settings.&lt;/p&gt;
&lt;p&gt;If its not what you want read the FAQ how to check the numberformat of an existing xlsx file.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="diptidjadhav" When="10/10/2011 10:07:14">
          <Html>
        
&lt;p&gt;Got solution for my Problem as below, it set custom format for that field... but its consider as Date..... :)&lt;/p&gt;
&lt;p&gt;We need to set Formula field instead of Value field.&lt;/p&gt;
&lt;p&gt;ws.Cells[rowNum, colNum].Formula = "=DATE(2011,10,4)";&lt;/p&gt;
&lt;p&gt;ws.Cells[rowNum, colNum].Style.Numberformat.Format = "DD/MM/YYYY";&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="bradwood" When="10/11/2014 14:53:27">
          <Html>
        &lt;div class="markDownOutput "&gt;This does not store the value as a date, but rather a number. See &lt;a href="http://www.example.com" rel="nofollow"&gt;
https://epplus.codeplex.com/discussions/571553&lt;/a&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to make cell take on date type">
      <Posts>
        <Post From="bradwood" When="07/11/2014 20:59:15">
          <Html>
        &lt;div class="markDownOutput "&gt;There is already a &lt;a href="http://epplus.codeplex.com/discussions/274587" rel="nofollow"&gt;
question about this&lt;/a&gt;, but I found it to be untrue (doing that does &lt;em&gt;not&lt;/em&gt; make the value a date type).
&lt;br&gt;
&lt;br&gt;
If you open excel, type "1/1/2014" into a cell, arrow down, right click the cell, and check it's format under the "Number" tab, category "Date" will be selected. I want to do that programmatically. No matter what I try, the resulting
 cell comes up with "Custom" selected, not date. &lt;br&gt;
&lt;br&gt;
I'm betting there is a way; just not documented anywhere...&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="bradwood" When="10/11/2014 14:48:11">
          <Html>
        &lt;div class="markDownOutput "&gt;Setting Cell.Style.Numberformat.Format to "m/d/yyyy" does the equivalent of what I asked for. However, it seems that the underlying value is
&lt;em&gt;still&lt;/em&gt; numeric (double) and requires detecting the format (can check cell.Style.Numberformat.NumFmtID == 14) and converting (DateTime.FromOADate( (double)cell.Value )) to get the actual date upon reading the file.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="setting WrapText on merged Cells">
      <Posts>
        <Post From="phoxware" When="20/05/2011 18:12:56">
          <Html>
        
&lt;p&gt;hi guyz,&lt;/p&gt;
&lt;p&gt;seems this is not working for me. i merged several cells to a single range, but after setting the WrapText = true on the range, its still not wrapping the text to the next line&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="25/05/2011 21:28:11">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Works for me when I try it (latest source). Is the Wrap text checkbox set when you open the format dialog in Excel?&lt;/p&gt;
&lt;p&gt;Also make sure you use \r\n in the string to change to a new line.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="phoxware" When="24/10/2012 18:31:23">
          <Html>
        
&lt;p&gt;Perfect, working fine now but this also leads to another issue, whenever i merge several cells, not all the contents in the new ranged cell&amp;nbsp;are displayed, the contents are restricted into a single line and&amp;nbsp;the rest contents can only be&amp;nbsp;viewed&amp;nbsp;by
 manually expanding the row height in Excel&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="phoxware" When="12/11/2012 08:28:21">
          <Html>
        
&lt;p&gt;Plz, anybody (or Jankallman) with tips in fixing this issue?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;thanx in advance&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="kailash_ravuri" When="21/11/2012 17:56:13">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Even i am facing the same issue as phoxware mentioned. anybody please help. Is there any work around or this is bug/limitation for EpPlus.&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="netDeveloperUK" When="04/12/2012 08:40:05">
          <Html>
        
&lt;p&gt;I am facing the same problem when I do:&amp;nbsp;&lt;/p&gt;
&lt;p&gt;ExcelPackage pck = new ExcelPackage(); &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;br&gt;
var ws = pck.Workbook.Worksheets.Add("newWorkbook");&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;
&lt;br&gt;
ws.Cells["A" + 1].Value = comments; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;
&lt;br&gt;
&lt;strong&gt;ws.Cells["A" + 1 + ":F" + 1].Merge = true;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;
&lt;/strong&gt;&lt;br&gt;
&lt;strong&gt;ws.Cells["A" + 1 + ":F" + 1].Style.WrapText = true; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Is this a bug or is it working for anyone else?&lt;/p&gt;
&lt;p&gt;Thanks!&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="bullszi" When="07/11/2014 14:52:05">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi Everyone, &lt;br&gt;
&lt;br&gt;
So it is almost 2 years since the last post in this thread and I am also experiencing the same problem.
&lt;br&gt;
&lt;br&gt;
Has anyone found a solution to this issue? Is there a workaround available? &lt;br&gt;
&lt;br&gt;
It would be really great to be able to display all the text in a merged range. &lt;br&gt;
&lt;br&gt;
Thanks!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="will there be a new version">
      <Posts>
        <Post From="aseghaier" When="03/11/2014 13:10:27">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello, &lt;br&gt;
&lt;br&gt;
As the subject says: is there a new planned release? &lt;br&gt;
&lt;br&gt;
Note that we have already ask a question about an issue on DeleteColumn() function.
&lt;br&gt;
&lt;br&gt;
we hope so that the new version solves the problem &lt;br&gt;
&lt;br&gt;
thanks&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="gauravelixir" When="05/11/2014 09:54:31">
          <Html>
        &lt;div class="markDownOutput "&gt;I got the following info for a similar question regarding release &lt;br&gt;
&lt;br&gt;
"We will release beta 3, which should be stable and close to the final version, soon and then wait for about 2 weeks to see that everything seems ok. So expect something like 3 weeks to a month depending how it goes."
&lt;br&gt;
&lt;br&gt;
Hope this helps &lt;br&gt;
&lt;br&gt;
thanks&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="aseghaier" When="05/11/2014 10:24:48">
          <Html>
        &lt;div class="markDownOutput "&gt;hi, &lt;br&gt;
&lt;br&gt;
thank you for your reply gauravelixir.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Can I convert CSV file to excel using EPPLUS using Powershell">
      <Posts>
        <Post From="sandy143" When="04/11/2014 13:17:29">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi ,&lt;br&gt;
&lt;br&gt;
Can you please help me how to onvert CSV file to EXCEL using EPPLUS dll with powershell. I have no office installed in my server . I have a bulk of CSV files where i have to convert to XLx with out excel services installed on the server&lt;br&gt;
&lt;br&gt;
Thanks,&lt;br&gt;
Sandy&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Hyperlink Image to a cell ?">
      <Posts>
        <Post From="andrew79" When="03/11/2014 19:53:14">
          <Html>
        &lt;div class="markDownOutput "&gt;Can someone kindly show me how to hyperlink an Image to a cell ? I can't figure out what to pass in for the Uri param to work
&lt;br&gt;
&lt;pre&gt;&lt;code&gt;     ExcelPicture picture = null;
     if (image != null) {
             picture = ws.Drawings.AddPicture("pic00", image,new Uri("Sheet1!A1"));
     }&lt;/code&gt;&lt;/pre&gt;
Thanks !!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="License">
      <Posts>
        <Post From="GoatCheez" When="29/10/2014 14:43:42">
          <Html>
        &lt;div class="markDownOutput "&gt;Since EPPlus derived from ExcelPackage, and ExcelPackage has a GPL License, isn't EPPlus actually GPL and not LGPL?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="29/10/2014 14:50:30">
          <Html>
        &lt;div class="markDownOutput "&gt;Depends, our last versions are LGPL because Jam has rewritten all Excel Package code, but if you has downloaded an older version, maybe you has an GPL version. Despite of this, EPPlus interface still is very similar to Excel Package because it was our
 starting point.&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Edit: Forgot to say, we are LGPL since version 3.0.&lt;br&gt;
&lt;br&gt;
Regards,&lt;br&gt;
Thiago&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Duplicate rows - suppress">
      <Posts>
        <Post From="devling" When="28/10/2014 19:25:13">
          <Html>
        &lt;div class="markDownOutput "&gt;I'm attemping to do this:&lt;br&gt;
&lt;blockquote&gt;Dept Name&lt;br&gt;
04 Bob&lt;br&gt;
04 Job&lt;br&gt;
05 Jill&lt;br&gt;
05 Amy&lt;br&gt;
&lt;/blockquote&gt;
And do this:&lt;br&gt;
&lt;br&gt;
Dept Name&lt;br&gt;
04 Bob&lt;br&gt;
&lt;pre&gt;&lt;code&gt;     Job&lt;/code&gt;&lt;/pre&gt;
05 Jill&lt;br&gt;
&lt;pre&gt;&lt;code&gt;   Amy
&lt;/code&gt;&lt;/pre&gt;
I'm struggling to do this in EEPlus. The Dept ID should not repeat itself until the next value changes....&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
What should I look at?&lt;br&gt;
&lt;br&gt;
thanks,&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Format condition by Expression">
      <Posts>
        <Post From="hanmai" When="02/11/2012 14:57:44">
          <Html>
        
&lt;p&gt;Hi experts,&lt;/p&gt;
&lt;p&gt;I'm trying to format some range by using conditionalFormatting feature of EPPlus. I read many document but there is nowhere mentions about Conditional Formatting Expression.&lt;/p&gt;
&lt;p&gt;I'm very confusing. Don't know how to use that feature. Here are my some questions:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Can we use multiple range to put into parameter ExcelAddress (like "H1:H17,L1:L17,"AA1:AA17")
&lt;/li&gt;&lt;li&gt;The formual is put into Formual property is somehow like Interop Excel or not? (like we use "A1" to represent for the current cell for formatting in interop excel)
&lt;/li&gt;&lt;li&gt;Can you give me a small demo code leg that use Conditional Formatting Expression.
&lt;/li&gt;&lt;/ol&gt;
&lt;p&gt;Thank you!&lt;/p&gt;
&lt;p&gt;(Sorry for bad English I wrote)&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="hanmai" When="05/11/2012 10:15:32">
          <Html>
        
&lt;div&gt;
&lt;p&gt;I have found out solution by myself. Please take an example code:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&lt;div style="color: black; background-color: white;"&gt;&lt;pre&gt;&lt;span style="color: rgb(0, 128, 128);"&gt;ExcelAddress &lt;/span&gt;_formatRangeAddress = &lt;span style="color: blue;"&gt;new&lt;/span&gt; &lt;span style="color: rgb(0, 128, 128);"&gt;ExcelAddress&lt;/span&gt;(&lt;span style="color: rgb(163, 21, 21);"&gt;"B3:B10,D3:D10,F3:F10,H3:H10:J3:J10"&lt;/span&gt;); 
&lt;span style="color: green;"&gt;// fill WHITE color if one of previous cell or current cell is BLANK: &lt;/span&gt;
&lt;span style="color: blue;"&gt;string&lt;/span&gt; _statement = &lt;span style="color: rgb(163, 21, 21);"&gt;"IF(AND(ISBLANK(OFFSET(B3,0,-1)),ISBLANK(B3)),1,0)"&lt;/span&gt;; 
&lt;span style="color: blue;"&gt;var&lt;/span&gt; _cond4 = sheet.ConditionalFormatting.AddExpression(_formatRangeAddress);
 _cond4.Style.Fill.PatternType = OfficeOpenXml.Style.&lt;span style="color: rgb(0, 128, 128);"&gt;ExcelFillStyle&lt;/span&gt;.Solid;
 _cond4.Style.Fill.BackgroundColor.Color = &lt;span style="color: rgb(0, 128, 128);"&gt;Color&lt;/span&gt;.White; _cond4.Formula = _statement; 
&lt;span style="color: green;"&gt;// fill GREEN color if value of the current cell is greater than &lt;/span&gt;
&lt;span style="color: green;"&gt;// or equals to value of the previous cell &lt;/span&gt;
_statement = &lt;span style="color: rgb(163, 21, 21);"&gt;"IF(OFFSET(B3,0,-1)-B3&amp;lt;=0,1,0)"&lt;/span&gt;; &lt;br&gt;&lt;span style="color: blue;"&gt;var&lt;/span&gt; _cond1 = sheet.ConditionalFormatting.AddExpression(_formatRangeAddress); &lt;br&gt;_cond1.Style.Fill.PatternType = OfficeOpenXml.Style.&lt;span style="color: rgb(0, 128, 128);"&gt;ExcelFillStyle&lt;/span&gt;.Solid; &lt;br&gt;_cond1.Style.Fill.BackgroundColor.Color = &lt;span style="color: rgb(0, 128, 128);"&gt;Color&lt;/span&gt;.Green; &lt;br&gt;_cond1.Formula = _statement; 
&lt;span style="color: green;"&gt;// fill RED color if value of the current cell is less than &lt;/span&gt;
&lt;span style="color: green;"&gt;// value of the previous cell &lt;/span&gt;
_statement = &lt;span style="color: rgb(163, 21, 21);"&gt;"IF(OFFSET(B3,0,-1)-B3&amp;gt;0,1,0)"&lt;/span&gt;; &lt;span style="color: blue;"&gt;&lt;br&gt;var&lt;/span&gt; _cond3 = sheet.ConditionalFormatting.AddExpression(_formatRangeAddress); &lt;br&gt;_cond3.Style.Fill.PatternType = OfficeOpenXml.Style.&lt;span style="color: rgb(0, 128, 128);"&gt;ExcelFillStyle&lt;/span&gt;.Solid; &lt;br&gt;_cond3.Style.Fill.BackgroundColor.Color = &lt;span style="color: rgb(0, 128, 128);"&gt;Color&lt;/span&gt;.Red; &lt;br&gt;_cond3.Formula = _statement;
&lt;/pre&gt;
&lt;/div&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;In the above example, &lt;strong&gt;&lt;code&gt;_formatRangeAddress&lt;/code&gt;&lt;/strong&gt; is the range that will be apply for the conditional formatting by the expression.
&lt;strong&gt;&lt;code&gt;_statement&lt;/code&gt;&lt;/strong&gt; is the formula used to calculate the condition, this string doesn't start with equal sign (&lt;strong&gt;&lt;code&gt;=&lt;/code&gt;&lt;/strong&gt;) (difference point from MS Excel), the cell which is used to make expression is the first cell
 in the &lt;strong&gt;&lt;code&gt;_formatRangeAddress&lt;/code&gt;&lt;/strong&gt;. (B3).&lt;/p&gt;
&lt;p&gt;Hope this is helpful to others who need. -Han-&lt;/p&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="tarunmathur" When="02/09/2014 11:54:56">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello Hanmai, &lt;br&gt;
&lt;br&gt;
I am using similar code to do conditional formattiong but itys not working, pleae check my below code and let me know where I am wrong:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;            ExcelPackage pck = new ExcelPackage();
            var ws = pck.Workbook.Worksheets.Add("Sample1");

            var _formatRangeAddress = new ExcelAddress("H16:K31,H33:K44,H46:K57,H59:K69,H71:K73");
            string _statement = "=AND(COUNTA(H16:H16)&amp;lt;2,COUNTA(H16:K16)&amp;gt;0)";
            var _cond4 = ws.ConditionalFormatting.AddExpression(_formatRangeAddress);
            _cond4.Style.Fill.PatternType = OfficeOpenXml.Style.ExcelFillStyle.Solid;
            _cond4.Style.Fill.BackgroundColor.Color = Color.Green;
            _cond4.Formula = _statement;          

            pck.SaveAs(Response.OutputStream);
            Response.ContentType = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";
            Response.AddHeader("content-disposition", "attachment;  filename=Sample1.xlsx");&lt;/code&gt;&lt;/pre&gt;
Thanks in advance&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="hanmai" When="26/10/2014 14:44:49">
          <Html>
        &lt;div class="markDownOutput "&gt;Sorry that I don't visit this page as well as check my outlook frequently. Your statement contains equal sign (=) while it should not.
&lt;br&gt;
I have no more other comment than all experiences that I've shared in my above example. -Han-&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Macro Options">
      <Posts>
        <Post From="wtfinc" When="24/10/2014 20:15:13">
          <Html>
        &lt;div class="markDownOutput "&gt;I am creating an XLSM spreadsheet and have successfully inserted the source code in a VBA Module. How do I set the options to assign a keystroke to execute the macro in Excel? In OLE, I would have used the xl.MacroOptions routine.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="wtfinc" When="24/10/2014 21:12:52">
          <Html>
        &lt;div class="markDownOutput "&gt;Here is my rather clunky solution:&lt;br&gt;
At the end of the VBA code, I added an Auto_Open routine that assigns the desired keystrokes to the new macros. Now, every time the spreadsheet is opened, the appropriate keystrokes are reassigned to the macros.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Issue in Mono with File Loading">
      <Posts>
        <Post From="fawadali123" When="24/10/2014 15:45:01">
          <Html>
        &lt;div class="markDownOutput "&gt;I am using the below code for reading excel file into datatable:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;public static DataTable GetDataTableFromExcel(string path)
        {
            DataTable tbl = new DataTable();
            using (var pck = new ExcelPackage())
            {
                using (var stream = File.OpenRead(path))
                {
                    pck.Load(stream);                    
                }

                //GET FIRST SHEET IN EXCEL FILE
                var ws = pck.Workbook.Worksheets.First();
                
                bool hasheader = true; // adjust it accordingly( i've mentioned that this is a simple approach)
                 
                //ADD COLUMNS (SCHEMA) TO DATATABLE
                foreach (var firstrowcell in ws.Cells[1, 1, 1, ws.Dimension.End.Column])
                {
                    tbl.Columns.Add(hasheader ? firstrowcell.Text : string.Format("column {0}", firstrowcell.Start.Column));
                }

                //IF THE EXCEL SHEET HAS FIRST ROW AS COLUMN NAMES THAN START FROM 2nd ROW Else FROM FIRST ROW
                var startrow = hasheader ? 2 : 1;

                for (var rownum = startrow; rownum &amp;lt;= ws.Dimension.End.Row; rownum++)
                {
                    //ws.Cells[rownum, 1, rownum, ws.Dimension.End.Column].Style.Numberformat.Format = "General";
                    var wsrow = ws.Cells[rownum, 1, rownum, ws.Dimension.End.Column];
                    var row = tbl.NewRow();
                    foreach (var cell in wsrow)
                    {
                        if (cell.Start.Column &amp;gt; 20)
                            continue;
                        if (cell.Start.Column == 20)
                        {
                            DateTime dt = new DateTime(1947, 1, 1);
                            DateTime.TryParse(cell.Value.ToString(), out dt);

                            if (dt == new DateTime(0001, 1, 1))
                            {
                                long serialDate = long.Parse(cell.Value.ToString());
                                DateTime result = DateTime.FromOADate(serialDate);
                                row[cell.Start.Column - 1] = result.ToString();
                            }
                            else
                                row[cell.Start.Column - 1] = cell.Value;
                        }
                        else
                            row[cell.Start.Column - 1] = cell.Text;
                    }
                    tbl.Rows.Add(row);
                }
                
            }
            return tbl;
        } &lt;/code&gt;&lt;/pre&gt;
In my aplication i select an excel file and its loaded in GridView if i select a new file- the above method will be called and data will be loaded in GridView.
&lt;br&gt;
But This does not work on Mono. This works in .Net but with the same code when i select a different file from the browse button the first file gets load again and again.
&lt;br&gt;
to load a new file i have to close the application and run again. &lt;br&gt;
&lt;br&gt;
is there anything wrong with the method code? &lt;br&gt;
do i need to close/Unload the excel in EP code somewhere? &lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Regards,&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="ColumnClustered Spacing">
      <Posts>
        <Post From="unitedcomputer" When="22/10/2014 03:02:45">
          <Html>
        &lt;div class="markDownOutput "&gt;Is there a way to space the columns in the ColumnClustered chart type? I'm adding the three ranges and they all touch. When I open the file in Excel and click to change the chart type, Excel moves the columns over (adding the spacing) but how do I do that
 in code?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="SetPosition">
      <Posts>
        <Post From="unitedcomputer" When="22/10/2014 01:47:03">
          <Html>
        &lt;div class="markDownOutput "&gt;Found it.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="PivotChart">
      <Posts>
        <Post From="janfredrik" When="10/10/2014 14:43:01">
          <Html>
        &lt;div class="markDownOutput "&gt;Is there any support for creating a PivotChart? &lt;br&gt;
&lt;br&gt;
This is similar to this question on stackoverflow: &lt;br&gt;
&lt;a href="http://stackoverflow.com/questions/20766908/epplus-create-chart-from-pivot" rel="nofollow"&gt;http://stackoverflow.com/questions/20766908/epplus-create-chart-from-pivot&lt;/a&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="janfredrik" When="21/10/2014 12:17:19">
          <Html>
        &lt;div class="markDownOutput "&gt;I looked at the sample code (sample 12) and found the answer there.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Prroblem copying worksheet containing checkboxes">
      <Posts>
        <Post From="Chrillee" When="20/10/2014 13:38:29">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
I have a problem copying one worksheet to another. The problem is related to my checkbox controls in my worksheet.
&lt;br&gt;
This is what I am trying to do and it works fine when I remove my checkboxes from the excel worksheet.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;            FileInfo file = new FileInfo(@"C:\File1.xlsx");
            FileInfo file2 = new FileInfo(@"C:\File2.xlsx");

            ExcelPackage p = new ExcelPackage(file);
            ExcelPackage p2 = new ExcelPackage(file2);

            p.Workbook.Worksheets.Add("newWorkSheet",p2.Workbook.Worksheets[1]);

            Stream s = File.Create(@"C:\File3.xlsx");

            p.SaveAs(s);
&lt;/code&gt;&lt;/pre&gt;
This is the error I get when I keep my checkboxes: &lt;br&gt;
OjbectDisposedException was unhandled, It is not possible to reach a closed data stream.
&lt;br&gt;
&lt;br&gt;
Is it possible to copy a worksheet with these type of controls?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="After filling out the color of the cells - the cells are white">
      <Posts>
        <Post From="evgnib123" When="15/10/2014 08:06:30">
          <Html>
        &lt;div class="markDownOutput "&gt;Problem. &lt;br&gt;
After filling the cell values (from template) ​​(sheet.Cells[1,1].Value), colored cells are white.
&lt;br&gt;
It is necessary to remember the style of the cell before it is filled? &lt;br&gt;
How to do it correctly? &lt;br&gt;
&lt;br&gt;
Thanks.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Merging multiple worksheets from external documents failing">
      <Posts>
        <Post From="unitedcomputer" When="10/10/2014 18:33:51">
          <Html>
        &lt;div class="markDownOutput "&gt;Instead of creating sheets from scratch, I had my client create a template which I am loading in and pulling the worksheet across into a new merged sheet (created on the server.)
&lt;br&gt;
&lt;br&gt;
If I pull one worksheet in, the operation works. If I attempt to pull in both worksheets, the operation fails with:
&lt;br&gt;
&lt;br&gt;
Index was out of range. Must be non-negative and less than the size of the collection.
&lt;br&gt;
&lt;br&gt;
Here's what the code looks like:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;  internal void BDBB(ExcelPackage BDWS)
  {
    string ExcelFile = Server.MapPath("~/lib/template/bdbb.xlsx");
    ExcelPackage ep = new ExcelPackage(new FileInfo(ExcelFile));
    ep.Load(new FileStream(ExcelFile, FileMode.Open));
    ExcelWorksheet single = ep.Workbook.Worksheets["Single"];
    //ExcelWorksheet multiple = ep.Workbook.Worksheets["Multiple"];
    BDWS.Workbook.Worksheets.Add("Single 2014", single);
    //BDWS.Workbook.Worksheets.Add("Multiple 2014", multiple);
  }&lt;/code&gt;&lt;/pre&gt;
That works, however, if I uncomment out the addition of the worksheet "Multiple 2014" then the generation fails with the above message. Before the crash I can trace out the Workbook has 3 worksheets in it but an attempt to do this fails.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;Response.BinaryWrite(ExcelDocument.GetAsByteArray());&lt;/code&gt;&lt;/pre&gt;
When the page inits, I create, manually, the first cover page and then add this sheet to it. Additionally, some elements on the page are not copied over correctly with the copied version having visible XML instead of text.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="unitedcomputer" When="10/10/2014 18:46:40">
          <Html>
        &lt;div class="markDownOutput "&gt;New twist, if I remove the addition of the worksheet "Single" and try just to add "Multiple" which is just the second worksheet with formulas, it fails with the same error so it's something to do with that worksheet it seems.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="unitedcomputer" When="10/10/2014 19:16:32">
          <Html>
        &lt;div class="markDownOutput "&gt;Follow up twist - I can add the good working sheet 4 times in a row but this one other sheet I can't add. Is there a way to see if a page add had errors?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Write Large File with EPPlus open with Excel and Save -- now EPPLus 4.00 is struggling">
      <Posts>
        <Post From="tsc_sutor" When="10/10/2014 13:27:35">
          <Html>
        &lt;div class="markDownOutput "&gt;If i write a large worksheet with EPPlus 4.00 actual code (also in debug mode with VS) and open this file with MS Excel and save the file, the code from EPPlus is now not able to serialize his in memory store.
&lt;br&gt;
&lt;br&gt;
What i have found, the sheet.xml inside the container is now not utf-8 encoded anymore, its's ANSI coded, also showed by half the weight.
&lt;br&gt;
I open the xlsx with EEPlus and load it in memory, search for my worksheet by name and delete all cells with ExcelWorksheet.Cells.Clear(). After this i write all my actual data to this cleared cells in this ExcelWorksheet. Some cells will get format information's.
 On the end i will save the Excelpackage.GetAsByteArray(). EPPlus is now struggling in cleaning up the theme definition inside the cell store comparer with negative length..
&lt;br&gt;
&lt;br&gt;
I will now try to delete my ExcelWorksheet and build a new one with the same name, maybe the error will go away..&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="EPPPLUS EXCEL AS AN EMAIL ATTACHMENT">
      <Posts>
        <Post From="vijaykumar_chebol" When="17/03/2013 12:12:33">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi I am using EPPPlus to return a excel file and also to send the same file as an attachment. I could open the excel file and also got attachement but when I open the email attachment I am getting error message saying File is corrupted. Please look at
 the belwo code and suggest me changes. &lt;br&gt;
&lt;br&gt;
MemoryStream outputStream = new MemoryStream(); &lt;br&gt;
using (ExcelPackage pck = new ExcelPackage(outputStream)) &lt;br&gt;
{ &lt;br&gt;
ExcelWorksheet ws = pck.Workbook.Worksheets.Add("Demo"); &lt;br&gt;
ws.Cells["A1"].LoadFromDataTable(tbl, true); &lt;br&gt;
using (ExcelRange rng = ws.Cells[1, 1, 1, tbl.Columns.Count]) &lt;br&gt;
{ &lt;br&gt;
rng.Style.Font.Bold = true; rng.Style.Fill.PatternType = ExcelFillStyle.Solid; &lt;br&gt;
rng.Style.Fill.BackgroundColor.SetColor(Color.FromArgb(79, 129, 189)); &lt;br&gt;
rng.Style.Font.Color.SetColor(Color.White); &lt;br&gt;
} &lt;br&gt;
using (ExcelRange col = ws.Cells[2, 1, 2 + tbl.Rows.Count, 1]) &lt;br&gt;
{ col.Style.Numberformat.Format = "#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00"; col.Style.HorizontalAlignment = ExcelHorizontalAlignment.Right;
&lt;br&gt;
} MailMessage mail = null; try &lt;br&gt;
{ &lt;br&gt;
mail = new MailMessage(); &lt;br&gt;
mail.From = new MailAddress("&lt;a href='mailto:@@@@@@.com",' rel="nofollow"&gt;@@@@@@.com",&lt;/a&gt; "SystemMail");
&lt;br&gt;
mail.To.Add(new MailAddress(emailAddress)); &lt;br&gt;
mail.Subject = "Store Finder Geocoding"; &lt;br&gt;
mail.IsBodyHtml = true; &lt;br&gt;
string message = ""; &lt;br&gt;
message += ".LLHere is the attachment with list of stores and geocode values you requested." + "&amp;lt;/br&amp;gt;";
&lt;br&gt;
mail.Body = message; outputStream.Position = 0; &lt;br&gt;
Attachment attachment = new Attachment(outputStream, "Geocoding.xlsx", "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet");
&lt;br&gt;
mail.Attachments.Add(attachment); &lt;br&gt;
mail.SubjectEncoding = System.Text.Encoding.UTF8; &lt;br&gt;
mail.BodyEncoding = System.Text.Encoding.UTF8; &lt;br&gt;
SmtpClient client = new SmtpClient("localhost"); client.Send(mail); &lt;br&gt;
} &lt;br&gt;
catch (Exception ex) { throw ex; } &lt;br&gt;
Response.ContentType = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";
&lt;br&gt;
Response.AddHeader("content-disposition", String.Format(CultureInfo.InvariantCulture, "attachment; filename={0}", "geo.xlsx"));
&lt;br&gt;
Response.BinaryWrite(pck.GetAsByteArray()); &lt;br&gt;
Response.End();&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mbeppe" When="09/10/2014 10:17:51">
          <Html>
        &lt;div class="markDownOutput "&gt;hi all&lt;br&gt;
i've the same problem. is there a workaround ?&lt;br&gt;
many thanks&lt;br&gt;
here is my code:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;Imports System.IO
Imports System
Imports System.Text
Imports OfficeOpenXml.style
Imports OfficeOpenXml

Module Module3
    Public Sub main()
        Dim oDal As New DAL1

        Dim ds As DataSet = oDal.getIncassi("Piano")

        Dim m As New MemoryStream()

        Dim package As ExcelPackage = New ExcelPackage(m)

        Dim wsheet As ExcelWorksheet = package.Workbook.Worksheets.Add("Sheet 1")

        wsheet.Cells("A1").LoadFromDataTable(ds.Tables(0), True)

        package.Save()
        m.Position = 0

        inviaMail(m)
        package = Nothing
        m = Nothing
    End Sub

    Public Sub inviaMail(ByVal attchMe As System.IO.MemoryStream)
        Dim emailTo As String = "me@me.it"

        Dim ms As New MemoryStream(attchMe.GetBuffer(), 0, attchMe.GetBuffer().Length)

        Dim attch As System.Net.Mail.Attachment = New System.Net.Mail.Attachment(ms, "Piano.xlsx", _
                 "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet")

        Dim Mail As New System.Net.Mail.SmtpClient
        Dim message As New System.Net.Mail.MailMessage
        Dim fromAddress As New System.Net.Mail.MailAddress("Sender@me.it")

        message.To.Add(emailTo)

        message.Subject = "Prova XLSX al volo "
        message.Attachments.Add(attch)

        message.Body = "Body della mail"

        message.From = fromAddress

        Mail.Host = "myhst.me.it" 'server_name here
        Try
            Mail.Send(message)
        Catch ex As Exception
            Throw New Exception("Il servizio di posta non e' al momento attivo")
        End Try
        Mail = Nothing
        message = Nothing
        fromAddress = Nothing
        attch.Dispose()
        GC.Collect()

    End Sub&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mbeppe" When="10/10/2014 07:03:17">
          <Html>
        &lt;div class="markDownOutput "&gt;Solved!! &lt;br&gt;
For those who want to send an email with attached an EPPPlus "on the fly" (not written on disk) using .NET:
&lt;br&gt;
imports System.IO &lt;br&gt;
Imports System &lt;br&gt;
Imports System.Text &lt;br&gt;
Imports OfficeOpenXml.style &lt;br&gt;
Imports OfficeOpenXml &lt;br&gt;
' insert code for layer data -------&lt;br&gt;
&lt;pre&gt;&lt;code&gt;    Dim  m As New MemoryStream()
    Dim package As ExcelPackage = New ExcelPackage(m)
    Dim wsheet As ExcelWorksheet = package.Workbook.Worksheets.Add("Sheet 1")&lt;/code&gt;&lt;/pre&gt;
' insert code for eppplus xlsx -------&lt;br&gt;
&lt;pre&gt;&lt;code&gt;     package.Save()
    m.Position = 0&lt;/code&gt;&lt;/pre&gt;
' insert code for email ----- &lt;br&gt;
&lt;pre&gt;&lt;code&gt;     Dim attch As System.Net.Mail.Attachment = New System.Net.Mail.Attachment(m, "name.xlsx", _
                     "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet")
    message.Attachments.Add(attch)&lt;/code&gt;&lt;/pre&gt;
' send mail &lt;br&gt;
DONE.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="&quot;Unterminated String&quot; error on Calculate()">
      <Posts>
        <Post From="pimbrouwers" When="08/10/2014 22:02:27">
          <Html>
        &lt;div class="markDownOutput "&gt;There is an issue with the "EnsureStringsAreWellFormed" function (seen below), whereby it's identifying a single quote within double quotes as a new "OpenedString".
&lt;br&gt;
&lt;pre&gt;&lt;code&gt;private void EnsureStringsAreWellFormed(Token token, AnalyzingContext context)
        {
            if (!context.IsInString &amp;amp;&amp;amp; token.TokenType == TokenType.String)
            {
                context.IsInString = true;
                context.OpenedStrings++;
            }
            else if (context.IsInString &amp;amp;&amp;amp; token.TokenType == TokenType.String)
            {
                context.IsInString = false;
                context.ClosedStrings++;
            }
        }&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Load a picture from a spread sheet">
      <Posts>
        <Post From="davidw567" When="29/08/2014 12:02:46">
          <Html>
        &lt;div class="markDownOutput "&gt;I create a spread sheet and add a jpg image to it using &lt;br&gt;
&lt;br&gt;
private static void AddImage(ExcelWorksheet ws, int columnIndex, int rowIndex, string filePath)&lt;br&gt;
&lt;pre&gt;&lt;code&gt;    {
        //How to Add a Image using EP Plus
        Bitmap image = new Bitmap(filePath);
        ExcelPicture picture = null;
        if (image != null)
        {
            picture = ws.Drawings.AddPicture("pic" + rowIndex.ToString() + columnIndex.ToString(), image);
            picture.From.Column = columnIndex;
            picture.From.Row = rowIndex;
            picture.SetSize(340, 256);
        }
    }

&lt;/code&gt;&lt;/pre&gt;
BUT &lt;br&gt;
&lt;br&gt;
I also need to read the spread sheet back in. &lt;br&gt;
How do I read the image from the spread sheet into a Bitmap?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="davidw567" When="08/10/2014 15:03:42">
          <Html>
        &lt;div class="markDownOutput "&gt;Can anybody help please&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="External links">
      <Posts>
        <Post From="igitur" When="02/02/2012 10:19:52">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I'd like to enumerate all external links (links to other Excel worksbooks). Is it possible?&lt;/p&gt;
&lt;p&gt;thanks,&lt;br&gt;
Francois&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="06/02/2012 21:52:45">
          <Html>
        
&lt;p&gt;No, external links is&amp;nbsp;currently very poorly supported by the library, but I hope I can improve it sometime in the future.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="igitur" When="13/06/2012 09:01:20">
          <Html>
        
&lt;p&gt;Even though they aren't supported in the meantime, could you perhaps give me some pointers on how to manage (edit) the external links by working directly with the Package object and the internal .xml files? I've already successfully enumerated the links,
 but I'm unable to change them.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="DangerMouseParker" When="16/08/2012 18:05:23">
          <Html>
        
&lt;p&gt;igitur, how did you enumerate the links? I am very interested in being able to do this as well. Cheers!&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="igitur" When="17/08/2012 09:13:40">
          <Html>
        
&lt;p&gt;Probably not the most elegant way, but here's how I do it:&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre style="white-space: pre; -ms-overflow-x: auto;"&gt;&lt;span style="color: blue;"&gt;using&lt;/span&gt; (ExcelPackage excelPackage = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(InputFileInfo))
{
    &lt;span style="color: green;"&gt;//The links to external files are contained in separate .xml files in the Excel zip package&lt;/span&gt;
    &lt;span style="color: green;"&gt;//There is a specific metadata xml file which has references to the .xml files with the actual links.&lt;/span&gt;
    &lt;span style="color: green;"&gt;//So the process is: Open the metadata xml file, find the .xml files, open the .xml files, parse the actual link to the external Excel files.&lt;/span&gt;

    &lt;span style="color: green;"&gt;//The external links' xml files (also metadata?) are referenced by '/xl/_rels/workbook.xml.rels' in the zip package&lt;/span&gt;
    &lt;span style="color: blue;"&gt;var&lt;/span&gt; workbookLinksPart = excelPackage.Package.GetParts().Where(p =&amp;gt; p.ContentType.Equals(&lt;span style="color: rgb(163, 21, 21);"&gt;"application/vnd.openxmlformats-package.relationships+xml"&lt;/span&gt;) &amp;amp;&amp;amp; p.Uri.ToString().Equals(&lt;span style="color: rgb(163, 21, 21);"&gt;"/xl/_rels/workbook.xml.rels"&lt;/span&gt;)).First();

    &lt;span style="color: green;"&gt;//Open the stream to that part&lt;/span&gt;
    XDocument workbookXmlDoc = XDocument.Load(workbookLinksPart.GetStream(FileMode.Open, FileAccess.Read));

    &lt;span style="color: green;"&gt;//Enumerate the links xml files in that part&lt;/span&gt;
    &lt;span style="color: blue;"&gt;var&lt;/span&gt; externalLinksXML = &lt;span style="color: blue;"&gt;from&lt;/span&gt; r &lt;span style="color: blue;"&gt;in&lt;/span&gt; workbookXmlDoc.Descendants()
                        &lt;span style="color: blue;"&gt;where&lt;/span&gt; r.Name.LocalName.Equals(&lt;span style="color: rgb(163, 21, 21);"&gt;"Relationship"&lt;/span&gt;) &amp;amp;&amp;amp;
                        r.Attribute(&lt;span style="color: rgb(163, 21, 21);"&gt;"Type"&lt;/span&gt;).Value.Equals(&lt;span style="color: rgb(163, 21, 21);"&gt;"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink"&lt;/span&gt;)
                        &lt;span style="color: blue;"&gt;select&lt;/span&gt; (&lt;span style="color: blue;"&gt;string&lt;/span&gt;)r.Attribute(&lt;span style="color: rgb(163, 21, 21);"&gt;"Target"&lt;/span&gt;);

&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;span style="background-color: white;"&gt;Originally I thought that would give me the list of links, but I found that many of the links were not used, and in Excel didn't even display if you click "Edit links". I have no idea why they are there, but
 I consider them 'orphaned links'. To check whether a link is used, adds a whole level of complexity and slows down the process, but I haven't found a way around it. &amp;nbsp;So, continuing...&amp;nbsp;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="background-color: white;"&gt;&amp;nbsp;&lt;/span&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;    &lt;span style="color: blue;"&gt;foreach&lt;/span&gt; (&lt;span style="color: blue;"&gt;var&lt;/span&gt; linkXML &lt;span style="color: blue;"&gt;in&lt;/span&gt; externalLinksXML)
    {
        &lt;span style="color: green;"&gt;// Grab linkId from target link string&lt;/span&gt;
        &lt;span style="color: blue;"&gt;int&lt;/span&gt; linkId = &lt;span style="color: blue;"&gt;int&lt;/span&gt;.Parse(Regex.Match(linkXML, &lt;span style="color: rgb(163, 21, 21);"&gt;@"externalLinks/externalLink(\d+)\.xml"&lt;/span&gt;).Groups[1].Captures[0].Value);

        &lt;span style="color: green;"&gt;// Use the linkId only to check whether the link is actually used. I'll document this method later.&lt;/span&gt;
        &lt;span style="color: blue;"&gt;if&lt;/span&gt; (IsLinkIdUsed(excelPackage, linkId))
        {
            &lt;span style="color: blue;"&gt;string&lt;/span&gt; linkrel = linkXML.Replace(&lt;span style="color: rgb(163, 21, 21);"&gt;"externalLinks/"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"externalLinks/_rels/"&lt;/span&gt;) + &lt;span style="color: rgb(163, 21, 21);"&gt;".rels"&lt;/span&gt;;
            &lt;span style="color: blue;"&gt;var&lt;/span&gt; linkPart = excelPackage.Package.GetParts().Where(p =&amp;gt; p.ContentType.Equals(&lt;span style="color: rgb(163, 21, 21);"&gt;"application/vnd.openxmlformats-package.relationships+xml"&lt;/span&gt;) &amp;amp;&amp;amp; p.Uri.ToString().Contains(linkrel)).First();

            &lt;span style="color: blue;"&gt;var&lt;/span&gt; stream = linkPart.GetStream(FileMode.Open, FileAccess.ReadWrite);
            XDocument xmlDoc = XDocument.Load(stream);

            &lt;span style="color: green;"&gt;// usually there is only one relationship (external link) in that file, but I make provision in case there are more than one&lt;/span&gt;
            &lt;span style="color: blue;"&gt;var&lt;/span&gt; relationships = &lt;span style="color: blue;"&gt;from&lt;/span&gt; r &lt;span style="color: blue;"&gt;in&lt;/span&gt; xmlDoc.Descendants()
                          &lt;span style="color: blue;"&gt;where&lt;/span&gt; r.Name.LocalName.Equals(&lt;span style="color: rgb(163, 21, 21);"&gt;"Relationship"&lt;/span&gt;)
                          &lt;span style="color: blue;"&gt;select&lt;/span&gt; r;

            &lt;span style="color: blue;"&gt;foreach&lt;/span&gt; (&lt;span style="color: blue;"&gt;var&lt;/span&gt; relationship &lt;span style="color: blue;"&gt;in&lt;/span&gt; relationships)
            {
                &lt;span style="color: green;"&gt;// This is what we're after!&lt;/span&gt;
                &lt;span style="color: blue;"&gt;string&lt;/span&gt; target = relationship.Attribute(&lt;span style="color: rgb(163, 21, 21);"&gt;"Target"&lt;/span&gt;).Value;

                &lt;span style="color: green;"&gt;// In my case, I needed an absolute URL, not relative as most of the values would be. You can skip this part if you want to.&lt;/span&gt;
                Uri targetUri;
                &lt;span style="color: blue;"&gt;string&lt;/span&gt; filePath;
                &lt;span style="color: blue;"&gt;if&lt;/span&gt; (Uri.TryCreate(target, UriKind.RelativeOrAbsolute, &lt;span style="color: blue;"&gt;out&lt;/span&gt; targetUri) &amp;amp;&amp;amp; targetUri.IsAbsoluteUri)
                    filePath = targetUri.LocalPath;
                &lt;span style="color: blue;"&gt;else&lt;/span&gt;
                    filePath = target;

                filePath = ResolvePath(doc, filePath);
            }
        }
    }
}
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;span style="background-color: white;"&gt;The helper methods are (written in a huge hurry, so don't judge):&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="background-color: white;"&gt;&amp;nbsp;&lt;/span&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;private&lt;/span&gt; &lt;span style="color: blue;"&gt;bool&lt;/span&gt; IsLinkIdUsed(ExcelPackage excelPackage, &lt;span style="color: blue;"&gt;int&lt;/span&gt; linkId)
{
    &lt;span style="color: blue;"&gt;bool&lt;/span&gt; isUsed = &lt;span style="color: blue;"&gt;false&lt;/span&gt;;

    &lt;span style="color: blue;"&gt;var&lt;/span&gt; sheetParts = excelPackage.Package.GetParts().Where(p =&amp;gt; p.ContentType.Equals(&lt;span style="color: rgb(163, 21, 21);"&gt;"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"&lt;/span&gt;) &amp;amp;&amp;amp; p.Uri.ToString().StartsWith(&lt;span style="color: rgb(163, 21, 21);"&gt;"/xl/worksheets/sheet"&lt;/span&gt;));
    &lt;span style="color: blue;"&gt;foreach&lt;/span&gt; (&lt;span style="color: blue;"&gt;var&lt;/span&gt; sheetPart &lt;span style="color: blue;"&gt;in&lt;/span&gt; sheetParts)
    {
        XDocument sheetXmlDoc = XDocument.Load(sheetPart.GetStream(FileMode.Open, FileAccess.Read));

        &lt;span style="color: blue;"&gt;var&lt;/span&gt; referencesToLink = &lt;span style="color: blue;"&gt;from&lt;/span&gt; r &lt;span style="color: blue;"&gt;in&lt;/span&gt; sheetXmlDoc.Descendants()
                            &lt;span style="color: blue;"&gt;where&lt;/span&gt; r.Name.LocalName.Equals(&lt;span style="color: rgb(163, 21, 21);"&gt;"f"&lt;/span&gt;) &amp;amp;&amp;amp; r.Value.Contains(&lt;span style="color: blue;"&gt;string&lt;/span&gt;.Format(&lt;span style="color: rgb(163, 21, 21);"&gt;"[{0}]"&lt;/span&gt;, linkId))
                            &lt;span style="color: blue;"&gt;select&lt;/span&gt; r;

        isUsed = isUsed || referencesToLink.Count() &amp;gt; 0;
        &lt;span style="color: blue;"&gt;if&lt;/span&gt; (isUsed) &lt;span style="color: blue;"&gt;return&lt;/span&gt; &lt;span style="color: blue;"&gt;true&lt;/span&gt;;

    }

    &lt;span style="color: blue;"&gt;return&lt;/span&gt; isUsed;
}
&lt;/pre&gt;
&lt;/div&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;private&lt;/span&gt; &lt;span style="color: blue;"&gt;static&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; ResolvePath(OfficeDocument doc, &lt;span style="color: blue;"&gt;string&lt;/span&gt; filePath)
{
    filePath = filePath.Replace(&lt;span style="color: rgb(163, 21, 21);"&gt;"%20"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;" "&lt;/span&gt;);
    &lt;span style="color: blue;"&gt;if&lt;/span&gt; (filePath.StartsWith(&lt;span style="color: rgb(163, 21, 21);"&gt;"/"&lt;/span&gt;) || !filePath.StartsWith("\\") &amp;amp;&amp;amp; !filePath.Contains(&lt;span style="color: rgb(163, 21, 21);"&gt;':'&lt;/span&gt;))
    {
        &lt;span style="color: green;"&gt;//relative link&lt;/span&gt;
        &lt;span style="color: blue;"&gt;if&lt;/span&gt; (filePath.StartsWith(&lt;span style="color: rgb(163, 21, 21);"&gt;"/"&lt;/span&gt;))
            filePath = &lt;span style="color: blue;"&gt;new&lt;/span&gt; FileInfo(doc.FullPath).Directory.Root.FullName + filePath.Substring(1).Replace(&lt;span style="color: rgb(163, 21, 21);"&gt;'/'&lt;/span&gt;, '\\');
        &lt;span style="color: blue;"&gt;else&lt;/span&gt;
            filePath = Path.Combine(&lt;span style="color: blue;"&gt;new&lt;/span&gt; FileInfo(doc.FullPath).DirectoryName, filePath.Replace(&lt;span style="color: rgb(163, 21, 21);"&gt;'/'&lt;/span&gt;, '\\'));
    }
    &lt;span style="color: blue;"&gt;return&lt;/span&gt; filePath;
}

&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="17/08/2012 12:30:00">
          <Html>
        
&lt;p&gt;nice work igitur! Dont be shy! When someone has pride of their code, they waste a lot of time coding hehehe&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="surika" When="06/10/2014 19:36:30">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi igitur, &lt;br&gt;
&lt;br&gt;
I'm interested interested in this issue. Can you provide a complete code? &lt;br&gt;
&lt;br&gt;
Thanks in advance, &lt;br&gt;
surika&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Autofit row height">
      <Posts>
        <Post From="iakobelev" When="06/10/2014 12:10:31">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi. &lt;br&gt;
Is it possible to set the automatic row height on the content? &lt;br&gt;
Or how to manually calculate the height of the text with the line break? &lt;br&gt;
&lt;br&gt;
regards.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to show created sheet without saving? how to open and show for userwithout saving?">
      <Posts>
        <Post From="kwestia" When="30/09/2014 16:47:36">
          <Html>
        &lt;div class="markDownOutput "&gt;the user needs to choose place of saving without package,saveas(..)&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="01/10/2014 18:19:03">
          <Html>
        &lt;div class="markDownOutput "&gt;EPPlus it isn't a web viewer for Excel. It can open existing files, modify and save them.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="kwestia" When="01/10/2014 19:04:16">
          <Html>
        &lt;div class="markDownOutput "&gt;Thanks for reply. Microsoft Excel is not web viewer too. But you can create Sheet object and show it for user before saving - is there similar possibility with EPPlus?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="01/10/2014 19:30:37">
          <Html>
        &lt;div class="markDownOutput "&gt;No, there is no kind of preview before save. Maybe you can generate and save an excel file with epplus on the server and show to user via google docs embedded in your site and make this transparent to your end-user, but you will need always to save.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="kwestia" When="02/10/2014 18:55:18">
          <Html>
        &lt;div class="markDownOutput "&gt;Thank you so much :) I didn't find information about it, so I need to generate for ex. "Report(date time).xlsx" name, and save it in app directory, reopen with System.Process while shows for user. I'll try, thanx and kind regards ...&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Formula using cell values between worksheets - problem">
      <Posts>
        <Post From="csienke" When="30/09/2014 11:23:05">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello, &lt;br&gt;
&lt;br&gt;
I would like to count the data of cell values from another worksheet using a formula from my current worksheet.
&lt;br&gt;
Example:&lt;br&gt;
&lt;ul&gt;
&lt;li&gt;another worksheets name is "Details - Calculation" &lt;/li&gt;&lt;li&gt;current worksheet name is "Statistics" &lt;/li&gt;&lt;li&gt;cells D7:D17 are in the worksheet "Details - Calculation" &lt;/li&gt;&lt;li&gt;cell D3 is on the current worksheet ("Statistics") and contains the string value I would like to count (ex. "apple")&lt;br&gt;
&lt;/li&gt;&lt;/ul&gt;
I'm using the following formula to do this:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;string formula = "COUNTIF($'Details - Calculation'.$D$7:$D$17;D3)";
worksheet.Cells[LastRow, FirstColumn].Formula = formula;&lt;/code&gt;&lt;/pre&gt;
The problem is that when I open the file in OpenOffice, an extra parentheses is added to the end of the formula and the cell will contain the following error: #NAME?
&lt;br&gt;
When I delete this extra parentheses and I press enter, the calculation is correct.
&lt;br&gt;
&lt;br&gt;
I tried the following formula with Excel as well, but I got the message &lt;em&gt;""Excel found unreadable content in test.xlsx. Do you want to recocer the contents of this workbook? If you trust the source of this workbook, click Yes.""&lt;/em&gt;
 After I click yes, the cell is empty and doesn't contain the formula. &lt;br&gt;
&lt;br&gt;
I tried the following formulas as well (cell A2 contains the text "Details - Calculation" and is in the current worksheet -&amp;gt; "Statistics"):&lt;br&gt;
&lt;pre&gt;&lt;code&gt;=COUNTIF($'Details - Calculation'.$D$7:$D$17;D3)  // OpenOffice
=COUNTIF(INDIRECT("'" &amp;amp; A2 &amp;amp; "'.$D$7:$D$17");D3) // OpenOffice

=COUNTIF(INDIRECT("'" &amp;amp; A2 &amp;amp; "'!$D$7:$D$17");D3) // Excel
=COUNTIF('Details - Visible Engine'!$D$8:$D$17;D3) // Excel&lt;/code&gt;&lt;/pre&gt;
When I enter them manually, they work. When I do it with EPPlus (in this case I don't include the = sign) and I open the file I got the error message written above from Excel and Err:508 in the case of OpenOffice. In the case of OpenOffice when I go to the
 formula, I delete the dot, I write it again and I press enter, the error disappears and the calculation is correct.
&lt;br&gt;
&lt;br&gt;
Can anybody help me with this? Thank you in advance.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="csienke" When="01/10/2014 10:27:46">
          <Html>
        &lt;div class="markDownOutput "&gt;I figured it out. If somebody has the same problem here is the solution: &lt;br&gt;
&lt;br&gt;
Correct Excel formula:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;=COUNTIF(INDIRECT("'" &amp;amp; A2 &amp;amp; "'!$D$7:$D$17");D3)&lt;/code&gt;&lt;/pre&gt;
C# code wrong formula:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;string formula = "COUNTIF(INDIRECT(\"'\" &amp;amp; A2 &amp;amp; \"'!$D$7:$D$17\");D3)";&lt;/code&gt;&lt;/pre&gt;
C# code correct formula:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;string formula = "COUNTIF(INDIRECT(\"'\" &amp;amp; A2 &amp;amp; \"'!$D$7:$D$17\"),D3)";&lt;/code&gt;&lt;/pre&gt;
&lt;strong&gt;Conclusion&lt;/strong&gt;: in the code we should use the comma instead of the semicolon. After opening the generated excel file the comma will be replaced by the semicolon, so the formula will be correct.
&lt;br&gt;
&lt;br&gt;
&lt;strong&gt;Note:&lt;/strong&gt; in OpenOffice Calc instead of the exclamation mark (!) we should use the dot (.)&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="01/10/2014 19:42:21">
          <Html>
        &lt;div class="markDownOutput "&gt;It´s great to know that you solved your problem. This is a pretty common error among EPPlus users from non en-US culture.
&lt;br&gt;
&lt;br&gt;
If anybody find this thread with same issues, this tip, and others too, are in our EPPlus FAQ.
&lt;br&gt;
&lt;br&gt;
Take a look when you have a time =) &lt;br&gt;
&lt;br&gt;
&lt;a href="https://epplus.codeplex.com/wikipage?title=FAQ&amp;amp;referringTitle=Documentation" rel="nofollow"&gt;https://epplus.codeplex.com/wikipage?title=FAQ&amp;amp;referringTitle=Documentation&lt;/a&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="hour format">
      <Posts>
        <Post From="bermaneyal" When="30/09/2014 14:33:04">
          <Html>
        &lt;div class="markDownOutput "&gt;i have a cell that need to be in format hh:mm, &lt;br&gt;
this is my code&lt;br&gt;
&lt;pre&gt;&lt;code&gt; ws.Cells[rowNumber, 11].Style.Numberformat.Format = "hh:mm";
 string start = row.R_HourStart.ToString("HH:mm");
ws.Cells[rowNumber, 11].LoadFromText(start);&lt;/code&gt;&lt;/pre&gt;
in the excel i see in the cell "10:00" but when i go over it i see in the function field the text "30/09/2014 10:00:00".
&lt;br&gt;
&lt;br&gt;
i want it to be just "10:00"&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="01/10/2014 19:23:53">
          <Html>
        &lt;div class="markDownOutput "&gt;Instead of "hh:mm" try "h:mm", I didn´t find "hh:mm" format in excel built in styles, maybe this is the problem.
&lt;br&gt;
&lt;br&gt;
&lt;a href="http://polymathprogrammer.com/2011/02/15/built-in-styles-for-excel-open-xml/" rel="nofollow"&gt;http://polymathprogrammer.com/2011/02/15/built-in-styles-for-excel-open-xml/&lt;/a&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How do you determine if a cell has an error such as #NAME? or #VALUE! when reading a spreadsheet with EPPLUS?">
      <Posts>
        <Post From="ivankrsul" When="29/09/2014 17:11:25">
          <Html>
        &lt;div class="markDownOutput "&gt;How do you determine if a cell has an error such as #NAME? or #VALUE! when reading a spreadsheet with EPPLUS? What I currently do is:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;                    if (worksheet.Cells[i, j] is double &amp;amp;&amp;amp; Double.IsNaN((double)worksheet.Cells[i, j] ))
&lt;/code&gt;&lt;/pre&gt;
But this seems incomplete. Is there a more elegant way to determine if a cell has an error such as #NAME? or #VALUE! when reading a spreadsheet with EPPLUS?
&lt;br&gt;
&lt;br&gt;
Ivan&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="01/10/2014 18:24:45">
          <Html>
        &lt;div class="markDownOutput "&gt;I´m pretty sure there is no way to do that, EPPlus can generate Excel files but it isn't a full Excel engine. This kind of problems usually are bad formulas, references, etc. Maybe with the new Calculation Engine (Beta 4.0), you can discover some of that
 errors, but not all of them.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Using EPP for filling VBA forms?">
      <Posts>
        <Post From="mortenlouw" When="30/09/2014 22:07:16">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
I have gotten a request from a customer. They are asking me if I can fill an existing excel workbook with the EPP framework. The thing is that the workbook holds a lot of VBA and is using vba forms.
&lt;br&gt;
&lt;br&gt;
What I will need to do is find certain textboxes and add content to their values, and then invoke the events on the buttons.
&lt;br&gt;
&lt;br&gt;
Is this beyond EPPlus? If so, does anyone know any alternatives? &lt;br&gt;
&lt;br&gt;
Kind regards, &lt;br&gt;
Morten&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Zeroes stripped when reading phone numbers">
      <Posts>
        <Post From="Twinbee" When="25/09/2014 13:30:14">
          <Html>
        &lt;div class="markDownOutput "&gt;When I read an XLSX file with cells containing zeroes (for example 00359182), the zeroes get removed. How can I prevent this from happening?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Twinbee" When="25/09/2014 13:31:34">
          <Html>
        &lt;div class="markDownOutput "&gt;Found the solution: I used .Text instead of .Value. E.g: &lt;br&gt;
&lt;br&gt;
object o = workBook.Worksheets[n].Cells[y,x].Text&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="kwestia" When="30/09/2014 08:02:29">
          <Html>
        &lt;div class="markDownOutput "&gt;Right, it needs to be done everywhere with preceding zeros like zip codes, people's numbers and so on&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Not able to open Worksheet">
      <Posts>
        <Post From="samrules" When="08/06/2011 11:23:52">
          <Html>
        
&lt;p&gt;Hi,&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I am not able to open up an excel sheet using EPPlus. Below is my code I am just trying to get reference of Worksheet so that I can play on that:&lt;/p&gt;
&lt;p&gt;&lt;span style="white-space: pre;"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;     &lt;span style="color: blue;"&gt;string&lt;/span&gt; filePath = txtboxSelectedFile.Text;
            FileInfo file = &lt;span style="color: blue;"&gt;new&lt;/span&gt; FileInfo(filePath);
            ExcelPackage package = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(file);   
        ExcelWorksheet sheet = package.Workbook.Worksheets[0];
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Exception details with stack trace is :&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Index was out of range. Must be non-negative and less than the size of the collection.Parameter name: index&lt;br&gt;
&lt;br&gt;
&amp;nbsp; &amp;nbsp;at System.ThrowHelper.ThrowArgumentOutOfRangeException()&amp;nbsp; &amp;nbsp;at System.Collections.Generic.List`1.get_Item(Int32 index)&amp;nbsp; &amp;nbsp;at OfficeOpenXml.ExcelStyleCollection`1.get_Item(Int32 PositionID)&amp;nbsp; &amp;nbsp;at OfficeOpenXml.Style.ExcelStyle..ctor(ExcelStyles
 styles, ChangedEventHandler ChangedEvent, Int32 positionID, String Address, Int32 xfsId)&amp;nbsp; &amp;nbsp;at OfficeOpenXml.Style.XmlAccess.ExcelNamedStyleXml..ctor(XmlNamespaceManager NameSpaceManager, XmlNode topNode, ExcelStyles styles)&amp;nbsp; &amp;nbsp;at OfficeOpenXml.ExcelStyles.LoadFromDocument()&amp;nbsp;
 &amp;nbsp;at OfficeOpenXml.ExcelStyles..ctor(XmlNamespaceManager NameSpaceManager, XmlDocument xml, ExcelWorkbook wb)&amp;nbsp; &amp;nbsp;at OfficeOpenXml.ExcelWorkbook.get_Styles()&amp;nbsp; &amp;nbsp;at OfficeOpenXml.ExcelCell.get_Style()&amp;nbsp; &amp;nbsp;at OfficeOpenXml.ExcelWorksheet.GetValueFromXml(ExcelCell
 cell, XmlTextReader xr)&amp;nbsp; &amp;nbsp;at OfficeOpenXml.ExcelWorksheet.LoadCells(XmlTextReader xr)&amp;nbsp; &amp;nbsp;at OfficeOpenXml.ExcelWorksheet.CreateXml()&amp;nbsp; &amp;nbsp;at OfficeOpenXml.ExcelWorksheet..ctor(XmlNamespaceManager ns, ExcelPackage excelPackage, String
 relID, Uri uriWorksheet, String sheetName, Int32 sheetID, Int32 positionID, eWorkSheetHidden hide)&amp;nbsp; &amp;nbsp;at OfficeOpenXml.ExcelWorksheets..ctor(ExcelPackage xlPackage)&amp;nbsp; &amp;nbsp;at OfficeOpenXml.ExcelWorkbook.get_Worksheets()&amp;nbsp; &amp;nbsp;at TimeSheetTracker.Main.ProcessInputs()
 in D:\TryOut Projects\TimeSheetTracker\TimeSheetTracker\Main.cs:line 39&amp;nbsp; &amp;nbsp;at TimeSheetTracker.Main.btnProcess_Click(Object sender, EventArgs e) in D:\TryOut Projects\TimeSheetTracker\TimeSheetTracker\Main.cs:line 25&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;The Excel sheet that I am trying to open is of .xlsx type and contains only one worksheet with some data.&lt;/p&gt;
&lt;p&gt;The thing is when I copy my data into one of the sample .xlsx files of EPPlus it works fine. &amp;nbsp;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Does anybody knows that what can be the problem??&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks in advance&lt;/p&gt;
&lt;p&gt;Regards&lt;/p&gt;
&lt;p&gt;Sumit&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="semanthos" When="08/06/2011 23:41:34">
          <Html>
        
&lt;p&gt;Same problem here. Workbook.Worksheets container is null. It does not happen with every file - I've created a test file and it opened without problems. Problematic file is huge, lots of sheets were created, deleted, moved, etc... Tried fixing it manually
 editing sheet ids after unziping xlsx file so that they would be in sequence from 1, it didn't help.&lt;/p&gt;
&lt;p&gt;Btw, I think you should use index of 1, not zero:&lt;/p&gt;
&lt;p&gt;ExcelWorksheet sheet = package.Workbook.Worksheets[1];&lt;/p&gt;
&lt;p&gt;Sheets are numbered starting from 1.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="09/06/2011 12:44:30">
          <Html>
        
&lt;p&gt;I think this is the same problem as issue &lt;span id="IssueIdLabel"&gt;13639.&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Try the latest source and see if it solves your problem.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="semanthos" When="09/06/2011 22:41:51">
          <Html>
        
&lt;blockquote style="margin: 0.25em 1em 0px; padding: 0px 0.25em; border: 0.1em solid rgb(204, 204, 204); border-image: none; font-style: italic;"&gt;
&lt;strong&gt;jankallman wrote:&lt;/strong&gt;&lt;br&gt;
&lt;p&gt;I think this is the same problem as issue &lt;span id="IssueIdLabel"&gt;13639.&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Try the latest source and see if it solves your problem.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;I'm using latest version, I think (I've downloaded it two or three days ago).&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="swmal" When="10/06/2011 07:28:33">
          <Html>
        
&lt;blockquote style="margin: 0.25em 1em 0px; padding: 0px 0.25em; border: 0.1em solid rgb(204, 204, 204); border-image: none; font-style: italic;"&gt;
&lt;strong&gt;semanthos wrote:&lt;/strong&gt;&lt;br&gt;
&lt;blockquote style="margin: 0.25em 1em 0px; padding: 0px 0.25em; border: 0.1em solid rgb(204, 204, 204); border-image: none; font-style: italic;"&gt;
&lt;strong&gt;jankallman wrote:&lt;/strong&gt;&lt;br&gt;
&lt;p&gt;I think this is the same problem as issue &lt;span id="IssueIdLabel"&gt;13639.&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Try the latest source and see if it solves your problem.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;I'm using latest version, I think (I've downloaded it two or three days ago).&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;br&gt;
Jan means that you should get the latest source code and build it yourself. Eventually there will be a 2.9.0.2, but until then bugfixes are only available in the source code.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Grossmeister" When="11/07/2011 14:00:58">
          <Html>
        
&lt;p&gt;Have the same trouble with one file. It is not big, or something - looks normal.&lt;/p&gt;
&lt;p&gt;Using release from May 31.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Grossmeister" When="11/07/2011 14:00:59">
          <Html>
        
&lt;p&gt;Have the same trouble with one file. It is not big, or something - looks normal.&lt;/p&gt;
&lt;p&gt;Using release from May 31.&lt;/p&gt;
&lt;p&gt;Update: it looks working with the latest source.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jjw92" When="27/09/2011 01:05:54">
          <Html>
        
&lt;p&gt;I have the same issue.&amp;nbsp; I downloaded the most recent source code and built it but still getting the error...&lt;/p&gt;
&lt;p&gt;'package.Workbook.Worksheets' threw an exception of type 'System.ArgumentOutOfRangeException'&lt;br&gt;
"Index was out of range. Must be non-negative and less than the size of the collection.\r\nParameter name: index"&lt;/p&gt;
&lt;p&gt;The problem workbook is very large (6MB with hundreds of worksheets and takes about 20-30 seconds to load in Excel).&amp;nbsp; As soon as I load the file, which happens very quickly, _worksheets is null.&amp;nbsp; Same code works for a smaller workbook (3 worksheets)
 that is generated by the same system.&lt;/p&gt;
&lt;p&gt;FileInfo&amp;nbsp;fiExcel = new FileInfo(txtFilename.Text);&lt;br&gt;
using (ExcelPackage&amp;nbsp;package = new ExcelPackage(fiExcel))&lt;/p&gt;
&lt;p&gt;I don't have control over the source as it's generated by another system.&amp;nbsp; I need to split it up into multiple workbooks but can't get it to open successfully.&lt;/p&gt;
&lt;p&gt;Any workarounds to this?&lt;/p&gt;
&lt;p&gt;Thanks,&lt;br&gt;
Jim&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="hekucn" When="27/09/2011 02:29:31">
          <Html>
        
&lt;blockquote style="margin: 0.25em 1em 0px; padding: 0px 0.25em; border: 0.1em solid rgb(204, 204, 204); border-image: none; font-style: italic;"&gt;
&lt;strong&gt;May be like this:&lt;br&gt;
&lt;/strong&gt;
&lt;p&gt;&lt;span style="white-space: pre;"&gt;&amp;nbsp;&lt;/span&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;     &lt;span style="color: blue;"&gt;string&lt;/span&gt; filePath = txtboxSelectedFile.Text;
            FileInfo file = &lt;span style="color: blue;"&gt;new&lt;/span&gt; FileInfo(filePath);
            ExcelPackage package = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(file);   
        ExcelWorksheet sheet = package.Workbook.Worksheets[&lt;span style="color: rgb(255, 0, 255);"&gt;&lt;strong&gt;1&lt;/strong&gt;&lt;/span&gt;];//start from 1&lt;/pre&gt;
&lt;/div&gt;
&lt;/blockquote&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jjw92" When="27/09/2011 13:22:52">
          <Html>
        
&lt;blockquote style="margin: 0.25em 1em 0px; padding: 0px 0.25em; border: 0.1em solid rgb(204, 204, 204); border-image: none; font-style: italic;"&gt;
&lt;strong&gt;hekucn wrote:&lt;/strong&gt;&lt;br&gt;
&lt;blockquote style="margin: 0.25em 1em 0px; padding: 0px 0.25em; border: 0.1em solid rgb(204, 204, 204); border-image: none; font-style: italic;"&gt;
&lt;strong&gt;May be like this:&lt;br&gt;
&lt;/strong&gt;
&lt;p&gt;&lt;span style="white-space: pre;"&gt;&amp;nbsp;&lt;/span&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;     &lt;span style="color: blue;"&gt;string&lt;/span&gt; filePath = txtboxSelectedFile.Text;
            FileInfo file = &lt;span style="color: blue;"&gt;new&lt;/span&gt; FileInfo(filePath);
            ExcelPackage package = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(file);   
        ExcelWorksheet sheet = package.Workbook.Worksheets[&lt;span style="color: rgb(255, 0, 255);"&gt;&lt;strong&gt;1&lt;/strong&gt;&lt;/span&gt;];//start from 1&lt;/pre&gt;
&lt;/div&gt;
&lt;/blockquote&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;br&gt;
Thanks. I did try that, as well referencing the first sheet by name, but it doesn't work.&amp;nbsp; I also tried...&lt;/p&gt;
&lt;p&gt;﻿﻿﻿﻿MessageBox.Show(package.Workbook.Worksheets.Count.ToString());&lt;/p&gt;
&lt;p&gt;... just to get the sheet count but the source file completely fails to load so that errors out too.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="27/09/2011 15:45:37">
          <Html>
        
&lt;p&gt;Hard to tell what the problem is.&lt;/p&gt;
&lt;p&gt;Create an issue and upload xlsx file and your code (or mail it to &lt;a href="mailto:epplusdocs@gmail.com" rel="nofollow"&gt;
epplusdocs@gmail.com&lt;/a&gt;).&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jjw92" When="28/09/2011 03:01:21">
          <Html>
        
&lt;p&gt;The source file is generated by a financial reporting system so I opened it in Excel to cleanse it of any sensitive info before uploading it.&amp;nbsp; Before uploading it I tested it again and of course it loaded successfully. :o)&amp;nbsp; I had also removed some
 worksheets in that process so I thought that may have been what fixed&amp;nbsp;the issue&amp;nbsp;so I tried another cleansed version&amp;nbsp;with all worksheets and that also worked.&lt;/p&gt;
&lt;p&gt;It looks like it's something with the format of the file being generated by the reporting system.&amp;nbsp; The original file size is 7.9 MB.&amp;nbsp; If I open it in Excel, do nothing but just save it again and close, the file becomes 8.1 MB.&amp;nbsp; That version
 then loads properly in EPPlus.&lt;/p&gt;
&lt;p&gt;Thanks for the feedback, it looks like I'll need to address the issue on the source side.&amp;nbsp; Worst case scenario they need to open the workbook, save, and close again before processing.&lt;/p&gt;
&lt;p&gt;Oh, and thanks for producing this library, it works great.&lt;/p&gt;
&lt;p&gt;-Jim&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="fudairu" When="15/11/2011 08:16:54">
          <Html>
        
&lt;p&gt;I have the same problem. So what is the last solve? I can not make it until I copy the file to a new one. So is there any other way?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="17/11/2011 06:44:34">
          <Html>
        
&lt;p&gt;You have to upload your file (or mail it to &lt;a href="mailto:epplusdocs@gmail.com" rel="nofollow"&gt;
epplusdocs@gmail.com&lt;/a&gt;).&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="daniloquio" When="29/11/2011 15:03:50">
          <Html>
        
&lt;p&gt;I had the same problem, now its working (I was using release 2.9.0.1, latest release by now).&lt;/p&gt;
&lt;p&gt;I went to&amp;nbsp;&lt;a href="http://epplus.codeplex.com/SourceControl/list/changesets" rel="nofollow"&gt;http://epplus.codeplex.com/SourceControl/list/changesets&lt;/a&gt;, downloaded the latest source code and compiled the project \trunk\ExcelPackage. I updated the reference uin my
 project with the generated EPPLUS.dll and now its working OK.&lt;/p&gt;
&lt;p&gt;Thanks a lot for this excelente tool, I've been using it for a while and this is the first issue I have with it.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Daniel.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="fudairu" When="06/12/2011 00:45:50">
          <Html>
        
&lt;blockquote style="margin: 0.25em 1em 0px; padding: 0px 0.25em; border: 0.1em solid rgb(204, 204, 204); border-image: none; font-style: italic;"&gt;
&lt;strong&gt;JanKallman wrote:&lt;/strong&gt;&lt;br&gt;
&lt;p&gt;You have to upload your file (or mail it to &lt;a href="mailto:epplusdocs@gmail.com" rel="nofollow"&gt;
epplusdocs@gmail.com&lt;/a&gt;).&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;br&gt;
I have sent my file to your email. but you never answer me. this paoblem is really confused me and my work has many files like that to deal with,so if I must copy each of them to a new file,it can be dead to me.I need your help.please answer me,thank you.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JudeNishamal" When="14/02/2012 12:29:34">
          <Html>
        
&lt;p&gt;I had the same error, And managed to make it work by using following code&lt;/p&gt;
&lt;p&gt;ExcelPackage excelPackage = new ExcelPackage();&lt;br&gt;
&lt;br&gt;
excelPackage.Load(new FileStream(excelFile, FileMode.Open));&lt;br&gt;
&lt;br&gt;
&amp;nbsp;ExcelWorksheet workSheet = excelPackage.Workbook.Worksheets.["Sheet1"];&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="kookaburracc" When="04/02/2014 02:00:33">
          <Html>
        &lt;div class="markDownOutput "&gt;In my case, the file name is too long. &lt;br&gt;
&lt;br&gt;
I change to "text.xlsx" then working&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="njensen" When="26/09/2014 13:13:12">
          <Html>
        &lt;div class="markDownOutput "&gt;Did anyone solve this issue ? &lt;br&gt;
&lt;br&gt;
I have some .xlsx files which are working and some which are not. They all look ok.
&lt;br&gt;
&lt;br&gt;
LAST LINE FAILS ------------------------------------------------------------------------
&lt;br&gt;
&lt;br&gt;
using (ExcelPackage xlPackage = new ExcelPackage(fi))&lt;br&gt;
&lt;pre&gt;&lt;code&gt;{
    // get the first worksheet in the workbook
    ExcelWorksheet worksheet = xlPackage.Workbook.Worksheets[1];
&lt;/code&gt;&lt;/pre&gt;
EXCEPTION ----------------------------------------------------------------------------
&lt;br&gt;
&lt;br&gt;
An unhandled exception of type 'System.NullReferenceException' occurred in EPPlus.dll&lt;br&gt;
&lt;h2&gt;Additional information: Object reference not set to an instance of an object.
&lt;/h2&gt;
However if i open the failing file, and press save, it's working next time ! &lt;br&gt;
&lt;br&gt;
any suggestions ?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="njensen" When="26/09/2014 14:00:01">
          <Html>
        &lt;div class="markDownOutput "&gt;Updated to version 4.0.0.1 and initial testing seems to show the problem has disappeared&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Copying of an excel worksheet (having formula) to another workbook sheet with only value">
      <Posts>
        <Post From="hasham" When="23/09/2014 13:06:16">
          <Html>
        &lt;div class="markDownOutput "&gt;I have a scenario where I need to copy an excel worksheet having calculated value(means formula on the respective cell) to another worksheet of different workbook. My Issue is that
&lt;em&gt;is their anyway to copy only the value (not formula)of sheet without formula&lt;/em&gt; .Currently formula is also coming.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="EPPlus 3.11 &amp;amp; InsertRow()">
      <Posts>
        <Post From="evgnib123" When="18/09/2014 12:36:34">
          <Html>
        &lt;div class="markDownOutput "&gt;Help, I observe the following problem &lt;br&gt;
Trying to copy a table row using: &lt;br&gt;
&lt;pre&gt;&lt;code&gt;public void InsertRow(int rowFrom, int rows, int copyStylesFromRow);&lt;/code&gt;&lt;/pre&gt;
It contains merged cells. &lt;br&gt;
After copying, the new lines are unmerged cell. &lt;br&gt;
&lt;br&gt;
So it should be?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="evgnib123" When="19/09/2014 09:25:02">
          <Html>
        &lt;div class="markDownOutput "&gt;It seems that the problem is known &lt;br&gt;
&lt;br&gt;
&lt;a href="https://epplus.codeplex.com/workitem/13141" rel="nofollow"&gt;https://epplus.codeplex.com/workitem/13141&lt;/a&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="EPPlus 4.0 Beta error for string formula =&quot;Hello&quot;">
      <Posts>
        <Post From="rm1" When="18/09/2014 05:29:31">
          <Html>
        &lt;div class="markDownOutput "&gt;The output of below code is #VALUE!. Am i missing something? &lt;br&gt;
&lt;br&gt;
string path = System.Reflection.Assembly.GetExecutingAssembly().Location; &lt;br&gt;
var directory = Path.GetDirectoryName(path); &lt;br&gt;
string sourceFile = directory + "\Book1.xlsx"; &lt;br&gt;
string targetFile = directory + "\Test1 " + DateTime.Now.ToString("yyyyMMddhhmmss") + ".xlsx";
&lt;br&gt;
FileInfo sourceFileInfo = new FileInfo(sourceFile); &lt;br&gt;
FileInfo targetFileInfo = new FileInfo(targetFile); &lt;br&gt;
OfficeOpenXml.ExcelPackage package = new ExcelPackage(targetFileInfo, sourceFileInfo);
&lt;br&gt;
ExcelWorkbook book = package.Workbook; &lt;br&gt;
ExcelWorksheet sheet = book.Worksheets["Sheet1"]; &lt;br&gt;
//sheet.Cells["B4"].Formula = "IFERROR(1000/2,0)"; &lt;br&gt;
sheet.Cells["B4"].Formula = "\"Hello\""; &lt;br&gt;
sheet.Cells["B4"].Calculate(); &lt;br&gt;
object value = sheet.Cells["B4"].Value; &lt;br&gt;
sheet.Cells["B5"].Value = value + " World"; &lt;br&gt;
book.Calculate(); &lt;br&gt;
package.Save();&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Shav" When="18/09/2014 12:02:42">
          <Html>
        &lt;div class="markDownOutput "&gt;Hey rm1, I haven't tried all of this in code but if you're just assigning a string to cell B4, then all you should need to do is sheet.Cells["B4"].Value = "Hello"; There should be no need for sheet.Cells["B4"].Calculate();
 either because you're not calculating any Excel formula. &lt;br&gt;
&lt;br&gt;
For your variable value, you would need&lt;br&gt;
string value = sheet.Cells["B4"].Value.ToString();&lt;br&gt;
&lt;br&gt;
then sheet.Cells["B5"].Value = value + " World"; should work.
&lt;br&gt;
&lt;br&gt;
Also, no need for your final book.Calculate(); because you don't have any Excel formulas above so nothing to calculuate. .Calculate only need to work out an actual Excel formula.
&lt;br&gt;
&lt;br&gt;
Cheers&lt;br&gt;
Shav&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Regarding Deleting of row between certain range in Epplus">
      <Posts>
        <Post From="hasham" When="17/09/2014 11:18:31">
          <Html>
        &lt;div class="markDownOutput "&gt;I have a scenario in that I have to delete only those row between certain range which is empty using epplus
&lt;br&gt;
ws.DeleteRow(start row,Del row) &lt;br&gt;
but it is deleting entire row of the range but I want to delete only rows which is empty of this range.
&lt;br&gt;
If I am using closedxml we can directly use ws.Rows(row_cnt, row_end).Delete() but as it is epplus,it is not going 2 work here.
&lt;br&gt;
Any help is appreciatable&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Not Properly Disposing?">
      <Posts>
        <Post From="IronMan84" When="15/09/2014 20:53:18">
          <Html>
        &lt;div class="markDownOutput "&gt;I recently upgraded some export code that I'd done not that long ago to using the 4.0 Beta, so that I could try it out. When I did run it (with code that had worked
&lt;em&gt;perfectly&lt;/em&gt; with the regular version) it spat out an Excel file of size 0KB, and which, when I opened it up, said that the file was either in the wrong format or unreadable.
&lt;br&gt;
&lt;br&gt;
After poking and prodding it for a while I finally figured out what was wrong. I had done the following for my export:
&lt;br&gt;
&lt;pre&gt;&lt;code&gt;using (var db = new DbContext())
{
  using (var package = new ExcelPackage(stream))
  {
     //Some export of data found in the Context
  }
}&lt;/code&gt;&lt;/pre&gt;
But when I split out all of the DB calls into its own using, ala:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;using (var db = new DbContext())
{
  //all my needed db calls
}

using (var package = new ExcelPackage(stream))
{
   //Some export of data found in the Context
}
&lt;/code&gt;&lt;/pre&gt;
Then it started working again. Has anyone else encountered this in the Beta? Does anyone fully know why this happened? Is it just not able to fully dispose the ExcelPackage when it's in another using statement anymore?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to set the color of column chart.">
      <Posts>
        <Post From="CharlotW" When="15/09/2014 17:20:53">
          <Html>
        &lt;div class="markDownOutput "&gt;thanks to this thread: &lt;a href="https://epplus.codeplex.com/discussions/287917" rel="nofollow"&gt;
https://epplus.codeplex.com/discussions/287917&lt;/a&gt; &lt;br&gt;
i can set the color of the line chart:) &lt;br&gt;
and there are 2 column charts i want to change the default color of them, &lt;br&gt;
Is there any to do this? &lt;br&gt;
&lt;br&gt;
Thanks in advance!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Conditional formatting AddBetween doesnt work correctly.">
      <Posts>
        <Post From="valvedev" When="11/09/2014 23:33:16">
          <Html>
        &lt;div class="markDownOutput "&gt;first of all, this thing is freaking amazing... i've been through a lot of excel libraries but this is by far the most powerful.
&lt;br&gt;
&lt;br&gt;
I manually applied a Between filter on a conditional formatting and inspected it with Open Xml Productivity Tool. This is what it shows:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;        ConditionalFormatting conditionalFormatting2 = new ConditionalFormatting(){ SequenceOfReferences = new ListValue&amp;lt;StringValue&amp;gt;() { InnerText = "G1:G1048576" } };

        ConditionalFormattingRule conditionalFormattingRule3 = new ConditionalFormattingRule(){ Type = ConditionalFormatValues.CellIs, FormatId = (UInt32Value)2U, Priority = 1, Operator = ConditionalFormattingOperatorValues.Between };
        Formula formula3 = new Formula();
        formula3.Text = "120";
        Formula formula4 = new Formula();
        formula4.Text = "149";
&lt;/code&gt;&lt;/pre&gt;
as you can see here, the formula is actually 2 parts... when i apply the formula with the api it only applies the low end... any ideas on how to fix this? for now i just have multiple criteria @ different priorities to do what I want but I thought I'd point
 it out... even in the sample if you look at the conditional formatting in excel afterwards it shows between &amp;lt;formula&amp;gt; and &amp;lt;blank&amp;gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="multiple FreezePanes">
      <Posts>
        <Post From="JenniferNWard52" When="13/02/2013 14:59:09">
          <Html>
        &lt;div class="markDownOutput "&gt;I need to set two FreezePanes statements. I need the first three rows frozen so I write ws.View.FreezePanes(4, 8);. But I also need just the first column frozen with an unknown amount of rows (I'm using r) so I write ws.View.FreezePanes(r, 2);.
&lt;br&gt;
&lt;br&gt;
When I use either or, they work correctly. However, when I use both statements together, whichever is the last one seems to 'override' the other. So if I write:
&lt;br&gt;
&lt;br&gt;
ws.View.FreezePanes(4, 8); &lt;br&gt;
ws.View.FreezePanes(r, 2); &lt;br&gt;
&lt;br&gt;
my spreadsheet results in the first column being frozen, yet I cannot even scroll up and down through the rows.
&lt;br&gt;
&lt;br&gt;
If I write: &lt;br&gt;
&lt;br&gt;
ws.View.FreezePanes(r, 2); &lt;br&gt;
ws.View.FreezePanes(4, 8); &lt;br&gt;
&lt;br&gt;
my spreadsheet results in the top three rows being frozen, but when I scroll right to left, the first column is not frozen.&lt;br&gt;
&lt;br&gt;
How can I set multiple FreezePanes?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="vishalgoyal2470" When="11/09/2014 07:03:13">
          <Html>
        &lt;div class="markDownOutput "&gt;ws.View.FreezePanes(4, 2) will freeze top 3 rows and 1st column.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to set PaperSize to A0 or custom size?">
      <Posts>
        <Post From="scda0001" When="10/09/2014 13:28:11">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
I needed to set the worksheet paper size to A0. How can I do this with EPPlus? &lt;br&gt;
Enumeration ePaperSize is missing A0 !?&lt;br&gt;
&lt;pre&gt;&lt;code&gt; ws.PrinterSettings.PaperSize = ePaperSize.A0;
&lt;/code&gt;&lt;/pre&gt;
Regards, &lt;br&gt;
Daniel&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Changing the worksheets order.">
      <Posts>
        <Post From="rbelknap" When="10/09/2014 02:46:04">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi.. &lt;br&gt;
&lt;br&gt;
I am trying to hide the first Worksheet in a workbook. This does not appear to work.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;package.Workbook.Worksheets["Raw Hardware"].Hidden = OfficeOpenXml.eWorkSheetHidden.Hidden;&lt;/code&gt;&lt;/pre&gt;
This table contains the "raw" data from which the following worksheets are created. I would like to be able to leave the worksheet in the workbook for audit purposes.
&lt;br&gt;
&lt;br&gt;
Is there a way to change the order so that the worksheet I am attempting to hide will be able to be hidden?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="rbelknap" When="10/09/2014 03:07:00">
          <Html>
        &lt;div class="markDownOutput "&gt;Ok... so I figured out a workaround... not elegant, but it works.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;                    var rawHardware = package.Workbook.Worksheets["Raw Hardware"];
                    package.Workbook.Worksheets.Add("RawHardware", rawHardware);
                    package.Workbook.Worksheets.Delete("Raw Hardware");
                    package.Workbook.Worksheets["RawHardware"].Name = "Raw Hardware";&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="10/09/2014 12:21:17">
          <Html>
        &lt;div class="markDownOutput "&gt;Strange, I didn't try EPPlus 4.x but I'm using this feature in some projects with 3.x and works fine. Do you open generated files with Excel or another compatible app ?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Is it possible to get and MODIFY PageFieldSettings?">
      <Posts>
        <Post From="Huk" When="05/09/2014 08:54:38">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello. &lt;br&gt;
&lt;br&gt;
I have a xlsx file with pivotal tables. Some tables have filters (page fields), I need to find all the filters and if they match with the one passed to method - change the settings, for example: I have page field “CompanyId” and if I call my method like:
&lt;br&gt;
&lt;br&gt;
void ChangeFilter(“CompanyId”,100); &lt;br&gt;
&lt;br&gt;
I would expect that filter selects 100 &lt;br&gt;
&lt;br&gt;
I’m trying EPPlus (4.0 beta - the stable version didn’t want to open my xlsx), and while I can find find the table filters, I can’t change the PageFieldSettings since it’s read only... is there any other way to manipulate filters, or is it simply not supported
 feature? &lt;br&gt;
&lt;br&gt;
Thanks in advance. &lt;br&gt;
&lt;br&gt;
Best regards.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="NULL values are not considering as empty cells">
      <Posts>
        <Post From="chumsat" When="03/09/2014 16:15:40">
          <Html>
        &lt;div class="markDownOutput "&gt;When we use LOADFROMDATATABLE method to export the datatable into excel file, if the datatable has NULL value in it the excel file shows empty cells. But when we select only those empty cells, it is showing the count at the bottom.
&lt;br&gt;
&lt;br&gt;
Normally in the excel file, if we select the empty cells it wont show the count at the bottom.
&lt;br&gt;
&lt;br&gt;
Appreciate if anyone could help me on this issue. &lt;br&gt;
&lt;br&gt;
Thanks in Advance. &lt;br&gt;
&lt;br&gt;
Sathish Selva&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="03/09/2014 16:23:27">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
Please take a look at this thread &lt;a href="http://epplus.codeplex.com/discussions/393289" rel="nofollow"&gt;
http://epplus.codeplex.com/discussions/393289&lt;/a&gt; &lt;br&gt;
&lt;br&gt;
Regards &lt;br&gt;
Thiago&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="chumsat" When="04/09/2014 09:21:47">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi Thiago, &lt;br&gt;
&lt;br&gt;
Is it possible to have an updated DLL with the changes which was mentioned on this thread
&lt;a href="http://epplus.codeplex.com/discussions/393289" rel="nofollow"&gt;http://epplus.codeplex.com/discussions/393289&lt;/a&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Appreciate your help. &lt;br&gt;
&lt;br&gt;
Thanks in Advance. &lt;br&gt;
&lt;br&gt;
Sathish Selva&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="chumsat" When="04/09/2014 09:47:43">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi Thiago, &lt;br&gt;
&lt;br&gt;
Thanks for your answer. I was able to change the code and got the updated DLL. &lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Thanks a lot. &lt;br&gt;
&lt;br&gt;
Sathish Selva&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="chumsat" When="04/09/2014 10:20:15">
          <Html>
        &lt;div class="markDownOutput "&gt;I have changed the code in this way to make it working.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;foreach (DataRow dr in Table.Rows)
{
      foreach (object value in dr.ItemArray)
     {                                  
          if (value != null &amp;amp;&amp;amp; value.ToString() != string.Empty)
          {
             _worksheet._values.SetValue(row, col++, value);
          }
          else
          {
             col++;
          }
      }
      row++;
      col = _fromCol;
 }&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="MVC 5 Epplus Excel Found Unreadable Content">
      <Posts>
        <Post From="captaincoder" When="03/09/2014 12:46:42">
          <Html>
        &lt;div class="markDownOutput "&gt;I am trying to write some information to an excel file. I can write in it with using EPPlus. And download the excel file. But when I run and the download this file I see this error.&lt;br&gt;
&lt;br&gt;
"Excel found unreadable content in filename.xls. Do you want to recover the contents of this workbook? If you trust the source of this workbook, click Yes."&lt;br&gt;
&lt;br&gt;
Even if I did not write anything to file, I get this error. My code in Excel class is:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;using MaasRaporlari.Models;
using OfficeOpenXml;
using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Text;
using System.Web;

namespace MaasRaporlari.Controllers
{
    class AyrintiliHarcamaRapor
    {
        public List&amp;lt;AyrintiliHarcamaProgramiVM2&amp;gt; Ayrintili;

        private static int RaporaEklenebilecekIcerikSayısı = 33;

        public string ExcelTemplatePath { get; set; } 
        public string ExcelResultPath { get; set; }
        public FileStream Save()
        {
            try
            {
                ExcelTemplatePath = HttpContext.Current.Server.MapPath("~/Images/AyrintiliHarcamaProgrami.xlsx");
                ExcelResultPath = HttpContext.Current.Server.MapPath("~/Images/Harcama.xls");
                var File = new FileInfo(ExcelTemplatePath);
                using (ExcelPackage package = new ExcelPackage(File))
                {
                    package.Load(new FileStream(ExcelTemplatePath, FileMode.Open));
                    int sheetCount = (int)Math.Ceiling((double)Ayrintili.Count / RaporaEklenebilecekIcerikSayısı);
                    ExcelWorksheet workSheet = package.Workbook.Worksheets["Sheet1"];
                    List&amp;lt;ExcelWorksheet&amp;gt; workSheets = new List&amp;lt;ExcelWorksheet&amp;gt;();
                    workSheets.Add(workSheet);
                    package.Stream.Position = 0;
                    if (sheetCount &amp;gt;= 2)
                    {
                        for (int i = 0; i &amp;lt; sheetCount - 1; i++)
                        {
                            ExcelWorksheet tempSheet = package.Workbook.Worksheets.Add(string.Format("Sheet{0}", i + 2), workSheet);
                            workSheets.Add(tempSheet);
                        }
                    }

                    int icerikSayac = 0;
                    foreach (ExcelWorksheet workSheetItem in workSheets)
                    {
                        package.Stream.Position = 0;
                        decimal MiktarToplam1 = 0;
                        decimal MiktarToplam2 = 0;
                        decimal MiktarToplam3 = 0;
                        decimal MiktarToplam4 = 0;
                        decimal MiktarToplam5 = 0;
                        decimal OranToplam1 = 0;
                        decimal OranToplam2 = 0;
                        decimal OranToplam3 = 0;
                        decimal OranToplam4 = 0;
                        decimal OranToplam5 = 0;

                        MiktarToplam Toplam = new MiktarToplam();

                        int rowPointer = 10;

                        for (int i = 0; i &amp;lt; RaporaEklenebilecekIcerikSayısı; i++)
                        {
                            if (icerikSayac &amp;lt; Ayrintili.Count)
                            {
                                var item = Ayrintili[icerikSayac];

                                package.Stream.Position = 0;

                                MiktarToplam5 = item.Miktar1 + item.Miktar2 + item.Miktar3 + item.Miktar4;
                                OranToplam5 = item.Oran1 + item.Oran2 + item.Oran3 + item.Oran4;

                                MiktarToplam1 += item.Miktar1;
                                MiktarToplam2 += item.Miktar2;
                                MiktarToplam3 += item.Miktar3;
                                MiktarToplam4 += item.Miktar4;

                                OranToplam1 += item.Oran1;
                                OranToplam2 += item.Oran2;
                                OranToplam3 += item.Oran3;
                                OranToplam4 += item.Oran4;


                                workSheetItem.Cells["A" + rowPointer.ToString()].Value = item.One;
                                workSheetItem.Cells["B" + rowPointer.ToString()].Value = item.Two;
                                workSheetItem.Cells["C" + rowPointer.ToString()].Value = item.Aciklama;
                                workSheetItem.Cells["D" + rowPointer.ToString()].Value = item.Miktar1;
                                workSheetItem.Cells["F" + rowPointer.ToString()].Value = item.Miktar2;
                                workSheetItem.Cells["H" + rowPointer.ToString()].Value = item.Miktar3;
                                workSheetItem.Cells["J" + rowPointer.ToString()].Value = item.Miktar4;
                                workSheetItem.Cells["E" + rowPointer.ToString()].Value = item.Oran1;
                                workSheetItem.Cells["G" + rowPointer.ToString()].Value = item.Oran2;
                                workSheetItem.Cells["I" + rowPointer.ToString()].Value = item.Oran3;
                                workSheetItem.Cells["K" + rowPointer.ToString()].Value = item.Oran4;
                                workSheetItem.Cells["AC" + rowPointer.ToString()].Value = MiktarToplam5;
                                workSheetItem.Cells["AD" + rowPointer.ToString()].Value = OranToplam5;

                                rowPointer++;
                                icerikSayac++;

                            }
                        }


                        workSheetItem.Cells["D33"].Value = MiktarToplam1;
                        workSheetItem.Cells["E33"].Value = OranToplam1;
                        workSheetItem.Cells["F33"].Value = MiktarToplam2;
                        workSheetItem.Cells["G33"].Value = OranToplam2;
                        workSheetItem.Cells["H33"].Value = MiktarToplam3;
                        workSheetItem.Cells["I33"].Value = OranToplam3;
                        workSheetItem.Cells["J33"].Value = MiktarToplam4;
                        workSheetItem.Cells["K33"].Value = OranToplam4;

                    }
                    using (FileStream outStream = new FileStream(ExcelResultPath, FileMode.OpenOrCreate, FileAccess.ReadWrite))
                    {
                        package.Stream.Position = 0;

                        package.SaveAs(outStream);
                        outStream.Position = 0;
                        package.Stream.Dispose();


                        return (outStream);
                    }

                }

            }


            catch (Exception)
            {
                throw;

            }
        }
        public class MiktarToplam
        {
            public decimal Toplam { get; set; }

            public MiktarToplam()
            {
                Toplam = 0;

            }
        }
    }
}&lt;/code&gt;&lt;/pre&gt;
```&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="03/09/2014 16:27:30">
          <Html>
        &lt;div class="markDownOutput "&gt;I never had any issues with mvc, only with webforms, but give a try...take a look at this thread
&lt;br&gt;
&lt;br&gt;
&lt;a href="https://epplus.codeplex.com/discussions/223843" rel="nofollow"&gt;https://epplus.codeplex.com/discussions/223843&lt;/a&gt;
&lt;br&gt;
&lt;br&gt;
Regards, &lt;br&gt;
Thiago&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="captaincoder" When="03/09/2014 18:44:04">
          <Html>
        &lt;div class="markDownOutput "&gt;thanks but I have already seen it. And it could not help me&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="EPPlus loses row height">
      <Posts>
        <Post From="parudisa" When="02/09/2014 15:47:43">
          <Html>
        &lt;div class="markDownOutput "&gt;
&lt;blockquote&gt;I have to use an existing excel and place contents on specific cells and give it to user through ASP.Net MVC site. The original excel should not be changed, so that it can be used as a template. The issue is though functionally everything works
 with EPPlus, the row heights of the original excel is completely lost in the resulting excel.&lt;br&gt;
&lt;/blockquote&gt;
&lt;pre&gt;&lt;code&gt;using (ExcelPackage package = new ExcelPackage(new FileInfo(NewFile), new FileInfo(Template)))
         {
            ExcelWorksheet excelSheet = package.Workbook.Worksheets[1];
            //Do all process, mainly set specific cell values
            package.Save();
         }
         //Return the new file to user&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="EPPlus Excel Chek box value">
      <Posts>
        <Post From="parudisa" When="02/09/2014 15:46:24">
          <Html>
        &lt;div class="markDownOutput "&gt;Can we change the value of a check box in an excel thru EPPlus? I used true/false to linked cell but that is not showing checked state when user downloads the excel file, though the linked cell value is true. Once user clicks enable editing for the warning(warning
 saying it is from internet), the check box correctly changes to checked state. &lt;br&gt;
&lt;br&gt;
Any ideas/help?????&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Open saved files with Excel 2007">
      <Posts>
        <Post From="b2e" When="02/09/2014 10:56:47">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello, &lt;br&gt;
&lt;br&gt;
i am using the library to open a template, modify its content and save it. &lt;br&gt;
&lt;br&gt;
It is working fine with Excel 2010. When i try to open the generated file with Excel 2007 it shows a read error message.
&lt;br&gt;
&lt;br&gt;
Is it possible to generate a file compatible with Office 2010 and 2007 ? &lt;br&gt;
&lt;br&gt;
Thanks&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="HOW TO CHANGE DEFAULT COLORS OF THE PIE CHART in EXCEL Programmatically using EPPLUS">
      <Posts>
        <Post From="vspraveenkumar" When="01/09/2014 12:03:17">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello All &lt;br&gt;
&lt;br&gt;
&lt;a href="https://drive.google.com/file/d/0B9ZoPCV6nHyyMjAwS09BNzRtN1E/edit?usp=sharing" rel="nofollow"&gt;CLICK_TO_SEE_THE_EXCEL_PIE_CHART_IMAGE&lt;/a&gt;
&lt;br&gt;
&lt;br&gt;
below is my code &lt;br&gt;
&lt;br&gt;
var pieChart = worksheet.Drawings.AddChart("piechart", eChartType.Pie3D) as ExcelPieChart;&lt;br&gt;
&lt;pre&gt;&lt;code&gt;            //Set top left corner to row 1 column 2
            pieChart.SetPosition(18, 0, 0, 0);
            pieChart.SetSize(350, 300);
            pieChart.Series.Add(ExcelRange.GetAddress(12, 2, 15, 2),ExcelRange.GetAddress(12, 1, 15, 1) );
            pieChart.Legend.Position = eLegendPosition.Bottom;
            pieChart.Legend.Border.Fill.Color = Color.Green;
            pieChart.Legend.Border.LineStyle = eLineStyle.Solid;              
            pieChart.Legend.Border.Fill.Style = eFillStyle.SolidFill;
            pieChart.Title.Text = "Current Status";               
            pieChart.DataLabel.ShowCategory = false;
            pieChart.DataLabel.ShowPercent = true;
&lt;/code&gt;&lt;/pre&gt;
I want to change the default colors to the colors shown in the left side of image.
&lt;br&gt;
&lt;br&gt;
Suggest me some code, throw light on this. &lt;br&gt;
&lt;br&gt;
Thanks in advance.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="System.InvalidOperationException: &quot;A worksheet with this name already exists in the workbook&quot;">
      <Posts>
        <Post From="Kasjan" When="01/09/2014 08:22:00">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello,&lt;br&gt;
&lt;br&gt;
i really love this package. The performance is really amazing. But unfortunately i have a horrible problem. I'm using EPPlus to create around 10-30 xlsx-files each time in my program. After 8-10 iterations the export algorithm throws an exception, saying that
 the worksheet already exists in the workbook when im adding a new one. The wicked thing is, that this can't be, cause every time i export a file, the ExcelPackage should be disposed since i use the "using" statement.&lt;br&gt;
This is how my export looks like:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;using (ExcelPackage pck = new ExcelPackage(newFile))
{
   for (int i = 0; i &amp;lt; ListSheetNames.Count; i++)
   {
       ExcelWorksheet Sheet = pck.Workbook.Worksheets.Add(ListSheetNames[i]);
       // Filling Sheet from DataTable
   }
}&lt;/code&gt;&lt;/pre&gt;
Even if i delete the sheets manually after saving the ExcelPackage the bug still exists:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;while (pck.Workbook.Worksheets.Count &amp;gt; 0) { pck.Workbook.Worksheets.Delete(1); }&lt;/code&gt;&lt;/pre&gt;
Anyone with an idea? The export-method is static, is that the reason maybe?&lt;br&gt;
I tried to reproduce this problem with the sample projects, creating 20-30 times the same sample-project but the error won't occure. :(&lt;br&gt;
&lt;br&gt;
The only workaround for now is to check the workbook for a existing sheet, delete it, and re add it. But thats pretty stupid, cause the workbook should be empty...&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Share Workbook function">
      <Posts>
        <Post From="RevitArkitek" When="27/08/2014 15:27:59">
          <Html>
        &lt;div class="markDownOutput "&gt;I'm trying to enable the option "Allow changes by more than one user at the same time. This also allows workbook merging." in the Share Workbook settings. I cannot find any method in the EPPlus library or discussion on this site related to this.
 Can anyone help? Is it possible? Thanks.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to insert to cell by array">
      <Posts>
        <Post From="xuexue87" When="20/08/2013 11:57:42">
          <Html>
        &lt;div class="markDownOutput "&gt;Dear All, &lt;br&gt;
&lt;br&gt;
I have created the excel where about 2000 row and 100 column. &lt;br&gt;
I set value by cell by cell. It take 10 minute to finish the excel. &lt;br&gt;
May i know is there any way I can set value to multiple cell using array. &lt;br&gt;
&lt;br&gt;
For example &lt;br&gt;
&lt;br&gt;
obj[] abc = new obj[]{ "1", "2", "3", "4"};
&lt;br&gt;
ws.Cells["A1:D1"].Value = abc; &lt;br&gt;
&lt;br&gt;
Regards, &lt;br&gt;
Nicholas&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Kasjan" When="26/08/2014 15:50:24">
          <Html>
        &lt;div class="markDownOutput "&gt;+1 for this request. I didnt like to create excel-files with COM at all, but assigning an array to a range was pretty sweet ;)&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Compilation Error with .Calculate Method">
      <Posts>
        <Post From="Shav" When="26/08/2014 10:20:45">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi all, is there any way that I can see more specifics on compilation errors using Epplus. If I have a compilation failure, the only error message Visual Studio 2012 displays is
&lt;br&gt;
&lt;pre&gt;&lt;code&gt;An unhandled exception of type 'System.Windows.Markup.XamlParseException' occurred in PresentationFramework.dll

Additional information: 'The invocation of the constructor on type 'Sizer.MainWindow' that matches the specified binding constraints threw an exception.' Line number '3' and line position '9'.

If there is a handler for this exception, the program may be safely continued. &lt;/code&gt;&lt;/pre&gt;
It's not very informative so I end up having to step back through lines of code and comment them out individually so that I can try and find the source of the compilation. If I could see more information, it would help me identify the source of the problem
 quicker.&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
As a carry on from the above, I have identified the source of my compilation failure for my current issue. I'm using 4.0 Beta2 and trying to call the .Calculate method. To me the code seems ok but obviously something is up. Any help greatly appreciated.
&lt;br&gt;
&lt;pre&gt;&lt;code&gt;            count = 15;
            for (rowid = (siu_row + 1); rowid &amp;lt;= (siu_row + count); rowid++)
            {
                XLS_Modules.Cells[rowid, column_total].Formula = "SUM(" + XLS_Modules.Cells[rowid, column_smsc_mo].Address + ":" + XLS_Modules.Cells[rowid, column_total - 1].Address + ")";
                XLS_Modules.Cells[rowid, column_total].Style.Fill.BackgroundColor.SetColor(Color.Yellow);
                XLS_Modules.Cells[rowid, column_total].Style.Font.Bold = true;
            }
            XLS_Modules.Cells[rowid, column_total].Formula = "SUM(" + XLS_Modules.Cells[(siu_row + 1), column_total].Address + ":" + XLS_Modules.Cells[(rowid - 1), column_total].Address + ")";

            XLS_Modules.Cells[rowid, column_total].Calculate();
total_capacity_required = Convert.ToInt16(XLS_Modules.Cells[rowid, column_total].Value);&lt;/code&gt;&lt;/pre&gt;
If I comment out &lt;em&gt;XLS_Modules.Cells[rowid, column_total].Calculate();&lt;/em&gt; , then it compiles and works fine. I need to use the Calculate method as I want to assign the calculated value in the cell to total_capacity_required&lt;br&gt;
&lt;br&gt;
Any help greatly appreciated. &lt;br&gt;
Thanks&lt;br&gt;
Shav&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Shav" When="26/08/2014 12:54:01">
          <Html>
        &lt;div class="markDownOutput "&gt;I've been doing some more digging and the build seems to be fine. It's Debug that's outputting the message. Here's more info on why Calculate() is failing but not really pointing me in a direction that I can understand/fix.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;A first chance exception of type 'System.InvalidCastException' occurred in mscorlib.dll
An unhandled exception of type 'System.Windows.Markup.XamlParseException' occurred in PresentationFramework.dll
Additional information: 'The invocation of the constructor on type 'Sizer.MainWindow' that matches the specified binding constraints threw an exception.' Line number '3' and line position '9'.&lt;/code&gt;&lt;/pre&gt;
Thanks &lt;br&gt;
Shav&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Shav" When="26/08/2014 14:18:28">
          <Html>
        &lt;div class="markDownOutput "&gt;I'm some clown. Just spotted that issue is unrelated to this and was due to problem with another part of the code. Lesson learned to put better debugging output into my code. Thanks
&lt;br&gt;
Shav&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="PivotTable Column Fields formatting">
      <Posts>
        <Post From="ebucis" When="26/08/2014 03:28:59">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
I am required to format all the column fields changing the orientation to 90 degrees.
&lt;br&gt;
&lt;br&gt;
I hope the answer to any of these questions will help me to achieve my goal if there is no direct solution to my problem using the API.&lt;br&gt;
&lt;ol&gt;
&lt;li&gt;Is there a way to know what is the range of the values for each column field?
&lt;/li&gt;&lt;li&gt;Is there a way to know the range of the pivot table? With FirstDataCol and FirstDataRow I hope I can infere the ranges.&lt;br&gt;
&lt;/li&gt;&lt;/ol&gt;
Thanks a lot, &lt;br&gt;
L&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="VLOOKUP fails">
      <Posts>
        <Post From="PralayAhluwalia" When="25/08/2014 10:22:52">
          <Html>
        &lt;div class="markDownOutput "&gt;we are use the latest Beta 4.0 Beta 2 available and found that VLOOKUPs do not get fired.
&lt;br&gt;
&lt;br&gt;
Our use case requires us to change some cells in a predefined workbook and fire the calculation refresh. Users have defined VLOOKUPs which return a #VALUE. When we open the same workbook in Excel , the lookups successfully return values.&lt;br&gt;
&lt;br&gt;
Can some advise on workarounds or if there is an eminent release catering to this ?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Images in Worksheets">
      <Posts>
        <Post From="mcristales" When="22/08/2014 00:16:52">
          <Html>
        &lt;div class="markDownOutput "&gt;I need put some imagen in my Worksheets, but the problem is when the sheet end,, because the next images appear in the middle of the page i need put the next images in the top of the next sheet&lt;br&gt;
I have this..&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
var ws = wb.Workbook.Worksheets.Add("OrdenInspeccion");&lt;br&gt;
&lt;pre&gt;&lt;code&gt;        for (int i =0; i&amp;lt;10;i++)
        {
        Image logo =
            Image.FromFile(
                "C:\\Header-0.jpg");
        var picture = ws.Drawings.AddPicture(i.ToString(), logo);
        //position picture on desired column
            if(i%2==0)
            {
                 rango = i*210;
                picture.SetPosition(rango,1);
            }
            else
            { picture.SetPosition(rango,420); }


        //set picture size to fit inside the cell
        picture.SetSize(150, 150);
            currentRow ++;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Problem with Excel file">
      <Posts>
        <Post From="vasek007" When="21/08/2014 13:34:31">
          <Html>
        &lt;div class="markDownOutput "&gt;Thanks for this feature, but when I had used it a problem become. The excel, during opening the created file, says, that the created xlsx file is wrong. Then, after some prompts, excel is trying to correct the file, fortunately successfully. But I would
 need direct success :-/&lt;br&gt;
Don't you know, where the problem could be? Many thanks, datatable contains data in over 25 thousands db rows and cca 20 columns, but a small datatable causes the same result too :(&lt;br&gt;
My code is:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;    Dim a As New Class1
    Dim dt As New DataTable
    Dim da As New SqlDataAdapter
    dt = a.SelectTriviaDT(cs, "EXEC dbo.sp_VyberPlatnaIZO")

    Using pck As New ExcelPackage
        Dim ws As ExcelWorksheet
        ws = pck.Workbook.Worksheets.Add("Pokus")
        ws.Cells("A1").LoadFromDataTable(dt, True)
        Response.ContentType = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"
        Response.AddHeader("content-disposition", "attachment;  filename=ExcelDemo.xlsx")
        Response.BinaryWrite(pck.GetAsByteArray())
    End Using&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="21/08/2014 14:32:42">
          <Html>
        &lt;div class="markDownOutput "&gt;Please, take a look at this thread (&lt;a href="https://epplus.codeplex.com/discussions/223843" rel="nofollow"&gt;https://epplus.codeplex.com/discussions/223843&lt;/a&gt;), maybe is your problem too.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="vasek007" When="21/08/2014 15:11:00">
          <Html>
        &lt;div class="markDownOutput "&gt;Thanks a lot! It really works! Wow!!!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Getting started">
      <Posts>
        <Post From="AMSAndy" When="20/08/2014 14:57:12">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, I am trying to get started with EPPlus, but cannot find an example to get me started (I need vb and not c#)
&lt;br&gt;
&lt;br&gt;
I need to;&lt;br&gt;
&lt;ul&gt;
&lt;li&gt;Create a new xlsx file on the server &lt;/li&gt;&lt;li&gt;Populate it with a few values (e.g. from textbox entries) &lt;/li&gt;&lt;li&gt;Save the file&lt;br&gt;
&lt;/li&gt;&lt;/ul&gt;
I will need to add more functionality later, but I have seen examples for this on the web.
&lt;br&gt;
&lt;br&gt;
Can you please also let me know what I need to include in the Bin folder. &lt;br&gt;
&lt;br&gt;
Thanks &lt;br&gt;
&lt;br&gt;
Andy&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Does EPPlus uses COM Components?">
      <Posts>
        <Post From="EdwinRaj" When="20/08/2014 09:18:09">
          <Html>
        &lt;div class="markDownOutput "&gt;Since EPPLus is based on OOXML format, I believe it is possible to create excel spreadsheet using EPPlus without doing the COM interaction. Please let me know if my understanding is correct.
&lt;br&gt;
&lt;br&gt;
Many Thanks,&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="20/08/2014 13:00:53">
          <Html>
        &lt;div class="markDownOutput "&gt;Yes, you are right. EPPlus only needs .net framework.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="ExcelNamedRange missing RefersTo property">
      <Posts>
        <Post From="urscheler" When="11/08/2014 03:52:43">
          <Html>
        &lt;div class="markDownOutput "&gt;Excel allows to specify any Excel Formula as Named Range's RefersTo value, without having to set an actual range.
&lt;br&gt;
E.g. &lt;br&gt;
Name: OfficeFilter &lt;br&gt;
Refers To: =T("Toronto Office") &lt;br&gt;
&lt;br&gt;
How can I set this using EPPlus? &lt;br&gt;
&lt;br&gt;
worksheet.Names.Add seems to require a valid ExcelRangeBase which I don't have in my case.
&lt;br&gt;
&lt;br&gt;
Note: When reading such a defined name, then EPPlus set the Formula attribute with the RefersTo value.
&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="urscheler" When="18/08/2014 03:44:44">
          <Html>
        &lt;div class="markDownOutput "&gt;I was able to get it working by adding this function to ExcelNamedRangeCollection:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;    public ExcelNamedRange Add(string Name, string NameFormula)
    {
        ExcelNamedRange item;
        item = new ExcelNamedRange(Name, _wb, _ws, _dic.Count);
        item.NameFormula = NameFormula;

        AddName(Name, item);

        return item;
    }&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Copying Worksheet to new Workbook in &quot;Calculated&quot; State">
      <Posts>
        <Post From="pimbrouwers" When="15/08/2014 23:13:23">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi everyone, &lt;br&gt;
&lt;br&gt;
First, thanks to the EEPlus team for putting this awesome package together. It's a treat to use. So kudos.
&lt;br&gt;
&lt;br&gt;
On to my question. I'm using the new Beta 4.0, which allows me to utilize the new "Calculate()" function. The end goal of my task is to copy a sheet from a workbook to a new workbook. But only the calculated cell values. The sheets I'm copying contain
 only cell references and formulas, which will not be making the trip to the new workbook. Thus, after copying I'm left with a ton of invalid references.
&lt;br&gt;
&lt;br&gt;
Ultimately, if there isn't a way to do this in bulk, I suppose I can call "Calculate()" and copy the data cell by cell. But the sheets to be copied contain graphs (based on the data) and ultimately I'd like to preserve them in "as-is" state
 (minus the formulas/references). &lt;br&gt;
&lt;br&gt;
Thank you everyone for your help. &lt;br&gt;
&lt;br&gt;
Peace and love. &lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="cells without worksheet">
      <Posts>
        <Post From="fade123" When="15/08/2014 16:11:14">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi all , &lt;br&gt;
&lt;br&gt;
I need some help how can i build an object that contanis the defenestion of cells without worksheet?
&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Change XAxis Type in Line Chart">
      <Posts>
        <Post From="AllenLin" When="15/08/2014 03:05:48">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi all,&lt;br&gt;
&lt;pre&gt;&lt;code&gt;I have a question, when i generate a line chart with date and value, the XAxis will be a date format, but i don't like it, i need a text format to show more clearly!! Who can tell me how to change it in EPPlus ? Or give me some pointers?. Excel setting as follows:
&lt;/code&gt;&lt;/pre&gt;
&lt;img alt="Image" src="http://b.hiphotos.baidu.com/image/pic/item/0ff41bd5ad6eddc4881f7adf3adbb6fd5266331e.jpg"&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Why does LoadFromCollection remove Underscores from the column names?">
      <Posts>
        <Post From="aesalazar" When="12/08/2014 16:17:10">
          <Html>
        &lt;div class="markDownOutput "&gt;I am using 3.1 in .net 4. Great API. &lt;br&gt;
&lt;br&gt;
I noticed that if I have LoadFromCollection set to insert the column headers it is hard-coded to remove underscores. So I thought I would tell it not to do that and I would add them myself to the first row.
&lt;br&gt;
&lt;br&gt;
When I do that, it does not properly get the field names - it just says "ColumnX" where is a sequential number.
&lt;br&gt;
&lt;br&gt;
In excel, as far as I know, there is nothing wrong with have underscores in a pivot table data source. What is causing the problem here?
&lt;br&gt;
&lt;br&gt;
Thanks &lt;br&gt;
Ernie&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Xenolith" When="14/08/2014 10:45:53">
          <Html>
        &lt;div class="markDownOutput "&gt;I also noticed this behavior in EPPlus 4.0 Beta 2. &lt;br&gt;
&lt;br&gt;
I wanted to &lt;em&gt;delete&lt;/em&gt; all columns which start with "ID_" but I only managed to
&lt;em&gt;hide&lt;/em&gt; all columns which starts with "ID " &lt;br&gt;
&lt;br&gt;
Great API so far, but I would love to see a delete method.&lt;br&gt;
&lt;pre&gt;&lt;code&gt; worksheet.Column(i).Delete();&lt;/code&gt;&lt;/pre&gt;
Greetings from Germany &lt;br&gt;
Xenolith&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Excel 2 DataGrid">
      <Posts>
        <Post From="a44281071" When="14/08/2014 03:06:00">
          <Html>
        &lt;div class="markDownOutput "&gt;Well, I just wan't to know how to Load the xls file and convert to a DataGrid
&lt;br&gt;
&lt;br&gt;
row 1 is the DataGrid's Title&lt;br&gt;
&lt;h1&gt;Excel file template:&lt;/h1&gt;
Name Age … &lt;br&gt;
Jack 13 &lt;br&gt;
&lt;h1&gt;Tom 17 &lt;/h1&gt;
EPPlusSamples 9 : &lt;br&gt;
from cell in sheet.Cells[sheet.Dimension.Address] &lt;br&gt;
I have found a problem: &lt;br&gt;
if Tom's “Age" Cell, it's value is NULL，I will not got the Cell&lt;br&gt;
&lt;h1&gt;how is it that?&lt;/h1&gt;
Sorry my bad Eng... &lt;br&gt;
Looking forward to your reply...Thanks a lot&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Line chart lines are invisible?">
      <Posts>
        <Post From="CaffeinePowered" When="13/08/2014 22:20:44">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello! I'm trying to create a line chart using EPPlus Beta 4.0 (I've also tried 3.1) and having a bit of trouble. For some reason the lines of the line chart end up invisible. Any idea what's going on? Here's my code:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;ExcelLineChart ec = worksheet.Drawings.AddChart("Line Time Graph", OfficeOpenXml.Drawing.Chart.eChartType.Line) as ExcelLineChart;
            ec.Title.Text = "Monthly Data";
            ec.SetPosition(1, 0, 4, 0);
            ec.SetSize(800, 600);

            ec.DisplayBlanksAs = eDisplayBlanksAs.Span;

            ExcelChartSerie s1 = ec.Series.Add("B7:B18", "A7:A18");&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Very Specific: Need to delete certain indexes of a Excel Chart legend">
      <Posts>
        <Post From="markhalonen" When="11/08/2014 22:37:44">
          <Html>
        &lt;div class="markDownOutput "&gt;My goal is to have 3 series with the same color on a graph, and only represented by one legend item. When creating a chart with EPPlus, the legend makes an item for each series, obviously.
&lt;br&gt;
I've done some editing and recompiling to the EPPplus DLL, but I'm not an expert.
&lt;br&gt;
First, I made two excel files. The only difference between the two was that i deleted a legend item. I found that in the chart XML file, it added:&lt;br&gt;
&lt;br&gt;
-&amp;lt;c:legendEntry&amp;gt;&lt;br&gt;
&lt;br&gt;
&amp;lt;c:idx val="0"/&amp;gt;&lt;br&gt;
&lt;br&gt;
&amp;lt;c:delete val="1"/&amp;gt;&lt;br&gt;
&lt;br&gt;
&amp;lt;/c:legendEntry&amp;gt;&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
To the Legend XML area/node thing. I was able to replicate this exactly with a method inside EPPlus:&lt;br&gt;
&lt;br&gt;
TopNode = _chart.ChartXml.SelectSingleNode("c:chartSpace/c:chart/c:legend", NameSpaceManager);&lt;br&gt;
&lt;pre&gt;&lt;code&gt;        string firstpart = "&amp;lt;c:legendPos val=\"r\"/&amp;gt;" ;
        string addedString = "&amp;lt;c:legendEntry&amp;gt;&amp;lt;c:idx val = \"1\"/&amp;gt;&amp;lt;c:delete val = \"1\"/&amp;gt;&amp;lt;/c:legendEntry&amp;gt;";
        string lastPart = "&amp;lt;c:layout/&amp;gt;" + "&amp;lt;c:overlay val=\"0\"/&amp;gt;";





        TopNode.InnerXml = string.Format(firstpart + addedString + lastPart, 0, 0);
&lt;/code&gt;&lt;/pre&gt;
Upon inspection, the resulting XML indicates that the legend at the specified index is deleted (it looks identical to the legend item code specified above), but the Excel file shows otherwise. No legend item is deleted. I know the method is shitty, I'm just
 trying to get it to work once. &lt;br&gt;
&lt;br&gt;
Any other strategies I should try to figure out a method that can delete a legend item?
&lt;br&gt;
Thanks!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Appending Worksheets to Existing Excel file without loading it into the memory">
      <Posts>
        <Post From="Andrez" When="11/08/2014 07:54:12">
          <Html>
        &lt;div class="markDownOutput "&gt;I am working with huge excel files and basically what I want to do is to append worksheets to an existing files. As the size of the current excel file is around 60 mb I was wondering whether there is a way to append worksheets to it without loading the
 actual content in memory? &lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="11/08/2014 20:19:33">
          <Html>
        &lt;div class="markDownOutput "&gt;No, there is no partial read/write support in EPPlus.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="EPPLUS - Execute a VBA macro from runtime">
      <Posts>
        <Post From="manzaniw" When="02/08/2014 14:16:52">
          <Html>
        &lt;div class="markDownOutput "&gt;First of all, thanks so much for creating and maintaining a such a good tool. We got the assignment of re-engineering a set of reports that were developed by using MS Office Interop and VBA code. those reports are supposed to be executed on daily basis
 and taking around 4 hours to execute. Basically the idea is to get the daily average for 5000 KPIs from a real-time-database system. After a long research, i found EPPLUS and was able to reduce the execution time to almost 10 min. The problem i am facing now
 is that the Excel files has some VBA code that needs to be executed, migrating them .NET will take too much time, and i cannot find a way to execute the code from my EPPLUS Class and generate the PDF. Any help will be appreciated!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="06/08/2014 09:51:14">
          <Html>
        &lt;div class="markDownOutput "&gt;Sorry - it is not possible to execute VBA code via EPPlus.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title=".xlsx Created and Saved Using Template with EPPlus is Unreadable/Corrupt">
      <Posts>
        <Post From="zsmith" When="11/10/2013 18:45:55">
          <Html>
        &lt;div class="markDownOutput "&gt;
&lt;h1&gt;The Problem&lt;/h1&gt;
I Posted this on Stack Overflow earlier. Thought I'd try here as well. &lt;br&gt;
&lt;br&gt;
I'm trying to create a small program that uses an &lt;em&gt;Excel template&lt;/em&gt; to create an
&lt;em&gt;Excel document&lt;/em&gt; and then writes to several cells using &lt;a href="https://epplus.codeplex.com/" rel="nofollow"&gt;
&lt;em&gt;EPPlus&lt;/em&gt;&lt;/a&gt;. Unfortunately, the files appear to be corrupt no matter what I try.&lt;br&gt;
&lt;h2&gt;My code:&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using OfficeOpenXml;
using System.IO;

namespace ConsoleApplication9
{
    public sealed class ExcelSerialize
    {
        private readonly List&amp;lt;Tuple&amp;lt;string, string&amp;gt;&amp;gt; Results;
        private readonly string Directory;
        private ExcelPackage package;

        public ExcelSerialize(List&amp;lt;Tuple&amp;lt;string, string&amp;gt;&amp;gt; Results, string Directory)
        {
            this.Results = Results;
            this.Directory = Directory;
        }

        public bool WriteResults()
        {
            FileInfo template = new FileInfo(Directory);

            using (package = new ExcelPackage(template, true))
            {
                ExcelWorksheet worksheet = package.Workbook.Worksheets[1];

                //foreach (Tuple&amp;lt;string, string&amp;gt; Result in Results)
                //{
                //    worksheet.Cells[Result.Item1].Value = Result.Item2;
                //}

                string file = string.Format(System.AppDomain.CurrentDomain.BaseDirectory.ToString() + @"results\results" + System.DateTime.Now.ToString().Replace(" ", "").Replace("/", "_").Replace(":", "-") + ".xlsx");

                Byte[] bin = package.GetAsByteArray();
                File.WriteAllBytes(file, bin);

                return true;
            }
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h2&gt;Things I've tried:&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Changing the values of various cells in the template. &lt;/li&gt;&lt;li&gt;Saving an &lt;em&gt;Excel&lt;/em&gt; document created from the template without writing any new data to it.
&lt;/li&gt;&lt;li&gt;Creating a basic template with the cells A1, A2, and A3 containing "TEST" and no other edits instead of the more complicated template I intend to use.
&lt;/li&gt;&lt;li&gt;Saving using &lt;code&gt;Package.SaveAs()&lt;/code&gt;. &lt;/li&gt;&lt;li&gt;Saving using the Byte array seen in the example code. &lt;/li&gt;&lt;li&gt;Compiling EPPlus from the latest source provided on Codeplex.&lt;br&gt;
&lt;/li&gt;&lt;/ul&gt;
&lt;h2&gt;Things that work:&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Creating a new file using the following code:&lt;br&gt;
&lt;/li&gt;&lt;/ul&gt;
&amp;lt;/ br&amp;gt;&lt;br&gt;
&lt;pre&gt;&lt;code&gt;using (package = new ExcelPackage(string.Format(System.AppDomain.CurrentDomain.BaseDirectory.ToString() + @"results\results" + System.DateTime.Now.ToString().Replace(" ", "").Replace("/", "_").Replace(":", "-") + ".xlsx"))
{
    ExcelWorksheet worksheet = package.Workbook.Worksheets.Add("Test");
    worksheet.Cells[A1].Value = "Test";
    package.Save();
}

&lt;/code&gt;&lt;/pre&gt;
&lt;h2&gt;Notes:&lt;/h2&gt;
For whatever reason, the files saved still appear corrupt and can't be recovered. I'm currently using
&lt;em&gt;Microsoft Office 2010&lt;/em&gt;. The file formats I'm using are &lt;code&gt;.xltx&lt;/code&gt; and
&lt;code&gt;.xlsx&lt;/code&gt;. &lt;br&gt;
&lt;br&gt;
&lt;em&gt;Source&lt;/em&gt;: &lt;a href="http://stackoverflow.com/q/19322625/2490143" rel="nofollow"&gt;
http://stackoverflow.com/q/19322625/2490143&lt;/a&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="11/10/2013 19:14:26">
          <Html>
        &lt;div class="markDownOutput "&gt;I will assume that will be a console app, so let´s do the basics... try this&lt;br&gt;
&lt;pre&gt;&lt;code&gt;   FileInfo tmpl = new FileInfo(@"c:\" + DateTime.Now.Ticks + ".xlsx");

            using (ExcelPackage pck = new ExcelPackage(tmpl))
            {
                var ws = pck.Workbook.Worksheets.Add("1");                      
                ws.Cells[2, 1].Value = "A";               
                pck.Save();
            }&lt;/code&gt;&lt;/pre&gt;
If that works, try the same code with your template file passing by constructor.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="zsmith" When="13/10/2013 17:58:35">
          <Html>
        &lt;div class="markDownOutput "&gt;Dunno if you've read my post. I've tried the basics. I've simplified it down to manually creating a template in Microsoft Office Excel 2010 with nothing but the word "TEST" in two cells. I then open this, write test to a third cell using EPPlus,
 and save it. The new .xlsx file comes out corrupt. Creating a new file using your method and not using an existing file works, but templates appear completely broken.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="amolg" When="17/10/2013 19:55:25">
          <Html>
        &lt;div class="markDownOutput "&gt;I was having the same problem. I was using .xltx as template and saving it as .xlsx. Now instead of taking .xltx file, I am taking blank .xlsx file with all the formatting ( style etc.) and after inserting the data in it, I am saving it as another .xlsx
 file. The original blank file(.xlsx) can be used as a template file. Hope this helps....&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Rosensteel" When="05/08/2014 17:32:00">
          <Html>
        &lt;div class="markDownOutput "&gt;When instantiating a new ExcelPackage object you're supposed to be able to provide a template as the second parameter, however when providing it with an xltx file I kept getting an exception. I eventually found that supplying a regular xlsx file as the
 template, rather than an actual template file, appeared to work.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;Dim excelFile As New FileInfo(filename)
Dim reportTemplate As New FileInfo(templatePath)
Dim xlFile As ExcelPackage = New ExcelPackage(excelFile, reportTemplate)

' Do Stuff

xlFile.Save()&lt;/code&gt;&lt;/pre&gt;
Bizarre behavior, but it worked.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="05/08/2014 20:59:29">
          <Html>
        &lt;div class="markDownOutput "&gt;I'm pretty sure there is no xltx support, EPPlus only handles xlsx and xlsm files. Maybe there is a extension check in the code.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Rosensteel" When="05/08/2014 21:20:39">
          <Html>
        &lt;div class="markDownOutput "&gt;You're probably right, but with little formal documentation, it's easy to assume that the template parameter means an actual template. That's what I did, and I got the same result: No exceptions on execution, but a corrupt and unusable output file.
&lt;br&gt;
&lt;br&gt;
The OP notes at the very end of his post that he was using an xltx file.&lt;br&gt;
&lt;br&gt;
Taking a quick peek at the EPPlus source, it looks like the ExcelPackage constructors that accept the "template" parameter, call the CreateFromTemplate() method. The comments on the CreateFromTemplate() method states that it expects an existing xlsx
 file to use as a template, not an actual template.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="05/08/2014 21:35:46">
          <Html>
        &lt;div class="markDownOutput "&gt;I think now I understand what this is about...I'm no advanced excel user =)&lt;br&gt;
&lt;br&gt;
I didn't know there was a extension to excel template files (xltx). Maybe instead of calling "templateFile" the best is calling "existingFile", and make clear inside the docs that you can use an existing file as template and this file must
 be xlsx or xlsm.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Using named ranges to allow user to define presentation layer and EPPlus provides data layer">
      <Posts>
        <Post From="Opus61856" When="05/08/2014 14:50:13">
          <Html>
        &lt;div class="markDownOutput "&gt;Has anyone successfully applied a template concept using EPPlus? &lt;br&gt;
&lt;br&gt;
Allow end user to define a worksheet/template with column headings, column formatting, and grouping. While using EPPlus to populate the sheet with data values.
&lt;br&gt;
&lt;br&gt;
Would love to be able to use the LoadFromDataTable() method, However, it appears to replace any current cell/column formatting when method called. This kinda kills the idea of using a template approach from the very start.
&lt;br&gt;
&lt;br&gt;
Any suggestions?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Date Format when Importing CSV">
      <Posts>
        <Post From="More92" When="01/08/2014 16:58:41">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello guys, Im importing a CSV which has a column that displays Dates (I want to display them as dd/mm/yyyy)&lt;br&gt;
&lt;br&gt;
CSV Example:&lt;br&gt;
&lt;br&gt;
B]999] &lt;strong&gt;13/01/2014 15:34&lt;/strong&gt; ]TEXT1]1&lt;br&gt;
B]999] &lt;strong&gt;03/01/2014 12:37&lt;/strong&gt; ]TEXT2]3&lt;br&gt;
B]999] &lt;strong&gt;03/01/2014 12:37&lt;/strong&gt; ]TEXT3]2&lt;br&gt;
&lt;br&gt;
When i save the file with the rows imported to a XLSX I see the dates in this way:&lt;br&gt;
&lt;br&gt;
&lt;strong&gt;13/01/2014 15:34&lt;br&gt;
41699,52569&lt;br&gt;
41699,52569&lt;/strong&gt;&lt;br&gt;
&lt;br&gt;
I tried to set a culture to the ExcelTextFormat but all i get is an empty report (only with the column headers)&lt;br&gt;
&lt;pre&gt;&lt;code&gt;   var format = new ExcelTextFormat();
   format.Delimiter = ']';
   format.TextQualifier = '[';
   format.SkipLinesBeginning = 0;
   format.SkipLinesEnd = 0;
   //format.Culture = CultureInfo.InvariantCulture; //Same as nothing
   //format.Culture = new CultureInfo("es-AR"); //Empty report&lt;/code&gt;&lt;/pre&gt;
Do you guys know how to do a workaround this?&lt;br&gt;
&lt;br&gt;
Thanks!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Streaming Excel file">
      <Posts>
        <Post From="andrewQwer" When="01/08/2014 10:06:38">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, I know that EPPlus can write content to stream, but I need another behavior:&lt;br&gt;
I want to write to stream as part of the excel data is ready. I use &lt;code&gt;BufferOutput = false&lt;/code&gt; to write to response immediately, but I don't know what to do with ExcelPackage to make it work.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;response.BufferOutput = false;
response.AddHeader("content-disposition", "inline; filename=" + reportGenerator.FileName);
response.ContentType = reportGenerator.ContentType;&lt;/code&gt;&lt;/pre&gt;
I tried to pass response.OutputStream to ExcelPackage but getting error which says that method is not supported. It seems that this is because OutputStream is not writeable as ExcelPackage requires.&lt;br&gt;
What can I do to write Excel content directly to OutputStream as the part of the data is ready?
&lt;br&gt;
I don't watn to send entire Excel content using &lt;code&gt;GetAsByteArray&lt;/code&gt; or &lt;code&gt;
SaveAs&lt;/code&gt; methods, I want partial writing to stream.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How do I return a cell value as it has been formatted by Excel?">
      <Posts>
        <Post From="r_omar" When="30/07/2014 11:47:39">
          <Html>
        &lt;div class="markDownOutput "&gt;I use EPPlus to load an Excel file that has numeric cells having this custom number format:&lt;br&gt;
&lt;br&gt;
00"."00"."00"."000"."0&lt;br&gt;
&lt;br&gt;
Hence, a cell value of 202100083 is displayed on Excel as 02.02.10.008.3&lt;br&gt;
&lt;br&gt;
It's a sort of a material coding standard. Now, I would like to use EPPlus to return the formatted value in a string. I am not really interested in the numeric value. Also, I don't want to do the formatting manually in my code because the number format may
 vary. How would I do this?&lt;br&gt;
&lt;br&gt;
Thank you :)&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="r_omar" When="31/07/2014 08:08:05">
          <Html>
        &lt;div class="markDownOutput "&gt;&lt;strong&gt;Update:&lt;/strong&gt; &lt;br&gt;
&lt;br&gt;
User &lt;a href="https://www.codeplex.com/site/users/view/wrummler" rel="nofollow"&gt;wrummler&lt;/a&gt; has found
&lt;a href="http://stackoverflow.com/questions/25032528/using-epplus-how-do-i-return-a-cell-value-as-it-has-been-formatted-by-excel" rel="nofollow"&gt;
my question on Stackoverflow&lt;/a&gt;, and he figured out that the problem is due to a bug in EPPlus. He suggested a nice workaround and he thankfully filed an issue for this
&lt;a href="https://epplus.codeplex.com/workitem/15041" rel="nofollow"&gt;here&lt;/a&gt;. Below is a quoting of his very helpful response.&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;em&gt;This looks like an issue in EPPlus. (update: I filed an &lt;a href="https://epplus.codeplex.com/workitem/15041" rel="nofollow"&gt;
issue&lt;/a&gt;.)&lt;/em&gt;&lt;br&gt;
&lt;br&gt;
&lt;em&gt;If you run your example with EPPlus under a debugger, you'll see that EPPlus is producing the string value from ExcelRangeBase.cs:965 using the expression d.ToString(format, nf.Culture) where d is the converted double value of your cell's text, format is
 "00.00.00.000.0", and nf is an EPPlus ExcelFormatTranslator (but the latter is not important to this particular issue).&lt;/em&gt;&lt;br&gt;
&lt;br&gt;
&lt;em&gt;The issue is that an un-literalized . in a custom numeric format string is taken to be a decimal point. So the value of format at this point in the EPPlus code should be "00'.'00'.'00'.'000'.'0".&lt;/em&gt;&lt;br&gt;
&lt;br&gt;
&lt;em&gt;I'm not yet sure what would be the best fix for this, but it looks to require a change somewhere in ExcelNumberFormatXml.ExcelFormatTranslator.ToNetFormat.&lt;/em&gt;&lt;br&gt;
&lt;br&gt;
&lt;em&gt;In the meantime, you don't have to do the formatting manually in your own code. Before calling the Text property, you can set the number format to what it should be, e.g.:&lt;/em&gt;&lt;br&gt;
&lt;br&gt;
&lt;em&gt;range.Style.Numberformat.Format = "00'.'00'.'00'.'000'.'0";&lt;/em&gt;&lt;br&gt;
&lt;br&gt;
&lt;em&gt;Now range.Text should give you the string you were expecting.&lt;/em&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to find one cell element without using loop in Epplus">
      <Posts>
        <Post From="Asfalt" When="15/12/2012 08:37:55">
          <Html>
        
&lt;p&gt;Hello!&lt;/p&gt;
&lt;p&gt;We have big excel file, and file has like 15 sections. We were using office and it was taking quite much time to import data from excel to database.&amp;nbsp;&lt;/p&gt;
&lt;p&gt;In office we are using Find function to get the row number and looping. &amp;nbsp;In office excel its working like this&lt;/p&gt;
&lt;p&gt;&amp;nbsp;_Worksheet xlWorksheet = xlWorkbook.Sheets[1];&amp;nbsp;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/p&gt;
&lt;p&gt;Range xlRange = xlWorksheet.UsedRange;&lt;/p&gt;
&lt;p&gt;var section1Heading = xlRange.Find("Section 1");&lt;/p&gt;
&lt;p&gt;var section2Heading = xlRange.Find("Section 2");&lt;/p&gt;
&lt;p&gt;int row = section1Heading.Row;&lt;/p&gt;
&lt;p&gt;for(int rowIndex = row; rowIndex&amp;lt;section2Heading.row ; rowIndex++) { }&lt;/p&gt;
&lt;p&gt;My Question is this, that how can i achieve the same result using Epplus. We have to use Epplus.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Klim1987" When="25/07/2014 09:50:17">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello! &lt;br&gt;
&lt;br&gt;
Did you solve your issue? If so, how? &lt;br&gt;
&lt;br&gt;
Until now I used the Excel library, but the stability of my programs are not always on top. Usually the cause is implementation of programs with parallel work in Excel users .
&lt;br&gt;
&lt;br&gt;
So I was wondering how you can work with Excel without using the program library. A little Googling I found EPPlyus. The library at the first approach I found everything I needed except for the Range.Find methods.
&lt;br&gt;
&lt;br&gt;
&lt;strong&gt;How did it happen that such a useful method is not implemented?&lt;/strong&gt; &lt;br&gt;
&lt;br&gt;
Yes, it is possible to compare the data in the cycle, but it works almost an order of magnitude slower search. I have half of the programs conducts a search in the cycle, so the difference in speed of 1 second in a series of 100,000 rows gives slowdown in 27
 hours.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="eagle47" When="29/07/2014 11:37:49">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello, I have never used the Find function, but if I understand correctly, it returns a range of cells with a certain value, right?&lt;br&gt;
&lt;br&gt;
If so, have you tried using Linq to find the specific cells? I don't know about the performance though.&lt;br&gt;
&lt;br&gt;
Example in C#&lt;br&gt;
&lt;pre&gt;&lt;code&gt;using (ExcelPackage pkg = new ExcelPackage(new FileInfo("newFile.xlsx")))
{
    ExcelWorksheet ws = pkg.Workbook.Worksheets.Add("NewSheet");

    ws.Cells["G140"].Value = "value you want to find";

    foreach (ExcelRangeBase cell in ws.Cells.Where(c =&amp;gt; c.Value == "value you want to find"))
    {
        Console.WriteLine(cell.Address);
    }
    pkg.Save();

}&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Klim1987" When="30/07/2014 08:39:22">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello, eagle47. &lt;br&gt;
&lt;br&gt;
Proposed code works. However, the rate is still suffers. Primarily because of the attempt to view all the used area of ​​the sheet.
&lt;br&gt;
&lt;br&gt;
How not to look over the entire sheet, but only for a specific range? Excel for example it would look like this:&lt;br&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;Excel.Range RangeS;
Excel.Range SearchObj;
RangeS = WorkSheet.get_Range(&lt;span style="color: rgb(163, 21, 21);"&gt;"B7"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"B"&lt;/span&gt; + (RowNum - 1));
SearchObj = RangeS.Find(&lt;span style="color: rgb(163, 21, 21);"&gt;"value you want to find"&lt;/span&gt;, Type.Missing, Excel.XlFindLookIn.xlValues, Excel.XlLookAt.xlWhole, Excel.XlSearchOrder.xlByRows, Excel.XlSearchDirection.xlNext, &lt;span style="color: blue;"&gt;false&lt;/span&gt;, &lt;span style="color: blue;"&gt;false&lt;/span&gt;, &lt;span style="color: blue;"&gt;false&lt;/span&gt;);
}
&lt;span style="color: blue;"&gt;if&lt;/span&gt; (SearchObj != &lt;span style="color: blue;"&gt;null&lt;/span&gt;)
{
    &lt;span style="color: green;"&gt;// do something&lt;/span&gt;
}
&lt;/pre&gt;
&lt;/div&gt;
In addition, the method of "Find" has many useful options.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="eagle47" When="30/07/2014 09:37:37">
          <Html>
        &lt;div class="markDownOutput "&gt;You could replace&lt;br&gt;
&lt;pre&gt;&lt;code&gt;ws.Cells.Where(c =&amp;gt; c.Value == "value you want to find")&lt;/code&gt;&lt;/pre&gt;
by&lt;br&gt;
&lt;pre&gt;&lt;code&gt;ws.Cells["B7:B" + (RowNum - 1).ToString()].Where(c =&amp;gt; c.Value == "value you want to find")&lt;/code&gt;&lt;/pre&gt;
to only iterate over a specified range (B1 to B(RowNum-1)). Hopefully, this will perform better.
&lt;br&gt;
&lt;br&gt;
Using Linq, you can also search for cell with other types of information (basically any property of a ExcelRangeBase in EPPlus) such as&lt;br&gt;
&lt;pre&gt;&lt;code&gt;wsData.Cells["B7:B" + (RowNum - 1).ToString()].Where(c =&amp;gt; c.Style.Font.Bold &amp;amp;&amp;amp; c.Style.Font.Size &amp;gt; 10);&lt;/code&gt;&lt;/pre&gt;
You can also use other Linq methods such as Select, OrderBy, Max, Min, etc. which could be useful.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Klim1987" When="30/07/2014 12:36:54">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello, eagle47. &lt;br&gt;
&lt;br&gt;
Unfortunately the time to perform the same tasks for the two methods 1 to 6 for the range "A1: A400000" (0.468 sec and 3.18 sec) in favor of the standard library. Of course, when the number of lines is much less, the difference is hardly noticeable.
 But I assume that the volume of data can be large. &lt;br&gt;
&lt;br&gt;
Have to work with the standard library. &lt;br&gt;
&lt;br&gt;
Thank you.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Export without column name">
      <Posts>
        <Post From="kranitz" When="27/07/2014 15:40:33">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello everyone! &lt;br&gt;
&lt;br&gt;
Could someone tell me,how i could export my data to excel table without exporting the columns name?
&lt;br&gt;
&lt;br&gt;
Thanks for help!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="EEPlus Active Filter using List Validation">
      <Posts>
        <Post From="makisce" When="25/07/2014 08:40:08">
          <Html>
        &lt;div class="markDownOutput "&gt;The document i'm creating has several sheets. The first one is used for data entry and other ones are used as lookup tables.
&lt;br&gt;
The trouble I'm in is how can I create Active Filter so a cell list for validation is generated according the value selected in another one?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Creating file which is more 1.5 Mb throws and exception System.ObjectDisposedException: Cannot access a disposed object. Object name: 'Cannot access Stream object because it was closed or disposed.'">
      <Posts>
        <Post From="kai121" When="23/07/2013 06:39:37">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello everyone. &lt;br&gt;
&lt;br&gt;
My aim is to form and save the xlsx file using epplus.dll. Everything is fine when file is less than 1.5 Mb. But trouble arrows when formed file, becomes more than 1.5 MB and it throws an exception at saving time.
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;strong&gt;Exception&lt;/strong&gt;&lt;br&gt;
&lt;pre&gt;&lt;code&gt; System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'Cannot access Stream object because it was closed or disposed.'&lt;/code&gt;&lt;/pre&gt;
&lt;strong&gt;Code snippet&lt;/strong&gt;&lt;br&gt;
&lt;pre&gt;&lt;code&gt; using (ExcelPackage package = new ExcelPackage())
         {
// there is code above where I write the data in package.
Response.Clear();
             Response.ContentType = "application/force-download";
             Response.AddHeader("content-disposition", "attachment; filename=ReportLicensesInExcel" + DateTime.Today.ToShortDateString() + ".xlsx");
             Response.Buffer = true;

             package.SaveAs(Response.OutputStream);

             Response.End();
    }&lt;/code&gt;&lt;/pre&gt;
&lt;strong&gt;Command line with exception&lt;/strong&gt;&lt;br&gt;
&lt;pre&gt;&lt;code&gt;package.SaveAs(Response.OutputStream);&lt;/code&gt;&lt;/pre&gt;
&lt;strong&gt;Stack trace&lt;/strong&gt; &lt;br&gt;
&lt;br&gt;
[ObjectDisposedException: Cannot access a disposed object. &lt;br&gt;
Object name: 'Cannot access Stream object because it was closed or disposed.'.] &lt;br&gt;
OfficeOpenXml.ExcelPackage.Save() +1235 &lt;br&gt;
OfficeOpenXml.ExcelPackage.SaveAs(Stream OutputStream) +83 &lt;br&gt;
Forms_ExpImpLicense.PrintToExcel() in c:\Inetpub\wwwroot\easuweb\VET\Forms\ExpImpLicense.aspx.cs:1220
&lt;br&gt;
Forms_ExpImpLicense.ExportToExcel_Click(Object sender, EventArgs e) in c:\Inetpub\wwwroot\easuweb\VET\Forms\ExpImpLicense.aspx.cs:1623
&lt;br&gt;
System.Web.UI.WebControls.Button.OnClick(EventArgs e) +118 &lt;br&gt;
System.Web.UI.WebControls.Button.RaisePostBackEvent(String eventArgument) +112 &lt;br&gt;
System.Web.UI.WebControls.Button.System.Web.UI.IPostBackEventHandler.RaisePostBackEvent(String eventArgument) +10
&lt;br&gt;
System.Web.UI.Page.RaisePostBackEvent(IPostBackEventHandler sourceControl, String eventArgument) +13
&lt;br&gt;
System.Web.UI.Page.RaisePostBackEvent(NameValueCollection postData) +36 &lt;br&gt;
System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +5563
&lt;br&gt;
&lt;br&gt;
What should i do?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="23/07/2013 12:30:17">
          <Html>
        &lt;div class="markDownOutput "&gt;I´m pretty sure when you call SaveAs method some objects are disposed, but i don't know why you have problem only with files greater than 1.5mb&lt;br&gt;
&lt;br&gt;
try this:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;                Response.Clear();
                Response.AddHeader("content-disposition", "attachment;  filename=file.xlsx");
                Response.ContentType = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";                   
                Response.BinaryWrite(pck.GetAsByteArray());
                Response.End();&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Ian_Powers" When="23/07/2013 13:46:37">
          <Html>
        &lt;div class="markDownOutput "&gt;I was having an issue where the workbook had to be repaired every time I downloaded.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;Response.End()&lt;/code&gt;&lt;/pre&gt;
Thank you mrxrsd&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="richardtallent" When="23/07/2013 15:51:15">
          <Html>
        &lt;div class="markDownOutput "&gt;Try removing this line:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;Response.Buffer = true;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="aszalacinski" When="24/07/2014 20:16:00">
          <Html>
        &lt;div class="markDownOutput "&gt;Was the ever resolved? I am experiencing this same issue with any file over 1.5 MB in an MVC 3 web app.&lt;br&gt;
&lt;pre&gt;&lt;code&gt; public ActionResult GetPublisherReportFile()
 {
      ExcelPackage pck = new ExcelPackage();
            
      var ws = pck.Workbook.Worksheets.Add("Report");

      ... omitted for brevity

      string contentType = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";
      string downloadName = string.Format("{0}.xlsx", reportTitle);

      var fileStream = new MemoryStream();
      pck.SaveAs(fileStream);
      fileStream.Position = 0;

      return File(fileStream, contentType, downloadName);
}&lt;/code&gt;&lt;/pre&gt;
I really want this to work or I will have to move on to other options. It's a slick library.
&lt;br&gt;
&lt;br&gt;
It runs fine in my development environment but in production it throws the following error when it goes to production:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;Cannot access a disposed object. Object name: 'Cannot access Stream object because it was closed or disposed.'. &lt;/code&gt;&lt;/pre&gt;
Production is running Windows Server 2003 R2 x64 and IIS6 &lt;br&gt;
&lt;br&gt;
Have attempted every solution I could fine on the web but no luck.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="An exception 'System.OutOfMemoryException' occured while genrating an Excel">
      <Posts>
        <Post From="pankajrai00" When="24/07/2014 08:03:56">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi,&lt;br&gt;
&lt;br&gt;
I am trying to generate Excel from data table 'dtResult'. Which consists about 80 columns &amp;amp; 300000 rows. An exception 'System.OutOfMemoryException' occured while genrating an Excel, below is code to generate an excel :&lt;br&gt;
&lt;br&gt;
using (ExcelPackage package = new ExcelPackage(newFile))&lt;br&gt;
&lt;pre&gt;&lt;code&gt;        {
            ExcelWorksheet worksheet = package.Workbook.Worksheets.Add(excelSheetName);
            worksheet.Cells["A1"].LoadFromDataTable(dtResult, true, TableStyles.None);
            package.Save();
        }
&lt;/code&gt;&lt;/pre&gt;
When I tried to create by running the code then it successfully generated an excel file. But when try to create by executable on server then it gives an exception.&lt;br&gt;
&lt;br&gt;
Please provide some solution to overcome this issue.&lt;br&gt;
&lt;br&gt;
Thanks,&lt;br&gt;
Pankaj Rai&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="SSRS Exported Excel files are not readable in EPPlus">
      <Posts>
        <Post From="celtic" When="18/07/2014 16:15:34">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
I am experiencing an issue with EPPlus reading worksheets from an SSRS generated excel file(*.xlsx), basically export to Excel.
&lt;br&gt;
Exception Message - &lt;br&gt;
"Unexpected XML declaration. The XML declaration must be the first node in the document, and no white space characters are allowed to appear before it. Line 1, position 2175"
&lt;br&gt;
&lt;br&gt;
If I save the same file opening in Excel Application and with no change to it, the same file works well.
&lt;br&gt;
&lt;br&gt;
Development Environment - &lt;br&gt;
VS2010, SQL Server 2012, SSRS &lt;br&gt;
&lt;br&gt;
Could anyone have suggestions to this issue. Appreciate your help.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Change rotation in fomart axis">
      <Posts>
        <Post From="John89" When="18/07/2014 12:42:13">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello,&lt;br&gt;
&lt;br&gt;
I search how to change the rotation in 35° at Axe of Xaxis, to see in picture by Epplus in C#.&lt;br&gt;
&lt;br&gt;
Thank you very much,&lt;br&gt;
&lt;br&gt;
&lt;img alt="Image" src="http://img.imagesia.com/fichiers/lz/sans-titre-2_imagesia-com_lzic_large.bmp"&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="read muti stilyng cell error">
      <Posts>
        <Post From="Cedrxz" When="18/07/2014 01:23:51">
          <Html>
        &lt;div class="markDownOutput "&gt;I have a document I need export information to my database &lt;br&gt;
when I'm reading a cell which have muti stilyng font: &lt;br&gt;
&lt;br&gt;
this is Normal, &lt;strong&gt;this is Bold&lt;/strong&gt; &lt;br&gt;
&lt;br&gt;
I get error 'System.ArgumentOutOfRangeException' but the cell exist and has values
&lt;br&gt;
&lt;br&gt;
and If I go with debug, the value take a couple of seconds to apper I'm not sure what is
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
I'm very estressed by this issue &lt;br&gt;
&lt;br&gt;
can please some body help me&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Encoding issue when reading Excel Sheet created by Microsoft Access 2007/2013">
      <Posts>
        <Post From="benigemperle" When="16/07/2014 15:49:41">
          <Html>
        &lt;div class="markDownOutput "&gt;In Microsoft Access 2007 or 2013 a Table can be exported using the Export Spreadsheet Wizard:
&lt;br&gt;
&lt;br&gt;
&lt;img alt="Image" src="http://share.2sic.com/share/Content/Programming-Issues/2014-07%20EPPlus/Access%20Export.png"&gt;
&lt;br&gt;
&lt;br&gt;
When reading the Excel Sheet with EPPlus angle brackets are somehow encoded, probably it’s XML-Encoding.
&lt;br&gt;
If the Excel Sheet created by Access then is opend in Excel and saved again (“file touched”), EPPlus reads it as it should be.
&lt;br&gt;
&lt;br&gt;
&lt;img alt="Image" src="http://share.2sic.com/share/Content/Programming-Issues/2014-07%20EPPlus/Reading%20the%20Excel%20Sheets.png"&gt;
&lt;br&gt;
&lt;br&gt;
Please help me to solve this issue. Does Access create invalid Spreadsheets? Is there something missing in EPPlus? Same behavior with Spreadsheets created by Access 2007 and 2013.
&lt;br&gt;
&lt;br&gt;
Excel always shows the correct text, also reading the Spreadsheet with SQL Server (using OPENROWSET) shows correct texts.
&lt;br&gt;
&lt;br&gt;
&lt;a href="http://share.2sic.com/share/Content/Programming-Issues/2014-07%20EPPlus/AccessExport.xlsx" rel="nofollow"&gt;AccessExport.xlsx&lt;/a&gt;
&lt;br&gt;
&lt;a href="http://share.2sic.com/share/Content/Programming-Issues/2014-07%20EPPlus/SavedInExcel.xlsx" rel="nofollow"&gt;SavedInExcel.xlsx&lt;/a&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Thanks, &lt;br&gt;
Benjamin&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Pivot table - possibility to Format also the RowFields">
      <Posts>
        <Post From="andreideznan" When="16/07/2014 13:13:07">
          <Html>
        &lt;div class="markDownOutput "&gt;Would be great to have the possibility to Format also the RowFields or to inherit the format used on data source columns. DataFields can be formatted already.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Cannot use LoadFromDatatable more than once on same WS - Table1 name used w/ each load">
      <Posts>
        <Post From="Opus61856" When="11/07/2014 14:24:26">
          <Html>
        &lt;div class="markDownOutput "&gt;When I execute the first load into a new or completely empty WS, the &lt;strong&gt;
LoadFromDataTable&lt;/strong&gt; works perfectly. &lt;br&gt;
&lt;br&gt;
However, if I would like to add a second group of numbers to the right of the first group, the
&lt;strong&gt;LoadFromDataTable&lt;/strong&gt; fails because it attempts to name the second table with the name (Table1) and this the Load fails. Is there anyway short of handcoding?
&lt;br&gt;
&lt;br&gt;
Combine this with an apparent inability to delete or rename an existing Table then the only alternative I see is to load each days values directly (wo/ using the
&lt;strong&gt;LoadFromDataTable&lt;/strong&gt;). &lt;br&gt;
&lt;br&gt;
Would be nice if Load... had an optional parameter of TableName. &lt;br&gt;
&lt;br&gt;
Any ideas, or alternatives.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="kummaz" When="15/07/2014 04:35:18">
          <Html>
        &lt;div class="markDownOutput "&gt;You can rename the DataTable prior to each load and you should not run into this issue.
&lt;br&gt;
&lt;br&gt;
However if you want a more permanent fix or to provide this functionality yourself you can overload the LoadFromDataTable method in the source.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;var tbl = _worksheet.Tables.Add(new ExcelAddressBase(_fromRow, _fromCol, _fromRow + (rows==0 ? 1 : rows), _fromCol + Table.Columns.Count-1), Table.TableName);&lt;/code&gt;&lt;/pre&gt;
Simply replace the Table.TableName with the overloaded string parameter that your new method includes. Alternatively you can instead of throwing the 'Table not Unique' exception, call the GetNewTableName() function to create a TableName with an incremented
 number based on the existing tables. &lt;br&gt;
&lt;br&gt;
Just my 2c&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="read Merged Cells">
      <Posts>
        <Post From="Cedrxz" When="12/07/2014 00:15:04">
          <Html>
        &lt;div class="markDownOutput "&gt;How can I read the value from merged cells on an excel file?? &lt;br&gt;
&lt;br&gt;
I have this code but send me a indedx out of limit error &lt;br&gt;
var enu = worksheet.Cells["A3:D3"].Value;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="kummaz" When="14/07/2014 07:13:54">
          <Html>
        &lt;div class="markDownOutput "&gt;The values in merged cells are stored in 2d arrays e.g. object[,]. &lt;br&gt;
&lt;br&gt;
To access the value just grab the first value from the array e.g. [0,0]; &lt;br&gt;
&lt;br&gt;
v.quick example&lt;br&gt;
&lt;pre&gt;&lt;code&gt;var enu = (worksheet.Cells["A3:D3"].Value as object[,])[0,0].ToString();&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Cedrxz" When="14/07/2014 19:51:04">
          <Html>
        &lt;div class="markDownOutput "&gt;Actually I found the error but it's a little weird, &lt;br&gt;
this error comes when the merged cell or any other single cell is partially formatted
&lt;br&gt;
&lt;br&gt;
example: &lt;br&gt;
&lt;br&gt;
"normal data, &lt;strong&gt;formatted data&lt;/strong&gt;" &lt;br&gt;
on this case is when I get the error did anybody know how can be solved?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Change Series Chart Type">
      <Posts>
        <Post From="kummaz" When="14/07/2014 06:51:16">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
Does anyone know how to change the Chart Type of a specific series once a number of series have been added to the chart?
&lt;br&gt;
&lt;br&gt;
E.g. I have 3 series. Two of these should be lines, and the third series should be a column. Currently it only appears as though you can set the chart type for all series in a chart and not one in particular.
&lt;br&gt;
&lt;br&gt;
Thanks. &lt;br&gt;
&lt;br&gt;
kummaz&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Pivot table - by adding a column containing '&amp;lt;' character the export will crash">
      <Posts>
        <Post From="andreideznan" When="07/07/2014 17:49:43">
          <Html>
        &lt;div class="markDownOutput "&gt;Do you have an idea on how can I manage this?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Background Color">
      <Posts>
        <Post From="jcl5fa" When="07/03/2011 22:07:18">
          <Html>
        
&lt;p&gt;How do I set the background color of a cell?&lt;/p&gt;
&lt;p&gt;I thought this would work, but the compiler is telling me the field is read only and cannot be assigned.&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;font face="Consolas" size="2"&gt;&lt;/font&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;font face="Consolas" size="2"&gt;
&lt;p&gt;myWs.Cells[1, 1].Style.Fill.BackgroundColor.Rgb =&lt;/p&gt;
&lt;/font&gt;&lt;span style="color: rgb(163, 21, 21); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(163, 21, 21); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(163, 21, 21); font-family: Consolas; font-size: x-small;"&gt;"FFFF00"
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="10/03/2011 07:31:07">
          <Html>
        
&lt;p&gt;Download the sample project, you have several examples how to do it there.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JordanBaumgardner" When="04/07/2014 02:37:18">
          <Html>
        &lt;div class="markDownOutput "&gt;myWs.Cells[1, 1].Style.Fill.PatternType = OfficeOpenXml.Style.ExcelFillStyle.Solid;&lt;br&gt;
myWs.Cells[1, 1].Style.Fill.BackgroundColor.SetColor(Color.LightGray);&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="External Data Sources">
      <Posts>
        <Post From="mhardy" When="03/07/2014 18:13:46">
          <Html>
        &lt;div class="markDownOutput "&gt;Is it possible to manage external data sources using EPPlus? &lt;br&gt;
&lt;br&gt;
More specifically, add a reference to an ODC file for a Pivot table. &lt;br&gt;
&lt;br&gt;
Thanks, &lt;br&gt;
Mike&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="03/07/2014 18:17:40">
          <Html>
        &lt;div class="markDownOutput "&gt;Mike, &lt;br&gt;
&lt;br&gt;
No, EPPlus only handles xlsx files and there is no way to attach external data sources.
&lt;br&gt;
&lt;br&gt;
Regards, &lt;br&gt;
Thiago&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Generate Chart, Apply Style in Excel, Save, Fail">
      <Posts>
        <Post From="CarlGo" When="02/07/2014 21:04:46">
          <Html>
        &lt;div class="markDownOutput "&gt;This problem exists in both the 3.1 and 4.0 code base.&lt;br&gt;
&lt;br&gt;
To reproduce the error,&lt;br&gt;
&lt;ol&gt;
&lt;li&gt;Run the sample application. &lt;/li&gt;&lt;li&gt;Open sample5.xlsx &lt;/li&gt;&lt;li&gt;Select the Pie Chart &lt;/li&gt;&lt;li&gt;Select the CHART TOOLS tab &lt;/li&gt;&lt;li&gt;Select any predefined style &lt;/li&gt;&lt;li&gt;Save the workbook&lt;br&gt;
&lt;/li&gt;&lt;/ol&gt;
The following error is displayed:&lt;br&gt;
Errors were detected while saving 'C:\temp\SampleApp\sample5.xlsx'. Microsoft Excel may be unable to save the file by removing or repairing some features. To make repairs in a new file, click Continue. To cancel saving the file, click Cancel.&lt;br&gt;
&lt;br&gt;
Clicking Continue and trying to save the file with a new name results in the exact same error.&lt;br&gt;
&lt;br&gt;
I would love to use EPPlus, but the user MUST have the ability to modify the generated spreadsheet when it has a chart which is impossible.&lt;br&gt;
&lt;br&gt;
Has anyone found a workaround for this problem?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Unable to edit existing comments in excel.">
      <Posts>
        <Post From="preetam96" When="02/07/2014 20:42:38">
          <Html>
        &lt;div class="markDownOutput "&gt;In my excel when I am trying to update existing comments (code provided below) .when I try to open the excel I get following message “Excel found unreadable content in ‘test.xlsx’. Do you want to recover the contents of this workbook? If you trust the
 source of this workbook, click yes.” &lt;br&gt;
In the excel all the comments in the workbook are lost. &lt;br&gt;
&lt;pre&gt;&lt;code&gt; using (newPack = new ExcelPackage(fileInfo))
        {
            var wkBk = newPack.Workbook.Worksheets["Company"];
            var cell= wkBk.Cells["A6"];
            if (cell.Comment != null)
            {
                cell.Comment.Text = "Hello edited comments";
            }
    newPack.Save();
    }&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Scatter Chart">
      <Posts>
        <Post From="ZvonkoM" When="02/07/2014 12:26:06">
          <Html>
        &lt;div class="markDownOutput "&gt;I have created a chart and the generated xls file looks very good in OpenOffice Calc, but not so well in MS OFfice. Here is my VB.NET code:&lt;br&gt;
&lt;br&gt;
Dim chart As ExcelScatterChart = CType(chartWorksheet.Drawings.AddChart("Scatter Chart", eChartType.XYScatter), OfficeOpenXml.Drawing.Chart.ExcelScatterChart)&lt;br&gt;
chart.From.Row=5&lt;br&gt;
chart.From.Column=1&lt;br&gt;
chart.SetSize(ChartHeightAndWidth, ChartHeightAndWidth)&lt;br&gt;
&lt;br&gt;
Dim range1 As ExcelRange = dataWorksheet.Cells(String.Format("C1:C{0}", data.Count + 1))&lt;br&gt;
Dim range2 As ExcelRange = dataWorksheet.Cells(String.Format("B1:B{0}", data.Count + 1))&lt;br&gt;
Dim serie As ExcelScatterChartSerie = CType(chart.Series.Add(range1, range2), ExcelScatterChartSerie)&lt;br&gt;
Any help is appreciated!&lt;br&gt;
&lt;br&gt;
Thanks!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="AutoFilter and protected ranges don't seem to want to play together">
      <Posts>
        <Post From="PoweredByPorkers" When="02/07/2014 00:11:43">
          <Html>
        &lt;div class="markDownOutput "&gt;I have to create a spreadsheet, add auto filtering to the columns, protect the sheet and allow sorting, all easy enough except I can't get my code working :-)
&lt;br&gt;
&lt;br&gt;
Here's an example&lt;br&gt;
&lt;pre&gt;&lt;code&gt;using (var package = new ExcelPackage(newFile))
{
    var worksheet = package.Workbook.Worksheets.Add("Yo!");

    worksheet.Protection.AllowDeleteColumns =
        worksheet.Protection.AllowDeleteRows = 
        worksheet.Protection.AllowSelectLockedCells = false;
    worksheet.Protection.AllowSort =
        worksheet.Protection.AllowFormatColumns =
            worksheet.Protection.AllowAutoFilter = 
            worksheet.Protection.AllowPivotTables = true;

    worksheet.Protection.SetPassword("SomeFabulousPasswordNoDoubt");

    worksheet.Cells["A1"].Value = "Column1";
    worksheet.Cells["B1"].Value = "Column2";
    worksheet.Cells["C1"].Value = "Column3";
    worksheet.Cells["D1"].Value = "Column4";
    worksheet.Cells["E1"].Value = "Column5";

    worksheet.Cells["A2:E4"].Value = 1;
    worksheet.Cells["A1:E1"].AutoFilter = true;
    worksheet.ProtectedRanges.Add("XXX", new ExcelAddress("A2:E4"));

    package.Save();
}&lt;/code&gt;&lt;/pre&gt;
If I run this the excel doesn't open, if I remove either the AutoFilter line OR the ProtectedRanges.Add line all is good??
&lt;br&gt;
&lt;br&gt;
Anyone point me in the right direction please?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Retain format of excel template">
      <Posts>
        <Post From="Dominican" When="29/06/2014 23:09:48">
          <Html>
        &lt;div class="markDownOutput "&gt;I am filling an existing excel template's cells with data but would like to retain the format from the template so the new data gets formatted as per the template. Is there any way to retain the format in an existing file for new data.
&lt;br&gt;
&lt;br&gt;
Thanks. &lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="how do this ?">
      <Posts>
        <Post From="lihao647" When="27/06/2014 09:29:01">
          <Html>
        &lt;div class="markDownOutput "&gt;&lt;img alt="Image" src="http://v2.freep.cn/3tb_140627162440b10g512293.png"&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Error in Debug Mode in SSIS Designer">
      <Posts>
        <Post From="billiam904" When="26/06/2014 17:09:17">
          <Html>
        &lt;div class="markDownOutput "&gt;I am working in BIDS (SSIS Designer) 2008 and created a C# script task then added EPPLus.dll as a reference and get the following error:
&lt;br&gt;
&lt;br&gt;
Error: System.Reflection.TargetInvocationException: Exception has been thrown by the target of an invocation. ---&amp;gt; System.IO.FileNotFoundException: Could not load file or assembly 'EPPlus, Version=4.0.0.1, Culture=neutral, PublicKeyToken=ea159fdaa78159a1'
 or one of its dependencies. The system cannot find the file specified. &lt;br&gt;
File name: 'EPPlus, Version=4.0.0.1, Culture=neutral, PublicKeyToken=ea159fdaa78159a1'
&lt;br&gt;
at ST_8c2e71bfe43f48e2bad80e1d40d31c52.csproj.ScriptMain.Main() &lt;br&gt;
&lt;br&gt;
Any help with this error would be appreciated.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Pivot Table Top Ten">
      <Posts>
        <Post From="rbelknap" When="21/05/2014 22:41:28">
          <Html>
        &lt;div class="markDownOutput "&gt;I am having trouble figuring out if the "Top Ten" filter is supported for Pivot Tables.
&lt;br&gt;
&lt;br&gt;
Would you please let me know if it is supported and if yes supply an example. &lt;br&gt;
&lt;br&gt;
Thanks...&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Mark_Wightman" When="25/06/2014 14:53:29">
          <Html>
        &lt;div class="markDownOutput "&gt;In the currently released version 3.1 the pivot table filter fields is extremely limited (Page Field). This is because it does not load any of the data into the pivot table xml files and lets Excel handle this when the file is opened for the first time.
 Implementing anything like a "Top Ten" filter requires it to know what the data is in the row or data fields.
&lt;br&gt;
&lt;br&gt;
I have not seen any indication this is changing in 4.0, but I could be mistaken. &lt;br&gt;
&lt;br&gt;
To add something like this it will require some redesign of the source code. &lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="eDisplayBlanksAs.Gap is not working!?!">
      <Posts>
        <Post From="darrenh99" When="19/11/2012 05:49:21">
          <Html>
        
&lt;p&gt;I use the following code to try to set up to "Show empty cells as: Gaps". But it seems not working because I can still see it is set to "Zero" in the "Hidden and Empty Cell Settings" window.&lt;/p&gt;
&lt;p&gt;var chart1 = ews01.Drawings.AddChart("Chart - 1", eChartType.LineMarkers);&lt;br&gt;
chart1.SetPosition(5, 5);&lt;br&gt;
chart1.SetSize(1150, 340);&lt;br&gt;
chart1.DisplayBlanksAs = eDisplayBlanksAs.Gap;&lt;/p&gt;
&lt;p&gt;but if I change Gap to Span --&amp;gt; chart1.DisplayBlanksAs = eDisplayBlanksAs.Span;&lt;/p&gt;
&lt;p&gt;it works! it is set to "Connect data points with line" in the "Hidden and Empty Cell Settings" window.&lt;/p&gt;
&lt;p&gt;Does any one get any idea? Thanks&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="swaghost" When="31/05/2013 21:03:35">
          <Html>
        &lt;div class="markDownOutput "&gt;Did you get any resolution to "eDisplayBlanksAs.Gap is not working!?!"? I have the same issue.
&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="ClassyBear" When="29/04/2014 17:14:20">
          <Html>
        &lt;div class="markDownOutput "&gt;Same&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Trobes" When="24/06/2014 21:58:45">
          <Html>
        &lt;div class="markDownOutput "&gt;Seems like its a bug. &lt;br&gt;
&lt;br&gt;
In the chart.xml file inside your excel zip library, if you set with Gap, it actually doesn't include the node.
&lt;br&gt;
My work around is as follows, works great. &lt;br&gt;
&lt;br&gt;
You need to set it as span, so the node actually gets created. &lt;br&gt;
chart.DisplayBlanksAs = eDisplayBlanksAs.Span; &lt;br&gt;
&lt;br&gt;
Now you update it by calling my formatChartGap function, which will replace the xml
&lt;br&gt;
xml before: &lt;br&gt;
&amp;lt;c:dispBlanksAs val="span"/&amp;gt; &lt;br&gt;
xml after: &lt;br&gt;
&amp;lt;c:dispBlanksAs val="gap"/&amp;gt; &lt;br&gt;
&lt;br&gt;
formatChartGap(chart.ChartXml);&lt;br&gt;
&lt;pre&gt;&lt;code&gt;        nsmgr = new XmlNamespaceManager(doc.NameTable);
        nsmgr.AddNamespace("r", @"http://schemas.openxmlformats.org/officeDocument/2006/relationships");
        nsmgr.AddNamespace("a", @"http://schemas.openxmlformats.org/drawingml/2006/main");
        nsmgr.AddNamespace("c", @"http://schemas.openxmlformats.org/drawingml/2006/chart");


    public void formatChartGap(XmlDocument xdoc)
    {
        var root = xdoc.DocumentElement;
        XmlNode xn;

         xn = root.SelectSingleNode("//c:chart/c:dispBlanksAs", nsmgr);

         xn.Attributes["val"].Value = "gap";

    }&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Trobes" When="24/06/2014 22:04:08">
          <Html>
        &lt;div class="markDownOutput "&gt;this is how I initialized my chart obj.. in case this helps &lt;br&gt;
&lt;br&gt;
var chart = (ExcelLineChart)sheetchart.Drawings.AddChart("Z Chart", eChartType.LineMarkers);
&lt;br&gt;
&lt;br&gt;
so chart.ChartXml is essentially a XmlDocument object that you can do anything with. So any time epplus doesn't do something, you just do in an excel file what you want.. change the extension to .zip open the zip and compare the xml before and after (from another
 copy) and then you can use the XmlDocument method to basically do anything. And fubar stuff as well....&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Read an xlsx file">
      <Posts>
        <Post From="vigas22" When="24/06/2014 16:00:42">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
I can't read an xlsx file, i use this following code :&lt;br&gt;
&lt;pre&gt;&lt;code&gt;FileInfo fileInfo = new FileInfo(xlsxFile);
ExcelPackage package = new ExcelPackage(fileInfo);
IEnumerable&amp;lt;string&amp;gt; list = package.Workbook.Worksheets.Select(w =&amp;gt; w.Name);&lt;/code&gt;&lt;/pre&gt;
and I have systematically this exception with some files xlsx.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;___URI non valide : Impossible d'analyser le nom d'hôte.___
à System.Uri.CreateThis(String uri, Boolean dontEscape, UriKind uriKind)
à System.Uri..ctor(String uriString, UriKind uriKind)
à MS.Internal.IO.Packaging.InternalRelationshipCollection.ProcessRelationshipAttributes(XmlCompatibilityReader reader)
   à MS.Internal.IO.Packaging.InternalRelationshipCollection.ParseRelationshipPart(PackagePart part)
   à MS.Internal.IO.Packaging.InternalRelationshipCollection..ctor(Package package, PackagePart part)
   à System.IO.Packaging.PackagePart.EnsureRelationships()
   à System.IO.Packaging.PackagePart.GetRelationshipHelper(String id)
   à System.IO.Packaging.PackagePart.GetRelationship(String id)
   à OfficeOpenXml.ExcelWorksheet.LoadHyperLinks(XmlTextReader xr)
   à OfficeOpenXml.ExcelWorksheet.CreateXml()
   à OfficeOpenXml.ExcelWorksheet..ctor(XmlNamespaceManager ns, ExcelPackage excelPackage, String relID, Uri uriWorksheet, String sheetName, Int32 sheetID, Int32 positionID, eWorkSheetHidden hide)
   à OfficeOpenXml.ExcelWorksheets..ctor(ExcelPackage pck, XmlNamespaceManager nsm, XmlNode topNode)
   à OfficeOpenXml.ExcelWorkbook.get_Worksheets()
   à OfficeOpenXml.ExcelWorkbook.GetDefinedNames()
   à OfficeOpenXml.ExcelPackage.get_Workbook()&lt;/code&gt;&lt;/pre&gt;
Any idea to solve this ? &lt;br&gt;
&lt;br&gt;
Regards&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Export WPF Datagrid to Excel xlsx">
      <Posts>
        <Post From="younessbouizem" When="20/06/2014 10:58:00">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
I would like to export WPF datagrid to Excel OpenXML format (.xlsx). I am looking for this example :
&lt;br&gt;
&lt;br&gt;
&lt;a href="http://rbalajiprasad.blogspot.fr/2013/07/wpf-export-to-excel-using-epplus.html" rel="nofollow"&gt;http://rbalajiprasad.blogspot.fr/2013/07/wpf-export-to-excel-using-epplus.html&lt;/a&gt;
&lt;br&gt;
&lt;br&gt;
but it seems there isn't any idea about using datagrid control for export. &lt;br&gt;
&lt;br&gt;
Any suggestions ? &lt;br&gt;
&lt;br&gt;
Regards&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Insert single or range of cells">
      <Posts>
        <Post From="primg" When="10/06/2014 15:13:44">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi ,&lt;br&gt;
&lt;br&gt;
I'd like to insert a few cells in an existing complex Excel (in order to add column in a table, which is just a part of the Excel).&lt;br&gt;
I tried the worksheet.InsertColumn(int int int), but I would like to insert cell by cell.&lt;br&gt;
&lt;br&gt;
Is that possible ?&lt;br&gt;
&lt;br&gt;
Thanks by advance,&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="primg" When="20/06/2014 10:14:58">
          <Html>
        &lt;div class="markDownOutput "&gt;Nobody ?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Epplus Version 4.0 InsertRow in WorkSheet Fail">
      <Posts>
        <Post From="thanhtuanckc" When="20/06/2014 04:49:28">
          <Html>
        &lt;div class="markDownOutput "&gt;I have code: &lt;br&gt;
&lt;pre&gt;&lt;code&gt;       ExcelPackage excelPackage = new ExcelPackage(fileInput);

       ExcelWorksheet excelWorksheet = excelPackage.Workbook.Worksheets[1];

       excelWorksheet.InsertRow(3, 2, 3);
&lt;/code&gt;&lt;/pre&gt;
Add row is good but "copy Styles From Row" is fail.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Format Template Excel">
      <Posts>
        <Post From="thanhtuanckc" When="19/06/2014 02:54:16">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi. &lt;br&gt;
&lt;br&gt;
I have a file template Excel format (number, time, General,...). When I write data to file template by Epplus and SaveAs file and open file. All data types not in the format of template. Why ?
&lt;br&gt;
&lt;br&gt;
Thank.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="[EPPLUS][C#]View the table of data in a histogram.">
      <Posts>
        <Post From="John89" When="18/06/2014 21:42:03">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello everyone,&lt;br&gt;
&lt;br&gt;
Currently I use EPPLUS that I am fully satisfied. &lt;br&gt;
&lt;br&gt;
I can create a stacked bar chart and put options I want. &lt;br&gt;
&lt;br&gt;
I blocks just when it comes to put the data table (see example below) :/. &lt;br&gt;
&lt;br&gt;
So I can not find the option otherwise related, may I found very information has above.
&lt;br&gt;
&lt;br&gt;
Apparently it would create a template and apply it. No worries we know save templates graphs with Excel 2010 crtx extension. I just can not find how to load the graph that I build.
&lt;br&gt;
&lt;br&gt;
So does anyone know how to make a addition of tables of data in a graph? or how to load the template?
&lt;br&gt;
So it is possible to extract the graph to an image? &lt;br&gt;
&lt;br&gt;
I want to improve my English. &lt;br&gt;
&lt;br&gt;
Best regard,&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
With TableDATA : &lt;a href="http://www.hostingpics.net/viewer.php?id=934840graphe2.jpg" rel="nofollow"&gt;
TEXT&lt;/a&gt;&lt;br&gt;
&lt;img alt="Image" src="http://www.hostingpics.net/viewer.php?id=934840graphe2.jpg"&gt;&lt;br&gt;
&lt;br&gt;
Without TableData : &lt;a href="http://www.hostingpics.net/viewer.php?id=731385graphe1.jpg" rel="nofollow"&gt;
TEXT&lt;/a&gt;&lt;br&gt;
&lt;img alt="Image" src="http://www.hostingpics.net/viewer.php?id=731385graphe1.jpg"&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Is it possible to user zero-based cell index?">
      <Posts>
        <Post From="skfd" When="17/06/2014 13:04:21">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi!&lt;br&gt;
&lt;br&gt;
I'm trying to port an app to EPPlus, but it uses zero-based index. Whole app is littered with magic numbers that assume zero-basedness.&lt;br&gt;
&lt;br&gt;
Is it possible to use zero-based index with EPPlus?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Desktop Application - Unable to determine the identity of domain">
      <Posts>
        <Post From="RuselGun" When="14/06/2014 14:33:57">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello, &lt;br&gt;
I have just starting my excel interop code to epplus and did it when savng an excel document but I can't read an existing file. I searched but every result is related with web applications, I am developing a desktop application.
&lt;br&gt;
My code is so simple:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;        Dim File As FileInfo = New FileInfo(DosyaAd)
        Using package As New ExcelPackage(File)
            Dim She As ExcelWorksheet
            She = package.Workbook.Worksheets("BF")
        End using&lt;/code&gt;&lt;/pre&gt;
I got this error at: She = package.Workbook.Worksheets("BF")&lt;br&gt;
&lt;pre&gt;&lt;code&gt;System.IO.IsolatedStorage.IsolatedStorageException was unhandled by user code
  HResult=-2146233264
  Message=Unable to determine the identity of domain.
  Source=mscorlib
  StackTrace:
       at System.IO.IsolatedStorage.IsolatedStorage._GetAccountingInfo(Evidence evidence, Type evidenceType, IsolatedStorageScope fAssmDomApp, Object&amp;amp; oNormalized)
       at System.IO.IsolatedStorage.IsolatedStorage.GetAccountingInfo(Evidence evidence, Type evidenceType, IsolatedStorageScope fAssmDomApp, String&amp;amp; typeName, String&amp;amp; instanceName)
       at System.IO.IsolatedStorage.IsolatedStorage._InitStore(IsolatedStorageScope scope, Evidence domainEv, Type domainEvidenceType, Evidence assemEv, Type assemblyEvidenceType, Evidence appEv, Type appEvidenceType)
       at System.IO.IsolatedStorage.IsolatedStorage.InitStore(IsolatedStorageScope scope, Type domainEvidenceType, Type assemblyEvidenceType)
       at System.IO.IsolatedStorage.IsolatedStorageFile.GetStore(IsolatedStorageScope scope, Type domainEvidenceType, Type assemblyEvidenceType)
       at MS.Internal.IO.Packaging.PackagingUtilities.ReliableIsolatedStorageFileFolder.GetCurrentStore()
       at MS.Internal.IO.Packaging.PackagingUtilities.ReliableIsolatedStorageFileFolder..ctor()
       at MS.Internal.IO.Packaging.PackagingUtilities.GetDefaultIsolatedStorageFile()
       at MS.Internal.IO.Packaging.PackagingUtilities.CreateUserScopedIsolatedStorageFileStreamWithRandomName(Int32 retryCount, String&amp;amp; fileName)
       at MS.Internal.IO.Packaging.SparseMemoryStream.SwitchModeIfNecessary()
       at MS.Internal.IO.Packaging.SparseMemoryStream.Write(Byte[] buffer, Int32 offset, Int32 count)
       at MS.Internal.IO.Packaging.DeflateEmulationTransform.Decompress(Stream source, Stream sink)
       at MS.Internal.IO.Packaging.CompressEmulationStream..ctor(Stream baseStream, Stream tempStream, Int64 position, IDeflateTransform transformer)
       at MS.Internal.IO.Packaging.CompressStream.ChangeMode(Mode newMode)
       at MS.Internal.IO.Packaging.CompressStream.Seek(Int64 offset, SeekOrigin origin)
       at MS.Internal.IO.Zip.ProgressiveCrcCalculatingStream.Seek(Int64 offset, SeekOrigin origin)
       at MS.Internal.IO.Zip.ZipIOModeEnforcingStream.Read(Byte[] buffer, Int32 offset, Int32 count)
       at System.IO.StreamReader.ReadBuffer(Char[] userBuffer, Int32 userOffset, Int32 desiredChars, Boolean&amp;amp; readToUserBuffer)
       at System.IO.StreamReader.Read(Char[] buffer, Int32 index, Int32 count)
       at System.IO.StreamReader.ReadBlock(Char[] buffer, Int32 index, Int32 count)
       at OfficeOpenXml.ExcelWorksheet.GetWorkSheetXml(Stream stream, Int64 start, Int64 end, Encoding&amp;amp; encoding)
       at OfficeOpenXml.ExcelWorksheet.CreateXml()
       at OfficeOpenXml.ExcelWorksheet..ctor(XmlNamespaceManager ns, ExcelPackage excelPackage, String relID, Uri uriWorksheet, String sheetName, Int32 sheetID, Int32 positionID, eWorkSheetHidden hide)
       at OfficeOpenXml.ExcelWorksheets..ctor(ExcelPackage pck, XmlNamespaceManager nsm, XmlNode topNode)
       at OfficeOpenXml.ExcelWorkbook.get_Worksheets()
       at OfficeOpenXml.ExcelWorkbook.GetDefinedNames()
       at OfficeOpenXml.ExcelPackage.get_Workbook()
.........&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Index was out of range. Must be non-negative and less than the size of the collection">
      <Posts>
        <Post From="preetam96" When="05/06/2014 22:05:44">
          <Html>
        &lt;div class="markDownOutput "&gt;In my project , user will download the excel from UI he has the leverage to select the work book tabs which he want to see in the excel sheet. One he get that excel he can use it to get data to the corresponding excel sheet. By uploading the excel. The
 problem I will encountered is if I download the excel and use that excel sheet to get data from my application I am getting following error&lt;br&gt;
{"Index was out of range. Must be non-negative and less than the size of the collection.\r\nParameter name: index"}&lt;br&gt;
After downloading the excel and open that excel and hit manually save then I upload that excel then it works fine.
&lt;br&gt;
&lt;strong&gt;Below are the code I used:&lt;/strong&gt; &lt;br&gt;
&lt;pre&gt;&lt;code&gt;  public byte[] DownloadExcel(string path, string tempPath, List&amp;lt;string&amp;gt; SelectedTabs, int colN)
    {
        FileInfo fileInfo = new FileInfo(path);
        File.Copy(path, tempPath, true);
        FileInfo tempFileInfo = new FileInfo(tempPath);
        List&amp;lt;string&amp;gt; workBookName = new List&amp;lt;string&amp;gt;();
        IEnumerator&amp;lt;ExcelWorksheet&amp;gt; workSheets = null;
        ExcelPackage newPackage = null;
        using (newPackage = new ExcelPackage(tempFileInfo))
        {
            using (ExcelPackage package = new ExcelPackage(fileInfo))
            {
                workSheets = package.Workbook.Worksheets.GetEnumerator();
                while (workSheets.MoveNext())
                {
                    ExcelWorksheet xlSheet = workSheets.Current;
                    workBookName.Add(workSheets.Current.Name);

                    if (commonTabList.ContainsIgnoreCase(xlSheet.Name))
                    {
                        //do nothing for the common tab
                        continue;
                    }
                    else if (!SelectedTabs.Contains(xlSheet.Name))
                    {
                        if (!SelectedTabs.Contains(xlSheet.Name.Remove(xlSheet.Name.Length - 1)))
                        {
                            newPackage.Workbook.Worksheets.Delete(workSheets.Current.Name);
                            workBookName.Remove(workSheets.Current.Name);
                        }
                    }
                    else if (xlSheet.Hidden.ToString() == "Hidden")
                    {
                        newPackage.Workbook.Worksheets.Delete(workSheets.Current.Name);
                        workBookName.Remove(workSheets.Current.Name);
                    }
                }
            }
return newPackage.GetAsByteArray();&lt;/code&gt;&lt;/pre&gt;
}&lt;br&gt;
}&lt;br&gt;
&lt;br&gt;
&lt;strong&gt;for getData code:&lt;/strong&gt;&lt;br&gt;
&lt;pre&gt;&lt;code&gt;    public void GetExcel(XmlDocument doc, String path, String templatePathName, String tabNameList = null)
    {
 FileInfo fileInfo = new FileInfo(path);
 FileInfo templateFileInfo = new FileInfo(templatePathName);
     using (ExcelPackage package = new ExcelPackage(fileInfo, templateFileInfo))
        {

// added logic to add corresponding data to excel
     package.save(); _// at this location I am getting exception_
      }
      }
&lt;/code&gt;&lt;/pre&gt;
I see Problem in download excel please let me know suggestions. &lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Mono/Oracle support for EPPlus 4.0">
      <Posts>
        <Post From="littyl" When="03/06/2014 19:17:37">
          <Html>
        &lt;div class="markDownOutput "&gt;Does anyone know if EPPlus will be supported with an oracle/mono environment?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="EPPlus line chart">
      <Posts>
        <Post From="dshrestha" When="03/06/2014 12:11:59">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi,&lt;br&gt;
&lt;br&gt;
Can we change 'Horizontal(Category) Axis' and 'Vertical(Category) Axis' of the line chart? Right now, numbers 1,2,3,4,5,... is displaying in Horizontal(Category) Axis but I want to replace it with Date column.&lt;br&gt;
&lt;br&gt;
Thank you..&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Adding scalable picture">
      <Posts>
        <Post From="philAtkin" When="19/09/2011 16:26:08">
          <Html>
        
&lt;p&gt;I need to add graphs to my worksheet that are beyond what the EPPlus API provides. &amp;nbsp;So I'm using other tools (specifically, MS Chart Controls for .Net) to render the graphs, then transferring them to the worksheet.&lt;/p&gt;
&lt;p&gt;I would like to do this in a manner that provides scalable graphics, so that text and lines are rendered correctly. &amp;nbsp;I've done this by drawing to a metafile, which I can put in a Stream or a file. &amp;nbsp;Unfortunately, it seems that if when add the metafile
 to the worksheet (via a Stream or file and worksheet.Drawings.AddPicture) it gets converted to a JPEG image, which isn't really suitable because of the&amp;nbsp;artifacts and because of the fixed pixel resolution. &amp;nbsp;Relevant here is the comment against the
 ExcelPicture.ImageFormat property, which says "If the picture is created from an Image this type is always Jpeg".&lt;/p&gt;
&lt;p&gt;Is there a way around this? &amp;nbsp;For example, if I save my graph as a metafile (.wmf or .emf), then use Insert...Picture in Excel or OOo Spreadsheet, the graphics are drawn as I require. &amp;nbsp;But I can't find a means to accomplish the same using EPPlus.&lt;/p&gt;
&lt;p&gt;Thanks, Phil&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="20/09/2011 20:16:14">
          <Html>
        
&lt;p&gt;I think the only workaround is to save the file in the format you want and then use the AddPicture method with a FileInfo parameter. Then it is&amp;nbsp;saved in the package depending on the extension of the file.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="SolarFlareSW" When="19/02/2012 02:40:22">
          <Html>
        
&lt;p&gt;[UPDATE] The problem was with the chart control, not EPPlus. &amp;nbsp;I didn't have EnableViewState set on the Chart control, so on the postback the chart image was blank.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Phil:&lt;/p&gt;
&lt;p&gt;I am doing exactly the same thing. &amp;nbsp;However, when I add my images via AddPicture, the images do not display in the worksheet. &amp;nbsp;Can you share the bit of your code wherein you get the images from the chart and save them too the worksheet? &amp;nbsp;Here
 is what I did:&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;span&gt;string&lt;/span&gt; filename = Server.MapPath(&lt;span&gt;"~"&lt;/span&gt;) +
&lt;span&gt;"/"&lt;/span&gt; + uniquefilename;&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;span&gt;if&lt;/span&gt; (chart1.Visible)&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; {&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; chart1.SaveImage(filename, System.Web.UI.DataVisualization.Charting.&lt;span&gt;ChartImageFormat&lt;/span&gt;.Bmp);&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; System.Drawing.&lt;span&gt;Image&lt;/span&gt; imgChart1 =
&lt;span&gt;new&lt;/span&gt; &lt;span&gt;Bitmap&lt;/span&gt;(filename);&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;span&gt;if&lt;/span&gt; (imgChart1 !=
&lt;span&gt;null&lt;/span&gt;)&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; {&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;
&lt;/span&gt;//set picture column width to accommodate the picture&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ws.Column(pictureCol).Width =
&lt;span&gt;ExcelHelper&lt;/span&gt;.Pixel2ColumnWidth(ws, imgChart1.Width + 1);&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;
&lt;/span&gt;//set row height to accommodate the picture&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ws.Row(iCurrentRow).Height =
&lt;span&gt;ExcelHelper&lt;/span&gt;.Pixel2RowHeight(imgChart1.Height + 1);&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;
&lt;span&gt;//add picture to cell&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;
&lt;span&gt;ExcelPicture&lt;/span&gt; pic = ws.Drawings.AddPicture(&lt;span&gt;"pic"&lt;/span&gt; + iCurrentRow.ToString() + pictureCol.ToString(), imgChart1);&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;
&lt;/span&gt;//position picture on desired column&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; pic.From.Column = pictureCol - 1;&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; pic.From.Row = iCurrentRow - 1;&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; pic.From.ColumnOff =
&lt;span&gt;ExcelHelper&lt;/span&gt;.Pixel2MTU(1);&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; pic.From.RowOff =
&lt;span&gt;ExcelHelper&lt;/span&gt;.Pixel2MTU(1);&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;
&lt;/span&gt;//set picture size to fit inside the cell&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; pic.SetSize(imgChart1.Width, imgChart1.Height);&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="philAtkin" When="19/02/2012 13:37:12">
          <Html>
        
&lt;div&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 11pt;"&gt;Do I understand from your update that you’ve solved this yourself?&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 11pt;"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 11pt;"&gt;Phil&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 11pt;"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;div&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 8pt;"&gt;&lt;img width="17" height="17" id="Picture_x0020_1" alt="Description: Logo small" src="cid:image001.jpg@01CCEF0B.9148AE40"&gt;Pixel Analytics is a limited company registered in England&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 8pt;"&gt;Company number: 7747526; Registered office: 93A New Road, Haslingfield, Cambridge CB23 1LP&lt;/span&gt;&lt;span style="font-family:; font-size: 8pt;"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 11pt;"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;div&gt;
&lt;div style="border-width: 1pt medium medium; border-style: solid none none; border-color: rgb(181, 196, 223) currentColor currentColor; padding: 3pt 0cm 0cm; border-image: none;"&gt;
&lt;p&gt;&lt;b&gt;&lt;span lang="EN-US" style="font-family:; font-size: 10pt;"&gt;From:&lt;/span&gt;&lt;/b&gt;&lt;span lang="EN-US" style="font-family:; font-size: 10pt;"&gt; SolarFlareSW [email removed]
&lt;br&gt;
&lt;b&gt;Sent:&lt;/b&gt; 19 February 2012 02:41&lt;br&gt;
&lt;b&gt;To:&lt;/b&gt; phil.atkin@pixelanalytics.co.uk&lt;br&gt;
&lt;b&gt;Subject:&lt;/b&gt; Re: Adding scalable picture [EPPlus:273082]&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 9pt;"&gt;From: SolarFlareSW&lt;/span&gt;&lt;/p&gt;
&lt;div id="ThreadNotificationPostBody" style="margin-bottom: 24pt;"&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 9pt;"&gt;Phil:&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 9pt;"&gt;I am doing exactly the same thing. However, when I add my images via AddPicture, the images do not display in the worksheet. Can you share the bit of your code wherein you get the images from the chart and save
 them too the worksheet? Here is what I did:&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 9pt;"&gt;string filename = Server.MapPath("~") + "/" + uniquefilename;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 9pt;"&gt;if (chart1.Visible)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 9pt;"&gt;{&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 9pt;"&gt;chart1.SaveImage(filename, System.Web.UI.DataVisualization.Charting.ChartImageFormat.Bmp);&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 9pt;"&gt;System.Drawing.Image imgChart1 = new Bitmap(filename);&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 9pt;"&gt;if (imgChart1 != null)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 9pt;"&gt;{&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 9pt;"&gt;//set picture column width to accommodate the picture&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 9pt;"&gt;ws.Column(pictureCol).Width = ExcelHelper.Pixel2ColumnWidth(ws, imgChart1.Width + 1);&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 9pt;"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 9pt;"&gt;//set row height to accommodate the picture&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 9pt;"&gt;ws.Row(iCurrentRow).Height = ExcelHelper.Pixel2RowHeight(imgChart1.Height + 1);&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 9pt;"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 9pt;"&gt;//add picture to cell&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 9pt;"&gt;ExcelPicture pic = ws.Drawings.AddPicture("pic" + iCurrentRow.ToString() + pictureCol.ToString(), imgChart1);&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 9pt;"&gt;//position picture on desired column&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 9pt;"&gt;pic.From.Column = pictureCol - 1;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 9pt;"&gt;pic.From.Row = iCurrentRow - 1;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 9pt;"&gt;pic.From.ColumnOff = ExcelHelper.Pixel2MTU(1);&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 9pt;"&gt;pic.From.RowOff = ExcelHelper.Pixel2MTU(1);&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 9pt;"&gt;//set picture size to fit inside the cell&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 9pt;"&gt;pic.SetSize(imgChart1.Width, imgChart1.Height);&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 9pt;"&gt;} &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 9pt;"&gt;}&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="gumuruh" When="03/06/2014 03:47:23">
          <Html>
        &lt;div class="markDownOutput "&gt;I think i also got the same problem you faced right now . So is it resolved now?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="philAtkin" When="03/06/2014 10:38:48">
          <Html>
        I'm sorry but I'm no longer using this code, and I can't recall what happened. Phil On 03/06/2014 03:47, gumuruh wrote: &amp;gt; &amp;gt; From: gumuruh &amp;gt; &amp;gt; I think i also got the same problem you faced right now . So is it &amp;gt; resolved now? &amp;gt; &amp;gt; Read
 the full discussion online &amp;gt; . &amp;gt; &amp;gt; To add a post to this discussion, reply to this email &amp;gt; ([email removed] &amp;gt; ) &amp;gt; &amp;gt; To start a new discussion for this project, email &amp;gt; [email removed] &amp;gt; &amp;gt; You are receiving this email because you
 subscribed to this discussion &amp;gt; on CodePlex. You can unsubscribe &amp;gt; on &amp;gt; CodePlex.com. &amp;gt; &amp;gt; Please note: Images and attachments will be removed from emails. Any &amp;gt; posts to this discussion will also be available online at CodePlex.com &amp;gt; --
 *Pixel Analytics* is a limited company registered in England. Company number: 7747526; Registered office: 93A New Road, Haslingfield, Cambridge CB23 1LP I'm sorry but I'm no longer using this code, and I can't recall what happened.&lt;br&gt;
Phil&lt;br&gt;
&lt;div&gt;On 03/06/2014 03:47, gumuruh wrote:&lt;br&gt;
&lt;/div&gt;
&lt;blockquote type="cite"&gt;
&lt;p&gt;From: gumuruh&lt;/p&gt;
&lt;div id="ThreadNotificationPostBody"&gt;I think i also got the same problem you faced right now . So is it resolved now?&lt;br&gt;
&lt;/div&gt;
&lt;/blockquote&gt;
&lt;br&gt;
&lt;div&gt;-- &lt;br&gt;
&lt;img width="18" height="18" alt="" src="cid:[email removed]" hspace="5"&gt;&lt;b&gt;Pixel Analytics&lt;/b&gt; is a limited company registered in England. Company number: 7747526; Registered office: 93A New Road, Haslingfield, Cambridge CB23 1LP
&lt;/div&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Header InsertPicture inserts an empty space instead">
      <Posts>
        <Post From="ahb3000" When="01/06/2013 16:44:33">
          <Html>
        &lt;div class="markDownOutput "&gt;I have the fallowing code that inserts a png picture into a the Header of a sheet.
&lt;br&gt;
The issue is that when I open the resultant xlsx in Excel2013 it shows an empty space with the same width and height as the inserted image but there is no image.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;string docsPath = @"[path_to_files]";

var newFileInfo = new FileInfo(docsPath + @"\outout.xlsx");
var templateFileInfo = new FileInfo(docsPath + @"\template.xlsx");
var package = new ExcelPackage(newFileInfo, templateFileInfo);
var sheet = package.Workbook.Worksheets[1];

var qrcodeImage = new Bitmap(docsPath + @"\qrcode.png");
var img = sheet.HeaderFooter.OddHeader.InsertPicture(qrcodeImage, PictureAlignment.Right);
sheet.HeaderFooter.OddHeader.RightAlignedText =
    "&amp;amp;\"Arial,Regular\"&amp;amp;10Sample Header Text\r\n" +
    "&amp;amp;G\r\n" +
    "Date [&amp;amp;D]";
img.Title = "QrCode Image";
img.GrayScale = false;
img.BiLevel = false;
img.Gain = .5;
img.Gamma = .35;
img.Width = 100;
img.Height = 100;

package.Save();&lt;/code&gt;&lt;/pre&gt;
I tried to insert the image manually in Excel and it shows fine. &lt;br&gt;
&lt;br&gt;
Any suggestions?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="ahb3000" When="02/06/2013 10:22:05">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
FYI &lt;br&gt;
I managed to fix the issue by modifying "ExcelVmlDrawingPictureCollection.cs" and adding two lines of code:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;internal ExcelVmlDrawingPicture Add(string id, Uri uri, string name, double width, double height)
{
    XmlNode node = AddImage(id, uri, name, width, height);
    var draw = new ExcelVmlDrawingPicture(node, NameSpaceManager, _ws);
    draw.ImageUri = uri;
    //-----Missing Code-----
    var rel = Part.CreateRelationship(PackUriHelper.GetRelativeUri(Uri, draw.ImageUri), TargetMode.Internal, ExcelPackage.schemaRelationships + "/image");
    draw.RelId = rel.Id;
    //---------------------
    _images.Add(draw);
    return draw;
}&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="gumuruh" When="03/06/2014 03:49:32">
          <Html>
        &lt;div class="markDownOutput "&gt;how can I do that if i'm not using C# instead ... i'm using Vb.net please?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Reading image and other cells">
      <Posts>
        <Post From="nirataro" When="02/06/2014 16:52:18">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
I have rows that contain an image column. I am trying to read the image column as well other columns however the results do not line up.&lt;br&gt;
&lt;pre&gt;&lt;code&gt; var draw = sheets.Drawings[i];
if (draw is ExcelPicture)
{
    var pic = (ExcelPicture)draw;
    object imeiCell = sheets.Cells[i, 4].Value;
    var picInfo = new Tuple&amp;lt;string, ExcelPicture&amp;gt;(imeiCell.ToString(), pic);

    results.Add(picInfo);
&lt;/code&gt;&lt;/pre&gt;
The problem is that sheets.Drawings[i] does not return the correct image where the row i is supposed to be.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Call Save() method recursively">
      <Posts>
        <Post From="tomisy" When="02/06/2014 08:09:39">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi! &lt;br&gt;
&lt;br&gt;
There is existing file with name: app.xlsx. I wold like to save a new xlsx with the same name and path. When the original file is open, then the Save() throws the InvalidOperationException. That is good, but when I catch the exception, then I would like to
 call the saving again, until the user closes the app.xlsx manually, then after he closed the file, the the program continously throws the exception. It is possible to save this problem with EPPLUS?
&lt;br&gt;
Here is my code:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;        public Form1()
        {
            InitializeComponent();
        }

        ExcelPackage package = new ExcelPackage();
            
        private void button1_Click(object sender, EventArgs e)
        {
            ExcelWorksheet wv = package.Workbook.Worksheets.Add("Test Page");
            wv.Cells["A1"].Formula = "SUM(A2:A3)";
            wv.Cells["A2"].Value = 2;
            wv.Cells["A3"].Value = 3;

            wv.Cells["A1"].Calculate();

            Save();

            this.Close();
        }

        private void Save()
        {
            try
            {
                package.SaveAs(new FileInfo("app.xlsx"));
            }
            catch (Exception ex)
            {
                Console.WriteLine(ex.Message);
                Save();
            }
        }&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="formula to refrence a column in another sheet">
      <Posts>
        <Post From="radhanandan" When="27/05/2014 05:27:04">
          <Html>
        &lt;div class="markDownOutput "&gt;I am trying to add a formula to a cell. &lt;br&gt;
I have two sheets 'cover' and 'comment'. &lt;br&gt;
&lt;br&gt;
In comment Sheet column D as values as "P" or "C". &lt;br&gt;
I want to reference a column D of sheet comments in cover sheet. &lt;br&gt;
&lt;br&gt;
I am doing like this &lt;br&gt;
&lt;br&gt;
// Formula ////=COUNTIF(Comment!D:D,"P") &lt;br&gt;
var cellRange = ws.Cells[18, 6]; &lt;br&gt;
ExcelColumn column = workbook.Worksheets[1].Column(4); &lt;br&gt;
cellRange.Formula = string.Format("COUNTIF(Comments!{0}:{1}," + @"""P)""", column, column);&lt;br&gt;
&lt;br&gt;
But getting error - "Object reference not set to an instance of an object."
&lt;br&gt;
&lt;br&gt;
could some one help.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="radhanandan" When="27/05/2014 05:31:44">
          <Html>
        &lt;div class="markDownOutput "&gt;corrected to &lt;br&gt;
&lt;br&gt;
cellRange.Formula = string.Format("COUNTIF(Comments!{0}:{1},\"P\")", column, column);
&lt;br&gt;
&lt;br&gt;
But still getting same above error.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="01/06/2014 06:06:28">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
when you use the variable column as a parameter string.Format I guess it will call the ToString() method on the instance which will return the typename. Or perhaps column is null when you use it in String.Format?
&lt;br&gt;
&lt;br&gt;
In the coming 4.0 version of EPPlus we have added the possibility to get the column letter given an index, but in 3.1 you have to handle that yourself.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Operator for Validation is alway Any.">
      <Posts>
        <Post From="Frans_van_Ek" When="28/05/2014 09:00:08">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi,&lt;br&gt;
&lt;br&gt;
on the vaidation the operator type is Always any. is this a bug?&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
If got an class which retrieves all the validations for a worksheet.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;   private ValidationBase Convert(IExcelDataValidation validationData)
    {


        switch (validationData.ValidationType.Type)
        {
            case eDataValidationType.Custom:
                break;
            case eDataValidationType.DateTime:
                return ConvertToDateTime((ExcelDataValidationDateTime) validationData);

            case eDataValidationType.Decimal:
                break;
            case eDataValidationType.List:
                return ConvertToListValidation((ExcelDataValidationList) validationData);

            case eDataValidationType.TextLength:
                break;
            case eDataValidationType.Time:
                break;
            case eDataValidationType.Whole:
                return ConvertToIntegerValidation((ExcelDataValidationInt)validationData);
            default:
                break;
        }
        return null;
    }

&lt;/code&gt;&lt;/pre&gt;
for the int conversion i've got this function&lt;br&gt;
&lt;pre&gt;&lt;code&gt;    private ValidationGeneric&amp;lt;int?&amp;gt; ConvertToIntegerValidation(ExcelDataValidationInt validationData)
   {     
        int? value1 = GetIntValueFor(validationData.Formula);
        int? value2 = GetIntValueFor(validationData.Formula2);
        return new IntegerValidation().SetMinMaxValue(value1,value2);
    }
&lt;/code&gt;&lt;/pre&gt;
Now i want to extend the functionality. so i can determine if the validation is between. not between..... and so on.
&lt;br&gt;
&lt;br&gt;
but now the operator is alway .any.&lt;br&gt;
&lt;br&gt;
is this a bug?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="01/06/2014 05:55:58">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
yes it is a bug. It was fixed a few weeks ago and will be included in 4.0 which we hope to release soon.
&lt;br&gt;
&lt;br&gt;
Until then you must download and build the latest source code yourself.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to upgroup sheet">
      <Posts>
        <Post From="pongthorn" When="24/06/2010 09:33:00">
          <Html>
        
&lt;p&gt;My project is copy template to multiple worksheet.&amp;nbsp;How to&amp;nbsp;ungroup sheet?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="24/06/2010 09:55:20">
          <Html>
        
&lt;p&gt;Set OutlineLevel=0 on rows and columns.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="pongthorn" When="24/06/2010 10:17:58">
          <Html>
        
&lt;p&gt;It doesn't work . My problem is xxx.xlsx[Group]. when I delete sheet all sheet is deleted.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="27/06/2010 19:52:24">
          <Html>
        
&lt;p&gt;Can you give me an code example of what you are doing, I dont understand whats wrong here.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="marle1" When="08/10/2012 10:12:40">
          <Html>
        
&lt;p&gt;I am experiencing a similar issue when copying sheet inside workbook (or adding by a copy).&lt;/p&gt;
&lt;p&gt;When I edit a cell in the new or old sheet, the same cell in the other sheet is also edited.&lt;/p&gt;
&lt;p&gt;I have tried to set OutlineLevel = 0 on every column and row, but to no effect.&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;package.Workbook.Worksheets.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"Data "&lt;/span&gt; + sI, ws);

ws.Column(3).OutlineLevel = 0;
ws.Row(11).OutlineLevel = 0;
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;I have even tried to set OutlineLevel before and after the copy and on the new and old sheet.&lt;/p&gt;
&lt;p&gt;It seems to me like it should be a property on the sheet level, as I can remove the grouping in Excel on the tab/sheet by right clicking.&lt;/p&gt;
&lt;p&gt;What am I doing wrong guys?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="marle1" When="17/10/2012 08:50:31">
          <Html>
        
&lt;p&gt;Anyone?&lt;/p&gt;
&lt;p&gt;Really need some help on this matter&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="vaxjo" When="31/10/2012 18:20:26">
          <Html>
        
&lt;p&gt;I, too, have experienced this problem. In my situation I have a few separate XSLX files that I programmatically attach to a base workbook. It looks something like this:&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;ExcelPackage basePackage = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(&lt;span style="color: blue;"&gt;new&lt;/span&gt; System.IO.FileInfo(&lt;span style="color: rgb(163, 21, 21);"&gt;"some_file.xlsx"&lt;/span&gt;));
ExcelPackage secondPackage = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(&lt;span style="color: blue;"&gt;new&lt;/span&gt; System.IO.FileInfo(&lt;span style="color: rgb(163, 21, 21);"&gt;"another_file.xlsx"&lt;/span&gt;));
basePackage.Workbook.Worksheets.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"Second"&lt;/span&gt;, secondPackage.Workbook.Worksheets[&lt;span style="color: rgb(163, 21, 21);"&gt;"Second"&lt;/span&gt;]);
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Later on, this workbook (with multiple sheets that have been added from multiple sources) might get downloaded to the end user. When they then open it in Excel each of the sheets are grouped together by default. If they don't notice this (the only indication
 that the sheets are grouped is a subtle shading of the sheet tab name) they will wreak havoc by unknowingly modifying the values of multiple sheets when they mean to edit only one of the sheets.&lt;/p&gt;
&lt;p&gt;Obviously, I would prefer the sheets didn't auto-group themselves together. I haven't investigated this bug very deeply yet; I was hoping to find an easy solution here.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="vaxjo" When="31/10/2012 19:24:10">
          <Html>
        
&lt;p&gt;I may have figured out a fix for this problem. After I add all the disparate worksheets into my base workbook I issue this command:&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;pre&gt;epPackage.Workbook.Worksheets.First().View.TabSelected = true;&lt;/pre&gt;
This forces the first page to be selected which, I guess, causes all of the other pages to become deselected.
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="marle1" When="01/11/2012 10:59:05">
          <Html>
        
&lt;p&gt;Thank you for posting your solution vaxjo.&lt;/p&gt;
&lt;p&gt;I actually deselect every newly added tab, so I cannot confirm that TabSelected = true deselects all other tabs.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="bennyb" When="30/05/2014 20:07:33">
          <Html>
        &lt;div class="markDownOutput "&gt;@vaxjo That worked perfectly. Thx!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Pivot Table Field Settings - Repeat Item Labels">
      <Posts>
        <Post From="seph" When="28/05/2014 20:38:06">
          <Html>
        &lt;div class="markDownOutput "&gt;I'm generating a PivotTable, which has a "Date" RowField. If more than one row has the same date, the date is not repeated on the following rows.
&lt;br&gt;
&lt;br&gt;
The user can change this on the actual pivot table by right clicking somewhere in the column &amp;amp; then clicking "Field Settings"&amp;gt;"Layout &amp;amp; Print" Tab, and then checking "Repeat item labels".
&lt;br&gt;
&lt;br&gt;
Is there a way to select this setting programmatically before generating the PivotTable?
&lt;br&gt;
&lt;br&gt;
Thanks very much&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Can I update excel sheets?">
      <Posts>
        <Post From="piper1977" When="28/05/2014 14:41:20">
          <Html>
        &lt;div class="markDownOutput "&gt;I will make this quick. I have an excel file with 8 sheets, 3 of which I need to import into my C# form. My program takes the 3 sheets from the excel file and imports the 3 sheets onto 3 new tabs on a tabControl. Each new tab also had a dataGridView created
 on it where the information / data from the excel sheets will display in a table.
&lt;br&gt;
&lt;br&gt;
This part I have done and working 100%. I am able to manually change/add text in the fields on the new dataGrids / tables. I want to be able to click a button, and update the changed cells in that original excel file. (I do not want to create an entirely new
 excel sheet because I will then lose the other 5 sheets that I need to keep). Another forum pointed me here to EPPLUS. Can someone explain to me or show me how to do this? Thanks.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Need help with multi-level outlining">
      <Posts>
        <Post From="CoolBreeze812" When="15/05/2013 16:32:18">
          <Html>
        &lt;div class="markDownOutput "&gt;I'm having a really tough time trying to get multi-level outlining applied properly. I have 5 loops of collections that I'm trying to apply outlining to, but it is only placing everything under outline level 1 and ignoring the rest.&lt;br&gt;
&lt;br&gt;
Below is a snippet of what I have:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;foreach (var publisher in Publishers)
{
     worksheet.cells[pubRow, 1].Value = publisher.Name;
     worksheet.Row(pubRow).OutlineLevel = 1;

     foreach (var author in Authors)
     {
          worksheet.cells[authorRow, 2].Value = author.Name;
          worksheet.Row(pubRow).OutlineLevel = 2;

          foreach (var book in Books)
          {
               worksheet.cells[bookRow, 3].Value = book.Title;
               worksheet.cells[bookRow, 4].Value = book.ISBN;
               worksheet.cells[bookRow, 5].Value = book.Edition;
               worksheet.cells[bookRow, 6].Value = book.Pages;
               worksheet.row(bookRow).OutlineLevel = 3;
               bookRow++;
          }
     }
}&lt;/code&gt;&lt;/pre&gt;
Can anyone help?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Kaerwek" When="27/05/2014 08:12:39">
          <Html>
        &lt;div class="markDownOutput "&gt;I'm facing a similar problem. Did you ever solve this, and can you please share how?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Comments copied with row styles?">
      <Posts>
        <Post From="ndevenish" When="23/05/2014 15:08:07">
          <Html>
        &lt;div class="markDownOutput "&gt;When using the 4 beta, the ExcelSheet.InsertRows form with "copyStylesFromRow" the comments in the source row appear to be duplicated.
&lt;br&gt;
&lt;br&gt;
Is this intended? It didn't used to happen and I didn't see anything in the release notes about it.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Pivot Table - Row and Colum Labels">
      <Posts>
        <Post From="rbelknap" When="22/05/2014 18:59:51">
          <Html>
        &lt;div class="markDownOutput "&gt;How do you change the default values of "Row Labels" and "Column Labels" in a pivot table?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Pivot Table Field List">
      <Posts>
        <Post From="rbelknap" When="22/05/2014 18:46:30">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
Is it possible to set the Pivot Table Field List to hidden? &lt;br&gt;
&lt;br&gt;
If yes, would you provide an example. I am having trouble figuring it out.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Read Cell Value">
      <Posts>
        <Post From="Oceanamie" When="22/05/2014 16:04:48">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, all. I am having difficulty trying to read a cell value from a file. Could someone please explain how to do this fully?
&lt;br&gt;
&lt;br&gt;
I have an interface with 5 gauges, and they all read a variable that I can fix at 100, 80, 60, 40, and 20. I want to replace these numbers with five Excel cell value references. Though I can't seem to read the Excel cell value. Please advise me on how to do
 this fully because I've tried it and read sources, but failing.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Getting error while creating new sheet from existing sheet">
      <Posts>
        <Post From="radhanandan" When="21/05/2014 10:36:23">
          <Html>
        &lt;div class="markDownOutput "&gt;I am trying to create a excel sheet from existing one, but getting error&lt;br&gt;
&lt;pre&gt;&lt;code&gt;    public string RunSample22(DirectoryInfo outputDir)
    {
        FileInfo tempFile = new FileInfo(@"F:\bin\Debug\ReportTemplateFile.xlsx");

        // Making a new file 'Sample2.xlsx'
        FileInfo newFile = new FileInfo(@"E:\Test" + @"\Sample22.xlsx");

        if (newFile.Exists)
        {
            newFile.Delete();
            newFile = new FileInfo(outputDir.FullName + @"\Sample22.xls");
        }

        using (ExcelPackage package = new ExcelPackage(newFile, tempFile ))   // getting error in this line
        {
            // Openning first Worksheet of the template file i.e. 'Sample1.xlsx'
            ExcelWorksheet worksheet = package.Workbook.Worksheets[1];

            worksheet.Cells[1, 1].Value = "Test";

            // Save our new workbook
            package.Save();
        }
        return newFile.FullName;
    }

&lt;/code&gt;&lt;/pre&gt;
Error - File contains corrupted data. &lt;br&gt;
&lt;br&gt;
could anyone help me?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Featurerequest">
      <Posts>
        <Post From="ChristianLindenau" When="21/05/2014 09:01:34">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi there,&lt;br&gt;
&lt;br&gt;
first of all a big thank you for this awesome library.&lt;br&gt;
&lt;br&gt;
Could you please implement the functionality into ExcelPicture class, that you are able to set their resizing mode (dependent on the cell position and size and so on). Unfortunately my excelversion is in german, so i have a hard time figuring out, how those
 properties are called.&lt;br&gt;
&lt;br&gt;
Basically I need to create item lists with pictures. When you want to filter those lists, the pictures all get stacked ontop of each other, but dont disappear correctly.
&lt;br&gt;
This can be fixed by manually selecting all pictures after export and set the property of their resize behaviour to be dependend on cellsize and position.&lt;br&gt;
&lt;br&gt;
If this is allready implemented, then please let me know.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Inside Vertical and Horizontal borders - how?">
      <Posts>
        <Post From="GrzesiekP" When="02/10/2012 13:32:02">
          <Html>
        
&lt;p&gt;Hello!&lt;/p&gt;
&lt;p&gt;Can anyone help me and tell how to set inside borders (vertical and horizontal) for selected range?&lt;/p&gt;
&lt;p&gt;Thanks,&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="wrummler" When="20/05/2014 18:59:49">
          <Html>
        &lt;div class="markDownOutput "&gt;I know this is an old post, but in searching for more efficient ways of setting all borders (inner/outer, horizontal/vertical) of a range, I came across it.
&lt;br&gt;
&lt;br&gt;
From what I can tell by the EPPlus documentation and samples, the idiomatic way of doing this is the following (demonstrated with an extension method):&lt;br&gt;
&lt;pre&gt;&lt;code&gt;static void BorderAll(
    this ExcelRangeBase @this,
    ExcelBorderStyle borderStyle)
{
    var border = @this.Style.Border;
    border.Left.Style = borderStyle;
    border.Right.Style = borderStyle;
    border.Top.Style = borderStyle;
    border.Bottom.Style = borderStyle;
}&lt;/code&gt;&lt;/pre&gt;
This will set all inner borders as well as the outer borders of the range. &lt;br&gt;
&lt;br&gt;
On my machine, the above code takes about 4.1 seconds to complete for the range A2:Z6000. To get a little boost in speed (down to about 2.3 seconds over the same test range), I usually use the following implementation:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;static void BorderAll(
    this ExcelRangeBase @this,
    ExcelBorderStyle borderStyle)
{
    var fromRow = @this.Start.Row;
    var fromCol = @this.Start.Column;
    var toRow = @this.End.Row;
    var toCol = @this.End.Column;

    var numRows = toRow - fromRow + 1;
    var numCols = toCol - fromCol + 1;

    @this.Style.Border.BorderAround(borderStyle);

    for (var rowOffset = 1; rowOffset &amp;lt; numRows; rowOffset += 2)
    {
        var row = @this.Offset(rowOffset, 0, 1, numCols);
        row.Style.Border.BorderAround(borderStyle);
    }

    for (var colOffset = 1; colOffset &amp;lt; numCols; colOffset += 2)
    {
        var col = @this.Offset(0, colOffset, numRows, 1);
        col.Style.Border.BorderAround(borderStyle);
    }
}&lt;/code&gt;&lt;/pre&gt;
The above code tries to skip as much range object creation as possible, which is what seems to slow down explicit approaches like this one.
&lt;br&gt;
&lt;br&gt;
The process of setting all these borders seems to be unavoidably slow compared to setting them within Excel. Excel sets all borders on the test range mentioned above almost instantly.
&lt;br&gt;
&lt;br&gt;
Also, I haven't tried Interop.Excel and don't know whether something there might be faster.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Using EPPlus as an enterprise product">
      <Posts>
        <Post From="pgscannell" When="16/05/2014 19:45:24">
          <Html>
        &lt;div class="markDownOutput "&gt;I just downloaded and used EPPlus today and found it to be a tremendous tool. Now I want to convince my boss to put the dll up on our dev, test, and prod servers. He is more than willing to do this, but with a caveat.
&lt;br&gt;
&lt;br&gt;
We only can put third party products on our servers that we have a legal relationship with. Since EPPlus is a free product, that legal relationship is missing.
&lt;br&gt;
&lt;br&gt;
So, what can we do to set such a relationship up so that I can use the product? I should say that being a free product isn't a necessity for us, so if you offer a bundling type of thing where we get notified with enhancements and fixes or other things that
 would be huge. &lt;br&gt;
&lt;br&gt;
Thanks, &lt;br&gt;
Paul&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="18/05/2014 05:44:28">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi Paul, &lt;br&gt;
&lt;br&gt;
EPPlus is open source and the only licence offered by the EPPlus team is LGPL. There is a lot of commercial software available, you could have a look at Aspose Cells or Spreadsheet Gear for example.
&lt;br&gt;
&lt;br&gt;
/Mats&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Could not load file or assembly EPPlus">
      <Posts>
        <Post From="xkubr" When="14/05/2014 20:07:10">
          <Html>
        &lt;div class="markDownOutput "&gt;I have referenced the EPPlus.dll in my project however I am getting the below error:
&lt;br&gt;
“Could not load file or assembly 'EPPlus, Version=2.9.0.1, Culture=neutral, PublicKeyToken=ea159fdaa78159a1' or one of its dependencies. The system cannot find the file specified.”
&lt;br&gt;
&lt;br&gt;
What am I doing wrong? I also tried the latest stable version and the beta and still get the same error.
&lt;br&gt;
&lt;br&gt;
I am using C#, .Net 4.5&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="14/05/2014 20:30:05">
          <Html>
        &lt;div class="markDownOutput "&gt;The only dependency this version of EPPlus has is System.Web.dll. Could it be that you have your project set to the Client Framework? If so you need to change to the "full" framework. This dependency has been removed in version 4.0 which is released
 in beta state.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="xkubr" When="15/05/2014 06:35:59">
          <Html>
        &lt;div class="markDownOutput "&gt;The project is not set to client framework, I am definitely using the full framework. I will try using version 4.0. Thank you.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Save files in Loop">
      <Posts>
        <Post From="Krishn4k" When="14/05/2014 09:57:25">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello ! &lt;br&gt;
&lt;br&gt;
I'm trying to generate Excel files in Loop, I can save my first file, but after that, my header crash and i cannot save other files ...
&lt;br&gt;
&lt;br&gt;
there is my function : &lt;br&gt;
&lt;pre&gt;&lt;code&gt;Function CreerExcel(ByVal val1 As String, ByVal val2 As String, ByVal val3 As String, ByVal val4 As String, ByVal val5 As String)
        'Ouverture de mon fichier Excel existant
        Dim ExistFile = Server.MapPath("~/Styles/Excel/fiche_evaluation.xlsx")
 
        Dim File = New FileInfo(ExistFile)
 
        'Définition du package EPplus
        Using package As New ExcelPackage(File)
            package.Load(New FileStream(ExistFile, FileMode.Open))
 
            'Selection de l'onglet de travail (Excel)
            Dim workSheet As ExcelWorksheet = package.Workbook.Worksheets("Feuil1")
            'Ecriture
            workSheet.Cells("B6").Value = val1
            workSheet.Cells("F6").Value = val2
            workSheet.Cells("C7").Value = val3
            workSheet.Cells("G7").Value = val4
            workSheet.Cells("C8").Value = val5
            'Enregistrement du nouveau fichier
            Response.ContentType = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"
            Response.AddHeader("content-disposition", "attachment;  filename=Eval_" &amp;amp; val1 &amp;amp; "-" &amp;amp; val5 &amp;amp; ".xlsx")
            Response.BinaryWrite(package.GetAsByteArray())
            Response.Flush()
            Response.Clear()
        End Using
 
    End Function&lt;/code&gt;&lt;/pre&gt;
Any idea to solve this ??? &lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="14/05/2014 12:03:11">
          <Html>
        &lt;div class="markDownOutput "&gt;I don´t know how are you doing your loop, but you can't flush several files at once. Maybe you can create all your worksheets on the server, zip them and flush this compress file.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Krishn4k" When="14/05/2014 12:53:12">
          <Html>
        &lt;div class="markDownOutput "&gt;How can I Proceed ? &lt;br&gt;
&lt;br&gt;
I never use VB, or EPPlus before, so i don't know how to work &amp;gt;&amp;lt; &lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="labeling a line graph legend">
      <Posts>
        <Post From="dferguson992" When="09/05/2014 15:48:39">
          <Html>
        &lt;div class="markDownOutput "&gt;I can't seem to figure out how you label the series on a line graph in the legend box. When i create my line chart, I just have a couple colored lines in the legend, but I have no way of labeling each line to the label I want them to have. any one know
 how to do this?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="lagwagon667" When="14/05/2014 10:02:39">
          <Html>
        &lt;div class="markDownOutput "&gt;You can set the series header statically:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;chart.Series[n].Header = "MyCaption";&lt;/code&gt;&lt;/pre&gt;
In the 4.0 Beta 2 it seems it is not possible currently (not working) to assign a cell value as the header address.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="InsertRow problem">
      <Posts>
        <Post From="AdutoitC" When="13/05/2014 16:00:46">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello, im trying to add some rows in a existing spreadsheets. Im using the InsertRow command.
&lt;br&gt;
&lt;br&gt;
The insert is well done, but the problem appears with rows after that. Some formulas stop working.
&lt;br&gt;
&lt;br&gt;
The spreadsheets have xlsx extension. &lt;br&gt;
&lt;br&gt;
Using EPPlus 3.1 : Some formulas totally lost his form, for example, "=SheetName!G20+150" turn into "=I21+I22+I24", not in every cell with formulas it is happening. I find out that it´s always happend in locked cells (with different style
 too). &lt;br&gt;
&lt;br&gt;
EPPlus 4.0 Beta 2: In that case, formulas are well, but the index not to be upgrade at inserting, for example "=SheetName!G20+150" after inserting must be "=SheetName!G21+150" but remains the same.
&lt;br&gt;
&lt;br&gt;
Thanks for attention &lt;br&gt;
&lt;br&gt;
PD: Sorry for my terrible english, i´m still improve it.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Removing conditional formatting from a cell or range">
      <Posts>
        <Post From="cignaciob" When="07/05/2014 19:50:09">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi: Is there any way to remove conditional formatting for a cell or range (other than removing them for the whole sheet)?
&lt;br&gt;
I have tried, clear, delete or copy a cell without formatting, insert or delete rows but the conditional formatting at the address remains unaffected.
&lt;br&gt;
Thanks&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Edit a xltx">
      <Posts>
        <Post From="Krishn4k" When="06/05/2014 10:31:10">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
I'm trying to use EPPLus to edit an Excel Model, I've made it, one page and I wanted to fill it with data extract from a database, and all of that in VB. It's my first time with VB and with Epplus so i'm totaly lost ...
&lt;br&gt;
&lt;br&gt;
Could someone help me ?? &lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Suggestion: Generating random valid xlsx packages for some kind of fuzz testing">
      <Posts>
        <Post From="wrummler" When="05/05/2014 18:11:01">
          <Html>
        &lt;div class="markDownOutput "&gt;If it were feasible to generate random valid xlsx package files, EPPlus's logic for opening and saving could maybe benefit from having some kind of fuzz testing applied to it with files like this.&lt;br&gt;
&lt;br&gt;
One could just open and immediately save the package with EPPlus, then compare the input file's XML directly to the output file's XML.&lt;br&gt;
&lt;br&gt;
This recently popped in my mind when I was trying to pin down a very slippery bug with some cells being unformatted after do-nothing roundtripping through EPPlus.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Use Case copy XLSX worksheet into a workbook">
      <Posts>
        <Post From="breakingbad" When="03/05/2014 04:27:59">
          <Html>
        &lt;div class="markDownOutput "&gt;I have a question on whether this library could be used to &lt;br&gt;
Multiple single workbook excel file in to one multi workbook xlsx file. I have a need to bring multiple xlsx workbooks in to one big xlsx file.
&lt;br&gt;
&lt;br&gt;
I couldn't get a sense from the documentation. &lt;br&gt;
&lt;br&gt;
Thanks for your help. &lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="datetime format issue">
      <Posts>
        <Post From="dcui" When="11/04/2014 02:49:47">
          <Html>
        &lt;div class="markDownOutput "&gt;I've got datetime format issue in my APP. see below sample code, &lt;br&gt;
&lt;br&gt;
sheet.Cells[1, 1].Value = DateTime.Parse("1/1/1900 12:00:00 AM"); &lt;br&gt;
sheet.Column(1).Style.Numberformat.Format = "m/d/yyyy"; &lt;br&gt;
&lt;br&gt;
the cell shows 1/2/1900 instead of 1/1/1900. &lt;br&gt;
&lt;br&gt;
Is it possible to fix it&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="dcui" When="11/04/2014 02:59:53">
          <Html>
        &lt;div class="markDownOutput "&gt;The issue occur only when the year field is 1900. if the year is less than 1900, the excel even could not show it correctly.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Tydude4Christ" When="29/04/2014 21:45:56">
          <Html>
        &lt;div class="markDownOutput "&gt;Please see this article. It explains why there is the issue. &lt;br&gt;
&lt;br&gt;
&lt;a href="http://support.microsoft.com/kb/214326" rel="nofollow"&gt;http://support.microsoft.com/kb/214326&lt;/a&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Column AutoFit With Formulas">
      <Posts>
        <Post From="Tydude4Christ" When="29/04/2014 14:34:20">
          <Html>
        &lt;div class="markDownOutput "&gt;First off, thank you for your hard work on this project. It has helped me greatly.
&lt;br&gt;
&lt;br&gt;
As for my question, I believe I read somewhere that Column AutoFit wouldn't work great due to the lack of formula calculation. With formula calculation being added in 4.0 this should make Column AutoFit work much better. I have seen things improve in my own
 worksheets but still see some "########" here and there. Is there anything else that might need to be added to get this working so that we don't see any "########"?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="29/04/2014 15:01:14">
          <Html>
        &lt;div class="markDownOutput "&gt;Yes, in previous releases it isn't a case of work poorly or greatly, doens't work it all in case of formula because EPPlus don't have a calculation engine.
&lt;br&gt;
&lt;br&gt;
I didn't have time to test this new beta release but I took a look at the code and there was some modifications in AutoFit Method, so if you call formula calculation before autofit, everything should work fine.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Tydude4Christ" When="29/04/2014 18:31:27">
          <Html>
        &lt;div class="markDownOutput "&gt;Thanks. I found the issue with why I was seeing "########". I was populating the Formula property with an equal sign at the beginning which was causing the calculation to fail. I fixed that and now it is running beautifully.&lt;br&gt;
&lt;br&gt;
I just implemented being able to sort on a formula column to my code which would not have been possible without the Formula Calculator. Thanks for those involved in its development.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Smoothed Line VB">
      <Posts>
        <Post From="ClassyBear" When="14/04/2014 10:14:44">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
Every time I add a line graph it sets it as a 'smooth line'. how do I change this so it is a straight line between each point using VB?
&lt;br&gt;
&lt;pre&gt;&lt;code&gt;Dim chtPre = objWorksheetChartPre.Drawings.AddChart("PreLineChart", Chart.eChartType.ColumnClustered)
        chtPre.DisplayBlanksAs = Chart.eDisplayBlanksAs.Gap

        chtPre.Series.Add(ExcelRange.GetFullAddress("Data", "D3:D" &amp;amp; iRow2013.ToString), ExcelRange.GetFullAddress("Data", "A3:A" &amp;amp; iRow2013.ToString)).Header = "score 1"


        chtPre.Title.Text = "Pre Chart"
        chtPre.SetSize(1200, 800)&lt;/code&gt;&lt;/pre&gt;
Thanks&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="ClassyBear" When="14/04/2014 10:18:47">
          <Html>
        &lt;div class="markDownOutput "&gt;&lt;strong&gt;ClassyBear wrote:&lt;/strong&gt;&lt;br&gt;
&lt;blockquote&gt;
&lt;pre&gt;&lt;code&gt;Dim chtPre = objWorksheetChartPre.Drawings.AddChart("PreLineChart", Chart.eChartType.ColumnClustered)
        chtPre.DisplayBlanksAs = Chart.eDisplayBlanksAs.Gap
&lt;/code&gt;&lt;/pre&gt;
&lt;/blockquote&gt;
Where this says Chart.eChartType.ColumnClustered I meant Chart.eChartType.Line. &lt;br&gt;
&lt;br&gt;
Thanks&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="ClassyBear" When="29/04/2014 17:10:41">
          <Html>
        &lt;div class="markDownOutput "&gt;Worked it out. Download the latest version as this was a bug in EPPlus. Also I should have declared chtpost as ExcelLineChart and imported Imports OfficeOpenXml.Drawing.Chart
&lt;br&gt;
&lt;br&gt;
Hope this helps someone else. &lt;br&gt;
&lt;br&gt;
Thanks,&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Array formulas lost when using a template">
      <Posts>
        <Post From="gedl" When="31/08/2011 22:42:51">
          <Html>
        
&lt;p&gt;Hi all,&lt;/p&gt;
&lt;p&gt;First of all I'd like to thank you for your amazing job. Epplus is a really usefull tool.&lt;/p&gt;
&lt;p&gt;I'm opening this discussion to focus on array formulas; not creating them using eeplus but having a template that have them processed by eeplus.&lt;/p&gt;
&lt;p&gt;The steps to reproduce the error is:&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;1 - Create a .xlsx file with an arbitrary number of sheets;&lt;/p&gt;
&lt;p&gt;2 - Put an array formula in one cell of one sheet&lt;/p&gt;
&lt;p&gt;3 - Process the file using it as a template (new ExcelPackage(new FileInfo(path), new FileInfo(templatePath))) and insert an abitrary number of rows on any sheet (not&amp;nbsp;necessarily&amp;nbsp;the sheet containing the array formula)&lt;/p&gt;
&lt;p&gt;4 - The resulting file got its array formulas transformed into regular formulas (which, obviously, don't work anymore)&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;The expected result was to have the formulas intact, since no change was made to the whole sheet (let alone the particular cell containing the array formula)&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Moreover, and I don't know if its supposed to, I checkout the trunk and I got a lot of XML errors while saving the package. I know that the trunk isn't supposed to work all the time but I'm giving the heads up anyway. BTW, I checked it out to see if this
 whole array formulas being transformed in regular formulas problem was already solved.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Did anyone run into this problem as well? Is there a solution/workaround?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I'm using epplus 2.9.0.1 (from here:&amp;nbsp;http://epplus.codeplex.com/releases/view/67324#DownloadId=245824)&lt;/p&gt;
&lt;p&gt;&lt;br&gt;
Best,&lt;/p&gt;
&lt;p&gt;Gonçalo&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="01/09/2011 19:32:23">
          <Html>
        
&lt;p&gt;Ok, I'll have a look at it. I'll get back to you when I have a solution.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="gedl" When="02/09/2011 15:16:52">
          <Html>
        
&lt;p&gt;Hi Jan,&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks for &amp;nbsp;your reply, sounds perfect.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I don't know if it helps, but the same happens with cell properties, border, diagonal. That is, if I set regular (horizontal,vertical) cell borders it works ok but any cells with diagonal border appears without it in the processed file.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Best,&lt;/p&gt;
&lt;p&gt;Gonçalo&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="georges128" When="21/02/2013 08:08:07">
          <Html>
        &lt;div class="markDownOutput "&gt;Any news or correction about this bug ? &lt;br&gt;
Or do you know any tricks allowing to bypass it. &lt;br&gt;
&lt;br&gt;
I have the same problem in Version 3.0.0.2 &lt;br&gt;
&lt;br&gt;
Regards, &lt;br&gt;
&lt;br&gt;
Georges&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="akangels" When="29/04/2014 06:04:33">
          <Html>
        &lt;div class="markDownOutput "&gt;ExcelBorderXml.cs File Modify(version beta 4.02)&lt;br&gt;
&lt;h1&gt;before&lt;/h1&gt;
&lt;pre&gt;&lt;code&gt;internal ExcelBorderXml(XmlNamespaceManager nsm, XmlNode topNode) : base(nsm, topNode)
        {
            _left = new ExcelBorderItemXml(nsm, topNode.SelectSingleNode(leftPath, nsm));
            _right = new ExcelBorderItemXml(nsm, topNode.SelectSingleNode(rightPath, nsm));
            _top = new ExcelBorderItemXml(nsm, topNode.SelectSingleNode(topPath, nsm));
            _bottom = new ExcelBorderItemXml(nsm, topNode.SelectSingleNode(bottomPath, nsm));
            _diagonal = new ExcelBorderItemXml(nsm, topNode.SelectSingleNode(diagonalPath, nsm));
        }&lt;/code&gt;&lt;/pre&gt;
&lt;h1&gt;after&lt;/h1&gt;
&lt;pre&gt;&lt;code&gt;internal ExcelBorderXml(XmlNamespaceManager nsm, XmlNode topNode) : base(nsm, topNode)
        {
            _left = new ExcelBorderItemXml(nsm, topNode.SelectSingleNode(leftPath, nsm));
            _right = new ExcelBorderItemXml(nsm, topNode.SelectSingleNode(rightPath, nsm));
            _top = new ExcelBorderItemXml(nsm, topNode.SelectSingleNode(topPath, nsm));
            _bottom = new ExcelBorderItemXml(nsm, topNode.SelectSingleNode(bottomPath, nsm));
            _diagonal = new ExcelBorderItemXml(nsm, topNode.SelectSingleNode(diagonalPath, nsm));


            /* Get the diagonal part of a bug in the process as follows: Start */
            foreach (XmlAttribute attr in topNode.Attributes) 
            {
                switch (attr.Name)
                {
                    case "diagonalDown":
                        this.DiagonalDown = true;
                        break;
                    case "diagonalUp":
                        this.DiagonalUp = true;
                        break;
                }
            }
            /* Get the diagonal part of a bug in the process as follows: End */
        }&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Need to open and save file in excel before the data is right">
      <Posts>
        <Post From="krillezzz" When="26/04/2014 12:16:34">
          <Html>
        &lt;div class="markDownOutput "&gt;
&lt;pre&gt;&lt;code&gt;public void CreateAnnuityExcelSheet(List&amp;lt;Calculation&amp;gt; cList, FormCollection form, int DTCyear)
        {
            byte[] bytes = null;
            var stream = new MemoryStream();
            List&amp;lt;Calculation&amp;gt; newList = new List&amp;lt;Calculation&amp;gt;();
            newList.Add(cList.First()); //Getting the values for the first row
            var StartValue = newList[0].StartValue;
            var radio = form["advanceOrArrears"];
            string fileName = newList[0].CalculationName;
            string path = @"C:\ExcelFiles\" + fileName + ".xlsx"; //Path for the file
            FileInfo info = new FileInfo(path);
            info.Directory.Create(); //If C:\ExcelFiles does not exist, create it
            if (!info.Exists)
            {
                using (ExcelPackage package = new ExcelPackage(info))
                {
                    ExcelWorksheet ws = package.Workbook.Worksheets.Add(fileName);
                    //Styles for the sheet

                    package.Save();
                }
            }
        }&lt;/code&gt;&lt;/pre&gt;
When I try to open the saved file I need to open it in Excel and then save it, before that it's something wrong with the data. (for example. The file is 6kb when not saved, and after it's 12-13kb).
&lt;br&gt;
&lt;br&gt;
I have also tried using a stream and package.SaveAs(stream) but the result is the same&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="rdeago" When="26/04/2014 20:55:22">
          <Html>
        &lt;div class="markDownOutput "&gt;&lt;strong&gt;krillezzz wrote:&lt;/strong&gt;&lt;br&gt;
&lt;blockquote&gt;When I try to open the saved file I need to open it in Excel and then save it, before that it's something wrong with the data. (for example. The file is 6kb when not saved, and after it's 12-13kb).&lt;br&gt;
&lt;/blockquote&gt;
Are you sure something is actually wrong &lt;em&gt;with the data&lt;/em&gt;?&lt;br&gt;
&lt;br&gt;
The 6kb added to the file size may well be some standard styles and stuff that Excel just likes to add to any file it touches.
&lt;br&gt;
&lt;br&gt;
I've seen something like that before, but the data was unaffected: the file just contained all standard styles after being saved with Excel.&lt;br&gt;
&lt;br&gt;
Furthermore, if you later open the file with a copy of Excel in another language, it re-adds all standard styles again, but with names in the other language, further adding to the file size, but certainly not affecting data in any way.&lt;br&gt;
&lt;br&gt;
If this is not your case, can you clarify, maybe with an actual example of which data are affected and how?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Bug in ExcelWorksheet.Save">
      <Posts>
        <Post From="rdeago" When="26/04/2014 02:52:25">
          <Html>
        &lt;div class="markDownOutput "&gt;Please ignore this thread altogether. I have filed appropriate issues &lt;a href="https://epplus.codeplex.com/workitem/14986" rel="nofollow"&gt;
here&lt;/a&gt;, &lt;a href="https://epplus.codeplex.com/workitem/14987" rel="nofollow"&gt;here&lt;/a&gt; and
&lt;a href="https://epplus.codeplex.com/workitem/14988" rel="nofollow"&gt;here&lt;/a&gt;.&lt;br&gt;
&lt;br&gt;
Maintainer: please feel free to delete this thread. I'd do it myself, but apparently CodePlex won't let me.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="rdeago" When="26/04/2014 03:27:22">
          <Html>
        &lt;div class="markDownOutput "&gt;.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="rdeago" When="26/04/2014 03:48:42">
          <Html>
        &lt;div class="markDownOutput "&gt;.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="rdeago" When="26/04/2014 17:48:38">
          <Html>
        &lt;div class="markDownOutput "&gt;.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Porting to .NET Framework 4.0">
      <Posts>
        <Post From="rdeago" When="26/04/2014 10:25:48">
          <Html>
        &lt;div class="markDownOutput "&gt;How many people are actually using EPPlus under .NET Framework 3.5 any longer?
&lt;br&gt;
&lt;br&gt;
Compiling under .NET Framework 4.0 requires just two small changes to the source code, to use the XmlReaderSettings.DtdProcessing property istead of the obsolete ProhibitDtd. Just substitute&lt;br&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;variable_name&amp;gt;.ProhibitDtd = true;&lt;/code&gt;&lt;/pre&gt;
with&lt;br&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;variable_name&amp;gt;.DtdProcessing = DtdProcessing.Ignore;&lt;/code&gt;&lt;/pre&gt;
(there are just 2 occurrences of that in all EPPlus). &lt;br&gt;
&lt;br&gt;
I'm willing to make a pull request for that, but since I don't want my fork to deviate too much from upstream, I first have to make sure there's actual interest on the maintainers' part.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="rdeago" When="26/04/2014 10:56:54">
          <Html>
        &lt;div class="markDownOutput "&gt;Actually there's a "NET4.0" branch in my fork, should anyone want to give it a try. It seems to work fine for my purposes; I didn't try it with ASP.NET, but all the examples and tests compile without problems, so everyone is welcome to do some
 more testing.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="RepeatRows &amp;amp; RepeatColumns don't work">
      <Posts>
        <Post From="nicopulse" When="13/04/2011 14:35:44">
          <Html>
        
&lt;p&gt;Hi,&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I want to repeat the first rows and columns on each pages on printing.&lt;/p&gt;
&lt;p&gt;I tried this :&amp;nbsp;&lt;/p&gt;
&lt;p&gt;ws.PrinterSettings.RepeatRows = ws.Cells["1:2"];&lt;br&gt;
ws.PrinterSettings.RepeatColumns = ws.Cells["A:G"];&lt;/p&gt;
&lt;p&gt;and this :&lt;/p&gt;
&lt;p&gt;ws.PrinterSettings.RepeatRows = new ExcelAdress("1:2");&lt;br&gt;
ws.PrinterSettings.RepeatColumns = new ExcelAdress("A:G");&lt;/p&gt;
&lt;p&gt;That don't work...&lt;/p&gt;
&lt;p&gt;How to do this ?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="http://www.monsterup.com/upload/1302701673116.png"&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="14/04/2011 15:02:22">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Worked fine for me.&lt;/p&gt;
&lt;p&gt;Pasted this into sample 1...&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;worksheet.PrinterSettings.RepeatRows = worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"1:2"&lt;/span&gt;];
worksheet.PrinterSettings.RepeatColumns = worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A:G"&lt;/span&gt;];
&lt;/pre&gt;
&lt;pre&gt;Can you provide a more detailed example?&lt;/pre&gt;
&lt;pre&gt;Jan&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="dbelmont" When="23/10/2012 12:03:06">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I am experiencing an error with the 'RepeatRows' property too. When I try this:&lt;/p&gt;
&lt;pre&gt;&lt;span style="color: rgb(0, 0, 255);"&gt;sheet.PrinterSettings.RepeatRows&amp;nbsp;=&amp;nbsp;sheet.Cells["1:1"];
sheet.PrinterSettings.RepeatColumns&amp;nbsp;=&amp;nbsp;sheet.Cells["A:D"];&lt;/span&gt;&lt;/pre&gt;
&lt;p&gt;I receive the error message bellow:&lt;/p&gt;
&lt;pre&gt;&lt;span style="color: rgb(255, 0, 0);"&gt;ArgumentOutOfRangeException: Row cannot be less then 1.
Parameter name: value&lt;br&gt;OfficeOpenXml.ExcelCellAddress.set_Row(Int32 value) +97&lt;br&gt;OfficeOpenXml.ExcelCellAddress..ctor(Int32 row, Int32 column) +45&lt;br&gt;OfficeOpenXml.ExcelAddressBase.get_Start() +71&lt;br&gt;OfficeOpenXml.ExcelPrinterSettings.get_RepeatColumns() +120&lt;br&gt;OfficeOpenXml.ExcelPrinterSettings.set_RepeatRows(ExcelAddress value) +157&lt;/span&gt;&lt;/pre&gt;
&lt;p&gt;I am using EPPlus version 3.1.1.0.&lt;/p&gt;
&lt;p&gt;Regards,&lt;br&gt;
David&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="rdeago" When="26/04/2014 03:40:18">
          <Html>
        &lt;div class="markDownOutput "&gt;&lt;strong&gt;jankallman wrote:&lt;/strong&gt;&lt;br&gt;
&lt;blockquote&gt;Hi, Worked fine for me.&lt;br&gt;
&lt;/blockquote&gt;
It's still broken in last build (commit 0ad4f8d82b0c of 2014-04-20). The problem seems to be that the setter for ExcelCellAddress.Row doesn't like column-only addresses like "A:D". The Start (and probably End) getter(s) of ExcelAddressBase should
 probably treat those addresses differently from "normal" range addresses. Just my 2 (Euro-)cents.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Richtext format carry over">
      <Posts>
        <Post From="Epaminaidos" When="25/04/2014 15:31:28">
          <Html>
        &lt;div class="markDownOutput "&gt;Is there any reason, why ExcelRichTextCollection carries the current format over to the next chunk of text?&lt;br&gt;
Example:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;var rtfCollection = worksheet.Cells[1, 1].RichText
var red = rtfCollection.Add("Red");
red.Color = Color.Red;
rtfCollection.Add("Black");&lt;/code&gt;&lt;/pre&gt;
Now the Text "Black" appears in red - even though I did not make any change to the rtfCollection directly, but only to the text that has been added to the collection.&lt;br&gt;
This makes it very hard to write clean code: When passing the rtfCollection to a method in order to add some text, there is no way of knowing, which format-parameters it changes.&lt;br&gt;
And when I add some text on my own afterwards, I need to reset each an every format-parameter just to be sure that I undid every change the method might have made.&lt;br&gt;
Is there any way to make this easier?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="A simple(ish) feature suggestion">
      <Posts>
        <Post From="wtfsven" When="24/04/2014 19:33:31">
          <Html>
        &lt;div class="markDownOutput "&gt;It seems I keep running into situations where it would be very useful to get the
&lt;code&gt;Address&lt;/code&gt; of a given &lt;code&gt;Cell&lt;/code&gt;, specifically when working with a
&lt;code&gt;Table&lt;/code&gt;. Could it be possible to add to the API some methods to give me information about ranges within a
&lt;code&gt;Table&lt;/code&gt;? &lt;br&gt;
&lt;br&gt;
ex:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;int col = myTable.Columns[0].Column;   // the index of the column (within the sheet) that the column resides on.&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to Open a .xlsx large size file">
      <Posts>
        <Post From="jezusz" When="23/04/2014 21:41:04">
          <Html>
        &lt;div class="markDownOutput "&gt;When I am debugging I can open a file of 3 MB.&lt;br&gt;
But now that I just published my project, the server throws this Exception with files of more than 1MB :&lt;br&gt;
&lt;br&gt;
Request for the permission of type 'System.Security.Permissions.IsolatedStorageFilePermission, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' failed&lt;br&gt;
&lt;br&gt;
Just Right after executing pck.Load(New IO.FileInfo(paramPathFile).OpenRead)&lt;br&gt;
&lt;br&gt;
Here is the complete method:&lt;br&gt;
&lt;br&gt;
Public Shared Function ImportFromMsExcel(ByVal paramPathFile As String, ByVal pStartRow As Integer, ByVal pStartColumn As Integer, ByVal pHasHeader As Boolean, Optional ByVal pStartSheet As Integer = 1) As DataSet&lt;br&gt;
&lt;pre&gt;&lt;code&gt;       If paramPathFile.Contains(".xlsx") Then
            Dim ds As New DataSet()
            Dim pck = New OfficeOpenXml.ExcelPackage()
            pck.Load(New IO.FileInfo(paramPathFile).OpenRead)
            If pck.Workbook.Worksheets.Count &amp;lt;&amp;gt; 0 Then
                Dim tbl As New DataTable
                Dim ws = pck.Workbook.Worksheets(pStartSheet)

                Dim hasHeader = pHasHeader

                For Each firstRowCell In ws.Cells(pStartRow, pStartColumn, pStartRow, ws.Dimension.End.Column)
                    tbl.Columns.Add(If(hasHeader, Replace(Replace(firstRowCell.Text.Trim(), Chr(10), ""), Chr(13), ""), String.Format("Column {0}", firstRowCell.Start.Column)))
                Next

                Dim startRow = If(hasHeader, pStartRow + 1, pStartRow)
                For rowNum = startRow To ws.Dimension.End.Row
                    Dim nrow As DataRow = tbl.NewRow()
                    For colNum As Integer = 0 To tbl.Columns.Count - 1
                        nrow(colNum) = ws.Cells(rowNum, colNum + pStartColumn).Text
                    Next
                    tbl.Rows.Add(nrow)
                Next
                ds.Tables.Add(tbl)

            End If
            Return ds
        Else
            Throw New Exception("")
        End If
    End Function
&lt;/code&gt;&lt;/pre&gt;
Does anyone have an idea of what am I missing?&lt;br&gt;
&lt;br&gt;
Thank You!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="24/04/2014 13:14:50">
          <Html>
        &lt;div class="markDownOutput "&gt;Probably you are using EPPlus 3.1, this version is a little tricky to setup your server to work flawless. If you really want to use this version, there is a lot of threads about this.&lt;br&gt;
&lt;br&gt;
I recommend you to try our new beta version, in this new version we are using Dotnetzip instead of Packing.io, so there isn´t issues with IsolatedStorage.&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
EPPlus 4 Beta &lt;a href="https://epplus.codeplex.com/releases/view/118053" rel="nofollow"&gt;
https://epplus.codeplex.com/releases/view/118053&lt;/a&gt; &lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to get the conditional formatting applied to the cell?">
      <Posts>
        <Post From="stetoner" When="24/04/2014 09:22:21">
          <Html>
        &lt;div class="markDownOutput "&gt;I'm decomposing an Excel workbook using EPPlus. One of the worksheets has many existing conditional formatting rules which have been setup in Excel.
&lt;br&gt;
&lt;br&gt;
When iterating over cells I can't seem to locate the attributes which have been altered by the conditional formatting rules although when I save the package and open the Excel file the formatting is applied to the cells.
&lt;br&gt;
&lt;br&gt;
Is it possible to get the values post conditional formatting using EPPlus? For example, one of the rules may check if the value of the cell value is greater than 0.05 and if it is the cell colour is formatted red, otherwise green. I would expect the Cell.Style.Fill.BackgroundColor.Rgb
 property to have a red value.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="No referenced cell's number format becomes 'Percentage'.">
      <Posts>
        <Post From="ent" When="23/04/2014 10:20:07">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
I ran the below code with updating my template workbook by EPPlus 4.0 Beta 2. &lt;br&gt;
&lt;br&gt;
Then, I opened the saved workbook by excel 2010 , its cell format became 'Percentage' by all entire columns except updated column 'A' ,referenced column 'E' and having non-default width columns .&lt;br&gt;
&lt;pre&gt;&lt;code&gt;Dim exp As New ExcelPackage(fi)  'open my Template workbook
Dim wb As ExcelWorkbook = exp.Workbook
Dim sh1 = wb.Worksheets(1)

Console.WriteLine("Check Formula before update: {0}", sh1.Cells(1, 5).Style.Numberformat.Format) 'Reference columns 'E'

sh1.Cells(1, 1).Value = Now ' Update column 'A'

fis = New System.IO.FileInfo("NewPath")
exp.SaveAs(fis)
&lt;/code&gt;&lt;/pre&gt;
It does not occurs using workbook created newly by Excel 2010 . &lt;br&gt;
So , I would like to upload my template file . But I could not find the way.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to find the referenced cells in a formula">
      <Posts>
        <Post From="Frans_van_Ek" When="20/04/2014 15:38:50">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi &lt;br&gt;
&lt;br&gt;
I need to get the referenced Cells in a formula. e.g. the formula = B1 * Average(B2:B6) on worksheet Testing.
&lt;br&gt;
&lt;br&gt;
I want to get a list of absolute cells references. &lt;br&gt;
&lt;br&gt;
so in this case: &lt;br&gt;
&lt;br&gt;
Testing.B1 &lt;br&gt;
Testing.B2:Testen.B6 &lt;br&gt;
&lt;br&gt;
or even better : &lt;br&gt;
&lt;br&gt;
Testing.B1 &lt;br&gt;
Testing.B2 &lt;br&gt;
Testing.B3 &lt;br&gt;
Testing.B4 &lt;br&gt;
Testing.B5 &lt;br&gt;
Testing.B6 &lt;br&gt;
&lt;br&gt;
I saw there is a formulatokens property but is working. &lt;br&gt;
&lt;br&gt;
ExcelPackage._workbook._formulaTokens.Current' threw an exception of type 'System.IndexOutOfRangeException'
&lt;br&gt;
&lt;br&gt;
Has anyone a example of the otherwise i will make a new own solution. &lt;br&gt;
&lt;br&gt;
Regards, &lt;br&gt;
&lt;br&gt;
Frans&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="20/04/2014 21:31:20">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
There are functionality in EPPlus for handling formula tokens, but some of it is internal and nothing is documented so far (I guess you use the 4.0 beta). However the following might work for you:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;var ws = package.Workbook.Worksheets["Testing"];
var tokens = package.Workbook.FormulaParser.Lexer.Tokenize(ws.Cells["B1"].Formula);
var references = tokens.Where(x =&amp;gt; x.TokenType == TokenType.ExcelAddress);
foreach (var reference in references)
{
        var address = reference.Value;
        var excelAddress = new ExcelAddress(address);
}
&lt;/code&gt;&lt;/pre&gt;
The ExcellAddress class from the OfficeOpenXml namespace will give you some data about the referenced cell/range.
&lt;br&gt;
&lt;br&gt;
I am aware that we could expose this in a better way via the EPPlus interfaces, and we might do so in a future release... Hope this helps.
&lt;br&gt;
&lt;br&gt;
/Mats&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Frans_van_Ek" When="22/04/2014 10:11:27">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi Mats,&lt;br&gt;
&lt;br&gt;
thanks for the reply. you are correct, I am using the 4.0.0- Beta2 version. &lt;br&gt;
&lt;br&gt;
Unfortunally the workbook doesn't expose FormulaParser, only the FormulaParserManager. Which in turn doesn't expose a Lexer and no Tokenize in this Lexer.&lt;br&gt;
&lt;br&gt;
Do you know any other way other then wainting for a new release en hoping this feature is part of it?&lt;br&gt;
&lt;br&gt;
Frans&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="22/04/2014 10:35:37">
          <Html>
        &lt;div class="markDownOutput "&gt;Sorry, now I see that the FormulaParser property is Internal. &lt;br&gt;
&lt;br&gt;
Try this instead:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;class Program
    {
        static void Main(string[] args)
        {
            // Open your package here.
            using(var package = new ExcelPackage(new MemoryStream()))
            {
                var provider = new EpplusExcelDataProvider(package);
                var formulaParser = new FormulaParser(provider);
                var tokens = formulaParser.Lexer.Tokenize("B1 * Average(B2:B6)");
                var references = tokens.Where(x =&amp;gt; x.TokenType == TokenType.ExcelAddress);
                foreach(var reference in references)
                {
                    Console.WriteLine(reference.Value);
                }
                Console.ReadKey();
            }
        }
    }&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Frans_van_Ek" When="22/04/2014 10:54:19">
          <Html>
        &lt;div class="markDownOutput "&gt;&lt;strong&gt;swmal wrote:&lt;/strong&gt;&lt;br&gt;
&lt;blockquote&gt;Sorry, now I see that the FormulaParser property is Internal.&lt;br&gt;
&lt;br&gt;
Try this instead:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;class Program
    {
        static void Main(string[] args)
        {
            // Open your package here.
            using(var package = new ExcelPackage(new MemoryStream()))
            {
                var provider = new EpplusExcelDataProvider(package);
                var formulaParser = new FormulaParser(provider);
                var tokens = formulaParser.Lexer.Tokenize("B1 * Average(B2:B6)");
                var references = tokens.Where(x =&amp;gt; x.TokenType == TokenType.ExcelAddress);
                foreach(var reference in references)
                {
                    Console.WriteLine(reference.Value);
                }
                Console.ReadKey();
            }
        }
    }&lt;/code&gt;&lt;/pre&gt;
&lt;/blockquote&gt;
Thanks. I did manage to get the tokens.. Still some work to do on my part, but i can proceed. Thanks a lot.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to change Checkbox value in xlsx?">
      <Posts>
        <Post From="hujg" When="16/04/2014 16:16:46">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi! &lt;br&gt;
I have a template file xlsx with checkbox objects. Is there a way to set values in checkbox? I can't find methods in the library for working with that.
&lt;br&gt;
I tried just to put TRUE/FALSE into LinkedCell, but when I open an edited xlsx it doesn't take the values for setting into checkboxes.
&lt;br&gt;
Thanks.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="c_melgarejo" When="18/04/2014 17:20:04">
          <Html>
        &lt;div class="markDownOutput "&gt;I have the same controls in my template. When adding the value to the cell, set it as a bool value. For example:&lt;br&gt;
&lt;br&gt;
bool isChecked = false;&lt;br&gt;
sheet.Cells["C10"].Value = isChecked;&lt;br&gt;
&lt;br&gt;
Regards.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="ExcelScatterChartSerie markers">
      <Posts>
        <Post From="crazycris84" When="17/04/2014 09:57:20">
          <Html>
        &lt;div class="markDownOutput "&gt;How I can set the marker for an ExcelScatterChartSerie? &lt;br&gt;
Thanks. &lt;br&gt;
It's very urgent!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="crazycris84" When="18/04/2014 08:41:30">
          <Html>
        &lt;div class="markDownOutput "&gt;I would know if it's my error or the library can't permit me change marker of the excelscatterchartserie.
&lt;br&gt;
Please help me.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="WorkSheet Dispose method not working">
      <Posts>
        <Post From="aseghaier" When="16/04/2014 09:36:42">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi,&lt;br&gt;
we are trying to run this code :&lt;br&gt;
&lt;pre&gt;&lt;code&gt;using Ws =pck.workbook.worksheets("MyWs")
' Here Some code
End Using &lt;/code&gt;&lt;/pre&gt;
but we have an exception: The object reference is not set to an instance of an object.&lt;br&gt;
this message appears on the End Using.&lt;br&gt;
if we use this syntax:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;dim ws =pck.workbook.workSheets("MyWs")
' Here some code&lt;/code&gt;&lt;/pre&gt;
the problem appears only when we add Ws.Dispose&lt;br&gt;
&lt;br&gt;
NB: We use the EpPlus 4.0 Library&lt;br&gt;
thanks &lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="17/04/2014 17:14:33">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
Dont use the using statement on worksheet, use it on the ExcelPackage instead. &lt;br&gt;
&lt;br&gt;
/Mats&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="XYScatterSmooth Chart Error">
      <Posts>
        <Post From="crazycris84" When="16/04/2014 09:34:29">
          <Html>
        &lt;div class="markDownOutput "&gt;I have a XYScatterSmooth chart in an Excel file (XLSX). &lt;br&gt;
I insert the chart data in some cells by code behind and the save a file. &lt;br&gt;
When I open the file, the chart's lines are not Smooth. &lt;br&gt;
Any idea?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Worksheet.Drawings is null">
      <Posts>
        <Post From="pwinant" When="15/04/2014 23:00:53">
          <Html>
        &lt;div class="markDownOutput "&gt;I am creating a new ExcelPackage from an existing template. That part is working fine, and I can retrieve the named worksheet. The problems is that the worksheet has a chart in it and I can't retrieve it from the "Drawings" collection using...&lt;br&gt;
&lt;pre&gt;&lt;code&gt;Dim chart As ExcelChart = ws.Drawings("chart1")&lt;/code&gt;&lt;/pre&gt;
... because for some reason that Drawings collection is empty. &lt;br&gt;
&lt;br&gt;
Does anybody know why this would happen?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Getting cell value from forumla">
      <Posts>
        <Post From="tomisy" When="13/04/2014 20:12:05">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi! &lt;br&gt;
&lt;br&gt;
I need a cell value, what defined by a formula. It is possible with epplus? &lt;br&gt;
I need the value from cell(1,1)&lt;br&gt;
&lt;pre&gt;&lt;code&gt;ExcelPackage package = new ExcelPackage();
            ExcelWorksheet ws = package.Workbook.Worksheets.Add("Test Page");

            ws.Cells[2, 1].Value = 1;
            ws.Cells[3, 1].Value = 2;
            ws.Cells[1, 1].Formula = "=SZUM(A2:A3)";

            ws.Calculate();
            ws.Cells[1, 1].Calculate();
            MessageBox.Show(ws.Cells[1,1].Value.ToString());

            package.SaveAs(new FileInfo("app.xlsx"));
            MessageBox.Show("Done");
            Application.Exit();&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="14/04/2014 05:45:31">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
yes, it is possible with EPPlus 4.0 (currently in beta). But you must use the english function names, in your example SUM instead of hungarian SZUM. The localization of function names is something that Excel handles clientside, in the xlsx-file they are always
 in english. &lt;br&gt;
&lt;br&gt;
Also - to improve performance - make sure you call Calculate() only once. &lt;br&gt;
&lt;br&gt;
/Mats&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="tomisy" When="14/04/2014 09:01:15">
          <Html>
        &lt;div class="markDownOutput "&gt;Thanks for your answer awmal, &lt;br&gt;
&lt;br&gt;
It have tried, but I got In the messagebox "#VALUE!" text instead of 5. Here is my new code:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;            ExcelPackage package = new ExcelPackage();
            ExcelWorksheet wv = package.Workbook.Worksheets.Add("Test Page");
            wv.Cells["A1"].Formula = "=SUM(A2:A3)";
            wv.Cells["A2"].Value = 2;
            wv.Cells["A3"].Value = 3;

            wv.Cells["A1"].Calculate();
            MessageBox.Show(wv.Cells["A1"].Value.ToString());

            package.SaveAs(new FileInfo("app.xlsx"));&lt;/code&gt;&lt;/pre&gt;
I need the calculated value from the cell A1. &lt;br&gt;
Thank you very much! &lt;br&gt;
&lt;br&gt;
Tamás&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="14/04/2014 22:36:04">
          <Html>
        &lt;div class="markDownOutput "&gt;I think that you should remove the leading = sign. from your formula. You can also download the samples, to learn more about the new formula calculation engine in epplus.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="tomisy" When="15/04/2014 07:56:01">
          <Html>
        &lt;div class="markDownOutput "&gt;Thank you! It works without the = sign!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Style handing problem">
      <Posts>
        <Post From="psh24" When="09/04/2014 18:08:52">
          <Html>
        &lt;div class="markDownOutput "&gt;
&lt;h2&gt;In Japanese xlsx, cellStyle in styles.xml is not sorted by xfId as following:&lt;/h2&gt;
-&amp;lt;cellStyles count="47"&amp;gt; &lt;br&gt;
&amp;lt;cellStyle xfId="1" customBuiltin="1" hidden="1" builtinId="30" name="20% - アクセント 1"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="2" customBuiltin="1" hidden="1" builtinId="34" name="20% - アクセント 2"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="3" customBuiltin="1" hidden="1" builtinId="38" name="20% - アクセント 3"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="4" customBuiltin="1" hidden="1" builtinId="42" name="20% - アクセント 4"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="5" customBuiltin="1" hidden="1" builtinId="46" name="20% - アクセント 5"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="6" customBuiltin="1" hidden="1" builtinId="50" name="20% - アクセント 6"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="7" customBuiltin="1" hidden="1" builtinId="31" name="40% - アクセント 1"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="8" customBuiltin="1" hidden="1" builtinId="35" name="40% - アクセント 2"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="9" customBuiltin="1" hidden="1" builtinId="39" name="40% - アクセント 3"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="10" customBuiltin="1" hidden="1" builtinId="43" name="40% - アクセント 4"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="11" customBuiltin="1" hidden="1" builtinId="47" name="40% - アクセント 5"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="12" customBuiltin="1" hidden="1" builtinId="51" name="40% - アクセント 6"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="13" customBuiltin="1" hidden="1" builtinId="32" name="60% - アクセント 1"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="14" customBuiltin="1" hidden="1" builtinId="36" name="60% - アクセント 2"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="15" customBuiltin="1" hidden="1" builtinId="40" name="60% - アクセント 3"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="16" customBuiltin="1" hidden="1" builtinId="44" name="60% - アクセント 4"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="17" customBuiltin="1" hidden="1" builtinId="48" name="60% - アクセント 5"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="18" customBuiltin="1" hidden="1" builtinId="52" name="60% - アクセント 6"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="19" customBuiltin="1" hidden="1" builtinId="29" name="アクセント 1"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="20" customBuiltin="1" hidden="1" builtinId="33" name="アクセント 2"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="21" customBuiltin="1" hidden="1" builtinId="37" name="アクセント 3"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="22" customBuiltin="1" hidden="1" builtinId="41" name="アクセント 4"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="23" customBuiltin="1" hidden="1" builtinId="45" name="アクセント 5"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="24" customBuiltin="1" hidden="1" builtinId="49" name="アクセント 6"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="25" customBuiltin="1" hidden="1" builtinId="15" name="タイトル"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="26" customBuiltin="1" hidden="1" builtinId="23" name="チェック セル"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="27" customBuiltin="1" hidden="1" builtinId="28" name="どちらでもない"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="46" hidden="1" builtinId="5" name="パーセント"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="28" customBuiltin="1" hidden="1" builtinId="10" name="メモ"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="29" customBuiltin="1" hidden="1" builtinId="24" name="リンク セル"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="30" customBuiltin="1" hidden="1" builtinId="27" name="悪い"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="31" customBuiltin="1" hidden="1" builtinId="22" name="計算"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="32" customBuiltin="1" hidden="1" builtinId="11" name="警告文"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="43" hidden="1" builtinId="6" name="桁区切り"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="42" hidden="1" builtinId="3" name="桁区切り [0.00]"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="33" customBuiltin="1" hidden="1" builtinId="16" name="見出し 1"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="34" customBuiltin="1" hidden="1" builtinId="17" name="見出し 2"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="35" customBuiltin="1" hidden="1" builtinId="18" name="見出し 3"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="36" customBuiltin="1" hidden="1" builtinId="19" name="見出し 4"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="37" customBuiltin="1" hidden="1" builtinId="25" name="集計"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="38" customBuiltin="1" hidden="1" builtinId="21" name="出力"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="39" customBuiltin="1" hidden="1" builtinId="53" name="説明文"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="45" hidden="1" builtinId="7" name="通貨"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="44" hidden="1" builtinId="4" name="通貨 [0.00]"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="40" customBuiltin="1" hidden="1" builtinId="20" name="入力"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="0" builtinId="0" name="標準"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="41" customBuiltin="1" hidden="1" builtinId="26" name="良い"/&amp;gt;&lt;br&gt;
&lt;h2&gt;&amp;lt;/cellStyles&amp;gt;&lt;/h2&gt;
&lt;h2&gt;After saveAs, xfId is renumbered as following:&lt;/h2&gt;
-&amp;lt;cellStyles count="47"&amp;gt; &lt;br&gt;
&amp;lt;cellStyle xfId="0" customBuiltin="1" builtinId="30" name="20% - アクセント 1"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="1" customBuiltin="1" builtinId="34" name="20% - アクセント 2"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="2" customBuiltin="1" builtinId="38" name="20% - アクセント 3"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="3" customBuiltin="1" builtinId="42" name="20% - アクセント 4"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="4" customBuiltin="1" builtinId="46" name="20% - アクセント 5"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="5" customBuiltin="1" builtinId="50" name="20% - アクセント 6"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="6" customBuiltin="1" builtinId="31" name="40% - アクセント 1"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="7" customBuiltin="1" builtinId="35" name="40% - アクセント 2"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="8" customBuiltin="1" builtinId="39" name="40% - アクセント 3"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="9" customBuiltin="1" builtinId="43" name="40% - アクセント 4"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="10" customBuiltin="1" builtinId="47" name="40% - アクセント 5"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="11" customBuiltin="1" builtinId="51" name="40% - アクセント 6"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="12" customBuiltin="1" builtinId="32" name="60% - アクセント 1"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="13" customBuiltin="1" builtinId="36" name="60% - アクセント 2"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="14" customBuiltin="1" builtinId="40" name="60% - アクセント 3"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="15" customBuiltin="1" builtinId="44" name="60% - アクセント 4"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="16" customBuiltin="1" builtinId="48" name="60% - アクセント 5"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="17" customBuiltin="1" builtinId="52" name="60% - アクセント 6"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="18" customBuiltin="1" builtinId="29" name="アクセント 1"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="19" customBuiltin="1" builtinId="33" name="アクセント 2"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="20" customBuiltin="1" builtinId="37" name="アクセント 3"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="21" customBuiltin="1" builtinId="41" name="アクセント 4"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="22" customBuiltin="1" builtinId="45" name="アクセント 5"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="23" customBuiltin="1" builtinId="49" name="アクセント 6"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="24" customBuiltin="1" builtinId="15" name="タイトル"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="25" customBuiltin="1" builtinId="23" name="チェック セル"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="26" customBuiltin="1" builtinId="28" name="どちらでもない"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="27" builtinId="5" name="パーセント"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="28" customBuiltin="1" builtinId="10" name="メモ"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="29" customBuiltin="1" builtinId="24" name="リンク セル"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="30" customBuiltin="1" builtinId="27" name="悪い"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="31" customBuiltin="1" builtinId="22" name="計算"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="32" customBuiltin="1" builtinId="11" name="警告文"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="33" builtinId="6" name="桁区切り"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="34" builtinId="3" name="桁区切り [0.00]"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="35" customBuiltin="1" builtinId="16" name="見出し 1"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="36" customBuiltin="1" builtinId="17" name="見出し 2"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="37" customBuiltin="1" builtinId="18" name="見出し 3"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="38" customBuiltin="1" builtinId="19" name="見出し 4"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="39" customBuiltin="1" builtinId="25" name="集計"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="40" customBuiltin="1" builtinId="21" name="出力"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="41" customBuiltin="1" builtinId="53" name="説明文"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="42" builtinId="7" name="通貨"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="43" builtinId="4" name="通貨 [0.00]"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="44" customBuiltin="1" builtinId="20" name="入力"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="45" builtinId="0" name="標準"/&amp;gt;
&lt;br&gt;
&amp;lt;cellStyle xfId="46" customBuiltin="1" builtinId="26" name="良い"/&amp;gt;&lt;br&gt;
&lt;h2&gt;&amp;lt;/cellStyles&amp;gt;&lt;/h2&gt;
So, all cells with default style will have buildinId=30 background color. &lt;br&gt;
&lt;br&gt;
xfId shouldn't be renumbered or internal list should be initially sorted by xfId.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="psh24" When="09/04/2014 18:27:52">
          <Html>
        &lt;div class="markDownOutput "&gt;
&lt;h2&gt;following change in ExcelStyles.cs works fine for me.&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;        //cellStyle
        XmlNode namedStyleNode = _styleXml.SelectSingleNode(CellStylesPath, _nameSpaceManager);
        if (namedStyleNode != null)
        {
            foreach (XmlNode n in namedStyleNode)
            {
                ExcelNamedStyleXml item = new ExcelNamedStyleXml(_nameSpaceManager, n, this);
                NamedStyles.Add(item.Name, item);
            }

            NamedStyles.Sort((x, y) =&amp;gt; x.StyleXfId.CompareTo(y.StyleXfId)); // ... added&lt;/code&gt;&lt;/pre&gt;
&lt;h2&gt;}&lt;/h2&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="13/04/2014 18:05:04">
          <Html>
        &lt;div class="markDownOutput "&gt;Thanks, we will have a look on this. &lt;br&gt;
&lt;br&gt;
/Mats&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Error after publish">
      <Posts>
        <Post From="AllenLin" When="11/04/2014 03:55:39">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi,&lt;br&gt;
&lt;pre&gt;&lt;code&gt; I've developed a report with Epplus 3.1,  it run normal on my development environment (windows xp), but after publish, runs on windows server 2008 r2, the report is generate success, but when i open it, it throw an error as below:&lt;/code&gt;&lt;/pre&gt;
&lt;img alt="Image" src="http://c.hiphotos.baidu.com/image/w%3D2048%3Bq%3D90/sign=12fc8fbe4334970a4773172fa1f2eab9/622762d0f703918f1ac37a5b533d269759eec415.jpg"&gt;&lt;br&gt;
&lt;br&gt;
Excel was able to open the file by reparing or removing the unreadable conten.&lt;br&gt;
Excel completed file level validation and repair. Some parts of this workbook may have been repaired or discarded.&lt;br&gt;
Replaced Part:/xl/worksheets/sheet10.xml part with XML error. Unexpected end of input.&lt;br&gt;
Line1, conlumn 96171.&lt;br&gt;
&lt;pre&gt;&lt;code&gt; And this issue always happen on the last sheet! no matter how many sheet in this excel report!&lt;/code&gt;&lt;/pre&gt;
For example, if sheet2 is the last sheet, if will generate with error. then try to add another sheet named sheet3, this error will occur on sheet3 but sheet2 is normal.&lt;br&gt;
&lt;pre&gt;&lt;code&gt; So, who can help me ?&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="AllenLin" When="11/04/2014 03:57:27">
          <Html>
        &lt;div class="markDownOutput "&gt;And this issue always happen on the last sheet! no matter how many sheet in this excel report!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="13/04/2014 18:00:20">
          <Html>
        &lt;div class="markDownOutput "&gt;You can try to rename the generated excel file from &lt;em&gt;.xlsx to &lt;/em&gt;.zip (change the file extension) then open the zip file and navigate to the sheet, for example /xl/worksheets/sheet10.xml. Then open the sheet xml file in an xml editor of your choice
 and you will hopefully be able see the error. &lt;br&gt;
&lt;br&gt;
/Mats&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to use EPPlus to run a macro code?">
      <Posts>
        <Post From="freecode2012" When="11/04/2014 13:47:54">
          <Html>
        &lt;div class="markDownOutput "&gt;I can use Microsoft.Office.Interop.Excel lib to run macro like this: &lt;br&gt;
CurrentWorkbook.Application.Run(macroName); &lt;br&gt;
&lt;br&gt;
May I know to to run macro using EPPlus? &lt;br&gt;
&lt;br&gt;
Thanks, &lt;br&gt;
Rock&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="13/04/2014 17:55:11">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
no, you need Excel to do that. &lt;br&gt;
&lt;br&gt;
Cheers, &lt;br&gt;
&lt;br&gt;
Mats&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="AddComment issue with EpPlus 4.0 Beta DLL">
      <Posts>
        <Post From="aseghaier" When="07/04/2014 15:38:08">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
We have a problem to add comments to cells with the EPPLUS 4.0 Beta library. &lt;br&gt;
After adding comments, the saving file generate a streaming exception. &lt;br&gt;
the exception message is : Memory stream is not expandable. &lt;br&gt;
NB: we used the FileInfo class &lt;br&gt;
this issue is not appearing with the 3.1 build &lt;br&gt;
we can't use the 3.1 build because there is an issue when using it in an ACCESS application.
&lt;br&gt;
best regards&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="JanKallman" When="09/04/2014 11:40:20">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
I havn't seen this behaviour. &lt;br&gt;
Please add an issue with some code to reproduce this problem, so I can have a look at it.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="aseghaier" When="10/04/2014 12:19:38">
          <Html>
        &lt;div class="markDownOutput "&gt;hello, &lt;br&gt;
the problem is solved. &lt;br&gt;
we have two excel WorkSheets. the first is used to extract the comments and we want copied into the second one.
&lt;br&gt;
with the EPPLUS 4.0 Library, if we run this code:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;
  Dim dicToolTip As Dictionary(Of String, String) = Nothing
        Using pck As New ExcelPackage(New FileInfo(My.Application.Info.DirectoryPath &amp;amp; "\TestComment.xlsx"))
            Dim ws1 = pck.Workbook.Worksheets(1)
            Dim IMyLastColFirstWs = ws1.Cells.AsEnumerable.Where(Function(f) f.Value = "MyCol").Select(Function(f) f.Start.Column).FirstOrDefault
            Dim rngToolTip = ws1.Cells(1, 1, 1, IMyLastColFirstWs)
            dicToolTip = rngToolTip.ToDictionary(Function(f) f.Value.ToString, Function(f) f.Comment.Text)
            Dim ws = pck.Workbook.Worksheets(2)
            Dim iMyLastColSecondWs = ws.Cells.AsEnumerable.Where(Function(f) f.Value = "MyCol").Select(Function(f) f.Start.Column).Max
            Dim rng = ws.Cells(1, 1, 1, iMyLastColSecondWs)
            Dim i = 1
            For Each c In rng
                If c.Value IsNot Nothing Then
                    Dim cellComment As String = Nothing
                    If dicToolTip.TryGetValue(c.Value, cellComment) Then
                        c.AddComment(cellComment, Nothing)
                        c.Comment.AutoFit = True
                    End If
                End If
            Next
            Dim fi = New FileInfo(My.Application.Info.DirectoryPath &amp;amp; "\TestComment_After.xlsx")
            If fi.Exists Then fi.Delete()
            pck.SaveAs(fi)
        End Using&lt;/code&gt;&lt;/pre&gt;
we have the exception message : Memory stream is not expandable. &lt;br&gt;
&lt;br&gt;
But if we run this code:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;
 Dim dicToolTip As Dictionary(Of String, String) = Nothing
 
            Using pck As New ExcelPackage(New FileInfo(My.Application.Info.DirectoryPath &amp;amp; "\TestComment.xlsx"))
                Dim ws1 = pck.Workbook.Worksheets(1)
                Dim IMyLastColFirstWs = ws1.Cells.AsEnumerable.Where(Function(f) f.Value = "MyCol").Select(Function(f) f.Start.Column).FirstOrDefault
                Dim rngToolTip = ws1.Cells(1, 1, 1, IMyLastColFirstWs)
                dicToolTip = rngToolTip.ToDictionary(Function(f) f.Value.ToString, Function(f) f.Comment.Text)
            End Using
            
            Using pck1 As New ExcelPackage(New FileInfo(My.Application.Info.DirectoryPath &amp;amp; "\TestComment.xlsx"))
                Dim ws = pck1.Workbook.Worksheets(2)
                Dim iMyLastColSecondWs = ws.Cells.AsEnumerable.Where(Function(f) f.Value = "MyCol").Select(Function(f) f.Start.Column).Max
                Dim rng = ws.Cells(1, 1, 1, iMyLastColSecondWs)
                Dim i = 1
                For Each c In rng
                    If c.Value IsNot Nothing Then
                        Dim cellComment As String = Nothing
                        If dicToolTip.TryGetValue(c.Value, cellComment) Then
                            c.AddComment(cellComment, Nothing)
                            c.Comment.AutoFit = True
                        End If
                    End If
                Next
                Dim fi = New FileInfo(My.Application.Info.DirectoryPath &amp;amp; "\TestComment_After.xlsx")
                If fi.Exists Then fi.Delete()
                pck1.SaveAs(fi)
            End Using&lt;/code&gt;&lt;/pre&gt;
Everything is now ok. &lt;br&gt;
&lt;br&gt;
NB: with the first code we do not have the exception message with the 3.1 version.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Clustered Columns - Overlapping">
      <Posts>
        <Post From="Vik" When="10/04/2014 00:39:31">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
First off, thanks for the awesome work!&lt;br&gt;
&lt;br&gt;
I'm running into an issue with clustered column charts overlapping each other when used in combination with line chart. I set the column chart to use secondary axis and it renders ok, however the column with higher number is overshadowing the other series data.&lt;br&gt;
&lt;br&gt;
In Excel, once I toggle the Primary and Secondary axis radio button, they are being separated.
&lt;br&gt;
&lt;br&gt;
What could be the issue and how to resolve this?&lt;br&gt;
&lt;pre&gt;&lt;code&gt; var testchart = testchartworksheet.Drawings.AddChart("chart1", eChartType.LineMarkers);
                   
                     //Set position and size
                     testchart.SetPosition(0, 430);
                     testchart.SetSize(1000, 600);
switch (medp[0].ChartType)
                         {
                             case  "Individual":
                                 var testchartType3 = testchart.PlotArea.ChartTypes.Add(eChartType.ColumnClustered);
                                testchartType3.Series.Add(testworksheet.Cells[thisExcelRange], testworksheet.Cells[ARangeSeqInit]);                                              
                                testchartType3.UseSecondaryAxis = true;                                                       
                          break;
                             case "Cumulative":
                                  var testchartType4 = testchart.PlotArea.ChartTypes.Add(eChartType.LineMarkers);                    
                    testchartType4.Series.Add(testworksheet.Cells[thisExcelRange], testworksheet.Cells[ARangeSeqInit]);
                    
                                 break;
                             default:
                                 break;
                         }&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Vik" When="10/04/2014 01:17:12">
          <Html>
        &lt;div class="markDownOutput "&gt;I'm able to duplicate the issue in sample files. Here is the Sample9.cs file which loads ClusteredColumn in LoadFile2 method. If you swap the Sample9.cs with this one and run the console app, sample9.xlxs sheet Csv2 has the bug I mentioned in above post.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;/*******************************************************************************
 * You may amend and distribute as you like, but don't remove this header!
 * 
 * All rights reserved.
 * 
 * EPPlus is an Open Source project provided under the 
 * GNU General Public License (GPL) as published by the 
 * Free Software Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA
 * 
 * EPPlus provides server-side generation of Excel 2007 spreadsheets.
 * See http://www.codeplex.com/EPPlus for details.
 *
 *
 * 
 * The GNU General Public License can be viewed at http://www.opensource.org/licenses/gpl-license.php
 * If you unfamiliar with this license or have questions about it, here is an http://www.gnu.org/licenses/gpl-faq.html
 * 
 * The code for this project may be used and redistributed by any means PROVIDING it is 
 * not sold for profit without the author's written consent, and providing that this notice 
 * and the author's name and all copyright notices remain intact.
 * 
 * All code and executables are provided "as is" with no warranty either express or implied. 
 * The author accepts no liability for any damage or loss of business that this product may cause.
 *
 *
 * Code change notes:
 * 
 * Author                           Change                      Date
 *******************************************************************************
 * Jan Källman      Added       28 Oct 2010
 *******************************************************************************/
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using OfficeOpenXml;
using System.IO;
using OfficeOpenXml.Table;
using OfficeOpenXml.Drawing.Chart;
using System.Globalization;
namespace EPPlusSamples
{
    /// &amp;lt;summary&amp;gt;
    /// This sample shows how to load CSV files using the LoadFromText method, how to use tables and
    /// how to use charts with more than one charttype and secondary axis
    /// &amp;lt;/summary&amp;gt;
    public static class Sample9
    {
        /// &amp;lt;summary&amp;gt;
        /// Loads two CSV files into tables and adds a chart to each sheet.
        /// &amp;lt;/summary&amp;gt;
        /// &amp;lt;param name="outputDir"&amp;gt;&amp;lt;/param&amp;gt;
        /// &amp;lt;returns&amp;gt;&amp;lt;/returns&amp;gt;
        public static string RunSample9(DirectoryInfo outputDir)
        {
            FileInfo newFile = new FileInfo(outputDir.FullName + @"\sample9.xlsx");
            if (newFile.Exists)
            {
                newFile.Delete();  // ensures we create a new workbook
                newFile = new FileInfo(outputDir.FullName + @"\sample9.xlsx");
            }
            
            using (ExcelPackage package = new ExcelPackage())
            {
                LoadFile1(package);
                LoadFile2(package);

                package.SaveAs(newFile);
            }
            return newFile.FullName;
        }
        private static void LoadFile1(ExcelPackage package)
        {
            //Create the Worksheet
            var sheet = package.Workbook.Worksheets.Add("Csv1");

            //Create the format object to describe the text file
            var format = new ExcelTextFormat();
            format.TextQualifier = '"';
            format.SkipLinesBeginning = 2;
            format.SkipLinesEnd = 1;

            //Now read the file into the sheet. Start from cell A1. Create a table with style 27. First row contains the header.
            Console.WriteLine("Load the text file...");
            var range = sheet.Cells["A1"].LoadFromText(new FileInfo("..\\..\\csv\\Sample9-1.txt"), format, TableStyles.Medium27, true);

            Console.WriteLine("Format the table...");
            //Tables don't support custom styling at this stage(you can of course format the cells), but we can create a Namedstyle for a column...
            var dateStyle = package.Workbook.Styles.CreateNamedStyle("TableDate");
            dateStyle.Style.Numberformat.Format = "YYYY-MM";

            var numStyle = package.Workbook.Styles.CreateNamedStyle("TableNumber");
            numStyle.Style.Numberformat.Format = "#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.0";

            //Now format the table...
            var tbl = sheet.Tables[0];
            tbl.ShowTotal = true;
            tbl.Columns[0].TotalsRowLabel = "Total";
            tbl.Columns[0].DataCellStyleName = "TableDate";
            tbl.Columns[1].TotalsRowFunction = RowFunctions.Sum;
            tbl.Columns[1].DataCellStyleName = "TableNumber";
            tbl.Columns[2].TotalsRowFunction = RowFunctions.Sum;
            tbl.Columns[2].DataCellStyleName = "TableNumber";
            tbl.Columns[3].TotalsRowFunction = RowFunctions.Sum;
            tbl.Columns[3].DataCellStyleName = "TableNumber";
            tbl.Columns[4].TotalsRowFunction = RowFunctions.Sum;
            tbl.Columns[4].DataCellStyleName = "TableNumber";
            tbl.Columns[5].TotalsRowFunction = RowFunctions.Sum;
            tbl.Columns[5].DataCellStyleName = "TableNumber";
            tbl.Columns[6].TotalsRowFunction = RowFunctions.Sum;
            tbl.Columns[6].DataCellStyleName = "TableNumber";

            Console.WriteLine("Create the chart...");
            //Now add a stacked areachart...
            var chart = sheet.Drawings.AddChart("chart1", eChartType.AreaStacked);
            chart.SetPosition(0, 630);
            chart.SetSize(800, 600);

            //Create one series for each column...
            for (int col = 1; col &amp;lt; 7; col++)
            {
                var ser = chart.Series.Add(range.Offset(1, col, range.End.Row - 1, 1), range.Offset(1, 0, range.End.Row - 1, 1));
                ser.HeaderAddress = range.Offset(0, col, 1, 1);
            }
            
            //Set the style to 27.
            chart.Style = eChartStyle.Style27;

            sheet.View.ShowGridLines = false;
            sheet.Cells[sheet.Dimension.Address].AutoFitColumns();
        }

        private static void LoadFile2(ExcelPackage package)
        {
            //Create the Worksheet
            var sheet = package.Workbook.Worksheets.Add("Csv2");

            //Create the format object to describe the text file
            var format = new ExcelTextFormat();
            format.Delimiter='\t'; //Tab
            format.SkipLinesBeginning = 1;
            CultureInfo ci = new CultureInfo("sv-SE");          //Use your choice of Culture
            ci.NumberFormat.NumberDecimalSeparator = ",";       //Decimal is comma
            format.Culture = ci;

            //Now read the file into the sheet.
            Console.WriteLine("Load the text file...");
            var range = sheet.Cells["A1"].LoadFromText(new FileInfo("..\\..\\csv\\Sample9-2.txt"), format);

            //Add a formula
            range.Offset(1, range.End.Column, range.End.Row - range.Start.Row, 1).FormulaR1C1 = "RC[-1]-RC[-2]";

            //Add a table...
            var tbl = sheet.Tables.Add(range.Offset(0,0,range.End.Row-range.Start.Row+1, range.End.Column-range.Start.Column+2),"Table");
            tbl.ShowTotal = true;
            tbl.Columns[0].TotalsRowLabel = "Total";
            tbl.Columns[1].TotalsRowFormula = "COUNT(3,[Product])";    //Add a custom formula
            tbl.Columns[2].TotalsRowFunction = RowFunctions.Sum;
            tbl.Columns[3].TotalsRowFunction = RowFunctions.Sum;
            tbl.Columns[4].TotalsRowFunction = RowFunctions.Sum;
            tbl.Columns[5].TotalsRowFunction = RowFunctions.Sum;
            tbl.Columns[5].Name = "Profit";
            tbl.TableStyle = TableStyles.Medium10;

            sheet.Cells[sheet.Dimension.Address].AutoFitColumns();

            //Add a chart with column type.
            var chart = sheet.Drawings.AddChart("chart2", eChartType.ColumnClustered);
            chart.SetPosition(0, 540);
            chart.SetSize(800, 600);
        
            //var serie1= chart.Series.Add(range.Offset(1, 3, range.End.Row - 1, 1), range.Offset(1, 1, range.End.Row - 1, 1));
            //serie1.Header = "Purchase Price";
            //var serie2 = chart.Series.Add(range.Offset(1, 5, range.End.Row - 1, 1), range.Offset(1, 1, range.End.Row - 1, 1));
            //serie2.Header = "Profit";

            //Add a Column series
            var chartType2 = chart.PlotArea.ChartTypes.Add(eChartType.ColumnClustered);
            chartType2.UseSecondaryAxis = true;
            var serie3 = chartType2.Series.Add(range.Offset(1, 2, range.End.Row - 1, 1), range.Offset(1, 0, range.End.Row - 1, 1));
            serie3.Header = "Items in stock";


            var chartType4 = chart.PlotArea.ChartTypes.Add(eChartType.ColumnClustered);
            chartType4.UseSecondaryAxis = true;
            var serie4 = chartType4.Series.Add(range.Offset(1, 5, range.End.Row - 1, 1), range.Offset(1, 1, range.End.Row - 1, 1));
            serie4.Header = "Profit";

            //By default the secondary XAxis is not visible, but we want to show it...
            chartType2.XAxis.Deleted = false;
            chartType2.XAxis.TickLabelPosition = eTickLabelPosition.High;
            
            //Set the max value for the Y axis...
            chartType2.YAxis.MaxValue = 50;

            chart.Style = eChartStyle.Style26;
            sheet.View.ShowGridLines = false;
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="hide Partial Results in Pivot Table">
      <Posts>
        <Post From="trauschauwem" When="23/09/2013 13:27:13">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello together,&lt;br&gt;
&lt;br&gt;
I'm looking for a EPPlus function to hide partial results of a Pivot Column Field.&lt;br&gt;
&lt;br&gt;
In MS Excel the corresponding Function is placed in the context menu of the Column Field an it's German Caption is 'Teilergebnis "Column Name"'.&lt;br&gt;
&lt;br&gt;
Regards,&lt;br&gt;
Klaus&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="freakinhuge" When="09/04/2014 13:24:03">
          <Html>
        &lt;div class="markDownOutput "&gt;Any luck on this? I too am trying to accomplish the same thing.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Import XLSX to winforms DataGridView">
      <Posts>
        <Post From="silviudc" When="08/04/2014 17:49:04">
          <Html>
        &lt;div class="markDownOutput "&gt;I am trying to import the data from an excel file but when iterating I am not sure how to determine where the worksheet.Cells ends.&lt;br&gt;
&lt;br&gt;
I know there is a worksheet.Cells.End function but comes back with something like 100000 rows and 16000 columns and not the end of the actual rows.&lt;br&gt;
&lt;br&gt;
How can I get bottom right index row,column of the last record in the excel file?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="08/04/2014 17:53:19">
          <Html>
        &lt;div class="markDownOutput "&gt;Did you try worksheet.Dimension ? &lt;br&gt;
&lt;br&gt;
Regards, &lt;br&gt;
Thiago&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="silviudc" When="08/04/2014 18:27:00">
          <Html>
        &lt;div class="markDownOutput "&gt;I actually just came across Dimension.End.Row and Column a few minutes ago. &lt;br&gt;
Will use that and see. &lt;br&gt;
Thanks.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Rich Text questions">
      <Posts>
        <Post From="StevenReachSoft" When="03/04/2014 14:31:01">
          <Html>
        &lt;div class="markDownOutput "&gt;Why does the RichText properly return a collection? Is it because I can format fragments of the cell?
&lt;br&gt;
&lt;br&gt;
Is there a way or has anyone written an extension or anything to convert the RichText object to HTML? If not I have need so when I do it I'll post it here.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Omit numbers from integer that are less than a thousand?">
      <Posts>
        <Post From="Kaerwek" When="03/04/2014 09:00:17">
          <Html>
        &lt;div class="markDownOutput "&gt;Is it possible to omit numbers from a cell that are less than a thousand? Actually, not omit, but round the number shown.&lt;br&gt;
&lt;br&gt;
E.g. 12123 would show 12, while selecting the cell in Excel woulds how the full value in the editor.&lt;br&gt;
&lt;br&gt;
999 should show as 1. 499 would show as empty cell.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="EPPlus issue with DateTime fields in Datatable">
      <Posts>
        <Post From="sorialtg" When="01/04/2014 20:52:37">
          <Html>
        &lt;div class="markDownOutput "&gt;How do I prevent EPPlus from converting a datetime field in the passed datatable to a double? The columns in table are dynamic in nature and therefore I cannot apply datetime format to the cell as the column position is unkown.&lt;br&gt;
&lt;br&gt;
Thanks,&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="sorialtg" When="02/04/2014 16:29:35">
          <Html>
        &lt;div class="markDownOutput "&gt;I ended up resolving this by iterating through the columns in datatable. If datatype of column is DateTime then apply excel date formatting to the column.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="New Line in Excel Cell value">
      <Posts>
        <Post From="firozansari" When="15/11/2011 14:23:16">
          <Html>
        
&lt;p&gt;Hi, Is there anyway to add new line char between two text in Excel cell value? I tried using RTF new line tag but it still no success.&lt;br&gt;
&lt;br&gt;
Here is the code snippet which assign text in a cell:&lt;br&gt;
&lt;br&gt;
&lt;/p&gt;
&lt;pre&gt;ws.Cells["A1"].Value = @"&amp;lt;r&amp;gt;&amp;lt;rPr&amp;gt;&amp;lt;b /&amp;gt;&amp;lt;/rPr&amp;gt;&amp;lt;t&amp;gt;TEXT1&amp;lt;/t&amp;gt;&amp;lt;/r&amp;gt;&amp;lt;r&amp;gt;&amp;lt;rPr&amp;gt;&amp;lt;/rPr&amp;gt;&amp;lt;t&amp;gt;TEXT2&amp;lt;/t&amp;gt;&amp;lt;/r&amp;gt;";
ws.Cells["A1"].IsRichText = true;&lt;/pre&gt;
&lt;strong&gt;&lt;/strong&gt;&lt;br&gt;
In above code, I just want to render TEXT1 and TEXT2 in two separate lines in excel cell.
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;Thanks,&lt;/p&gt;
&lt;p&gt;- Firoz Ansari&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="17/11/2011 06:42:39">
          <Html>
        
&lt;p&gt;Yes, use something like..&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;].Style.WrapText=&lt;span style="color: blue;"&gt;true&lt;/span&gt;; &lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;There is a bug if you use the \r\n in the text. It&amp;nbsp;is fixed but not included in the current release.&lt;/p&gt;
&lt;p&gt;Download the latest source and build the library from the version 2.9 folder and it shoud be ok.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="firozansari" When="17/11/2011 14:16:05">
          <Html>
        
&lt;p&gt;Thanks Jan. I appreciate your help.&lt;br&gt;
&lt;br&gt;
I build the libarary using latest source code from CodePlex and used "\r\n" as you suggested. Instead of new line char its rendering "_x00D_".&amp;nbsp; Surely I am missing something here.&lt;br&gt;
&lt;br&gt;
Here is my modified code:&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;ws.Cells["A1"].Value = @"&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;r&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;rPr&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;b&lt;/span&gt; &lt;span style="color: blue;"&gt;/&amp;gt;&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;rPr&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;t&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;TEXT1&lt;span style="color: rgb(255, 0, 0);"&gt;&lt;strong&gt;\r\n&lt;/strong&gt;&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;t&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;r&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;r&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;rPr&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;rPr&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;t&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;TEXT2&lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;t&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;r&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;";
ws.Cells["A1"].IsRichText = true;
ws.Cells["A1"].Style.WrapText = true;
&lt;/pre&gt;
&lt;/div&gt;
&lt;br&gt;
Output I am getting:&lt;br&gt;
TEXT1_x00D_TEST2&lt;br&gt;
&lt;br&gt;
Firoz Ansari
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="18/11/2011 14:11:49">
          <Html>
        
&lt;p&gt;Use the Richtext property (if you need richtext in the cell)...﻿&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;            &lt;span style="color: blue;"&gt;using&lt;/span&gt; (&lt;span style="color: blue;"&gt;var&lt;/span&gt; rng = ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;])
            {
                &lt;span style="color: blue;"&gt;var&lt;/span&gt; rt1 = rng.RichText.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"TEXT1\r\n"&lt;/span&gt;);
                rt1.Bold = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
                rng.Style.WrapText = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
                &lt;span style="color: blue;"&gt;var&lt;/span&gt; rt2=rng.RichText.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"TEXT2"&lt;/span&gt;);
                rt2.Bold = &lt;span style="color: blue;"&gt;false&lt;/span&gt;;
            }

Otherwise use the Value Propery.&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="firozansari" When="18/11/2011 19:08:30">
          <Html>
        
&lt;p&gt;Awesome! I am now able to get new line in rich text. Thank you very much for your prompt response.&lt;/p&gt;
&lt;p&gt;Firoz Ansari&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="HarriVainola" When="05/12/2011 12:47:00">
          <Html>
        
&lt;p&gt;Hi, I tried to fix new line problem &lt;span style="color: rgb(192, 0, 0); font-size: 10pt;"&gt;
_x00D_. &lt;/span&gt;&lt;br&gt;
I downloaded the latest source and build the library from the version 2.9.&lt;br&gt;
After that when I create a new worksheet from template and save it, images are missing.&lt;br&gt;
btw&amp;nbsp; newlines are now ok,, but layout is not.&lt;/p&gt;
&lt;p&gt;-Harri&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="08/12/2011 20:54:15">
          <Html>
        
&lt;p&gt;Hmm, missing images, can you mail med your template? &lt;a href="mailto:epplusdocs@gmail.com" rel="nofollow"&gt;
epplusdocs@gmail.com&lt;/a&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="HarriVainola" When="09/12/2011 07:02:53">
          <Html>
        
&lt;div&gt;
&lt;p&gt;&lt;span lang="EN-US" style="font-family:; font-size: 11pt;"&gt;Hi Jan&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span lang="EN-US" style="font-family:; font-size: 11pt;"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span lang="EN-US" style="font-family:; font-size: 11pt;"&gt;Thanks for answering (btw: EPPlus is excellent).&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span lang="EN-US" style="font-family:; font-size: 11pt;"&gt;That problem became after I built EPPlus newest source code.&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span lang="EN-US" style="font-family:; font-size: 11pt;"&gt;Template has image logo but in result it is disappeared.&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span lang="EN-US" style="font-family:; font-size: 11pt;"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span lang="EN-US" style="font-family:; font-size: 11pt;"&gt;best regards&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span lang="EN-US" style="font-family:; font-size: 11pt;"&gt;-Harri&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span lang="EN-US" style="font-family:; font-size: 9pt;"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span lang="EN-US" style="font-family:; font-size: 9pt;"&gt;code:&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span lang="EN-US" style="font-family:; font-size: 9pt;"&gt;using&lt;/span&gt;&lt;span lang="EN-US" style="font-family:; font-size: 9pt;"&gt; (&lt;span style="color: rgb(43, 145, 175);"&gt;ExcelPackage&lt;/span&gt; package =
&lt;span style="color: blue;"&gt;new&lt;/span&gt; &lt;span style="color: rgb(43, 145, 175);"&gt;ExcelPackage&lt;/span&gt;(template,
&lt;span style="color: blue;"&gt;true&lt;/span&gt;))&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span lang="EN-US" style="font-family:; font-size: 9pt;"&gt;{&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span lang="EN-US" style="font-family:; font-size: 9pt;"&gt;worksheet = package.Workbook.Worksheets[&lt;span style="color: rgb(163, 21, 21);"&gt;"Hintakirja"&lt;/span&gt;];&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span lang="EN-US" style="font-family:; font-size: 9pt;"&gt;BeginTask();&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span lang="EN-US" style="font-family:; font-size: 9pt;"&gt;ReadTree(rootName, -1);&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span lang="EN-US" style="font-family:; font-size: 9pt;"&gt;EndTask();&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span lang="EN-US" style="font-family:; font-size: 9pt;"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span lang="EN-US" style="font-family:; font-size: 9pt;"&gt;&lt;span style="color: rgb(43, 145, 175);"&gt;Byte&lt;/span&gt;[] bin = package.GetAsByteArray();&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span lang="EN-US" style="font-family:; font-size: 9pt;"&gt;&lt;span style="color: rgb(43, 145, 175);"&gt;String&lt;/span&gt; file = newFile.FullName;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span lang="EN-US" style="font-family:; font-size: 9pt;"&gt;&lt;span style="color: rgb(43, 145, 175);"&gt;File&lt;/span&gt;.WriteAllBytes(file, bin);&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span lang="EN-US" style="font-family:; font-size: 9pt;"&gt;}&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span lang="EN-US" style="font-family:; font-size: 11pt;"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;a name="_MailEndCompose"&gt;&lt;span lang="EN-US" style="font-family:; font-size: 11pt;"&gt;&lt;/span&gt;&lt;/a&gt;&lt;/p&gt;
&lt;div&gt;
&lt;div style="border-width: 1pt medium medium; border-style: solid none none; border-color: rgb(181, 196, 223) currentColor currentColor; padding: 3pt 0cm 0cm; border-image: none;"&gt;
&lt;p&gt;&lt;b&gt;&lt;span lang="EN-US" style="font-family:; font-size: 10pt;"&gt;From:&lt;/span&gt;&lt;/b&gt;&lt;span lang="EN-US" style="font-family:; font-size: 10pt;"&gt; JanKallman [email removed]
&lt;br&gt;
&lt;b&gt;Sent:&lt;/b&gt; 8. joulukuuta 2011 22:54&lt;br&gt;
&lt;b&gt;To:&lt;/b&gt; Väinölä Harri&lt;br&gt;
&lt;b&gt;Subject:&lt;/b&gt; Re: New Line in Excel Cell value [EPPlus:279512]&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 9pt;"&gt;From: JanKallman&lt;/span&gt;&lt;/p&gt;
&lt;div id="ThreadNotificationPostBody" style="margin-bottom: 24pt;"&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 9pt;"&gt;Hmm, missing images, can you mail med your template?
&lt;a href="mailto:epplusdocs@gmail.com" rel="nofollow"&gt;epplusdocs@gmail.com&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="bassvix" When="11/01/2012 05:01:51">
          <Html>
        
&lt;p&gt;Not work for me. :(&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="HarriVainola" When="19/01/2012 12:25:03">
          <Html>
        
&lt;div&gt;
&lt;p&gt;&lt;span lang="EN-US" style="font-family:; font-size: 11pt;"&gt;Version 3.0.0 Jan 2012 seems to fix new line and template image problems.
&lt;br&gt;
thanks&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="prokofyev" When="14/09/2012 14:30:30">
          <Html>
        
&lt;p&gt;I use version 3.0.0.2, and have "new line" problem.&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;worksheet.Cells[1, 1].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"1\n2"&lt;/span&gt;;

worksheet.Cells[1, 1].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"1\r\n2"&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;Both shown code fragments result to cell with one line only. In Excel if I press F2 and then Enter, text becames two-line.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Declan_Gordon" When="02/04/2014 12:28:23">
          <Html>
        &lt;div class="markDownOutput "&gt;Just to clarify, it is still necessary to enable the wraptext property and to invoked AutoFitColumn() when using new line. To do otherwise can result in undesired layout display during user access of the file.
&lt;br&gt;
&lt;br&gt;
However the AutoFitColumn() command will ignore cells where WrapText is true. &lt;br&gt;
&lt;br&gt;
A valid approach is &lt;br&gt;
&lt;br&gt;
1.Process all your cells, including Environment.NewLine as required. I have not tested with \r\n or \r&lt;br&gt;
&lt;pre&gt;&lt;code&gt;    foreach(var c in RCdata){  Worksheet.Cells[c.Row,c.Column]....; } 
&lt;/code&gt;&lt;/pre&gt;
2.Process the worksheet to autofit, then enable wraptext&lt;br&gt;
&lt;pre&gt;&lt;code&gt;    WorkSheet.Cells[WorkSheet.Dimension.Address].AutoFitColumns();

    WorkSheet.Cells.Style.WrapText = true;
&lt;/code&gt;&lt;/pre&gt;
3.Save the file&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Series Marker Property">
      <Posts>
        <Post From="DarkSyzygy" When="01/04/2014 18:20:10">
          <Html>
        &lt;div class="markDownOutput "&gt;Is there a reason that the Marker property is internal? Looking at it's usage pattern internally it doesn't seem to be anything special. Are there values in the eMarkerStyle enum that are not valid for certain charts?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Can EPPLUS edit DRM files?">
      <Posts>
        <Post From="psycoblaster" When="31/03/2014 00:16:49">
          <Html>
        &lt;div class="markDownOutput "&gt;All office documents are DRM protected in my company, so any documents created or edited in the office can only be further edited or viewed only within the company. I was wondering if EPPLUS can edit documents when used inside the office.
&lt;br&gt;
If it does not work, I guess my best bet would be to use excel Interop. &lt;br&gt;
EPPLUS does create unprotected files when used in the office, but I was just wondering if it would be able to read protected files.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="TextRotation Range">
      <Posts>
        <Post From="pigoth" When="21/03/2014 14:39:53">
          <Html>
        &lt;div class="markDownOutput "&gt;Why the range of rotation is max 180? &lt;br&gt;
I read a cell in existing xlsx file, and in this cell the value of TextRotation is 255.
&lt;br&gt;
When i try to set this value to another cell I have a range exception&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="JanKallman" When="28/03/2014 09:44:12">
          <Html>
        &lt;div class="markDownOutput "&gt;From the OOXML documentation for the TextRotation attribute (18.8.1)... &lt;br&gt;
&lt;br&gt;
textRotation (Text Rotation) &lt;br&gt;
Text rotation in cells. Expressed in degrees. Values range from 0 to 180. The first letter of
&lt;br&gt;
the text is considered the center-point of the arc. &lt;br&gt;
For 0 - 90, the value represents degrees above horizon. For 91-180 the degrees below the
&lt;br&gt;
horizon is calculated as:&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Updating an exiting excel sheet using epplus giving error">
      <Posts>
        <Post From="mishaa" When="24/03/2014 13:23:36">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi,&lt;br&gt;
&lt;br&gt;
I want to update existing '.xlsx' file using Epplus. I have Open Office installed at my system. I want to open 'Sample.xlsx' file which is also creating by Epplus for fisrt time and if file already exists then update it. I am using below code for updating file
 but getting error 'General Input/Output error' when trying to open file using 'Process.start("...")&lt;br&gt;
&lt;br&gt;
Using below code : &lt;br&gt;
&lt;pre&gt;&lt;code&gt;ExcelPackage l_ExcelPackg = null;
 ExcelWorksheet l_ExcelSheet = null;

//Update existing file 
FileInfo l_FileInfo = new FileInfo(@"C:\\Files\\Sample.xlsx");
 l_ExcelPackg = new ExcelPackage(l_FileInfo);
ExcelWorkbook l_WorkBook = l_ExcelPackg.Workbook;

//Get 10th sheet of excel to update
//1 to 9 sheets keep unchanged

l_ExcelSheet = l_WorkBook.Worksheets[10];
l_ExcelSheet.Cells.Clear();

//First row having column names
foreach (DataColumn l_dcColumn in p_dtSelectedRows.Columns)
 {
    l_ExcelSheet.Cells[1, l_intColums].Value = 
    p_dtSelectedRows.Columns[l_dcColumn.ColumnName].ToString();
     l_ExcelSheet.Cells[1, l_intColums].Style.Font.Bold = true;
     l_intColums++;
  }


byte[] l_byteArr = l_ExcelPackg.GetAsByteArray();
File.WriteAllBytes(p_strFilePath, l_byteArr); 

ProcessStartInfo l_objProcess = new ProcessStartInfo(@"C:\\Files\\Sample.xlsx");
                Process.Start(l_objProcess);

                l_ExcelPackg.Dispose();&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="25/03/2014 23:29:11">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi,&lt;br&gt;
&lt;br&gt;
I can't seem to reproduce the error.&lt;br&gt;
&lt;br&gt;
Could it be that you have the Sample.xlsx open in excel while you are running your code?&lt;br&gt;
&lt;br&gt;
/Mats&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Evaluate, calculate expressions 4.0.0.0">
      <Posts>
        <Post From="tomisy" When="24/03/2014 12:30:11">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi! &lt;br&gt;
&lt;br&gt;
I'm using epplus version 4.0.0.0. In the worksheet i am using a formula, what I want to evaluate. As I know the 4.0.0.0 is able to calculate the results of the formula, but it doesn't work at me. What is the problem?&lt;br&gt;
&lt;pre&gt;&lt;code&gt;        ExcelPackage package = new ExcelPackage();
        ExcelWorksheet ws = package.Workbook.Worksheets.Add("Test Page");

        for (int i = 0; i &amp;lt; 35; i++)
        {
            ws.Cells[i+1, 1].Value = Convert.ToInt32(i+1);
        }

        ws.Cells[2, 2, 2, 2].Formula = "=(" + "A" + "5-SZUM(" + "A" + "6:" + "A" + "22))-(("
                + "A" + "4+" + "A" + "24)*" + "A" + "31/60)";
        //ws.Cells[2, 2, 2, 2].Style.Numberformat.Format = "0.00";
        ws.Cells[2, 2, 2, 2].Calculate();
        ws.Column(2).Width = 20;
        ws.Calculate();
        package.Workbook.Calculate();

        //ws.Calculate(ws.Cells[2, 2, 2, 2].Formula);

        package.SaveAs(new FileInfo("app.xlsx"));
        MessageBox.Show("Done");
        Application.Exit();
&lt;/code&gt;&lt;/pre&gt;
Thank you! &lt;br&gt;
&lt;br&gt;
Tamás&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="tomisy" When="24/03/2014 13:04:30">
          <Html>
        &lt;div class="markDownOutput "&gt;I know the base problem: In formula string I'm using the hungarian function name: SZUM istead of SUM. When I change it to SUM, then works well. But how can I use the function name with other languages? Is there any option, where I am able to adjust the
 language/culture of the xlsx?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="24/03/2014 14:08:23">
          <Html>
        &lt;div class="markDownOutput "&gt;No, there is no option for that. In Excel, the browser in a Hungarian locale might use the Hungarian for SUM while the file is saved using the standard English name. In EPPlus, the formula property is a string and there is no string processing to save
 it with another name.&lt;br&gt;
&lt;br&gt;
Regards,&lt;br&gt;
Thiago&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="25/03/2014 06:06:43">
          <Html>
        &lt;div class="markDownOutput "&gt;Exactly, just to clarify: the language/culture is not set on the file, it is in your local Excel installation.
&lt;br&gt;
&lt;br&gt;
So always use the english formula names when using epplus and you will see the hungarian versions when you open the file in Excel. If you send the file to me I will see it in swedish.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Cell containing formula giving null values when read second time">
      <Posts>
        <Post From="klvnnsrikanth" When="15/01/2011 16:53:38">
          <Html>
        
&lt;p&gt;Hi Jan&lt;/p&gt;
&lt;p&gt;I have a class that opens the excel sheet reads and then closes the file. (certain cells have formulas in them)&lt;/p&gt;
&lt;p&gt;There is another process which does some computations on the obtained values.&lt;/p&gt;
&lt;p&gt;I have another class that writes values to the excel sheet opening it again and saving it.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;When I run the whole process again without opening the file after the first cycle on the same file, the cells containing the formula give me null values.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Can you tell me how to fix this?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;
&lt;p&gt;Srikanth Kambhampati&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Excel Sheet has values&lt;/p&gt;
&lt;p&gt;A &amp;nbsp; &amp;nbsp; B C D&lt;/p&gt;
&lt;p&gt;Item 1 1 1&lt;/p&gt;
&lt;p&gt;Values =B1 =B2+C1 =C2+D1&lt;/p&gt;
&lt;table&gt;
&lt;tbody&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Here is the code I used.&lt;/p&gt;
&lt;p&gt;Program.cs&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;using&lt;/span&gt; System;
&lt;span style="color: blue;"&gt;using&lt;/span&gt; System.Collections.Generic;
&lt;span style="color: blue;"&gt;using&lt;/span&gt; System.Linq;
&lt;span style="color: blue;"&gt;using&lt;/span&gt; System.Text;
&lt;span style="color: blue;"&gt;using&lt;/span&gt; System.IO;
&lt;span style="color: blue;"&gt;using&lt;/span&gt; OfficeOpenXml;

&lt;span style="color: blue;"&gt;namespace&lt;/span&gt; ExcelTestWrite
{
    &lt;span style="color: blue;"&gt;using&lt;/span&gt; System;
    &lt;span style="color: blue;"&gt;using&lt;/span&gt; System.Reflection;

    &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;class&lt;/span&gt; Program
    {
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;static&lt;/span&gt; &lt;span style="color: blue;"&gt;void&lt;/span&gt; Main()
        {
            ReadFromExcelSheet read = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ReadFromExcelSheet(&lt;span style="color: rgb(163, 21, 21);"&gt;@"C:\Book1.xlsx"&lt;/span&gt;);
            read.TestRead();

            ExcelSheetWriter write = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelSheetWriter(&lt;span style="color: rgb(163, 21, 21);"&gt;@"C:\Book1.xlsx"&lt;/span&gt;);
            write.WriteToExcel();
            Console.WriteLine(&lt;span style="color: rgb(163, 21, 21);"&gt;"*******************************************************"&lt;/span&gt;);
            read.TestRead();
            Console.ReadLine();
        }
    }
}
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;pre&gt;ExcelSheetWriter.cs&lt;/pre&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;using&lt;/span&gt; System;
&lt;span style="color: blue;"&gt;using&lt;/span&gt; System.Collections.Generic;
&lt;span style="color: blue;"&gt;using&lt;/span&gt; System.Linq;
&lt;span style="color: blue;"&gt;using&lt;/span&gt; System.Text;
&lt;span style="color: blue;"&gt;using&lt;/span&gt; OfficeOpenXml;
&lt;span style="color: blue;"&gt;using&lt;/span&gt; System.IO;

&lt;span style="color: blue;"&gt;namespace&lt;/span&gt; ExcelTestWrite
{
    &lt;span style="color: blue;"&gt;class&lt;/span&gt; ExcelSheetWriter
    {
        FileInfo file;

        &lt;span style="color: blue;"&gt;public&lt;/span&gt; ExcelSheetWriter(&lt;span style="color: blue;"&gt;string&lt;/span&gt; path)
        {
            file = &lt;span style="color: blue;"&gt;new&lt;/span&gt; FileInfo(path);
        }
        
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;void&lt;/span&gt; WriteToExcel()
        {
            &lt;span style="color: blue;"&gt;using&lt;/span&gt; (ExcelPackage package = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(file))
            {
                ExcelWorksheet worksheet = package.Workbook.Worksheets.First();

                worksheet.Cells[1, 6].Value = 1;
                worksheet.Cells[2, 6].Formula = &lt;span style="color: rgb(163, 21, 21);"&gt;"E2 + F1"&lt;/span&gt;;
                worksheet.Cells[1, 7].Value = 1;
                worksheet.Cells[2, 7].Formula = &lt;span style="color: rgb(163, 21, 21);"&gt;"F2 + G1"&lt;/span&gt;;

                package.Save();
            }
        }
    }
}

&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;pre&gt;ReadFromExcelSheet.cs&lt;/pre&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;using&lt;/span&gt; System;
&lt;span style="color: blue;"&gt;using&lt;/span&gt; System.Collections.Generic;
&lt;span style="color: blue;"&gt;using&lt;/span&gt; System.Linq;
&lt;span style="color: blue;"&gt;using&lt;/span&gt; System.Text;
&lt;span style="color: blue;"&gt;using&lt;/span&gt; System.IO;
&lt;span style="color: blue;"&gt;using&lt;/span&gt; OfficeOpenXml;

&lt;span style="color: blue;"&gt;namespace&lt;/span&gt; ExcelTestWrite
{
    &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;class&lt;/span&gt; ReadFromExcelSheet
    {
        FileInfo file;

        &lt;span style="color: blue;"&gt;public&lt;/span&gt; ReadFromExcelSheet(&lt;span style="color: blue;"&gt;string&lt;/span&gt; path)
        {
            file = &lt;span style="color: blue;"&gt;new&lt;/span&gt; FileInfo(path);
        }

        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;void&lt;/span&gt; TestRead()
        {
            &lt;span style="color: blue;"&gt;using&lt;/span&gt; (ExcelPackage package = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(file))
            {
                ExcelWorksheet worksheet = package.Workbook.Worksheets.First();
                Console.WriteLine(worksheet.Cells[1, 1].Value);
                Console.WriteLine(worksheet.Cells[1, 2].Value);
                Console.WriteLine(worksheet.Cells[1, 3].Value);
                Console.WriteLine(worksheet.Cells[1, 4].Value);
                Console.WriteLine(worksheet.Cells[1, 5].Value);
                Console.WriteLine(worksheet.Cells[2, 1].Value);
                Console.WriteLine(worksheet.Cells[2, 2].Value);
                Console.WriteLine(worksheet.Cells[2, 3].Value);
                Console.WriteLine(worksheet.Cells[2, 4].Value);
                Console.WriteLine(worksheet.Cells[2, 5].Value);
                package.Save();
            }
        }
    }
}

&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="klvnnsrikanth" When="15/01/2011 20:20:09">
          <Html>
        
&lt;p&gt;I figured out something like&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;when you say package.Save() the excel will no longer have the formulas retained in it.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;How do I need to save the file in order to make the sheets still have the formulas in them?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;
&lt;p&gt;Srikanth Kambhampati&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="16/01/2011 17:41:12">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;There is no calculation engine in EPPlus, so you have to open the files in Excel to get the values of the formulas.&lt;/p&gt;
&lt;p&gt;Also, make sure you have the Calc mode set to automatic in all your workbooks.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="klvnnsrikanth" When="17/01/2011 04:32:23">
          <Html>
        
&lt;p&gt;Is there a way to open/save the excel sheet programmatically for this to work? (without using COM)&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;
&lt;p&gt;Srikanth Kambhampati&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="17/01/2011 21:07:58">
          <Html>
        
&lt;p&gt;The calc chains are removed when the package&amp;nbsp;is opened in EPPlus, so you have to recalculate the formulas in Excel.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="swmal" When="24/03/2014 08:48:07">
          <Html>
        &lt;div class="markDownOutput "&gt;Since there are external links to this thread, we should just add that there will be support for formula calculation from EPPlus 4.0 (which is currently in beta-state).&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Copy cell ExcelColor to another cell">
      <Posts>
        <Post From="pigoth" When="21/03/2014 14:36:39">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
I have a problem to copy the style cell to cell. &lt;br&gt;
Rgb color work, but Theme color don't have a set metod&lt;br&gt;
&lt;pre&gt;&lt;code&gt;   private void SetColor(ExcelColor color, ExcelColor template)
    {
        if (template.Indexed &amp;gt;= 0)
            color.Indexed = template.Indexed;

        color.Tint = template.Tint;
        if (!string.IsNullOrEmpty(template.Rgb))
            color.SetColor(ColorTranslator.FromHtml(string.Format("#{0}", template.Rgb)));
    }&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="EPPlus copy function">
      <Posts>
        <Post From="PrincessLenLen" When="19/03/2014 07:21:41">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi! &lt;br&gt;
&lt;br&gt;
I noticed that the copy function from EPPlus 4.0 does not copy the formula and format of the source. i tried using version 3.0.0.2 and it does not have a problem with the copy function. i never tried using version 3.1 due to dll registration here in our office.
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
here is my code when using it on version 3.0.0.2&lt;br&gt;
&lt;pre&gt;&lt;code&gt;For rownum = 4 To .Dimension.End.Row
      .Cells(3, 6, 3, 37).Copy(.Cells(rownum, 6, rownum, 37))
Next&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Is there a way to remove named styles?">
      <Posts>
        <Post From="psycoblaster" When="18/03/2014 22:05:10">
          <Html>
        &lt;div class="markDownOutput "&gt;I am writing a program that edits an excel file, but the excel file has around 300~ defined named styles.
&lt;br&gt;
Is there a way to just clear them all, or edit them through loop as if there is an array of namedStyle objects?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to run VBA code?">
      <Posts>
        <Post From="dm80" When="17/03/2014 23:41:26">
          <Html>
        &lt;div class="markDownOutput "&gt;I'm new to using EPPlus and would appreciate some guidance on how to accomplish what I need to do. I have on the server an Excel file that already has Macro/VBA code that needs to be ran after I populate a worksheet with data. Is this something that can
 be done using EPPlus? If yes please provide more details on how to do this. Many thanks in advance!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="JanKallman" When="18/03/2014 20:16:37">
          <Html>
        &lt;div class="markDownOutput "&gt;No, there's not VBA engine in EPPlus, you can just read and write to the Project. No Execution. You need Excel for that.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="dotnetzip used in epplus">
      <Posts>
        <Post From="dhernandez" When="14/03/2014 09:49:22">
          <Html>
        &lt;div class="markDownOutput "&gt;What version of dotnetzip are you using in dotnetzip new beta version? &lt;br&gt;
I'm using dotnetzip version 1.9.1.8 with some programs and it has issues when using with multicore cpu.
&lt;br&gt;
I've used patch from: &lt;br&gt;
&lt;a href="https://dotnetzip.codeplex.com/workitem/14087" rel="nofollow"&gt;https://dotnetzip.codeplex.com/workitem/14087&lt;/a&gt;
&lt;br&gt;
and now it works ok. &lt;br&gt;
that patch changes zlib\ParallelDeflateOutputStream.cs&lt;br&gt;
&lt;pre&gt;&lt;code&gt;funcion private void EmitPendingBuffers(bool doAll, bool mustWait)&lt;/code&gt;&lt;/pre&gt;
at line 874 . Changes at are line 987. &lt;br&gt;
substracted from patch at &lt;a href="https://dotnetzip.codeplex.com/workitem/14087" rel="nofollow"&gt;
https://dotnetzip.codeplex.com/workitem/14087&lt;/a&gt; :&lt;br&gt;
&lt;blockquote&gt;rhpainte wrote Jan 6, 2012 at 7:30 PM&lt;br&gt;
The issue is reproducable anytime you are compressing data that fits into an integeral number of internal buffers inside ParallelDeflateOutputStream (The default size is set to 64KB). When it has finished loading your data into the buffers Close is called which
 will result in _Flush(true) being called. Since we have an integeral size _currentlyFilling is equal to -1 and we go directly to EmitPendingBuffers(true, false) and _FlushFinish().&lt;br&gt;
&lt;br&gt;
Inside EmitPendingBuffers the outside do{} while (doAll &amp;amp;&amp;amp; (_lastWritten != _latestCompressed)) can exit prematurely as it doesn't take into account number of buffers filled, as our threads could still be busy computing blocks 3-15 with _lastWritten
 and _latestCompressed both equalling 2.&lt;br&gt;
&lt;br&gt;
Workround:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;The suggestion by Mike is great
Modify the buffer size so that it is not nicely aligned with your file size
&lt;/code&gt;&lt;/pre&gt;
Fix:&lt;br&gt;
Zlib\ParallelDeflateOutputStream.cs&lt;br&gt;
&lt;br&gt;
line 987:&lt;br&gt;
change&lt;br&gt;
&lt;/blockquote&gt;
&lt;pre&gt;&lt;code&gt;} while (doAll &amp;amp;&amp;amp; (_lastWritten != _latestCompressed));&lt;/code&gt;&lt;/pre&gt;
&lt;blockquote&gt;to&lt;br&gt;
&lt;/blockquote&gt;
&lt;pre&gt;&lt;code&gt;} while (doAll &amp;amp;&amp;amp; (_lastWritten != _latestCompressed || _lastWritten != _lastFilled));&lt;/code&gt;&lt;/pre&gt;
Regards, &lt;br&gt;
&lt;br&gt;
David.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="JanKallman" When="18/03/2014 20:08:56">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
I synced the code from Dotnet zip a few weeks ago, but I cant see this fix. I'll try to add it to the next build.
&lt;br&gt;
Thanks Jan&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Still having memory issues with Beta release">
      <Posts>
        <Post From="techSUPPORT" When="13/03/2014 22:18:45">
          <Html>
        &lt;div class="markDownOutput "&gt;I may have missed some documentation somewhere, however I'm still running into memory issues with the 4.0 Beta release.
&lt;br&gt;
&lt;br&gt;
I need to create a spreadsheet with close to 300k records. The process, while slow, completes successfully however I don't see any of the memory used during the process given back.
&lt;br&gt;
&lt;br&gt;
The process I'm using seems pretty basic. I pull records from a database into a List object (named 'results'). I then cycle through that list and write to the spreadsheet.
&lt;br&gt;
&lt;pre&gt;&lt;code&gt;        //Construct new Excel package
        ExcelPackage pck = new ExcelPackage();

        //Instantiate workbook object
        var ws = pck.Workbook.Worksheets.Add("Query_" + DateTime.Now.ToString());

        //Header content
        ws.Cells["A1"].Value = "ChannelCode";
        ws.Cells["B1"].Value = "DrmTerrDesc";
        ws.Cells["C1"].Value = "IndDistrnId";
        ws.Cells["D1"].Value = "StateCode";
        ws.Cells["E1"].Value = "ZipCode";
        ws.Cells["F1"].Value = "EndDate";
        ws.Cells["G1"].Value = "EffectiveDate";
        ws.Cells["H1"].Value = "LastUpdateId";
        ws.Cells["I1"].Value = "ErrorCodes";
        ws.Cells["J1"].Value = "Status";
        ws.Cells["K1"].Value = "Id";

        //Set autofilter
        ws.Cells["A1:K1"].AutoFilter = true;

        //Center text
        ws.Cells["A1:K1"].Style.HorizontalAlignment = ExcelHorizontalAlignment.Center;

        //Freeze first row
        ws.View.FreezePanes(2, 1);

        //Set background color for Id cells
        ws.Column(11).Style.Fill.PatternType = ExcelFillStyle.Solid;
        ws.Column(11).Style.Fill.BackgroundColor.SetColor(Color.Gainsboro);

        //Set background color for the rest
        ws.Cells["A1:K1"].Style.Fill.PatternType = ExcelFillStyle.Solid;
        ws.Cells["A1:K1"].Style.Fill.BackgroundColor.SetColor(Color.Black);

        //Set header text color
        ws.Cells["A1:K1"].Style.Font.Color.SetColor(Color.WhiteSmoke);
        ws.Cells["A1:K1"].Style.Font.Bold = true;

        //Content
        int i = 2;
        foreach (var zip in results)
        {
            //Set cell values
            ws.Cells["A" + i.ToString()].Value = zip.ChannelCode;
            ws.Cells["B" + i.ToString()].Value = zip.DrmTerrDesc;
            ws.Cells["C" + i.ToString()].Value = zip.IndDistrnId;
            ws.Cells["D" + i.ToString()].Value = zip.StateCode;
            ws.Cells["E" + i.ToString()].Value = zip.ZipCode;
            ws.Cells["F" + i.ToString()].Value = zip.EndDate.ToShortDateString();
            ws.Cells["G" + i.ToString()].Value = zip.EffectiveDate.ToShortDateString();
            ws.Cells["H" + i.ToString()].Value = zip.LastUpdateId;
            ws.Cells["I" + i.ToString()].Value = zip.ErrorCodes;
            ws.Cells["J" + i.ToString()].Value = zip.Status;
            ws.Cells["K" + i.ToString()].Value = zip.Id;

            //Unlock non-Id fields
            ws.Cells["A" + i.ToString()].Style.Locked = false;
            ws.Cells["B" + i.ToString()].Style.Locked = false;
            ws.Cells["C" + i.ToString()].Style.Locked = false;
            ws.Cells["D" + i.ToString()].Style.Locked = false;
            ws.Cells["E" + i.ToString()].Style.Locked = false;
            ws.Cells["F" + i.ToString()].Style.Locked = false;
            ws.Cells["G" + i.ToString()].Style.Locked = false;
            ws.Cells["H" + i.ToString()].Style.Locked = false;
            ws.Cells["I" + i.ToString()].Style.Locked = false;
            ws.Cells["J" + i.ToString()].Style.Locked = false;

            i++;
        }

        ws.Cells.Dispose();

        ////Autofit cells
        //ws.Cells[ws.Dimension.Address].AutoFitColumns();

        return new ExcelResult
            {
                FileName = "ZipCodeSearch_" + DateTime.Now + ".xlsx",
                Package = pck
            };
&lt;/code&gt;&lt;/pre&gt;
This is an MVC app and I wanted the user to be able to download the finished product. As a results I override the 'ExecuteResult' method of the System.Web.Mvc class 'ActionResults'&lt;br&gt;
&lt;pre&gt;&lt;code&gt;    public string FileName { get; set; }
    public ExcelPackage Package { get; set; }

    public override void ExecuteResult(ControllerContext context)
    {
        context.HttpContext.Response.Buffer = true;
        context.HttpContext.Response.Clear();
        context.HttpContext.Response.AddHeader("content-disposition", "attachment; filename=" + FileName);
        context.HttpContext.Response.ContentType = "application/vnd.ms-excel";
        context.HttpContext.Response.BinaryWrite(Package.GetAsByteArray());

        Package.Stream.Close();
        Package.Dispose();
    }&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="JanKallman" When="18/03/2014 20:01:54">
          <Html>
        &lt;div class="markDownOutput "&gt;Call pck.Dispose() or wrap the package in an Using statment to release the memory (and optionally call GC.Collect() to see the change).
&lt;br&gt;
This will call dispose on any underlaying objects in the cellstore. &lt;br&gt;
The Cells property is an ExcelRange object that is more of a "window" on top if the cell store.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Read result value of formula">
      <Posts>
        <Post From="JustP" When="06/12/2010 13:03:57">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I'm looking for a way to achieve the g&lt;strong&gt;oal:&lt;/strong&gt; create a web application using the result of calculations in my Excel workbook based on values provided by the user.&lt;/p&gt;
&lt;p&gt;I have the following scenario:&lt;/p&gt;
&lt;p&gt;- A template Excel file with a lot of formulas (referencing to values and formulas on multiple worksheets) calculating a user's 'category' based on 20 questions (likert scale)&lt;/p&gt;
&lt;p&gt;- Because of the rate of change and complexity of these formulas I don't want to hard code these calculations into the web application&lt;/p&gt;
&lt;p&gt;- I'm currently opening the excel; programmatically enter the values into the correct cells&lt;/p&gt;
&lt;p&gt;- The sheet is saved correctly and the result of the formula based on the values are shown in Excel when opening the file&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;- I can't find a way to programmatically get hold of this result value -&amp;gt; EPPlus is returning an empty string when trying to fetch the .Value of the cell with the result formula.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Is there any way to get hold of the result value?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="06/12/2010 18:05:59">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;No,&amp;nbsp;EPPlus has no calculation engine. It depends on Excel to calculate all formulas when the workbook is opened.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="techSUPPORT" When="07/03/2014 19:08:42">
          <Html>
        &lt;div class="markDownOutput "&gt;Any update on this or is EPPlus still unable to programmatically execute formulas?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="10/03/2014 13:21:32">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
the upcoming beta realease of EPPlus 4.0 will have support for formula evaluation. It will probably be released in a week or so.
&lt;br&gt;
&lt;br&gt;
/Mats&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="techSUPPORT" When="13/03/2014 23:08:18">
          <Html>
        &lt;div class="markDownOutput "&gt;Got the new dll. Is there any documentation on how to calculate formulas? &lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="14/03/2014 06:17:47">
          <Html>
        &lt;div class="markDownOutput "&gt;Check out the new formula samples in the sample project. But basically, you just call the Calculate() method on workbook, worksheet or range and the calculated values will be set on each cell containing a formula.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Memory is not released back">
      <Posts>
        <Post From="ymetelkin" When="27/09/2012 15:57:33">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Watching the Task Manager, I noticed that in a process of creating a pretty large Excel file (~1.5 MB) on IIS, a lot more memory (~200MB) is added to IIS Worker Process (w3wp.exe). The memory count does not go down after a download is completed. Every new
 download increases that memory (not&amp;nbsp;linearly, it reaches about 500MB and increases become smaller, but increases&amp;nbsp;nevertheless). I use pretty much the same code as this one:&amp;nbsp;&lt;a href="http://epplus.codeplex.com/wikipage?title=WebapplicationExample" rel="nofollow"&gt;http://epplus.codeplex.com/wikipage?title=WebapplicationExample&lt;/a&gt;.
 I also tried "try-catch-finally" block instead of "using" statement so I can call "Dispose" method directly, that did not help.&lt;/p&gt;
&lt;p&gt;I do not want to reinvent the bicycle and use OpenXML directly. EPPLus has everything I need. Except this little problem, of course. I have also seen a few "out-of-memory" threads and none of them seems to be resolved. I wonder if you recognize
 this problem and plan to fix it in any future releases?&lt;/p&gt;
&lt;p&gt;Thanks,&lt;/p&gt;
&lt;p&gt;Yuri&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Sarske" When="03/10/2012 10:18:22">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I also have the same problem as Yuri. Somethimes I need to create files of 3 - 5mb and the w3wp.exe rises until 1GB&lt;/p&gt;
&lt;p&gt;Could someone please tell us, how to release the memory?&lt;/p&gt;
&lt;p&gt;Thanks,&lt;br&gt;
Jan&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mjslane" When="28/11/2012 16:53:23">
          <Html>
        
&lt;p&gt;ExcelRangeBase has an eventhandler and the code to remove is is in the finalizer. But as the eventhandler holds a reference to the ExcelRangeBase instance, the finaliser will never be called. &amp;nbsp;Make sure that Dispose() is called on any references to
 ExcelRangeBase &amp;nbsp;when you've finished with them. &amp;nbsp;I don't know if this problem exists in any other classes, it probably will be an issue for ExcelRange and ExcelNamedRange as they inherit from ExcelRangeBase.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="webfriend13" When="14/03/2013 10:49:41">
          <Html>
        &lt;div class="markDownOutput "&gt;I am facing the same issue and I used ANTS profiler. It showed that ExcelCell object is not garbage collected. But I could not figure out which object is holding reference of ExcelCell object. After this I decided to call GC.Collect(). I know its not advisable
 but GC.Collect() is doing the trick for me. I hope it will work in your case as well.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="grimmdp" When="19/03/2013 21:01:31">
          <Html>
        &lt;div class="markDownOutput "&gt;So when I do something like &lt;br&gt;
&lt;pre&gt;&lt;code&gt;ExcelRange rng = sht.Cells[StartRow, col];
// use the rng reference to do stuff&lt;/code&gt;&lt;/pre&gt;
You're saying I need to call rng.Dispose()? &lt;br&gt;
&lt;br&gt;
If so, that's gonna be a serious maintenance issue...&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="s_schwenker" When="05/04/2013 01:37:18">
          <Html>
        &lt;div class="markDownOutput "&gt;Hey, &lt;br&gt;
&lt;br&gt;
I'm having this very same issue and It's impacting our systems significently since we consistently generate Excel files in the 10-30MB range. I have created a sample application for me to profile the code and I have tracked down all the ExcelCell objects and
 found that they are being held by RangeCollection. I have also modified/extended the dispose() method to dispose the Range collections from the ExcelWorksheet class and it releases all of the ExcelCell and RangCollection.IndexItem objects.
&lt;br&gt;
&lt;br&gt;
This patch does not solve the memory leak completely as there are still a bunch of objects being held but it does free up +95% of the objects in my test application. I would like to create a patch for this but I have not found where I can check out the code
 in some version control system so that I can easily do this. Any help?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="jxnim" When="15/04/2013 10:14:03">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
I am also having the same issue, have anyone found a solution?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="saurabhrajguru" When="08/07/2013 05:50:53">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello, &lt;br&gt;
&lt;br&gt;
I am also facing this issue. &lt;br&gt;
This is a very Critical issue for me. &lt;br&gt;
Does anyone can share a Solution ?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="rasputino" When="24/07/2013 11:50:07">
          <Html>
        &lt;div class="markDownOutput "&gt;Same problem... &lt;br&gt;
&lt;br&gt;
I tried everything... disposing, using a "using"... does anyone found a solution?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="cpatchett" When="30/07/2013 18:13:09">
          <Html>
        &lt;div class="markDownOutput "&gt;Likewise here...it's currently preventing me from using EPPlus in production.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="s_schwenker" When="31/07/2013 22:23:35">
          <Html>
        &lt;div class="markDownOutput "&gt;Hey guys, &lt;br&gt;
&lt;br&gt;
Sorry, I should have written you back on this. I have written a patch and committed it to the CleanupMemory branch in the source control. Please go ahead and download if from there.
&lt;br&gt;
&lt;br&gt;
It does a pretty good job of releasing the memory for the most part but there's still some memory not being cleaned up.
&lt;br&gt;
&lt;br&gt;
Thank you, &lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Steve.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="wim1983" When="01/08/2013 07:37:07">
          <Html>
        &lt;div class="markDownOutput "&gt;&lt;strong&gt;s_schwenker wrote:&lt;/strong&gt;&lt;br&gt;
&lt;blockquote&gt;Hey guys,&lt;br&gt;
&lt;br&gt;
Sorry, I should have written you back on this. I have written a patch and committed it to the CleanupMemory branch in the source control. Please go ahead and download if from there.&lt;br&gt;
&lt;br&gt;
It does a pretty good job of releasing the memory for the most part but there's still some memory not being cleaned up.&lt;br&gt;
&lt;br&gt;
Thank you,&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Steve.&lt;br&gt;
&lt;/blockquote&gt;
Hi, &lt;br&gt;
&lt;br&gt;
I have tried to debug your changes into dll and replace it back and run with calling excel package dispose, but still the memory keep increasing without release? Any advice?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="s_schwenker" When="13/09/2013 15:20:33">
          <Html>
        &lt;div class="markDownOutput "&gt;Maybe your use case is different than mine. I ended up creating a small program with my use case that caused the memory leak. I then debugged that.
&lt;br&gt;
&lt;br&gt;
Is it possible for you to write a small console app that reproduces your memory leak and send it to me?
&lt;br&gt;
&lt;br&gt;
Steve.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="wim1983" When="17/09/2013 07:15:51">
          <Html>
        
&lt;div dir="ltr"&gt;Hi,
&lt;div&gt;&lt;br&gt;
&lt;/div&gt;
&lt;div&gt;Thanks for your kind attention on the issue. I have temporarily solved the problem by splitting data into multiple Excel files, each limit to max 100K records, 1 sheet.&lt;/div&gt;
&lt;div&gt;Anyway, I'll write the console app when I'm free again.&lt;/div&gt;
&lt;div&gt;&lt;br&gt;
&lt;/div&gt;
&lt;div&gt;Thanks,&lt;/div&gt;
&lt;div&gt;Hon Wai&lt;br&gt;
&lt;br&gt;
&lt;div&gt;
&lt;hr id="stopSpelling"&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="techSUPPORT" When="13/03/2014 19:59:52">
          <Html>
        &lt;div class="markDownOutput "&gt;Where is the CleanupMemory branch you're referring to? Can't find it under the "Source Code" link.
&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Saved xlsm file is corrupted">
      <Posts>
        <Post From="rchorev" When="12/03/2014 01:57:52">
          <Html>
        &lt;div class="markDownOutput "&gt;I have a very basic program that loads a xlsm file into an Excel Package object and then saves it into a new file. The new file is corrupt and I cannot open it in Excel? What's is wrong?
&lt;br&gt;
&lt;br&gt;
static void Main(string[] args)&lt;br&gt;
&lt;pre&gt;&lt;code&gt;    {
        using (ExcelPackage _package = new ExcelPackage(new FileInfo(args[0])))
        {
            _package.SaveAs(new FileInfo(args[1]));
        }
    }
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Open Existing Excel File">
      <Posts>
        <Post From="kdeutsch2" When="10/03/2014 18:31:38">
          <Html>
        &lt;div class="markDownOutput "&gt;Ok i guess i am not a very good searcher, thought I could find lots of examples of opening an existing excel file and filling in certain cells then showing to user.
&lt;br&gt;
&lt;ol&gt;
&lt;li&gt;Open an existing file &lt;/li&gt;&lt;li&gt;fill in certian cells. &lt;/li&gt;&lt;li&gt;allow user to save to thier desktop.&lt;br&gt;
&lt;/li&gt;&lt;/ol&gt;
here is what I have that keeps telling me I need a workbook first.&lt;br&gt;
&lt;pre&gt;&lt;code&gt; protected void lnkExport_Click(object sender, EventArgs e)
    {
        var ExistFile = Server.MapPath("~/Excel/NSS.xlxs");

        var File = new FileInfo(ExistFile);


        using (ExcelPackage package = new ExcelPackage(File))
            {
                ExcelWorkbook workBook = package.Workbook;
                if (workBook != null)
                {
                    if (workBook.Worksheets.Count &amp;gt; 0)
                    {
                        ExcelWorksheet cSheet = workBook.Worksheets.First();

                        cSheet.Cells["A8"].Value = "Kevin";
                    }
                }
               
                package.Save();


                Response.Clear();
                Response.ContentType = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";

                Response.AddHeader("Content-Disposition", "attachment; filename=ProposalRequest.xslx");
                Response.BinaryWrite(package.GetAsByteArray());
                // myMemoryStream.WriteTo(Response.OutputStream); //works too
                Response.Flush();
                Response.Close();
            }
   
    }&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="kdeutsch2" When="10/03/2014 18:40:48">
          <Html>
        &lt;div class="markDownOutput "&gt;Ok, I had the file extension wrong, what a dummy. However I can now get at the file but I get another error. Inthat It cannot touch file becuase its in use by another process. when trying to save it. Is there a way to create a copy of the existing file
 instead of using the current one and then saving it as another file that a user can save to their desktop after I have edited and added the contect I need to..&lt;br&gt;
&lt;pre&gt;&lt;code&gt; protected void lnkExport_Click(object sender, EventArgs e)
    {
        var ExistFile = Server.MapPath("~/Excel/NSS.xlsx");

        var File = new FileInfo(ExistFile);


        using (ExcelPackage package = new ExcelPackage(File))
            {
                package.Load(new FileStream(ExistFile, FileMode.Open));

                ExcelWorksheet workSheet = package.Workbook.Worksheets["Sheet1"];

                workSheet.Cells["A8"].Value = "kevin";

                package.Save();


                Response.Clear();
                Response.ContentType = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";

                Response.AddHeader("Content-Disposition", "attachment; filename=ProposalRequest.xslx");
                Response.BinaryWrite(package.GetAsByteArray());
                // myMemoryStream.WriteTo(Response.OutputStream); //works too
                Response.Flush();
                Response.Close();
            }
   
    }&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Saving problem">
      <Posts>
        <Post From="cemremengu" When="23/12/2013 09:23:24">
          <Html>
        &lt;div class="markDownOutput "&gt;I successfully create an xlsx file. However, when I open the files and then try to close them I am prompted with the question asking if I want to save the document (Even if I dont make any changes).&lt;br&gt;
&lt;br&gt;
Without explicitly opening the file and saving it, reading the xlsx file returns some values as null. What can be the problem, any ideas ? I exactly follow the instructions in documentations.&lt;br&gt;
&lt;br&gt;
Further examination shows that the cell values which are null, are the ones that contain a formula. Only after saving the sheet manually I can read these values. This is also mentioned here:
&lt;a href="https://epplus.codeplex.com/discussions/241913" rel="nofollow"&gt;https://epplus.codeplex.com/discussions/241913&lt;/a&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="techSUPPORT" When="07/03/2014 18:57:07">
          <Html>
        &lt;div class="markDownOutput "&gt;I'm experiencing the same problem. If I do not open and save the spreadsheet certain cells are read as null by the program even though there is text in the cell.
&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="dll from Source Code">
      <Posts>
        <Post From="PrincessLenLen" When="06/03/2014 05:41:41">
          <Html>
        &lt;div class="markDownOutput "&gt;hi, &lt;br&gt;
&lt;br&gt;
Can someone help me compile the source code into a dll file. I dont have C# here at my office.
&lt;br&gt;
&lt;br&gt;
thanks!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Cannot re-save the existing xls file after modifying the value of some cells">
      <Posts>
        <Post From="TLD" When="04/03/2014 06:02:43">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, I am trying to open the existing spreadsheet, modify the values of some cells and re-save the xls but I have the error saving the file. The InnerException said "Package object was closed and disposed, so cannot carry out operations on this object
 or any stream opened on a part of this package.". &lt;br&gt;
&lt;br&gt;
The code is just simple like&lt;br&gt;
&lt;pre&gt;&lt;code&gt;            using (package = new ExcelPackage(existingXLS))
            {
                // get the first worksheet in the workbook
                worksheet = package.Workbook.Worksheets[1];  

               //modify the values of some cells          
    for (int i = 2; i &amp;lt;= numRows; i++)
                {
                   worksheet.Cells[i, 10].Value = newvalue1;
                   worksheet.Cells[i, 11].Value = newvalue2;
                }

    package.save();

           }
&lt;/code&gt;&lt;/pre&gt;
Can you please help? Thank you.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Excel template with macros (xlsm) and saving as a new file">
      <Posts>
        <Post From="Santhos" When="03/03/2014 12:15:09">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
I have an excel file (xlsm) that I use as a template with some macros inside. When I simply open the file, write in some cells of a worksheet (that does not contain the macro) and then save the file as a new xlsm file, is it possible that it breaks the macro?
&lt;br&gt;
&lt;br&gt;
I am not the author of the macro and I am trying to figure out whether the error is in using EPPlus or the macro is wrong.
&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to generate Excel 2010 files.">
      <Posts>
        <Post From="_manvel_" When="12/03/2012 08:38:03">
          <Html>
        
&lt;p&gt;Hi,&amp;nbsp;&lt;/p&gt;
&lt;p&gt;First of all let me to thank you for the awesome job you've done !!!&lt;/p&gt;
&lt;p&gt;I could make few samples to generate Excel files, thou all of them were Excel 2007 files. On the homepage of this project it says&lt;/p&gt;
&lt;p&gt;"&amp;nbsp;Create advanced Excel 2007/2010 spreadsheets on the server&amp;nbsp;", so I guess it's possible to generate Excel 2010 files as well. Can you guys point me to right direction, how should I generate Excel 2010 files ?&lt;/p&gt;
&lt;p&gt;Thanks in advance.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="12/03/2012 12:17:29">
          <Html>
        
&lt;p&gt;Yes, you can generate spreadsheets based on OOXML ( Excel 2007/2010 ). Take a look at our FAQ and download the lastest version of EPPlus. There is a sample project to guide you.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Download:&amp;nbsp;&lt;a href="http://epplus.codeplex.com/releases/view/79802" rel="nofollow"&gt;http://epplus.codeplex.com/releases/view/79802&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;FAQ:&amp;nbsp;&lt;a href="http://epplus.codeplex.com/wikipage?title=FAQ&amp;amp;referringTitle=Documentation" rel="nofollow"&gt;http://epplus.codeplex.com/wikipage?title=FAQ&amp;amp;referringTitle=Documentation&lt;/a&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="_manvel_" When="12/03/2012 13:20:24">
          <Html>
        
&lt;p&gt;Thanks !!!&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="galmok" When="28/02/2014 15:52:03">
          <Html>
        &lt;div class="markDownOutput "&gt;I have been searching for the Excel 2010 option, but it has eluded me. Could you point me in the right direction? I am specifically looking to use the 2010 version of the DataBar Conditional Formatting as it supports border color and non-gradient fill.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="28/02/2014 19:14:43">
          <Html>
        &lt;div class="markDownOutput "&gt;In theory, all features we have in EPPlus are the same in Excel 2007 and 2010, so there is option to choose. If you didn´t find something, it is because we don´t have yet.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="galmok" When="03/03/2014 08:32:24">
          <Html>
        &lt;div class="markDownOutput "&gt;So what you are saying is that EPPlus implements the features comming to both Excel 2007 and Excel 2010. This of course makes the document readable for both programs. Are there any plans to support dedicated Excel 2010 features (like the more advanced
 DataBars)?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Set default filter on tables">
      <Posts>
        <Post From="ravivenkat" When="28/02/2014 14:51:16">
          <Html>
        &lt;div class="markDownOutput "&gt;I have created a set of tables on excel using EPPlus. Can I turn on a default filter which is set when the file is opened?
&lt;br&gt;
&lt;br&gt;
e.g. A table with certain scores are created. Though I want all the data present in the table, I need a filter on the table showing only scores &amp;gt; '##'.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Setting the Created data on the workbook">
      <Posts>
        <Post From="galmok" When="28/02/2014 10:29:42">
          <Html>
        &lt;div class="markDownOutput "&gt;How do I set the Created (and Last Modified) dates on a workbook?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="[InvalidOperationException: Error saving file sample.xlsx]">
      <Posts>
        <Post From="Engins" When="26/02/2014 16:13:20">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello there, &lt;br&gt;
i'm getting an error saving file when i publish the web site. &lt;br&gt;
it is running good on compiler but not when it published. &lt;br&gt;
i searched about this error but cant find solution. &lt;br&gt;
what can i do ? &lt;br&gt;
&lt;br&gt;
whole error is like this ; &lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
[DirectoryNotFoundException: Could not find a part of the path 'c:\made4me\madeforme26021809.xlsx'.]
&lt;br&gt;
System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath) +216 &lt;br&gt;
System.IO.FileStream.Init(String path, FileMode mode, FileAccess access, Int32 rights, Boolean useRights, FileShare share, Int32 bufferSize, FileOptions options, SECURITY_ATTRIBUTES secAttrs, String msgPath, Boolean bFromProxy, Boolean useLongPath) +2481
&lt;br&gt;
System.IO.FileStream..ctor(String path, FileMode mode, FileAccess access, FileShare share, Int32 bufferSize, FileOptions options, String msgPath, Boolean bFromProxy) +229
&lt;br&gt;
System.IO.FileStream..ctor(String path, FileMode mode) +106 &lt;br&gt;
OfficeOpenXml.ExcelPackage.Save() +610 &lt;br&gt;
&lt;br&gt;
[InvalidOperationException: Error saving file c:\made4me\madeforme26021809.xlsx] &lt;br&gt;
OfficeOpenXml.ExcelPackage.Save() +2128 &lt;br&gt;
Web.OrderList.BtnExcel_Click(Object sender, EventArgs e) +4757 &lt;br&gt;
System.Web.UI.WebControls.Button.RaisePostBackEvent(String eventArgument) +154 &lt;br&gt;
System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +3707
&lt;br&gt;
&lt;br&gt;
regards&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="pragneshmpatel" When="27/02/2014 16:52:45">
          <Html>
        &lt;div class="markDownOutput "&gt;Do you create file from template? &lt;br&gt;
It shows directory not found. means the output directory is not present in your webserver.
&lt;br&gt;
Please post some code or just check made4me directory is present and location is correct.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Pivottable data in plain table">
      <Posts>
        <Post From="pragneshmpatel" When="27/02/2014 15:47:14">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
Is there any way to get Pivoted data in simple table. &lt;br&gt;
i mean i have created pivot table &amp;amp; chart. &lt;br&gt;
but in my export we want to show pivoted table as simple table + chart generated from that simple table.
&lt;br&gt;
&lt;br&gt;
I can not find any property of PivotTable to get data out of it.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Hyperlink in shapes">
      <Posts>
        <Post From="stjom" When="19/09/2011 10:41:52">
          <Html>
        
&lt;p&gt;Hi!&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Is it possible to add hyperlink in ExcelShape object?&lt;/p&gt;
&lt;p&gt;Thanks!&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="20/09/2011 20:16:40">
          <Html>
        
&lt;p&gt;No, not in the current release&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="axlns" When="26/02/2014 13:41:32">
          <Html>
        &lt;div class="markDownOutput "&gt;Any plans on adding support for this?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="ExcelHyperlink for Shape">
      <Posts>
        <Post From="xuexue87" When="27/06/2013 11:40:28">
          <Html>
        &lt;div class="markDownOutput "&gt;Dear All, &lt;br&gt;
&lt;br&gt;
I have been try for few hour. I want to make my shape to be a ExcelHyperLink but it just doesn't work. I create the shape dynamically but I couldn't make it to be ExcelHyperLink. Is this version is available for doing that.
&lt;br&gt;
&lt;br&gt;
Thank you &lt;br&gt;
&lt;br&gt;
Regards, &lt;br&gt;
Nicholas&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="ErickR" When="02/07/2013 17:46:03">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello, &lt;br&gt;
I'm actually having the same problem that you are, and as soon as I find out how to deal with that problem, the sooner I can finish my program.
&lt;br&gt;
So, if anyone there knows whether this version supports this function or not, can you speak up ?
&lt;br&gt;
And if it does, how do we do that? &lt;br&gt;
&lt;br&gt;
Thank you very much, &lt;br&gt;
&lt;br&gt;
Regards, &lt;br&gt;
Erick.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="axlns" When="26/02/2014 13:40:47">
          <Html>
        &lt;div class="markDownOutput "&gt;Having the same problem; Any plans on adding support for this. This is very useful to create shapes looking like buttons to redirect user to different worksheets, so filters can be emulated.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Unable to open worksheet">
      <Posts>
        <Post From="htbrady" When="21/11/2011 22:30:01">
          <Html>
        
&lt;pre&gt;&lt;span&gt;&lt;pre&gt;&lt;span&gt;I have been using the EPPlus library and really getting along great with it.  However, I have hit the following snag using a couple of Excel files.  When executing the code below.  I get the following error message.  I am lost on what to try to fix this?&lt;br&gt;&lt;br&gt;&lt;/span&gt;&lt;/pre&gt;
&lt;pre&gt;FileInfo&amp;nbsp;existingFile&amp;nbsp;=&amp;nbsp;new&amp;nbsp;FileInfo(filePath);&lt;/pre&gt;
&lt;/span&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;span&gt;using&lt;/span&gt;&amp;nbsp;(&lt;span&gt;ExcelPackage&lt;/span&gt;&amp;nbsp;package&amp;nbsp;=&amp;nbsp;&lt;span&gt;new&lt;/span&gt;&amp;nbsp;&lt;span&gt;ExcelPackage&lt;/span&gt;(existingFile))&lt;/pre&gt;
&lt;pre&gt;{&lt;span&gt;	&lt;/span&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;span style="white-space: pre;"&gt;&lt;pre&gt;&lt;span&gt;// this line throws the error...&lt;/span&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;span&gt;ExcelWorksheet&lt;/span&gt;&amp;nbsp;sheet&amp;nbsp;=&amp;nbsp;package.Workbook.Worksheets[&lt;span&gt;"COVER"&lt;/span&gt;];
&lt;/pre&gt;
&lt;/span&gt;&lt;/pre&gt;
&lt;pre&gt;}&lt;/pre&gt;
&lt;pre&gt;&lt;br&gt;&lt;/pre&gt;
&lt;pre&gt;******************************************************************************************************&lt;/pre&gt;
&lt;pre&gt;&lt;br&gt;&lt;/pre&gt;
&lt;pre&gt;System.Exception was unhandled by user code&amp;nbsp; Message=Invalid Address format BTNINSTRUCTIONS_CLICK&amp;nbsp; Source=EPPlus&amp;nbsp; StackTrace:&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;at OfficeOpenXml.ExcelCellBase.GetRowCol(String address, Int32&amp;amp; row, Int32&amp;amp; col, Boolean throwException)&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;at OfficeOpenXml.ExcelCellBase.GetRowColFromAddress(String CellAddress, Int32&amp;amp; Row, Int32&amp;amp; Column)&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;at OfficeOpenXml.ExcelCellBase.GetRowColFromAddress(String CellAddress, Int32&amp;amp; FromRow, Int32&amp;amp; FromColumn, Int32&amp;amp; ToRow, Int32&amp;amp; ToColumn)&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;at OfficeOpenXml.ExcelAddressBase.SetAddress(String address)&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;at OfficeOpenXml.ExcelAddressBase..ctor(String address)&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;at OfficeOpenXml.ExcelAddress..ctor(String address)&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;at OfficeOpenXml.ExcelWorkbook.GetDefinedNames()&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;at OfficeOpenXml.ExcelPackage.get_Workbook()&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;at Consolidations20xx.Y34File.SheetExists(Int32 fileId, String sheetName) in C:\SourceControl\Consolidations20xx\Consolidations20xx\Classes\Y34File.cs:line 236&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;at Consolidations20xx.FileList.btnProcessFiles_Click(Object sender, EventArgs e) in C:\SourceControl\Consolidations20xx\Consolidations20xx\FileList.aspx.cs:line 62&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;at DevExpress.Web.ASPxEditors.ASPxButton.OnClick(EventArgs e)&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;at DevExpress.Web.ASPxEditors.ASPxButton.RaisePostBackEvent(String eventArgument)&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;at DevExpress.Web.ASPxClasses.ASPxWebControl.System.Web.UI.IPostBackEventHandler.RaisePostBackEvent(String eventArgument)&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;at System.Web.UI.Page.RaisePostBackEvent(IPostBackEventHandler sourceControl, String eventArgument)&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;at System.Web.UI.Page.RaisePostBackEvent(NameValueCollection postData)&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;at System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint)&amp;nbsp; InnerException:&amp;nbsp;&lt;br&gt;&lt;/pre&gt;
&lt;pre&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span style="white-space: pre;"&gt;	&lt;/span&gt;&lt;/pre&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="28/11/2011 06:28:39">
          <Html>
        
&lt;p&gt;Something in your template file causes the component to crash. Make sure you don't use any features not supported by EPPlus. Otherwise create an issue and upload your file, so I can have a look at it.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="htbrady" When="30/11/2011 23:03:55">
          <Html>
        
&lt;p&gt;Thanks. &amp;nbsp;I will upload the file for you to look at. &amp;nbsp;I appreciate your help as all my files are throwing this error.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="htbrady" When="06/12/2011 14:57:47">
          <Html>
        
&lt;p&gt;Please let me know if I can provide any more information on this. &amp;nbsp;I am really stuck here. &amp;nbsp;I have submitted an issue and uploaded my file. &amp;nbsp;Thank you very much for your time and help.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="DrPein" When="12/12/2011 17:23:27">
          <Html>
        
&lt;p&gt;Hiya&lt;/p&gt;
&lt;p&gt;I got the same issue with some random(?) files.&lt;/p&gt;
&lt;p&gt;I am still not sure what the underlying cause is, but it "helps" as a work-around&amp;nbsp;to save the Excel file in a different format, like OpenDocument Spreadsheet (ODS), then open that new file and save it back as an Excel workbook.&lt;/p&gt;
&lt;p&gt;Cheers&lt;/p&gt;
&lt;p&gt;Martin&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="msm2020" When="25/02/2014 12:00:12">
          <Html>
        &lt;div class="markDownOutput "&gt;i have same problem :( no solution &lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to collapse rows and columns in Pivot table">
      <Posts>
        <Post From="JayantRimza" When="22/02/2014 13:14:09">
          <Html>
        &lt;div class="markDownOutput "&gt;HI, &lt;br&gt;
&lt;br&gt;
Is there any way to collapse row and column in Pivot table. &lt;br&gt;
&lt;br&gt;
It can be easy done by using excel macro &lt;br&gt;
&lt;br&gt;
pivotfields("name").ShowDetails = false &lt;br&gt;
&lt;br&gt;
I know we can write macro and create xlsm file, I do not want to do it.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Remove dependency on System.Web to Enable .NET client profile support">
      <Posts>
        <Post From="ArsalanAhmad" When="18/08/2013 08:22:52">
          <Html>
        &lt;div class="markDownOutput "&gt;I think if you make a separate version of this great tool that does not have anything to do with ASP, you can not only reduce the size of the assembly but also enable applications to be targeted for client profile versions of .NET&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="richardtallent" When="19/08/2013 06:27:45">
          <Html>
        &lt;div class="markDownOutput "&gt;IIRC, the reason for the System.Web reference has nothing to do with ASP.NET itself, it's because Excel uses HTML's named character references in its XML rather than all-numeric references and the 4.0 BCL doesn't have another built-in option for decoding
 these references. &lt;br&gt;
&lt;br&gt;
I have a replacement HtmlDecode function I'd like to submit, but my last few submissions seems to have disappeared without a trace in the current build, and I'm losing faith that the maintainers of this library will roll up the many important fixes over the
 last year and actually release something (the last stable release was almost a year and a half ago).&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="richardtallent" When="19/08/2013 06:53:25">
          <Html>
        &lt;div class="markDownOutput "&gt;Ok, I finally found my last submission, it's in the branch called "FormulaParser." I'm very new to CodePlex and have no idea WTH these branches mean or why this one is sitting around for a year without being merged into default.
&lt;br&gt;
&lt;br&gt;
I'll see if I can fork that branch, add my HtmlDecode function, and submit a pull request (I think I got all the terminology right there). At least that will remove the dependency that I added while working around a bug in SecurityElement.Escape (a bug that
 is still there in the default branch). &lt;br&gt;
&lt;br&gt;
It looks like FormulaParser inexplicably also contains the code that works around the buggy System.IO.Packaging BCL, so I'm crossing my fingers I can start using this branch in production.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="CurtisMoostoos" When="08/11/2013 23:30:20">
          <Html>
        &lt;div class="markDownOutput "&gt;Did you have any luck including your replacement for HtmlDecode? I would like very much to run it using the .net client profile.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="richardtallent" When="01/12/2013 05:41:07">
          <Html>
        &lt;div class="markDownOutput "&gt;It appears the references are gone in the latest version of the FormulaParser branch. I saw one reference to include System.Web still there, but nothing called within that library.
&lt;br&gt;
&lt;br&gt;
I still think there are some underlying bugs in how EPPlus handles escaped characters versus how Excel handles them, but I haven't had a chance to really dig into it.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="geregam" When="21/02/2014 03:23:53">
          <Html>
        &lt;div class="markDownOutput "&gt;It looks like the dependency was introduced on 3/19/2013 for the HttpUtility.UrlDecode function.
&lt;br&gt;
&lt;br&gt;
The repository seems to be down at the moment, but one could try using System.Uri.UnescapeDataString as a replacement function. I don't see any tests so I wouldn't know if that function fully worked.
&lt;br&gt;
&lt;br&gt;
As of right now i'm using 3.0.0.2 to keep the System.Web reference out and allow me to use the client profile.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Can't re-call package.save()">
      <Posts>
        <Post From="iquestor" When="02/01/2014 21:25:44">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
I've seen similar threads, but no answers to my issue. &lt;br&gt;
&lt;br&gt;
I have an application that gets information from each PDF File in a given folder.
&lt;br&gt;
For each PDF File, there are 1 or more rows of information which need to be stored in a common Excel file.
&lt;br&gt;
&lt;br&gt;
I have written a function that is called for each PDF file. It does the following:&lt;br&gt;
&lt;ol&gt;
&lt;li&gt;Opens excel file using EPPlus &lt;/li&gt;&lt;li&gt;Gets the next row # (col a value) to be written to by examining contents of col a.
&lt;/li&gt;&lt;li&gt;writes row(s) into the excel file based on data collected from the PDF File &lt;/li&gt;&lt;li&gt;Saves the package &lt;br&gt;
&lt;/li&gt;&lt;/ol&gt;
Problem:&lt;br&gt;
&lt;br&gt;
I cannot seem to run the function twice, it fails on package.save() on the second call.
&lt;br&gt;
&lt;ul&gt;
&lt;li&gt;My function processes first file processes perfectly. &lt;/li&gt;&lt;li&gt;My function throws an exception on the second file when package.save() is called.
&lt;/li&gt;&lt;li&gt;{"Index was outside the bounds of the array."}&lt;br&gt;
at OfficeOpenXml.Utils.CompoundDocument.GetChunk(Byte[] compBuffer, Int32&amp;amp; pos)&lt;br&gt;
at OfficeOpenXml.Utils.CompoundDocument.DecompressPart(Byte[] part, Int32 startPos)&lt;br&gt;
at OfficeOpenXml.VBA.ExcelVbaProject.ReadModules()&lt;br&gt;
at OfficeOpenXml.VBA.ExcelVbaProject.GetProject()&lt;br&gt;
at OfficeOpenXml.VBA.ExcelVbaProject..ctor(ExcelWorkbook wb)&lt;br&gt;
at OfficeOpenXml.ExcelWorkbook.get_VbaProject()&lt;br&gt;
at OfficeOpenXml.ExcelWorkbook.Save()&lt;br&gt;
at OfficeOpenXml.ExcelPackage.Save()&lt;br&gt;
&lt;/li&gt;&lt;li&gt;If I open the excel file in Windows (using Excel) and press the Save button, then close it, I can
&lt;br&gt;
rerun my function, and it works. &lt;br&gt;
&lt;/li&gt;&lt;li&gt;no other code is opening the excel file in any way, nor is the excel file open in Windows when error occurs.
&lt;br&gt;
&lt;/li&gt;&lt;/ul&gt;
&amp;lt;begin code snip&amp;gt;&lt;br&gt;
&lt;pre&gt;&lt;code&gt;    private void exportToExcel()
    {
             FileInfo myExcelOutputFile = new FileInfo(myFile);
            ExcelPackage package = new ExcelPackage(myExcelOutputFile);

            //Open worksheet 1 - "main"
            ExcelWorksheet worksheet = package.Workbook.Worksheets["Main"];

            // do work
            int lvIndx = 0, row = 0, count = 0, nextRow = 0;
&lt;/code&gt;&lt;/pre&gt;
//Select all cells in column a that have a data type double value (as opposed to blank)&lt;br&gt;
var query1 = (from cell in worksheet.Cells["a:a"] where cell.Value is double select cell);&lt;br&gt;
&lt;br&gt;
// find last row with a valid datatype double value&lt;br&gt;
foreach (var cell in query1) { count++; }&lt;br&gt;
&lt;br&gt;
// offset for initial header row &lt;br&gt;
&lt;pre&gt;&lt;code&gt;            nextRow = count + 2;


            // add data from myitems to the excel sheet, 1 row at a time
    for (; lvIndx &amp;lt; myPDFItems.Count; lvIndx++)
                {
                    row = lvIndx + nextRow; // calc the next row
                    worksheet.InsertRow(row, 1);
                    worksheet.Cells[row, 1].Value = Convert.ToDouble(myNextPDFID); 
                    worksheet.Cells[row, 2].Value = "info"; 
                    worksheet.Cells[row, 3].Value = myNextPDFBkmrkdesc;                                    
                }

           // save our new workbook and we are done!

           try
           {
            //fails for second file!
    package.Save();

           }

           catch (Exception eppMsg)
           {

             MessageBox.Show(eppMsg.Message);
           }

        }
    }
&lt;/code&gt;&lt;/pre&gt;
&amp;lt;/end code snip&amp;gt;&lt;br&gt;
&lt;br&gt;
I've tried: &lt;br&gt;
package.SaveAs(differentExcelFileName); // same error&lt;br&gt;
package.Dispose(); // same error&lt;br&gt;
package = null; // same error&lt;br&gt;
&lt;br&gt;
I don't know what " index would be out of bounds" but thought maybe my code was doing it, so I tried a simple function where i just open the excel file, then call package.save(), without doing any processing whatsoever, and I still get the error.
 see test code below:&lt;br&gt;
&lt;br&gt;
&amp;lt;begin test code snip&amp;gt;&lt;br&gt;
&lt;pre&gt;&lt;code&gt;    private void exportToExcel()
    {
            FileInfo myExcelOutputFile = new FileInfo(myFile);
            ExcelPackage package = new ExcelPackage(myExcelOutputFile);

            //Open worksheet 1 - "main"
            ExcelWorksheet worksheet = package.Workbook.Worksheets["Main"];

           try
           {
            //fails for second call!
    package.Save();

           }

           catch (Exception eppMsg)
           {

             MessageBox.Show(eppMsg.Message);
           }    
    }
&lt;/code&gt;&lt;/pre&gt;
&amp;lt;/end code snip&amp;gt;&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Any help would be appreciated!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mjbiddle" When="20/02/2014 22:07:54">
          <Html>
        &lt;div class="markDownOutput "&gt;Maybe there is a problem with calling the Dispose directly. Have you tried: &lt;br&gt;
&lt;br&gt;
&lt;br&gt;
// the using statement automatically calls Dispose() which closes the package. &lt;br&gt;
using (ExcelPackage package = new ExcelPackage(newFile)) &lt;br&gt;
{ &lt;br&gt;
&lt;br&gt;
}&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Execute a macro (vba script) and then remove it to Save as XLSX?">
      <Posts>
        <Post From="murali7" When="17/01/2013 19:52:51">
          <Html>
        
&lt;p&gt;Hello ppl,&lt;/p&gt;
&lt;p&gt;My title says a lot about what I wish to achive. The library as such was very helpful for me. I was just wondering if i could execute the script i added to my file and then remove it after it executed and still save the file as a xlsx?&lt;/p&gt;
&lt;p&gt;The VBA script just formats and groups my data and I wold like to hold on to the formatting when i remove the VBA part.&lt;/p&gt;
&lt;p&gt;Looking for some code samples as I was not able to find any in the sample projects and I am very new to coding. Any help is appreciated.&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;
&lt;p&gt;Ron&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="xav2075" When="18/01/2013 15:34:32">
          <Html>
        
&lt;p&gt;A better approach cold be to do some .NET code that uses epplus to organize, group and format the data in a spreadsheet worksheet without having to use a VBA macro.&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Otherwise -&lt;/p&gt;
&lt;p&gt;The epplus OpenXML wrapper can do a lot but not everything that OpenXML covers.&amp;nbsp; Using my google and stackoverflow.com search IQ implant I bolted together some OpenXml code I found that can open a .xslm spreadsheet file that has macros, remove them,
 save the xlsm file, re-open the xlsm file and save it as a xlsx file:&amp;nbsp; You need to install the Open Office XML SDK (http://www.microsoft.com/en-us/download/details.aspx?id=30425) as the code below does not use epplus&lt;/p&gt;
&lt;p&gt;(.NET 4.0 project)&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;using&lt;/span&gt; System;
&lt;span style="color: blue;"&gt;using&lt;/span&gt; System.Collections.Generic;
&lt;span style="color: blue;"&gt;using&lt;/span&gt; System.Linq;
&lt;span style="color: blue;"&gt;using&lt;/span&gt; System.Text;
&lt;span style="color: blue;"&gt;using&lt;/span&gt; DocumentFormat.OpenXml; &lt;span style="color: green;"&gt;// References C:\Program Files (x86)\Open XML SDK\V2.5\lib\DocumentFormat.OpenXml.dll&lt;/span&gt;
&lt;span style="color: blue;"&gt;using&lt;/span&gt; DocumentFormat.OpenXml.Packaging;
&lt;span style="color: blue;"&gt;using&lt;/span&gt; DocumentFormat.OpenXml.Spreadsheet;
&lt;span style="color: blue;"&gt;using&lt;/span&gt; System.IO; &lt;span style="color: green;"&gt;// References : C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework\.NETFramework\v4.0\Profile\Client\WindowsBase.dll&lt;/span&gt;

&lt;span style="color: blue;"&gt;namespace&lt;/span&gt; RemoveExcelMacros1
{
  &lt;span style="color: blue;"&gt;class&lt;/span&gt; Program
  {
    &lt;span style="color: blue;"&gt;static&lt;/span&gt; &lt;span style="color: blue;"&gt;void&lt;/span&gt; Main(&lt;span style="color: blue;"&gt;string&lt;/span&gt;[] args)
    {
      DocumentFormat.OpenXml.Packaging.SpreadsheetDocument document = SpreadsheetDocument.Open(&lt;span style="color: rgb(163, 21, 21);"&gt;@"d:\sample1.xlsm"&lt;/span&gt;, &lt;span style="color: blue;"&gt;true&lt;/span&gt;);
      document.WorkbookPart.DeletePart(document.WorkbookPart.VbaProjectPart); &lt;span style="color: green;"&gt;// Remove all macros&lt;/span&gt;
      document.Dispose(); &lt;span style="color: green;"&gt;// Save sample1.xlsm file that has no macros&lt;/span&gt;
      &lt;span style="color: blue;"&gt;byte&lt;/span&gt;[] byteArray = File.ReadAllBytes(&lt;span style="color: rgb(163, 21, 21);"&gt;@"d:\sample1.xlsm"&lt;/span&gt;);
      &lt;span style="color: blue;"&gt;using&lt;/span&gt; (MemoryStream stream = &lt;span style="color: blue;"&gt;new&lt;/span&gt; MemoryStream())
      {
        stream.Write(byteArray, 0, (&lt;span style="color: blue;"&gt;int&lt;/span&gt;)byteArray.Length);
        &lt;span style="color: blue;"&gt;using&lt;/span&gt; (SpreadsheetDocument spreadsheetDoc = SpreadsheetDocument.Open(stream, &lt;span style="color: blue;"&gt;true&lt;/span&gt;))
        {
          &lt;span style="color: green;"&gt;// Change from template .xlsm type to workbook .xlsx type&lt;/span&gt;
          spreadsheetDoc.ChangeDocumentType(SpreadsheetDocumentType.Workbook);
        }
        File.WriteAllBytes(&lt;span style="color: rgb(163, 21, 21);"&gt;@"d:\sample1.xlsx"&lt;/span&gt;, stream.ToArray());
      }
      Console.Write(&lt;span style="color: rgb(163, 21, 21);"&gt;"Program finished.  Press a key\n"&lt;/span&gt;);
    }
  }
}
&lt;br&gt;&lt;br&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;The original Sample1.xlsm is not deleted.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="murali7" When="18/01/2013 16:53:19">
          <Html>
        
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;a href="http://www.codeplex.com/site/users/view/xav2075" rel="nofollow"&gt;xav2075&lt;/a&gt;: That worked as a charm. Thanks&lt;/p&gt;
&lt;p&gt;I was trying to do the same thing but I tried using EPPlus's WorrkBook.VBAProject.Remove() to get rid of the VBA Part. That helped me get the code out but still kept the format as MacroEnabled even when i did the Format change as you have done in your code.&amp;nbsp;&lt;/p&gt;
&lt;p&gt;But that was a good learning process for me.&amp;nbsp;&lt;br&gt;
Thanks for your help&lt;/p&gt;
&lt;p&gt;Ron&amp;nbsp;&lt;/p&gt;
&lt;p&gt;PS: i tried something like this&lt;span style="font-size: 10pt;"&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;Dim&lt;/span&gt; fmtPck &lt;span style="color: blue;"&gt;As&lt;/span&gt; &lt;span style="color: blue;"&gt;New&lt;/span&gt; ExcelPackage(newFile)
fmtPck.Workbook.VbaProject.Remove()
fmtPck.Save()
fmtPck.Dispose()
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="xav2075" When="18/01/2013 19:44:02">
          <Html>
        
&lt;p&gt;Ah I forgot to search the epplus help chm file for vba as well as macro.&amp;nbsp; I tried the .VbaProject.Remove and it does remove all macros but still saves the Excel xml zipped package in xlsm format.&amp;nbsp; Looking in epplus I was not able to find anything
 that does spreadsheetDoc.ChangeDocumentType(SpreadsheetDocumentType.Workbook); as in the OpenXml code I posted above.&lt;/p&gt;
&lt;p&gt;The code below loads an existing xlsm spreadsheet and injects it into excel_package.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;pre style="background: white; color: black; font-family: Consolas;"&gt;&lt;span style="color: blue;"&gt;using&lt;/span&gt;&amp;nbsp;System;
&lt;span style="color: blue;"&gt;using&lt;/span&gt;&amp;nbsp;System.Collections.Generic;
&lt;span style="color: blue;"&gt;using&lt;/span&gt;&amp;nbsp;System.Linq;
&lt;span style="color: blue;"&gt;using&lt;/span&gt;&amp;nbsp;System.Text;
&lt;span style="color: blue;"&gt;using&lt;/span&gt;&amp;nbsp;System.IO;
&lt;span style="color: blue;"&gt;using&lt;/span&gt;&amp;nbsp;OfficeOpenXml;
 
&lt;span style="color: blue;"&gt;namespace&lt;/span&gt;&amp;nbsp;RemoveExcelMacros_using_epplus1
{
&amp;nbsp;&amp;nbsp;&lt;span style="color: blue;"&gt;class&lt;/span&gt;&amp;nbsp;&lt;span style="color: rgb(43, 145, 175);"&gt;Program&lt;/span&gt;
&amp;nbsp;&amp;nbsp;{
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span style="color: blue;"&gt;static&lt;/span&gt;&amp;nbsp;&lt;span style="color: blue;"&gt;void&lt;/span&gt;&amp;nbsp;Main(&lt;span style="color: blue;"&gt;string&lt;/span&gt;[]&amp;nbsp;args)
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span style="color: rgb(43, 145, 175);"&gt;FileInfo&lt;/span&gt;&amp;nbsp;xlsm_template&amp;nbsp;=&amp;nbsp;&lt;span style="color: blue;"&gt;new&lt;/span&gt;&amp;nbsp;&lt;span style="color: rgb(43, 145, 175);"&gt;FileInfo&lt;/span&gt;(&lt;span style="color: rgb(163, 21, 21);"&gt;@"d:\sample1.xlsm"&lt;/span&gt;);&amp;nbsp;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span style="color: rgb(43, 145, 175);"&gt;FileInfo&lt;/span&gt;&amp;nbsp;newFile&amp;nbsp;=&amp;nbsp;&lt;span style="color: blue;"&gt;new&lt;/span&gt;&amp;nbsp;&lt;span style="color: rgb(43, 145, 175);"&gt;FileInfo&lt;/span&gt;(&lt;span style="color: rgb(163, 21, 21);"&gt;@"d:\sample1.xlsx"&lt;/span&gt;);
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span style="color: rgb(43, 145, 175);"&gt;ExcelPackage&lt;/span&gt;&amp;nbsp;excel_package&amp;nbsp;=&amp;nbsp;&lt;span style="color: blue;"&gt;new&lt;/span&gt;&amp;nbsp;&lt;span style="color: rgb(43, 145, 175);"&gt;ExcelPackage&lt;/span&gt;(newFile,&amp;nbsp;xlsm_template);
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;excel_package.Workbook.VbaProject.Remove();
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;excel_package.Save();&amp;nbsp;&lt;span style="color: green;"&gt;//&amp;nbsp;Saves&amp;nbsp;sample1.xlsx&amp;nbsp;but&amp;nbsp;Excel&amp;nbsp;won't&amp;nbsp;open&amp;nbsp;it&amp;nbsp;unless&amp;nbsp;.xlsx&amp;nbsp;extension&amp;nbsp;is&amp;nbsp;changed&amp;nbsp;to&amp;nbsp;.xlsm&lt;/span&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}
&amp;nbsp;&amp;nbsp;}
}
&lt;/pre&gt;

        
    </Html>
        </Post>
        <Post From="mjbiddle" When="20/02/2014 21:48:59">
          <Html>
        &lt;div class="markDownOutput "&gt;I see your description from a while back. I have the similar situation. I want to create a spreadsheet on the fly (from asp.net) by filling from db. Then I want to create a macro/vba in that spreadsheet by reading in text file that contains lots of formatting
 code. I then want to Run the vba code and then allow the user to save as .xlsx. When in Excel directly I can create a macro and run the code without having to save the file first.
&lt;br&gt;
&lt;br&gt;
I do not see anywhere in the above discussion or in the epplus samples where vba code is actually being executed, like Workbook.Module("FormatMyXls").Run . I see where I can create a Sub Workbook_Open with the code but I think that would require that
 I save and close the .xlsm file on the server and then reopen it. I tried creating code on the Worksheet_Activate but that wont work programatically, works okay in UI.&lt;br&gt;
&lt;br&gt;
The reason I want the VBA code in a separate file as there are many spreadsheets and I dont want to have to recompile a .net application when it is just a formatting change. This way I can maintain all of the formatting vba code by opening up excel directly
 and saving the new vba to a text file and read it in from asp app when i need it.&lt;br&gt;
&lt;br&gt;
This is a bug in epplus. There is something happening within Excel that detects when the VBA code is removed it is okay to save as xlsx. epplus needs to find out what this internal 'switch' is and implement it. I have been able to implement the techniqes in
 the samples provided by epplus and mentioned above, but this bug is prohibiting me from coming up with a really nice solution. As of now I will just be having the user save as xlsm and then have them manually remove the code and save as xlsx.&lt;br&gt;
&lt;br&gt;
So Epplus here are my issues:&lt;br&gt;
Implement a fix for xlmx save&lt;br&gt;
Implement a Module.Run&lt;br&gt;
Implement a Worksheet.Select("name") -- not select a cell or range to activate&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Clear data in column">
      <Posts>
        <Post From="techSUPPORT" When="20/02/2014 18:13:29">
          <Html>
        &lt;div class="markDownOutput "&gt;How do I go about clearing all the data in a specific column, or is this possible?
&lt;br&gt;
&lt;br&gt;
I attempted to simply clear the data out of a cell like so but didn't have any luck.
&lt;br&gt;
&lt;pre&gt;&lt;code&gt;if (File.Exists(path))
{
    //Connect to spreadsheet
    FileStream stream = File.Open(path, FileMode.Open, FileAccess.Read);
    FileInfo file = new FileInfo(path);
    _package = new ExcelPackage();

    //Pull data into EPPlus object
    _package.Load(stream);
    _sheet = _package.Workbook.Worksheets.First(); 

    //Clear out previous errors
    _sheet.Cells["L1"].Clear();
}&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Code working only when i use a break point">
      <Posts>
        <Post From="youneslami" When="20/02/2014 10:50:00">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi everyone,&lt;br&gt;
&lt;br&gt;
I am a new user of the EPPlus library.&lt;br&gt;
&lt;br&gt;
I have problems with saving and accessing the Excel file.&lt;br&gt;
&lt;br&gt;
the error occure on this part of the code :&lt;br&gt;
&lt;br&gt;
&lt;strong&gt;this.xlSheet = this.package.Workbook.Worksheets[indexFeuille];&lt;/strong&gt;&lt;br&gt;
indexFeuille = 1&lt;br&gt;
&lt;strong&gt;with&lt;/strong&gt;&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
private ExcelWorksheet xlSheet;&lt;br&gt;
private ExcelPackage package;&lt;br&gt;
&lt;br&gt;
&lt;strong&gt;and&lt;/strong&gt;&lt;br&gt;
&lt;br&gt;
this.package = new ExcelPackage(new FileInfo(pathFin), new FileInfo(pathTemplate));&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
The Template file is a hug excel file with 23 worksheets, charts and links between worksheets.&lt;br&gt;
&lt;br&gt;
I notice that when i set a break point and a thread.sleep(5000) before accessing the worksheet, the program work fine.&lt;br&gt;
&lt;br&gt;
here is the error&lt;br&gt;
&lt;br&gt;
ArgumentOutofRangeException&lt;br&gt;
length cannot be less than zero&lt;br&gt;
&lt;br&gt;
" à System.String.InternalSubStringWithChecks(Int32 startIndex, Int32 length, Boolean fAlwaysCopy)\r\n à System.String.Substring(Int32 startIndex, Int32 length)\r\n à OfficeOpenXml.ExcelAddressBase.SetWbWs(String address)\r\n à OfficeOpenXml.ExcelAddressBase.SetAddress(String
 address)\r\n à OfficeOpenXml.ExcelAddressBase..ctor(String address)\r\n à OfficeOpenXml.ExcelAddress..ctor(String address)\r\n à OfficeOpenXml.ExcelWorkbook.GetDefinedNames()\r\n à OfficeOpenXml.ExcelPackage.get_Workbook()\r\n à GEREMINE.DAO.ExcelDAL.EcrireDataTable(Int32
 indexFeuille, Int32 ligneDepart, Int32 colDepart, Boolean afficherTitreColonnes, DataTable table) dans d:\DTM_IG_SVN\DTM_IG_2_test\App_Code\DAO\ExcelDAL.cs:ligne 141"&lt;br&gt;
&lt;br&gt;
Thks for the help &lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Excel Calculation">
      <Posts>
        <Post From="PrincessLenLen" When="09/02/2014 06:17:55">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
Since EPPlus does not support calculation yet, is there any other way aside from excel interop to calculate my xlsx files?
&lt;br&gt;
&lt;br&gt;
Thanks!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="11/02/2014 12:05:53">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
I don't know any other way. There is a project from swmal ( very early stage ), maybe you can start from there.
&lt;br&gt;
&lt;br&gt;
&lt;a href="https://github.com/swmal/ExcelFormulaParser" rel="nofollow"&gt;https://github.com/swmal/ExcelFormulaParser&lt;/a&gt;
&lt;br&gt;
&lt;br&gt;
Regards, &lt;br&gt;
Thiago&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="15/02/2014 22:21:26">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
we will have a beta available very soon that supports calculation. We are working on the final details in the FormulaParser branch here on codeplex.
&lt;br&gt;
&lt;br&gt;
/Mats&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="PrincessLenLen" When="16/02/2014 05:34:14">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi! &lt;br&gt;
&lt;br&gt;
Thats good to hear. Ill wait for this new feature of EPPlus. Im just going to use interop till this feature has been released.
&lt;br&gt;
&lt;br&gt;
Thanks!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Get NOT Set Cell BackgroundColor">
      <Posts>
        <Post From="pbukowski" When="12/02/2014 20:48:15">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi Jan, &lt;br&gt;
&lt;br&gt;
I've looked everywhere trying to figure out how to read a cell BackgroundColor. I know how to set it, but I can't seem to read it. How would I change this up to read the value in Hex - like #FFFFFF ?
&lt;br&gt;
&lt;br&gt;
Thank you ! &lt;br&gt;
Paul&lt;br&gt;
&lt;pre&gt;&lt;code&gt;ws.Cells["A1"].Value = "Test";
ws.Cells["A1"].Style.Font.Bold = true;
ws.Cells["A1"].Style.Fill.PatternType = ExcelFillStyle.Solid;
ws.Cells["A1"].Style.Fill.BackgroundColor.SetColor(Color.Brown);
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Setting colors of series">
      <Posts>
        <Post From="Watcher01" When="18/12/2010 19:26:48">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I have chart with 2 series - first is column serie, second is line.&lt;/p&gt;
&lt;p&gt;By default color of columns is blue, and line is red.&lt;/p&gt;
&lt;p&gt;Is there any possibility to set those colors manualy?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks in advance for help.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="20/12/2010 07:59:04">
          <Html>
        
&lt;p&gt;No, I haven't added any support for that yet. If it's ok for you to use a template,&amp;nbsp;you can do the changes in Excel.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="watcher01" When="20/12/2010 11:38:23">
          <Html>
        
&lt;p&gt;Thanks Jan for quick answer.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="xazosxazos" When="11/02/2014 11:37:55">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello Jan, &lt;br&gt;
&lt;br&gt;
are you going to add this feature to a future release? &lt;br&gt;
&lt;br&gt;
Thank you, &lt;br&gt;
thomas&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="11/02/2014 12:11:18">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
Our major developers are a little busy in their personal lives. I don't think there will be any new features in EPPlus soon, maybe only some fixes.
&lt;br&gt;
&lt;br&gt;
Regards, &lt;br&gt;
Thiago&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="xazosxazos" When="11/02/2014 12:27:21">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello, &lt;br&gt;
&lt;br&gt;
that is ok, you have already done more than a lot, for this project. &lt;br&gt;
&lt;br&gt;
Thank you for the quick response. &lt;br&gt;
Thomas&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Reading and Saving Existing Excel File- Can't keep column widths">
      <Posts>
        <Post From="ahmetkocadogan" When="10/02/2014 08:54:04">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi there. I have an excel file which has some images and column names, and different column widths at some column. When i read that excel, add some text into cells and save it,i see row and column widths change. And image's width also decreased. How can
 i solve this? &lt;br&gt;
&lt;br&gt;
Thanks from now.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Cannot save() Excel doc on server">
      <Posts>
        <Post From="RogerBall" When="13/11/2012 16:53:12">
          <Html>
        
&lt;p&gt;I have copied Sample4 from the web samples (using EPPLUS V3.1.2). It basically creates a very simple xlsm file with some VBA added. This works fine on my local machine, however when I copy the solution to a web server for testing it errors on the following
 line:&lt;/p&gt;
&lt;p&gt;&lt;em&gt;"Object reference not set to an instance of an object."&lt;/em&gt;&lt;br&gt;
Response.BinaryWrite(pck.GetAsByteArray());&lt;/p&gt;
&lt;p&gt;Not sure it makes any difference but the web server is 64 bit and my local machine is 32 bit? I have tried using the save() method instead of GetAsByteArray() but I get the same result.&amp;nbsp;Has anyone come accross similar issues?&lt;/p&gt;
&lt;p&gt;Here's the stack trace:&lt;br&gt;
[NullReferenceException: Object reference not set to an instance of an object.]&lt;br&gt;
&amp;nbsp;&amp;nbsp; System.Runtime.InteropServices.Marshal.ReleaseComObject(Object o) +132&lt;br&gt;
&amp;nbsp;&amp;nbsp; OfficeOpenXml.Utils.CompoundDocument.Save() +417&lt;br&gt;
&amp;nbsp;&amp;nbsp; OfficeOpenXml.VBA.ExcelVbaProject.Save() +1127&lt;br&gt;
&amp;nbsp;&amp;nbsp; OfficeOpenXml.ExcelWorkbook.Save() +535&lt;br&gt;
&amp;nbsp;&amp;nbsp; OfficeOpenXml.ExcelPackage.GetAsByteArray(Boolean save) +34&lt;br&gt;
&amp;nbsp;&amp;nbsp; OfficeOpenXml.ExcelPackage.GetAsByteArray() +10&lt;br&gt;
&amp;nbsp;&amp;nbsp; Tasks.ibtExportToExcel_Click(Object sender, EventArgs e) in e:\homer.test\ADAS_Systems\System42\Tasks.aspx.cs:583&lt;br&gt;
&amp;nbsp;&amp;nbsp; System.Web.UI.WebControls.ImageButton.OnClick(ImageClickEventArgs e) +108&lt;br&gt;
&amp;nbsp;&amp;nbsp; System.Web.UI.WebControls.ImageButton.RaisePostBackEvent(String eventArgument) +118&lt;br&gt;
&amp;nbsp;&amp;nbsp; System.Web.UI.WebControls.ImageButton.System.Web.UI.IPostBackEventHandler.RaisePostBackEvent(String eventArgument) +10&lt;br&gt;
&amp;nbsp;&amp;nbsp; System.Web.UI.Page.RaisePostBackEvent(IPostBackEventHandler sourceControl, String eventArgument) +13&lt;br&gt;
&amp;nbsp;&amp;nbsp; System.Web.UI.Page.RaisePostBackEvent(NameValueCollection postData) +36&lt;br&gt;
&amp;nbsp;&amp;nbsp; System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +1565&lt;br&gt;
&lt;br&gt;
&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="rogerball" When="14/11/2012 13:30:51">
          <Html>
        
&lt;p&gt;I have recently discovered that the problems I'm experiencing are down to iis, more specifically&amp;nbsp;impersonation. My anonymous user has full access to by bin folder in my web app, does anyone know what else I would need to give the user access to in order
 for EPPlus to work?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="SonicFlare" When="09/02/2014 18:49:57">
          <Html>
        &lt;div class="markDownOutput "&gt;To anyone experiencing this problem, it indicates that you don't have permissions to write to TEMP.
&lt;br&gt;
Also check for pagefile&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="RESOLVED:  Issue using EPPlus with Visual Studio 2012 to get the first worksheet">
      <Posts>
        <Post From="ARW3" When="07/02/2014 17:32:25">
          <Html>
        &lt;div class="markDownOutput "&gt;Wondering if anyone else has had this problem. Using the code below in VS 2012 and it cannot find the ".First()" method. I put the exact same code in VS 2008 and it works fine. I do have the EPPlus.dll file referenced in both solutions. I'm using
 version 3.1.3 of EPPlus too. Anyone know why this would be happening? Thanks in advance.
&lt;br&gt;
&lt;br&gt;
using OfficeOpenXml;&lt;br&gt;
&lt;pre&gt;&lt;code&gt;    protected void btnImportSpreadsheet_Click(object sender, EventArgs e)
    {
        string path = FileUpload1.PostedFile.FileName;
        var excelFile = new FileInfo(path);
        using (var package = new ExcelPackage(excelFile))
        {
            // Get the work book in the file
            ExcelWorkbook workBook = package.Workbook;

            if (workBook != null)
            {
                if (workBook.Worksheets.Count &amp;gt; 0)
                {
                    // Get the first worksheet
                    ExcelWorksheet currentWorksheet = workBook.Worksheets.First();
                }
            }
        }&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="ARW3" When="07/02/2014 17:55:52">
          <Html>
        &lt;div class="markDownOutput "&gt;This was my fault. I guess it took asking the question online in order for me to find the issue. It was not an EPPlus issue. There was something missing in my code.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Formulas in EPPLUS">
      <Posts>
        <Post From="skumar88" When="04/02/2014 07:39:33">
          <Html>
        &lt;div class="markDownOutput "&gt;I have a formula like '=RC[-5]+RC[-4]+RC[-2]' in my stored procedure. I am using LoadFromDataTable helper method to fill data in excel. But the formula which is in my stored procedure is dumping as it is into excel? How to resolve this issue, any help
 appreciated. &lt;br&gt;
&lt;br&gt;
Thanks &lt;br&gt;
Praveen&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="05/02/2014 22:21:13">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
LoadFromDataTable does not recognice formulas, it just set values on cells. To achieve this you have to iterate over your collection or datatable and explicitly set the
&lt;em&gt;Value&lt;/em&gt; or &lt;em&gt;Formula&lt;/em&gt; property on the cells. &lt;br&gt;
&lt;br&gt;
/Mats&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Remove Automatic (Soft) Page Breaks">
      <Posts>
        <Post From="jortgonfreit" When="22/12/2012 14:52:01">
          <Html>
        
&lt;p&gt;I've created a spreadsheet, and set manual page breaks throughout it. The problem is Excel creates an automatic (soft) page break at a very awkward spot. I am creating over 100 spreadsheets, each with at least 10 different worksheets. This is a cumbersome
 task to have to open each file and move that soft page break off the page.&lt;/p&gt;
&lt;p&gt;Is there a way to remove this automatic page break, manipulate it, or just disallow excel from creating automatic page breaks?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="bertvan" When="05/02/2014 20:59:13">
          <Html>
        &lt;div class="markDownOutput "&gt;Same question. Any answers yet?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to do a CSE formula?">
      <Posts>
        <Post From="tlaford" When="04/02/2014 20:42:25">
          <Html>
        &lt;div class="markDownOutput "&gt;Array Formula, CSE Formula, CTRL+SHIFT+ENTER formula - Whatever you call it here's what I'm trying to do:&lt;br&gt;
&lt;ul&gt;
&lt;li&gt;Calculate a row's minimum value excluding cells that have a 0 value &lt;/li&gt;&lt;li&gt;Calculate a row's maximum value excluding cells that have a 0 value &lt;/li&gt;&lt;li&gt;Calculate a row's standard deviation excluding cells that have a 0 value&lt;br&gt;
&lt;/li&gt;&lt;/ul&gt;
By typing the following formulas into an excel spreadsheet and hitting CTRL+SHIFT+ENTER at the end of the formula gives me what I want:&lt;br&gt;
&lt;ul&gt;
&lt;li&gt;Minimum: =MIN(IF(B2:SS2&amp;lt;&amp;gt;0,B2:SS2)) &lt;/li&gt;&lt;li&gt;Maximum: =MAX(IF(B2:SS2&amp;lt;&amp;gt;0,B2:SS2)) &lt;/li&gt;&lt;li&gt;Standard Deviation: =STDEV(IF(B2:SS2&amp;lt;&amp;gt;0,B2:SS2))&lt;br&gt;
&lt;/li&gt;&lt;/ul&gt;
But if I just hit ENTER it gives me an error message (A value used in the formula is of the wrong data type.)
&lt;br&gt;
&lt;br&gt;
When I try to assign these formulas while building a spreadsheet via EPPLUS&lt;br&gt;
&lt;pre&gt;&lt;code&gt;wkst.Cells(row, column).Formula = "min(if(" &amp;amp; range &amp;amp; "&amp;lt;&amp;gt;0," &amp;amp; range &amp;amp; "))"
wkst.Cells(row, column).Formula = "max(if(" &amp;amp; range &amp;amp; "&amp;lt;&amp;gt;0," &amp;amp; range &amp;amp; "))"
wkst.Cells(row, column).Formula = "stdev(if(" &amp;amp; range &amp;amp; "&amp;lt;&amp;gt;0," &amp;amp; range &amp;amp; "))"&lt;/code&gt;&lt;/pre&gt;
these cells give the same error when I open the file, but if it edit the cell and hit CTRL+SHIFT+ENTER it calculates the values just fine.
&lt;br&gt;
&lt;br&gt;
Is there a way to have EPPLUS properly identify these formulas as Array Formulas?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to read Date value into a DateTime datatype">
      <Posts>
        <Post From="ymgrigsb" When="27/04/2011 22:20:13">
          <Html>
        
&lt;p&gt;I am trying to read a date value in Excel into a DateTime datatype in C#.&amp;nbsp; I am not sure how to take the Cell value (which returns as a number) and convert it properly to the correct date.&lt;/p&gt;
&lt;p&gt;In Excel I have a cell value as 1-Oct-2013 with the Cell format as Custom -&amp;gt; d-mmm-yyyy.&lt;/p&gt;
&lt;p&gt;When I look at the Cell[row,col].Styles.NumberFormat.Format value in debugger I see "\\ d\\-mmm\\-yyyy", which is what I expected.&lt;/p&gt;
&lt;p&gt;When I try to DateTime.Parse the Cell[row,col].Value.ToString() on any date value including the one above, I get the result 1/01/0001 12:00:00AM.&amp;nbsp; I was expecting 10/1/2013 12:00:00AM ( the date as&amp;nbsp;found in Excel).&lt;/p&gt;
&lt;p&gt;Here is my code (I am looping through every cell from start to finish and putting each row's values in a List&amp;lt;string&amp;gt;):&lt;/p&gt;
&lt;p&gt;==============&lt;/p&gt;
&lt;p&gt;&amp;nbsp;using (ExcelPackage package = new ExcelPackage(_currentFile))&lt;br&gt;
{&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; ExcelWorksheet worksheet = package.Workbook.Worksheets[worksheetIndex];&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; for (rowIndex = startAtRow; rowIndex &amp;lt; totalRows; rowIndex++)&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; List&amp;lt;string&amp;gt; record = new List&amp;lt;string&amp;gt;();&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; //read whole row&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; for (int columnIndex = 1; columnIndex &amp;lt;= totalColumns; columnIndex++)&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; string format = worksheet.Cells[rowIndex, columnIndex].Style.Numberformat.Format;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; if ( format != "General" &amp;amp;&amp;amp; !format.Contains("#") &amp;amp;&amp;amp; !format.Contains(".") &amp;amp;&amp;amp; !format.Contains("0"))&amp;nbsp;&amp;nbsp;
 //it's a custom date in this file&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; DateTime result;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; DateTime.TryParse(worksheet.Cells[rowIndex, columnIndex].Value.ToString(),out result);&amp;nbsp;&amp;nbsp; //doesn't give the right answer&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; record.Add(result.ToString("dd/mm/yyyy");&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }else if (worksheet.Cells[rowIndex, columnIndex].Value != null)&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; record.Add(worksheet.Cells[rowIndex, columnIndex].Value.ToString());&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; else&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; record.Add("");&amp;nbsp; //add blank string for null cell value&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
}&lt;/p&gt;
&lt;p&gt;=================&lt;/p&gt;
&lt;p&gt;Also, if there is a better way to determine when the format indicates a date type, please let me know, the way I have it now is not coded very well I'm sure.&lt;/p&gt;
&lt;p&gt;Thanks,&lt;/p&gt;
&lt;p&gt;Yvonne&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="ymgrigsb" When="27/04/2011 22:39:08">
          <Html>
        
&lt;p&gt;Answer to the first question:&lt;/p&gt;
&lt;p&gt;long serialDate = long.Parse(worksheet.Cells[row, column].Value.ToString());&lt;br&gt;
DateTime result = DateTime.FromOADate(serialDate);&lt;/p&gt;
&lt;p&gt;Still would like the best way to determine when the Excel cell format indicates a date type value for my conditional statements.&lt;/p&gt;
&lt;p&gt;Thanks,&lt;/p&gt;
&lt;p&gt;Yvonne&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="29/04/2011 07:45:29">
          <Html>
        
&lt;p&gt;Dates are stored as numbers in Excel and the only way to determine the datatype is the numberformat.&lt;/p&gt;
&lt;p&gt;EPPlus will convert any build-in date format to a DateTime value,&amp;nbsp;when the file is loaded. The build in formats are...&lt;/p&gt;
&lt;p&gt;ID Format&lt;/p&gt;
&lt;p&gt;14&amp;nbsp; mm-dd-yy &lt;br&gt;
15&amp;nbsp; d-mmm-yy &lt;br&gt;
16&amp;nbsp; d-mmm &lt;br&gt;
17&amp;nbsp; mmm-yy &lt;br&gt;
18&amp;nbsp; h:mm AM/PM &lt;br&gt;
19&amp;nbsp; h:mm:ss AM/PM &lt;br&gt;
20&amp;nbsp; h:mm &lt;br&gt;
21&amp;nbsp; h:mm:ss &lt;br&gt;
22&amp;nbsp; m/d/yy h:mm &lt;br&gt;
45&amp;nbsp; mm:ss &lt;br&gt;
46&amp;nbsp; [h]:mm:ss &lt;br&gt;
47&amp;nbsp; mmss.0&lt;/p&gt;
&lt;p&gt;Custom date formats will be doubles and require the FromOADate conversion you use above.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="AbdulJabbar" When="04/02/2014 12:38:04">
          <Html>
        &lt;div class="markDownOutput "&gt;&lt;a href="https://epplus.codeplex.com/discussions/404112" rel="nofollow"&gt;https://epplus.codeplex.com/discussions/404112&lt;/a&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="I can not able to add EPPlus reference in my WPF Applications">
      <Posts>
        <Post From="saravananshasta" When="27/01/2014 04:55:27">
          <Html>
        &lt;div class="markDownOutput "&gt;The currently targeted framework ".NETFramework,Version=v4.0,Profile=Client" does not include "System.Web, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" which the referenced assembly "EPPlus" depends on.
 This caused the referenced assembly to not resolve. To fix this, either (1) change the targeted framework for this project, or (2) remove the referenced assembly from the project.
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
This is the error message am getting.Please some one help me.Am using Visual studio 2010.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="DavidSpoint" When="03/02/2014 11:33:46">
          <Html>
        &lt;div class="markDownOutput "&gt;Are you using Targetframework &lt;strong&gt;.NET Framework 4 Client&lt;/strong&gt;? Try to change it to
&lt;strong&gt;.NET Framework 4&lt;/strong&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Create Excel Worksheet from SqlDataReader/CsvReader">
      <Posts>
        <Post From="jstone923" When="16/06/2011 03:29:00">
          <Html>
        
&lt;p&gt;Is there any methods in your library to create an excel worksheet from a SqlDataReader or CsvReader? An example would be i have 2 or 3 sql queries that I want rows dumped to individual Excel Worksheets within the same Workbook.&amp;nbsp; The same could be true
 to load several CSV files into separate Worksheets.&lt;/p&gt;
&lt;p&gt;Thanks!&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="16/06/2011 16:33:05">
          <Html>
        
&lt;p&gt;There is no build in support for SqlDataReaders or CsvReaders, but you can read a csv file using the Range.LoadFromText method (as in sample 9).&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jstone923" When="16/06/2011 19:03:47">
          <Html>
        
&lt;p&gt;Got it, thanks. This will work in the short term, but due to the large size of csv files i'm dealing with, it is definitely a hit on memory. In this specific case, I don't want to cache everything. I want to search everything in a fast-forward way, and only
 keep portions of the rows from the csv file.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="zippy1981" When="02/02/2014 19:24:22">
          <Html>
        &lt;div class="markDownOutput "&gt;I have created a &lt;a href="https://epplus.codeplex.com/SourceControl/network/forks/zippy1981/LoadFromDataReader/contribution/6144" rel="nofollow"&gt;
pull request&lt;/a&gt; to implement this. Please test.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Can i read data from EXCEL and insert it into Mysql Database using EPPlus?">
      <Posts>
        <Post From="samsoftTech" When="31/01/2014 10:49:05">
          <Html>
        &lt;div class="markDownOutput "&gt;Please, i will like to know if its possible to load data store inside EXCEL Cells into mysql Database using EPPlus, if yes... how?
&lt;br&gt;
&lt;br&gt;
Thanks!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to Remove Gridlines from Excelsheet">
      <Posts>
        <Post From="saravananshasta" When="31/01/2014 07:13:35">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi All, &lt;br&gt;
&lt;br&gt;
I need to know how to remove grid lines from sheet using EP Plus. &lt;br&gt;
&lt;br&gt;
can anyone help me.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="[Solved] Write password protected xlsx file">
      <Posts>
        <Post From="hoelzelre" When="27/04/2012 14:38:14">
          <Html>
        
&lt;p&gt;Hi there,&lt;/p&gt;
&lt;p&gt;i create a xlsx file, add some data, and save this file with the password.&lt;br&gt;
Here is my code for testing (VB Express 2010):&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;Private&lt;/span&gt; &lt;span style="color: blue;"&gt;Sub&lt;/span&gt; Form1_Load(&lt;span style="color: blue;"&gt;ByVal&lt;/span&gt; sender &lt;span style="color: blue;"&gt;As&lt;/span&gt; &lt;span style="color: blue;"&gt;Object&lt;/span&gt;, &lt;span style="color: blue;"&gt;ByVal&lt;/span&gt; e &lt;span style="color: blue;"&gt;As&lt;/span&gt; System.EventArgs) &lt;span style="color: blue;"&gt;Handles&lt;/span&gt; &lt;span style="color: blue;"&gt;Me&lt;/span&gt;.Load
&lt;span style="color: blue;"&gt;Dim&lt;/span&gt; p &lt;span style="color: blue;"&gt;As&lt;/span&gt; ExcelPackage
&lt;span style="color: blue;"&gt;Dim&lt;/span&gt; w &lt;span style="color: blue;"&gt;As&lt;/span&gt; ExcelWorksheet = &lt;span style="color: blue;"&gt;Nothing&lt;/span&gt;
&lt;span style="color: blue;"&gt;If&lt;/span&gt; IO.File.Exists(&lt;span style="color: rgb(163, 21, 21);"&gt;"Test.xlsx"&lt;/span&gt;) &lt;span style="color: blue;"&gt;Then&lt;/span&gt;
	p = &lt;span style="color: blue;"&gt;New&lt;/span&gt; ExcelPackage(&lt;span style="color: blue;"&gt;New&lt;/span&gt; IO.FileInfo(&lt;span style="color: rgb(163, 21, 21);"&gt;"Test.xlsx"&lt;/span&gt;), &lt;span style="color: blue;"&gt;True&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"123456"&lt;/span&gt;)
	w = p.Workbook.Worksheets(1)
	w.Cells(1, 2).Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"Entry2"&lt;/span&gt;
	&lt;span style="color: blue;"&gt;Me&lt;/span&gt;.Text = w.Cells(1, 2).Value.ToString

	p.Save(&lt;span style="color: rgb(163, 21, 21);"&gt;"123456"&lt;/span&gt;)
&lt;span style="color: blue;"&gt;Else&lt;/span&gt;
	p = &lt;span style="color: blue;"&gt;New&lt;/span&gt; ExcelPackage(&lt;span style="color: blue;"&gt;New&lt;/span&gt; IO.FileInfo(&lt;span style="color: rgb(163, 21, 21);"&gt;"Test.xlsx"&lt;/span&gt;))
	w = p.Workbook.Worksheets.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"test"&lt;/span&gt;
	w.Cells(1, 1).Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"Entry1"&lt;/span&gt;

	p.Save(&lt;span style="color: rgb(163, 21, 21);"&gt;"123456"&lt;/span&gt;)
&lt;span style="color: blue;"&gt;End&lt;/span&gt; &lt;span style="color: blue;"&gt;If&lt;/span&gt;
&lt;span style="color: blue;"&gt;End&lt;/span&gt; &lt;span style="color: blue;"&gt;Sub&lt;/span&gt;
&lt;/pre&gt;
&lt;pre&gt;What it does:&lt;br&gt;If we start the app the first time, the xlsx file is created and the value from cell 1,1 (A1) is set to "Entry1".&lt;br&gt;Now it is saved with the password 123456.&lt;br&gt;Now we close the app and start it again.&lt;br&gt;The xlsx file exist and we set cell B1 (1,2) to "Entry2". Then we read the same cell (B1) and set the window title to the cell value and save the package with the password 123456.&lt;br&gt;As we can see the window title changed to "Entry2" but if i open the xlsx file there is only "Entry1" in cell A1.&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;Is this a Bug ?&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="27/04/2012 15:09:26">
          <Html>
        
&lt;p&gt;I don't know what "useStream" in ExcelPackage constructors means, but if you change to false, works fine. I THINK, "useStream" means if it will update your template directly or not.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;        &lt;span style="color: gray;"&gt;///&lt;/span&gt; &lt;span style="color: gray;"&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt;&lt;span style="color: green;"&gt; Create a new instance of the ExcelPackage class based on a existing template.&lt;/span&gt;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt; &lt;span style="color: gray;"&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt; &lt;span style="color: gray;"&gt;&amp;lt;param name="template"&amp;gt;&lt;/span&gt;&lt;span style="color: green;"&gt;The name of the Excel template to use as the basis of the new Excel file&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt; &lt;span style="color: gray;"&gt;&amp;lt;param name="useStream"&amp;gt;&lt;/span&gt;&lt;span style="color: green;"&gt;if true use a stream. If false create a file in the temp dir with a random name&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt; &lt;span style="color: gray;"&gt;&amp;lt;param name="password"&amp;gt;&lt;/span&gt;&lt;span style="color: green;"&gt;Password to decrypted the template&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; ExcelPackage(FileInfo template, &lt;span style="color: blue;"&gt;bool&lt;/span&gt; useStream, &lt;span style="color: blue;"&gt;string&lt;/span&gt; password)
        {
            Init();
            CreateFromTemplate(template, password);
            &lt;span style="color: blue;"&gt;if&lt;/span&gt; (useStream == &lt;span style="color: blue;"&gt;false&lt;/span&gt;)
            {
                File = &lt;span style="color: blue;"&gt;new&lt;/span&gt; FileInfo(Path.GetTempPath() + Guid.NewGuid().ToString() + &lt;span style="color: rgb(163, 21, 21);"&gt;".xlsx"&lt;/span&gt;);
            }
        }
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="hoelzelre" When="02/05/2012 07:38:12">
          <Html>
        
&lt;p&gt;Thx for your tip mrxrsd,&lt;/p&gt;
&lt;p&gt;i solved the problem by using the following code:&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;public&lt;/span&gt; ExcelPackage(FileInfo newFile, &lt;span style="color: blue;"&gt;string&lt;/span&gt; password)&lt;br&gt;{&lt;br&gt;  Init();&lt;br&gt;  File = newFile;&lt;br&gt;  ConstructNewFile(&lt;span style="color: blue;"&gt;new&lt;/span&gt; MemoryStream(), password);&lt;br&gt;}&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="vbrsamudrala" When="30/01/2014 13:11:42">
          <Html>
        &lt;div class="markDownOutput "&gt;HI , i am using EPPlus tool for exporting Datatable into excel sheet in C#. Following is the code that i have written for exporting table into excel sheet&lt;br&gt;
&lt;pre&gt;&lt;code&gt;using (ExcelPackage pck = new ExcelPackage())
                {
                    if (dt != null)
                    {
                        if (extension == ".xlsx")
                            fileName = "Test_" + DateTime.Now.ToString("yyyMMddHHmmss") + ".xlsx";
                        else if (extension == ".xls")
                            fileName = "Test_" + DateTime.Now.ToString("yyyMMddHHmmss") + ".xls";

                        fileName = path + fileName;


                        pck.File = (new FileInfo(fileName));


                        //Create the worksheet
                        ExcelWorksheet ws = pck.Workbook.Worksheets.Add(fileName);

                        //Load the datatable into the sheet, starting from cell A1. Print the column names on row 1
                        ws.Cells["A2"].LoadFromDataTable(dt, true);
                        //Set a password for the workbookprotection
                        ws.Protection.SetPassword("11");

                        //Encrypt with no password
                        pck.Save(fileName);


                        
                    }
                    
                }&lt;/code&gt;&lt;/pre&gt;
There are no errors during execution and even excel file is generating but when i am opening excel sheet a prompt message is coming requesting for 'password'.&lt;br&gt;
I am giving password as 11 but still i am getting message like invalid password. Please help me ASAP.
&lt;br&gt;
&lt;br&gt;
Thanks,&lt;br&gt;
bhadra&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Cells with formulae don't display value until I click 'enable editing'">
      <Posts>
        <Post From="hamble" When="29/01/2014 14:25:48">
          <Html>
        &lt;div class="markDownOutput "&gt;I've created a file with EPPlus, but the cells containing formulae are blank, until I click the 'enable editing' button in Excel. I presume this is somethign to do with the lack of calculation engine in EPPlus.
&lt;br&gt;
&lt;br&gt;
Is there a way I can create a spreadsheet with a formula in the cell, but setting an initial value so that it doesn't appear blank on first loading?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to Convert Backgroud Color of a Cell to System.Drawing.Color?">
      <Posts>
        <Post From="alionline759" When="24/05/2012 09:00:38">
          <Html>
        
&lt;p&gt;I have a serious problem converting the ExelRange.Style.Fill.BackgroundColor to System.Drawing.Color. There is no problem when the color of the range is in RGB property but the problem raises when it is indexed or based on a Theme. Please help me&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="tridy" When="24/01/2014 09:51:01">
          <Html>
        &lt;div class="markDownOutput "&gt;Any luck on setting &lt;em&gt;Style.Fill.BackgroundColor.Theme&lt;/em&gt; property? Has anyone
&lt;a href="http://epplus.codeplex.com/discussions/346525" rel="nofollow"&gt;extended&lt;/a&gt; the functionality?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Exception thrown during Package.Save()">
      <Posts>
        <Post From="DarkSyzygy" When="23/01/2014 19:33:10">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, I am currently running into an issue when I attempt to save my excel package.&lt;br&gt;
&lt;br&gt;
Here's the stack trace:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;EPPlus.dll!OfficeOpenXml.ExcelStyles.RemoveUnusedStyles()         Line 663  
EPPlus.dll!OfficeOpenXml.ExcelStyles.UpdateXml()                  Line 459  
EPPlus.dll!OfficeOpenXml.ExcelWorkbook.Save()                     Line 649  
EPPlus.dll!OfficeOpenXml.ExcelPackage.Save()                      Line 712  &lt;/code&gt;&lt;/pre&gt;
Specifically it's happening on line 675&lt;br&gt;
&lt;pre&gt;&lt;code&gt;673         foreach (ExcelColumn col in sheet._columns)
674         {
675                 if(col.StyleID&amp;gt;=0) CellXfs[col.StyleID].useCnt++;
676         }&lt;/code&gt;&lt;/pre&gt;
the conditional checks if StyleID is &amp;gt; 0 to be used as an index access into the CellXfs collection, but in this case CellXfs.Count is 11 and the StyleID being passed in is 20.
&lt;br&gt;
&lt;br&gt;
Any idea why this would be the case? Should there be a compound conditional or should StyleID never be larger than CellXfs.Count
&lt;br&gt;
&lt;br&gt;
I'm compiling from source at commit 13fc263b49bf &lt;br&gt;
&lt;br&gt;
Thanks&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="problem reading excel sheet cell with formula">
      <Posts>
        <Post From="gr8developer" When="19/01/2014 03:56:46">
          <Html>
        &lt;div class="markDownOutput "&gt;When I try to read excel sheet having formula, I get the result as 0. C4 has the formula as =SUM(C2:C3)&lt;br&gt;
&lt;pre&gt;&lt;code&gt;        using (var package = new ExcelPackage(existingFile))
        {
            ExcelWorkbook workBook = package.Workbook;
            var currentWorksheet = workBook.Worksheets.First();
            currentWorksheet.Cells["C2"].Value = 5;
            currentWorksheet.Cells["C3"].Value = 7;
            var c4 = Convert.ToDouble(currentWorksheet.Cells["C4"].Value);
        }
&lt;/code&gt;&lt;/pre&gt;
In the above code why is c4 getting the value of zero? &lt;br&gt;
&lt;br&gt;
Please help. Thanks&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="cm_prog" When="21/01/2014 14:46:13">
          <Html>
        &lt;div class="markDownOutput "&gt;EPPlus does not have a calculation engine built into it, so it won't calculate a cell's value if it happens to have a formula in it. You can get the formula from the cell via the CellRange.Formula property as opposed to the CellRange.Value property.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="21/01/2014 20:07:04">
          <Html>
        &lt;div class="markDownOutput "&gt;Next version of EPPlus will have a calculation engine. A beta will be available in the near future.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to Add Image to Cell">
      <Posts>
        <Post From="junjimalaza" When="21/01/2014 10:44:56">
          <Html>
        &lt;div class="markDownOutput "&gt;I have been reading on how to add image to a cell, but I still don't get it. I'm trying to understand how to use the methods.
&lt;br&gt;
&lt;br&gt;
Is there a simple example to add an image to a cell when a webpage loads. I am using MVC, I have tried this but still can't get the image out.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;public ActionResult Index()
        {
            ViewBag.Message = "Modify this template to jump-start your ASP.NET MVC application.";

            ExcelPackage epck = new ExcelPackage();
            var ws = epck.Workbook.Worksheets.Add("Sheet 1");

            
            Image logo = Image.FromFile("heroAccent.png");
            var picture = ws.Drawings.AddPicture(1.ToString(), logo);
            picture.SetPosition(1,1);



            epck.SaveAs(Response.OutputStream);
            Response.ContentType = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";
            Response.AddHeader("content-disposition", "attachment;  filename=HitterReport.xlsx");

            return View();
        }&lt;/code&gt;&lt;/pre&gt;
How do one add an image to a cell let us say in cell B3? &lt;br&gt;
&lt;br&gt;
Thanks&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Filter DateTime field for Years,Months and Days in Pivot">
      <Posts>
        <Post From="TiSch" When="08/09/2011 16:39:40">
          <Html>
        
&lt;p&gt;Hello,&lt;/p&gt;
&lt;p&gt;i'm trying to create a Pivot with a DateTime PageField, so that the user can filter the period he want to see by himself. But although i can filter this for year,month or days in the data worksheet automatically, i don't get it working in the Pivot.&lt;/p&gt;
&lt;p&gt;Here is what i have:&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;Dim&lt;/span&gt; wsPivot = excel.Workbook.Worksheets.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"Pivot"&lt;/span&gt;)
&lt;span style="color: blue;"&gt;Dim&lt;/span&gt; wsData = excel.Workbook.Worksheets.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"Data"&lt;/span&gt;)
&lt;span style="color: blue;"&gt;Dim&lt;/span&gt; source = workSheet.GetDataSource
wsData.Cells(&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;).LoadFromDataTable(source, &lt;span style="color: blue;"&gt;True&lt;/span&gt;, OfficeOpenXml.Table.TableStyles.Medium6)
&lt;span style="color: blue;"&gt;For&lt;/span&gt; &lt;span style="color: blue;"&gt;Each&lt;/span&gt; col &lt;span style="color: blue;"&gt;As&lt;/span&gt; DataColumn &lt;span style="color: blue;"&gt;In&lt;/span&gt; source.Columns
    &lt;span style="color: blue;"&gt;If&lt;/span&gt; col.DataType = &lt;span style="color: blue;"&gt;GetType&lt;/span&gt;(&lt;span style="color: blue;"&gt;Date&lt;/span&gt;) &lt;span style="color: blue;"&gt;Then&lt;/span&gt;
        &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; colNumber = col.Ordinal + 1
        &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; range = wsData.Cells(1, colNumber, source.Rows.&lt;span style="color: blue;"&gt;Count&lt;/span&gt;, colNumber)
        range.Style.Numberformat.Format = &lt;span style="color: rgb(163, 21, 21);"&gt;"dd.mm.yyyy"&lt;/span&gt;
   &lt;span style="color: blue;"&gt;End&lt;/span&gt; &lt;span style="color: blue;"&gt;If&lt;/span&gt;
&lt;span style="color: blue;"&gt;Next&lt;/span&gt;
&lt;span style="color: blue;"&gt;Dim&lt;/span&gt; dataRange = wsData.Cells(wsData.Dimension.Address.ToString())
dataRange.AutoFitColumns()
&lt;span style="color: blue;"&gt;Dim&lt;/span&gt; pivotTable = wsPivot.PivotTables.Add(wsPivot.Cells(&lt;span style="color: rgb(163, 21, 21);"&gt;"A3"&lt;/span&gt;), dataRange, &lt;span style="color: rgb(163, 21, 21);"&gt;"Open Contacts"&lt;/span&gt;)
pivotTable.PageFields.Add(pivotTable.Fields(&lt;span style="color: rgb(163, 21, 21);"&gt;"OwnedAt"&lt;/span&gt;)) &lt;span style="color: green;"&gt;'** this is the date column i want to group **'&lt;/span&gt;
pivotTable.PageFields.Add(pivotTable.Fields(&lt;span style="color: rgb(163, 21, 21);"&gt;"Owner"&lt;/span&gt;))
pivotTable.RowFields.Add(pivotTable.Fields(&lt;span style="color: rgb(163, 21, 21);"&gt;"Country"&lt;/span&gt;))
pivotTable.ColumnFields.Add(pivotTable.Fields(&lt;span style="color: rgb(163, 21, 21);"&gt;"Status"&lt;/span&gt;))
pivotTable.DataFields.Add(pivotTable.Fields(&lt;span style="color: rgb(163, 21, 21);"&gt;"Count"&lt;/span&gt;))
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;It's only possible to select datetime values from the list including hours and minutes and not to group by month f.e.(see picture below).&lt;/p&gt;
&lt;p&gt;&lt;a href="http://www.bilder-hochladen.net/files/4709-o0-fa83-jpg-rc.html" target="_blank" rel="nofollow"&gt;&lt;img alt="" src="http://www.bilder-hochladen.net/files/thumbs/4709-o0-fa83.jpg" border="0"&gt;&lt;/a&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="carlozsilva" When="16/09/2011 18:12:48">
          <Html>
        
&lt;p&gt;I would like help with this too.&amp;nbsp;&lt;br&gt;
If not, is there a work around?Here I show a filter that I also would like to&lt;br&gt;
&lt;br&gt;
&lt;a href="http://www.freeimagehosting.net/bd9b6" rel="nofollow"&gt;&lt;img width="700" height="600" alt="" src="http://www.freeimagehosting.net/newuploads/bd9b6.jpg"&gt;&lt;/a&gt;
&lt;br&gt;
would be very helpful to support on this issue thanks&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="TiSch" When="19/09/2011 09:52:48">
          <Html>
        
&lt;blockquote style="margin: 0.25em 1em 0px; padding: 0px 0.25em; border: 0.1em solid rgb(204, 204, 204); border-image: none; font-style: italic;"&gt;
&lt;strong&gt;carlozsilva wrote:&lt;/strong&gt;&lt;br&gt;
&lt;p&gt;I would like help with this too.&amp;nbsp;&lt;br&gt;
If not, is there a work around?Here I show a filter that I also would like to&amp;nbsp;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Sorry, i cannot understand your problem. If you've added that as PageField to your pivot, the data will be already filtered on the selected customer(s).&lt;/p&gt;
&lt;p&gt;Meanwhile i've added additional fields to my pivot to simulate the filter for year, month and date. But that is an ugly solution. Too many fields and no relation between them, so the user can choose
&lt;em&gt;year 2010 &lt;/em&gt;and &lt;em&gt;month &lt;/em&gt;Februar-&lt;em&gt;2011 &lt;/em&gt;although that makes no sense at all. Besides i've found no way to sort correctly the months since i have following format: August 2011. I can sort via eSortType.Ascending (or Descending) but that would
 sort only alphabetically.&lt;/p&gt;
&lt;p&gt;Another approach was to add that field as RowField to the Pivot and add a DateGrouping. I've realized that this works perfectly in OpenOffice but not in Excel(2010). [see screenshots below]&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;Dim&lt;/span&gt; ownedAtField = pivotTable.Fields(&lt;span style="color: rgb(163, 21, 21);"&gt;"OwnedAt"&lt;/span&gt;)
pivotTable.RowFields.Add(ownedAtField)
ownedAtField.AddDateGrouping(eDateGroupBy.Years Or eDateGroupBy.Months &lt;span style="color: blue;"&gt;Or&lt;/span&gt; eDateGroupBy.Days)&lt;br&gt;&lt;br&gt;Works in OpenOffice:&lt;br&gt;&lt;br&gt; &lt;a href="http://www.bilder-hochladen.net/files/4709-o6-84f7-jpg-nb.html" rel="nofollow"&gt;&lt;img alt="Bilder Upload" src="http://www.bilder-hochladen.net/files/4709-o6-84f7.jpg" border="0"&gt;&lt;/a&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;Has no effect in Excel:&lt;br&gt;&lt;br&gt;&lt;a href="http://www.bilder-hochladen.net/files/4709-o5-b86e-jpg-nb.html" rel="nofollow"&gt;&lt;img alt="Bilder Upload" src="http://www.bilder-hochladen.net/files/4709-o5-b86e.jpg" border="0"&gt;&lt;/a&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;So my &lt;strong&gt;question&lt;/strong&gt;: why does this work in OO but not in Excel itself? &lt;br&gt;I would assume that excel knows how to group fields together because it supports this too.&lt;br&gt;&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="20/09/2011 20:35:24">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I haven't added support for grouping pagefields (I had missed that), so I'll add it to my TODO list.&lt;/p&gt;
&lt;p&gt;Not sure why the grouping is'nt working. If you don't get it to work create an issue with code to replicate&amp;nbsp;the&amp;nbsp;problem&amp;nbsp;and&amp;nbsp;I will have a look at it.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="TiSch" When="27/09/2011 09:41:19">
          <Html>
        
&lt;p&gt;Hi Jan,&lt;/p&gt;
&lt;p&gt;i've solved this issue. I wasn't able to group by the date-field because there was still one unformatted row.&lt;/p&gt;
&lt;p&gt;The following line caused this issue(see complete code in my above):&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;Dim&lt;/span&gt; range = wsData.Cells(1, colNumber, source.Rows.&lt;span style="color: blue;"&gt;Count&lt;/span&gt;, colNumber)
range.Style.Numberformat.Format = &lt;span style="color: rgb(163, 21, 21);"&gt;"dd.mm.yyyy"&lt;/span&gt;
&lt;br&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Because &lt;em&gt;LoadFromDataTable &lt;/em&gt;loaded the DataTable with the Colums' names as header, the last row kept unformatted, therefore the pivot cannot group the date(only in Excel).&lt;br&gt;
&lt;br&gt;
So this fixed it:&amp;nbsp;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;Dim&lt;/span&gt; range = wsData.Cells(2, colNumber, source.Rows.&lt;span style="color: blue;"&gt;Count&lt;/span&gt; + 1, colNumber)&lt;br&gt;&lt;br&gt;&lt;br&gt;Besides, how can i collapse these grouped date-rowfields initially?&lt;br&gt;&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="Hamiller" When="21/01/2014 09:47:57">
          <Html>
        &lt;div class="markDownOutput "&gt;&lt;a href="http://www.kettic.com/winforms_ui/csharp_guide/pivotgrid_filter_report.shtml" rel="nofollow"&gt;Filtering in PivotGrid table&lt;/a&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Problem in TrendLines Collection">
      <Posts>
        <Post From="nightdreamer" When="20/01/2014 15:06:42">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello I Added a trendline, but i can't access the the properties because the collection did not contain the new trendline.
&lt;br&gt;
&lt;br&gt;
How I acces to the trendline collection properti? &lt;br&gt;
&lt;br&gt;
Regards&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Out of memory exception">
      <Posts>
        <Post From="nikhilgupta" When="18/01/2014 19:39:31">
          <Html>
        &lt;div class="markDownOutput "&gt;I have 8 gb of RAM &amp;amp; 64 bit windows 7 OS. &lt;br&gt;
I am trying to create an excel (XLSX) having 65K records &amp;amp; 125 columns. Whatever I do, ExcelPackage.save() to save as a physical file or get bytes, all giving me out of memory exception. I have to create 7 tabs in total in this workbook all may contains
 close to 65K records each with 6 sheets having 10-20 columns &amp;amp; 1 sheet contains 125 columns... I have even tried to create separate package for all sheets &amp;amp; then try to copy them in a single package but that also nt working...
&lt;br&gt;
&lt;br&gt;
Any help plzzz&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Is there a way in the library to apply a .CRTX file to a chart?.">
      <Posts>
        <Post From="tempbasura" When="17/01/2014 09:06:07">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, first of all, congratulations for your great work with this library. It's amazing. I use automation to apply excel chart templates to a chart generated with the excel app and i m evaluating toos to avoid it without using excel. Is there a way in the
 library to apply a .CRTX file to a chart?. &lt;br&gt;
Thanks in advance.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Export Excel Shapes to Powerpoint">
      <Posts>
        <Post From="mrcheidel" When="16/01/2014 17:02:41">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello guys, &lt;br&gt;
Is possible draw shapes in EPPlus and next paste to a powerpoint (pptm) ? &lt;br&gt;
I would like use this library to make draws and next join in a pptm presentation.
&lt;br&gt;
&lt;br&gt;
Thanks of lot&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Chart - When copying worksheet the chart series doesn't update to reference new worksheet">
      <Posts>
        <Post From="mdesnoyer" When="27/09/2012 18:56:57">
          <Html>
        
&lt;p&gt;I am loading in a template that has a worksheet that I want to use as a template to create multiple sheets with data from a datatable. I copy this worksheet and then proceed to fill in the data. There are charts the display some of the data cell. However,
 the reference to these cell for the chart remain pointed back to the chart that was copied.&lt;/p&gt;
&lt;p&gt;='GAUGE R&amp;amp;R'!$C$14:$L$14&lt;/p&gt;
&lt;p&gt;'GAUGE R&amp;amp;R' is the name of the template worksheet. I would like to have it reference this worksheet&lt;/p&gt;
&lt;p&gt;='DAT B101'!$C$14:$L$14&lt;/p&gt;
&lt;p&gt;Is there a method to copy that will update references to curren(new) worksheet.&lt;/p&gt;
&lt;p&gt;or&lt;/p&gt;
&lt;p&gt;Is there a way to look for these references and change the name by searching through a worksheet&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="nunomendes" When="14/01/2014 11:59:59">
          <Html>
        &lt;div class="markDownOutput "&gt;Good morning, &lt;br&gt;
&lt;br&gt;
I'm having the same issue. You solve this? Our anyone has solution for this? &lt;br&gt;
&lt;br&gt;
Best Reggards, &lt;br&gt;
NM&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Performance Issues with EPPlus depending of the environment">
      <Posts>
        <Post From="gpelegay" When="08/01/2014 12:12:26">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
We are having performance issues using EPPlus v 3.1.1.0 in two different enviroments. The same process (fill an Excel with EPPlus) is taking much less tiempo on development environment that on staging environment.
&lt;br&gt;
&lt;br&gt;
These are the environment resources. &lt;br&gt;
&lt;br&gt;
DEVELOPMENT &lt;br&gt;
Memory 4095 &lt;br&gt;
CPUs 1 &lt;br&gt;
Disks 1 &lt;br&gt;
Networks 2 &lt;br&gt;
&lt;br&gt;
STAGING &lt;br&gt;
Memory 8191 &lt;br&gt;
CPUs 8 &lt;br&gt;
Disks 1 &lt;br&gt;
Networks 2 &lt;br&gt;
&lt;br&gt;
Any thought on this?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="08/01/2014 12:17:29">
          <Html>
        &lt;div class="markDownOutput "&gt;I know it is a kind of stupid question, but I need to ask. Are we talking about the same amount of data in all enviroments?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="gpelegay" When="08/01/2014 12:23:00">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
Thanks for your reply. &lt;br&gt;
&lt;br&gt;
Yes, data is the same, we are testing with the same amount of data. &lt;br&gt;
&lt;br&gt;
My question is to know is there is any known issue with environment resources; 34/64 bits (processor), memory, etc.
&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="08/01/2014 12:41:24">
          <Html>
        &lt;div class="markDownOutput "&gt;I've never heard any complaints about enviroment resources. At my work we have a mixed of 32/64bits machine and my production servers are 64 bits, no problem at all.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="gpelegay" When="08/01/2014 15:10:03">
          <Html>
        &lt;div class="markDownOutput "&gt;Another difference is that DEVELOPMENT environment is a virtualized environment, instead of STAGING that is a physical environment.
&lt;br&gt;
&lt;br&gt;
I know that it is very weird but do you have any idea? &lt;br&gt;
&lt;br&gt;
Thanks in advance,&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="leonardoFiorot" When="08/01/2014 22:48:23">
          <Html>
        &lt;div class="markDownOutput "&gt;which the data volume and time which is in both cases?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="gpelegay" When="10/01/2014 10:46:21">
          <Html>
        &lt;div class="markDownOutput "&gt;Data volumen is the same in both environments...&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Dynamic Row Selection">
      <Posts>
        <Post From="vishnutejcj" When="08/01/2014 18:08:12">
          <Html>
        &lt;div class="markDownOutput "&gt;I'm sorry if my question appears to be silly.. Kindly Help... &lt;br&gt;
&lt;br&gt;
In the below code,&lt;br&gt;
&lt;pre&gt;&lt;code&gt;public ActionResult SampleDownload1()
        {
            var records = _getSampleInfoQuery.Execute();
                        var columns = new[]
                              {
                                  Column(x =&amp;gt; x.College),
                                  Column(x =&amp;gt; x.Amount, ExcelFormat.Money),
                                  Column(x =&amp;gt; x.CreatedDate, ExcelFormat.Date, "Date"),
                                  Column(x =&amp;gt; x.CreatedBy),
                                  Column(x =&amp;gt; x.CreatedDate, ExcelFormat.Time, "Time"),
                                  Column(x =&amp;gt; x.PercentageExample, ExcelFormat.Percent),
                              };
 
            return new ExcelFileResult&amp;lt;SampleInfo&amp;gt;(records) {ColumnDefinitions = columns};
        }&lt;/code&gt;&lt;/pre&gt;
I would like the user to specify the list of columns to be added to Var columns. &lt;br&gt;
&lt;br&gt;
I would probably be passing array of IDs (&lt;em&gt;or anything else?&lt;/em&gt;) of the chosen column like College,Amount,PercentageExample, the downloaded excel should contain only those columns.
&lt;br&gt;
&lt;br&gt;
Note sure whether i am putting my question in right. Let me know for any clarifications.
&lt;br&gt;
&lt;br&gt;
Thanks for your precious time Smile | :) &lt;br&gt;
Vishnu&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="leonardoFiorot" When="08/01/2014 22:53:39">
          <Html>
        &lt;div class="markDownOutput "&gt;Have put together a working example as well near your reality.&lt;br&gt;
&lt;br&gt;
There is some form of solving the problem.&lt;br&gt;
With this example failing to understand.&lt;br&gt;
&lt;br&gt;
look link &amp;gt; &lt;a href="http://stackoverflow.com/questions/16516971/linq-dynamic-select" rel="nofollow"&gt;
http://stackoverflow.com/questions/16516971/linq-dynamic-select&lt;/a&gt;&lt;br&gt;
or &lt;a href="http://stackoverflow.com/questions/4214881/using-lambda-expression-to-select-different-fields-from-field-names" rel="nofollow"&gt;
http://stackoverflow.com/questions/4214881/using-lambda-expression-to-select-different-fields-from-field-names&lt;/a&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="vishnutejcj" When="09/01/2014 02:40:37">
          <Html>
        &lt;div class="markDownOutput "&gt;Thanks leonardoFiorot&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Opposite of LoadFromDataTable()?">
      <Posts>
        <Post From="danthman" When="07/11/2011 22:23:48">
          <Html>
        
&lt;p&gt;I'd like to be able to read a table in from Excel and insert the results directly into an ADO.NET DataTable. Is there a direct method for this, or do I need to use Linq?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="17/11/2011 06:30:29">
          <Html>
        
&lt;p&gt;No, there is no build in method for that. Use Linq or add cell by cell.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="viki_baid" When="16/01/2012 10:21:19">
          <Html>
        
&lt;p&gt;I'm also looking for a similar function. if you can post the Linq code , it would be helpful&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="TiSch" When="16/01/2012 11:47:57">
          <Html>
        
&lt;p&gt;Here is a simple example(VB.NET):&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/p&gt;
&lt;pre&gt;&lt;div style="color: black; background-color: white;"&gt;&lt;pre&gt;&lt;span style="color: blue;"&gt;Dim&lt;/span&gt; pck = &lt;span style="color: blue;"&gt;New&lt;/span&gt; OfficeOpenXml.ExcelPackage() &lt;br&gt;pck.Load(&lt;span style="color: blue;"&gt;New&lt;/span&gt; IO.FileInfo(path).OpenRead) &lt;br&gt;&lt;span style="color: blue;"&gt;Dim&lt;/span&gt; ws = pck.Workbook.Worksheets(&lt;span style="color: rgb(163, 21, 21);"&gt;"Worksheet1"&lt;/span&gt;) &lt;br&gt;&lt;span style="color: blue;"&gt;Dim&lt;/span&gt; tbl &lt;span style="color: blue;"&gt;As&lt;/span&gt; &lt;span style="color: blue;"&gt;New&lt;/span&gt; DataTable &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; hasHeader = &lt;span style="color: blue;"&gt;True&lt;/span&gt;
&lt;span style="color: blue;"&gt;For&lt;/span&gt; &lt;span style="color: blue;"&gt;Each&lt;/span&gt; firstRowCell &lt;span style="color: blue;"&gt;In&lt;/span&gt; ws.Cells(1, 1, 1, ws.Dimension.&lt;span style="color: blue;"&gt;End&lt;/span&gt;.Column)
    tbl.Columns.Add(
        &lt;span style="color: blue;"&gt;If&lt;/span&gt;(hasHeader,
           firstRowCell.Text,
           &lt;span style="color: blue;"&gt;String&lt;/span&gt;.Format(&lt;span style="color: rgb(163, 21, 21);"&gt;"Column {0}"&lt;/span&gt;, firstRowCell.Start.Column)))
&lt;span style="color: blue;"&gt;Next&lt;/span&gt;
&lt;span style="color: blue;"&gt;Dim&lt;/span&gt; startRow = &lt;span style="color: blue;"&gt;If&lt;/span&gt;(hasHeader, 2, 1)
&lt;span style="color: blue;"&gt;For&lt;/span&gt; rowNum = startRow &lt;span style="color: blue;"&gt;To&lt;/span&gt; ws.Dimension.&lt;span style="color: blue;"&gt;End&lt;/span&gt;.Row
    &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; wsRow = ws.Cells(rowNum, 1, rowNum, ws.Dimension.&lt;span style="color: blue;"&gt;End&lt;/span&gt;.Column)
    &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; row = tbl.NewRow
    &lt;span style="color: blue;"&gt;For&lt;/span&gt; &lt;span style="color: blue;"&gt;Each&lt;/span&gt; cell &lt;span style="color: blue;"&gt;In&lt;/span&gt; wsRow
        row(cell.Start.Column - 1) = cell.Text
    &lt;span style="color: blue;"&gt;Next&lt;/span&gt;
    tbl.Rows.Add(row)
&lt;span style="color: blue;"&gt;Next&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;/pre&gt;
&lt;/div&gt;
&lt;hr&gt;
C# (translated):&lt;br&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;var&lt;/span&gt; pck = &lt;span style="color: blue;"&gt;new&lt;/span&gt; OfficeOpenXml.ExcelPackage();
pck.Load(&lt;span style="color: blue;"&gt;new&lt;/span&gt; System.IO.FileInfo(path).OpenRead());
&lt;span style="color: blue;"&gt;var&lt;/span&gt; ws = pck.Workbook.Worksheets[&lt;span style="color: rgb(163, 21, 21);"&gt;"Worksheet1"&lt;/span&gt;];
DataTable tbl = &lt;span style="color: blue;"&gt;new&lt;/span&gt; DataTable();
&lt;span style="color: blue;"&gt;var&lt;/span&gt; hasHeader = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
&lt;span style="color: blue;"&gt;foreach&lt;/span&gt; (&lt;span style="color: blue;"&gt;var&lt;/span&gt; firstRowCell &lt;span style="color: blue;"&gt;in&lt;/span&gt; ws.Cells[1, 1, 1, ws.Dimension.End.Column]){
      tbl.Columns.Add(hasHeader ? firstRowCell.Text : &lt;span style="color: blue;"&gt;string&lt;/span&gt;.Format(&lt;span style="color: rgb(163, 21, 21);"&gt;"Column {0}"&lt;/span&gt;, firstRowCell.Start.Column));
}
&lt;span style="color: blue;"&gt;var&lt;/span&gt; startRow = hasHeader ? 2 : 1;
&lt;span style="color: blue;"&gt;for&lt;/span&gt; (&lt;span style="color: blue;"&gt;var&lt;/span&gt; rowNum = startRow; rowNum &amp;lt;= ws.Dimension.End.Row; rowNum++){
     &lt;span style="color: blue;"&gt;var&lt;/span&gt; wsRow = ws.Cells[rowNum, 1, rowNum, ws.Dimension.End.Column];
     &lt;span style="color: blue;"&gt;var&lt;/span&gt; row = tbl.NewRow();
     &lt;span style="color: blue;"&gt;foreach&lt;/span&gt; (&lt;span style="color: blue;"&gt;var&lt;/span&gt; cell &lt;span style="color: blue;"&gt;in&lt;/span&gt; wsRow){
           row[cell.Start.Column - 1] = cell.Text;
     }
     tbl.Rows.Add(row);
}
&lt;/pre&gt;
&lt;/div&gt;
&lt;/pre&gt;

        
    </Html>
        </Post>
        <Post From="danthman" When="16/01/2012 17:49:14">
          <Html>
        
&lt;p&gt;@viki,&lt;/p&gt;
&lt;p&gt;Here's my "FillTable" method:&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;        &lt;span style="color: blue;"&gt;private&lt;/span&gt; &lt;span style="color: blue;"&gt;void&lt;/span&gt; FillTable(DataTable table, ExcelWorksheet worksheet)
        {
            &lt;span style="color: blue;"&gt;var&lt;/span&gt; firstCell = worksheet.Cells[1, 1];
            &lt;span style="color: blue;"&gt;var&lt;/span&gt; endCell = GetLastContiguousCell(firstCell);
            &lt;span style="color: blue;"&gt;var&lt;/span&gt; beginCell = worksheet.Cells[2, 1];
            &lt;span style="color: blue;"&gt;if&lt;/span&gt; (beginCell.Value == &lt;span style="color: blue;"&gt;null&lt;/span&gt;) &lt;span style="color: blue;"&gt;return&lt;/span&gt;;
            &lt;span style="color: blue;"&gt;var&lt;/span&gt; range = worksheet.Cells[beginCell.Start.Row, beginCell.Start.Column, endCell.Start.Row, endCell.Start.Column];
            &lt;span style="color: blue;"&gt;var&lt;/span&gt; data = range
                .OrderBy(cell =&amp;gt; cell.Start.Row)
                .GroupBy(cell =&amp;gt; cell.Start.Row);
            &lt;span style="color: blue;"&gt;foreach&lt;/span&gt; (&lt;span style="color: blue;"&gt;var&lt;/span&gt; rowData &lt;span style="color: blue;"&gt;in&lt;/span&gt; data)
            {
                &lt;span style="color: blue;"&gt;var&lt;/span&gt; values = table.Columns.Cast&amp;lt;DataColumn&amp;gt;()
                    .Select((column, index) =&amp;gt; rowData.SingleOrDefault(cell =&amp;gt; cell.Start.Column == index + 1))
                    .Select(cell =&amp;gt; cell == &lt;span style="color: blue;"&gt;null&lt;/span&gt; ? &lt;span style="color: blue;"&gt;null&lt;/span&gt; : cell.Value)
                    .Select(value =&amp;gt; _valueAdjuster == &lt;span style="color: blue;"&gt;null&lt;/span&gt; ? value : _valueAdjuster(value))
                    .ToArray();
                table.Rows.Add(values);
            }
        }

        &lt;span style="color: blue;"&gt;private&lt;/span&gt; ExcelRange GetLastContiguousCell(ExcelRange beginCell)
        {
            &lt;span style="color: blue;"&gt;var&lt;/span&gt; worksheet = beginCell.Worksheet;
            &lt;span style="color: blue;"&gt;var&lt;/span&gt; beginCellAddress = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelCellAddress(beginCell.Start.Row, beginCell.Start.Column);
            &lt;span style="color: blue;"&gt;var&lt;/span&gt; lastCellAddress = worksheet.Dimension.End;
            &lt;span style="color: blue;"&gt;var&lt;/span&gt; bottomCell = worksheet.Cells[beginCellAddress.Row, beginCellAddress.Column, lastCellAddress.Row, beginCellAddress.Column]
                .First(cell =&amp;gt; cell.Offset(1, 0).Value == &lt;span style="color: blue;"&gt;null&lt;/span&gt;);
            &lt;span style="color: blue;"&gt;var&lt;/span&gt; rightCell = worksheet.Cells[beginCellAddress.Row, beginCellAddress.Column, beginCellAddress.Row, lastCellAddress.Column]
                .First(cell =&amp;gt; cell.Offset(0, 1).Value == &lt;span style="color: blue;"&gt;null&lt;/span&gt;);
            &lt;span style="color: blue;"&gt;return&lt;/span&gt; worksheet.Cells[bottomCell.Start.Row, rightCell.Start.Column];
        }
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;This assumes a couple things:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;You already have a DataTable with the schema filled. &lt;/li&gt;&lt;li&gt;Your Excel data begins at the top/left cell (A1), and there are no gaps in the data (i.e., no empty columns or rows in the middle of the data).
&lt;/li&gt;&lt;/ol&gt;
&lt;p&gt;I have another method that checks if the heading row is a perfect match for the column names in the DataTable:&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;        &lt;span style="color: blue;"&gt;private&lt;/span&gt; &lt;span style="color: blue;"&gt;void&lt;/span&gt; ValidateWorksheetHeadings(DataTable table, ExcelWorksheet worksheet)
        {&lt;pre&gt;            &lt;span style="color: blue;"&gt;var&lt;/span&gt; firstCell = worksheet.Cells[1, 1];
            &lt;span style="color: blue;"&gt;var&lt;/span&gt; endCell = GetLastContiguousCell(firstCell);
            &lt;span style="color: blue;"&gt;var&lt;/span&gt; beginCell = worksheet.Cells[1, 1];
            &lt;span style="color: blue;"&gt;var&lt;/span&gt; range = worksheet.Cells[beginCell.Start.Row, beginCell.Start.Column, beginCell.Start.Row, endCell.Start.Column];
            &lt;span style="color: blue;"&gt;var&lt;/span&gt; data = range.OrderBy(cell =&amp;gt; cell.Start.Column);
            &lt;span style="color: blue;"&gt;var&lt;/span&gt; tableHeadings = table.Columns.Cast&amp;lt;DataColumn&amp;gt;().Select((column, index) =&amp;gt; index + &lt;span style="color: rgb(163, 21, 21);"&gt;"."&lt;/span&gt; + column.ColumnName);
            &lt;span style="color: blue;"&gt;var&lt;/span&gt; worksheetHeadings = data.Select((cell, index) =&amp;gt; index + &lt;span style="color: rgb(163, 21, 21);"&gt;"."&lt;/span&gt; + cell.Value.ToString());
            &lt;span style="color: blue;"&gt;var&lt;/span&gt; missingHeadings = tableHeadings.Except(worksheetHeadings);
            &lt;span style="color: blue;"&gt;var&lt;/span&gt; extraHeadings = worksheetHeadings.Except(tableHeadings);
            &lt;span style="color: blue;"&gt;if&lt;/span&gt; (missingHeadings.IsEmpty() &amp;amp;&amp;amp; extraHeadings.IsEmpty()) &lt;span style="color: blue;"&gt;return&lt;/span&gt;;
            &lt;span style="color: blue;"&gt;throw&lt;/span&gt; &lt;span style="color: blue;"&gt;new&lt;/span&gt; Exception(&lt;span style="color: blue;"&gt;string&lt;/span&gt;.Format(
                &lt;span style="color: rgb(163, 21, 21);"&gt;"The worksheet, {1}, has the following errors:{0}"&lt;/span&gt; +
                (missingHeadings.IsEmpty() ? &lt;span style="color: blue;"&gt;string&lt;/span&gt;.Empty : &lt;span style="color: rgb(163, 21, 21);"&gt;"- Missing Headings: {2}{0}"&lt;/span&gt;) +
                (extraHeadings.IsEmpty() ? &lt;span style="color: blue;"&gt;string&lt;/span&gt;.Empty : &lt;span style="color: rgb(163, 21, 21);"&gt;"- Extra Headings: {3}"&lt;/span&gt;),
                Environment.NewLine, table.TableName, &lt;span style="color: blue;"&gt;string&lt;/span&gt;.Join(&lt;span style="color: rgb(163, 21, 21);"&gt;", "&lt;/span&gt;, missingHeadings), &lt;span style="color: blue;"&gt;string&lt;/span&gt;.Join(&lt;span style="color: rgb(163, 21, 21);"&gt;", "&lt;/span&gt;, extraHeadings)));
        }
&lt;/pre&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Note: if you use the validation method, you may want to put the calculation of EndCell into a method (to keep your code DRY).&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="msbr" When="02/01/2014 14:32:27">
          <Html>
        &lt;div class="markDownOutput "&gt;@danthman what is _valueAdjuster ? &lt;br&gt;
I have a error: "The name '_valueAdjuster' does not exist in the current context "
&lt;br&gt;
&lt;br&gt;
Thanks&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="danthman" When="06/01/2014 19:03:23">
          <Html>
        &lt;div class="markDownOutput "&gt;@msbr, &lt;br&gt;
&lt;br&gt;
You can safely remove the line that contains _valueAdjuster. (All that does is enable the client to provide a Func delegate to perform a custom conversion of a value.)&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Sheet direction">
      <Posts>
        <Post From="WhiteSwan" When="06/01/2014 08:09:26">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi , &lt;br&gt;
&lt;br&gt;
I'm wondering if it is possible to set sheet direction in epplus ? &lt;br&gt;
I would appreciate any hint to do that . &lt;br&gt;
&lt;br&gt;
Thanks&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="06/01/2014 18:15:37">
          <Html>
        &lt;div class="markDownOutput "&gt;I don´t remeber any property related to sheet direction. Maybe you can try by VBA.
&lt;br&gt;
&lt;br&gt;
&lt;a href="http://www.rondebruin.nl/win/s5/win004.htm" rel="nofollow"&gt;http://www.rondebruin.nl/win/s5/win004.htm&lt;/a&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Automatically choose a NumberFormat based on datatype of the column in LoadFromDataTable procedure.">
      <Posts>
        <Post From="leonardoFiorot" When="04/01/2014 23:20:28">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello everybody! &lt;br&gt;
&lt;br&gt;
I would like to share the code I made to automatically select a mask of number format based on the datatype of the column.
&lt;br&gt;
&lt;br&gt;
Changed code that follows:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;#region LoadFromDataTable
        /// &amp;lt;summary&amp;gt;
        /// Load the data from the datatable starting from the top left cell of the range
        /// &amp;lt;/summary&amp;gt;
        /// &amp;lt;param name="Table"&amp;gt;The datatable to load&amp;lt;/param&amp;gt;
        /// &amp;lt;param name="PrintHeaders"&amp;gt;Print the column caption property (if set) or the columnname property if not, on first row&amp;lt;/param&amp;gt;
        /// &amp;lt;param name="TableStyle"&amp;gt;The table style to apply to the data&amp;lt;/param&amp;gt;
        /// &amp;lt;param name="AutoNumberFormat"&amp;gt;Inserts the value as the field type of column&amp;lt;/param&amp;gt;
        /// &amp;lt;returns&amp;gt;The filled range&amp;lt;/returns&amp;gt;
        public ExcelRangeBase LoadFromDataTable(DataTable Table, bool PrintHeaders, TableStyles TableStyle, bool AutoNumberFormat = false)
        {
            var r = LoadFromDataTable(Table, PrintHeaders, AutoNumberFormat);

            int rows = Table.Rows.Count + (PrintHeaders ? 1 : 0) - 1;
            if (rows &amp;gt;= 0 &amp;amp;&amp;amp; Table.Columns.Count &amp;gt; 0)
            {
                var tbl = _worksheet.Tables.Add(new ExcelAddressBase(_fromRow, _fromCol, _fromRow + (rows == 0 ? 1 : rows), _fromCol + Table.Columns.Count - 1), Table.TableName);
                tbl.ShowHeader = PrintHeaders;
                tbl.TableStyle = TableStyle;
            }
            return r;
        }
        /// &amp;lt;summary&amp;gt;
        /// Load the data from the datatable starting from the top left cell of the range
        /// &amp;lt;/summary&amp;gt;
        /// &amp;lt;param name="Table"&amp;gt;The datatable to load&amp;lt;/param&amp;gt;
        /// &amp;lt;param name="PrintHeaders"&amp;gt;Print the caption property (if set) or the columnname property if not, on first row&amp;lt;/param&amp;gt;
        /// &amp;lt;param name="AutoNumberFormat"&amp;gt;Inserts the value as the field type of column&amp;lt;/param&amp;gt;
        /// &amp;lt;returns&amp;gt;The filled range&amp;lt;/returns&amp;gt;
        public ExcelRangeBase LoadFromDataTable(DataTable Table, bool PrintHeaders, bool AutoNumberFormat = false)
        {
            if (Table == null)
            {
                throw (new ArgumentNullException("Table can't be null"));
            }

            int col = _fromCol, row = _fromRow;
            if (PrintHeaders)
            {
                foreach (DataColumn dc in Table.Columns)
                {
                    if (AutoNumberFormat)
                    {
                        _worksheet.Column(col).Style.Numberformat.Format = GetAutoNumberFormat(dc.DataType);
                    }
                    
                    // If no caption is set, the ColumnName property is called implicitly.
                    _worksheet.Cell(row, col++).Value = dc.Caption;
                }

                row++;
                col = _fromCol;
            }
            foreach (DataRow dr in Table.Rows)
            {
                foreach (object value in dr.ItemArray)
                {
                    _worksheet.Cell(row, col++).Value = value;
                }
                row++;
                col = _fromCol;
            }
            return _worksheet.Cells[_fromRow, _fromCol, row - 1, _fromCol + Table.Columns.Count - 1];
        }

        private string GetAutoNumberFormat(Type type)
        {
            string format = "General";
            if (type == typeof(int))
                format = "0";
            else if (type == typeof(uint))
                format = "0";
            else if (type == typeof(long))
                format = "0";
            else if (type == typeof(ulong))
                format = "0";
            else if (type == typeof(short))
                format = "0";
            else if (type == typeof(ushort))
                format = "0";
            else if (type == typeof(double))
                format = "0.00";
            else if (type == typeof(float))
                format = "0.00";
            else if (type == typeof(decimal))
                format = NumberFormatInfo.CurrentInfo.CurrencySymbol + " #,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00";
            else if (type == typeof(DateTime))
                format = DateTimeFormatInfo.CurrentInfo.ShortDatePattern + " " + DateTimeFormatInfo.CurrentInfo.LongTimePattern;
            else if (type == typeof(string))
                format = "@";
            else if (type == typeof(bool))
                format = "\"" + bool.TrueString + "\";\"" + bool.TrueString + "\";\"" + bool.FalseString + "\"";

            return format;

        }
        #endregion&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Unreadable content after opening/saving the Excel file by EPPlus">
      <Posts>
        <Post From="trongvu" When="23/12/2013 07:36:21">
          <Html>
        &lt;div class="markDownOutput "&gt;I have an Excel file containing a TreeList. Then I just open and save the Excel file without doing any other thing.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;using (var excel = new ExcelPackage(existingFile))
{
     excel.Save();
}&lt;/code&gt;&lt;/pre&gt;
The output Excel file contains unreadable content and a Repair dialog appears to tell me about removing a part ("Removed Part: Drawing shape")
&lt;br&gt;
&lt;br&gt;
Please help me. &lt;br&gt;
&lt;br&gt;
Thanks, &lt;br&gt;
Vu&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="DenisRQ" When="03/01/2014 16:14:16">
          <Html>
        &lt;div class="markDownOutput "&gt;I have the same problem, did you solved it? &lt;br&gt;
&lt;br&gt;
/xl/worksheets/sheet1.xm&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Chart in Excel using EP plus">
      <Posts>
        <Post From="Sidhesh" When="03/01/2014 04:43:32">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
I have generated the column stack chart with datalables in excel using EPPlus lib. but datalabels seems to be overlapping.
&lt;br&gt;
&lt;br&gt;
how can i avoid overlapping of datalabels ? can i auto resize the chart? &lt;br&gt;
&lt;br&gt;
Thanks, &lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Reg. Create Excel File Using EPPLUS">
      <Posts>
        <Post From="erdhimant" When="02/01/2014 10:57:49">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
I want to create new excel file using the EPPLUS without copying the excel sheet from any location
&lt;br&gt;
&lt;br&gt;
Can anyone help me how to do this ?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Progress Info while saving/reading file and creating sheet from datatable">
      <Posts>
        <Post From="Haldun" When="25/12/2013 11:08:00">
          <Html>
        &lt;div class="markDownOutput "&gt;Dear All,&lt;br&gt;
&lt;br&gt;
Thank you for this life saver project.&lt;br&gt;
&lt;br&gt;
Just wondering if any chance to get progress info while saving/reading huge files or creating excel sheets from datatables with LoadFromDataTable?&lt;br&gt;
&lt;br&gt;
Thanks.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to use InsertRow mantaining the format of the previous row....">
      <Posts>
        <Post From="stepho75" When="08/11/2012 10:06:49">
          <Html>
        
&lt;p&gt;When using &lt;strong&gt;Excel.Interop&lt;/strong&gt; there was a fantastic command that let you add a row keeping the format of the above row..."&lt;em&gt;row.Insert(Excel.XlInsertShiftDirection.xlShiftDown, false)&lt;/em&gt;"&lt;/p&gt;
&lt;p&gt;Unfortunately I cannot manage to replicate the same functionality in EPPlus.&lt;/p&gt;
&lt;p&gt;I tried "&lt;em&gt;InsertRow&lt;/em&gt;", but this adds a brand new row loosing the format of the above row.&lt;/p&gt;
&lt;p&gt;Please help.&lt;/p&gt;
&lt;p&gt;Thanks&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Stefano&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Robert_E" When="12/11/2012 06:52:55">
          <Html>
        
&lt;p&gt;You can use ExcelWorksheet.InsertRow(int rowFrom, int rows, intCopyStylesFromRow);&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="kiranshenvi" When="21/12/2013 07:59:27">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi Robert, &lt;br&gt;
&lt;br&gt;
Thanks it worked. But there is one more issue with the formatting being returned. If the above row contains some merged cells those don't appear to be copied to the new rows. Is there any other way to create new rows with the merged property being retained?
&lt;br&gt;
&lt;br&gt;
Regards, &lt;br&gt;
&lt;br&gt;
Kiran Shenvi&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Display the first row field field name in a pivot table">
      <Posts>
        <Post From="zippy1981" When="19/12/2013 21:26:23">
          <Html>
        &lt;div class="markDownOutput "&gt;I am trying to create pivot tables with EPPlus. I got the formatting the way I want, tabular rows labels.&lt;br&gt;
&lt;br&gt;
However, I want to get rid of the drop down filter "Row labels" and replace it with the name of the first field. I know I can set the PivotTable.RowHeaderCaption property, but that will not be updated if the user edits the pivot table after my code
 generates it. How do I not display the RowHeaderCaption with the filter?&lt;br&gt;
&lt;br&gt;
I have made a &lt;a href="https://gist.github.com/zippy1981/8046650" rel="nofollow"&gt;
sample&lt;/a&gt; that pulls data from NYC open data. That creates a pivot table illustrating the problem.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Removing the default blue format of pivot tables">
      <Posts>
        <Post From="zippy1981" When="19/12/2013 21:23:53">
          <Html>
        &lt;div class="markDownOutput "&gt;When I make a pivot table with EPPlus, it is formatted in a manner similar to the default formatting of a table, blue and light blue alternating. How do I remvoe this?&lt;br&gt;
&lt;br&gt;
I have sample code that does this &lt;a href="https://gist.github.com/zippy1981/8046650" rel="nofollow"&gt;
here&lt;/a&gt;.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="AreaStacked DataLabel">
      <Posts>
        <Post From="Krenom" When="19/12/2013 11:25:49">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
I have created other types of charts (pies, bars) and they have access to datalabel to enable them, but it would seem that the area stacked type doesn't.
&lt;br&gt;
&lt;br&gt;
I can see that Excel itself has a layout that shows the data labels so at least I know it's possible, but I can't see any way to add/enable the data labels on an areastacked chart.
&lt;br&gt;
&lt;br&gt;
Am I missing something or is it a less than obvious solution to get them to show on this particular chart type?
&lt;br&gt;
&lt;br&gt;
Thanks.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Excel to Datatable">
      <Posts>
        <Post From="bgil331" When="18/12/2013 20:01:26">
          <Html>
        &lt;div class="markDownOutput "&gt;I was wondering if there is a way to import Excel to a Datatable without going row by row (example below)? Thanks in advance!
&lt;br&gt;
&lt;br&gt;
public static DataTable getDataTableFromExcel(string path) &lt;br&gt;
{&lt;br&gt;
&lt;pre&gt;&lt;code&gt;using (var pck = new OfficeOpenXml.ExcelPackage())
{
    using (var stream = File.OpenRead(path))
    {
        pck.Load(stream);
    }
    var ws = pck.Workbook.Worksheets.First();  
    DataTable tbl = new DataTable();
    bool hasHeader = true; // adjust it accordingly( i've mentioned that this is a simple approach)
    foreach (var firstRowCell in ws.Cells[1, 1, 1, ws.Dimension.End.Column])
    {
        tbl.Columns.Add(hasHeader ? firstRowCell.Text : string.Format("Column {0}", firstRowCell.Start.Column));
    }
    var startRow = hasHeader ? 2 : 1;
    for (var rowNum = startRow; rowNum &amp;lt;= ws.Dimension.End.Row; rowNum++)
    {
        var wsRow = ws.Cells[rowNum, 1, rowNum, ws.Dimension.End.Column];
        var row = tbl.NewRow();
        foreach (var cell in wsRow)
        {
            row[cell.Start.Column - 1] = cell.Text;
        }
        tbl.Rows.Add(row);
    }
    return tbl;
}&lt;/code&gt;&lt;/pre&gt;
}&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Chm documentation not working maybe you can add this tip to the newbies">
      <Posts>
        <Post From="sabrina_c" When="18/12/2013 16:01:07">
          <Html>
        &lt;div class="markDownOutput "&gt;Sorry if this has been discussed before, but using the search I didn't found clues.
&lt;br&gt;
&lt;br&gt;
I'm new to epplus, so I've downloaded the documentation and unzipped the .chm file but opening it all the content was blank.
&lt;br&gt;
&lt;br&gt;
After a few searches on internet I found that the problem is due to the fact that for security reasons the downloaded file content is blocked.
&lt;br&gt;
To be able to access the documentation you need to open the properties window, and look if there is an "Unblock" button on this window. After unblocking it the content appears inside your chm.
&lt;br&gt;
Sometimes the same result can be reached simply copying and pasting the file from a disk to another in your pc (but I'm not sure why this happens).
&lt;br&gt;
&lt;br&gt;
just to avoid newbies frustration &lt;br&gt;
bye &lt;br&gt;
Sabrina&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="18/12/2013 16:06:56">
          <Html>
        &lt;div class="markDownOutput "&gt;Glad to know that you solved your problem. I didn't know about that security issue.
&lt;br&gt;
&lt;br&gt;
Regards, &lt;br&gt;
Thiago&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="ExcelVbaProject Constants Property">
      <Posts>
        <Post From="rchorev" When="11/12/2013 23:53:17">
          <Html>
        &lt;div class="markDownOutput "&gt;Anyone had success using this property? When I set this property: &lt;br&gt;
&lt;br&gt;
_package.Workbook.VbaProject.Constants = "SbA = 1" &lt;br&gt;
and then save the workbook I cannot open the workbook in Excel. It complains about it being corrupted.
&lt;br&gt;
&lt;br&gt;
When I read in a workbook that has conditional compilation arguments set I can successfully read them using _package.Workbook.VbaProject.Constants.
&lt;br&gt;
&lt;br&gt;
If I then set _package.Workbook.VbaProject.Constants =_package.Workbook.VbaProject.Constants and save the workbook it is corrupted again. Seems like a bug in the code?
&lt;br&gt;
&lt;br&gt;
I then looked where this is being added to the file: &lt;br&gt;
bw.Write((ushort)0x0C); //ID&lt;br&gt;
&lt;pre&gt;&lt;code&gt;        bw.Write((uint)Constants.Length);              //Size
        bw.Write(Encoding.GetEncoding(CodePage).GetBytes(Constants));              //Help context id
        bw.Write((ushort)0x3C);                                           //ID
        bw.Write((uint)Constants.Length/2);                              //Size
        bw.Write(Encoding.Unicode.GetBytes(Constants));  //HelpFile2
&lt;/code&gt;&lt;/pre&gt;
But honestly this is the part of eeplus I don't really understand. The comments regarding Help context and helpfile2 seem suspicious.
&lt;br&gt;
&lt;br&gt;
Thanks, &lt;br&gt;
Roy&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="rchorev" When="12/12/2013 20:57:36">
          <Html>
        &lt;div class="markDownOutput "&gt;I solved the problem by commenting out the following lines: &lt;br&gt;
//bw.Write((ushort)0x3C); //ID&lt;br&gt;
&lt;pre&gt;&lt;code&gt;        //bw.Write((uint)Constants.Length/2);                              //Size
        //bw.Write(Encoding.Unicode.GetBytes(Constants));  //HelpFile2&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to change selected items in page fields in a pivot table?">
      <Posts>
        <Post From="T1gana" When="11/12/2013 22:59:10">
          <Html>
        &lt;div class="markDownOutput "&gt;I'm trying to change this value from 0 to 1:&lt;br&gt;
&lt;br&gt;
&lt;img alt="Image" src="http://i.imgur.com/ZOgqcwT.png"&gt;&lt;br&gt;
&lt;br&gt;
I would expect to do something like this:&lt;br&gt;
pivotTable.PageFields[3].Items[0].checked = false;&lt;br&gt;
pivotTable.PageFields[3].Items[1].checked = true;&lt;br&gt;
&lt;br&gt;
But I can't see any way to chose which items are selected.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="T1gana" When="12/12/2013 15:05:37">
          <Html>
        &lt;div class="markDownOutput "&gt;I figured out how to do it with excel interop in case this helps anybody:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;            Application excelApp = new Application();
            Workbook workBook = excelApp.Workbooks.Open(filePath);

            foreach (Worksheet sheet in workBook.Sheets)
            {
                foreach (PivotTable pivotTable in sheet.PivotTables())
                {
                    pivotTable.PivotCache().MissingItemsLimit = XlPivotTableMissingItems.xlMissingItemsNone;
                    pivotTable.PivotCache().Refresh();

                    PivotField Value = (PivotField)pivotTable.PageFields("Value");

                    PivotItem one = (PivotItem)Value.PivotItems("1");
                    one .Visible = true;

                    PivotItem zero= (PivotItem)Value.PivotItems("0");
                    zero.Visible = false;
                }
            }

            workBook.Save();
            workBook.Close();
            Marshal.ReleaseComObject(workBook);&lt;/code&gt;&lt;/pre&gt;
If anybody knows how to do this in EPPlus that would be awesome. It would be nice if interop wasn't necessary.
&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Date modification has a random last date">
      <Posts>
        <Post From="flamefury" When="10/12/2013 18:12:42">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi,&lt;br&gt;
&lt;br&gt;
Right now I am trying to read in a spreadsheet, modify its date column, then save it to a new location. I attempt to change the date to today plus one day. The code I'm using is as follows:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;worksheet.Column(dateColumnIndex).Style.Numberformat.Format = @"d/m/yyyy";
for (var row = 2; row &amp;lt;= rowCount; row++)
{
    worksheet.SetValue(row, dateColumnIndex, DateTime.Now.Date.AddDays(1));
}
worksheet.Column(dateColumnIndex).Style.HorizontalAlignment = ExcelHorizontalAlignment.Left;
worksheet.Column(dateColumnIndex).Style.VerticalAlignment = ExcelVerticalAlignment.Top;&lt;/code&gt;&lt;/pre&gt;
This works fine for the first rows. However, the last row for whatever reason always ends up as the 7th of the current month.&lt;br&gt;
&lt;br&gt;
For example, if I were to run the code today, the date column would be set to 11/12/2013 for every row but the last, which would be set to 7/12/2013.&lt;br&gt;
&lt;br&gt;
Does anyone have any ideas?&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
EDIT: D'oh, please ignore. My rowcount was starting from 1 while the loop began at 2 to avoid modifying the column header.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Worksheet Formatting Corruption">
      <Posts>
        <Post From="wtftc" When="09/12/2013 17:04:22">
          <Html>
        &lt;div class="markDownOutput "&gt;I'm not sure if the right place to put this is in issues or discussions, but I'm putting it in both places for references. The Issue I created can be found here:
&lt;a href="https://epplus.codeplex.com/workitem/14927" rel="nofollow"&gt;https://epplus.codeplex.com/workitem/14927&lt;/a&gt;. It also has an attachment example.
&lt;br&gt;
&lt;br&gt;
I am hitting an issue where the Worksheet formatting is being corrupted after I open, make a small change, then re-save a sheet.
&lt;br&gt;
&lt;br&gt;
Here is the example code:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;        public static void TestExcelOutput()
        {
            var path =
                @"C:\Users\bill\Documents\Visual Studio 2010\Projects\EPPlusTest\EPPlusTest\Input.xlsx";
            var inputFileInfo = new FileInfo(path);

            var outputPath = Path.Combine(Path.GetDirectoryName(path), string.Format("{0}{1}.{2}", Path.GetFileNameWithoutExtension(path),
                                          "-processed", Path.GetExtension(path)));
            var outputFileInfo = new FileInfo(outputPath);

            using (var package = new ExcelPackage(inputFileInfo))
            {
                foreach (var worksheet in package.Workbook.Worksheets)
                {
                    worksheet.SetValue(1, 1, "foo");
                }
                package.SaveAs(outputFileInfo);
            }

        }&lt;/code&gt;&lt;/pre&gt;
For me, after re-saving, some of the cell borders in the Analyst tab are lost.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Problem when importing spreadsheet to Google Drive - the import fails">
      <Posts>
        <Post From="albertmarkish" When="04/12/2013 15:12:04">
          <Html>
        &lt;div class="markDownOutput "&gt;When trying to upload the spreadsheet to Google Drive with conversion=on, the upload fails with the following error message:
&lt;br&gt;
&lt;br&gt;
&lt;em&gt;The spreadsheet you are trying to upload is invalid.&lt;/em&gt; &lt;br&gt;
&lt;br&gt;
The same spreadsheet opens perfectly in Microsoft Office. The Google Drive document preview or GMail attachment preview also can display it just fine.
&lt;br&gt;
&lt;br&gt;
It's a really simple spreadsheet - just three worksheets with a short table in each of them.
&lt;br&gt;
&lt;br&gt;
Does anybody know how to solve this ?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Calculate total column width from a range">
      <Posts>
        <Post From="mariusmeier" When="03/12/2013 23:04:04">
          <Html>
        &lt;div class="markDownOutput "&gt;hello&lt;br&gt;
&lt;br&gt;
What would be the easiest way to calculate the total column with from a range (example A1:H10)?&lt;br&gt;
I have seen xlsx examples with the open xml tool, which defines only two columns. How can i calculate the width of the other ones which are not defined as a column element?&lt;br&gt;
&lt;br&gt;
Here is an example:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;x:cols xmlns:x="http://schemas.openxmlformats.org/spreadsheetml/2006/main"&amp;gt;
  &amp;lt;x:col min="2" max="4" width="17.85546875" customWidth="1" /&amp;gt;
&amp;lt;/x:cols&amp;gt;&lt;/code&gt;&lt;/pre&gt;
Column 2 to 4 have 125 pixel length. But if i want to calculate column width from column 1 to 5, how is that possible?&lt;br&gt;
Do i have to consider the page setup to calculate the total width and then subtract those elements from it?&lt;br&gt;
&lt;br&gt;
The main goal would be to fit an image into a cell range (example A1:H10). To fullfill this task i have to evaluate the total column width and the total row height. Then i can use these two to create an image with the given pixel size.&lt;br&gt;
&lt;br&gt;
Greetings &lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Autofit row height ?">
      <Posts>
        <Post From="gicio" When="01/12/2011 18:18:49">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;how to autofit the row height ?&lt;/p&gt;
&lt;p&gt;regards,&lt;/p&gt;
&lt;p&gt;gicio&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="08/12/2011 20:53:02">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;There is no autofit method for rowheights in this version&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="colourblend" When="03/12/2013 19:24:43">
          <Html>
        &lt;div class="markDownOutput "&gt;Is it possible to use autofit for rows now?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Reverse order y-axis in bar chart">
      <Posts>
        <Post From="henri_dewinter" When="16/10/2013 14:54:17">
          <Html>
        &lt;div class="markDownOutput "&gt;How can I reverse the order of the y-axis in a bar chart. Default the y-axis is in reverse order and I want it to be in the order of the original data (from top to bottom). I know there is a setting in Excel to do this, but I want to do it with EPPlus.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="PsYcK1K" When="26/11/2013 17:49:21">
          <Html>
        &lt;div class="markDownOutput "&gt;I just found it... curiosly it changed the Y axis :) &lt;br&gt;
&lt;br&gt;
chart.XAxis.Orientation = eAxisOrientation.MaxMin&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="henri_dewinter" When="02/12/2013 13:29:40">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi PsYcK1K, &lt;br&gt;
&lt;br&gt;
Thank you for your reply...it works.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="EPPlus vs Open xml sdk">
      <Posts>
        <Post From="jeevajsb" When="02/12/2013 12:54:34">
          <Html>
        &lt;div class="markDownOutput "&gt;Please would you give, advantages and disadvanges between EPPlus vs Open xml sdk. would you mention about the support for this ?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Read Excel from Excel Pack">
      <Posts>
        <Post From="tungdtcoder" When="26/11/2013 02:51:50">
          <Html>
        &lt;div class="markDownOutput "&gt;I have a class which read excel file by ExcelPackage &lt;em&gt;(The class name is Excel Reader)&lt;/em&gt;. When you don't use 'Delete' combine with 'Clear content' menu of office , excel reader is right.
&lt;br&gt;
&lt;br&gt;
But, when you try to 'Delete' command at column lists in Excel tool, and after that use 'Clear content' command at Row lists in Excel tool. Excel reader is incorrect. I have used the office 2007 professional.
&lt;br&gt;
&lt;br&gt;
my code block maybe wrong. But I can't understand what wrong it is ? So, I capture some picture from my desktop , upload my code block and attack my error excel file into Mediafire. And I Hope that somebody in the great Epplus team may help me :). Your product
 works so well, but May that problem be an issue of your project ? Please help me, I stuck with this problem 2 days ago :(.&lt;br&gt;
&lt;br&gt;
This is a block code&lt;br&gt;
&lt;pre&gt;&lt;code&gt;int SheetColumnsCount = item.Dimension.End.Column;// Find End Column
int SheetRowCount = item.Dimension.End.Row;// Find End Row

if (
    SheetColumnsCount &amp;gt; 0
    &amp;amp;&amp;amp;
    SheetRowCount &amp;gt; 0
   )
{
    for (int indexRows = 1; indexRows &amp;lt;=SheetRowCount; indexRows++)
    {
        DataRow row = SheetItemInfomation.Data.NewRow();//Create new row

        for (int indexCols = 1; indexCols &amp;lt;=SheetColumnsCount; indexCols++)
        {
            if (item.Cells[indexRows, indexCols].Value != null)//if value is not null (it mean you didn't use the clear content menu)
                row["Cols_" + ((int)(indexCols-1)).ToString()] = item.Cells[indexRows, indexCols].Value;
            else//It mean that the value of row is empty because of the clear content are used.
                row["Cols_" + ((int)(indexCols - 1)).ToString()] = "";
        }

        SheetItemInfomation.Data.Rows.Add(row);
    }

    SheetItemInfomation.RemoveBlankColumns(TrimedPosition);
    SheetItemInfomation.RemoveBlankRows();

    Sheets.Add(SheetItemInfomation);
    ToTalSheetCount++;
}&lt;/code&gt;&lt;/pre&gt;
This is a link of error file &lt;br&gt;
&lt;a href="http://www.mediafire.com/view/ddc48vcqc83hcfx/error.xlsx" rel="nofollow"&gt;http://www.mediafire.com/view/ddc48vcqc83hcfx/error.xlsx&lt;/a&gt;&lt;br&gt;
&lt;br&gt;
And this is a serial of demonstration steps to create error :&lt;br&gt;
Delete column&lt;br&gt;
&lt;img alt="Image" src="http://imageshack.com/a/img811/7193/9aeh.png"&gt;&lt;br&gt;
&lt;br&gt;
Clear content of row&lt;br&gt;
&lt;img alt="Image" src="http://imageshack.com/a/img24/1860/lidk.png"&gt;&lt;br&gt;
&lt;br&gt;
Actual data in excel file :&lt;br&gt;
&lt;img alt="Image" src="http://imageshack.com/a/img62/8647/40ur.png"&gt;&lt;br&gt;
&lt;br&gt;
Reader 's Data in code :&lt;br&gt;
&lt;img alt="Image" src="http://imageshack.com/a/img203/4161/eixt.png"&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="tungdtcoder" When="27/11/2013 10:48:27">
          <Html>
        &lt;div class="markDownOutput "&gt;Help me please, my project are running, and few users sometime have complex actions in their excel files. For example , an academic user have grade information files from teachers. And the users must combine all files together to create a final grade information
 file.&lt;br&gt;
&lt;br&gt;
In their process, they must copy, paste, delete and sometime clear the content of their excel files (&lt;em&gt;because of their mistake for example)&lt;/em&gt;. And this issue accompany with the complicate their actions. After that, the issue make a reading Data is incorrect.
&lt;br&gt;
&lt;br&gt;
And my program always check the conditional of each cells. Because of above issue, my program will reject excel file :( (in each different context the program will reject by different conditional -it depend on error's reading data ).
&lt;br&gt;
&lt;br&gt;
I can't explain for them :( . So please help me. &lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="29/11/2013 05:32:57">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
Sorry about your problem. However, I am not sure if I understand it. Do you open the file in Excel, remove some data, save and close the file, then open it with EPPlus? And when you open it with EPPlus you find things that is not there if you open it with Excel?
&lt;br&gt;
&lt;br&gt;
If I find the time to look deeper into this - please describe how I can recreate your problem.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="tungdtcoder" When="30/11/2013 02:59:26">
          <Html>
        &lt;div class="markDownOutput "&gt;Thank for reply Swmal. &lt;br&gt;
&lt;br&gt;
&lt;strong&gt;swmal wrote:&lt;/strong&gt;&lt;br&gt;
&lt;blockquote&gt;Sorry about your problem. However, I am not sure if I understand it. Do you open the file in Excel, remove some data, save and close the file, then open it with EPPlus? And when you open it with EPPlus you find things that is not there if you open
 it with Excel?&lt;br&gt;
&lt;/blockquote&gt;
You completely understand my problem. And I will create an video to demo that how to create my problem (all steps' detail ).
&lt;br&gt;
&lt;br&gt;
After that I will upload into youtube website and embed video in this forum for you to get further more information.
&lt;br&gt;
&lt;br&gt;
Thank alot once more times.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Format Cell as Heading 1">
      <Posts>
        <Post From="mmalbergier" When="27/11/2013 20:50:17">
          <Html>
        &lt;div class="markDownOutput "&gt;Is it possible to format a specific cell using builtin styles like "Heading 1"?
&lt;br&gt;
&lt;br&gt;
Thanks&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Problem in loading excel file greater than 1 MB">
      <Posts>
        <Post From="ChRaviTeja" When="26/11/2013 05:53:48">
          <Html>
        &lt;div class="markDownOutput "&gt;Epplus is showing : &lt;br&gt;
Index was out of range. Must be non-negative and less than the size of the collection.
&lt;br&gt;
Parameter name: index &lt;br&gt;
for excel file greater than 1 MB&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="About CSV file">
      <Posts>
        <Post From="ChRaviTeja" When="26/11/2013 04:31:29">
          <Html>
        &lt;div class="markDownOutput "&gt;Can we open and save CSV file using epplus&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="About csv files">
      <Posts>
        <Post From="ChRaviTeja" When="26/11/2013 04:30:09">
          <Html>
        &lt;div class="markDownOutput "&gt;how to convert xls or xlsx files to CSV file&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Column Formatting">
      <Posts>
        <Post From="eljuanpelos" When="25/11/2013 21:15:21">
          <Html>
        &lt;div class="markDownOutput "&gt;Is it possible to assign the number format to a column as straight forward as ClosedXML, I mean
&lt;br&gt;
&lt;br&gt;
I've tried something like this in ClosedXML and it works perfectly &lt;br&gt;
&lt;br&gt;
ws.Cell(row, col).Style.NumberFormat.NumberFormatId = 9; &lt;br&gt;
&lt;br&gt;
The only way I see how to do this in EPPlus is using custom formats: &lt;br&gt;
&lt;br&gt;
ws.Column(1).Style.Numberformat.Format = "0.00%" &lt;br&gt;
&lt;br&gt;
But I really would like to be able to use the built in formats as : &lt;br&gt;
&lt;br&gt;
ews.Column(1).Style.Numberformat.NumFmtID = 9; &lt;br&gt;
&lt;br&gt;
but NumFmtID is read only, is there are work around this? &lt;br&gt;
&lt;br&gt;
Thanks in advance&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Is there a way of using validation to stop white spaces in a cell or range of cells">
      <Posts>
        <Post From="derailedJeff" When="25/11/2013 16:44:12">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi &lt;br&gt;
&lt;br&gt;
In my application I get my users to download an Excel file created using EPPlus, I want to control what the user can enter into certain cells, specifically I want to stop the user entering in white spaces.
&lt;br&gt;
&lt;br&gt;
Is the re a way of doing this with RegEx or any other means? &lt;br&gt;
&lt;br&gt;
Jeff&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Align picture in middle of cell (ASP.Net/C#)">
      <Posts>
        <Post From="AdnanSaeed" When="25/11/2013 16:05:13">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi guys, &lt;br&gt;
&lt;br&gt;
I hope you are doing great. &lt;br&gt;
&lt;br&gt;
I am working with EPPlus library to generate excel files in ASP.Net/C#, and I want to insert an image in each row, but image should be aligned in middle of the cell (or may be on top but with some margin). Below is the code which I am using.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;System.Drawing.Image img = System.Drawing.Image.FromFile(MapPath("~/images/myimage.jpg"));
ExcelPicture pic = ws.Drawings.AddPicture("My Image", img);
int left = 0;
int top = 0;
CalculateCoodinates(row, 2, ws, out top, out left);
pic.SetSize(80, 50);
pic.SetPosition(top, left);

// Method to calculate top and left coordinates
void CalculateCoodinates(int row, int column, ExcelWorksheet worksheet, out int top, out int left)
{
    double t = 5; // 5 - to add some extra padding
    left = 66;

    for (int i = 1; i &amp;lt; row; i++)
    {
        t += (int)worksheet.Row(i).Height;
    }

    top = (int)Math.Ceiling(t / 0.75);
}&lt;/code&gt;&lt;/pre&gt;
I tried different ways, but I didn't get the images in proper cell. In top few cells, images are appearing fine, but after that images are moving down.
&lt;br&gt;
&lt;br&gt;
I also tried:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;pic.From.Column = 1;
pic.From.Row = (row - 1);&lt;/code&gt;&lt;/pre&gt;
but it's aligning image on top border of the cell which I don't want. &lt;br&gt;
&lt;br&gt;
Any help will be highly appreciated. &lt;br&gt;
&lt;br&gt;
Many thanks... &lt;br&gt;
&lt;br&gt;
Adnan&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="RichText.Color does not work with theme colors">
      <Posts>
        <Post From="Aculeo" When="25/11/2013 13:57:08">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello, &lt;br&gt;
&lt;br&gt;
I'm not sure if this is a bug or intended, but &lt;code&gt;RichText.Color&lt;/code&gt; sometimes returns
&lt;code&gt;Color [Empty]&lt;/code&gt; even though a color is assigned. After digging a bit in the code I found out it doesn't work with theme colors.
&lt;br&gt;
&lt;br&gt;
Normal colors are saved as &lt;code&gt;&amp;lt;color rgb="FFFFC000" /&amp;gt;&lt;/code&gt;, while theme colors are saved as
&lt;code&gt;&amp;lt;color theme="9" tint="-0.499984740745262" /&amp;gt;&lt;/code&gt;.
&lt;br&gt;
&lt;br&gt;
Is there a simple way to get the actual color? The theme colors are stored in the XLSX file, so it should be possible somehow.
&lt;br&gt;
&lt;br&gt;
Thanks in advance&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How do I export custom object list to epplus">
      <Posts>
        <Post From="akbuz" When="21/11/2013 12:47:57">
          <Html>
        &lt;div class="markDownOutput "&gt;I want to export with a generic object list.&lt;br&gt;
&lt;br&gt;
example:&lt;br&gt;
List&amp;lt;object&amp;gt; records = .....&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="EPPlus: Created file is locked">
      <Posts>
        <Post From="dpreznik" When="20/11/2013 18:28:14">
          <Html>
        &lt;div class="markDownOutput "&gt;I create an Excel file using EPPlus library. After the file is created, it cannot be deleted or edited, as it is said to be used by "another user", as long as the program is running. I cannot find any solution that would work for me.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;Here is my code:

        var newFile = new FileInfo(path); 
        using (var xlPackage = new ExcelPackage(newFile))
        {
            var ws = xlPackage.Workbook.Worksheets.Add("Sheet1");
...
            xlPackage.Save();
        }&lt;/code&gt;&lt;/pre&gt;
The strange thing is that I am able File.Delete() the newly created files from within my code. But I cannot delete or edit it while the program is still running from the Windows Explorer.
&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Multithread not supported ?">
      <Posts>
        <Post From="TiramisuBxl" When="10/01/2012 12:56:45">
          <Html>
        
&lt;p&gt;&lt;span&gt;Hello,&lt;/span&gt;&lt;br&gt;
&lt;br&gt;
&lt;span&gt;First of all thank you very much for this library.&lt;/span&gt;&lt;br&gt;
&lt;span&gt;Very powerful &amp;amp; easy to use.&lt;/span&gt;&lt;br&gt;
&lt;span&gt;I am trying to generate reports in parallel to save some time but unfortunately when trying to use the library via 2 threads at the same time it locks my application. Any clue ? When I'll have some time I'll try to investigate with the source code.&lt;/span&gt;&lt;br&gt;
&lt;span&gt;Thank you to let me know if there is a special way to handle multithread.&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;TiramisuBxl&lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="novenyang" When="05/09/2012 15:27:34">
          <Html>
        
&lt;p&gt;I have the same problem, any one has an idea?&lt;/p&gt;
&lt;p&gt;Thanks,&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="05/09/2012 17:54:43">
          <Html>
        
&lt;p&gt;I think it is not possible because &lt;span&gt;System.IO.Packaging isn't thread safety.&amp;nbsp;&lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jANkALLMAN" When="05/09/2012 20:26:28">
          <Html>
        
&lt;p&gt;Threading works until the package get to about 1MB of size&amp;nbsp;(compressed). Then the package api starts to use Isolated storage. IS is&amp;nbsp;for some strange reason not thread safe, and will hang even though you use different instances.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="TiramisuBxl" When="06/09/2012 07:03:30">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I solved the issue by modifying the EPPlus code, I added a critical section in the save function.&lt;/p&gt;
&lt;p&gt;@Jan, wouldn't it be interesting to have a thread safe function save ? Leave the current one so people can use it in parallel for small files and save time but for big files save only 1 by 1. Or even better find a way to have an estimate of the file size
 so when we know it can hang we save with the critical section.&lt;/p&gt;
&lt;p&gt;What do you think ?&lt;/p&gt;
&lt;p&gt;Regards.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mjslane" When="15/11/2012 18:03:55">
          <Html>
        
&lt;p&gt;Has anyone found a work around for this? &amp;nbsp;I have 100 reports to generate, all 3-10MiB in size and taking around 2-5 minutes to build. &amp;nbsp;Doing this in&amp;nbsp;parallel&amp;nbsp;would be so much quicker. &amp;nbsp;I haven't looked at the relevant code (it's
 almost pub o'clock for me, and this has just become an issue for me), but would locking the calls to IS with a mutex solve this issue? &amp;nbsp;&lt;/p&gt;
&lt;p&gt;http://social.msdn.microsoft.com/Forums/en-US/wpdevelop/thread/b6779758-0d8d-4fb9-93d6-ea642c8a02db/&lt;/p&gt;
&lt;p&gt;If no one has some code for this, I'll see if I get time tomorrow to give it a go.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mjslane" When="16/11/2012 11:07:12">
          <Html>
        
&lt;p&gt;Add a private static object to ExcelPackage and wrap the innards of the Save() method with a lock on the object.&lt;/p&gt;
&lt;p&gt;This appears to work with some basic spreadsheets. I noticed that charts reference IO.Packaging, and I haven't tried a spreadsheet with a chart. &amp;nbsp;I'm under time pressure to deliver this project so I can only justify testing areas that affect me.&lt;/p&gt;
&lt;p&gt;System.IO.Packaging is referenced quite a few times throughout the project making it difficult to wrap the relevant areas in mutexes. I'm not familiar with this namespace as its not an area I have any use for in my usual work, but using proxy object that
 wraps the IO.Packaging classes would probably work if a more fine grained approach is necessary.&lt;/p&gt;
&lt;p&gt;I'll do some more testing.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="19/11/2012 21:24:36">
          <Html>
        
&lt;p&gt;I have replaced the Packaging API with DotNetZip in CoreChanges bransch. Feel free to test it if you are&amp;nbsp;having problems with mulithreading...&lt;/p&gt;
&lt;p&gt;&lt;a href="http://epplus.codeplex.com/SourceControl/changeset/view/af16b68ec2e5" rel="nofollow"&gt;http://epplus.codeplex.com/SourceControl/changeset/view/af16b68ec2e5&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="iabaker" When="19/11/2012 22:02:54">
          <Html>
        
&lt;p&gt;When do you expect this change to be released?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="21/11/2012 07:13:28">
          <Html>
        
&lt;p&gt;I'm not sure, but it will not be in the near future. I would guess in the middle of next year.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="katesar" When="12/09/2013 20:06:48">
          <Html>
        &lt;div class="markDownOutput "&gt;Does release 3.1.3 support multithreaded use now?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="12/09/2013 20:20:32">
          <Html>
        &lt;div class="markDownOutput "&gt;No, not yet. I don't have any info but there is no more dotnetzip branch, maybe Jan had some issues and aborted this change.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="richardtallent" When="01/10/2013 22:36:17">
          <Html>
        &lt;div class="markDownOutput "&gt;It's still there, it's just rolled up in the branch called "FormulaParser." I've been using it without issues.
&lt;br&gt;
&lt;br&gt;
Has anyone approached Jan about taking over this project? The progress has been very slow, and I fear this entire library will be abandoned soon if we can't get some traction on moving some of these major updates into a new stable version.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="zippy1981" When="12/11/2013 00:49:50">
          <Html>
        &lt;div class="markDownOutput "&gt;@richardtalent, are you saying if I use that branch I should be able to create different worksheets in parallel and call save without doing any locking on my end?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="swmal" When="17/11/2013 09:20:36">
          <Html>
        &lt;div class="markDownOutput "&gt;zippy1981 - the FormulaParser branch has a totally rewritten cellstore, which does not utilize System.IO.Packaging, so it has hopefully less issues when it comes to threading. But keep in mind that this branch is currently under development, Jan is working
 on this right now and I dont think he has got all functionality covered yet.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="DataValidations List Validation - String limit?">
      <Posts>
        <Post From="elgransan" When="26/04/2012 06:48:02">
          <Html>
        
&lt;p&gt;Hello!!!... I'm using List Validations and if I add to the list a 100 char length items to the list the Excel throw an error and do not display the list, There is a limit on the string length for each item in the list?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks!!!&lt;/p&gt;
&lt;p&gt;Regards&lt;/p&gt;
&lt;p&gt;Santiago&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="elgransan" When="06/11/2012 23:18:24">
          <Html>
        
&lt;p&gt;Hello, I'm back with this issue, I'm creating a Excel Worksheet from asp.net mvc, and I added some DataValidation in this way:&lt;/p&gt;
&lt;p&gt;&lt;span style="white-space: pre;"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;pre&gt;	//This Works perfect
            var val = ws.DataValidations.AddListValidation("B2:B10000");
            val.ShowErrorMessage = true;
            val.Formula.Values.Add("Add");
            val.Formula.Values.Add("Delete");

&lt;span style="white-space: pre;"&gt;	&lt;/span&gt;//This Is not working, Excel give error: Characteristics erased: Cell with data validation: /xl/worksheets/sheet1.xml&lt;/pre&gt;
&lt;pre&gt;            var val2 = ws.DataValidations.AddListValidation("C2:C10000");
            val2.ShowErrorMessage = true;
            for (int x = 0; x &amp;lt; 20; x++)
            {
                Dictionary row = (Dictionary)Groups[x];
                val2.Formula.Values.Add(row["Name"].Substring(0, Math.Min(row["Name"].Length, 17)));
            }
&lt;/pre&gt;
&lt;p&gt;I don't know why but if I change the content from Groups["Name"] the max length of the string can be different, sometimes bigger, sometimes smaller. And also I can't add more than 20 records to the list.&lt;/p&gt;
&lt;p&gt;I want to know the real limits to this functionality to see if I need to do a workaround with this.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks!&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="swmal" When="09/11/2012 19:45:32">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;If you add a list data validation via Excel you will see that the values are entered&amp;nbsp;as a comma separated string. It is stored the same way in the open office xml.&amp;nbsp;In Excel there&amp;nbsp;seems&amp;nbsp;to be&amp;nbsp;a limitation for the total length of this
 string, but the same limitation&amp;nbsp;is not implemented in EPPlus.&lt;/p&gt;
&lt;p&gt;Maybe you could try to render your values as&amp;nbsp;a comma separated string and try to paste it into a list data validation in Excel? My guess is that the total length of your items (added to Formula.Values) exceeds Excels max limit.&lt;/p&gt;
&lt;p&gt;Regards,&lt;/p&gt;
&lt;p&gt;Mats&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="swmal" When="10/11/2012 18:31:57">
          <Html>
        
&lt;p&gt;An example:&lt;/p&gt;
&lt;pre&gt;val.Formula.Values.Add("First");
val.Formula.Values.Add("Second");
val.Formula.Values.Add("Third");&lt;/pre&gt;
&lt;p&gt;...will be stored like this in the workbook: "First, Second, Third". As far as I can see this string cannot be longer than 255 characters in Excel 2010.&lt;/p&gt;
&lt;p&gt;A workaround for you could be to lookup the values via an Excel formula instead, like this:&lt;/p&gt;
&lt;p&gt;val.Formula.ExcelFormula = "A1:A22";&lt;/p&gt;
&lt;p&gt;I think we should add a check for this and throw an exception when the max length is exceeded.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="elgransan" When="15/11/2013 22:46:12">
          <Html>
        &lt;div class="markDownOutput "&gt;Thank you swmal, that information clears everyting! ... I took me one year to answer but istill useful info! :D&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Writing to the same file multiple times">
      <Posts>
        <Post From="reliops" When="13/11/2013 21:19:06">
          <Html>
        &lt;div class="markDownOutput "&gt;I am attempting to use this to Read/Write excel documents within SSIS. SSIS in 64-bit mode does not support excel connections. What is happening is in different tasks that write to the same excel file the 2nd Save() always fails. I have been able to reproduce
 this in .NET as well. The following simulates what I have for a scenario in SSIS.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;RowIndex = 2;
using (var ep = new ExcelPackage(new FileInfo(filePath)))
{                
            for (var i= 1; i&amp;lt;= 10; i++)
            {
                var worksheet = ep.Workbook.Worksheets["Sheet1"];
                worksheet.Cells[RowIndex, 1].Value = i;
                RowIndex++;
            }
            ep.Save();
}

RowIndex = 2;
using (var ep = new ExcelPackage(new FileInfo(filePath)))
{                
            for (var ii= 1; ii&amp;lt;= 10; ii++)
            {
                var worksheet = ep.Workbook.Worksheets["Sheet2"];
                worksheet.Cells[RowIndex, 1].Value = ii;
                RowIndex++;
            }
            ep.Save();
}&lt;/code&gt;&lt;/pre&gt;
The second save returns the following error:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;{"Error saving file C:\\####.xlsm"}
Inner Exception: 
   {"Index was outside the bounds of the array."}
      at OfficeOpenXml.Utils.CompoundDocument.GetChunk(Byte[] compBuffer, Int32&amp;amp; pos)
   at OfficeOpenXml.Utils.CompoundDocument.DecompressPart(Byte[] part, Int32 startPos)
   at OfficeOpenXml.VBA.ExcelVbaProject.ReadModules()
   at OfficeOpenXml.VBA.ExcelVbaProject.GetProject()
   at OfficeOpenXml.VBA.ExcelVbaProject..ctor(ExcelWorkbook wb)
   at OfficeOpenXml.ExcelWorkbook.get_VbaProject()
   at OfficeOpenXml.ExcelWorkbook.Save()
   at OfficeOpenXml.ExcelPackage.Save()
&lt;/code&gt;&lt;/pre&gt;
I tried loading the source code to debug through it however the Cells collection was no longer present. I am not sure how that happened. Any help would be appreciated.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Printing Excel from EPPlus">
      <Posts>
        <Post From="ABRit" When="12/11/2013 12:55:38">
          <Html>
        &lt;div class="markDownOutput "&gt;Oke, I can find lots of information on EPPlus' PrinterSettings, but nothing on how to print an excel-file with eg EPPlus.
&lt;br&gt;
&lt;br&gt;
Can anyone point me in the right direction to slove it? &lt;br&gt;
&lt;br&gt;
Thanks &lt;br&gt;
&lt;br&gt;
Frank&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="12/11/2013 13:03:45">
          <Html>
        &lt;div class="markDownOutput "&gt;Because you can't. If you want to print a excel file you need to open in Microsoft Excel ( or similar ).
&lt;br&gt;
&lt;br&gt;
Regards, &lt;br&gt;
Thiago&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="ABRit" When="12/11/2013 14:48:37">
          <Html>
        &lt;div class="markDownOutput "&gt;Thiago, &lt;br&gt;
&lt;br&gt;
What is the best way to print an Open XML file created with EPPlus? As far as I know, you can't print using Open XML or EPPlus. So how do I go about it? Save it using EPPlus, and opening it with Interop to print it? Seems a bit like a hassle.
&lt;br&gt;
&lt;br&gt;
What do you recommend? &lt;br&gt;
&lt;br&gt;
Frank&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Where I found AdventureWorks database?">
      <Posts>
        <Post From="debopampal" When="11/11/2013 14:38:33">
          <Html>
        &lt;div class="markDownOutput "&gt;Where I found the &lt;strong&gt;Adventure Works&lt;/strong&gt; database which is used in the project EPPlus? Please help me. Thank You.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to get the ExcelPackage to be saved faster?">
      <Posts>
        <Post From="dcui" When="08/11/2013 04:22:44">
          <Html>
        &lt;div class="markDownOutput "&gt;I have a datasource with 30000 rows and 50 columns. &lt;br&gt;
&lt;br&gt;
It costs 9 seconds to save the file even the compression option is uncompressed. &lt;br&gt;
&lt;br&gt;
Is there a way to get it faster?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Is there a way to getthe max row number in the active sheet?">
      <Posts>
        <Post From="dcui" When="07/11/2013 09:06:09">
          <Html>
        &lt;div class="markDownOutput "&gt;In my project, I want to get the max row number rather than used row number &lt;br&gt;
&lt;br&gt;
Is there a way to getthe max row number in the active sheet?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="07/11/2013 10:26:32">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
Please use worksheet.Dimension. &lt;br&gt;
&lt;br&gt;
Regards, &lt;br&gt;
Thiago&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="dcui" When="08/11/2013 02:40:19">
          <Html>
        &lt;div class="markDownOutput "&gt;Thiago, &lt;br&gt;
&lt;br&gt;
Thanks for reply. &lt;br&gt;
&lt;br&gt;
I found that the worksheet.Dimension return the used row number instead of max row number.
&lt;br&gt;
&lt;br&gt;
when opening a new worksheet, there are some blank default rows and columns. &lt;br&gt;
&lt;br&gt;
Could I get the max row number and max column number in this case?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to find the last column of a row ?">
      <Posts>
        <Post From="Jahz" When="07/11/2013 09:20:29">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello,&lt;br&gt;
&lt;br&gt;
How I can find the last column with a value of a row ?&lt;br&gt;
&lt;br&gt;
I can't use &lt;strong&gt;worksheet.Dimension.End.Column&lt;/strong&gt; because the result is the last row of the whole worksheet.&lt;br&gt;
&lt;br&gt;
For example, I would like to have the last row with a value of the seventh column.&lt;br&gt;
&lt;br&gt;
Thank you,&lt;br&gt;
&lt;br&gt;
Jahz&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="07/11/2013 10:28:29">
          <Html>
        &lt;div class="markDownOutput "&gt;There is no automatic way to do that. Try a linq query over epplus cells. &lt;br&gt;
&lt;br&gt;
Regards, &lt;br&gt;
Thiago&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Jahz" When="07/11/2013 11:57:00">
          <Html>
        &lt;div class="markDownOutput "&gt;I tried linq query but I did not found how to do.&lt;br&gt;
&lt;br&gt;
I tried something like that :&lt;br&gt;
&lt;pre&gt;&lt;code&gt;        Dim cells = From c
                     In _ws2.Cells("A:" &amp;amp; _currentRow)
                     Where c.Value IsNot Nothing And c.Text.ToString() &amp;lt;&amp;gt; ""&lt;/code&gt;&lt;/pre&gt;
Can you help me ?&lt;br&gt;
&lt;br&gt;
Best regards,&lt;br&gt;
&lt;br&gt;
Jahz&lt;br&gt;
&lt;br&gt;
PS : Sorry for my english, I am French.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="07/11/2013 12:24:18">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
There are some examples in our repository. Please take a look at &lt;a href="https://epplus.codeplex.com/SourceControl/latest#SampleApp/Sample8.cs" rel="nofollow"&gt;
https://epplus.codeplex.com/SourceControl/latest#SampleApp/Sample8.cs&lt;/a&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Bulk import">
      <Posts>
        <Post From="Asocat" When="06/11/2013 17:16:01">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello, &lt;br&gt;
&lt;br&gt;
In my application, i'm using EPPlus to create an Excel file and fill in some data.
&lt;br&gt;
It's working fine but i perform some loops to fill the cells. &lt;br&gt;
With fiew data the time needed is ok but i'm afraid if i have to fill thousands of rows with hundreds of columns.
&lt;br&gt;
Is there a way to perform the writing of the cells in one time or may i continue to write each cells separatly ?
&lt;br&gt;
Many thanks in advance for your response. &lt;br&gt;
Asocat.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Validating Data in Template Sheet">
      <Posts>
        <Post From="tomferguson" When="06/11/2013 14:03:05">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello, &lt;br&gt;
&lt;br&gt;
I have a manually created Excel sheet that has a number of drop down lists in it, with the set of drop down values being defined on a hidden sheet. There are data validations set up on the appropriate fields so that the user gets a prompt if attempting to enter
 invalid values manually in Excel. &lt;br&gt;
&lt;br&gt;
Using EPPlus, I am populating some of these values, however nothing seem to prevent me from entering values that are not available in the drop down list.
&lt;br&gt;
&lt;br&gt;
Is there some way of running the validation on the worksheet and getting back all the fields (and error messages) that are causing validation errors?
&lt;br&gt;
&lt;br&gt;
Thanks in advance, &lt;br&gt;
&lt;br&gt;
Tom&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Help me ! Creates two sheets in a excel">
      <Posts>
        <Post From="nguyenduyphuong90" When="05/11/2013 09:13:23">
          <Html>
        &lt;div class="markDownOutput "&gt;OK&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Format cells using the Excel dropdowns">
      <Posts>
        <Post From="CellBent" When="12/11/2012 15:57:21">
          <Html>
        
&lt;p&gt;Is it possible to define a number format&amp;nbsp;using the 'Accounting' style rather than the usual currency&amp;nbsp;that I usually use, which is:&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;ws.Column(i).Style.Numberformat.Format = &lt;span style="color: rgb(163, 21, 21);"&gt;"$0.00"&lt;/span&gt;&lt;/pre&gt;
&lt;p&gt;Thanks!&lt;/p&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="CellBent" When="17/11/2012 13:34:05">
          <Html>
        
&lt;p&gt;I ended up assigning the Accounting Format and opening the file as a template with EPPLus, then reading that cell and grabbing the NumberFormat string, which is:&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;span style="color: rgb(0, 0, 0);"&gt;_("$"* #,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00_);_("$"* \(#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00\);_("$"* "-"??_);_(@_)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;I can now assign any cell/column NumberFormat with this string, and when I open the finished Excel file it shows up perfectly for my end users as 'Accounting' style.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Wartickler" When="04/11/2013 13:43:11">
          <Html>
        &lt;div class="markDownOutput "&gt;
&lt;h1&gt;My answer to this:&lt;/h1&gt;
&lt;pre&gt;&lt;code&gt;const String STR_ACCOUNTING_FORMAT = @"_(""$""* #,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00_);_(""$""* \(#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00\);_(""$""* ""-""??_);_(@_)";
cellRange.Style.Numberformat.Format = STR_ACCOUNTING_FORMAT;&lt;/code&gt;&lt;/pre&gt;
I'm not sure why but the format supplied by CellBent didn't work for me and only corrupted the file. Perhaps mine works on Excel 2013 only?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How can I copy styles from one Excel files to another">
      <Posts>
        <Post From="Nic65535" When="04/11/2013 08:59:02">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
I have to copy rows from one Excel spreadsheet to another. I can figure out how to copy the data but I cannot figure out a simple way to copy the styles from one cell to another.
&lt;br&gt;
&lt;br&gt;
Is there any simple way to copy the styles from one Excel spreadsheet to another and assign that style to cells in the new spreadsheet?
&lt;br&gt;
&lt;br&gt;
Thanks in advance &lt;br&gt;
&lt;br&gt;
Nic&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Compile error in Visual Studio 2012">
      <Posts>
        <Post From="nguyen190887" When="01/11/2013 09:54:18">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi,&lt;br&gt;
&lt;br&gt;
I open my project in Visual Studio 2012. The target framework of my project is 2.0 (I upgrade the solution from VS2005 to VS2012 to use some new features such as TFS, ...).&lt;br&gt;
&lt;br&gt;
When building the project, I got the error "The type or namespace name 'OfficeOpenXml' could not be found (are you missing a using directive or an assembly reference?)". I tried to remove and re-add the dll, then rebuild the project, but the error
 still occurs. Could you please help to resolve this?&lt;br&gt;
&lt;br&gt;
Note that, when I try the dll with a .NET 4.0 project in VS2012, it works well.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Excel custom list (epplus/c#)">
      <Posts>
        <Post From="scabanel" When="30/10/2013 14:13:22">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
I try to find a way to add an auto complete or a custom list in my excel document to help the user to fill the document.
&lt;br&gt;
I have a list of name in my database, when I create the excel report I want the use to be able to start writing in my second column and excel help him to complete with a name in my list.
&lt;br&gt;
&lt;br&gt;
This is an idea of what I want to do: &lt;br&gt;
&lt;a href="http://www.dummies.com/how-to/content/how-to-use-custom-lists-with-excel-2010s-autofill-.html" rel="nofollow"&gt;http://www.dummies.com/how-to/content/how-to-use-custom-lists-with-excel-2010s-autofill-.html&lt;/a&gt;
&lt;br&gt;
&lt;br&gt;
Thanks.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Unable to generate excels during parallel processing of jobs (thread)">
      <Posts>
        <Post From="chetarjee" When="29/10/2013 09:40:30">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
I am unable to generate excels during parallel processing of jobs (thread). My file(s) size is more than 10mb and I will be generating multiple jobs. When I do this, the processing hangs or remains idle and won't generate excels.
&lt;br&gt;
In this regard, could you please let me know how I can achieve this functionality. Is there any code change that needs to be done to handle the above functionality.
&lt;br&gt;
Currently I am using EPPlus 3.1.2.0 version. &lt;br&gt;
We are using the following EPPlus methods: &lt;br&gt;
GetExcelAsByteArray()&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="29/10/2013 11:29:51">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
Take a look at this thread &lt;a href="https://epplus.codeplex.com/discussions/285611" rel="nofollow"&gt;
link&lt;/a&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="chetarjee" When="29/10/2013 12:04:34">
          <Html>
        &lt;div class="markDownOutput "&gt;I have seen this post earlier but didn't find much of use. It talks about the below:&lt;br&gt;
&lt;ol&gt;
&lt;li&gt;Add a private static object to ExcelPackage and wrap the innards of the Save() method with a lock on the object.
&lt;br&gt;
Query:- But in future releases of EPPlus this change is not a reliable one since every time I need to update it which is a pain.&lt;br&gt;
&lt;/li&gt;&lt;/ol&gt;
In this regard, kindly request you to provide me more reliable fix. &lt;br&gt;
&lt;br&gt;
Regards, &lt;br&gt;
Chetarjee &lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="29/10/2013 12:14:30">
          <Html>
        &lt;div class="markDownOutput "&gt;Chetarjee, &lt;br&gt;
&lt;br&gt;
I'm talking about the other option. Please try our other branch with DotNetZip instead of Packing.IO, it isn't final release but there are few people using it and I didn't see any complains.
&lt;br&gt;
&lt;br&gt;
Regards, &lt;br&gt;
Thiago&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="chetarjee" When="29/10/2013 12:24:18">
          <Html>
        &lt;div class="markDownOutput "&gt;Thiagao, &lt;br&gt;
&lt;br&gt;
Is there any possibilities of including this change of DotNetZip instead of Packing.IO, in your future releases.
&lt;br&gt;
&lt;br&gt;
Regards, &lt;br&gt;
Chetarjee&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="29/10/2013 12:34:27">
          <Html>
        &lt;div class="markDownOutput "&gt;Chetarjee,&lt;br&gt;
&lt;br&gt;
Sorry, I don't have any info about EPPlus roadmap or future plans, only Jan or swmal can answer this. I´m just a user, like you, but I try to help as a forum moderator =)&lt;br&gt;
&lt;br&gt;
Regards,&lt;br&gt;
Thiago&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="chetarjee" When="29/10/2013 12:44:54">
          <Html>
        &lt;div class="markDownOutput "&gt;Thanks Thiago. &lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How can I tell is a cell value is a number or a date?">
      <Posts>
        <Post From="webpurity" When="29/10/2013 11:11:16">
          <Html>
        &lt;div class="markDownOutput "&gt;When I get the ICell.NumericCellValue is there a way I can determine if the number value is a date or if it is really a number?
&lt;br&gt;
&lt;br&gt;
NOTE: Please excuse my repeated question but it seems like no-one ever takes notice of the discussions on here so I thought if I repeatedly posted I might get a response.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="webpurity" When="29/10/2013 12:22:24">
          <Html>
        &lt;div class="markDownOutput "&gt;I have found by doing cell.ToString() will return value as it is seen in excel including the formatting.
&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Get value as seen in excel, not value in cell">
      <Posts>
        <Post From="fuyangli" When="22/10/2013 19:59:32">
          <Html>
        &lt;div class="markDownOutput "&gt;Here's a problem I found: &lt;br&gt;
I just need to get the value as seen in excel, not the real value in that cell. &lt;br&gt;
For example: &lt;br&gt;
I have a column of cells with a custom style of date. &lt;br&gt;
What I see when I open excel is: &lt;strong&gt;11/07/13&lt;/strong&gt; &lt;br&gt;
When I get this value on EPPlus, they return me something like: 44211. &lt;br&gt;
What I need is a string with "11/07/13", not the numbers/things that are in the cell itself.
&lt;br&gt;
&lt;br&gt;
In INTEROP, we can use .Value2 to get this. &lt;br&gt;
&lt;br&gt;
Thank you guys!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="webpurity" When="23/10/2013 15:18:56">
          <Html>
        &lt;div class="markDownOutput "&gt;I am having the same issue. You can use &lt;br&gt;
&lt;br&gt;
DateTime.FromOADate(cell.NumericCellValue).ToShortDateString(); &lt;br&gt;
&lt;br&gt;
but this relies on knowing the cell's real value is actually a date and not a number. I am yet to find a way of determining if the real value is actually a date or not.
&lt;br&gt;
&lt;br&gt;
If we could get the value as seen in excel then this would no longer be a problem.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="fuyangli" When="23/10/2013 16:02:28">
          <Html>
        &lt;div class="markDownOutput "&gt;Exactly! Sometimes we just wanna get the data to put in another format, or make things with only the value we see...
&lt;br&gt;
Hope someone can see this and tell if there is a way to do it, or if they can implement it!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="webpurity" When="29/10/2013 12:21:28">
          <Html>
        &lt;div class="markDownOutput "&gt;I have found by doing cell.ToString() will return value as it is seen in excel including the formatting. Hope this helps.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="C++ example">
      <Posts>
        <Post From="hschokker" When="29/10/2013 05:07:31">
          <Html>
        &lt;div class="markDownOutput "&gt;For my research I want to validate something by using a c++ program which writes and reads to excel files. Since I'll be using nearly a million rows (should be possible with Excel 2007 and up).
&lt;br&gt;
&lt;br&gt;
My (simple) program is already written in C++ and I'd like to use EPPLUS for the actual writing and reading to the excel files. My programming skills are quite low, is there some example of using EPPlus with C++? The Samples 1 and 2 given (for c# I believe)
 contain more than enough, is it hard to convert these to C++ code? &lt;br&gt;
&lt;br&gt;
I want to create excel files (many) and write/read cells in multiple worksheets. No need to create nice graphs or other things. Just reading and writing text and numbers to cells. :)&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="hschokker" When="29/10/2013 12:03:40">
          <Html>
        &lt;div class="markDownOutput "&gt;Might still be interesting for others if an example was made but I personally just switched to c#. Got everything working now. :)&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="User Prompted to Login when OPening Excel">
      <Posts>
        <Post From="SkipMunk" When="25/10/2013 21:43:56">
          <Html>
        &lt;div class="markDownOutput "&gt;I build a little ASP.Net web app for internal users to access a sales report. Everything works great!...on my local machine. When I deploy this to our corporate test server, everything apears to work there as well, except, when the user runs the "Export"
 feature, they are given a server login prompt. The user can select "cancel" and the content will display as it is supposed to. If the user chooses to save the file, rather than open it, they can do that without any prompt. I find this very odd, since
 by the time the user hits my reporting site, he or she is already validated on the server.
&lt;br&gt;
&lt;br&gt;
Has anyone else seen this type of behavior? What was your solution? &lt;br&gt;
&lt;br&gt;
Confused in Portlandia&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Excel Error when opening after save">
      <Posts>
        <Post From="ascendedcrow" When="25/10/2013 15:08:53">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi &lt;br&gt;
&lt;br&gt;
My code strips out formulas from a excel document, runs fine on normal sheets but it excel gives the message "We found a problem with some content"
&lt;br&gt;
&lt;br&gt;
It seems to be when there is pictures in the excel document, if possible I will mail you the excel document.
&lt;br&gt;
&lt;br&gt;
The problem occurs even if I take out the iterations.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;using (Stream input = File.OpenRead(fileName))
            {
                
                using (ExcelPackage excelPackageRead = new ExcelPackage(input))
                {
                    ExcelWorkbook workbook = excelPackageRead.Workbook;
                    if (workbook != null)
                    {
                        foreach (var workSheet in workbook.Worksheets)
                        {
                            foreach (var cell in workSheet.Cells)
                            {
                                if (!string.IsNullOrEmpty(workSheet.Cells[cell.FullAddress].Formula))
                                {
                                    Console.WriteLine(cell.FullAddress);
                                    Console.WriteLine(workSheet.Cells[cell.FullAddress].Formula);
                                    workSheet.Cells[cell.FullAddress].Value = cell.Value;
                                }
                            }
                        }
                    }
                    //excelPackageRead.Save();
                    FileInfo toWriteFile = new FileInfo(@"D:\test.xlsx");
                    excelPackageRead.SaveAs(toWriteFile);
                }
            }&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="New line / Line breaks in epplus">
      <Posts>
        <Post From="ujjwalbsoni" When="23/10/2013 12:00:48">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
I am not able to display text in new line using epplus, tried all options but its still not working. Please suggest ?
&lt;br&gt;
&lt;br&gt;
I am getting value from db as text1\r\ntext2 &lt;br&gt;
&lt;br&gt;
also tried text1\ntext2 &lt;br&gt;
&lt;br&gt;
Thanks, &lt;br&gt;
&lt;br&gt;
Ujjwal Soni&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="fuyangli" When="23/10/2013 18:09:08">
          <Html>
        &lt;div class="markDownOutput "&gt;What do you mean? &lt;br&gt;
You want to write a cell with two lines? &lt;br&gt;
I think that's not possible. &lt;br&gt;
But you can try System.Environment.NewLine&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="ujjwalbsoni" When="24/10/2013 06:34:52">
          <Html>
        &lt;div class="markDownOutput "&gt;Thanks for your reply, i managed to resolve this issue programatically.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="fuyangli" When="24/10/2013 16:30:25">
          <Html>
        &lt;div class="markDownOutput "&gt;If you can, post the solution you found, so people with same issue can read it :D&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="ujjwalbsoni" When="25/10/2013 08:23:20">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
I followed blog article in below URL :: &lt;br&gt;
&lt;br&gt;
&lt;a href="http://ujjwalbsoni.blogspot.com/2013/10/new-line-break-problem-with-epplus-when.html" rel="nofollow"&gt;http://ujjwalbsoni.blogspot.com/2013/10/new-line-break-problem-with-epplus-when.html&lt;/a&gt;
&lt;br&gt;
&lt;br&gt;
Thanks, &lt;br&gt;
&lt;br&gt;
Ujjwal&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Auto Filter on merged cells">
      <Posts>
        <Post From="pravin_k_patil" When="05/09/2013 08:58:09">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello All, &lt;br&gt;
&lt;br&gt;
Facing one issue of autofilter feature. When I merge cells e.g. I have A2,B2,C2 and D2 cells, out of thise B2 and C2 are merged, now problem occurs when I try to apply autofilter on A2:D2, it filter is shown on four cells, rather it should be displayed on 3
 out of 4 cells. &lt;br&gt;
&lt;br&gt;
Any ideas how to achieve this? &lt;br&gt;
&lt;br&gt;
Thanks in advance &lt;br&gt;
Pravin Patil&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="wesley_isasoft" When="24/10/2013 12:15:48">
          <Html>
        &lt;div class="markDownOutput "&gt;Did you manage to solve the issue? I have the same situation &lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Questions on adding modules, forms etc">
      <Posts>
        <Post From="rchorev" When="24/10/2013 05:05:38">
          <Html>
        &lt;div class="markDownOutput "&gt;In my application I am building workbooks on the fly and may need to add vba modules, classes or form to a workbook. I have a few questions:&lt;br&gt;
&lt;ol&gt;
&lt;li&gt;I figured out how to add classes and modules. My users supply me a .bas,.cls or .frm files. I can then call package.Workbook.VbaProject.Modules.AddModule or package.Workbook.VbaProject.Modules.AddClass and set the code (I have to parse the file to skip
 the atrribute lines etc.). I want to be able to set the module's attributes - but I can't figure out how to add attributes to the module's attribute collection.
&lt;br&gt;
&lt;/li&gt;&lt;li&gt;I still cannot figure out how to add forms to the workbook.&lt;br&gt;
&lt;/li&gt;&lt;/ol&gt;
Any help would be appreciated!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Getting last used row/column using linq max - speed issue">
      <Posts>
        <Post From="happyartifact" When="23/10/2013 22:59:14">
          <Html>
        &lt;div class="markDownOutput "&gt;I've been toying with different methods to obtain the address of the last row/column containing data, as opposed to sheet.dimension.end.row or .column which may or may not be the actual range with usable data. Here's a method I thought would be pretty
 slick, but is actually very slow, and I can't see why. Can anyone shed light on this subject?&lt;br&gt;
&lt;pre&gt;&lt;code&gt;Private Sub GetExcelLastUsedLinqMax(ByRef sheet As ExcelWorksheet)
        Dim lastrow = sheet.Dimension.End.Row
        Dim lastcol = sheet.Dimension.End.Column
        Console.WriteLine("sheet.dimension.end.row: {0} .column {1}", lastrow, lastcol)

        Dim time As New Stopwatch
        time.Start()

        Dim querylastrow = (From cell In sheet.Cells(1, 1, lastrow, lastcol) Where cell.Value IsNot Nothing Select cell.Start.Row).Max
        Dim querylastcol = (From cell In sheet.Cells(1, 1, lastrow, lastcol) Where cell.Value IsNot Nothing Select cell.Start.Column).Max

        time.Stop()
        Console.WriteLine("Linq max query - last row {0} last col {1}, elapsed time {2}", querylastrow, querylastcol, time.ElapsedMilliseconds)
    End Sub&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Poor performance in the column direction">
      <Posts>
        <Post From="Pragmateek" When="22/10/2013 23:26:21">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
first thanks for developing such a great library, it looks really promising. &lt;br&gt;
I've decided to give it a try but I have a really strange issue. &lt;br&gt;
&lt;br&gt;
I'm trying to do the more basic operation: writing a matrix of numbers (&lt;strong&gt;int[,]&lt;/strong&gt;) into an xlsx file :&lt;br&gt;
&lt;pre&gt;&lt;code&gt;using (ExcelPackage package = new ExcelPackage(new FileInfo(EEPlusFileName)))
{
    ExcelWorksheet sheet = package.Workbook.Worksheets.Add("data");

    sheet.Cells[1, 1, data.GetLength(0), data.GetLength(1)].Value = data;
}&lt;/code&gt;&lt;/pre&gt;
I've tried with a &lt;strong&gt;400x400&lt;/strong&gt; matrix and it takes more than &lt;strong&gt;
7s&lt;/strong&gt;! &lt;br&gt;
But with a &lt;strong&gt;160000x1&lt;/strong&gt; matrix it takes &lt;strong&gt;0.5s&lt;/strong&gt;! &lt;br&gt;
&lt;br&gt;
Is there any known issue with the columns? &lt;br&gt;
&lt;br&gt;
I guess your implementation internally manages things in a row-first way explaining the difference between the two approach.
&lt;br&gt;
&lt;br&gt;
Any feedback and pointer would be greatly appreciated. &lt;br&gt;
&lt;br&gt;
Thanks in advance.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="GetValue&amp;lt;String&amp;gt; null vs empty return">
      <Posts>
        <Post From="danobri" When="22/10/2013 19:05:27">
          <Html>
        &lt;div class="markDownOutput "&gt;I am running into a scenario where in some cases I get a null return and sometimes I get an empty return from calling GetValue&amp;lt;String&amp;gt; on a cell, but when I look at the spreadsheet there is no discernible difference - they both just look empty. From
 what I can tell the columns are formatted the same.&lt;br&gt;
&lt;br&gt;
Why would this be? Does Excel distinguish between null and empty string values? If so, how can you tell which is which in Excel?
&lt;br&gt;
&lt;br&gt;
Thanks, DanO&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="22/10/2013 19:21:45">
          <Html>
        &lt;div class="markDownOutput "&gt;I think a cell will return null if never been initialized and empty if already been initialized before.
&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="danobri" When="22/10/2013 19:26:26">
          <Html>
        &lt;div class="markDownOutput "&gt;Do you know if there is a way to display NULL in Excel when the cell is null? Instead of always showing an empty string?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="22/10/2013 19:35:25">
          <Html>
        &lt;div class="markDownOutput "&gt;If you opened a new excel file you want to show 1 million of cells labeled with "null" ? I think there is no way to do that.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Encryption doesn't work at all">
      <Posts>
        <Post From="Vekin03" When="22/10/2013 14:58:34">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello, &lt;br&gt;
&lt;br&gt;
This is a very good lib, but I encountered a bug: it is impossible to encrypt the package!
&lt;br&gt;
&lt;br&gt;
My code:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;FileStream stream = new FileStream("sample1.xlsx", FileMode.Create, FileAccess.ReadWrite);
ExcelPackage package = new ExcelPackage(stream);

try
{
   ExcelWorksheet worksheet = package.Workbook.Worksheets.Add("Sheet 1");

   worksheet.Cells["A1"].Value = 1234;
   worksheet.Cells["B1"].Value = 4321;

   worksheet.Cells["C1"].Formula = "A1+B1";

   worksheet.Cells.AutoFitColumns();

   package.Save("1234");
}
finally
{
   package.Dispose();
   stream.Close();
}&lt;/code&gt;&lt;/pre&gt;
The resulted file is never encrypted! &lt;br&gt;
&lt;br&gt;
I have tried with&lt;br&gt;
&lt;pre&gt;&lt;code&gt;package-&amp;gt;Encryption-&amp;gt;Password = "1234";
package-&amp;gt;Encryption-&amp;gt;IsEncrypted = true;&lt;/code&gt;&lt;/pre&gt;
but it cannot works too. &lt;br&gt;
&lt;br&gt;
The strangest part is that the files generated by the sample &lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/10"&gt;#10&lt;/a&gt; are encrypted ! &lt;br&gt;
&lt;br&gt;
What is wrong with my code? It is a bug? &lt;br&gt;
&lt;br&gt;
PS: I have Office 2007, .NET Framework 4 and Windows XP 32-bit.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Cannot determine if the cell value is a number or a date">
      <Posts>
        <Post From="webpurity" When="22/10/2013 11:01:48">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
I am trying to get the value from an ICell which is the same as what is seen in the spreadsheet.
&lt;br&gt;
&lt;br&gt;
The problem is I can see no way of telling if the cell is a date or a number???? &lt;br&gt;
&lt;br&gt;
NOTE: I was using the CellStyle.DataFormat but I cannot find any info on this and it seems to be arbitrary.
&lt;br&gt;
&lt;br&gt;
Here is the code I have so far... &lt;br&gt;
&lt;br&gt;
switch(cell.CellType) &lt;br&gt;
{ &lt;br&gt;
case CellType.BOOLEAN:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;    cellValue = cell.BooleanCellValue.ToString();
    break;
case CellType.FORMULA:
    cellValue = cell.CellFormula;
    break;
case CellType.NUMERIC:
    cellValue = cell.NumericCellValue.ToString();
    // Excel stores dates as numeric values so check format and convert
    if (IsDateFormat(cell.CellStyle.DataFormat))
    {                            
        cellValue = DateTime.FromOADate(cell.NumericCellValue)
                                            .ToShortDateString();
    }
    break;
case CellType.STRING:
case CellType.Unknown:
    cellValue = cell.StringCellValue;
    break;&lt;/code&gt;&lt;/pre&gt;
}&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="webpurity" When="22/10/2013 11:03:00">
          <Html>
        &lt;div class="markDownOutput "&gt;In case the above is not clear I am looking for how to implement my IsDateFormat(...) method.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Footer Right Aligned Text section">
      <Posts>
        <Post From="pravin_k_patil" When="05/09/2013 08:52:38">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello All, &lt;br&gt;
&lt;br&gt;
I am facing issues while adding the text to the right aligned footer, ist there any max length set for the right aligned footer text?
&lt;br&gt;
&lt;br&gt;
Thanks in advance &lt;br&gt;
&lt;br&gt;
Pravin&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="nhanson" When="10/09/2013 16:41:58">
          <Html>
        &lt;div class="markDownOutput "&gt;Excel has a hard limit on header and footer size of 255 characters. This has nothing to do with EPPlus but is a limit with Excel itself. If your footer is longer then that it will not work. The typical workaround is to make an image with the text you want
 and use the image as a footer. The entire image file counts as a single character. I hope this helps.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="sthashakun" When="22/10/2013 08:23:39">
          <Html>
        &lt;div class="markDownOutput "&gt;Did you find any solution? &lt;br&gt;
I've also having similar problem.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Create data connections programatically.">
      <Posts>
        <Post From="nakulringshia" When="26/03/2013 15:14:02">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi &lt;br&gt;
&lt;br&gt;
I am working on a project wherein an Excel needs to be generated programatically and with a data connection (a web query) embedded - This is similar to the Data --&amp;gt; From Web feature available in excel.
&lt;br&gt;
&lt;br&gt;
A friend of mine referred me to this library and I am curious if it provides support for programatically creating the data connections.
&lt;br&gt;
&lt;br&gt;
Thanks &lt;br&gt;
&lt;br&gt;
Nakul Ringshia&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="manikmi" When="06/06/2013 07:57:36">
          <Html>
        &lt;div class="markDownOutput "&gt;Yes, I too want to add/update the workbook connections like we do in Interop:
&lt;br&gt;
&lt;br&gt;
xlWorkBook.Connections["SomeConnection"].ODBCConnection.CommandText = "EXEC SP";
&lt;br&gt;
&lt;br&gt;
some help is truly appreciated&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="PandaDrunkard" When="22/10/2013 04:59:13">
          <Html>
        &lt;div class="markDownOutput "&gt;+1. &lt;br&gt;
&lt;br&gt;
Furthermore, PivotTable class need to support Connection as data source.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Fix for Long Header Text">
      <Posts>
        <Post From="sthashakun" When="21/10/2013 09:59:30">
          <Html>
        &lt;div class="markDownOutput "&gt;If header text is longer than the page margin of printed excel, the excel file gets corrupted.
&lt;br&gt;
Is there any way I could line break the header-text so that it doesn't leak into the margins allocated to the body of excel report?
&lt;br&gt;
Header text's length can vary.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="21/10/2013 11:22:02">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
If we are talking about the same thing, it is not a EPPlus issue. Take a look at this thread
&lt;a href="http://epplus.codeplex.com/discussions/455572" rel="nofollow"&gt;http://epplus.codeplex.com/discussions/455572&lt;/a&gt;
&lt;br&gt;
&lt;br&gt;
regards, &lt;br&gt;
Thiago&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="sthashakun" When="21/10/2013 12:23:56">
          <Html>
        &lt;div class="markDownOutput "&gt;Thanks :)&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="I Created InsertColomn Method">
      <Posts>
        <Post From="KeijuHirokawa" When="20/10/2013 15:36:21">
          <Html>
        &lt;div class="markDownOutput "&gt;
&lt;pre&gt;&lt;code&gt;    Hi,
    I'm Keiju Hirokawa.
    I Created InsertColomn Method that Inserts a new colomn into the spreadsheet.
    Please use this Method.
    If you take notice of something in this Method please give me advices.

&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;【ExcelWorksheet.cs】
        /// &amp;lt;summary&amp;gt;
        /// Inserts a new colomn into the spreadsheet.  Existing colomn below the position are 
        /// shifted right.  All formula are updated to take account of the new colomn.
        /// &amp;lt;/summary&amp;gt;
        /// &amp;lt;param name="colFrom"&amp;gt;&amp;lt;/param&amp;gt;
        /// &amp;lt;param name="cols"&amp;gt;&amp;lt;/param&amp;gt;
        public void InsertColomn(int colFrom, int cols)
        {
            InsertColomn(colFrom, cols, 0);
        }
        
        /// &amp;lt;summary&amp;gt;
        /// Inserts a new colomn into the spreadsheet.  Existing colomn below the position are 
        /// shifted right.  All formula are updated to take account of the new colomn.
        /// &amp;lt;/summary&amp;gt;
        /// &amp;lt;param name="colFrom"&amp;gt;&amp;lt;/param&amp;gt;
        /// &amp;lt;param name="cols"&amp;gt;&amp;lt;/param&amp;gt;
        /// &amp;lt;param name="copyStylesFromColomn"&amp;gt;&amp;lt;/param&amp;gt;
        public void InsertColomn(int colFrom, int cols, int copyStylesFromColomn)
        {
            //Insert the new colomn into the collection
            List&amp;lt;ExcelCell&amp;gt; copyStylesCells = new List&amp;lt;ExcelCell&amp;gt;();
            if (copyStylesFromColomn &amp;gt; 0)
            {
                for (int i = 0; i &amp;lt; _cells.Count; i++)
                {
                    if ((_cells[i] as ExcelCell).Column == copyStylesFromColomn)
                    {
                        copyStylesCells.Add(_cells[i] as ExcelCell);
                    }
                }
            }

            //Insert logic
            _cells.InsertColumn(colFrom, cols);
            _columns.InsertColumn(colFrom, cols);
            
            _formulaCells.InsertColumnsUpdateIndex(colFrom, cols);
            
            if (_comments != null) _comments._comments.InsertColumnsUpdateIndex(colFrom, cols);
            if (_vmlDrawings != null) _vmlDrawings._drawings.InsertColumnsUpdateIndex(colFrom, cols);
            
            foreach (ExcelCell cell in _formulaCells)
            {
                if (cell.SharedFormulaID &amp;lt; 0)
                {
                    cell.Formula = ExcelCell.UpdateFormulaReferences(cell.Formula, 0, cols, 0, colFrom);
                }
                else
                {
                    throw new Exception("Shared formula error");
                }
            }
            
            FixMergedCellsByColmnAdd(colFrom, cols, false);
            
            //Copy the styles
            foreach (ExcelCell cell in copyStylesCells)
            {
                Cells[cell.Row, colFrom, cell.Row, colFrom + cols - 1].StyleID = cell.StyleID;
            }
        }

        /// &amp;lt;summary&amp;gt;
        /// Adds a value to the row of merged cells to fix for inserts or deletes
        /// &amp;lt;/summary&amp;gt;
        /// &amp;lt;param name="position"&amp;gt;&amp;lt;/param&amp;gt;
        /// &amp;lt;param name="cols"&amp;gt;&amp;lt;/param&amp;gt;
        /// &amp;lt;param name="delete"&amp;gt;&amp;lt;/param&amp;gt;
        private void FixMergedCellsByColmnAdd(int position, int cols, bool delete)
        {
            List&amp;lt;int&amp;gt; removeIndex = new List&amp;lt;int&amp;gt;();
            for (int i = 0; i &amp;lt; _mergedCells.Count; i++)
            {
                ExcelAddressBase addr = new ExcelAddressBase(_mergedCells[i]), newAddr;
                if (delete)
                {
                    newAddr = addr.DeleteColumn(position, cols);
                    if (newAddr == null)
                    {
                        removeIndex.Add(i);
                        continue;
                    }
                }
                else
                {
                    newAddr = addr.AddColumn(position, cols);
                }

                //The address has changed.
                if (newAddr._address != addr._address)
                {
                    //Set merged prop for cells
                    for (int col = newAddr._fromCol; col &amp;lt;= newAddr._toCol; col++)
                    {
                        for (int row = newAddr._fromRow; row &amp;lt;= newAddr._toRow; row++)
                        {
                            Cell(row,col).Merge = true;
                        }
                    }
                }
                _mergedCells.List[i] = newAddr._address;
            }

            for (int i = removeIndex.Count - 1; i &amp;gt;= 0; i--)
            {
                _mergedCells.List.RemoveAt(removeIndex[i]);
            }
        }&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;【RangeCollection.cs】
        /// Insert a number of column in the collecion
        /// &amp;lt;/summary&amp;gt;
        /// &amp;lt;param name="rowID"&amp;gt;&amp;lt;/param&amp;gt;
        /// &amp;lt;param name="rows"&amp;gt;&amp;lt;/param&amp;gt;
        /// &amp;lt;returns&amp;gt;Index of first rangeItem&amp;lt;/returns&amp;gt;
        internal void InsertColumn(int ColumnIndex, int columns)
        {
            ulong colAdd = (((ulong)columns) &amp;lt;&amp;lt; 15);

            bool isCell;
            for (int i = 0; i &amp;lt; _cells.Count; i++)
            {
                isCell = false;

                //check whether cell
                var cell = _cells[_cellIndex[i].ListPointer] as ExcelCell;
                if (cell != null)
                {
                    isCell = true;
                }
                if (isCell &amp;amp;&amp;amp;
                    cell.Column &amp;lt; ColumnIndex)
                {
                    continue;
                }

                //check whether colomn
                var col = _cells[_cellIndex[i].ListPointer] as ExcelColumn;
                int preColumnMax = 0;

                if (!isCell)
                {
                    if (col != null
                       &amp;amp;&amp;amp; col.ColumnMin &amp;lt; ColumnIndex)
                    {
                        continue;
                    }
                    else
                    {
                        preColumnMax = col.ColumnMax;
                    }
                }

                _cellIndex[i].RangeID += colAdd;
                _cells[_cellIndex[i].ListPointer].RangeID += colAdd;

                if (!isCell)
                {
                    (_cells[_cellIndex[i].ListPointer] as ExcelColumn)._columnMax = preColumnMax + columns;
                }
            }
        }

        /// &amp;lt;summary&amp;gt;
        /// Insert a number of columns in the collecion but dont update the cell only the index
        /// &amp;lt;/summary&amp;gt;
        /// &amp;lt;param name="rowID"&amp;gt;&amp;lt;/param&amp;gt;
        /// &amp;lt;param name="rows"&amp;gt;&amp;lt;/param&amp;gt;
        /// &amp;lt;returns&amp;gt;Index of first rangeItem&amp;lt;/returns&amp;gt;
        internal void InsertColumnsUpdateIndex(int ColumnIndex, int columns)
        {
            ulong colAdd = (((ulong)columns) &amp;lt;&amp;lt; 15);

            for (int i = 0; i &amp;lt; _cells.Count; i++)
            {
                if ((_cells[i] as ExcelCell).Column &amp;lt; ColumnIndex) continue;

                _cellIndex[i].RangeID += colAdd;
            }
        }
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Inserting a DateTime value in a cell">
      <Posts>
        <Post From="ojm37a" When="18/10/2013 20:13:08">
          <Html>
        &lt;div class="markDownOutput "&gt;I need to insert values into cells that are date AND time. (For example "9/23/2013 10:15:22 AM") and have Excel recognize it as a datetime so that sorting works (for example "10/1/2013 09:12:07 AM" should sort AFTER "9/30/2013
 11:55:12 PM" -- of course 1 sorts before 4 in a text cell, so I need the cell to be recognized as a date and time).
&lt;br&gt;
&lt;br&gt;
Any ideas? &lt;br&gt;
&lt;br&gt;
Thanks, &lt;br&gt;
Owen&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="When using templates, file is locked during reading">
      <Posts>
        <Post From="gethelp" When="18/10/2013 15:12:32">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello, thank you for the great work. &lt;br&gt;
&lt;br&gt;
When using a template file I recognized it is opened read write. After looking at source I noticed it's using System.IO.File.ReadAllBytes to read the content. ReadAllBytes opens it for readwrite. I refer to this article:
&lt;br&gt;
&lt;br&gt;
&lt;a href="http://blog.somecreativity.com/2008/04/04/ioexception-when-trying-to-read-a-file-using-filereadallbytes-function/" rel="nofollow"&gt;http://blog.somecreativity.com/2008/04/04/ioexception-when-trying-to-read-a-file-using-filereadallbytes-function/&lt;/a&gt;
&lt;br&gt;
&lt;br&gt;
So is there a reason for locking the file while reading? I use the template for reporting and it's just a matter of time this will occur on users side. I've tested the suggestion in the article and it works fine, but I'm sure I don't have enough knowledge of
 EPPlus to say if it's safe to use or not. &lt;br&gt;
&lt;br&gt;
Thank you&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Pivot Tables - Refresh on Load">
      <Posts>
        <Post From="TonyShark" When="18/10/2013 10:20:52">
          <Html>
        &lt;div class="markDownOutput "&gt;I'm creating spreadsheets based on existing templates (see the code sample below) and want to ensure that any Pivot Tables in the output have their "Refresh data when opening the file" property (from the Data tab in the Pivot Table's options
 dialog) set to true.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;public static void foo(string templatePath, System.IO.Stream outputStream)
{
    using (var templateStream = System.IO.File.OpenRead(templatePath))
    {
        using (var xlsx = new ExcelPackage(outputStream, templateStream))
        {
            foreach (var ws in xlsx.Workbook.Worksheets)
            {
                foreach (var pt in ws.PivotTables)
                {
                    // TODO... Ensure that "Refresh data when opening the file" is set to true
                }
            }
        }
    }
}&lt;/code&gt;&lt;/pre&gt;
I've had a trawl through the object model and spent a while Googling as well, but to no avail. Does anyone know it it's possible to set the value of this property in EPPlus, and if so how?&lt;br&gt;
&lt;br&gt;
TIA,&lt;br&gt;
&lt;br&gt;
Tony&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Row out of range when exporting large amounts of data">
      <Posts>
        <Post From="DarthGordon" When="17/10/2013 14:35:55">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello, &lt;br&gt;
&lt;br&gt;
First fo all I would like to thank You for this greate library - it's easy to use and efficient.
&lt;br&gt;
In my work I encountered a following problem: &lt;br&gt;
&lt;br&gt;
I have a collection of data, and I was using LoadFromColletcion method to dump that data into the WorkSheet. It was working fine for relatively small amounts of data. Whe the number of elements in the collection reaches 10 mln and above I receive "Row
 out of range" ArgumentException from that method. It throwed that exception both when I passed the whole collection to that method and when I used paging. The stack trace is as follows:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;   at OfficeOpenXml.ExcelRange.ValidateRowCol(Int32 Row, Int32 Col)
   at OfficeOpenXml.ExcelRange.get_Item(Int32 Row, Int32 Col)
   at OfficeOpenXml.ExcelRangeBase.LoadFromCollection[T](IEnumerable`1 Collection, Boolean PrintHeaders, TableStyles TableStyle, BindingFlags memberFlags, MemberInfo[] Members)&lt;/code&gt;&lt;/pre&gt;
The method invocation looks as follows: &lt;br&gt;
with paging:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;sheet.Cells[skipIndex + 2, 1].LoadFromCollection&amp;lt;T&amp;gt;(dataChunk, false,
                    OfficeOpenXml.Table.TableStyles.Medium1,
                    System.Reflection.BindingFlags.Public,
                    propertiesInfo.ToArray());&lt;/code&gt;&lt;/pre&gt;
without paging:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;sheet.Cells[2, 1].LoadFromCollection&amp;lt;T&amp;gt;(dataList, false,
                    OfficeOpenXml.Table.TableStyles.Medium1,
                    System.Reflection.BindingFlags.Public,
                    propertiesInfo.ToArray());&lt;/code&gt;&lt;/pre&gt;
I spent quite some time on searching for the reason of this issue with no success so any help will be much appreciated.
&lt;br&gt;
I searched that forum for any thread to post my question, but I couldn't find any that addressed my issue.
&lt;br&gt;
&lt;br&gt;
Thank You in advance for all answers. &lt;br&gt;
&lt;br&gt;
Best regards, &lt;br&gt;
Michal&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Copy Multiple WorkSheets to a single Workbook">
      <Posts>
        <Post From="spalan" When="27/12/2010 14:32:32">
          <Html>
        
&lt;p&gt;Hi All,&lt;/p&gt;
&lt;p&gt;I have multiple xlsx files with a single worksheet in each of them. This worksheet contains and chart and and its data. Now i want to create a new workbook and copy the sheet from each of this xlsx files into the new workbook. I want this to work something
 similar to the manualy Copy&lt;/p&gt;
&lt;p&gt;Please let me know how I can achieve this.&lt;/p&gt;
&lt;p&gt;I also wanted to know how i can delete a worksheet from an existing workbook.&lt;/p&gt;
&lt;p&gt;Thank you in advance.&lt;/p&gt;
&lt;p&gt;Regards,&lt;/p&gt;
&lt;p&gt;SP :)&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="27/12/2010 15:23:49">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;To add a copy use the Add method of the Worksheets collection like...&lt;/p&gt;
&lt;p&gt;package.Workbook.Worksheets.Add("NewSheet", copyWorksheet);&lt;/p&gt;
&lt;p&gt;where copyWorksheet is the worksheet you want to copy.&lt;/p&gt;
&lt;p&gt;To delete use the Delete ﻿method of the worksheets collection.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="spalan" When="27/12/2010 17:18:57">
          <Html>
        
&lt;p&gt;Hi jankallman,&lt;/p&gt;
&lt;p&gt;Thank you for your reply. My code looks like this:&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;﻿&lt;div style="color: black; background-color: white;"&gt;&lt;pre&gt;ExcelPackage pckTemplate = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage();

&lt;span style="color: blue;"&gt;using&lt;/span&gt; (ExcelPackage p = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(newFile, templateFile))
{

    &lt;span style="color: green;"&gt;//Set up the headers&lt;/span&gt;
    ExcelWorksheet ws = p.Workbook.Worksheets[1];
  

    ExcelChart chart = ((ExcelChart)ws.Drawings[&lt;span style="color: rgb(163, 21, 21);"&gt;"Chart 1"&lt;/span&gt;]);

    &lt;span style="color: blue;"&gt;for&lt;/span&gt; (&lt;span style="color: blue;"&gt;int&lt;/span&gt; intColCtr = 1; intColCtr &amp;lt; dtChartdata.Columns.Count; intColCtr++)
    {
	strColumn = fnGetCellAddress(intColNo);

	chart.Series[intColCtr - 1].Header = dtChartdata.Columns[intColCtr].ColumnName.ToString();
	chart.Series[intColCtr - 1].XSeries = &lt;span style="color: rgb(163, 21, 21);"&gt;"'"&lt;/span&gt; + ws.Name + &lt;span style="color: rgb(163, 21, 21);"&gt;"'!"&lt;/span&gt; + ExcelRange.GetAddress(intCurrentRow, 3, intCurrentRow + dtChartdata.Rows.Count, 3);
	chart.Series[intColCtr - 1].Series = &lt;span style="color: rgb(163, 21, 21);"&gt;"'"&lt;/span&gt; + ws.Name + &lt;span style="color: rgb(163, 21, 21);"&gt;"'!"&lt;/span&gt; + ExcelRange.GetAddress(intCurrentRow, intColNo, intCurrentRow + dtChartdata.Rows.Count, intColNo);

	intColNo++;
    }


    p.SaveAs(newFile);
    
    &lt;span style="color: blue;"&gt;var&lt;/span&gt; wsTemplate = pckTemplate.Workbook.Worksheets.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"NewSheet"&lt;/span&gt;,ws);


}
&lt;/pre&gt;
&lt;/div&gt;
&lt;/pre&gt;
&lt;pre&gt;In the line "&lt;span style="color: blue;"&gt;var&lt;/span&gt; wsTemplate = pckTemplate.Workbook.Worksheets.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"NewSheet"&lt;/span&gt;,ws);" i get error "Index was out of range. Must be non-negative and less than the size of the collection." &lt;/pre&gt;
&lt;pre&gt;Am i doing anything wrong here?&lt;/pre&gt;
&lt;pre&gt;Thanks in advance for your help :)&lt;/pre&gt;
&lt;pre&gt;&lt;br&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="28/12/2010 07:52:54">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;First of all make sure you use version 2.8. This did not work between packages in previous versions.&lt;/p&gt;
&lt;p&gt;Also, skip or move the SaveAs. Saving the package will close it, so if you want to save it, do that after the Add.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="spalan" When="28/12/2010 19:53:08">
          <Html>
        
&lt;p&gt;Hi Jan,&lt;/p&gt;
&lt;p&gt;Thanks for your reply.&lt;/p&gt;
&lt;p&gt;Tried your suggestions but still ran into trouble, still get an exception.&amp;nbsp;I am using version 2.8, maybe the method i am using is not correct. Is there any sample code available in the package that i could have a look at?&lt;/p&gt;
&lt;p&gt;I have now tried a workaround where i have all the sheets i need in a single workbook template and i just use that to insert my data and resets the chart series. This works fine for the problem i have on hand. I will meanwhile try a prototype code and see
 if your solution works.&lt;/p&gt;
&lt;p&gt;Thanks,&lt;/p&gt;
&lt;p&gt;San&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="28/12/2010 20:10:44">
          <Html>
        
&lt;p&gt;Create an issue and upload your template and an example, so I can have a look at it.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="vermashruti2812" When="16/10/2013 06:08:59">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi San, &lt;br&gt;
&lt;br&gt;
Did you find any solution to this isse you raised? Do u have the code to combile multiple excel sheet into one?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Load and save without change gives error message when opening in Excel.">
      <Posts>
        <Post From="TormodS" When="10/10/2013 14:06:32">
          <Html>
        &lt;div class="markDownOutput "&gt;I load and save an xlsx file.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;    var e1 = new FileInfo(@"C:\temp\mynewfile.xlsx");       
var pck1 = new ExcelPackage(e1);
var e3 = new FileInfo(@"c:\temp\tmpout.xlsx");
pck1.SaveAs(e3);
Process.Start(@"c:\temp\tmpout.xlsx");
&lt;/code&gt;&lt;/pre&gt;
The output file opens in Excel with an error message "Excel found unreadable content in 'tmpout.xlsx'. Do you want to recover the contents of this workbook?"
&lt;br&gt;
&lt;br&gt;
Clicking "yes" opens up Excel with "tmpout.xlsx [repaired]". Excel informs me that it was able to open it by removing content. Opening the logfile reveals this :
&lt;br&gt;
&lt;br&gt;
&amp;lt;?xml version="1.0" encoding="UTF-8" standalone="true"?&amp;gt;
&lt;br&gt;
-&amp;lt;recoveryLog xmlns="&lt;a href='http://schemas.openxmlformats.org/spreadsheetml/2006/main"&gt;&lt;logFileName&gt;error075840_01.xml&lt;/logFileName&gt;&lt;summary&gt;Errors' rel="nofollow"&gt;http://schemas.openxmlformats.org/spreadsheetml/2006/main"&amp;gt;&amp;lt;logFileName&amp;gt;error075840_01.xml&amp;lt;/logFileName&amp;gt;&amp;lt;summary&amp;gt;Errors&lt;/a&gt;
 were detected in file 'C:\temp\tmpout.xlsx'&amp;lt;/summary&amp;gt;-&amp;lt;removedRecords summary="Following is a list of removed records:"&amp;gt;&amp;lt;removedRecord&amp;gt;Removed Records: Named range from /xl/workbook.xml part (Workbook)&amp;lt;/removedRecord&amp;gt;&amp;lt;/removedRecords&amp;gt;&amp;lt;/recoveryLog&amp;gt;
&lt;br&gt;
&lt;br&gt;
Searching the internet, I found that this could be due to Pivot tables. Inspecting using Excel, I did find some in the document (in other tabs), and deleted the Worksheets where there were pivot tables.
&lt;br&gt;
No change. Repeating the process leaves the same result. &lt;br&gt;
&lt;br&gt;
My users are using a third party xlsx viewer which crashes when opening these documents.
&lt;br&gt;
&lt;br&gt;
Does anybody know what is going on? Did I miss any pivot tables? Should I do more than deleting the respective sheets? Is there any workaround? Can I remove the corrupt elements through the epplus API before saving?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="InsertRow works strange">
      <Posts>
        <Post From="RustamSingatov" When="09/10/2013 06:32:36">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello. First I would like to say that EPPlus very good library. But I have a one trouble with it. When I call worksheet.InsertRow(), for example to insert row before some table, I have not see the new row and I have not see that the table moved down. Is
 it correct behavior? Or bug? Or I don't know something?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to add code to worksheet not module">
      <Posts>
        <Post From="pathatcher" When="09/10/2013 01:38:36">
          <Html>
        &lt;div class="markDownOutput "&gt;Howdy. Fairly new to C# so forgive the ignorance.&lt;br&gt;
In all the examples I've seen and used the VBA code has always been a new module, but how do I add code the sheet itself to call the macro created? Here's partial code up to the point where I need to add it. Any help would be greatly appreciated.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;   ExcelPackage pck = new ExcelPackage();
        //Create the worksheet
        ExcelWorksheet ws = pck.Workbook.Worksheets.Add("Whse");
        //Load the datatable into the sheet, starting from cell A1. Print the column names on row 1
        ws.Cells["A2"].LoadFromDataTable(dt, true);
        ws.Column(2).Style.Numberformat.Format = "0";
        ws.Column(2).AutoFit();
        //Set title of spreadsheet
        ws.Cells["A1"].Value = "Requested RTV (" + ID.ToString() + ") Style Listing " + Request.QueryString["Name"];                            
        ws.SetValue("N2", "Dlb Click to Save to DB");           
        //Now add double click code...
        var sb = new StringBuilder();
        sb.AppendLine("Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)");
        sb.AppendLine("If Target.Address = \"$N$2\" THEN");
        sb.AppendLine("Call UpdateFinalUnits");
        sb.AppendLine("End If");
        sb.AppendLine("End Sub");&lt;/code&gt;&lt;/pre&gt;
Add code to the worksheet&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Print ExcelPackage">
      <Posts>
        <Post From="rasyidmujahid" When="08/10/2013 01:39:37">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
Can anyone give example how to send ExcelWorksheet to printer? &lt;br&gt;
&lt;br&gt;
Thanks&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Saving XLSM files">
      <Posts>
        <Post From="jebar8" When="07/10/2013 21:48:10">
          <Html>
        &lt;div class="markDownOutput "&gt;I'm writing a program that edits data in an XLSM file. I can open the file and read from it just fine, but when I try to save it the file size is almost 100K smaller in size. When I try to open it Excel gives me this message: "The workbook cannot
 be opened or repaired by Microsoft Excel because it is corrupt." &lt;br&gt;
&lt;br&gt;
I've studied the examples but didn't notice anything different from what I'm doing. Even the simple code below produces the same corrupted file. Am I doing something wrong? I've seen other questions where people were working with XLSM files just fine.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;var package = new ExcelPackage(new FileInfo(@"C:\testing.xlsm"));
package.Save();&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="MVC 2.0 Client Side Export to Excel">
      <Posts>
        <Post From="andycshi" When="07/10/2013 14:55:52">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
I'm new to MVC and I'm planning to do Export to Excel which I generated table using JQuery.
&lt;br&gt;
I've a Table with Filter on the UI. My Table will change dynamically based on filter. I want to export the JQuery table to Excel on Client Side.
&lt;br&gt;
&lt;br&gt;
Is it possible to do this using EPPlus ?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="07/10/2013 16:53:51">
          <Html>
        &lt;div class="markDownOutput "&gt;No, only server side.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Conditional Formatting Question -- Bug?">
      <Posts>
        <Post From="KJS703" When="06/10/2013 01:10:54">
          <Html>
        &lt;div class="markDownOutput "&gt;I used EPPlus to open an existing xlsm file -- without changing anything -- I did a saveas....
&lt;br&gt;
I expected to have a complete copy of the existing xlsm file with a new name. &lt;br&gt;
Most of the data was copied without an issue; however some of the fields which had conditional formatting on them have been changed. Wondering why this occurred since nothing was changed?
&lt;br&gt;
I did check the actual sheet xml of both versions and discovered this difference between the two versions (only showing two fields difference -- but change happen on eight fields)
&lt;br&gt;
What shows in the existing xlsm for fields F18 and F19 &lt;br&gt;
&amp;lt;c r="F18" s="328"&amp;gt; &lt;br&gt;
&amp;lt;f t="shared" si="4" /&amp;gt; &lt;br&gt;
&amp;lt;v&amp;gt;20430&amp;lt;/v&amp;gt; &lt;br&gt;
&amp;lt;/c&amp;gt; &lt;br&gt;
&amp;lt;c r="F19" s="328"&amp;gt; &lt;br&gt;
&amp;lt;f t="shared" si="4" /&amp;gt; &lt;br&gt;
&amp;lt;v&amp;gt;21485&amp;lt;/v&amp;gt; &lt;br&gt;
&amp;lt;/c&amp;gt; &lt;br&gt;
What shows in the SaveAs version of xlsm for fields F18 and F19 &lt;br&gt;
&amp;lt;c r="F18" s="350"&amp;gt; &lt;br&gt;
&amp;lt;f t="shared" si="4" /&amp;gt; &lt;br&gt;
&amp;lt;/c&amp;gt; &lt;br&gt;
&amp;lt;c r="F19" s="350"&amp;gt; &lt;br&gt;
&amp;lt;f t="shared" si="4" /&amp;gt; &lt;br&gt;
&amp;lt;/c&amp;gt; &lt;br&gt;
Can anyone share why this occurred? When only opened file and then SaveAs file?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Loading DataTables with Formulas, empty cells and values">
      <Posts>
        <Post From="rchorev" When="02/10/2013 19:57:24">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi. I am loading large Data Tables (19269 rows and 6 columns,1624 rows and 146 columns) using LoadFromDataTable. The performance is great. My problem is that my data has values, empty cells and formulas.
&lt;br&gt;
&lt;br&gt;
The workbook I generate is formatted by a 3rd party software when I open it in Excel. I found that I need to do the following to fix the worksheet:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;for (int col = 1; col &amp;lt;= ColNum; col++) 
                {
                    for (int row = 1; row &amp;lt;= RowNum; row++)
                    {
                        using (ExcelRange exrange = worksheet.Cells[row, col])
                        {
                            if (string.IsNullOrEmpty(exrange.Text) || string.IsNullOrWhiteSpace(exrange.Text))
                                exrange.Clear();
                            else if (exrange.Text.StartsWith("="))
                                exrange.Formula = exrange.Text;
                        }
                    }
                }&lt;/code&gt;&lt;/pre&gt;
This is very slow (8 min for the 1624 rows and 146 columns table). Any suggestions on how to improve this?&lt;br&gt;
&lt;br&gt;
Thank you!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="02/10/2013 20:17:14">
          <Html>
        &lt;div class="markDownOutput "&gt;From Faq... &lt;br&gt;
&lt;br&gt;
&lt;strong&gt;I have a lot of data I want to load. What should I think of to get the best performance?&lt;/strong&gt;
&lt;br&gt;
If you have more than, let's say 5 000 cells in the sheet and experience performance problems, have this in mind...
&lt;br&gt;
Always load cells from top to bottom left to right. That means that if you add a formula on the data you load, it's faster to add it for every row than to add it for a range after you have loaded the data (for ex. this will take a while,Worksheet.Cells"C1:C100000".Formula="A1+B1").
&lt;br&gt;
If you want to use a shared formula, like the sample, make sure you create the cells in sequence (use something like worksheet.Cellsrow,forumlaColumn.Value=null to create the cell. Then you can add the formula after you have finished loading your data.
&lt;br&gt;
Avoid using the InsertRow and DeleteRow methods. &lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Take a look at this thread too... &lt;a href="https://epplus.codeplex.com/discussions/393289" rel="nofollow"&gt;
https://epplus.codeplex.com/discussions/393289&lt;/a&gt; &lt;br&gt;
&lt;br&gt;
Maybe you can make somes change in loadfromdatable.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Footer Font Style">
      <Posts>
        <Post From="allentyw" When="01/10/2013 06:53:28">
          <Html>
        &lt;div class="markDownOutput "&gt;Is there any way to set the footer font style?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Saving Updated copy of XLSX">
      <Posts>
        <Post From="TwoLions" When="28/09/2013 16:53:53">
          <Html>
        &lt;div class="markDownOutput "&gt;This works when creating a new XLSX:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;      Dim XLSX_Out As New FileInfo("C:\XLSX_Out.xlsx")
      Using package As New ExcelPackage
           Dim worksheet As ExcelWorksheet = package.Workbook.Worksheets.Add("Test")
           worksheet.Cells("A1").Value = "AAAAAA"
           package.SaveAs(XLSX_Out)
      End Using

&lt;/code&gt;&lt;/pre&gt;
This Does not work when opening an XLSX, make a change and save it to a new file name:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;      Dim XLSX_In As New FileInfo("C:\XLSX_In.xlsx")
      Dim XLSX_Out As New FileInfo("C:\XLSX_Out.xlsx")
      Using package As New ExcelPackage(XLSX_In)
            Dim worksheet As ExcelWorksheet = package.Workbook.Worksheets("Test")
            worksheet.Cells("A1").Value = "AAAAAA"
            package.SaveAs(XLSX_Out) 
      End Using
&lt;/code&gt;&lt;/pre&gt;
Last snippet Throws Error "Object reference not set to an instance of an object." on the SaveAs command. Can't figure out why. I converted this code from C# so I may have something wrong with my conversion.&lt;br&gt;
&lt;br&gt;
I have also tried &lt;br&gt;
&lt;pre&gt;&lt;code&gt;       Using package As New ExcelPackage(XLSX_Out, XLSX_In)
       package.Save()
&lt;/code&gt;&lt;/pre&gt;
Same error.&lt;br&gt;
&lt;br&gt;
Have also used Excel Template (XLTX) as input with same result.&lt;br&gt;
&lt;br&gt;
Thanks!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Saving Updated copy of XLSX">
      <Posts>
        <Post From="TwoLions" When="28/09/2013 16:53:52">
          <Html>
        &lt;div class="markDownOutput "&gt;This works when creating a new XLSX: &lt;br&gt;
&lt;br&gt;
Dim XLSX_Out As New FileInfo("C:\XLSX_Out.xlsx") &lt;br&gt;
Using package As New ExcelPackage&lt;br&gt;
&lt;pre&gt;&lt;code&gt; Dim worksheet As ExcelWorksheet = package.Workbook.Worksheets.Add("Test")
 worksheet.Cells("A1").Value = "AAAAAA"
 package.SaveAs(XLSX_Out)&lt;/code&gt;&lt;/pre&gt;
End Using &lt;br&gt;
&lt;br&gt;
&lt;br&gt;
This Does not work when opening an XLSX, make a change and save it to a new file name:
&lt;br&gt;
&lt;br&gt;
Dim XLSX_In As New FileInfo("C:\XLSX_In.xlsx") &lt;br&gt;
Dim XLSX_Out As New FileInfo("C:\XLSX_Out.xlsx") &lt;br&gt;
Using package As New ExcelPackage(XLSX_In)&lt;br&gt;
&lt;pre&gt;&lt;code&gt;  Dim worksheet As ExcelWorksheet = package.Workbook.Worksheets("Test")
  worksheet.Cells("A1").Value = "AAAAAA"
  package.SaveAs(XLSX_Out) &lt;/code&gt;&lt;/pre&gt;
End Using &lt;br&gt;
&lt;br&gt;
Last snippet Throws Error "Object reference not set to an instance of an object." on the SaveAs command. Can't figure out why. I converted this code from C# so I may have something wrong with my conversion.
&lt;br&gt;
&lt;br&gt;
I have also tried &lt;br&gt;
Using package As New ExcelPackage(XLSX_Out, XLSX_In) &lt;br&gt;
package.Save() &lt;br&gt;
&lt;br&gt;
Same error. &lt;br&gt;
&lt;br&gt;
Thanks!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="What's next?">
      <Posts>
        <Post From="alt24" When="28/09/2013 00:45:56">
          <Html>
        &lt;div class="markDownOutput "&gt;Are you working on this excellent library? what is comming? netx releases? &lt;br&gt;
&lt;br&gt;
I use it in my work and personal projects, thank you a lot!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Created of Powershell Module to handle your .Net DLL">
      <Posts>
        <Post From="Avalon77" When="01/08/2013 10:19:08">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi,&lt;br&gt;
&lt;br&gt;
Just wanted to share my ExcelPSLib Powershell Module. It is still in a 0.1 alpha version but it already allows you to make basic operations. Just have a look at my CodePlex project page :&lt;br&gt;
&lt;a href="https://excelpslib.codeplex.com" rel="nofollow"&gt;https://excelpslib.codeplex.com/&lt;/a&gt;&lt;br&gt;
&lt;br&gt;
Thanks to the author of the EEPLUS .NET Library !&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Avalon77" When="07/08/2013 12:16:43">
          <Html>
        &lt;div class="markDownOutput "&gt;New version released : &lt;a href="https://excelpslib.codeplex.com" rel="nofollow"&gt;
ExcelPSLib 0.2&lt;/a&gt;&lt;br&gt;
&lt;br&gt;
&lt;strong&gt;New&lt;/strong&gt;&lt;br&gt;
&lt;ul&gt;
&lt;li&gt;Added Default Row, Col Size and AutoFilter Range at Sheet Creation &lt;/li&gt;&lt;li&gt;Added a new Cmdlet SetTextOptions allowing to set Text formating options for a cell range
&lt;/li&gt;&lt;li&gt;Added a new Cmdlet SetPrinterSettings allowing to set some printer settings &lt;/li&gt;&lt;li&gt;Modified some code so that not specifying a switch will negate it by default&lt;br&gt;
&lt;/li&gt;&lt;/ul&gt;
PS: I fixed the link on my first post that was pointing to "example.com" Sorry for that&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Avalon77" When="13/08/2013 10:54:23">
          <Html>
        &lt;div class="markDownOutput "&gt;New version released : &lt;a href="https://excelpslib.codeplex.com/" rel="nofollow"&gt;
ExcelPSLib 0.3&lt;/a&gt; &lt;br&gt;
&lt;br&gt;
&lt;strong&gt;New&lt;/strong&gt;&lt;br&gt;
&lt;ul&gt;
&lt;li&gt;Renamed all cmdlets to respect standards &lt;/li&gt;&lt;li&gt;Added the "Get-OOXMLDeprecatedCommand" to allow you to use the old cmdlets
&lt;/li&gt;&lt;li&gt;Added the "Convert-OOXMLOldScripts" to convert you script with 0.2 style cmdlets to the 0.3 style
&lt;br&gt;
** This cmdlet is very basic and should work in many case but it is more a "brute force" conversion than something "smart" so use it if you dare !
&lt;/li&gt;&lt;li&gt;Adde the "Get-OOXMLHelp" to print the syntax of all cmdlets at once (Ex: output it to a file)
&lt;/li&gt;&lt;li&gt;Reformated all comments and infos &lt;/li&gt;&lt;li&gt;Compatible PowerShell 2.0 &lt;br&gt;
** There was an issue with PS 2.0 : &lt;br&gt;
** Multi-dimentional .Net tables like cells[1,1] or cells[1,1,1,5] were not understood ! So If you use powershell 2.0 try to use literal addressing like "A1" or "A1:E1"
&lt;/li&gt;&lt;li&gt;Added the "Convert-OOXMLCellsCoordinates" cmdlet to convert coordinate like [1,1] to "A1" or like [1,1,1,5] to "A1:E1"
&lt;/li&gt;&lt;li&gt;Added the "Get-ColumnString" cmdlet that is normaly used by "Convert-OOXMLCellsCoordinates" but you can use it to
&lt;br&gt;
** Convert coordinate like [1,1] to "A1". I recommend the usage of "Convert-OOXMLCellsCoordinates" instead of "Get-ColumnString" for single cell coordinate convertion.
&lt;/li&gt;&lt;/ul&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Avalon77" When="13/08/2013 15:25:21">
          <Html>
        &lt;div class="markDownOutput "&gt;Hotfixed version released : &lt;a href="https://excelpslib.codeplex.com/" rel="nofollow"&gt;
ExcelPSLib 0.3a&lt;/a&gt; &lt;br&gt;
&lt;br&gt;
&lt;strong&gt;Fixed/Removed&lt;/strong&gt;&lt;br&gt;
&lt;ul&gt;
&lt;li&gt;Fixed the Set-OOXMLRangeBorder cmdlet that was still using the old cmdlet &lt;/li&gt;&lt;li&gt;Removed the usage example present in this module comment section &lt;/li&gt;&lt;/ul&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Avalon77" When="25/09/2013 13:16:00">
          <Html>
        &lt;div class="markDownOutput "&gt;New version released : &lt;a href="https://excelpslib.codeplex.com/releases/view/112553" rel="nofollow"&gt;
Excel Powershell Library 0.4&lt;/a&gt;&lt;br&gt;
&lt;br&gt;
&lt;strong&gt;New&lt;/strong&gt;&lt;br&gt;
&lt;ul&gt;
&lt;li&gt;Added ValueFromPipeline to allmost all functions (If relevant) &lt;/li&gt;&lt;li&gt;Fixed some Class Type casting (OfficeOpenXml.ExcelRange =&amp;gt; OfficeOpenXml.ExcelRangeBase)
&lt;/li&gt;&lt;li&gt;Added Return to allmost all functions (If relevant) so you can now chain CmdLet
&lt;/li&gt;&lt;li&gt;Modified the Save-OOXMLPackage "CmdLet" so it now uses the "Dispose" method if the "Dispose" switch is used
&lt;/li&gt;&lt;li&gt;The "BorderStyle" is no more a "string" but uses the Enum "OfficeOpenXml.Style.ExcelBorderStyle"
&lt;/li&gt;&lt;li&gt;The "FillStyle" is no more a "string" but it uses the Enum "OfficeOpenXml.Style.ExcelFillStyle"
&lt;/li&gt;&lt;li&gt;The "HorizontalAlignment" is no more a "string" but it uses the Enum "OfficeOpenXml.Style.ExcelHorizontalAlignment"
&lt;/li&gt;&lt;li&gt;The "VerticalAlignment" is no more a "string" but it uses the Enum "OfficeOpenXml.Style.ExcelVerticalAlignment"
&lt;/li&gt;&lt;/ul&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Multi Select list box">
      <Posts>
        <Post From="tiruvishal" When="24/09/2013 11:42:58">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi All, &lt;br&gt;
&lt;br&gt;
I have a requirement to insert a multiselect listbox programmatically. Hence I was wondering whether EPPlus allows me to achieve this out-of-the-box?
&lt;br&gt;
Any work around will also do. &lt;br&gt;
&lt;br&gt;
Thanks.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="24/09/2013 12:29:42">
          <Html>
        &lt;div class="markDownOutput "&gt;EPPlus doesn't support forms in this current release but you can achieve it through VBA code.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Multiple DataFields on PivotTable">
      <Posts>
        <Post From="Recursor" When="16/12/2011 05:53:15">
          <Html>
        
&lt;p&gt;Do I need to do anything special to add more than one of the same datafield with different functions like count, sum, and average to a pivottable?&amp;nbsp; Whenever I try this, the code runs fine but Excel crashes when I open the file.&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks!&lt;/p&gt;
&lt;p&gt;David&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="pietia336" When="12/04/2012 15:44:36">
          <Html>
        
&lt;p&gt;Anyone solved this problem? Is that possible to add multiple datafields? If so, how?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="trauschauwem" When="23/09/2013 12:53:46">
          <Html>
        &lt;div class="markDownOutput "&gt;Possibly pivot fields have to have a unique field names. Try to rename your columns, this workes for me in a similar situation,&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="packagerelationship with specified id does not exist for the source part">
      <Posts>
        <Post From="dmercanti" When="23/09/2013 08:07:02">
          <Html>
        &lt;div class="markDownOutput "&gt;version 3.1.3.0 &lt;br&gt;
&lt;br&gt;
I get the error in the subject with this file &lt;br&gt;
&lt;a href="http://data.sygest.it/download/bom_err.xlsx" rel="nofollow"&gt;http://data.sygest.it/download/bom_err.xlsx&lt;/a&gt;.
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Suggestions ?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Row by row shows varying lengths in C#">
      <Posts>
        <Post From="TormodS" When="19/09/2013 15:01:41">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi. &lt;br&gt;
&lt;br&gt;
My application is reading an excel sheet from an external vendor. The excel sheet looks fine, but it appears that it was edited using some feature in excel which confuses my epplus based code.
&lt;br&gt;
&lt;br&gt;
This two consecutive code lines returns two different numbers (on the same excel sheet).&lt;br&gt;
&lt;pre&gt;&lt;code&gt;pck1.Workbook.Worksheets["MACH_IO"].Cells["a279:bb279"].Count();
pck1.Workbook.Worksheets["MACH_IO"].Cells["a280:bb280"].Count();
&lt;/code&gt;&lt;/pre&gt;
since they cover the same amount of columns, the numbers should be the same, AFAICT.
&lt;br&gt;
&lt;br&gt;
Question 1: What can cause this? Merged cells? Cells with "null" content? Special content types (eg Formulas)?
&lt;br&gt;
Question 2: How do I compensate? I discovered this because .ElementAt() started returning the wrong stuff. It is very important that I am reading the visual column.
&lt;br&gt;
Question 3: I assume that some cells are missing. If this, for example, is "f280", what will happen if I try to access it directly.
&lt;br&gt;
&lt;br&gt;
Thank you.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="20/09/2013 20:32:43">
          <Html>
        &lt;div class="markDownOutput "&gt;I've never needed to take a look inside it, but I think only initialized cells will be in dictionary, if you try to access it directly will create a new entry on cell´s dictionary. So, If I am right, you can have a lot of "roles" inside your
 cells collection. Why you need to use ElementAt? Maybe you can try a linq querie.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Opening Exported Google Spreadsheet and calling Save or SaveAs results in weird formatting">
      <Posts>
        <Post From="jteitsch" When="18/09/2013 20:34:10">
          <Html>
        &lt;div class="markDownOutput "&gt;When I export any Google Spreadsheet as xlsx and then open with EPPlus and call the Save or SaveAs method, it causes all data (rows, column headers, etc.) in the xlsx file to become strikethrough, bold, and italicized.
&lt;br&gt;
&lt;br&gt;
Here is the sample code I've used most recently.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;using (var pck = new ExcelPackage(new FileInfo("exportedGoogleSpreadsheet.xlsx")))
{
    pck.SaveAs(new FileInfo("output.xlsx"));
}&lt;/code&gt;&lt;/pre&gt;
I currently have code that will download a google spreadsheet to a stream, then use EPPlus to add a password before saving to disk, since I wanted to avoid creating an insecure file on the disk if at all possible. If you notice that I'm doing anything wrong,
 please let me know! Thanks a bunch.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Missing option &quot;scale with document&quot; for headers">
      <Posts>
        <Post From="krush1704" When="16/09/2013 14:12:53">
          <Html>
        &lt;div class="markDownOutput "&gt;Firstly, thanks for your great work. It's nearly perfect for my needs. But I still have one question. It seems like there is no option "scale with document" in the ExcelHeaderFooter class. This option is always 'true'. Is there any possibility
 to set this value on 'false'? All the other boolean options for Header/Footer exists.
&lt;br&gt;
&lt;br&gt;
Thanks in advance!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How do you determine the most recently viewed worksheet (“ActiveSheet”)?">
      <Posts>
        <Post From="franzombler" When="10/09/2013 06:20:21">
          <Html>
        &lt;div class="markDownOutput "&gt;When you open a workbook in Excel, it shows you the worksheet you were looking at when you last saved it.
&lt;br&gt;
&lt;br&gt;
How do you determine which sheet this is when you open a workbook using EPPlus? &lt;br&gt;
&lt;br&gt;
(Question also posted here: &lt;br&gt;
&lt;a href="http://stackoverflow.com/questions/18566596/how-to-determine-the-most-recently-viewed-worksheet-activesheet-in-epplus" rel="nofollow"&gt;http://stackoverflow.com/questions/18566596/how-to-determine-the-most-recently-viewed-worksheet-activesheet-in-epplus&lt;/a&gt;)&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="10/09/2013 12:30:25">
          <Html>
        &lt;div class="markDownOutput "&gt;&lt;a href="http://epplus.codeplex.com/discussions/277184" rel="nofollow"&gt;http://epplus.codeplex.com/discussions/277184&lt;/a&gt;
&lt;br&gt;
&lt;br&gt;
I can't test right now, but I think the last opened worksheet will be set as TabSelected = true.
&lt;br&gt;
&lt;br&gt;
Regards, &lt;br&gt;
Thiago&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="franzombler" When="10/09/2013 20:56:58">
          <Html>
        &lt;div class="markDownOutput "&gt;Perfect, thanks. &lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="System.Security.Permissions.FileIOPermission - Failed">
      <Posts>
        <Post From="DeHaynes" When="01/10/2010 22:15:15">
          <Html>
        
&lt;p&gt;Ok, all I did was copy the DLL into my ASP.net 3.5, c# project and ran the following code.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; using (ExcelPackage package = new ExcelPackage(existingFile))&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ReturnTable = new DataTable("ExcelTabs");&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ReturnTable.Columns.Add("WorksheetName", System.Type.GetType("System.String"));&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; foreach (ExcelWorksheet Worksheet in package.Workbook.Worksheets)&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; DataRow row = ReturnTable.NewRow();&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; row[0] = Worksheet.Name;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;/p&gt;
&lt;p&gt;It gives me the following error:&lt;/p&gt;
&lt;p&gt;"Request for the permission of type 'System.Security.Permissions.FileIOPermission, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' failed."&lt;/p&gt;
&lt;p&gt;On the line "using (ExcelPackage package = new ExcelPackage(existingFile))".&lt;/p&gt;
&lt;p&gt;The "existingFile" is pointing to a tempFiles folder under the website main folder.&amp;nbsp; I have given full rights to the "network service" and "ASP.Net" accounts for the whole website, including that folder.&amp;nbsp; Any ideas?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="03/10/2010 18:00:27">
          <Html>
        
&lt;p&gt;That should work fine if you have the correct permissions. Make sure the user running under the application pool has the right permissions.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="DeHaynes" When="04/10/2010 12:47:58">
          <Html>
        
&lt;p&gt;The project that is running is the local one that is created when you start an application in Visual Studio.&amp;nbsp; I don't know of a place to control the application pool from.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="04/10/2010 13:50:15">
          <Html>
        
&lt;p&gt;ok, you use the internal webserver in vs2010?&amp;nbsp;Can you run the code from a console/win app?&lt;/p&gt;
&lt;p&gt;Are you local admin on your machine. If not, do you get it to work if you start&amp;nbsp;VS as Local admin?&lt;/p&gt;
&lt;p&gt;Also, check the event log for any messages.&lt;/p&gt;
&lt;p&gt;Can you read the file using a normal FileStream?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="DeHaynes" When="04/10/2010 14:15:24">
          <Html>
        
&lt;p&gt;Ok, I found some more information.&amp;nbsp; The line before the using listed above is this:&lt;/p&gt;
&lt;p&gt;FileInfo existingFile = new FileInfo(LocalFileName);&lt;/p&gt;
&lt;p&gt;I use reflector and can see that once processing enters the DLL, that it can no longer see the FileInfo.&amp;nbsp; I also extracted this error out&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;The assembly or AppDomain that failed was:&lt;br&gt;
EPPlus, Version=2.7.0.1, Culture=neutral, PublicKeyToken=ea159fdaa78159a1&lt;br&gt;
The Zone of the assembly that failed was:&lt;br&gt;
Internet&lt;br&gt;
The Url of the assembly that failed was:&lt;br&gt;
&lt;a&gt;file:///C:/inetpub/DRBweb_3.5//DRBWEB_3.5/bin/EPPlus.DLL&lt;/a&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="DeHaynes" When="04/10/2010 14:17:57">
          <Html>
        
&lt;p&gt;I am using VS2008.&amp;nbsp; This application is setup to use a website on the local IIS on my local box.&amp;nbsp; When I run your sample applicaiton I have no issues.&lt;/p&gt;
&lt;p&gt;When I start up my application, I have to be in local admin mode on my system.&lt;/p&gt;
&lt;p&gt;Will check the event log and try to read the file via a normal FileStream.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="DeHaynes" When="04/10/2010 14:18:27">
          <Html>
        
&lt;p&gt;Oh, my local box is Windows 7 with IIS 7&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="04/10/2010 14:19:13">
          <Html>
        
&lt;p&gt;Try to download the source and run it with your code.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="DeHaynes" When="04/10/2010 14:23:03">
          <Html>
        
&lt;p&gt;Sorry but I don't see where to download the source.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="04/10/2010 14:23:58">
          <Html>
        
&lt;p&gt;From the source code tab&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="DeHaynes" When="04/10/2010 14:24:16">
          <Html>
        
&lt;p&gt;Yep, just found it.&amp;nbsp; Thanks.&amp;nbsp; :)&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="DeHaynes" When="04/10/2010 14:32:53">
          <Html>
        
&lt;p&gt;Nope didn't help.&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="DeHaynes" When="04/10/2010 14:48:27">
          <Html>
        
&lt;p&gt;In case it helps, here is more of the code.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; public DataTable GetExcelTabNames()&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; DataTable ReturnTable = null;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; try&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; if (File.Exists(LocalFileName) == false)&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; GetExcelFile();&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; FileInfo existingFile = new FileInfo(LocalFileName);&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; // the using statement automatically calls Dispose() which closes the package.&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; using (ExcelPackage package = new ExcelPackage(existingFile))&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ReturnTable = new DataTable("ExcelTabs");&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ReturnTable.Columns.Add("WorksheetName", System.Type.GetType("System.String"));&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; foreach (ExcelWorksheet Worksheet in package.Workbook.Worksheets)&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; DataRow row = ReturnTable.NewRow();&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; row[0] = Worksheet.Name;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; catch (Exception ex)&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; string Message = "Description:&amp;nbsp; Error Getting Excel Tab Names."&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; + ", Method: DRB.Web.Accounts.Upload.UploadUtilVersion2.ExcelTabNames()"&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; + ", Error Message:" + ex.Message&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; + ", Error Source:" + ex.Source;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; EventLog.WriteEntry("DRBweb 1.1", Message, EventLogEntryType.Error);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; throw (ex);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; return ReturnTable;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="DeHaynes" When="04/10/2010 15:16:25">
          <Html>
        
&lt;p&gt;OK, I don't know what caused it but it started working.&amp;nbsp; I believe it was a security issue.&amp;nbsp; After it started working, I started backing out changes.&amp;nbsp; They are all backed out and it is still working!&amp;nbsp; I don't know what to think, but I
 will count it as a blessing and move forward.&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I am now getting a corrupted data error.&amp;nbsp; I will research that now.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks a ton for your help jankallman.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="bugmenot2" When="03/12/2010 14:13:58">
          <Html>
        
&lt;p&gt;i had same errors - &lt;span&gt;System.Security.Permissions.FileIOPermission - on lines, where FileInfo methods were called
&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;i edited ExcelPackage.cs, compiled and they're gone&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="ktchiam" When="06/09/2013 17:02:38">
          <Html>
        &lt;div class="markDownOutput "&gt;I have the same issue here. It works on my PC (Windows 7 64 bit), but it does not work on other 32 bit PC. It prompts the same error even if i re-compile the code in 32 bit environment. However, this error only happen when the DLL is called with Labview.
 It is working fine if it is called by the sample program. &lt;br&gt;
&lt;br&gt;
Please help. &lt;br&gt;
&lt;br&gt;
Br, &lt;br&gt;
KT.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Identify user edited range in a excel sheet">
      <Posts>
        <Post From="udaya726" When="06/09/2013 07:52:40">
          <Html>
        &lt;div class="markDownOutput "&gt;First of all I am thanking to this tool.I have small problem. I have a excel sheet with multiple columns. users are enter rows and the number of rows getting differ. How can I get the number of rows user enters data.Its like some thing used range.
&lt;br&gt;
&lt;br&gt;
Thanks&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Ignore blank cells">
      <Posts>
        <Post From="gopimanikandan" When="05/09/2013 16:00:16">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi All, &lt;br&gt;
&lt;br&gt;
I have created the excel charts using EPPLUS, it works very well. But I have faced some small issues.
&lt;br&gt;
&lt;ol&gt;
&lt;li&gt;Is there any way to remove the blank cells from the excel range &lt;br&gt;
dataSheet.Cells["B02:B26"] &lt;/li&gt;&lt;li&gt;remove the empty series from the chart when the chart getting populated using the following code&lt;br&gt;
chart.Series.Add(dataSheet.Cells["C02:C26"], dataSheet.Cells["B02:B26"]);&lt;br&gt;
&lt;/li&gt;&lt;/ol&gt;
Please let me know, is there any way or work around to overcome the above issues.
&lt;br&gt;
&lt;br&gt;
Thanks, &lt;br&gt;
Gopi&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to insert row into sheet with values from string[] or object[]">
      <Posts>
        <Post From="Datar" When="04/09/2013 08:51:01">
          <Html>
        &lt;div class="markDownOutput "&gt;my code:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;      sheetTires.Cells[1, 1].Value = "Код";
      sheetTires.Cells[1, 2].Value = "Марка";
      sheetTires.Cells[1, 3].Value = "Модель";
      sheetTires.Cells[1, 4].Value = "Сезонность";
      sheetTires.Cells[1, 5].Value = "Размер";
      sheetTires.Cells[1, 6].Value = "Шип";
      sheetTires.Cells[1, 7].Value = "Индексы";
      sheetTires.Cells[1, 8].Value = "Остатки на складе";
      sheetTires.Cells[1, 9].Value = "Остатки поставщиков";
      sheetTires.Cells[1, 10].Value = "Опт";
      sheetTires.Cells[1, 11].Value = "Розница";&lt;/code&gt;&lt;/pre&gt;
better code:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;sheetTires.Row(1).LoadFromArray(new string[] { "Код", "Марка", "Модель", "Сезонность", "Размер", "Шип", "Индексы", "Остатки на складе", "Остатки поставщиков", "Опт", "Розница" });&lt;/code&gt;&lt;/pre&gt;
because without index&lt;br&gt;
Explain me please how can do this.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Importing and exporting data - performance">
      <Posts>
        <Post From="Svein" When="04/06/2010 08:53:07">
          <Html>
        
&lt;p&gt;Hi! First of all I want to thank You for a great component :)&lt;/p&gt;
&lt;p&gt;I wonder what the best apporoach is&amp;nbsp;for importing/exporting dataTables from/to xlsx.&lt;/p&gt;
&lt;p&gt;Im relatively new to both programming and VS, so therefore use VB.net not c#.&lt;/p&gt;
&lt;p&gt;On the homepage, quote: "The access to cells has been totally rewritten using dictionaries, to gain better performance. You can now load 50 000 cells in seconds."&lt;/p&gt;
&lt;p&gt;When saving to xlsx I iterate approx 1000 rows and 400 columns, takes about 30-45 seconds.&lt;/p&gt;
&lt;p&gt;Is this the best opproach or im I missing soemthing here?&lt;/p&gt;
&lt;p&gt;For instance, is&amp;nbsp;it possible to&amp;nbsp;import and save&amp;nbsp;a whole worksheet, "wsheet.ExtractToDataTable(dataTable, wsheet.Rows[start], wsheet.Columns[start])"&lt;/p&gt;
&lt;p&gt;And similar for putting data from a table to a worksheet, setting a&amp;nbsp;cellID as start cell....&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I can live with the performance, but if finetunig&amp;nbsp;is&amp;nbsp;possible, its always welcome :)&lt;/p&gt;
&lt;p&gt;Keep up the good work :)&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="04/06/2010 14:05:03">
          <Html>
        
&lt;p&gt;Hi&lt;/p&gt;
&lt;p&gt;Loading 400 000 cells in 30-45 sek sounds normal&amp;nbsp;I guess.&lt;/p&gt;
&lt;p&gt;The performance&amp;nbsp;depends on a lot of things, like what kind of data you load&amp;nbsp; (a lot of strings take longer time), what kind of formatting you do and the performance of you database query, of course.&lt;/p&gt;
&lt;p&gt;Generally, always load data from the top, Left to right to avoid the internal index to be resorted (thats the way you do it if you load a datatable).&lt;/p&gt;
&lt;p&gt;That means that if you&amp;nbsp;add a formula on the data it's faster to add it for every row than do it for a whole range after you have loaded the datatable (since that will insert cells in the sorted internal index).&lt;/p&gt;
&lt;p&gt;Avoid to use the InsertRow&amp;nbsp;and DeleteRow methods.&lt;/p&gt;
&lt;p&gt;You&amp;nbsp;can use the&amp;nbsp;LoadFromDataTable-method&amp;nbsp;on&amp;nbsp;a range&amp;nbsp;to load a datatable.&amp;nbsp;I have not added a method for the other way around.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Svein" When="04/06/2010 15:50:40">
          <Html>
        
&lt;p&gt;Thanks for the reply!&lt;/p&gt;
&lt;p&gt;quote: "You&amp;nbsp;can use the&amp;nbsp;LoadFromDataTable-method&amp;nbsp;on&amp;nbsp;a range&amp;nbsp;to load a datatable.&amp;nbsp;I have not added a method for the other way around.&amp;nbsp;"&lt;/p&gt;
&lt;p&gt;So when saving to an xlsx I can 'loadFromDataTable' - but when importing an xlsx I have to iterate and place each cell - one at a time. Correct?&lt;/p&gt;
&lt;p&gt;Svein&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="06/06/2010 13:34:15">
          <Html>
        
&lt;p&gt;Correct&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="danielvanoye" When="24/09/2010 15:56:35">
          <Html>
        
&lt;p&gt;dear jankallman you say :&lt;br&gt;
"That means that if you&amp;nbsp;add a formula on the data it's faster to add it for every row than do it for a whole range after you have loaded the datatable (since that will insert cells in the sorted internal index)."&lt;/p&gt;
&lt;p&gt;i have a datatable with 70 000 rows and 100 columns with a lot of string, with LoadFromDataTable-method it's very quick ( 5 minutes, it's good for me), but when a try to add a column with formula using cell range, example:&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(0, 128, 0); font-size: x-small;"&gt;&lt;span style="color: rgb(0, 128, 0); font-size: x-small;"&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;sheet.Cells["CU2:CU" + (dt.Rows.Count + 1).ToString()].Formula = "CE2-BB2"&lt;/p&gt;
,
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(0, 0, 0);"&gt;this take another 5 minutes for each column. How i can add a formula in my data.?&lt;/span&gt;&lt;br&gt;
&lt;span style="color: rgb(0, 0, 0);"&gt;Your recommend me to write cells using LoadFromDataTable and later iterate for place formula cell by cell ?&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(0, 0, 0);"&gt;wich is the faster method to add formula cells in a excel thar have many rows( like 70 000 with 100 columns) ¿?&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="27/09/2010 07:15:17">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Here is a few hints to get better performance with huge amounts of data.&lt;/p&gt;
&lt;p&gt;The fastest way to add cells is always from Left to Right-Top to bottom.&lt;/p&gt;
&lt;p&gt;If you have a datatable to start with use the LoadFromDataTable method, it's a little bit faster than using the Cells collection. For every formula column, add an empty column to the datatable to ensure the cells are created in order.&lt;/p&gt;
&lt;p&gt;If you don't have a datatable (or if you can't or don't want to add columns to the datatable), just use the Cells collection and create the&amp;nbsp;cells in order.&lt;/p&gt;
&lt;p&gt;The reason cells should be created in order is that the internal RangeCollection class uses a a sorted array that points into a list of Cells. If you add a cell at the top, a "pointer item" will be inserted in the sorted array&amp;nbsp;and all items
 after will be shifted down.&lt;/p&gt;
&lt;p&gt;If you have millions of cells and insert a new column, that will take a looong time to complete, but if you add the cells in order the "pointer item" will allways be addad at the end.&lt;/p&gt;
&lt;p&gt;I guess you could aviod this by implementing some sort of paging in the sorted array, but that is something for the future,&lt;/p&gt;
&lt;p&gt;Have a look at the RangeCollection class if you are interested.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="danielvanoye" When="01/10/2010 05:43:17">
          <Html>
        
&lt;p&gt;Thanks Jankallman, i iterate trougth datatable and add cell by cell and i got a good time, aprox 5 minutes ( from load my data and put into excel), my datatable contains 70 000 rows and 100 columns, this works fine in this escenari, bue when&amp;nbsp;i have
 a datataable with 90 000 rows and 300 columns i get a systemoutofmemory exception = (&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="davidolivanubieto" When="31/08/2013 09:35:54">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, some results from my own investigation about performance loading huge amounts of data.
&lt;br&gt;
&lt;br&gt;
Scenario: Load 50.000 rows with 15 columns, no NumberFormat, Formulae, Styles, just plain data. The data loaded is mainly string, but contains also short, int, long and DateTime. The data to load is a list of objects (List&amp;lt;T&amp;gt;) that need some customization
 so need to be transformed into somewhat that will passed to EPPlus. &lt;br&gt;
&lt;br&gt;
The approach with best performance we be found is LoadFromArrays using object[][] as the container of the data to load. Requires 300ms to prepare the data (converting List&amp;lt;T&amp;gt; to object[][] with some customization) and 9.800ms to load the 750.000 cells
 on a 1-year laptop with Core i7. &lt;br&gt;
&lt;br&gt;
The second approach with best performance is LoadFromDataTable. The time to load the cells is very similar, but preparing the data tooks 1.300ms as the DataTable storage is not as efficient as object[][].
&lt;br&gt;
&lt;br&gt;
The last and worst scenario is of course Cells[row][column].Value = data, from left to right and from top to bottom as usual.
&lt;br&gt;
&lt;br&gt;
So, if you have your data already in a DataTable, use LoadFromDataTable but if you have your data in any other form, convert it to object[][] and use LoadFromArrays.
&lt;br&gt;
&lt;br&gt;
We did not test LoadFromCollection as the use of reflection may impose an overhead versus LoadFromArrays so if you can generate the object[][] easily, LoadFromArrays is your best option.
&lt;br&gt;
&lt;br&gt;
We use reflection in LoadFromArrays for generating the object[][] but in a very efficient way (we think!).&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="how do i copy the contents of a sheet into a Email.">
      <Posts>
        <Post From="bhushanvinay" When="21/08/2013 17:30:32">
          <Html>
        &lt;div class="markDownOutput "&gt;Is there a way i can copy the contents of a worksheet into a mail with HTML format and send it?
&lt;br&gt;
&lt;br&gt;
may be there is, if so please do help me. &lt;br&gt;
&lt;br&gt;
Regards &lt;br&gt;
Vinay.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="nhanson" When="29/08/2013 16:23:35">
          <Html>
        &lt;div class="markDownOutput "&gt;It's easy enough to send the generated worksheet as an attachment would this not work for you? I'm not sure what you mean by copy the contents into a mail with HTML format. Are you asking for it to be as if a user opened the spreadsheet, copied the contents
 to the clipboard, and then pasted it into an HTML email? I doubt that's a trivial task but I may be mistaken.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="bhushanvinay" When="30/08/2013 13:05:36">
          <Html>
        &lt;div class="markDownOutput "&gt;Yes the attachment won't work, need a way to automate the contents of the excel sheet as html to a mai.body = sheet[0].getcontentasHTML():
&lt;br&gt;
mail.send(): &lt;br&gt;
&lt;br&gt;
This is what I am after. So the images graphics remain intact with formatting. &lt;br&gt;
&lt;br&gt;
Kind regards &lt;br&gt;
Vinay.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Create a named range">
      <Posts>
        <Post From="mr_miles" When="01/10/2010 18:46:02">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I am trying to create a named range in a spreadsheet I am creating. However there does not seem to be a way to add the named range - although Workbook.Names.Add is public, it requires an ExcelRangeBase object, which does not seem to have a public constructor,
 so I am unable to create it.&lt;/p&gt;
&lt;p&gt;Am I doing this right, or is there another way?&amp;nbsp; Apologies if I just haven't looked in the right place,&lt;/p&gt;
&lt;p&gt;Thanks,&lt;/p&gt;
&lt;p&gt;Miles&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="01/10/2010 18:54:14">
          <Html>
        
&lt;p&gt;Use the Cells property like...&lt;/p&gt;
&lt;p&gt;Workbook.Names.Add("Name",WorkSheet.Cells["A1:A2"]);&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mr_miles" When="01/10/2010 19:07:25">
          <Html>
        
&lt;p&gt;Brilliant - works great.&lt;/p&gt;
&lt;p&gt;Thanks for your speedy response, now I can knock this off before the weekend!&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mr_miles" When="04/10/2010 15:58:32">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Is there a change between 2.7.0.1 and trunk that would cause this to only work on the trunk?&amp;nbsp; I can't see anything in the changelog about it, but my defined name is missing from&amp;nbsp;a test&amp;nbsp;sheet if I compile using the 2.7.0.1 binaries, but not
 if I compile using source from the trunk.&lt;/p&gt;
&lt;p&gt;If so, would it be possible to release an updated version?&lt;/p&gt;
&lt;p&gt;Here is the test code that I use to exercise the problem:&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;using System;&lt;br&gt;
using System.IO;&lt;br&gt;
using OfficeOpenXml;&lt;/p&gt;
&lt;p&gt;namespace ConsoleApplication1&lt;br&gt;
{&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; class Program&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; static void Main()&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; var newFile = new FileInfo(System.IO.Path.GetTempFileName());&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; int nameCount;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; using (ExcelPackage pck = new ExcelPackage())&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; var ws = pck.Workbook.Worksheets.Add("Content 1, scggdfg");&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ws.Cells["B1"].Value = "Name";&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ws.Cells["C1"].Value = "Size";&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ws.Cells["D1"].Value = "Created";&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ws.Cells["E1"].Value = "Last modified";&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ws.Cells["B1:E1"].Style.Font.Bold = true;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; var range = ExcelRange.GetAddress(1, 1, 1, 3, false);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; pck.Workbook.Names.Add("booger", ws.Cells[range]);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; nameCount = pck.Workbook.Names.Count;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; // create a temp file&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; pck.SaveAs(newFile);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; using (var pck2 = new ExcelPackage(newFile))&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; if (pck2.Workbook.Names.Count != nameCount)&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; throw new Exception("NAMES LOST AFTER SAVING");&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;/p&gt;
&lt;p&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
}&lt;/p&gt;
&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;&lt;font color="#0ac000" workitemlink"="" href="https://epplus.codeplex.com/workitem/0000"&gt;#0000ff" face="Consolas" size="2"&amp;gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;/font&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="05/10/2010 07:53:37">
          <Html>
        
&lt;p&gt;Yes, the bug has only been fixed in the trunk. But its one line of code. I can check it in to the 2.7 tag next time i update the code.&lt;/p&gt;
&lt;p&gt;You can change it yourself in the tag if you want to...&lt;/p&gt;
&lt;p&gt;﻿Change the &amp;gt; to == in ExistsNames in ExcelWorkbook...&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;        &lt;span style="color: blue;"&gt;private&lt;/span&gt; &lt;span style="color: blue;"&gt;bool&lt;/span&gt; ExistsNames()
        {
            &lt;span style="color: blue;"&gt;if&lt;/span&gt; (_names.Count == 0)

 I guess i should do all bug fixes in the tag as well but its a lot of extra work and I really dont have all that much time for this project. Anyway, I hope i can release a new version in a month or two.&lt;/pre&gt;
&lt;pre&gt;/Jan&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="mr_miles" When="05/10/2010 15:33:18">
          <Html>
        
&lt;p&gt;Thanks,&lt;/p&gt;
&lt;p&gt;Sorry for the hassle, because of the policies here and that other production&amp;nbsp;assemblies here use epplus, I can't get my work through QA unless the change is an "official" update.&lt;/p&gt;
&lt;p&gt;﻿﻿﻿So I am happy to make the change in the tag, but I don't have access at the moment,&amp;nbsp;are you able to add me?&lt;/p&gt;
&lt;p&gt;EPPlus is great BTW, thanks for all your help&lt;/p&gt;
&lt;p&gt;Miles&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="06/10/2010 06:45:15">
          <Html>
        
&lt;p&gt;If you want to use the 2.7 version a workaround is to add your name as a worksheet-local name (use the Worksheet.Names collection instead)&amp;nbsp;or if you need a workbook-global add the workbook name and then add add a dummy worksheet-local name in any worksheet.&lt;/p&gt;
&lt;p&gt;I have already made the change in the code but I have some unfinished work to complete before&amp;nbsp;I can check it in.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="grimmdp" When="30/08/2013 13:02:00">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi Jan,&lt;br&gt;
I'm using 3.1 and still appear to be having issues with Names collections saving. I've tried adding the named range at the workbook and worksheet level, and still seem to wind up with a worksheet that is missing the range once I re-open the workbook. Is there
 a specific way this needs to be done?&lt;br&gt;
&lt;pre&gt;&lt;code&gt;ExcelRange rng= sht1.Cells["F1:F100"];
for (int iwks = 1; iwks &amp;lt;= book.Worksheets.Count; iwks++)
{
    ExcelWorksheet sht = book.Worksheets[iwks];                                
    sht.Names.Add("NAME", rng);                            
}
rng.Dispose();&lt;/code&gt;&lt;/pre&gt;
Thanks Jan for a great project!&lt;br&gt;
&lt;br&gt;
Dean&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Invalid Address format: (tablename)[(tablefield)] Exception">
      <Posts>
        <Post From="mjoyce19" When="06/05/2013 19:11:41">
          <Html>
        &lt;div class="markDownOutput "&gt;Just an FYI for those using EPPlus for reading data formatted in a table. I created a file with a tab with two tables that referenced each other via Vlookups and DataValidation dropdown lists. Anyways, when trying to set the worksheet to a variable, I
 was getting an exception:&lt;br&gt;
&lt;br&gt;
&lt;em&gt;Invalid Address format: mytablename[mytablefield]&lt;/em&gt;&lt;br&gt;
&lt;br&gt;
No matter how many different names I tried, I still got this exception. &lt;strong&gt;Finally, I decided to remove the table format, and then recreate the table, using the same tablename and field names which fixed the issue.&lt;/strong&gt;&lt;br&gt;
&lt;br&gt;
I have no clue why this exception was occurring but I just wanted to post this in case someone else runs into this problem in the future.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="justinc829" When="29/08/2013 22:03:16">
          <Html>
        &lt;div class="markDownOutput "&gt;I have the same problem. I have a workbook with multiple worksheets, each sheet having a single table in it. I get the same exception to occur on the line:
&lt;br&gt;
&lt;br&gt;
worksheet = package.Workbook.Worksheets["Contacts"]; &lt;br&gt;
&lt;br&gt;
package.Workbook is a valid workbook and "Contacts" is the name of the worksheet I want to access. (Using an array index produces the same error).
&lt;br&gt;
&lt;br&gt;
If I manually remove the table formatting from the table and then run this code again, I no longer receive the exception. There is an issue raised for it here
&lt;a href="https://epplus.codeplex.com/workitem/14779" rel="nofollow"&gt;https://epplus.codeplex.com/workitem/14779&lt;/a&gt; but it is set to low priority. I think it should be raised to high priority as until it is fixed it is impossible to work with Excel files which
 contain tables.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="InvalidOperationException: FIPS">
      <Posts>
        <Post From="bgibb" When="21/09/2012 17:02:23">
          <Html>
        
&lt;p&gt;Hi -&lt;/p&gt;
&lt;p&gt;I am getting this error when trying to save a package:&lt;/p&gt;
&lt;p&gt;InvalidOperationException:&amp;nbsp;This implementation is not part of the Windows Platform FIPS validated cryptographic algorithms.&lt;/p&gt;
&lt;p&gt;It is a workbook with four worksheets. &amp;nbsp;It was saving fine with test data, but when I added the production data - not that much more - this error occurred.&lt;/p&gt;
&lt;p&gt;Any help will be greatly appreciated!&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Blair&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="ghemah" When="11/04/2013 16:13:33">
          <Html>
        &lt;div class="markDownOutput "&gt;Is there any news on this? I've tried changing all the SHA1Managed references to SHA1CryptoProviders and I'm still getting the FIPS error.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="bgibb" When="11/04/2013 16:17:24">
          <Html>
        
&lt;div&gt;
&lt;p&gt;We no longer use EPPlus. There were too many little things like this that got in the way.&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;b&gt;&lt;span style="font-family:;"&gt;Blair Gibb&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;
&lt;p&gt;&lt;b&gt;&lt;/b&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;Business Intelligence Analyst&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;Analytics&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:;"&gt;x3299&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;hr size="1"&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;CONFIDENTIALITY NOTICE: This e-mail, and any attachments, are intended solely for the use of the intended recipient and may contain information that is confidential, proprietary, copyrighted and/or legally privileged. Any unauthorized disclosure,
 distribution, or use of this information is prohibited. If you are not the intended recipient, and have received this message in error, please notify the sender immediately by reply e-mail and destroy all copies of the original message and any attachments.
 Your compliance is appreciated. &lt;/strong&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="nhanson" When="27/08/2013 18:23:53">
          <Html>
        &lt;div class="markDownOutput "&gt;Anyone find a resolution to this or can at least provide me with more info on it.&lt;br&gt;
&lt;br&gt;
I have a console application that uses EPPlus to generate Excel documents from our database to mail to users. It is scheduled on the server. The server is required by security regulations to have the FIPS compliant flag enabled. It runs fine on my development
 box (where FIPS compliance is not enforced) but I get this InvalidOperationException error when it runs on the server (where FIPS compliance IS enforced). Oddly it doesn't error out on the first job and does manage to send 3 spreadsheets before throwing this
 exception on the fourth. I'm not sure why the error doesn't occur in the first 3 (does it only use the invalid encryption if the file is over a certain size or something?). Any help would be appreciated.&lt;br&gt;
&lt;br&gt;
Also, at no point are we password protecting any of the generated spreadsheets. I'm not sure why any encryption would be used at all.&lt;br&gt;
&lt;br&gt;
Just out of curiosity bgibb, what solution did you move to to avoid this issue?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Component hangs under IIS when call from 2 users simultaneously">
      <Posts>
        <Post From="alexbf78" When="27/08/2013 16:26:48">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello, &lt;br&gt;
&lt;br&gt;
Using Version 3.1.3.0 &lt;br&gt;
&lt;br&gt;
we are facing an issue that is similar to the one described here (which is marked as fixed) :
&lt;br&gt;
&lt;a href="https://epplus.codeplex.com/workitem/14770" rel="nofollow"&gt;https://epplus.codeplex.com/workitem/14770&lt;/a&gt;
&lt;br&gt;
&lt;br&gt;
Our scenario is slightly different but definitely related : &lt;br&gt;
&lt;br&gt;
We have a web application. When the users generate excel files one after the other, the components reacts perfectly. However, if 2 users generate an excel file at the same time, the component hangs and from this point forward, it is impossible to generate excel
 files anymore. We have to do an IISRESET to be able to generate excels again. &lt;br&gt;
&lt;br&gt;
Has anyone ever faced this issue and if so, has any clue on how to workaround it?
&lt;br&gt;
&lt;br&gt;
Thanks in advance, &lt;br&gt;
Alex&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Additional properties in worksheet">
      <Posts>
        <Post From="twiernik" When="27/08/2013 09:40:48">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello, some properties ExcelWOrksheetView are missing when compared to &lt;a href="http://msdn.microsoft.com/en-us/library/office/documentformat.openxml.spreadsheet.sheetview_members(v=office.14).aspx" rel="nofollow"&gt;
http://msdn.microsoft.com/en-us/library/office/documentformat.openxml.spreadsheet.sheetview_members(v=office.14).aspx&lt;/a&gt;
&lt;br&gt;
&lt;br&gt;
is there a reason why this properties are not present in EPPlus version of workseet? i think they are new in 2010 but excel 2007 shouldn't have problem with that&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to insert a user form">
      <Posts>
        <Post From="inebriant" When="20/08/2013 16:41:45">
          <Html>
        &lt;div class="markDownOutput "&gt;I created a userform in Excel and then exported it. This created 2 files: a .frm and a .frx. How do I add these using EPPlus?
&lt;br&gt;
&lt;br&gt;
I already know how to add and modify regular class modules, but I can't get this to work.
&lt;br&gt;
&lt;br&gt;
Thanks, &lt;br&gt;
inebriant&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="20/08/2013 18:03:49">
          <Html>
        &lt;div class="markDownOutput "&gt;Unfortunately, there is no built-in method to add forms. You can try with VBA or download our source code and do by your own.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="inebriant" When="21/08/2013 13:32:55">
          <Html>
        
&lt;div style='font-family: Calibri,"Segoe UI",Meiryo,"Microsoft YaHei UI","Microsoft JhengHei UI","Malgun Gothic","Khmer UI","Nirmala UI",Tunga,"Lao UI",Ebrima,sans-serif; font-size: 12pt;' dir="ltr"&gt;
&lt;div&gt;Thanks for your prompt response. I will try to work around it without using forms.&lt;/div&gt;
&lt;div&gt;&lt;/div&gt;
&lt;div&gt;EPPlus is fabulous, btw. Not a developer by trade but I live in Excel and this makes all those huge automated reports so much faster and easier.&lt;/div&gt;
&lt;div&gt;
&lt;div&gt;&lt;/div&gt;
&lt;div&gt;Sent from Windows Mail&lt;/div&gt;
&lt;div&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div style="padding-top: 5px; border-top-color: rgb(229, 229, 229); border-top-width: 1px; border-top-style: solid;"&gt;
&lt;div&gt;&lt;font face="Calibri, 'Segoe UI', Meiryo, 'Microsoft YaHei UI', 'Microsoft JhengHei UI', 'Malgun Gothic', 'Khmer UI', 'Nirmala UI', Tunga, 'Lao UI', Ebrima, sans-serif" style="line-height: 15pt; letter-spacing: 0.02em; font-family: Calibri;"&gt;&lt;b&gt;From:&lt;/b&gt; mrxrsd&lt;br&gt;
&lt;b&gt;Sent:&lt;/b&gt; ‎Tuesday‎, ‎August‎ ‎20‎, ‎2013 ‎10‎:‎03‎ ‎AM&lt;br&gt;
&lt;b&gt;To:&lt;/b&gt; [email removed]&lt;/font&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div&gt;&lt;/div&gt;
&lt;p&gt;From: mrxrsd&lt;/p&gt;
&lt;div id="ThreadNotificationPostBody"&gt;Unfortunately, there is no built-in method to add forms. You can try with VBA or download our source code and do by your own.&lt;br&gt;
&lt;/div&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="I want to create a major gridlines">
      <Posts>
        <Post From="eltiel" When="20/08/2013 05:01:56">
          <Html>
        &lt;div class="markDownOutput "&gt;currently I am using epplus to making a plot chart, and my client request major gridlines include in the chart when generated, have any way to add it in?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Equivalent of CharacterRun">
      <Posts>
        <Post From="steegeje" When="14/08/2013 21:57:44">
          <Html>
        &lt;div class="markDownOutput "&gt;So i have been converting a aspx.cs from Excelwriter to EPPlus have run into one issue, is there an equivalent to CharacterRun in EPPlus? thanks for any help&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="richardtallent" When="19/08/2013 06:33:13">
          <Html>
        &lt;div class="markDownOutput "&gt;Are you referring to rich text formatting within a cell? &lt;br&gt;
&lt;br&gt;
If so, you create ExcelRichText objects, each of which has a text value and formatting, put them in an ExcelRichTextCollection, and set that as the cell's value.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Exporting worksheet data to Datatable along with the style attributes">
      <Posts>
        <Post From="sunny_lnct" When="18/08/2013 17:04:55">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi,&lt;br&gt;
&lt;br&gt;
I am trying to use EPPLUS to create datatable from excel sheet &amp;amp; display on the webpage.&lt;br&gt;
But I want to display the style attributes as well For e.g border, background color etc.&lt;br&gt;
&lt;br&gt;
For the background color I am using something like the below:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;                        var backgroundcolor = currentCell.Style.Fill.BackgroundColor.Rgb;
                        string style = "";
                        if (!string.IsNullOrEmpty(backgroundcolor))
                        {
                            style = "bgcolor=#" +
                                    backgroundcolor.Substring(2, backgroundcolor.Length - 2);
                        }
&lt;/code&gt;&lt;/pre&gt;
It works for the standard colors but not the custom colors. &lt;br&gt;
For borders again there I will have to try getting the style for left, right, bottom &amp;amp; top.&lt;br&gt;
&lt;br&gt;
Is there any easy way to copy the styles from OpenRowXml styles to css styles that I can apply to the table column&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Pivot Table Option">
      <Posts>
        <Post From="Phinehas" When="14/08/2013 07:59:43">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, is it possible for EPPlus to allow we check or uncheck "Save Source Data with file", "Refresh data when opening the file" in pivot table?
&lt;br&gt;
&lt;br&gt;
Or, how can I modify EPPlus source code to support these two options?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Formatting issue">
      <Posts>
        <Post From="Dakito" When="13/08/2013 22:37:04">
          <Html>
        &lt;div class="markDownOutput "&gt;I'm building a data table dynamically from a list of objects. When I give it a decimal with formatting down to 2 decimal points it just rounds it to the nearest whole number.
&lt;br&gt;
&lt;br&gt;
I've tried this on inserting the data to the table: &lt;br&gt;
&lt;br&gt;
row[prop.Header] = Math.Round((decimal)value, 2); &lt;br&gt;
&lt;br&gt;
and then formatting it like so: &lt;br&gt;
&lt;br&gt;
ws.Column(i + 1).Style.Numberformat.Format = "#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00"; &lt;br&gt;
&lt;br&gt;
I tried it with just the formatting string but it doesn't seem to work that way either. I'm also having issues with the formatting when doing percents but I can get around that by telling it is a string.
&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Inserting a split in a worksheet">
      <Posts>
        <Post From="IronMan84" When="12/08/2013 15:08:14">
          <Html>
        &lt;div class="markDownOutput "&gt;Does anybody know if there's a way to put in a split in a worksheet? What I mean by split is that you have the first few columns of a worksheet that always stay in place and the other columns are the ones that scroll over.
&lt;br&gt;
&lt;br&gt;
Thanks.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="12/08/2013 15:13:13">
          <Html>
        &lt;div class="markDownOutput "&gt;Yes, just insert a freezepane, look at sample 6.&lt;br&gt;
&lt;br&gt;
&lt;a href="http://epplus.codeplex.com/SourceControl/latest#SampleApp/Sample6.cs" rel="nofollow"&gt;http://epplus.codeplex.com/SourceControl/latest#SampleApp/Sample6.cs&lt;/a&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="validation unlocks cells">
      <Posts>
        <Post From="seggerman" When="09/08/2013 20:01:07">
          <Html>
        &lt;div class="markDownOutput "&gt;I built an EPPlus spreadsheet with half a dozen columns which need to be locked&lt;br&gt;
this code locks the cells from the columns in question:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;                        ws.Cells[rRow, cColumn].Style.Locked = true;
&lt;/code&gt;&lt;/pre&gt;
one of the columns contains validation (not one of the locked columns)&lt;br&gt;
this VBA is added to Worksheet1:&lt;br&gt;
Private Sub Worksheet_SelectionChange(ByVal Target As Range)&lt;br&gt;
&lt;pre&gt;&lt;code&gt;Dim rRow As Long
Dim cColumn As Long
Dim thisCell As Range
Dim ws As Worksheet
Dim rRange As Range

rRow = Target.Row
cColumn = Target.Column
If cColumn &amp;lt;&amp;gt; 13 Then
    GoTo Exit_Sub
End If
If ThisWorkbook.Worksheets("Sheet1").Cells(rRow, 1) = "" Then
    GoTo Exit_Sub
End If

Application.EnableEvents = False
Set thisCell = Target
Set ws = ThisWorkbook.Worksheets("Sheet2")
Set rRange = ws.Range("A:A")
ActiveWorkbook.Names.Add Name:="nName", RefersTo:=rRange

With thisCell.Validation
    .Delete
    .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:=xlBetween, Formula1:="=nName"
    .IgnoreBlank = True
    .InCellDropdown = True
    .InputTitle = "Pays de Commence"
    .ErrorTitle = "Oops Error"
    .InputMessage = "Select One"
    .ErrorMessage = "Not a valid selection"
    .ShowInput = True
    .ShowError = True
End With
&lt;/code&gt;&lt;/pre&gt;
Exit_Sub:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;Application.EnableEvents = True&lt;/code&gt;&lt;/pre&gt;
End Sub&lt;br&gt;
&lt;br&gt;
after one of the rows is selected in this column all the locked cells are unlocked&lt;br&gt;
&lt;br&gt;
um is this expected behavior?&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
this is a few days later&lt;br&gt;
I was able to get the locking / unlocking to work by rearranging where I lock the worksheet&lt;br&gt;
however, I can't seem to figure out how to add a ValidationList to a locked spreadsheet&lt;br&gt;
unprotecting the worksheet prompts for password - and there doesn't seem to be a hook for the protection option which says apply to keyboard input only (and let VBA go through)&lt;br&gt;
any assistance would be greatly appreciated&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="LoadFromDataTable creates non empty values for DBNull-Values in Table">
      <Posts>
        <Post From="suukit" When="09/08/2013 09:34:57">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi everybody, &lt;br&gt;
&lt;br&gt;
when loading data from a Datatable (generated from an SQL query) at first sight everything looks ok but empty cells are indeed not empty. For example they are countet if you use count no the column. Is there a way to get epplus to leave DBnull values as empty
 excel cells? &lt;br&gt;
&lt;br&gt;
Thank you in advance &lt;br&gt;
Max&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="09/08/2013 12:55:16">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
Look at this thread &lt;a href="http://epplus.codeplex.com/discussions/393289" rel="nofollow"&gt;
http://epplus.codeplex.com/discussions/393289&lt;/a&gt; &lt;br&gt;
&lt;br&gt;
I think your solution is something like that... &lt;br&gt;
&lt;br&gt;
Regards &lt;br&gt;
Thiago&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Update xlsm file, save and activating macro.">
      <Posts>
        <Post From="deserialized" When="08/08/2013 21:18:01">
          <Html>
        &lt;div class="markDownOutput "&gt;I read a xlsm file, update some cells and then save the file. This only works if I have enabled macros before opening it. Once I have saved it I need to enable macros again before I can write to it. If I don't I get error:
&lt;br&gt;
&lt;br&gt;
Index was outside the bounds of the array. &lt;br&gt;
&lt;br&gt;
Now, is it possible to either activate macros when opening the file or save the file in same state (with activated macros) after updating cells? If so, how?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Pivot Table SubTotal method does not work">
      <Posts>
        <Post From="Phinehas" When="06/08/2013 03:18:37">
          <Html>
        &lt;div class="markDownOutput "&gt;I set the field column subtotal to "None". However, the excel show error "Excel found unreadable content. After I click "Yes" to open the excel, the subtotal method is set to "Automatic", not "None".
&lt;br&gt;
&lt;br&gt;
How can I solve this problem?&lt;br&gt;
&lt;pre&gt;&lt;code&gt;            OfficeOpenXml.Table.PivotTable.ExcelPivotTableField rowField = pivotTable.Fields[1];
            rowField.SubTotalFunctions = OfficeOpenXml.Table.PivotTable.eSubTotalFunctions.None;
            if (isTabularForm)
            {
                rowField.Outline = false;
                rowField.Compact = false;
            }

            pivotTable.RowFields.Add(rowField);&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Graph on OpenOffice">
      <Posts>
        <Post From="TheOsvier" When="06/06/2013 21:35:36">
          <Html>
        &lt;div class="markDownOutput "&gt;I'm creating a spreadsheet with EPPlus library on a .NET 4.0 command line application.
&lt;br&gt;
&lt;br&gt;
I successfully loaded all the data from the data base, at the end I'm creating a graphic, this is my code:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;var chart = sheet.Drawings.AddChart("Revenue", OfficeOpenXml.Drawing.Chart.eChartType.ColumnClustered);

chart.SetPosition(2, 0, 4, 0);
chart.SetSize(650, 400);

chart.Series.Add(ExcelRange.GetAddress(3, 2, 14, 2),ExcelRange.GetAddress(3, 1, 14, 1));
chart.Title.Text = "Revenue";&lt;/code&gt;&lt;/pre&gt;
I open the generated file in MS Office 2010 and everything looks fine, the data the graphic, etc.. but if I open the same generated file in OpenOffice 3.3 the graphics are empty.
&lt;br&gt;
&lt;br&gt;
The weird thing is, if I open the file in Office 2010 and make a copy (Save As).. and I open the copy in OpenOffice, the graphics are good... so I'm wondering if I'm missing something in my code to make it compatible with both Office2010 and OpenOffice
&lt;br&gt;
&lt;br&gt;
Thanks for the help!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="poloseven" When="05/08/2013 09:24:09">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
I have exactly the same problem. Did you get any solution or can someone help us ?
&lt;br&gt;
&lt;br&gt;
Thanks !&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="poloseven" When="05/08/2013 10:43:31">
          <Html>
        &lt;div class="markDownOutput "&gt;I just tried the Sample5 from the latest source code and the same problem appears.
&lt;br&gt;
&lt;br&gt;
The pie chart is ok under Excel but nothing is displayed in OpenOffice ! &lt;br&gt;
&lt;br&gt;
Thanks, &lt;br&gt;
Paul&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Change column header text">
      <Posts>
        <Post From="huytnd" When="31/07/2013 13:34:14">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi guys, &lt;br&gt;
&lt;br&gt;
I have a problem when trying to change column header text. Here is my code:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;public class AbsentEmployee
    {
        [Display(Name = "Mã nhân viên")]
        public string EmployeeCode { get; set; }
        [Display(Name = "Họ tên")]
        public string EmpFullName { get; set; }
        [Display(Name = "Phòng ban")]
        public string Department { get; set; }
        [Display(Name = "Nghỉ từ ngày")]
        public DateTime FromDate { get; set; }
        [Display(Name = "Nghỉ đến ngày")]
        public DateTime ToDate { get; set; }
        [Display(Name = "Hình thức vắng mặt")]
        public string AbsenceType { get; set; }
    }&lt;/code&gt;&lt;/pre&gt;
My method to export excel file:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;FileInfo newFile = new FileInfo(file); ExcelPackage pck = new ExcelPackage(newFile);

        var wsData = pck.Workbook.Worksheets.Add("Absent Employee List");
        var dataRange = wsData.Cells["A1"].LoadFromCollection(
                from s in emps
                orderby s.EmployeeCode
                select s,
                true, OfficeOpenXml.Table.TableStyles.Medium2
                );
        wsData.Cells[2, 4, dataRange.End.Row, 4].Style.Numberformat.Format = "dd-mm-yyyy"
        wsData.Cells[2, 5, dataRange.End.Row, 5].Style.Numberformat.Format = "dd-mm-yyyy";

        wsData.Cells["A1"].Value = "Mã nhân viên"; // [1, 1]
        wsData.Cells["B1"].Value = "Họ tên"; // [1, 2]
        wsData.Cells["C1"].Value = "Phòng ban"; // [1, 3]

        dataRange.AutoFitColumns();

        pck.SaveAs(newFile);&lt;/code&gt;&lt;/pre&gt;
The problem is the header texts still are EmployeeCode, EmpFullName, Department. So did i miss something? Thank you for your help.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="reading worksheets returns 0">
      <Posts>
        <Post From="dmad3007" When="31/07/2013 10:50:57">
          <Html>
        &lt;div class="markDownOutput "&gt;I have developed an import method using EPPLUS that reads .xlsx files with several worksheets and process the data in each worksheet successfully (on my development pc) however when I publish the website to our web server the code fails as it can’t find
 any worksheets. I believe it is because when I select the file EPPLus just creates a blank xlsx document with nothing in. Can anyone tell me if I am one the right track or point me in the right direction?
&lt;br&gt;
&lt;strong&gt;&lt;strong&gt;This CODE works on my development PC&lt;/strong&gt;&lt;/strong&gt;* &lt;br&gt;
var Productsfile = new FileInfo(PathandFileName);&lt;br&gt;
&lt;pre&gt;&lt;code&gt;    //Open and read file
    using (var datafile = new ExcelPackage(Productsfile))
    {
        //Get workbook in file
        ExcelWorkbook wkb = datafile.Workbook;
        if(wkb !=null)
        {
            //process every worksheet
            for (int i = 1; i &amp;lt; wkb.Worksheets.Count + 1; i++)
            {
                ExcelWorksheet currentworksheet = wkb.Worksheets[i];
                //Read each row missing header go to last row used
                for (int rowNumber = startRow; rowNumber &amp;lt;=     currentworksheet.Dimension.End.Row; rowNumber++)
                {
                    //read each row
                    ReadCurrentWorkSheet(currentworksheet, rowNumber);
                    //Validate each row
                    Validate(currentworksheet, rowNumber);
                 }
            }


        }

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="For a String Column in excel, how to ignore the error and automatically convert to number if the number is stored as Text">
      <Posts>
        <Post From="Malluri" When="29/07/2013 14:59:56">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
Can some one help me with the below. &lt;br&gt;
&lt;br&gt;
For a String Column in excel, how to ignore the error and automatically convert to number if the number is stored as Text.
&lt;br&gt;
&lt;br&gt;
Is this option available in the current version of epplus dll. &lt;br&gt;
&lt;br&gt;
Thanks, &lt;br&gt;
Malluri&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="30/07/2013 12:53:57">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
take a look at this thread. &lt;br&gt;
&lt;br&gt;
&lt;a href="http://epplus.codeplex.com/discussions/271067" rel="nofollow"&gt;http://epplus.codeplex.com/discussions/271067&lt;/a&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Unable to un-merge cells">
      <Posts>
        <Post From="mdesnoyer" When="29/07/2013 16:51:55">
          <Html>
        &lt;div class="markDownOutput "&gt;I am trying to un merge a cell range. &lt;br&gt;
worksheet.Cells[row,scol,row,ecol].Merge = false;&lt;br&gt;
where row =24 scol=2, ecol=6 &lt;br&gt;
&lt;br&gt;
Error message is &lt;br&gt;
"Range is not fully merged. Specify the exact range" &lt;br&gt;
&lt;br&gt;
However, I want to clear any merge cell in the specified range. (above) &lt;br&gt;
In other words I do not know if or what may be merged in that range. &lt;br&gt;
&lt;br&gt;
How do I clear a cell range?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Getting excel error &quot;found unreadable content&quot; ..">
      <Posts>
        <Post From="pointmandk" When="14/07/2011 18:01:50">
          <Html>
        
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I keep getting the error "there was found unreadable content ......." error.&lt;br&gt;
I&amp;nbsp;tried with "response.clear()" and also downloaded the latest source and compiled it in, but no dice .....&lt;/p&gt;
&lt;p&gt;Src:&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;protected&lt;/span&gt; &lt;span style="color: blue;"&gt;void&lt;/span&gt; cmb_ExportExcel(&lt;span style="color: blue;"&gt;object&lt;/span&gt; sender, EventArgs e)
    {

       FileInfo tmpl = &lt;span style="color: blue;"&gt;new&lt;/span&gt; FileInfo(MapPath(&lt;span style="color: rgb(163, 21, 21);"&gt;"../template/xxx.xlsx"&lt;/span&gt;));
      
       &lt;span style="color: blue;"&gt;using&lt;/span&gt; (ExcelPackage pck = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(tmpl, &lt;span style="color: blue;"&gt;false&lt;/span&gt;))
       {
           ExcelWorksheet ws = pck.Workbook.Worksheets[&lt;span style="color: rgb(163, 21, 21);"&gt;"Ark1"&lt;/span&gt;];

           &lt;span style="color: blue;"&gt;int&lt;/span&gt; linecnt = 5;
           &lt;span style="color: blue;"&gt;foreach&lt;/span&gt; (DataRow dr &lt;span style="color: blue;"&gt;in&lt;/span&gt; dsDocByAdmin.Rows)
           {
               ws.Cells[linecnt,1].Value = dr[&lt;span style="color: rgb(163, 21, 21);"&gt;"DocIdTxt"&lt;/span&gt;];
               ws.Cells[linecnt, 2].Value = dr[&lt;span style="color: rgb(163, 21, 21);"&gt;"ImplStatTxt"&lt;/span&gt;];
               ws.Cells[linecnt, 3].Value = dr[&lt;span style="color: rgb(163, 21, 21);"&gt;"ImplRemarks"&lt;/span&gt;];
               
               &lt;span style="color: blue;"&gt;if&lt;/span&gt; (dr[&lt;span style="color: rgb(163, 21, 21);"&gt;"DocWithDrawn"&lt;/span&gt;].ToString() == &lt;span style="color: rgb(163, 21, 21);"&gt;"True"&lt;/span&gt;)
                    ws.Cells[linecnt, 4].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"Yes"&lt;/span&gt;;
               &lt;span style="color: blue;"&gt;else&lt;/span&gt;
                   ws.Cells[linecnt, 4].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"No"&lt;/span&gt;;

               linecnt++;
           }

           &lt;span style="color: blue;"&gt;using&lt;/span&gt; (ExcelRange rng = ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"C5:C"&lt;/span&gt;+linecnt.ToString()])
           {
               rng.Style.WrapText = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
           }

           ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"B2"&lt;/span&gt;].Value = Request.QueryString[&lt;span style="color: rgb(163, 21, 21);"&gt;"ITULong"&lt;/span&gt;];
           ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"D2"&lt;/span&gt;].Value = DateTime.Now;


           &lt;span style="color: green;"&gt;//Write it back to the client&lt;/span&gt;
           Response.Clear();
           Response.AddHeader(&lt;span style="color: rgb(163, 21, 21);"&gt;"content-disposition"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"attachment; filename=xxxx"&lt;/span&gt; + Request.QueryString[&lt;span style="color: rgb(163, 21, 21);"&gt;"ITUShort"&lt;/span&gt;].Trim() + &lt;span style="color: rgb(163, 21, 21);"&gt;".xlsx"&lt;/span&gt;);
           Response.ContentType = &lt;span style="color: rgb(163, 21, 21);"&gt;"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"&lt;/span&gt;;
           Response.BinaryWrite(pck.GetAsByteArray());
       }
    }
&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="maysjw" When="14/07/2011 21:19:23">
          <Html>
        
&lt;p&gt;Try putting this for the "write back to client":&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;pck.Stream.Seek(0, SeekOrigin.Begin);&lt;/p&gt;
&lt;p&gt;byte[] output = new byte[pck.Stream.Length];&lt;/p&gt;
&lt;p&gt;int bytesRead = pck.Stream.Read(output, 0, output.Length);&lt;/p&gt;
&lt;pre&gt;Response.Clear();
Response.AddHeader(&lt;span&gt;"content-disposition"&lt;/span&gt;, &lt;span&gt;"attachment; filename=xxxx"&lt;/span&gt; + Request.QueryString[&lt;span&gt;"ITUShort"&lt;/span&gt;].Trim() + &lt;span&gt;".xlsx"&lt;/span&gt;);&lt;/pre&gt;
&lt;pre&gt;Response.AddHeader("Content-Length", output.Length.ToString();
Response.ContentType = &lt;span&gt;"application/octet-stream"&lt;/span&gt;;
Response.BinaryWrite(output);&lt;/pre&gt;
&lt;pre&gt;Response.End();&lt;/pre&gt;

        
    </Html>
        </Post>
        <Post From="pointmandk" When="27/07/2011 23:04:58">
          <Html>
        
&lt;p&gt;Hi there&lt;/p&gt;
&lt;p&gt;Thanks for your suggestion, but i still have the same problem.&lt;/p&gt;
&lt;p&gt;When i save the file first and inspect it , it seems like it downloads the entire webpage inside, and when i open in excel say yes to fix and then save only the excel part is left. Also the size changes from above 400 kb to below 25 kb - which should be
 the correct size.&lt;/p&gt;
&lt;p&gt;May have to abandon this component ...&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Any suggestions is appreciated !&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;kenneth&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mjslane" When="28/07/2011 16:38:25">
          <Html>
        
&lt;p&gt;Is this the same problem I'm having? &amp;nbsp;Is your error message similar to "Repaired Part: /xl/worksheets/sheet3.xml part with XML error. &amp;nbsp;Load error. Line 1, column 235." &amp;nbsp;If so it is because the Dimension tag in the XML for the worksheet isn't
 getting saved correctly, it's missing the column information. See&amp;nbsp;&lt;a href="http://epplus.codeplex.com/workitem/13962" rel="nofollow"&gt;http://epplus.codeplex.com/workitem/13962&lt;/a&gt;&amp;nbsp; I keep meaning to look at the code to see if I can fix it myself, but just don't
 have the time right now and there's more pressing problems with epplus that have a bigger impact (Formulas getting corrupted on row/column inserts for one) that I'll look at first... when I get the time. &amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="dtsob75" When="01/08/2011 22:43:29">
          <Html>
        
&lt;p&gt;I am having the same problem.&amp;nbsp; The byte array that is coming back in the stream is really large.&amp;nbsp; over 45k for a file that should have only 2-300 bytes of data.&amp;nbsp; You suppose that the unreadable text is the extra stuff?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="02/08/2011 16:27:03">
          <Html>
        
&lt;p&gt;Maybe it is another problem, like bad formula format, bad merging, etc. Open your .xlsx file with notepad, if you didnt see html code from your page, it isnt html trash. So, you need to check other things.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;From FAQ...&amp;nbsp;http://epplus.codeplex.com/wikipage?title=FAQ&amp;amp;referringTitle=Documentation&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;I get an error that Excel has found unreadable content when I open my generated document?&lt;/strong&gt;&lt;br&gt;
Check your Formulas and Numberformats. Formulas and numberformats are not validated by the library so if you enter anything wrong the package will be corrupt. Use the English formula names. Formula parameters are separated by commas (,), string parameters use
 double quotes (").&lt;/p&gt;
&lt;div&gt;
&lt;pre&gt;worksheet.Cells[&lt;span&gt;"A1"&lt;/span&gt;].Formula=&lt;span&gt;"CONCATENATE(\"string1_\",\"test\")"&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Numberformats:&lt;br&gt;
Use culture independent number formats: dot (.) for decimal, comma (thousand).&amp;nbsp;&lt;br&gt;
The easiest way to check a format or a formula is to create an Excel file --&amp;gt; Do the formatting / Add the formulas --&amp;gt; Save it as XLSX ---&amp;gt; Rename the file *.zip. Extract the file and have a look at the number formats in the \xl\styles.xml file and
 formulas in \xl\worksheets\sheet#.xml.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="McuGuy" When="24/07/2013 13:29:41">
          <Html>
        &lt;div class="markDownOutput "&gt;I just fixed this problem. In my case this was being caused as the ASPX page response was also being sent after the Excel file.
&lt;br&gt;
&lt;br&gt;
EPPlus ASP.NET sample shows how to so it. Refer to GetSample.aspx in samples. &lt;br&gt;
&lt;br&gt;
ASPX page should be very minimal i.e. first line only.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Insert Line Break in Cell">
      <Posts>
        <Post From="patricker" When="17/12/2010 01:00:04">
          <Html>
        
&lt;p&gt;How do you insert a line break in a cell?&lt;/p&gt;
&lt;p&gt;I used to use a char 10 with Excel Interop but that doesn't seem to work with EPPlus.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="17/12/2010 08:26:30">
          <Html>
        
&lt;p&gt;This should work...&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;worksheet.Cells[1, 1].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"Row 1\r\nRow2"&lt;/span&gt;;
worksheet.Cells[1, 1].Style.WrapText = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
&lt;/pre&gt;
&lt;pre&gt;If you dont use C#, \r\n is CRLF,chr(13), chr(10)&lt;/pre&gt;
&lt;pre&gt;Jan&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="Ian_Powers" When="18/07/2013 14:40:20">
          <Html>
        &lt;div class="markDownOutput "&gt;I am using VB.NET and the above does not work. I found that when I enter chr(10) at the end of a string it also does not work.
&lt;br&gt;
&lt;br&gt;
The only way I could get it to work was by adding it between two pieces of string:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;sheet.cells("A:2:A4").RichText.Add("String that should have a line break" &amp;amp; chr(10))
sheet.cells("A:2:A4").RichText.Add("and does not.")

sheet.cells("A:2:A4").RichText.Add("String that does" &amp;amp; chr(10) &amp;amp; "have a line break")&lt;/code&gt;&lt;/pre&gt;
I found this because I wanted to style the first 'sentance' and then have the rest of the 'paragraph' be a different style.
&lt;br&gt;
&lt;br&gt;
is this by design or am I doing somehting wrong?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="richardtallent" When="23/07/2013 23:30:38">
          <Html>
        &lt;div class="markDownOutput "&gt;For VB.NET, you need:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;sheet.cells("A:2:A4").RichText.Add("String that does" &amp;amp; chr(13) &amp;amp; chr(10) &amp;amp; "have a line break")&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to copy ExcelWorksheet">
      <Posts>
        <Post From="pongthorn" When="25/03/2010 08:49:28">
          <Html>
        
&lt;p&gt;Now I want to solution to copy sheet.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="25/03/2010 10:46:23">
          <Html>
        
&lt;p&gt;Thats on the TODO list for a future version. It shouldn't be that hard to implement. You need to copy the worksheet XML document and clone&amp;nbsp;the internal variables with the new sheet ID.&lt;/p&gt;
&lt;p&gt;If you need this now, please have a look at it, otherwise I'll see what&amp;nbsp;I can do to the next version (or any one else that feel they can contribute).&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="pongthorn" When="25/03/2010 11:56:57">
          <Html>
        
&lt;p&gt;thanks for recommend. I will try to copy worksheet XML and clone variable.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="nitharsanr" When="17/04/2010 21:43:55">
          <Html>
        
&lt;p&gt;Hai jankallman&lt;/p&gt;
&lt;p&gt;I also want know abt copying worksheet ans paste it to another workbook.&lt;/p&gt;
&lt;p&gt;i did not get the point.can you post code to copy worksheet?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Nitha&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="19/04/2010 06:55:39">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I have not implemented a worksheet copy function, so I have no have no code to post.&amp;nbsp;My recomendations above is if you want to try to write it yourself.&lt;/p&gt;
&lt;p&gt;I'll see if I can do something to a coming version.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="sglantz" When="19/05/2010 22:06:16">
          <Html>
        I just discovered this project and it looks great. I have been using Excel Package and copying has been one of my required features. I have been using a copy implementation originally posted
&lt;a href="http://excelpackage.codeplex.com/Thread/View.aspx?ThreadId=29724" rel="nofollow"&gt;here&lt;/a&gt; by slide_o_mix. I took a quick look into implementing it into EPP, but it appears the constructor for ExcelWorksheet has changed. Beyond that I haven't had the chance to examine
 EPP enough to know if this code will be easily adaptable. The code is as follows, the red line is causing the error:
&lt;br&gt;
&lt;br&gt;
/// &amp;lt;summary&amp;gt;&lt;br&gt;
/// Copies the named worksheet and creates a new worksheet in the same workbook&lt;br&gt;
/// &amp;lt;/summary&amp;gt;&lt;br&gt;
/// &amp;lt;param name="Name"&amp;gt;The name of the existing worksheet&amp;lt;/param&amp;gt;&lt;br&gt;
/// &amp;lt;param name="NewName"&amp;gt;The name of the new worksheet to create&amp;lt;/param&amp;gt;&lt;br&gt;
/// &amp;lt;returns&amp;gt;&amp;lt;/returns&amp;gt;&lt;br&gt;
public ExcelWorksheet Copy(string Name, string NewName)&lt;br&gt;
{&lt;br&gt;
// we need a new sheetID&lt;br&gt;
ExcelWorksheet old_sheet = this[Name];&lt;br&gt;
if (old_sheet == null)&lt;br&gt;
throw new Exception(string.Format("Copy worksheet error: Could not find worksheet to copy '{0}'", Name));&lt;br&gt;
&lt;br&gt;
// first fine maximum existing sheetID&lt;br&gt;
// also create a unique name&lt;br&gt;
int sheetID = 0;&lt;br&gt;
&lt;br&gt;
foreach (XmlNode sheet in _worksheetsNode.ChildNodes)&lt;br&gt;
{&lt;br&gt;
XmlAttribute attr = (XmlAttribute)sheet.Attributes.GetNamedItem("sheetId");&lt;br&gt;
if (attr != null)&lt;br&gt;
{&lt;br&gt;
int curID = int.Parse(attr.Value);&lt;br&gt;
if (curID &amp;gt; sheetID)&lt;br&gt;
sheetID = curID;&lt;br&gt;
}&lt;br&gt;
attr = (XmlAttribute)sheet.Attributes.GetNamedItem("name");&lt;br&gt;
if (attr != null)&lt;br&gt;
{&lt;br&gt;
if (attr.Value == NewName)&lt;br&gt;
throw new Exception("Add worksheet Error: attempting to create worksheet with duplicate name");&lt;br&gt;
}&lt;br&gt;
}&lt;br&gt;
// we now have the max existing values, so add one&lt;br&gt;
sheetID++;&lt;br&gt;
// add the new worksheet to the package&lt;br&gt;
Uri uriWorksheet = new Uri("/xl/worksheets/sheet" + sheetID.ToString() + ".xml", UriKind.Relative);&lt;br&gt;
PackagePart worksheetPart = _xlPackage.Package.CreatePart(uriWorksheet, @"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml");&lt;br&gt;
&lt;br&gt;
// create the new, empty worksheet and save it to the package&lt;br&gt;
StreamWriter streamWorksheet = new StreamWriter(worksheetPart.GetStream(FileMode.Create, FileAccess.Write));&lt;br&gt;
XmlDocument worksheetXml = old_sheet.WorksheetXml;&lt;br&gt;
worksheetXml.Save(streamWorksheet);&lt;br&gt;
streamWorksheet.Close();&lt;br&gt;
_xlPackage.Package.Flush();&lt;br&gt;
&lt;br&gt;
// create the relationship between the workbook and the new worksheet&lt;br&gt;
PackageRelationship rel = _xlPackage.Workbook.Part.CreateRelationship(uriWorksheet, TargetMode.Internal, ExcelPackage.schemaRelationships + "/worksheet");&lt;br&gt;
_xlPackage.Package.Flush();&lt;br&gt;
&lt;br&gt;
// now create the new worksheet tag and set name/SheetId attributes in the workbook.xml&lt;br&gt;
XmlElement worksheetNode = _xlPackage.Workbook.WorkbookXml.CreateElement("sheet", ExcelPackage.schemaMain);&lt;br&gt;
// create the new sheet node&lt;br&gt;
worksheetNode.SetAttribute("name", NewName);&lt;br&gt;
worksheetNode.SetAttribute("sheetId", sheetID.ToString());&lt;br&gt;
// set the r:id attribute&lt;br&gt;
worksheetNode.SetAttribute("id", ExcelPackage.schemaRelationships, rel.Id);&lt;br&gt;
// insert the sheet tag with all attributes set as above&lt;br&gt;
_worksheetsNode.AppendChild(worksheetNode);&lt;br&gt;
&lt;p style="color: rgb(255, 0, 0);"&gt;ExcelWorksheet worksheet = new ExcelWorksheet(_xlPackage, rel.Id, NewName, uriWorksheet, sheetID, false);&lt;/p&gt;
&lt;br&gt;
XmlDocument doc = worksheet.WorksheetXml; // this will load the worksheet XML into the member variable.&lt;br&gt;
int positionID = _worksheets.Count + 1;&lt;br&gt;
_worksheets.Add(positionID, worksheet);&lt;br&gt;
return worksheet;&lt;br&gt;
}&lt;br&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="19/05/2010 22:12:54">
          <Html>
        
&lt;p&gt;Actually im working on that now. I will try to check it in this week or the beginning of next week.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="sglantz" When="19/05/2010 22:16:05">
          <Html>
        Good to hear. And thanks for the quick response, you already responded before I finished fixing the formating on my post.
        
    </Html>
        </Post>
        <Post From="juxtaposed" When="02/06/2010 20:28:44">
          <Html>
        
&lt;p&gt;Is the worksheet copy method in the new source code checked in on June 2, 2010?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="02/06/2010 21:57:20">
          <Html>
        
&lt;p&gt;Yes!&lt;/p&gt;
&lt;p&gt;The Worksheets.Add method now takes an extra ExcelWorksheet parameter to copy a sheet. I removed the copy method.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="juxtaposed" When="02/06/2010 22:04:59">
          <Html>
        
&lt;p&gt;Thanks, I replied to the other topic regarding the new Worksheets.Add method.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="escott" When="03/06/2010 23:17:10">
          <Html>
        Jan - thank you for your efforts. A colleague and I had hacked in some copy worksheet functionality, but yours is certainly better!
&lt;br&gt;
&lt;br&gt;
I am not sure if this minor issue matters to you, but in version 59488 there is still a reserved Copy method in the ExcelWorksheets class that does not perform the functionality. In my project I added the following to implement the functionality for this method.
&lt;br&gt;
&lt;br&gt;
ExcelWorksheet Copy = this[Name];&lt;br&gt;
if (Copy == null)&lt;br&gt;
throw new Exception(string.Format("Copy worksheet error: Could not find worksheet to copy '{0}'", Name));&lt;br&gt;
ExcelWorksheet added = Add(NewName, Copy);&lt;br&gt;
return added; &lt;br&gt;
&lt;br&gt;
As an extension of the copy worksheet function, we would very much like additional functionality to perform copying of a worksheets between differing workbooks, which would allow us to merge worksheets from multiple template workbooks into a single final product
 workbook. &lt;br&gt;
&lt;br&gt;
Thanks again
        
    </Html>
        </Post>
        <Post From="jankallman" When="04/06/2010 13:37:47">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Sure, my intention was to remove this method, but since you use it and the method is there&amp;nbsp;I'll add your code.&lt;/p&gt;
&lt;p&gt;I haven't tested to add a worksheet from another workbook using the add-method, but that is intended to work. If it's not working i'll try to fix it.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="escott" When="04/06/2010 14:03:13">
          <Html>
        Thanks Jan, &lt;br&gt;
&lt;br&gt;
In my testing of adding a Worksheet to a differing Workbook, I encounter problems when the ExcelWorkbook Save function calls Styles.UpdateXml(). An index out of range exception happens in the ExcelStyles class at line 518 CellXfs[cell.GetCellStyleID()].useCnt++;
&lt;br&gt;
&lt;br&gt;
If I can help further let me know. 
        
    </Html>
        </Post>
        <Post From="jankallman" When="04/06/2010 14:13:15">
          <Html>
        
&lt;p&gt;ahh, I should have thought about that. I'll see how much work it is to fix . If its easily fixed I'll add it to the new version.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="escott" When="17/06/2010 22:58:04">
          <Html>
        
&lt;p&gt;Did this make it into the new version? I suspect it would be a big undertaking and likely was not addressed at this time.&lt;/p&gt;
&lt;p&gt;Thanks again for your efforts&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="18/06/2010 07:14:53">
          <Html>
        
&lt;p&gt;No, you can only copy a sheet inside&amp;nbsp;a package (The problem is that you need to copy the styles between the different packages).&lt;/p&gt;
&lt;p&gt;It was a little bit to close to release to implement it, but I will fix it to the next version.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="VerbukArtem" When="18/07/2013 13:43:09">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, Jan &lt;br&gt;
Do you have any updates about copy worksheet from one workbook to another? Is it already works or not?
&lt;br&gt;
&lt;br&gt;
Regards, Artem&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="IE 8 error for streaming content">
      <Posts>
        <Post From="BillHasso" When="15/07/2013 18:59:52">
          <Html>
        &lt;div class="markDownOutput "&gt;The following code works in IE 9, All versions of Chrome, All Versions of Firefox.
&lt;br&gt;
&lt;br&gt;
However, IE 8 throws this error &lt;br&gt;
&lt;br&gt;
__Unable to download EPExportExcel.aspx from localhost &lt;br&gt;
&lt;br&gt;
Unable to open this Internet site. The requested site is either unavailable or cannot be found. Please try again later.__
&lt;br&gt;
The caught error is this: &lt;br&gt;
&lt;br&gt;
&lt;strong&gt;{Unable to evaluate expression because the code is optimized or a native frame is on top of the call stack.}&lt;/strong&gt;&lt;br&gt;
&lt;pre&gt;&lt;code&gt;  private void LoadExcel()
        {
            System.IO.FileInfo f = new System.IO.FileInfo(Server.MapPath("../Template.xlsx"));

         
            using (ExcelPackage pck = new ExcelPackage(f))
            {
                //Create a datasource
                DataTable tbl = ERSHelper.GetBTComparisonDataSource(_crit.FromDate, _crit.ThruDate, (int)_crit.NetworkType, (int)_crit.InboundProg);
                //create partial data with linq
                var query =
                            from o in tbl.AsEnumerable()
                            //where order.Field&amp;lt;bool&amp;gt;("OnlineOrderFlag") == true
                            select new
                            {
                                HLC = o.Field&amp;lt;string&amp;gt;("HLC"),
                                HLCName = o.Field&amp;lt;string&amp;gt;("HLCName"),
                                UniqueAcceptedIncidentCountHLC = o.Field&amp;lt;int&amp;gt;("UniqueAcceptedIncidentCountHLC"),
                                NotServicedIncidentCountHLC = o.Field&amp;lt;int&amp;gt;("NotServicedIncidentCountHLC"),
                                RefusedIncidentCountHLC = o.Field&amp;lt;int&amp;gt;("RefusedIncidentCountHLC"),
                                AcceptedRatioHLC = o.Field&amp;lt;decimal&amp;gt;("AcceptedRatioPctHLC"),
                                LoMilesHLC = o.Field&amp;lt;int&amp;gt;("LoMilesHLC"),
                                HiMilesHLC = o.Field&amp;lt;int&amp;gt;("HiMilesHLC"),
                                //DowntimeAllAllHLC = o.Field&amp;lt;decimal&amp;gt;("AcceptedRatioHLC"),
                                DowntimeLoAllHLC = o.Field&amp;lt;decimal&amp;gt;("DowntimeLoAllHLC"),
                                DowntimeHiAllHLC = o.Field&amp;lt;decimal&amp;gt;("DowntimeHiAllHLC"),
                                //DowntimeAllStdHLC = o.Field&amp;lt;decimal&amp;gt;("AcceptedRatioHLC"),
                                DowntimeLoStdHLC = o.Field&amp;lt;decimal&amp;gt;("DowntimeLoStdHLC"),
                                DowntimeHiStdHLC = o.Field&amp;lt;decimal&amp;gt;("DowntimeHiStdHLC"),
                                //DowntimeAllXOneHLC = o.Field&amp;lt;decimal&amp;gt;("AcceptedRatioHLC"),
                                DowntimeLoXOneHLC = o.Field&amp;lt;decimal&amp;gt;("DowntimeLoXOneHLC"),
                                DowntimeHiXOneHLC = o.Field&amp;lt;decimal&amp;gt;("DowntimeHiXOneHLC"),
                                AttemptRatioHLC = o.Field&amp;lt;decimal&amp;gt;("AttemptRatioHLC")
                            };
                // Create a table from the query.
                DataTable boundTable = ConvertToDataTable(query);
                //Create the worksheet
                ExcelWorksheet ws = pck.Workbook.Worksheets["Dashboard"];

                ws.Cells["A2"].Value = ERSHelper.BuildCriteriaTitle(_crit).Replace("&amp;lt;b&amp;gt;", "").Replace("&amp;lt;/b&amp;gt;", "");
                ws.Cells["F6:F10000"].Style.Numberformat.Format = "#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.0";
                ws.Cells["I6:N10000"].Style.Numberformat.Format = "#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;";
                ws.Cells["O6:O10000"].Style.Numberformat.Format = "#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.0";

                //Load the datatable into the sheet, starting from cell A6
                ws.Cells["A6"].LoadFromDataTable(boundTable, false);

                try
                {
                    //Write it back to the client
                    Response.Clear();
                    Response.ContentType = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";
                    Response.AddHeader("content-disposition", "attachment;  filename=BTComparison.xlsx");
                    Response.BinaryWrite(pck.GetAsByteArray());
                    Response.End();
                }
                catch (Exception ex)
                {
                    if (!(ex is System.Threading.ThreadAbortException))
                    {
                        //Other error handling code here
                    }
                }
            }
            



        }&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Make nuget packages for .NET 4.0, .NET 4.5">
      <Posts>
        <Post From="Staeff" When="15/07/2013 14:20:48">
          <Html>
        &lt;div class="markDownOutput "&gt;I think both of them are around long enough to add compiled libraries for them.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Copy/Paste from one excel to another">
      <Posts>
        <Post From="ryannayr" When="11/07/2013 03:49:39">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
Is there's a way that can we copy and paste a range of data from one excel to another in EPPlus?
&lt;br&gt;
&lt;br&gt;
let's say we have a data on A1-A10 from excel 1 and I want to copy it to another excel in A1-A10 also.
&lt;br&gt;
&lt;br&gt;
Hope you can help me with this. &lt;br&gt;
&lt;br&gt;
-Ryan&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Performance problems with adding pictures">
      <Posts>
        <Post From="mat62" When="09/07/2013 19:16:16">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello, &lt;br&gt;
I try to create a Excel file with almost 10.000 rows and 5-6 colunns. Each row contains a small Icon (16x16 png). Adding rows do not take too much time for the first 1000-1500 rows (just a few seconds). For the rest of rows, it takes many minutes, until the
 file is created- &lt;br&gt;
&lt;br&gt;
Did anybody have the same Problem? Do you know the reason or solution of this Problem?
&lt;br&gt;
&lt;br&gt;
Thanks &lt;br&gt;
Mat&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="09/07/2013 19:36:50">
          <Html>
        &lt;div class="markDownOutput "&gt;Maybe this can help u... &lt;br&gt;
&lt;br&gt;
From Faq&lt;br&gt;
&lt;blockquote&gt;&lt;strong&gt;I have a lot of data I want to load. What should I think of to get the best performance?&lt;/strong&gt;&lt;br&gt;
If you have more than, let's say 5 000 cells in the sheet and experience performance problems, have this in mind...&lt;br&gt;
Always load cells from top to bottom left to right. That means that if you add a formula on the data you load, it's faster to add it for every row than to add it for a range after you have loaded the data (for ex. this will take a while,Worksheet.Cells"C1:C100000".Formula="A1+B1").&lt;br&gt;
If you want to use a shared formula, like the sample, make sure you create the cells in sequence (use something like worksheet.Cellsrow,forumlaColumn.Value=null to create the cell. Then you can add the formula after you have finished loading your data.&lt;br&gt;
Avoid using the InsertRow and DeleteRow methods.&lt;br&gt;
&lt;/blockquote&gt;
&lt;a href="http://epplus.codeplex.com/wikipage?title=FAQ&amp;amp;referringTitle=Documentation" rel="nofollow"&gt;http://epplus.codeplex.com/wikipage?title=FAQ&amp;amp;referringTitle=Documentation&lt;/a&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Current Date and Time in Excel Header">
      <Posts>
        <Post From="pravin_k_patil" When="09/07/2013 09:45:39">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello All,&lt;br&gt;
&lt;br&gt;
I am trying to use Current Date and Time in header, but it appears as a text like "&amp;amp;[Date] &amp;amp;[Time]". When I click on header then it displays date and time values.&lt;br&gt;
&lt;br&gt;
Any idea how to get rid of this? as I would get current date and time values as soon as I open it up.&lt;br&gt;
&lt;br&gt;
Regards,&lt;br&gt;
Pravin &lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="pravin_k_patil" When="09/07/2013 10:11:43">
          <Html>
        &lt;div class="markDownOutput "&gt;Hey, I got the solution for this, I was going in wrong direction, used &lt;strong&gt;
ExcelHeaderFooter.CurrentDate&lt;/strong&gt; + " " + &lt;strong&gt;ExcelHeaderFooter.Currentine&lt;/strong&gt; and its working perfectly.
&lt;br&gt;
&lt;br&gt;
Thanks&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Show percentage in stacked bar chart">
      <Posts>
        <Post From="gopimanikandan" When="09/07/2013 08:15:03">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi All,&lt;br&gt;
&lt;br&gt;
I have developed the stacked bar chart using EPPlus and able to show the data label value. But not able to show the percentages for each datalabels. I have tried the "chart.DataLabel.ShowPercent = true;" option to show the percentage, but it's not
 working&lt;br&gt;
&lt;br&gt;
here is the code:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;            var chart = Worksheet.Drawings.AddChart("BarStacked", eChartType.BarStacked) as ExcelBarChart;
            chart.Title.Text = "Stacked Bar Chart";
            chart.SetPosition(120, 50);
            chart.SetSize(800, 300);
            chart.Legend.Position = eLegendPosition.Right;
            chart.Legend.Add();
            chart.ShowHiddenData = true;

            chart.DataLabel.ShowValue = true;
            chart.DataLabel.ShowPercent = true;
            var chart = Worksheet.Drawings.AddChart("BarStacked", eChartType.BarStacked) as ExcelBarChart;
            chart.Title.Text = "Stacked Bar Chart";
            chart.SetPosition(120, 50);
            chart.SetSize(800, 300);
            chart.Legend.Position = eLegendPosition.Right;
            chart.Legend.Add();
            chart.ShowHiddenData = true;

            chart.DataLabel.ShowValue = true;
            chart.DataLabel.ShowPercent = true;

            var series1 = chart.Series.Add(Worksheet.Cells["B2:B5"], Worksheet.Cells["B1:E1"]);
            series1.Header = Worksheet.Cells["A2"].Value.ToString();

            var series2 = chart.Series.Add(Worksheet.Cells["C2:C5"], Worksheet.Cells["B1:E1"]);
            series2.Header = Worksheet.Cells["A3"].Value.ToString();

            var series3 = chart.Series.Add(Worksheet.Cells["D2:D5"], Worksheet.Cells["B1:E1"]);
            series3.Header = Worksheet.Cells["A4"].Value.ToString();

            var series4 = chart.Series.Add(Worksheet.Cells["E2:E5"], Worksheet.Cells["B1:E1"]);
            series4.Header = Worksheet.Cells["A5"].Value.ToString();
&lt;/code&gt;&lt;/pre&gt;
Please let me know, how to add the percentage on each stack?&lt;br&gt;
&lt;br&gt;
Thanks,&lt;br&gt;
Gopi&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to Dispose Cells from Memory">
      <Posts>
        <Post From="saurabhrajguru" When="08/07/2013 05:37:22">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello, &lt;br&gt;
This is a great library for Excel. &lt;br&gt;
&lt;br&gt;
But it came to situation when i have to read file and then dispose objects. &lt;br&gt;
The code is like below. &lt;br&gt;
The scenario is I read from Excel file as below. &lt;br&gt;
So the problem is even this function completes the memory is not released back which makes me
&lt;br&gt;
very near to "OutofMemory" if function run multiple times. &lt;br&gt;
So is there any way to dispose objects.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;            System.IO.FileInfo objFileInfo = new System.IO.FileInfo(sFilepath);
            Stream strTemp = null;

            using (strTemp = objFileInfo.Open(FileMode.Open, FileAccess.Read, FileShare.ReadWrite))
            {
                using (ExcelPackage objExcelPackage = new ExcelPackage())
                {
                    objExcelPackage.Load(strTemp);

                    ExcelWorkbook objExcelWorkbook = objExcelPackage.Workbook;

                    nSheetCount = GetWorkSheetCount(objExcelWorkbook);

                    for (int nIdx = 1; nIdx &amp;lt;= nSheetCount; nIdx++)
                    {
                        ExWorkSheet objExWorkSheet = new ExWorkSheet();
                        ExcelWorksheet objExcelWorksheet = objExcelWorkbook.Worksheets[nIdx];
                        objExWorkSheet.WorkSheetName = objExcelWorksheet.Name;
                        objExWorkSheet.UsedRange = GetUsedRange(objExcelWorksheet);

                        if (objExWorkSheet.UsedRange == null)
                        {
                            objExWorkSheet.Cells = new Dictionary&amp;lt;string, ExCell&amp;gt;();
                            lstExWorkSheet[nIdx - 1] = objExWorkSheet;
                            continue;
                        }

                        objExWorkSheet.Columns = GetColumns(objExcelWorksheet, objExWorkSheet.UsedRange);

                        objExWorkSheet.Rows = GetRows(objExcelWorksheet, objExWorkSheet.UsedRange);

                        objExWorkSheet.Cells = GetCells(objExcelWorksheet, objExWorkSheet.UsedRange);
                    }
                }
}&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to remove the gridlines from Worksheet?">
      <Posts>
        <Post From="1337_5P34K" When="03/07/2013 16:17:59">
          <Html>
        &lt;div class="markDownOutput "&gt;What can I do to remove the Excel-Worksheet-Gridlines? &lt;br&gt;
I tried &lt;br&gt;
&lt;pre&gt;&lt;code&gt;ExcelWorksheet ws = p.Workbook.Worksheets[1];
ws.Cells.Style.Border.Bottom.Style = ExcelBorderStyle.None;
ws.Cells.Style.Border.Top.Style = ExcelBorderStyle.None;
ws.Cells.Style.Border.Left.Style = ExcelBorderStyle.None;
ws.Cells.Style.Border.Right.Style = ExcelBorderStyle.None;&lt;/code&gt;&lt;/pre&gt;
but it doesn't work.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="1337_5P34K" When="04/07/2013 10:22:54">
          <Html>
        &lt;div class="markDownOutput "&gt;The answer is...&lt;br&gt;
&lt;pre&gt;&lt;code&gt;ws.View.ShowGridLines = false;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Package object was closed and disposed, so cannot carry out operations on this object or any stream opened on a part of this package.">
      <Posts>
        <Post From="webfriend13" When="29/08/2012 07:27:05">
          <Html>
        
&lt;p&gt;Hi All,&lt;/p&gt;
&lt;p&gt;I am using following code to write data into excel file:&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;var&lt;/span&gt; newFile = &lt;span style="color: blue;"&gt;new&lt;/span&gt; FileInfo(&lt;span style="color: rgb(163, 21, 21);"&gt;@"c:\temp\newTest.xlsx"&lt;/span&gt;);

            &lt;span style="color: blue;"&gt;var&lt;/span&gt; package = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(newFile);

            &lt;span style="color: green;"&gt;// add a new worksheet to the empty workbook&lt;/span&gt;
            &lt;span style="color: blue;"&gt;var&lt;/span&gt; worksheet = package.Workbook.Worksheets.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"Result"&lt;/span&gt;);
            //worksheet.Cells[1, 1].LoadFromDataTable(ds.Tables[0], &lt;span style="color: blue;"&gt;false&lt;/span&gt;);

            &lt;span style="color: blue;"&gt;int&lt;/span&gt; col = 1, row = 1;
            &lt;span style="color: blue;"&gt;foreach&lt;/span&gt; (DataRow dr &lt;span style="color: blue;"&gt;in&lt;/span&gt; ds.Tables[0].Rows)
            {
                &lt;span style="color: blue;"&gt;foreach&lt;/span&gt; (&lt;span style="color: blue;"&gt;object&lt;/span&gt; value &lt;span style="color: blue;"&gt;in&lt;/span&gt; dr.ItemArray)
                {
                    worksheet.Cells[row, col++].Value = value;
                }
                &lt;span style="color: blue;"&gt;if&lt;/span&gt; (row == 10000)
                {
                    package.Save();
                }
                row++;
                col = 1;
            }

            package.Save();
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;When I try to save the data second time, i get "Package object was closed and disposed" error. I am trying to process the data into batch's. Currently in my system, when I try to write more than 8 million cells, I get memory exception. SO I was
 thinking of writing data into excel in batch's. The idea is to write "N" number of records into excel and then save the file. Is it possible to achieve this behavior?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="29/08/2012 12:17:41">
          <Html>
        
&lt;p&gt;No, it is impossible and I don´t think partial load/save will be supported soon. ( Maybe never, in my conception, it is a huge refactoring in epplus core, only Jan or Mats can answer this )&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="31/08/2012 07:16:12">
          <Html>
        
&lt;p&gt;No, I have some plans for memory optimazation, but not partial save/streaming.&lt;/p&gt;
&lt;p&gt;If you have a lot of data, make sure you have memory enought, run on a 64 bit system (32 bit limits memory to about 4GB), and of course that you have compiled your component for x64.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="kpstolk" When="04/07/2013 08:34:24">
          <Html>
        &lt;div class="markDownOutput "&gt;So it is not possible to save and leave the package open? &lt;br&gt;
&lt;br&gt;
If not, the package can not be reopened to write other data?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Problem saving with multi-sheet template">
      <Posts>
        <Post From="borotaur" When="03/07/2013 09:40:24">
          <Html>
        &lt;div class="markDownOutput "&gt;Scenario: opening a template xlsx with multiple sheets on it, writing some values to first sheet, then calling SaveAs ( ... ). This worked just fine until I added those extra worksheets on the template.
&lt;br&gt;
&lt;br&gt;
Any ideas, apart from just not having multiple sheets on my template?&lt;br&gt;
&lt;br&gt;
EDIT: Modifying the template over and over again, I managed to track whatever crashes saving the file into some styles/comments used in one of the extra worksheets. Pretty standard Excel stuff, but I guess there was something among them that doesn't sit well
 with OpenOfficeXml. While my problem has been evaded, I'll leave this thread here, just in case anyone gets same error or just wants to dig to the roots of the issue.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;System.InvalidOperationException was unhandled
  HResult=-2146233079
  Message=Error saving file C:\....aco.xlsx
  Source=EPPlus
  StackTrace:
    at OfficeOpenXml.ExcelPackage.Save()
    at OfficeOpenXml.ExcelPackage.SaveAs(FileInfo file)
    ...

InnerException: System.InvalidOperationException
   HResult=-2146233079
   Message=Cannot add part for the specified URI because it is already in the package.
   Source=WindowsBase
   StackTrace:
        at System.IO.Packaging.Package.CreatePart(Uri partUri, String contentType, CompressionOption compressionOption)
        at OfficeOpenXml.ExcelWorksheet.SaveComments()
        at OfficeOpenXml.ExcelWorksheet.Save()
        at OfficeOpenXml.ExcelWorkbook.Save()
        at OfficeOpenXml.ExcelPackage.Save()
   InnerException: &lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="EPPlus Barchart bars not showing colors for negative value in Excel 2013, but works fine in Excel 2007">
      <Posts>
        <Post From="sumeshkuttan" When="02/07/2013 12:50:07">
          <Html>
        &lt;div class="markDownOutput "&gt;I am using a BarClustered chart using EPPlus for Excel Package in C#. I am able to generate the bar chart as required. Only problem I am facing is that when I have a negative value, the bar does not show any color. It would be as if a transparent bar with
 only the border. &lt;br&gt;
&lt;br&gt;
I am facing this issue with Excel 2013. However this works fine in Excel 2007. &lt;br&gt;
I am using EPPlus version 3.0.0.2 &lt;br&gt;
&lt;br&gt;
ExcelWorksheet wsDataSource = xlPackage.Workbook.Worksheets.Add("DataSource");
&lt;br&gt;
wsDataSource.Hidden = eWorkSheetHidden.VeryHidden; &lt;br&gt;
var namedStyle = xlPackage.Workbook.Styles.CreateNamedStyle("HyperLink");
&lt;br&gt;
namedStyle.Style.Font.UnderLine = true; &lt;br&gt;
namedStyle.Style.Font.Color.SetColor(Color.Blue); &lt;br&gt;
&lt;br&gt;
//Here I iterate through an array and populate the wsDataSource values as below starting from 3rd row:
&lt;br&gt;
Feb 2000 5000 &lt;br&gt;
March -2000 2770 &lt;br&gt;
April 4000 4643 &lt;br&gt;
&lt;br&gt;
var chart = worksheet.Drawings.AddChart("Chart", OfficeOpenXml.Drawing.Chart.eChartType.BarClustered);
&lt;br&gt;
//row is the offset int variable &lt;br&gt;
chart.SetPosition(row + 2, 0, 0, 10); &lt;br&gt;
chart.SetSize(750, 30); &lt;br&gt;
chart.Title.Text = "Data Graph"; &lt;br&gt;
chart.Legend.Position = eLegendPosition.Top; &lt;br&gt;
var barChart = chart as ExcelBarChart; &lt;br&gt;
barChart.DataLabel.ShowValue = true; &lt;br&gt;
&lt;br&gt;
var mySeries = chart.Series.Add(wsDataSource.Cells[3, 2, intDataRow - 1, 2], wsDataSource.Cells[3, 1, intDataRow - 1, 1]);
&lt;br&gt;
mySeries.Header = "Current Year"; &lt;br&gt;
&lt;br&gt;
//isPreviousYearDataAvailable is a boolean which indicates if previous year data for the user is available.
&lt;br&gt;
if (isPreviousYearDataAvailable) &lt;br&gt;
{ &lt;br&gt;
var mySeries2 = chart.Series.Add(wsDataSource.Cells[3, 3, intDataRow, 3], wsDataSource.Cells[3, 1, intDataRow - 1, 1]);
&lt;br&gt;
mySeries2.Header = "Previous Year" &lt;br&gt;
} &lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="EPPlus creating 0KB file with 200000 records">
      <Posts>
        <Post From="vyasanand" When="29/06/2013 10:40:30">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi Team, &lt;br&gt;
&lt;br&gt;
I am trying to use EPPlus DLL to export the records to the excel. My record count is 2,00,000. However, the file created is of 0KB.
&lt;br&gt;
&lt;br&gt;
Not sure what is happening? &lt;br&gt;
&lt;br&gt;
I have merged the latest code with &lt;a href="https://epplus.codeplex.com/workitem/14762" rel="nofollow"&gt;
https://epplus.codeplex.com/workitem/14762&lt;/a&gt; as it solves one of the issue i was facing.
&lt;br&gt;
&lt;br&gt;
Can someone please help? &lt;br&gt;
&lt;br&gt;
Regards, &lt;br&gt;
Anand Vyas&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to export as image?">
      <Posts>
        <Post From="VerbukArtem" When="27/06/2013 07:09:34">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi guys. &lt;br&gt;
I am using EPPlus to build quite complicated reports. ANd it is great for doing so.
&lt;br&gt;
But I have another feature that I have to implement. I need to implement creation of .docx document from the report mentioned above. So, for example I need to be able to pivot table from Excel file to .docx.
&lt;br&gt;
Is it possible to do so using EPPlus? I don't need "smart" export, stupid conversion to image is enough for me. So is there something like&lt;br&gt;
&lt;pre&gt;&lt;code&gt;            var path = @"C:\Users\Administrator\Desktop\TEST.xlsx";
            using (var pkg = new ExcelPackage(new FileInfo(path)))
            {
                var ws = pkg.Workbook.Worksheets.First();
                var pivotTableImage = ws.PivotTables[0].ToImage();

            }&lt;/code&gt;&lt;/pre&gt;
?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Cell formating">
      <Posts>
        <Post From="yog2411" When="24/06/2013 20:33:18">
          <Html>
        &lt;div class="markDownOutput "&gt;May I know how can I convert a decimal (eg: 33.3333333333333,100,50) to percent format.
&lt;br&gt;
I have tried with this code: &lt;br&gt;
&lt;br&gt;
﻿﻿ws.Cells[1,1].Value = 33.3333333333333; &lt;br&gt;
ws.Cells[1.1].Style.Numberformat.Format = "0.00%"; &lt;br&gt;
&lt;br&gt;
But this give me 33% instead of 3333.33% &lt;br&gt;
Also i would like to see the values 100.00% &amp;amp; 50.00% respectively.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="priesdelly" When="27/06/2013 05:49:29">
          <Html>
        &lt;div class="markDownOutput "&gt;Try &lt;br&gt;
&lt;br&gt;
﻿﻿ws.Cells[1,1].Value = 33.3333333333333; &lt;br&gt;
ws.Cells[1,1].Style.Numberformat.Format = "&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00%"; &lt;br&gt;
&lt;br&gt;
:)&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Resize row height with multiline cell">
      <Posts>
        <Post From="deverion" When="25/06/2013 12:31:43">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi! &lt;br&gt;
&lt;br&gt;
Could you tell me please &lt;strong&gt;if there is a way&lt;/strong&gt; to set the correct &lt;strong&gt;
height&lt;/strong&gt; of the rows containing multiline cells to show the entire text in cells.
&lt;br&gt;
&lt;br&gt;
Cell.Style.WrapText is set, the text is OK, but I have to resize the rows manually in Excel to see the whole text.
&lt;br&gt;
&lt;br&gt;
Thank you!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Different Fonts - In-particular Wingdings">
      <Posts>
        <Post From="Nitric" When="21/06/2013 16:05:45">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
So I'm trying to use the EPPlus dll to output a xlsx workbook for a report. &lt;br&gt;
One of the requirements its to display &lt;em&gt;char(254)&lt;/em&gt; in Wingdings (which should be a checkbox with a tick in it). However, when I open the generated spreadsheet I am seeing "&lt;strong&gt;þ&lt;/strong&gt;" instead of the check box, even though the font set
 on the cell is wingdings. &lt;br&gt;
&lt;br&gt;
If I click in the font box in excel and press return, the &lt;strong&gt;þ&lt;/strong&gt; changes to the appropriate symbol.
&lt;br&gt;
&lt;br&gt;
Has anyone seen anything like this before, or have any form of explanation? &lt;br&gt;
&lt;br&gt;
&lt;em&gt;Code to generate the style:&lt;/em&gt;&lt;br&gt;
&lt;pre&gt;&lt;code&gt;var checkBoxStyle = package.Workbook.Styles.CreateNamedStyle("checkBox");
checkBoxStyle.Style.Font.SetFromFont(new System.Drawing.Font("Wingdings",10));&lt;/code&gt;&lt;/pre&gt;
&lt;em&gt;Code setting the cell value:&lt;/em&gt;&lt;br&gt;
&lt;pre&gt;&lt;code&gt;worksheet.Cells[rowCount, colCount].Value = Char.ConvertFromUtf32(254);
worksheet.Cells[rowCount, colCount].StyleName = checkBoxStyle.Name;&lt;/code&gt;&lt;/pre&gt;
I'm really not sure what I'm doing wrong.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Comma separated values coming in separae columns">
      <Posts>
        <Post From="saroj641" When="19/06/2011 16:14:21">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I am generating excel on the fly using EPPLUS. I am taking values from SQL database and putting it to excel. The problem is, i have database column which is having comma separated values like "a, b". "11111, 222222". etc When generating excel it should appear
 in only one column however its appearing in two columns e.g. "a" in one column and "b" in separate column. I checked all types of formatting to excel column but, it still coming in separate column. My question is, what i am doing wrong?? how can i get comma
 separated value to appear in just one cell??? Any help will be appreciated.&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="22/06/2011 19:31:12">
          <Html>
        
&lt;p&gt;Sounds strange, can you provide&amp;nbsp;some code how you do?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="armdan" When="03/05/2013 11:51:20">
          <Html>
        &lt;div class="markDownOutput "&gt;I have the same problem; here is my code:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;using (ExcelPackage pck = new ExcelPackage())
{
   //Create the worksheet
   ExcelWorksheet ws = pck.Workbook.Worksheets.Add("MySheet");
   using (ExcelRange range = ws.Cells[1, 1])
   {
      range.LoadFromText("this works");
   }
   using (ExcelRange range = ws.Cells[1, 2])
   {
      range.LoadFromText("this, splits my , text in 3 parts");
   }
}&lt;/code&gt;&lt;/pre&gt;
what I'm doing wrong?&lt;br&gt;
Thank you.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="jayschm" When="20/06/2013 14:46:28">
          <Html>
        &lt;div class="markDownOutput "&gt;You could try creating a new format and setting its delimiter, e.g.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;            var format = new ExcelTextFormat();
            format.Delimiter = '$'; // default is the comma
            range.LoadFromText("this, splits my, text in 3 parts", format);
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="View Excel sheet in ASP.NET page">
      <Posts>
        <Post From="rubenrav" When="19/06/2013 20:53:19">
          <Html>
        &lt;div class="markDownOutput "&gt;I see this is a quite powerful tool for making spreadsheets, but is there a way to just show a spreadsheet, in stead of downloading it?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Cannot open password protected file (Excel 2007)">
      <Posts>
        <Post From="dorakay" When="28/03/2013 11:14:31">
          <Html>
        &lt;div class="markDownOutput "&gt;I try to open the package with password specified but the "Invalid password" exception shown up.&lt;br&gt;
With the same password, I can unprotect workbook when open in Excel 2007.&lt;br&gt;
Does anyone experience this problem? How can I read this protected workbook?&lt;br&gt;
&lt;br&gt;
Below is my code snippet:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;using (FileStream fileStream = new FileStream(filePath, FileMode.OpenOrCreate, FileAccess.ReadWrite))
{
    using(var package = new ExcelPackage(fileStream, "password"))
    {&lt;/code&gt;&lt;/pre&gt;
Thank you in advance.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="BVictor" When="21/05/2013 13:20:06">
          <Html>
        &lt;div class="markDownOutput "&gt;I have the same issue. The unlock works in Excel 2010, but not within the Framework.
&lt;br&gt;
&lt;br&gt;
Besides, after the exception "Invalid Password" is thrown, the file remains stuck inside the process. (not sure if the framework has something to do about this.)
&lt;br&gt;
&lt;br&gt;
Did you find a solution?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="dorakay" When="22/05/2013 12:40:25">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi BVictor, &lt;br&gt;
&lt;br&gt;
I still found no solution to this problem. &lt;br&gt;
&lt;br&gt;
Regards,&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="BVictor" When="18/06/2013 12:22:13">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi again. &lt;br&gt;
I did some further searching and a bit of trial and error and I got it to work. It's a strange solution though:
&lt;br&gt;
&lt;br&gt;
new ExcelPackage(filePath, ""); &lt;br&gt;
&lt;br&gt;
I had a sheet protection and a workbook protection. The password used to unlock the file in MS Office Excel was useless with EPPlus. The EEPLus protection / encryption seems to be somewhat different than the Office protection.
&lt;br&gt;
&lt;br&gt;
Keep in mind, though, that if the xlsx file is not protected, using the constructor with an empty string as password will generate an exception. You can implement a method that tries to open the file as unprotected within a try block and as protected in the
 catch block. &lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Add comment, how to set the height and width?">
      <Posts>
        <Post From="zestxjest" When="18/06/2013 06:53:30">
          <Html>
        &lt;div class="markDownOutput "&gt;How can i set the height and width to the comment box? &lt;br&gt;
Anyone can help? &lt;br&gt;
Thanks.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to select maximum number of rows and columns">
      <Posts>
        <Post From="pkeyuda1" When="17/06/2013 21:37:03">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello, I am using this library to create a report in a spreadsheet (and what a fantastic library it has been for me!). What I would like to do now that I have my information in the spreadsheet is to hide all rows and columns around the blocked off range
 of cells which contain my report information and formatting. From looking around in other posts, I came across the dimension property of a worksheet. Unfortunately, worksheet.dimension.end.column does not provide me with the absolute end of the spreadsheet,
 but rather what seemed to be my last used cell. The action can be manually done in excel by selecting a cell and pressing ctrl + shift + right arrow for columns and ctrl + shift + down arrow for rows. Any help is greatly appreciated.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Using parallel task library to write to excel worksheet">
      <Posts>
        <Post From="AgentD5" When="17/06/2013 15:41:35">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi all, &lt;br&gt;
I am getting a data table back from a query. I then want to just write this data to an excel work sheet and save the file. I know there is
&lt;br&gt;
worksheet.Cells["A1"].LoadFromDataTable(dt, true); &lt;br&gt;
But I have dates that get incorrectly formatted when i use that. &lt;br&gt;
So I am trying to iterate through the rows and cells myself. However, I wanted to speed it up (I have 49,000 rows and 350+ columns), so I thought I'd trying using paraellelism since each row is indpendent of others. is this possible? When I try i get out of
 bounds exceptions. Here is my code. &lt;br&gt;
int rowCount = dt.Rows.Count;&lt;br&gt;
&lt;pre&gt;&lt;code&gt;            System.Threading.Tasks.Parallel.For(1, rowCount, x =&amp;gt;
            {
                    {
                    dr = dt.Rows[x];
                    for (int i = 0; i &amp;lt; iColCount; i++)
                    {
                        if (!Convert.IsDBNull(dr[i]))
                        {
                            //if (dr[i] is DateTime)
                            ExcelRange cell = worksheet.Cells[x + 1, i + 1];
                            if (isDates[i])
                                cell.Value = ((DateTime)dr[i]).ToShortDateString();
                            else
                                cell.Value = dr[i];
                            cell.Dispose();
                        }
                    }
                    }
                });
&lt;/code&gt;&lt;/pre&gt;
thanks, &lt;br&gt;
Dave&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to Escape special characters?">
      <Posts>
        <Post From="ojm37a" When="19/07/2010 19:40:20">
          <Html>
        
&lt;p&gt;How can I, using EPPlus, make sure that ALL text I put into a cell is escaped (for example, someone accidentally had the following in a title field: "Domestic Violence&amp;amp;#xB; and the&amp;nbsp;Professional". Excel complained about the &amp;amp;#xB; and
 would not load the file until I got rid of it, saying that there was an invalid character in the sharedstrings.xml, line 139 col 29 (right before the ";" in the above title).&lt;/p&gt;
&lt;p&gt;So, how can I make sure that, if anything like this happens again, excel won't choke?&lt;/p&gt;
&lt;p&gt;Thanks,&lt;br&gt;
Owen&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="20/07/2010 09:13:07">
          <Html>
        
&lt;p&gt;Sounds like a bug. I'll have a look at it when I get back from my vaccation&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="juan_camilo_r" When="28/01/2011 04:29:33">
          <Html>
        
&lt;p&gt;I'm having the same issue. Is there any update?&lt;br&gt;
&lt;br&gt;
Thanks in Advance.&lt;br&gt;
&lt;br&gt;
&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="30/01/2011 18:29:48">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I could not reproduce this bug. I'm not sure if this is the same problem as this issue...&lt;/p&gt;
&lt;p&gt;&lt;a href="http://epplus.codeplex.com/workitem/12706" rel="nofollow"&gt;http://epplus.codeplex.com/workitem/12706&lt;/a&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;If not, can you provide me with a failing sample?&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="sharandeep11" When="03/05/2013 13:58:53">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi,&lt;br&gt;
&lt;br&gt;
I found exception like this &lt;strong&gt;'&#x1F;', hexadecimal value 0x1F, is an invalid character&lt;/strong&gt; while exporting to Excel 2007&lt;br&gt;
&lt;br&gt;
I am using EPPlus version 3.0.0.2&lt;br&gt;
&lt;br&gt;
if anybody know this type of issue reply me...&lt;br&gt;
&lt;br&gt;
Thanking You&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Sharandeep&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="sharandeep11" When="30/05/2013 13:37:36">
          <Html>
        &lt;div class="markDownOutput "&gt;hi, &lt;br&gt;
&lt;br&gt;
in database i have data like this: " May 30 11:15:16 minnie G&#x3;&#x1;Q¦ßŽu€ÃèHeW¡€ö¦Är®–K`:7Ù&#x1F;ãº?Yœ&amp;gt; "
&lt;br&gt;
it contains several special characters.. when i export this data to excel (.xlsx) 2007 format using EPPlus 3.0.02 its creating excel file..
&lt;br&gt;
&lt;br&gt;
But the problem is when i tried to open the exported excel sheet its showing "Excel found unreadable content cant able to open the excel would you like to repair?
&lt;br&gt;
&lt;br&gt;
if i click Yes its opening excel sheet but data in particular cell that spl charactrs has to fill is showing blank..
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
whats is the solution for this? &lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="sharandeep11" When="14/06/2013 11:03:20">
          <Html>
        &lt;div class="markDownOutput "&gt;hi, &lt;br&gt;
&lt;br&gt;
in database i have data like this: " May 30 11:15:16 minnie G&#x3;&#x1;Q¦ßŽu€ÃèHeW¡€ö¦Är®–K`:7Ù&#x1F;ãº?Yœ&amp;gt; "
&lt;br&gt;
it contains several special characters.. when i export this data to excel (.xlsx) 2007 format using EPPlus 3.0.02 its creating excel file..
&lt;br&gt;
&lt;br&gt;
But the problem is when i tried to open the exported excel sheet its showing "Excel found unreadable content cant able to open the excel would you like to repair?
&lt;br&gt;
&lt;br&gt;
if i click Yes its opening excel sheet but data in particular cell that spl charactrs has to fill is showing blank..
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
whats is the solution for this? &lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="PivotTable - RowField 'Show Item labels in tabular form' set">
      <Posts>
        <Post From="yeanth" When="08/06/2013 15:57:45">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi all, &lt;br&gt;
is anybody in there who can help me to know if and how it is possible to set the property of a RowField
&lt;strong&gt;''Show Item labels in tabular form'&lt;/strong&gt; as it is available to set &lt;br&gt;
&lt;br&gt;
[Display subtotal at the top of each group] property&lt;br&gt;
&lt;pre&gt;&lt;code&gt;pivotTable2.RowFields[0].SubtotalTop = false;&lt;/code&gt;&lt;/pre&gt;
? &lt;br&gt;
&lt;br&gt;
Thanks in advance &lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="yeanth" When="08/06/2013 21:56:54">
          <Html>
        &lt;div class="markDownOutput "&gt;To who is interested in this thread: I found the following link that answer the question
&lt;br&gt;
&lt;br&gt;
&lt;a href="http://s1865.socode.info/question/50813b194f1eba38a43682d6" rel="nofollow"&gt;http://s1865.socode.info/question/50813b194f1eba38a43682d6&lt;/a&gt;&lt;br&gt;
&lt;pre&gt;&lt;code&gt;pivotTable.Compact = false;
pivotTable.CompactData = false;
pivotTable.Indent = 0;
pivotTable.RowGrandTotals = false;
pivotTable.UseAutoFormatting = true;
pivotTable.ShowMemberPropertyTips = false;
pivotTable.DataOnRows = false;

field.Outline = false;
field.Compact = false;
field.ShowAll = false;
field.SubtotalTop = false;
&lt;/code&gt;&lt;/pre&gt;
this code set in tabular layout all the fields selected to RowFields.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="writing to different worksheets at the same time">
      <Posts>
        <Post From="Simon2013" When="06/06/2013 16:07:33">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi! &lt;br&gt;
&lt;br&gt;
I want to write same data to different worksheets in one Loop. &lt;br&gt;
so here is an example:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;FileInfo template = new FileInfo(file);
FileInfo newFile = null;
OfficeOpenXml.ExcelPackage excelpackage = null;
OfficeOpenXml.ExcelWorksheet worksheet = null;

foreach(...)
{
      newFile = new FileInfo(....);
      excelpackage = new OfficeOpenXml.ExcelPackage(newFile, template);
      worksheet = excelpackage.Workbook.Worksheets["Sheet"]; 
      worksheet_2 = excelpackage.Workbook.Worksheets["Sheet_2"];

      worksheet.Cells[1, 1].Value = "some Value";

      worksheet_2.Cells[2, 2].Value = "some other Value";

      excelpackage.Save();                
}&lt;/code&gt;&lt;/pre&gt;
but this does not work. Any idea how to solve this ? &lt;br&gt;
&lt;br&gt;
thanks &lt;br&gt;
Simon&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="HTML formatted Cell - PasteSpecial">
      <Posts>
        <Post From="BugNuker" When="23/04/2013 23:08:54">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello all, &lt;br&gt;
I'm using the EPPlus Library with great success. However, I have the need where I need to put some dynamic HTML inside a cell.
&lt;br&gt;
&lt;br&gt;
I've tried setting richText = true; but this will not deal with HTML formatting. &lt;br&gt;
&lt;br&gt;
I've seen several things about using "PasteSpecial" but this was for the COM object to play with Excel documents.
&lt;br&gt;
I don't even have a file on the hard drive, I am doing all my work inside a memory stream.
&lt;br&gt;
&lt;br&gt;
If anyone has any idea how to put HTML inside a cell and have Excel render that html, or have a way to "PasteSpecial" using EPPlus, I would be very greatful.
&lt;br&gt;
Thanks &lt;br&gt;
-Shane&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="bioscomsoft" When="05/06/2013 18:59:32">
          <Html>
        &lt;div class="markDownOutput "&gt;Having similar issue. I am using FreeTextBox control from &lt;a href="http://www.freetextbox.com" rel="nofollow"&gt;
www.freetextbox.com&lt;/a&gt;. While retrieving my dataset to have EPPLUS render it into excel file as "it is", the HTML tagges are rendered into the excel file.
&lt;br&gt;
&lt;br&gt;
Please if there is anyone that has solution to make EPPLUS render into excel rather than the HTML will be greatly appreciated.
&lt;br&gt;
&lt;br&gt;
Thanks. &lt;br&gt;
&lt;br&gt;
Isaac.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Help with Epplus function">
      <Posts>
        <Post From="gte" When="23/06/2011 05:20:59">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Using the below example, I am trying to have:&lt;/p&gt;
&lt;p&gt;A method that creates the excel document/writes the header fields (row 1)&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; createWorkBook()&lt;/p&gt;
&lt;p&gt;A method that writes the data cell by cell&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
 &amp;nbsp;&amp;nbsp; writeCells()&lt;/p&gt;
&lt;p&gt;A method that closes the document and saves it&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
 closeWorkBook()&lt;/p&gt;
&lt;p&gt;I have the code below tweaked and almost except I'm not sure what this part does besides break my method :) . I can only add the worksheet once (when I create it), but need to have it defined as an existing workbook for the writeCells() and closeWorkBook()
 methods.&lt;/p&gt;
&lt;pre style="padding-left: 30px;"&gt;&lt;br&gt; " &lt;span style="color: blue;"&gt;var&lt;/span&gt; ws = package.Workbook.Worksheets.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"Performance Test"&lt;/span&gt;); "&lt;br&gt;&lt;br&gt;&lt;br&gt;Does anyone have an examples, something like ...&lt;br&gt;&lt;br&gt;public static createWorkBook(string directory, string fileName, int row, int column, string[] excelHeaders)&lt;br&gt;{&lt;br&gt;&lt;br&gt;}&lt;br&gt;&lt;br&gt;public static writeCells(int row, int column, string[] data)&lt;br&gt;{&lt;br&gt;&lt;br&gt;}&lt;br&gt;&lt;/pre&gt;
&lt;pre style="padding-left: 30px;"&gt;public static closeWorkBook(string directory, string fileName, string password)&lt;br&gt;{&lt;br&gt;&lt;br&gt;}&lt;br&gt;&lt;br&gt;&lt;br&gt;Thanks for reading!&lt;br&gt;&lt;br&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;using&lt;/span&gt; System;&lt;br&gt;&lt;span style="color: blue;"&gt;using&lt;/span&gt; System.Collections.Generic;&lt;br&gt;&lt;span style="color: blue;"&gt;using&lt;/span&gt; System.Text;&lt;br&gt;&lt;span style="color: blue;"&gt;using&lt;/span&gt; System.IO;&lt;br&gt;&lt;span style="color: blue;"&gt;using&lt;/span&gt; OfficeOpenXml;&lt;br&gt;&lt;span style="color: blue;"&gt;using&lt;/span&gt; OfficeOpenXml.Style;&lt;br&gt;&lt;span style="color: blue;"&gt;using&lt;/span&gt; System.Drawing;&lt;br&gt;&lt;span style="color: blue;"&gt;namespace&lt;/span&gt; EPPlusSamples&lt;br&gt;{&lt;br&gt;    &lt;span style="color: blue;"&gt;class&lt;/span&gt; Sample7&lt;br&gt;    {&lt;br&gt;        &lt;span style="color: gray;"&gt;///&lt;/span&gt; &lt;span style="color: gray;"&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;&lt;br&gt;        &lt;span style="color: gray;"&gt;///&lt;/span&gt;&lt;span style="color: green;"&gt; This sample load a number of rows, style them and insert a row at the top.&lt;/span&gt;&lt;br&gt;        &lt;span style="color: gray;"&gt;///&lt;/span&gt;&lt;span style="color: green;"&gt; A password is set to protect locked cells. Column 3 &amp;amp; 4 will be editable, the rest will be locked.&lt;/span&gt;&lt;br&gt;        &lt;span style="color: gray;"&gt;///&lt;/span&gt; &lt;span style="color: gray;"&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;&lt;br&gt;        &lt;span style="color: gray;"&gt;///&lt;/span&gt; &lt;span style="color: gray;"&gt;&amp;lt;param name="outputDir"&amp;gt;&lt;/span&gt;&lt;span style="color: gray;"&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;&lt;br&gt;        &lt;span style="color: gray;"&gt;///&lt;/span&gt; &lt;span style="color: gray;"&gt;&amp;lt;param name="Rows"&amp;gt;&lt;/span&gt;&lt;span style="color: gray;"&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;&lt;br&gt;        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;static&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; RunSample7(DirectoryInfo outputDir, &lt;span style="color: blue;"&gt;int&lt;/span&gt; Rows)&lt;br&gt;        {&lt;br&gt;            FileInfo newFile = &lt;span style="color: blue;"&gt;new&lt;/span&gt; FileInfo(outputDir.FullName + &lt;span style="color: rgb(163, 21, 21);"&gt;@"\sample7.xlsx"&lt;/span&gt;);&lt;br&gt;            &lt;span style="color: blue;"&gt;if&lt;/span&gt; (newFile.Exists)&lt;br&gt;            {&lt;br&gt;                newFile.Delete();  &lt;span style="color: green;"&gt;// ensures we create a new workbook&lt;/span&gt;&lt;br&gt;                newFile = &lt;span style="color: blue;"&gt;new&lt;/span&gt; FileInfo(outputDir.FullName + &lt;span style="color: rgb(163, 21, 21);"&gt;@"\sample7.xlsx"&lt;/span&gt;);&lt;br&gt;            }&lt;br&gt;&lt;br&gt;            ExcelPackage package = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage();&lt;br&gt;            Console.WriteLine(&lt;span style="color: rgb(163, 21, 21);"&gt;"{0:HH.mm.ss}\tStarting..."&lt;/span&gt;, DateTime.Now);&lt;br&gt;&lt;br&gt;            &lt;span style="color: green;"&gt;//Load the sheet with one string column, one date column and a few random numbers.&lt;/span&gt;&lt;br&gt;            &lt;span style="color: blue;"&gt;var&lt;/span&gt; ws = package.Workbook.Worksheets.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"Performance Test"&lt;/span&gt;);&lt;br&gt;&lt;br&gt;            &lt;span style="color: green;"&gt;//Format all cells&lt;/span&gt;&lt;br&gt;            ExcelRange cols = ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A:XFD"&lt;/span&gt;];&lt;br&gt;            cols.Style.Fill.PatternType = ExcelFillStyle.Solid;&lt;br&gt;            cols.Style.Fill.BackgroundColor.SetColor(Color.LightGray);&lt;br&gt;&lt;br&gt;            &lt;span style="color: blue;"&gt;var&lt;/span&gt; rnd = &lt;span style="color: blue;"&gt;new&lt;/span&gt; Random();&lt;br&gt;            &lt;span style="color: blue;"&gt;for&lt;/span&gt; (&lt;span style="color: blue;"&gt;int&lt;/span&gt; row = 1; row &amp;lt;= Rows; row++)&lt;br&gt;            {&lt;br&gt;                ws.SetValue(row, 1, row);                               &lt;span style="color: green;"&gt;//The SetValue method is a little bit faster than using the Value property&lt;/span&gt;&lt;br&gt;                ws.SetValue(row, 2, &lt;span style="color: blue;"&gt;string&lt;/span&gt;.Format(&lt;span style="color: rgb(163, 21, 21);"&gt;"Row {0}"&lt;/span&gt;, row));&lt;br&gt;                ws.SetValue(row, 3, DateTime.Today.AddDays(row));&lt;br&gt;                ws.SetValue(row, 4, rnd.NextDouble() * 10000);&lt;br&gt;&lt;br&gt;                ws.Cells[row, 5].FormulaR1C1 = &lt;span style="color: rgb(163, 21, 21);"&gt;"RC[-4]+RC[-1]"&lt;/span&gt;;&lt;br&gt;&lt;br&gt;                &lt;span style="color: blue;"&gt;if&lt;/span&gt; (row % 10000 == 0)&lt;br&gt;                {&lt;br&gt;                    Console.WriteLine(&lt;span style="color: rgb(163, 21, 21);"&gt;"{0:HH.mm.ss}\tWriting row {1}..."&lt;/span&gt;, DateTime.Now, row);&lt;br&gt;                }&lt;br&gt;            }&lt;br&gt;            &lt;span style="color: green;"&gt;//Add a sum at the end&lt;/span&gt;&lt;br&gt;            ws.Cells[Rows + 1, 5].Formula = &lt;span style="color: blue;"&gt;string&lt;/span&gt;.Format(&lt;span style="color: rgb(163, 21, 21);"&gt;"Sum({0})"&lt;/span&gt;, &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelAddress(1, 5, Rows, 5).Address);&lt;br&gt;            ws.Cells[Rows + 1, 5].Style.Font.Bold = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;&lt;br&gt;            ws.Cells[Rows + 1, 5].Style.Numberformat.Format = &lt;span style="color: rgb(163, 21, 21);"&gt;"#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00"&lt;/span&gt;;&lt;br&gt;&lt;br&gt;            Console.WriteLine(&lt;span style="color: rgb(163, 21, 21);"&gt;"{0:HH.mm.ss}\tWriting row {1}..."&lt;/span&gt;, DateTime.Now, Rows);&lt;br&gt;            Console.WriteLine(&lt;span style="color: rgb(163, 21, 21);"&gt;"{0:HH.mm.ss}\tFormating..."&lt;/span&gt;, DateTime.Now);&lt;br&gt;            &lt;span style="color: green;"&gt;//Format the date and numeric columns&lt;/span&gt;&lt;br&gt;            ws.Cells[1, 1, Rows, 1].Style.Numberformat.Format = &lt;span style="color: rgb(163, 21, 21);"&gt;"#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;"&lt;/span&gt;;&lt;br&gt;            ws.Cells[1, 3, Rows, 3].Style.Numberformat.Format = &lt;span style="color: rgb(163, 21, 21);"&gt;"YYYY-MM-DD"&lt;/span&gt;;&lt;br&gt;            ws.Cells[1, 4, Rows, 5].Style.Numberformat.Format = &lt;span style="color: rgb(163, 21, 21);"&gt;"#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00"&lt;/span&gt;;&lt;br&gt;&lt;br&gt;            Console.WriteLine(&lt;span style="color: rgb(163, 21, 21);"&gt;"{0:HH.mm.ss}\tInsert a row at the top..."&lt;/span&gt;, DateTime.Now);&lt;br&gt;            &lt;span style="color: green;"&gt;//Insert a row at the top. Note that the formula-addresses are shifted down&lt;/span&gt;&lt;br&gt;            ws.InsertRow(1, 1);&lt;br&gt;&lt;br&gt;            &lt;span style="color: green;"&gt;//Write the headers and style them&lt;/span&gt;&lt;br&gt;            ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"Index"&lt;/span&gt;;&lt;br&gt;            ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"B1"&lt;/span&gt;].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"Text"&lt;/span&gt;;&lt;br&gt;            ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"C1"&lt;/span&gt;].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"Date"&lt;/span&gt;;&lt;br&gt;            ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"D1"&lt;/span&gt;].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"Number"&lt;/span&gt;;&lt;br&gt;            ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"E1"&lt;/span&gt;].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"Formula"&lt;/span&gt;;&lt;br&gt;            ws.View.FreezePanes(2, 1);&lt;br&gt;&lt;br&gt;            &lt;span style="color: blue;"&gt;using&lt;/span&gt;(&lt;span style="color: blue;"&gt;var&lt;/span&gt; rng = ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A1:E1"&lt;/span&gt;])&lt;br&gt;            {&lt;br&gt;                rng.Style.Font.Bold = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;&lt;br&gt;                rng.Style.Font.Color.SetColor(Color.White);&lt;br&gt;                rng.Style.WrapText = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;&lt;br&gt;                rng.Style.VerticalAlignment = ExcelVerticalAlignment.Center;&lt;br&gt;                rng.Style.HorizontalAlignment = ExcelHorizontalAlignment.Center;&lt;br&gt;                rng.Style.Fill.PatternType = ExcelFillStyle.Solid;&lt;br&gt;                rng.Style.Fill.BackgroundColor.SetColor(Color.DarkBlue);&lt;br&gt;            }&lt;br&gt;&lt;br&gt;            ws.Cells[Rows-100, 1, Rows, 5].AutoFitColumns(5);   &lt;span style="color: green;"&gt;//Auto fit using the last 100 rows with minimum width 5&lt;/span&gt;&lt;br&gt;            ws.Column(5).Width = 15;                            &lt;span style="color: green;"&gt;//We need to set the width for column F manually since the end sum formula is the widest cell in the column (EPPlus don't calculate any forumlas, so no output text is avalible). &lt;/span&gt;&lt;br&gt;&lt;br&gt;            &lt;span style="color: green;"&gt;//Now we set the sheetprotection and a password.&lt;/span&gt;&lt;br&gt;            ws.Cells[2, 3, Rows + 1, 4].Style.Locked = &lt;span style="color: blue;"&gt;false&lt;/span&gt;;&lt;br&gt;            ws.Cells[2, 3, Rows + 1, 4].Style.Fill.PatternType = ExcelFillStyle.Solid;&lt;br&gt;            ws.Cells[2, 3, Rows + 1, 4].Style.Fill.BackgroundColor.SetColor(Color.White);&lt;br&gt;            ws.Cells[1, 5, Rows + 2, 5].Style.Hidden = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;    &lt;span style="color: green;"&gt;//Hide the formula&lt;/span&gt;&lt;br&gt;&lt;br&gt;            ws.Protection.SetPassword(&lt;span style="color: rgb(163, 21, 21);"&gt;"EPPlus"&lt;/span&gt;);&lt;br&gt;&lt;br&gt;            ws.Select(&lt;span style="color: rgb(163, 21, 21);"&gt;"C2"&lt;/span&gt;);&lt;br&gt;            Console.WriteLine(&lt;span style="color: rgb(163, 21, 21);"&gt;"{0:HH.mm.ss}\tSaving..."&lt;/span&gt;, DateTime.Now);&lt;br&gt;            package.SaveAs(newFile);&lt;br&gt;            Console.WriteLine(&lt;span style="color: rgb(163, 21, 21);"&gt;"{0:HH.mm.ss}\tDone!!"&lt;/span&gt;, DateTime.Now);&lt;br&gt;            &lt;span style="color: blue;"&gt;return&lt;/span&gt; newFile.FullName;&lt;br&gt;        }&lt;br&gt;    }&lt;br&gt;}&lt;br&gt;&lt;br&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="wilkenm" When="04/06/2013 14:41:46">
          <Html>
        &lt;div class="markDownOutput "&gt;I think you are looking for something like this: &lt;a href="http://zeeshanumardotnet.blogspot.com/2011/06/creating-reports-in-excel-2007-using.html." rel="nofollow"&gt;
http://zeeshanumardotnet.blogspot.com/2011/06/creating-reports-in-excel-2007-using.html.&lt;/a&gt; I downloaded the source code and it has the very examples you are looking for.
&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Namespace Error , plz help me !">
      <Posts>
        <Post From="morilog" When="04/06/2013 00:43:24">
          <Html>
        &lt;div class="markDownOutput "&gt;i was added EPPlus to my project references and Using OfficeOpenXml;&lt;br&gt;
when i run my project i got this errors and warning :&lt;br&gt;
&lt;br&gt;
Warning : &lt;br&gt;
&lt;blockquote&gt;The referenced assembly "EPPlus" could not be resolved because it has a dependency on "System.Web, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" which is not in the currently targeted framework ".NETFramework,Version=v4.0,Profile=Client".
 Please remove references to assemblies not in the targeted framework or consider retargeting your project.&lt;br&gt;
&lt;/blockquote&gt;
Errors :&lt;br&gt;
&lt;blockquote&gt;The type or namespace name 'OfficeOpenXml' could not be found (are you missing a using directive or an assembly reference?)&lt;br&gt;
&lt;br&gt;
The type or namespace name 'ExcelPackage' could not be found (are you missing a using directive or an assembly reference?)&lt;br&gt;
&lt;/blockquote&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Different excel file sizes produced on different machines">
      <Posts>
        <Post From="BenAmada" When="03/06/2013 21:17:47">
          <Html>
        &lt;div class="markDownOutput "&gt;Creating the same Excel file on my own machine versus on the live server, the Excel file size is quite a bit different (same version of EPPlus). 5 MBs on my machine and 8 MBs on the server ... same exact contents. If I open the 8 MB file up in Excel and
 simply save it without any real change, it goes down to 5 MBs. If I unarchive the contents of both XLSX files and compare with beyond compare, it's the same number of files and file sizes are basically the same (a few bytes difference).
&lt;br&gt;
&lt;br&gt;
I'm guessing this is a compression issue? Is there any type of compression option available? Either with EPPlus itself, or possibly a setting on the server I can change to try and get smaller files. Any info is very appreciated.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Copy worksheet values (no formulas or reference)">
      <Posts>
        <Post From="feifles" When="30/05/2013 23:27:31">
          <Html>
        &lt;div class="markDownOutput "&gt;Is it possible to copy a worksheet to another workbook values only? &lt;br&gt;
&lt;br&gt;
Here's how im doing right now, but it comes the formulas which i dont want.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;            var pck1= new ExcelPackage("book1.xlsx");
            var pck2= new ExcelPackage("book2.xlsx");

            var ws = pck1.Workbook.Worksheets["sheet1"];
            pck2.Workbook.Worksheets.Add ("shet1copied", ws);&lt;/code&gt;&lt;/pre&gt;
At least is something like that, i've shortned the code to be simpler&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Output xlsx as text/xml">
      <Posts>
        <Post From="reformed" When="30/05/2013 21:36:29">
          <Html>
        &lt;div class="markDownOutput "&gt;Is there a way to output the Excel package object as text, such as with a ToString() method? Any way to save it in xml format?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="insert data into next empty row in excel .xlsx">
      <Posts>
        <Post From="ctee" When="30/05/2013 14:30:51">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi all, &lt;br&gt;
&lt;br&gt;
I can successfully get the last used row and column in excel .xlsx. But i have problem where i want to insert data into next unused row (next empty row).Can anyone guide me about this?
&lt;br&gt;
&lt;br&gt;
var rowCnt = worksheet.Dimension.End.Row; &lt;br&gt;
var colCnt = worksheet.Dimension.End.Column; &lt;br&gt;
&lt;br&gt;
*This is how i check the last used row/column. So if current last used row is 14, i wish to start insert my datatable start from row 15, anyone got any idea how to go about this?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Finding last used row and insert data to the next unused row">
      <Posts>
        <Post From="ctee" When="30/05/2013 03:28:22">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi all, &lt;br&gt;
&lt;br&gt;
I can successfully get the last used row and column. But i have the problem where i want to insert data into next unused row.Can anyone guide me about this?&lt;br&gt;
&lt;pre&gt;&lt;code&gt;var rowCnt = worksheet.Dimension.End.Row;
                var colCnt = worksheet.Dimension.End.Column;
&lt;/code&gt;&lt;/pre&gt;
*This is how i check the last used row/column. So if current last used row is 14, i wish to start insert my datatable start from row 15.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Merging multiple Excel files.">
      <Posts>
        <Post From="beingcoder2010" When="30/05/2013 02:13:00">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
I have 2 questions,&lt;br&gt;
&lt;ol&gt;
&lt;li&gt;How to I create an excel file with Byte[]?&lt;br&gt;
&lt;/li&gt;&lt;/ol&gt;
2.How do I combine multiple excel files having 1 worksheet into 1 excel file with 1 worksheet?
&lt;br&gt;
&lt;br&gt;
I am searching for the these items and not able to get it. &lt;br&gt;
&lt;br&gt;
I appreciate your help. &lt;br&gt;
&lt;br&gt;
Regards,&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to add a reference to an external Sheet?">
      <Posts>
        <Post From="dirkkurt" When="28/05/2013 13:15:01">
          <Html>
        &lt;div class="markDownOutput "&gt;I'm creating a workbook and need the formula &lt;br&gt;
&lt;br&gt;
='C:\Rmv\API\ddl\Rmv.xla'!blp(A" + i + ";$B$1) &lt;br&gt;
&lt;br&gt;
in some cells (i is my iterator, of course). I figured out that excel itself saves links to external files by storing the path to the file itself in externalLink.xml and the name of the sheet in the external file as another reference.
&lt;br&gt;
&lt;br&gt;
How can I create such a link in EPPlus? Thank you for input / examples, best regards from Germany, Dirk&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="dirkkurt" When="28/05/2013 14:57:33">
          <Html>
        &lt;div class="markDownOutput "&gt;Hm I guess this is currently not possible with EPPlus, at least not easy.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Range names are lost on save">
      <Posts>
        <Post From="rsiddiqi" When="24/05/2013 21:18:51">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi All, &lt;br&gt;
&lt;br&gt;
EPPlus was a great help for me. I have created my application around it. Now I am having problem and kind of stuck.
&lt;br&gt;
&lt;br&gt;
I have a big xlsm files having a lots of macros and data validations. When I load the file like this&lt;br&gt;
&lt;pre&gt;&lt;code&gt;        ExcelPackage xlsFile = new ExcelPackage();
        var file = File.Open(fullFileName, FileMode.OpenOrCreate);
        xlsFile.Load(file);
&lt;/code&gt;&lt;/pre&gt;
macros and everything works well. &lt;br&gt;
&lt;br&gt;
But when I open the file like this &lt;br&gt;
&lt;pre&gt;&lt;code&gt;        FileInfo fileInfoObj = new FileInfo(fullFileName);
        ExcelPackage xlsFile = new ExcelPackage(fileInfoObj);
&lt;/code&gt;&lt;/pre&gt;
Make a little change in a Cell and save. xlsFile.Save(); &lt;br&gt;
&lt;br&gt;
My Range Names are deleted. Thought I didn't touch any macro or Range Name. &lt;br&gt;
&lt;br&gt;
Thanks for your help. &lt;br&gt;
Riz&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Adding a hidden attribute to a cell/row/column">
      <Posts>
        <Post From="WhiskaBiscuit" When="24/05/2013 16:52:08">
          <Html>
        &lt;div class="markDownOutput "&gt;I'm using XLSX files as an interface for upload/download &lt;br&gt;
&lt;br&gt;
I need to store some GUID's with the cell text so that if the user modifies a cell on the XLSX file, when I upload again I can read the GUID and not the cell text value.
&lt;br&gt;
&lt;br&gt;
Is there a way to store attributes on rows and columns, and for more granularity on cells?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Two questions, Numberformat  for currency and wrap= true wrapping words as well">
      <Posts>
        <Post From="chetanw" When="23/05/2013 14:52:09">
          <Html>
        &lt;div class="markDownOutput "&gt;First of all i would like to thank for wonderful library. &lt;br&gt;
&lt;br&gt;
I am able to export data to excel in a way that i wanted except with some issues that i am sure will be answered here.
&lt;br&gt;
&lt;br&gt;
I have column name as "TOTAL ALLOCATED CHARGES". It has all numbers. Now I set wrap = true.
&lt;br&gt;
What it does is that it wraps it in following way &lt;br&gt;
TOTAL &lt;br&gt;
ALLOCAT &lt;br&gt;
ED &lt;br&gt;
CHARGES &lt;br&gt;
&lt;br&gt;
I want it to be like &lt;br&gt;
TOTAL&lt;br&gt;
ALLOCATED &lt;br&gt;
CHARGES. &lt;br&gt;
&lt;br&gt;
There is second question &lt;br&gt;
I am exporting data from datatable. It has decimal type column which is currency. It has values like 0.0000, 10.0000. I want to display it like $0.00, $10.00. Can you please suggest Numberformat for this?
&lt;br&gt;
&lt;br&gt;
Thank you in advance!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="how to process equations edited by MathType.">
      <Posts>
        <Post From="pucx" When="23/05/2013 10:42:32">
          <Html>
        &lt;div class="markDownOutput "&gt;how to using Epplus to process equations edited by MathType.Thank you.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Grouping excel rows using EPPlus">
      <Posts>
        <Post From="vamsipunna" When="10/04/2013 15:53:36">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi can anyone tell me if we can group/ungroup excel rows using EPPlus? I have been using ExcelPackage so far and it doesn't seem to have grouping feature.
&lt;br&gt;
&lt;br&gt;
Thanks, &lt;br&gt;
Vamsi&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="AlexeyQ" When="23/05/2013 06:41:21">
          <Html>
        &lt;div class="markDownOutput "&gt;I also need to group rows. Does anybody know how to?&lt;br&gt;
=== added later ====&lt;br&gt;
the answer to my question: &lt;a href="https://epplus.codeplex.com/discussions/269473" rel="nofollow"&gt;
https://epplus.codeplex.com/discussions/269473&lt;/a&gt;&lt;br&gt;
(just used google instead of codeplex search :)&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Conditional format color for Less Than">
      <Posts>
        <Post From="Tridus" When="22/05/2013 18:14:01">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi. I'm trying to set a color for a less than conditional format. Here's the format code:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;var condition = sheet.ConditionalFormatting.AddLessThan(addr);
condition.Formula = "50";&lt;/code&gt;&lt;/pre&gt;
By default, this doesn't set the conditional format with any color, so you can't see it. I know the condition itself is working, since I can add something like italics and that shows up.
&lt;br&gt;
&lt;br&gt;
The issue is that unlike the other conditions, there is no condition.Color for Less Than that I can find. Instead you have to set Style.Font.Color, and that doesn't take a Color object to set it. It takes some kind of ExcelDxf object that I'm really not clear
 on how to use. &lt;br&gt;
&lt;br&gt;
Any advice on how to do this? Also, why is this one inconsistent from the ones like Two Color Scale, which just takes a Color object?
&lt;br&gt;
&lt;br&gt;
Thanks.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Tridus" When="22/05/2013 19:48:02">
          <Html>
        &lt;div class="markDownOutput "&gt;Nevermind, figured it out. :) You can set condition.Style.Font.Color.Color to a System.Drawing.Color object.
&lt;br&gt;
&lt;br&gt;
Not sure how I missed that, sorry for the silly question. :)&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to insert blank values in a cell">
      <Posts>
        <Post From="anilp" When="20/05/2013 21:15:02">
          <Html>
        &lt;div class="markDownOutput "&gt;Your DLL is amazing. I am able to create excel file which fulfill my requirements. Minor problem occurred below
&lt;br&gt;
&lt;br&gt;
I want to insert blank values in a cell and merge it but i am unable to do it.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;sheet.Cells[A1:A3].Value = "";
sheet.Cells[A1:A3].Merge = true;&lt;/code&gt;&lt;/pre&gt;
Doesn't work &lt;br&gt;
&lt;br&gt;
Same i want to add a blank values in datavalidationlist&lt;br&gt;
&lt;pre&gt;&lt;code&gt;
var listData = sheet.Cells[C1:C3].DataValidation.AddListDataValidation();
                        listData.Formula.Values.Add("");
                        listData.Formula.Values.Add("A");
                        listData.Formula.Values.Add("B");
                        listData.Formula.Values.Add("C");
                        listData.Formula.Values.Add("D");
                        listData.ShowErrorMessage = true;
                        listData.Error = "Please select a value from the list"; 
&lt;/code&gt;&lt;/pre&gt;
Pleae let me know how to do this.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to insert blank values in a cell">
      <Posts>
        <Post From="anilp" When="20/05/2013 21:15:00">
          <Html>
        &lt;div class="markDownOutput "&gt;Your DLL is amazing. I am able to create excel file which fulfill my requirements. Minor problem occurred below
&lt;br&gt;
&lt;br&gt;
I want to insert blank values in a cell and merge it but i am unable to do it.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;sheet.Cells[A1:A3].Value = "";
sheet.Cells[A1:A3].Merge = true;&lt;/code&gt;&lt;/pre&gt;
Doesn't work &lt;br&gt;
&lt;br&gt;
Same i want to add a blank values in datavalidationlist&lt;br&gt;
&lt;pre&gt;&lt;code&gt;
var listData = sheet.Cells[C1:C3].DataValidation.AddListDataValidation();
                        listData.Formula.Values.Add("");
                        listData.Formula.Values.Add("A");
                        listData.Formula.Values.Add("B");
                        listData.Formula.Values.Add("C");
                        listData.Formula.Values.Add("D");
                        listData.ShowErrorMessage = true;
                        listData.Error = "Please select a value from the list"; 
&lt;/code&gt;&lt;/pre&gt;
Pleae let me know how to do this.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Specified NumberFormat defaulting to Date">
      <Posts>
        <Post From="tmaly" When="20/05/2013 18:06:35">
          <Html>
        &lt;div class="markDownOutput "&gt;I am having a difficult time setting the Number Format for cells in a worksheet that has been loaded from a template.
&lt;br&gt;
&lt;br&gt;
If I try to set the Numberformat property for a cell to "#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00;&lt;a href="#,#&lt;a class=" workitemlink"=""&gt;#0&lt;/a&gt;.00" rel="nofollow"&amp;gt;Red" or "#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00_);(#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00)" or "#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00;(#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00)" the result winds up formatted as a date (mm/dd/yyyy).
&lt;br&gt;
&lt;br&gt;
The method I am using to set the cell format/value in all cases is:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;using (var cell = WorkSheet.Cells[rowIdx, columnIdx])
{
       cell.Style.HorizontalAlignment = ExcelHorizontalAlignment.Right;
       cell.Style.Font.Size = 8;
       cell.Style.Numberformat.Format = "#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00;[Red](#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00)";
       cell.Value = &amp;lt;decimal/string value&amp;gt;;  
}
&lt;/code&gt;&lt;/pre&gt;
Has anyone else encountered this issue? Is there a best practice with regard to cell format setting?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Doesn't seem to read font styles correctly">
      <Posts>
        <Post From="SamiHuutoniemi" When="15/05/2013 11:18:48">
          <Html>
        &lt;div class="markDownOutput "&gt;When I read the xlsx file, all cells seem to have the same Cells[...].Style.Font.Itallic/Bold/Strike etc.
&lt;br&gt;
&lt;br&gt;
In other words, itallic and other properties always seem to be true, whether the cell's style is itallic or not.
&lt;br&gt;
&lt;br&gt;
Anyone else had any trouble with this?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Xltx files">
      <Posts>
        <Post From="uditar" When="23/07/2012 13:37:22">
          <Html>
        
&lt;p&gt;not really a discussion, but something i did want to share.&lt;/p&gt;
&lt;p&gt;for a project i was working on i had to use xltx files as input and export xlsx files. the EPPlus library worked great for everthing else i needed to do, but i found that feature missing, so i figured out the difference between xltx and xlsx myself.&lt;/p&gt;
&lt;p&gt;and in case other people might be having the same issues or in case you want to add this option to the library, here is the code i wrote to make the conversion as a thanks for the work you did.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;this might need adaptation to support multiple workbooks though.&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: green;"&gt;//using ExcelPagage MyPackage&lt;/span&gt;
Package mypack = MyPackage.Package;
Uri workbook = &lt;span style="color: blue;"&gt;new&lt;/span&gt; Uri(&lt;span style="color: rgb(163, 21, 21);"&gt;"/xl/workbook.xml"&lt;/span&gt;, UriKind.Relative);
PackageRelationshipCollection relcoll = mypack.GetPart(workbook).GetRelationships();
mypack.DeletePart(workbook);
mypack.CreatePart(workbook, &lt;span style="color: rgb(163, 21, 21);"&gt;"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"&lt;/span&gt;, CompressionOption.SuperFast);
&lt;span style="color: blue;"&gt;foreach&lt;/span&gt; (PackageRelationship Relation &lt;span style="color: blue;"&gt;in&lt;/span&gt; relcoll)
{
    mypack.GetPart(workbook).CreateRelationship(Relation.TargetUri, Relation.TargetMode, Relation.RelationshipType, Relation.Id);
}
&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="robrbaron" When="01/02/2013 07:10:46">
          <Html>
        &lt;div class="markDownOutput "&gt;can you provide any more info on how to get this to work. &lt;br&gt;
&lt;br&gt;
I have tried to create an extension method, but it doesnt seem to have any impact to solve the problem of opening a XLTM and saving as XLSM.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;namespace EPPlusExtension
{
    using System;
    using System.IO.Packaging;  //needs reference to WindowsBase
    using OfficeOpenXml;
    public static class EP_RG
    {
        public static void ConvertXLT2XLM(this ExcelPackage myXLP)
        {//
            //using ExcelPagage MyPackage
            Package mypack = myXLP.Package;
            Uri workbook = new Uri("/xl/workbook.xml", UriKind.Relative);
            PackageRelationshipCollection relcoll = mypack.GetPart(workbook).GetRelationships();
            mypack.DeletePart(workbook);
            mypack.CreatePart(workbook, "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml", CompressionOption.SuperFast);
            foreach (PackageRelationship Relation in relcoll)
            {
                mypack.GetPart(workbook).CreateRelationship(Relation.TargetUri, Relation.TargetMode, Relation.RelationshipType, Relation.Id);
            }
        }
    }
}&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;
                    using (ExcelPackage xl = new ExcelPackage(InvoiceSave, InvoiceTempate))
                    {
                        ExcelWorksheet ws = xl.Workbook.Worksheets["Project Information"];
                        //Project_No is a workbook scope name
                        if (xl.Workbook.Names.ContainsKey("Project_No"))
                        {
                            ExcelNamedRange prid = xl.Workbook.Names["Project_No"];
                            prid.Value = projectName + projectSuffix;

                            xl.ConvertXLT2XLM();
                            xl.Save();
                            return;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="xav2075" When="01/02/2013 08:53:18">
          <Html>
        &lt;div class="markDownOutput "&gt;This code will convert a .xltm file to .xlsm file:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;using System;
using System.IO;
using DocumentFormat.OpenXml; // References C:\Program Files (x86)\Open XML SDK\V2.5\lib\DocumentFormat.OpenXml.dll
using DocumentFormat.OpenXml.Packaging;

namespace Change_xltm_file_to_xlsm
{
  class Program
  {
    static void Main(string[] args)
    {
      byte[] byteArray = File.ReadAllBytes(@"d:\sample1.xltm");
      using (MemoryStream stream = new MemoryStream())
      {
        stream.Write(byteArray, 0, (int)byteArray.Length);
        using (SpreadsheetDocument spreadsheetDoc = SpreadsheetDocument.Open(stream, true))
        {
          // Change from template .xlsm type to workbook .xlsm, type
          spreadsheetDoc.ChangeDocumentType(SpreadsheetDocumentType.MacroEnabledWorkbook);
        }
        File.WriteAllBytes(@"d:\sample1.xlsm", stream.ToArray());
      }
      Console.Write("Program finished.  Press a key\n");
    }
  }
}&lt;/code&gt;&lt;/pre&gt;
The &lt;strong&gt;spreadsheetDoc.ChangeDocumentType(SpreadsheetDocumentType.MacroEnabledWorkbook);&lt;/strong&gt; line does the conversion This code does not use epplus. So you can do stuff epplus and then save and close the file and then reopen it and convert it with
 the code above.&lt;br&gt;
&lt;br&gt;
You need the Microsoft OpenXML SDK 2.5 installed: &lt;a href="http://www.microsoft.com/en-gb/download/details.aspx?id=30425" rel="nofollow"&gt;
http://www.microsoft.com/en-gb/download/details.aspx?id=30425&lt;/a&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Peter_Karlstrom" When="14/05/2013 14:30:45">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi xav2075 &lt;br&gt;
&lt;br&gt;
Your sample is working unless you don't attempt to work with the worksheets using EPPlus afterwards.
&lt;br&gt;
I also found this sample on OpenXML forums and have used it for creating Excel spreadsheets from Excel XLTX templates.
&lt;br&gt;
&lt;br&gt;
But when I try to use the created spreadsheet using EPPlus after the change of documenttype, EPPlus cant find the sheets collection.
&lt;br&gt;
&lt;br&gt;
Studying the XML code after changing the documenttype using Open XML Producticity code, one can se that the the rootname of the workbook is changed from "workbook" to "workbook2".
&lt;br&gt;
This seems to be the cause of EPPlus not finding any sheets after the "conversion".
&lt;br&gt;
&lt;br&gt;
Do you (or anybody) have some mor input regarding this? &lt;br&gt;
&lt;br&gt;
Thanks in advance &lt;br&gt;
&lt;br&gt;
Peter karlström &lt;br&gt;
Midrange AB &lt;br&gt;
Sweden&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Performance Issue in AddShape">
      <Posts>
        <Post From="AnChakrabort" When="10/05/2013 20:15:58">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
i need to create a report which will have 3 three shape in each page. and there will be more than 1000 page in that report. it was running fine with less data &amp;lt;10 page. But now i am having big performance issue as data size increases. Any help will be greatly
 appreciated. &lt;br&gt;
Here is the code snippet for adding shape. &lt;br&gt;
&lt;br&gt;
ExcelShape shape1 = sheet.Drawings.AddShape("txt" + rowNo, eShapeStyle.RoundRect);&lt;br&gt;
&lt;pre&gt;&lt;code&gt;                            shape1.Border.Fill.Color = System.Drawing.Color.Black;

                            shape1.Fill.Color = System.Drawing.Color.White;
                            shape1.SetPosition(rowNo + 1, 0, 21, 0);
                            shape1.SetSize(320, 59);&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Can Data Series Line Style Be Set">
      <Posts>
        <Post From="daveblack" When="08/05/2013 19:39:49">
          <Html>
        &lt;div class="markDownOutput "&gt;I have a &lt;em&gt;eChartType.LineMarkers&lt;/em&gt; chart and the customer wants one of the lines to be a dashed line. Is this possible with EPPlus?
&lt;br&gt;
&lt;br&gt;
Thanks.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to set the value of Column Labels in the Pivot Table">
      <Posts>
        <Post From="Malluri" When="07/05/2013 19:50:10">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
How to set the value of Column Labels in the Pivot Table.I am able to set the value of Row label using RowHeaderCaption. But I did not find the option for setting the column label.
&lt;br&gt;
&lt;br&gt;
Regards, &lt;br&gt;
Malluri&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to Show the value as &quot;% of parent row total&quot; for the column in Pivot table using epplus">
      <Posts>
        <Post From="Malluri" When="21/03/2013 18:49:48">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
How to Show the value as "% of parent row total" for the column in Pivot table using epplus.I am able summarize the values.
&lt;br&gt;
&lt;br&gt;
I did not find any option.Please help regarding the same. &lt;br&gt;
&lt;br&gt;
Regards, &lt;br&gt;
Madhavi&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Malluri" When="21/03/2013 20:26:51">
          <Html>
        &lt;div class="markDownOutput "&gt;I am able to see options for BaseField and BaseItem which are in the same dialogue box but no option for "show values as dropdown"&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Malluri" When="07/05/2013 18:45:39">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
Can someone please help me with this. &lt;br&gt;
&lt;br&gt;
Regards, &lt;br&gt;
Malluri&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Get Background Color">
      <Posts>
        <Post From="3m2vinatohr04" When="05/03/2013 15:38:24">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi guys any idea on how to get the background color? &lt;br&gt;
&lt;br&gt;
I've been trying: &lt;br&gt;
&lt;br&gt;
worksheet.Cells["A1"].Style.Fill.BackgroundColor.Rgb &lt;br&gt;
&lt;br&gt;
but it returns "" &lt;br&gt;
&lt;br&gt;
Help pls.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mparter" When="07/05/2013 17:05:39">
          <Html>
        &lt;div class="markDownOutput "&gt;&lt;strong&gt;3m2vinatohr04 wrote:&lt;/strong&gt;&lt;br&gt;
&lt;blockquote&gt;Hi guys any idea on how to get the background color?&lt;br&gt;
&lt;br&gt;
I've been trying:&lt;br&gt;
&lt;br&gt;
worksheet.Cells["A1"].Style.Fill.BackgroundColor.Rgb&lt;br&gt;
&lt;br&gt;
but it returns ""&lt;br&gt;
&lt;br&gt;
Help pls.&lt;br&gt;
&lt;/blockquote&gt;
Did you ever suss this out? I'm having the same issue.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Unable to retrieve the background color of a cell">
      <Posts>
        <Post From="mparter" When="07/05/2013 11:24:02">
          <Html>
        &lt;div class="markDownOutput "&gt;It seems that no matter what the background color is of a cell in a workbook, the
&lt;br&gt;
&lt;pre&gt;&lt;code&gt;Sheet.Cells[1, 1].Style.Fill.BackgroundColor.Rgb &lt;/code&gt;&lt;/pre&gt;
property is always an empty string. I've also tried using&lt;br&gt;
&lt;pre&gt;&lt;code&gt;Sheet.Cells[1, 1].Style.Fill.BackgroundColor.Indexed&lt;/code&gt;&lt;/pre&gt;
and &lt;br&gt;
&lt;pre&gt;&lt;code&gt;Sheet.Cells[1, 1].Style.Fill.BackgroundColor.Tint&lt;/code&gt;&lt;/pre&gt;
and whilst these return values, they are always the same regardless of the color of the cell. So, is it possible to retrieve the background color of a cell?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="how to get the CommentCell'address">
      <Posts>
        <Post From="toughguy" When="06/05/2013 15:10:05">
          <Html>
        &lt;div class="markDownOutput "&gt;i made a excel file and i check the misstake using excel comment function; &lt;br&gt;
i want to get the comment cell's address from C#. &lt;br&gt;
&lt;br&gt;
it is my code &lt;br&gt;
&lt;br&gt;
foreach (ExcelComment c in ws.Comments) &lt;br&gt;
{&lt;br&gt;
&lt;pre&gt;&lt;code&gt;if (c.Text == "misstake")
{
    MessageBox.Show(c.Address.ToString());←here!!
}&lt;/code&gt;&lt;/pre&gt;
} &lt;br&gt;
&lt;br&gt;
the 'c' have not address member where is the target to fix. &lt;br&gt;
&lt;br&gt;
Apologize my poor english. please help me.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to Create Multiple Charts in a Single Worksheet">
      <Posts>
        <Post From="vips3483" When="06/05/2013 14:00:00">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
I want to create 2 charts in a single Worksheet but am passing 2 Data Tables, one which would populate Customer related info and the other would populate Client related info.
&lt;br&gt;
&lt;br&gt;
I am unable to do so in same Worksheet. &lt;br&gt;
&lt;br&gt;
Can anyone please help me out. &lt;br&gt;
&lt;br&gt;
Thanks&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Page number from cell">
      <Posts>
        <Post From="deverion" When="06/05/2013 09:40:58">
          <Html>
        &lt;div class="markDownOutput "&gt;Is it possible to determine which print page a given cell is on? &lt;br&gt;
&lt;br&gt;
I would like to print table headers on every page. (I do not want to use 'Print Titles' Excel feature, because I would like to customize the titles on every page)
&lt;br&gt;
&lt;br&gt;
My spreadsheet is "one printer page" width and usually contains 34 rows / page, so most of the time I know when 'I am on a new page'. But some cells have word wrap on, so they consumes multiple rows.
&lt;br&gt;
&lt;br&gt;
Should I count the height of rows? Any idea? &lt;br&gt;
&lt;br&gt;
Thank you very much!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="NullRefernceException was unhandled by user code">
      <Posts>
        <Post From="Deepi" When="30/04/2013 06:07:13">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi. I am working with EPPLUS in c#. I wrote the below code to read .xlsx file and display the content of a cell.
&lt;br&gt;
&lt;br&gt;
if (workbook != null)&lt;br&gt;
&lt;pre&gt;&lt;code&gt;            {
                ExcelWorksheet sheet = workbook.Worksheets["Sheet1"];
                var firstrow = sheet.Cells["A1:AO1"];
                String[] col = null;
                int i;
                i = 0;
                foreach (var cells in firstrow)
                {
                    var col1 = cells.GetValue&amp;lt;int&amp;gt;();
                    //TextBox1.Text = col1.ToString();
                    //break;
                    col[i] = String.Empty;
                    col[i] = col1.ToString();
                    i = i + 1;
                }
                int j = Convert.ToInt16(TextBox1.Text);
                TextBox2.Text = col[j];
            }
&lt;/code&gt;&lt;/pre&gt;
In the above code, at the line &lt;br&gt;
var firstrow = sheet.Cells["A1:AO1"]; &lt;br&gt;
I get a NullReferenceException. I am new to C#. Can anyone pls help me?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="ted_250" When="02/05/2013 21:03:50">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi Deepi, &lt;br&gt;
&lt;br&gt;
It can be pretty hard to know what the problem is without (ideally) the whole module or project of code to work with and, if at all possible, an output spreadsheet. Given your error, you might want to try
&lt;code&gt;ExcelWorksheet sheet = workbook.Worksheets[0];&lt;/code&gt; instead for the one line since the variable "sheet" is probably ending up with a null value.
&lt;br&gt;
&lt;br&gt;
My first guess is that the problem is probably annoyingly simple: the sheet is actually named "sheet1" rather than "Sheet1" (with a capital). In .NET, most string compares are case sensitive, so it could hit you.&lt;br&gt;
&lt;br&gt;
Ted&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Future Of EPPlus">
      <Posts>
        <Post From="Phenomin" When="02/05/2013 12:26:58">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, just wondering if there is a future for this software or if it's development will cease anytime soon. I love it so far, except for a few minor issues and would like to see it continue to grow.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Hiding Collapse and Expand button in pivot table">
      <Posts>
        <Post From="Bhanu1423" When="02/05/2013 08:55:47">
          <Html>
        &lt;div class="markDownOutput "&gt;How to Hide collapse and expand button in pivot table. &lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
i tried the below one , but not working &lt;br&gt;
pivotTable.EnableDrill =false; &lt;br&gt;
pivotTable.ShowDrill = false; &lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Please Urgent.... &lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Please Version Up This Project.">
      <Posts>
        <Post From="toughguy" When="02/05/2013 08:14:32">
          <Html>
        &lt;div class="markDownOutput "&gt;I'm using EPPLUS and thanks folks made it. it is very usefull. &lt;br&gt;
&lt;br&gt;
but, it only can use Excel2007 .xlsx template to create new file, &lt;br&gt;
can not use 2010 one. when I open the created excel file, I will get the error message that says 'xml is broken'
&lt;br&gt;
because the [2010 xlsx XML] is different from [2007 xlsx XML] a little. &lt;br&gt;
&lt;br&gt;
Does someone can fix it? please.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="xlsb Support?">
      <Posts>
        <Post From="lehket" When="07/04/2011 17:02:43">
          <Html>
        
&lt;p&gt;Does EPPlus support creation of .xlsb files? If not, are there any plans to do so at this point? Thanks!&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="swmal" When="07/04/2011 19:34:58">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;sorry, EPPlus does not support the binary format.&amp;nbsp;We&amp;nbsp;are currently&amp;nbsp;focusing on implementing new features in the .xlsx format.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="lehket" When="07/04/2011 19:42:37">
          <Html>
        
&lt;p&gt;Okay, thanks. That's what I thought, but wanted to make sure.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="kanwal_hans" When="01/05/2013 14:29:14">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
Do we have yet have any suppport for xlsb in EPPlus. If not, any plans to get that included in any near future release?
&lt;br&gt;
&lt;br&gt;
If not, are you aware of any other tools that can help create/update/edit xlsb format files.
&lt;br&gt;
&lt;br&gt;
Thanks&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="can i enable editing xls file using epplus?">
      <Posts>
        <Post From="osama_elfar" When="30/04/2013 15:51:04">
          <Html>
        &lt;div class="markDownOutput "&gt;we have built a small application that edit xls files and do some operations that we need ,but we have a big issue that files that our application depend on always come with "disable editing" .so we always have to open files using office and
 enable editing first . &lt;br&gt;
&lt;br&gt;
so ......... &lt;br&gt;
&lt;br&gt;
we are thinking now in building a small app that only import excel file and enable editing .
&lt;br&gt;
&lt;br&gt;
any help??&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Problem using EPPlus">
      <Posts>
        <Post From="sephiroth007234" When="28/04/2013 13:27:50">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi everyone!!! &lt;br&gt;
&lt;br&gt;
I need to mention that I´m using VS2010 net Framework 4, C# in a windows form project.
&lt;br&gt;
so... what´s the problem? &lt;br&gt;
I add to my project a new project of classLibrary type (named: ExportLibrary.dll), and then I add the epplus dll to it (a reference). Then I create a static Class that use epplus, but when I try to use the static class (that belongs to ExportLibrary ) in another
 project(but in the same solution), a windows form project these 2 error appear:&lt;br&gt;
&lt;ul&gt;
&lt;li&gt;Can not embed interop types from assembly 'd: \ proyecto(02-02-2013) New Version \ Components \ EPPlus.dll' because it has no attribute 'ImportedFromTypeLibAttribute' or the attribute 'PrimaryInteropAssemblyAttribute'.
&lt;br&gt;
&lt;/li&gt;&lt;li&gt;Unable to find metadata file 'D: \ proyecto(02-02-2013) New Version \ MyProyect\ ExportLibrary \ bin \ Release \ ExportLibrary.dll'.&lt;br&gt;
&lt;/li&gt;&lt;/ul&gt;
But I can´t find any solution. That´s why I´m asking for your help. &lt;br&gt;
Thanks a lot.&lt;br&gt;
&lt;ul&gt;
&lt;li&gt;I apologize because of my English isn´t good. &lt;/li&gt;&lt;/ul&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="sephiroth007234" When="28/04/2013 22:33:31">
          <Html>
        &lt;div class="markDownOutput "&gt;Sorry... my mistake. &lt;br&gt;
&lt;br&gt;
I create the library with net Framework 4, but the proyect where I try to use it was using Client profile. So, problem solved.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="android SUMs blank">
      <Posts>
        <Post From="aim12340" When="27/04/2013 19:14:03">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, i am loving EPPlus - thanks for the great work! &lt;br&gt;
&lt;br&gt;
I have a formula that works ok in excel and openoffice but is blank when viewed on my android document viewer. This is jelly bean on a nexus 7. I believe this is the built-in document viewer, not an app i downloaded.
&lt;br&gt;
&lt;br&gt;
the vb code i use is: ws.Cells("D"&amp;amp;row).Formula = "=Sum(D4:D" &amp;amp; row-2 &amp;amp; ")"
&lt;br&gt;
&lt;br&gt;
I see that excel will save the formula AND the current value in it's xlsx, and EPPlus saves just the formula.
&lt;br&gt;
&lt;br&gt;
I tried setting the value and then the formula, but it seems EPPlus clears the value when a formula is set.
&lt;br&gt;
&lt;br&gt;
I've had to calculate the SUM myself so there are no formulas in my xslx any more, which just makes me sad :(
&lt;br&gt;
&lt;br&gt;
I'm sure i saw an example before that set the value and formula something like .formula="123,sum(A1:A5)" but i can't find that now.
&lt;br&gt;
&lt;br&gt;
Anyone know how i can get this working? &lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Moving to next worksheet to save new cells data">
      <Posts>
        <Post From="reynierpm" When="27/04/2013 18:13:17">
          <Html>
        &lt;div class="markDownOutput "&gt;I,ve wrote this code:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;    private void button3_Click(object sender, EventArgs e)
    {
        int value = bdCleanList.Count() / Int32.Parse(textBox7.Text);
        string bases_generadas = System.IO.Path.Combine(AppDomain.CurrentDomain.BaseDirectory, "bases_generadas");

        var package = new ExcelPackage();

        package.Workbook.Worksheets.Add("L1");
        ExcelWorksheet worksheet = package.Workbook.Worksheets[1];
        worksheet.Name = "L1";

        int j = 2;

        for (int i = 1; i &amp;lt; bdCleanList.Count(); i++)
        {
            if (i%Int32.Parse(textBox7.Text) == 0)
            {
                package.Workbook.Worksheets.Add("L" + j);
                worksheet = package.Workbook.Worksheets[j];
                worksheet.Name = "L" + j;
                j += 1;
            }

            worksheet.Cells[i, 1].Value = bdCleanList[i];
        }

        Byte[] bin = package.GetAsByteArray();
        File.WriteAllBytes(System.IO.Path.Combine(bases_generadas, "bases_generadas_" + DateTime.Now.Ticks.ToString() + DateTime.Now.ToString("dd-MM-yyyy-hh-mm-ss") + ".xlsx"), bin);
    }
&lt;/code&gt;&lt;/pre&gt;
In the sample I'm running bdCleanList.Count() has 2056 values, Int32.Parse(textBox7.Text) has 500 as value so value gets in this case 5, values for first worksheet is saved fine but the rest of them don't have any values, why? what's wrong in my code?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Excel found unreadable content (/xl/SharedStrings.xml).">
      <Posts>
        <Post From="Mazz" When="27/04/2013 16:49:43">
          <Html>
        &lt;div class="markDownOutput "&gt;I created a fairly simple spreadsheet and Excel complains that it has found unreadable content when I open it. If I proceed with recover it reports "Repaired records: string properties from /xl/SharedStrings.xml".
&lt;br&gt;
&lt;br&gt;
When I have a look at SharedStrings.xml it initially looks like the culprit is an incorrect count attribute on the sst tag (but read all the way to the end!) The saved version has:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;sst xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" count="7" uniqueCount="7"&amp;gt;&lt;/code&gt;&lt;/pre&gt;
whereas the repaired one has:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;sst xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" count="8" uniqueCount="7"&amp;gt;&lt;/code&gt;&lt;/pre&gt;
It does look like one of the shared strings is referenced twice in the worksheet.
&lt;br&gt;
&lt;br&gt;
More curiously, this only started happening when I tried to format the cells to the right of the ones containing the string defined in SharedStrings.xml as RichText. I've narrowed it down to a code path where it executes:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;                ExcelRange cell = _dirSheet.Cells[_nextRow, col];
                cell.IsRichText = true;
                ExcelRichText rt = cell.RichText.Add(str1);
                rt = cell.RichText.Add(str2);&lt;/code&gt;&lt;/pre&gt;
When str1 is the empty string this error occurs - even in a spreadsheet with 1 header row and two detail rows (each with the same string in one column). When RichText.Add(str1) is only called when str1 is not empty the error has not yet occurred.
&lt;br&gt;
&lt;br&gt;
If I reduce the test case to a single detail row Excel still complains with the same error message and the same report about fixing /xl/SharedStrings.xml. However the sst tag's counts are now correct. Here is the entire unrepaired SharedStrings.xml file (indented
 for clarity):&lt;br&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?xml version="1.0" encoding="UTF-8" standalone="yes" ?&amp;gt;
&amp;lt;sst xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" count="6" uniqueCount="6"&amp;gt;
  &amp;lt;si&amp;gt;
    &amp;lt;t&amp;gt;Size&amp;lt;/t&amp;gt;
  &amp;lt;/si&amp;gt;
  &amp;lt;si&amp;gt;
    &amp;lt;t&amp;gt;Ext&amp;lt;/t&amp;gt;
  &amp;lt;/si&amp;gt;
  &amp;lt;si&amp;gt;
    &amp;lt;t&amp;gt;Name&amp;lt;/t&amp;gt;
  &amp;lt;/si&amp;gt;
  &amp;lt;si&amp;gt;
    &amp;lt;t&amp;gt;csv&amp;lt;/t&amp;gt;
  &amp;lt;/si&amp;gt;
  &amp;lt;si&amp;gt;
    &amp;lt;t&amp;gt;.txt&amp;lt;/t&amp;gt;
  &amp;lt;/si&amp;gt;
  &amp;lt;si&amp;gt;
    &amp;lt;d:r xmlns:d="http://schemas.openxmlformats.org/spreadsheetml/2006/main"&amp;gt;
      &amp;lt;d:rPr&amp;gt;
        &amp;lt;d:sz val="11" /&amp;gt;
        &amp;lt;d:rFont val="Calibri" /&amp;gt;
      &amp;lt;/d:rPr&amp;gt;
      &amp;lt;d:t xml:space="preserve"&amp;gt;&amp;lt;/d:t&amp;gt;
    &amp;lt;/d:r&amp;gt;
    &amp;lt;d:r xmlns:d="http://schemas.openxmlformats.org/spreadsheetml/2006/main"&amp;gt;
      &amp;lt;d:rPr&amp;gt;
        &amp;lt;d:sz val="11" /&amp;gt;
        &amp;lt;d:color rgb="FF000000" /&amp;gt;
        &amp;lt;d:rFont val="Calibri" /&amp;gt;
      &amp;lt;/d:rPr&amp;gt;
      &amp;lt;d:t xml:space="preserve"&amp;gt;a&amp;lt;/d:t&amp;gt;
    &amp;lt;/d:r&amp;gt;
  &amp;lt;/si&amp;gt;
&amp;lt;/sst&amp;gt;&lt;/code&gt;&lt;/pre&gt;
This is the repaired version:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&amp;gt;
&amp;lt;sst xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" count="6" uniqueCount="6"&amp;gt;
  &amp;lt;si&amp;gt;
    &amp;lt;t&amp;gt;Size&amp;lt;/t&amp;gt;
  &amp;lt;/si&amp;gt;
  &amp;lt;si&amp;gt;
    &amp;lt;t&amp;gt;Ext&amp;lt;/t&amp;gt;
  &amp;lt;/si&amp;gt;
  &amp;lt;si&amp;gt;
    &amp;lt;t&amp;gt;Name&amp;lt;/t&amp;gt;
  &amp;lt;/si&amp;gt;
  &amp;lt;si&amp;gt;
    &amp;lt;t&amp;gt;csv&amp;lt;/t&amp;gt;
  &amp;lt;/si&amp;gt;
  &amp;lt;si&amp;gt;
    &amp;lt;t&amp;gt;.txt&amp;lt;/t&amp;gt;
  &amp;lt;/si&amp;gt;
  &amp;lt;si&amp;gt;
    &amp;lt;t&amp;gt;a&amp;lt;/t&amp;gt;
  &amp;lt;/si&amp;gt;
&amp;lt;/sst&amp;gt;&lt;/code&gt;&lt;/pre&gt;
So it looks like there is probably one bug (maybe two).&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="EPPlus Issue with date format in same rows in any report">
      <Posts>
        <Post From="f1ght4fun" When="27/04/2013 00:21:24">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
I've come across annoying issue which I cannot fix and hopefully somebody can help me out.
&lt;br&gt;
Whenever I generate report I have issue with date format BUT in specific rows only.
&lt;br&gt;
&lt;br&gt;
&lt;a href="http://d.pr/i/6ZKj" rel="nofollow"&gt;Please see that example&lt;/a&gt; &lt;br&gt;
&lt;br&gt;
I've tried all kinds of date format on column like &lt;br&gt;
ws.Column(3).Style.Numberformat.Format = DateTimeFormatInfo.CurrentInfo.ShortDatePattern;
&lt;br&gt;
and &lt;br&gt;
ws.Column(3).Style.Numberformat.Format = "dd.mm.yy" &lt;br&gt;
but nothing seems to work, whatever criteria i use to get data into report, everytime same cells ,same rows are getting date code instead of format.
&lt;br&gt;
&lt;br&gt;
Thanks&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="WEBDEV.WEBSERVER.EXE blocked to delete the exported excel">
      <Posts>
        <Post From="kamal_karthi" When="25/04/2013 07:15:59">
          <Html>
        &lt;div class="markDownOutput "&gt;HI &lt;br&gt;
&lt;br&gt;
In my ASP.net Application i did the excel Export from grid view by using EPPLUS DLL. before save that excel i want to delete the file excel if already exists in the folder.but first time the excel was Exported on the second time excel generation that excel
 file was not able to delete when excel file name is already exists and shows the error as
&lt;br&gt;
"System.IO.IOException: &lt;strong&gt;The process cannot access the file 'F:\Test\report.xlsx' because it is being used by another process&lt;/strong&gt;".
&lt;br&gt;
and also i was not able to delete the excel as manually that time error was thrown as
&lt;br&gt;
&lt;strong&gt;"The action can't be completed because the file is open in webdev.webserver.exe&lt;/strong&gt;".i m using vs2005 and sql 2005 with IIS 6.0
&lt;br&gt;
&lt;br&gt;
kindly do the needful to fix this error.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to close Spreadsheets">
      <Posts>
        <Post From="jokeruk" When="23/04/2013 16:59:15">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi all, &lt;br&gt;
I am using to process data from spreadsheets into SQL. &lt;br&gt;
The problem is that when I finish with a particular spreadsheet I can't see how to close it so that I can relocate it to a processed folder.
&lt;br&gt;
This results in a file locked error when I try to use it. &lt;br&gt;
&lt;br&gt;
I am currently using the spreadsheet = (new IO.Fileopen(filename).openread) &lt;br&gt;
&lt;br&gt;
and worksheet=spreadsheet.workbook.worksheets(n) to get to the worksheet(s) I need
&lt;br&gt;
&lt;br&gt;
I can't see how to close everything when I'm done though &lt;br&gt;
&lt;br&gt;
I know it's going to be simple but I am being dim! &lt;br&gt;
&lt;br&gt;
Kind Regards &lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Steve&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Adding Percentage Symbol to my datafield in Pivot table">
      <Posts>
        <Post From="Bhanu1423" When="18/04/2013 13:31:30">
          <Html>
        &lt;div class="markDownOutput "&gt;how to add Percentage Symbol to my datafield in Pivot table&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Edit A Chart's XML">
      <Posts>
        <Post From="kenchi09" When="17/04/2013 16:54:25">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi guys, &lt;br&gt;
&lt;br&gt;
Is it possible to edit a chart's XML? &lt;br&gt;
&lt;br&gt;
I have a worksheet named "Retailer Template" and it has 4 charts in it. My code replicates this worksheet over a number of times, and then it is deleted.
&lt;br&gt;
&lt;br&gt;
The problem is when the user tries to open the file, Excel 2010 shows up an error message saying that the file has unreadable content. I've been contemplating on this issue for almost a week now. And while I was debugging using breakpoints, I see in the chart's
 XML that it still has worksheet name references to the deleted template and not its own worksheet name.
&lt;br&gt;
&lt;br&gt;
I believe that the "unreadable content" Excel says originates in the chart's XML. Can there be a solution to this?
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Thanks,&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Text to Columns">
      <Posts>
        <Post From="MorthProject" When="16/04/2013 15:41:17">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi everyone,&lt;br&gt;
&lt;br&gt;
I'm trying to use Text to columns like in Excel, but I cant find any method to do it.&lt;br&gt;
&lt;br&gt;
I read a .csv file using FileInfo, I use LoadFromText to add the text to a worksheet with TextQualifier = '\"'.&lt;br&gt;
&lt;br&gt;
in my first column I have some values like 090, C30, 021... and when I open the xlsx file, the leading-zeros disappears :(&lt;br&gt;
&lt;br&gt;
so, I put a ' character before column A values (when .csv is created), but now when I open the xlsx file, I see that apostrophe.&lt;br&gt;
&lt;br&gt;
Using Office Interop.Excel, I use an Array and "Excel.Selection.TextToColumns", and works fine. But I dont wanna use Office Interop any more.&lt;br&gt;
&lt;br&gt;
is there any possibilities to do something like this with EPPlus??.&lt;br&gt;
&lt;br&gt;
Pd. I use NumberFormat.Format = "@"; without using the apostrophe but the leading-zeros disappears too.&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Hope U can help me :)&lt;br&gt;
Cheers, and thanks for this magnificent tool.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Error: invalid templatepath on server">
      <Posts>
        <Post From="macmullet" When="18/01/2012 20:32:52">
          <Html>
        
&lt;p&gt;My code is simple, it just opens an existing file using UNC path, modifies one cell and saves the file. &amp;nbsp;When I run the code locally, it works fine.&amp;nbsp;When I move this code to a company server and run it, I get an error: invalid templatepath.&lt;/p&gt;
&lt;p&gt;FileInfo template1 = new FileInfo("\\\\serverxyz\\Temp\\createbatch.xlsx");&lt;/p&gt;
&lt;p&gt;using (ExcelPackage p1 = new ExcelPackage(template1, true)) &amp;nbsp;{&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;The account the webserver code uses to access the folder above has full control permissions on the folder.&lt;/p&gt;
&lt;p&gt;I also tried:&lt;/p&gt;
&lt;p&gt;FileInfo template1 = new FileInfo(@"\\serverxyz\Temp\createbatch.xlsx");&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Any ideas? &amp;nbsp;Thanks.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="31/01/2012 18:53:33">
          <Html>
        
&lt;p&gt;If you havn't solved this already, try to read the file as byte array and open it in a memory stream to see if you can read the file into memory.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="aGit" When="30/03/2012 15:44:15">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Were you able to solve this issue ?&lt;/p&gt;
&lt;p&gt;I'm having exactly the same problem although I'm using:&lt;br&gt;
FileInfo template = new FileInfo(Directory.GetCurrentDirectory() + "myfile.xlsx"); [I'm running it locally]&lt;/p&gt;
&lt;p&gt;I'm working with C# for a week now, can you help on "reading the file as byte array and open it in a memory stream" ? &amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="achronister85" When="15/04/2013 14:19:13">
          <Html>
        &lt;div class="markDownOutput "&gt;you can solve this issue by changing the package statement to the following&lt;br&gt;
&lt;pre&gt;&lt;code&gt;using (ExcelPackage p = new ExcelPackage(new MemoryStream(), new MemoryStream(File.ReadAllBytes(System.Web.HttpContext.Current.Server.MapPath("Test.xlsx")))))
            {
            }&lt;/code&gt;&lt;/pre&gt;
I found this via &lt;br&gt;
&lt;br&gt;
&lt;a href="http://epplus.codeplex.com/discussions/354529" rel="nofollow"&gt;http://epplus.codeplex.com/discussions/354529&lt;/a&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Creating excel with 2D array">
      <Posts>
        <Post From="cooldude_18" When="14/04/2013 17:47:00">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
am having a huge dataset with 96000 rows and 65 cols. currently am using excel automation to form an excel sheet and download it via ASP.net application. this is working fine. Am using below code to udpate the data to excel sheet
&lt;br&gt;
&lt;br&gt;
oRange = oSheet.Range(oSheet.Cells(1, 1), oSheet.Cells(intRecordCount + 1, intColCount))
&lt;br&gt;
&lt;br&gt;
oRange.Value = strDataArray -- this is my 2d array &lt;br&gt;
&lt;br&gt;
am forming 2d array this because, am interacting with excel only once and hence it is faster.
&lt;br&gt;
&lt;br&gt;
am facing some deployment issues, because this requires excel to be installed in deplymnet server, which we don't want to do. so am looking for alternatives.
&lt;br&gt;
&lt;br&gt;
I have few quesetions&lt;br&gt;
&lt;ol&gt;
&lt;li&gt;Can i use EPPlus to solve my problem? do we need to install excel to use EPPlus?&lt;br&gt;
&lt;/li&gt;&lt;li&gt;is EPPlus efficient for huge dataset?&lt;br&gt;
&lt;/li&gt;&lt;li&gt;can i use 2D arrays and range in EPP to update the cell contents in one single interaction?&lt;br&gt;
&lt;/li&gt;&lt;/ol&gt;
kindly help. &lt;br&gt;
&lt;br&gt;
Thanks in advance.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Set default style (font) of workbook or worksheet?">
      <Posts>
        <Post From="daviddesloovere" When="13/04/2013 15:25:59">
          <Html>
        &lt;div class="markDownOutput "&gt;Is it possible to set a default style for the complete workboook or a worksheet?
&lt;br&gt;
Can find anything in the docs. I really hope I don't have to set everything by cell/row/range.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="NumberFormat for range where first row is null">
      <Posts>
        <Post From="anotherexceller" When="12/04/2013 17:46:14">
          <Html>
        &lt;div class="markDownOutput "&gt;Trying to format columns of dates. Everything works great when the first row of the range has data in it. If the first row is empty/null, however, the NumberFormat applied to the range seems to get ignored. How to get around this? Thanks!&lt;br&gt;
&lt;pre&gt;&lt;code&gt;            Dim colCount, r, c As Integer
            Using dv As DataView = GetCompleteContractData()
                colCount = dv.Table.Columns.Count - 1
                For c = 0 To colCount  'for each col
                    ws.Cells(1, c + 1).Value = dv.Table.Columns(c).ColumnName.Replace("_", " ")  'write out the header
                    For r = 0 To dv.Count - 1  'for each row
                        ws.Cells(r + 2, c + 1).Value = dv(r)(c)  'write out data
                    Next
                    If dv.Table.Columns(c).DataType = GetType(Date) Then  'format date columns
                        Using drng As ExcelRange = ws.Cells(2, c, r + 1, c)
                            drng.Style.Numberformat.Format = "mm/dd/yyyy"
                        End Using
                    End If
                Next
            End Using&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="When field contains formula, text is always empty string">
      <Posts>
        <Post From="LauraNichols" When="22/01/2013 23:31:08">
          <Html>
        
&lt;p&gt;I have an excel workbook that has multiple worksheets. The first worksheet has vlookups that pull from the other worksheets. I'm trying to copy the values from that first worksheet into a new workbook. I can successfully copy the values in the fields that
 do not have formulas, but the fields with formulas always show an empty string for the text property and null for the value property. I am seeing in the code that the formula property is set, so I know I'm accessing the field in the original worksheet, it's
 just not giving me the value. How can I get the value from the worksheet?&lt;/p&gt;
&lt;p&gt;Here's my code:&lt;/p&gt;
&lt;pre&gt;&lt;span&gt;foreach&lt;/span&gt;&amp;nbsp;(&lt;span&gt;ExcelRangeBase&lt;/span&gt;&amp;nbsp;sourceCell&amp;nbsp;&lt;span&gt;in&lt;/span&gt;&amp;nbsp;TTL.Cells[1,&amp;nbsp;1,&amp;nbsp;TTL.Dimension.End.Row,&amp;nbsp;TTL.Dimension.End.Column])
{
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;TTLNew.Cells[sourceCell.Address].Value&amp;nbsp;=&amp;nbsp;sourceCell.Text;
}&lt;/pre&gt;
&lt;p&gt;I have also tried copying over a range and that did not work either.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="xav2075" When="23/01/2013 03:24:51">
          <Html>
        
&lt;p&gt;Something like this will work (never mind that the formula does not correctly reference other cells but it is copied):-&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;      FileInfo xlsx_template = &lt;span style="color: blue;"&gt;new&lt;/span&gt; FileInfo(&lt;span style="color: rgb(163, 21, 21);"&gt;@"d:\test1.xlsx"&lt;/span&gt;);
      FileInfo new_xlsx_file = &lt;span style="color: blue;"&gt;new&lt;/span&gt; FileInfo(&lt;span style="color: rgb(163, 21, 21);"&gt;@"d:\test1-formula-copied.xlsx"&lt;/span&gt;);
      ExcelPackage excel_package = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(new_xlsx_file, xlsx_template);
      ExcelWorksheet excel_worksheet4 = excel_package.Workbook.Worksheets.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"Read one Formula From First Sheet From test1.xlsx"&lt;/span&gt;); &lt;span style="color: green;"&gt;// test1.xlsx has three worksheets&lt;/span&gt;
      &lt;span style="color: blue;"&gt;string&lt;/span&gt; test = excel_package.Workbook.Worksheets[&lt;span style="color: rgb(163, 21, 21);"&gt;"Sheet 1"&lt;/span&gt;].Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"B78"&lt;/span&gt;].Formula.ToString(); &lt;span style="color: green;"&gt;// Debugger says the value of string test is =SUM(B2:B77)&lt;/span&gt;
      excel_worksheet4.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;].Formula = excel_package.Workbook.Worksheets[&lt;span style="color: rgb(163, 21, 21);"&gt;"Sheet 1"&lt;/span&gt;].Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"B78"&lt;/span&gt;].Formula.ToString(); &lt;span style="color: green;"&gt;//Formula =SUM(B2:B77) is correctly copied to cell A1 on new worksheet&lt;/span&gt;
      excel_package.Save();

&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="JChristian11" When="30/01/2013 12:23:49">
          <Html>
        
&lt;p&gt;[Replay removed: placed in the wrong thread]&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="LauraNichols" When="30/01/2013 16:37:01">
          <Html>
        
&lt;p&gt;Thanks for posting, but I don't want to copy the formula, I already know how to do that. I want to copy the text or result of the formula which isn't working. The code you supplied copies the formula, not the result.&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JoshCouts" When="10/04/2013 02:30:58">
          <Html>
        &lt;div class="markDownOutput "&gt;I'm having the same issue - basically, if I add the formula dynamically via C#, the resulting value will show up as empty when queried - but, if I add that same formula manually in Excel, or if I manually save the file as a new file from Excel after I've
 added the formula via C#, it will deliver the value...quite strange and quite annoying.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Format Cell as Currency - pound sterling £">
      <Posts>
        <Post From="Emulvihill" When="09/04/2013 20:20:49">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
I'm trying to set a currency format like this &lt;br&gt;
ws.Cells("A1".Style.Numberformat.Format = """£""\ #,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00"
&lt;br&gt;
or just &lt;br&gt;
ws.Cells("A1".Style.Numberformat.Format = "£#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00" &lt;br&gt;
&lt;br&gt;
but in excel i see Â£ instead of £. digging around it seems like a conflicting encoding, something is converting between utf8 and codepage 1252 or the other way around maybe.
&lt;br&gt;
&lt;br&gt;
Can anyone help? &lt;br&gt;
&lt;br&gt;
Thanks.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Emulvihill" When="09/04/2013 20:38:41">
          <Html>
        &lt;div class="markDownOutput "&gt;Solved. &lt;br&gt;
&lt;br&gt;
It was because of the encoding of my source file. I think i just asked windows to create a new text file and started using that. I think my editor treated it as utf8 but didn't add a BOM so maybe technically it was corrupt, and then .net assumed it wasn't utf8
 so treated it as ascii and i got extra chars. so frustrating, i've been on this for hours! :)
&lt;br&gt;
&lt;br&gt;
So literally 2 minutes after posting that, i found the answer myself. Anyone know if there is a name for that?. If not, I officially name it Mulvihill's Law.
&lt;br&gt;
:)&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="InsertRow freezes application.">
      <Posts>
        <Post From="Wrightboy" When="09/04/2013 16:57:42">
          <Html>
        &lt;div class="markDownOutput "&gt;So I have have two decimal columns that I want to convert to a single combined statement: D1 x D2. The code for this is below, and it works perfectly the saved document is just what I want. But an issue showed up when I afterwards added in a call to InsertRow.
 The application just hangs there...no exceptions or anything...just sits. But, if I comment out the line with the formula everything works fine again.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;// If I comment this out, InsertRow works normally.
ws.Cells[1, 2, currentRow, 2].Formula = string.Format(@"CONCATENATE(TEXT({0},""## #/#""), "" x "", TEXT({1},""## #/#""))", new ExcelAddress("H1").Address, new ExcelAddress("I1").Address); 

// Will just hang here if the above isn't commented.
ws.InsertRow(1, 1); &lt;/code&gt;&lt;/pre&gt;
Any ideas what I'm doing wrong?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Wrightboy" When="09/04/2013 17:02:48">
          <Html>
        &lt;div class="markDownOutput "&gt;Hm, well I just discovered that if I move the starting row down from 1, to 2: "ws.Cells[2, 2, currentRow, 2]" then it goes back to working with the insert...but it does leave the first column blank without the formula. So that's no good. Not
 sure how to get around that.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Set Interval in X-Axis">
      <Posts>
        <Post From="darkxer0x" When="08/04/2013 11:36:33">
          <Html>
        &lt;div class="markDownOutput "&gt;Is there any way to set interval in x-axis?&lt;br&gt;
&lt;br&gt;
I have rows with hourly values, and I want an X-axis with daily intervals. In Interop:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;axis.TickLabels.NumberFormat = "d-mmm";
int weeksCollected = 1;
int recsPerDay = 24;
axis.TickLabelSpacing = recsPerDay * weeksCollected;
axis.TickMarkSpacing = recsPerDay * weeksCollected;&lt;/code&gt;&lt;/pre&gt;
In EPPLUS i have only:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;ExcelChartAxis axis = chart.XAxis;
axis.Format = "d-mmm";&lt;/code&gt;&lt;/pre&gt;
Thanks,&lt;br&gt;
Alberto&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Execute VBA Macros in runtime">
      <Posts>
        <Post From="Zubyme" When="05/04/2013 09:05:09">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi all, please help me &lt;br&gt;
How can i open exists exl, xlsx or xlsm file and run random macros saved in that files?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How do I show values as running total in EPPlus?">
      <Posts>
        <Post From="rohithshenoyg" When="21/11/2012 10:09:59">
          <Html>
        
&lt;p&gt;I am able to create a pivot table and set its data function to sum. I want the data field to be shown as running total, but I cant seem to figure out how to do this? Any help?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="rohithshenoyg" When="23/11/2012 06:17:31">
          <Html>
        
&lt;p&gt;Any help any one? I'm really stuck!&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="rohithshenoyg" When="12/12/2012 10:56:41">
          <Html>
        
&lt;p&gt;So, is there no way to change the calculation method to running total with Epplus? :(&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="rohithshenoyg" When="05/04/2013 06:50:47">
          <Html>
        &lt;div class="markDownOutput "&gt;It'd still be useful if somebody could help out here. I just want to set the calculation of a data field to anything other that no calculation. Specifically, running total. I just cant find the property / method I should use! :(
&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="New row insertion into existing named range cells">
      <Posts>
        <Post From="Sarathee4u" When="04/04/2013 08:17:22">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
Im using Epplus to create Excel 2010 from a existing excel template. In my existing template I have many Namedrange cells.
&lt;br&gt;
&lt;br&gt;
One of my case is, I have two named range cells one below one in a sheet. Consider each named range cells having 10 rows &amp;amp; 5 columns.
&lt;br&gt;
&lt;br&gt;
Dynamically im adding/inserting rows(more than 10 rows) into the 1st named range cells which increases(or changes) the row end postion of the first named rangecells.
&lt;br&gt;
&lt;br&gt;
By which the starting row position of the second named range cells also got changed .In this situation when i tried to insert/write values to the 2nd named range cells,
&lt;br&gt;
it is actually writing /inserting on the old row position. How to track the changed starting row position of the 2nd named range cells.
&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Does epplus support Comment shape?Customer height and width.">
      <Posts>
        <Post From="zestxjest" When="03/04/2013 13:25:00">
          <Html>
        &lt;div class="markDownOutput "&gt;I want to set the size of each comment. But i don't know how to do. &lt;br&gt;
Anyone know? &lt;br&gt;
Thanks.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to refresh value of CELL(&quot;filename&quot;) function">
      <Posts>
        <Post From="frewi" When="02/04/2013 13:41:44">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, I have a set of spreadsheets stored in a repository. I read one of these using EPPlus, and to be able to locate the other spreadsheets, I need to resolve the file path to the current file.
&lt;br&gt;
&lt;br&gt;
I know it is possible to use the CELL("filename") formula to do this. My problem is that if/when the files are moved to another folder, someone has to open the spreadsheet in excel to "refresh" the value for this function.
&lt;br&gt;
&lt;br&gt;
So my question is: &lt;br&gt;
&lt;br&gt;
Does someone knows if is possible to refresh this value without opening the spreadsheet in Excel, preferably using EPPlus. And if that is the case, please advice how to do it.
&lt;br&gt;
&lt;br&gt;
Br. &lt;br&gt;
Fredrik&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Does EPPlus Support Parallel Programing?">
      <Posts>
        <Post From="Pagina" When="02/04/2013 03:24:11">
          <Html>
        &lt;div class="markDownOutput "&gt;
&lt;pre&gt;&lt;code&gt;for(int row=0;row&amp;lt;rowLength;row++)
{
    for(int column=0;column&amp;lt;colLength;column++)
    {
         ws.SetVallue(row+2,column+1,value[IndexOf(column)][row]);
    }
}&lt;/code&gt;&lt;/pre&gt;
When the row is more than one millon, I want to use Parallel.For to speed up, But there some error. I want to know whether EPPlus Support Parallel Programing; Code as Follow&lt;br&gt;
&lt;pre&gt;&lt;code&gt;Parallel.For(0,rowLength,row=&amp;gt;
{
    for(int column=0;column&amp;lt;colLength;column++)
    {
         ws.SetVallue(row+2,column+1,value[IndexOf(column)][row]);
    }
});&lt;/code&gt;&lt;/pre&gt;
When Row is very large, the saving time cost is expensive. Do you plan to use parallel programing to improve the performance?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="HYperlink without display text">
      <Posts>
        <Post From="grimmdp" When="19/03/2013 20:46:35">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello, &lt;br&gt;
Is it possible to have an internal Hyperlink that has no display text so that it will just display the underlying cell value? I have a summary sheet that has cell formulas that total the values of the underlying data sheet, and I need to be able to click on
 a total and jump the user to the underlying data. &lt;br&gt;
&lt;br&gt;
I see that there is a constructor that takes a single string arg, but it's a Uri instead of a ReferenceAddress. Note that I also have places that DO have a label, and if I use the ReferenceAddress, String constructor it works fine.
&lt;br&gt;
&lt;br&gt;
Thanks for a great product, &lt;br&gt;
Dean&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="grimmdp" When="01/04/2013 23:43:00">
          <Html>
        &lt;div class="markDownOutput "&gt;So I figured out how to make this work, it's a matter of setting things in the right order. First, if you pass null to the ExcelHyperLink constructor, it causes EPPlus to leave the display attribute out of the hyperlink XML. Then set the formula, and it
 works:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;srcSht.Cells[srcRow, srcCol].Hyperlink = new ExcelHyperLink(dest_rng.FullAddress, null);
srcSht.Cells[srcRow, srcCol].Formula = "'Sheet2'!A5";&lt;/code&gt;&lt;/pre&gt;
Maybe as a future enhancement, passing null as the display text would tell EPPlus to create the hyperlink, but not blank out the existing formula/value if any.&lt;br&gt;
&lt;br&gt;
Hope this helps someone else,&lt;br&gt;
Dean&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Reading a .data file">
      <Posts>
        <Post From="oliveg" When="31/03/2013 06:15:25">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello, &lt;br&gt;
I am using EPPlus for the first time and am having a little trouble. &lt;br&gt;
I have a .data file that I need to read and write the data to an excel file. &lt;br&gt;
&lt;br&gt;
Could someone direct me to where I can find some information on this? &lt;br&gt;
&lt;br&gt;
Thank you!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="how to use FreezePanes">
      <Posts>
        <Post From="reddy506" When="22/07/2010 06:07:32">
          <Html>
        
&lt;p&gt;&lt;span style="font-size: x-small;"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Hi all,&lt;/p&gt;
&lt;p&gt;am facing a problem while using freezepanes.&lt;/p&gt;
&lt;p&gt;i am creating a excel.&lt;/p&gt;
&lt;p&gt;and i have to fix first 8 rows and i have columns of 15.&lt;/p&gt;
&lt;p&gt;am writing like this.&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;
&lt;p&gt;objSheet.View.FreezePanes(1, 15);&lt;/p&gt;
&lt;p&gt;objSheet.View.FreezePanes(2, 15);&lt;/p&gt;
&lt;p&gt;objSheet.View.FreezePanes(3, 15);&lt;/p&gt;
&lt;p&gt;objSheet.View.FreezePanes(4, 15);&lt;/p&gt;
&lt;p&gt;objSheet.View.FreezePanes(5, 15);&lt;/p&gt;
&lt;p&gt;objSheet.View.FreezePanes(6, 15);&lt;/p&gt;
&lt;p&gt;objSheet.View.FreezePanes(7, 15);&lt;/p&gt;
&lt;p&gt;objSheet.View.FreezePanes(8, 15);&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;but 7 rows it is fixing but 8 th row it is not fixing.&lt;/p&gt;
&lt;p&gt;and i have 15 columns .&lt;/p&gt;
&lt;p&gt;and i have each and every column width.&lt;/p&gt;
&lt;p&gt;&lt;span style="font-size: x-small;"&gt;worksheet.Column(1).Width = 35;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;worksheet.Column(2).Width = 20;&lt;/p&gt;
&lt;p&gt;worksheet.Column(3).Width = 20;&lt;/p&gt;
&lt;p&gt;worksheet.Column(4).Width = 20;&lt;/p&gt;
&lt;p&gt;worksheet.Column(5).Width = 20;&lt;/p&gt;
&lt;p&gt;worksheet.Column(6).Width = 20;&lt;/p&gt;
&lt;p&gt;worksheet.Column(7).Width = 20;&lt;/p&gt;
&lt;p&gt;worksheet.Column(8).Width = 20;&lt;/p&gt;
&lt;p&gt;worksheet.Column(9).Width = 20;&lt;/p&gt;
&lt;p&gt;worksheet.Column(10).Width = 20;&lt;/p&gt;
&lt;p&gt;worksheet.Column(11).Width = 20;&lt;/p&gt;
&lt;p&gt;worksheet.Column(12).Width = 20;&lt;/p&gt;
&lt;p&gt;worksheet.Column(13).Width = 20;&lt;/p&gt;
&lt;p&gt;worksheet.Column(14).Width = 20;&lt;/p&gt;
&lt;p&gt;worksheet.Column(15).Width = 20;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;but what happening exactly, is am able to generate excel.&lt;/p&gt;
&lt;p&gt;but as i said early 8 row is not freezed.&lt;/p&gt;
&lt;p&gt;and due to width am able to see till column F. and than i cant see the values after column F.&lt;/p&gt;
&lt;p&gt;even i scroll side it is not working.but i can scroll down.&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;please tell me how to use&amp;nbsp;&lt;span style="color: rgb(0, 128, 0); font-size: x-small;"&gt;&lt;span style="color: rgb(0, 128, 0); font-size: x-small;"&gt;FreezePanes option in excelpackage.&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(0, 128, 0); font-size: x-small;"&gt;&lt;span style="color: rgb(0, 128, 0); font-size: x-small;"&gt;Thanks in advance.&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(0, 128, 0); font-size: x-small;"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(0, 128, 0); font-size: x-small;"&gt;&amp;nbsp;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-size: x-small;"&gt;&amp;nbsp; &lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="rakerr" When="29/03/2013 17:03:59">
          <Html>
        &lt;div class="markDownOutput "&gt;You should just use the following line: &lt;br&gt;
&lt;br&gt;
objSheet.View.FreezePanes(9, 16); &lt;br&gt;
&lt;br&gt;
That call will freeze everything above and to the left of the specified cell.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Performance about the border style setting">
      <Posts>
        <Post From="it1077" When="29/03/2013 03:25:38">
          <Html>
        &lt;div class="markDownOutput "&gt;My excel have about 500 rows and 2800 columns. When I set the border style using the code
&lt;strong&gt;worksheet.Cells[1, 1, 500, 2800].Style.Border.Left.Style = ExcelBorderStyle.Thin&lt;/strong&gt;,it takes half a hour to do it. Why setting the border style is so slow?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="net datetimes and LoadFromDataTable">
      <Posts>
        <Post From="buckley" When="26/05/2011 12:52:44">
          <Html>
        
&lt;p&gt;Hello,&lt;/p&gt;
&lt;p&gt;Are .net datetimes support when using the method "LoadFromDataTable"? They are displayed as number with the current version 2.8.0.2&lt;/p&gt;
&lt;p&gt;Kind Regars, Tom&lt;/p&gt;
&lt;div id="_mcePaste" style="left: -10000px; top: 0px; width: 1px; height: 1px; overflow: hidden;"&gt;
﻿&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="26/05/2011 17:57:10">
          <Html>
        
&lt;p&gt;Yes, but you need to set the numberformat to a date format (something like worksheet.Cells["A1:A100"].Style.NumberFormat.Format="yyyy/mm/dd")&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="elshev" When="28/03/2013 18:01:18">
          <Html>
        &lt;div class="markDownOutput "&gt;But why do not use by default application's or system current regional settings for date? Though it's not cover all cases but cover good part of cases and better than some incomprehensible number.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Reading XML">
      <Posts>
        <Post From="the_Simian" When="12/05/2011 14:59:47">
          <Html>
        
&lt;p&gt;in Excel, theres a way to Open or Map an XML file into excel. It does a lot behind the scenes - it formats the XML into a readable document, creates a schema etc.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I'm aware that working with this library means I'd have to do all this myself - or at least it seems this way.&lt;/p&gt;
&lt;p&gt;I know you can read in an XML Document to a Data Set, and then put it in a Data Table, and then put it in a worksheet that way, but I wanted to ask for advice on the most streamlined way to, as best i can, duplicate this excel feature.&amp;nbsp; Perhaps there
 is something useful in the EPPlus project i'm overlooking, or I'm doing more work than necessary.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Anyways, any feedback is appreciated, and thank you for working on this invaluable project.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="12/05/2011 19:04:07">
          <Html>
        
&lt;p&gt;Semyon is currently working on implementing Xml mapping in EPPlus, but it is not finished yet and it will not be included in the next version.&lt;/p&gt;
&lt;p&gt;So at this point you have to do all the work reading the xml yourself.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="the_Simian" When="12/05/2011 20:21:25">
          <Html>
        
&lt;p&gt;Excellent to hear!&lt;/p&gt;
&lt;p&gt;I wish him the best in his endeavors.&lt;/p&gt;
&lt;p&gt;Also, thank you for the quick reply.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;When he is done, an already great project will be even better!&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="maddax" When="19/12/2012 10:30:50">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Did XML mapping make it in yet? I'd love to use that feature.&lt;/p&gt;
&lt;p&gt;Thanks,&lt;/p&gt;
&lt;p&gt;Matthew&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Andron" When="28/03/2013 12:35:10">
          <Html>
        &lt;div class="markDownOutput "&gt;Any news about xml mapping??? &lt;br&gt;
anyone knows?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Andron" When="28/03/2013 12:36:23">
          <Html>
        &lt;div class="markDownOutput "&gt;&lt;strong&gt;jankallman wrote:&lt;/strong&gt;&lt;br&gt;
&lt;blockquote&gt;Semyon is currently working on implementing Xml mapping in EPPlus, but it is not finished yet and it will not be included in the next version. So at this point you have to do all the work reading the xml yourself.&lt;br&gt;
&lt;/blockquote&gt;
what do you mean by saing -to do all the work reading the xml yourself.???&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Having trouble creating an excel spreadsheet">
      <Posts>
        <Post From="Rahlord" When="28/03/2013 03:41:36">
          <Html>
        &lt;div class="markDownOutput "&gt;I have been stuck on this for days and despite all of the help out there, none of these solutions have been working for me. What I want to do is create an excel file using the epplus library with some basic data in it that I am pulling from a stored procedure.
 This is the code that I have in my ExportDocument.cs file: &lt;br&gt;
&lt;pre&gt;&lt;code&gt;public static ExcelPackage CreateExcelDocument(int [] arr)
    {
        String path = @"D:\temp\testsheet3.xlsx";
        //FileInfo newFile = null;
        /*if (!File.Exists(path + "\\testsheet2.xlsx"))
            newFile = new FileInfo(path + "\\testsheet2.xlsx");
        else
            return newFile;*/
        using (ExcelPackage package = new ExcelPackage())
        {
            ExcelWorksheet ws = package.Workbook.Worksheets.Add("testsheet");

            ws.Cells["B1"].Value = "Number of Used Agencies";
            ws.Cells["C1"].Value = "Active Agencies";
            ws.Cells["D1"].Value = "Inactive Agencies";
            ws.Cells["E1"].Value = "Total Hours Volunteered";
            ws.Cells["B1:E1"].Style.Font.Bold = true;

            int x = 2;
            char pos = 'B';
            foreach (object o in arr)
            {
                String str = pos + x.ToString();
                ws.Cells[str].Value = o.ToString();
                if (pos &amp;gt; 'E')
                {
                    pos = 'B';
                    x++;
                }

                pos++;
            }
            //newFile.Create();
            //newFile.MoveTo(@"C:/testSheet.xlsx");
            //package.SaveAs(newFile);
            package.Save();
            /*Stream stream = File.Create(path);
            package.SaveAs(stream);
            stream.Close();*/

            //byte[] data = File.ReadAllBytes(path);
            //byte[] bin = package.GetAsByteArray();
            //String path = Path.GetTempPath();
            //File.WriteAllBytes(path, bin);
            //File.WriteAllBytes(path + "testsheet.xlsx", bin);
            //HttpContext.Current.Response.Write("&amp;lt;script&amp;gt;alert('"+ temp + "');&amp;lt;/script&amp;gt;");
            //System.Diagnostics.Process.Start(path + "\\testsheet.xlsx");

            return package;
        }

    }&lt;/code&gt;&lt;/pre&gt;
All the commented code is different things that I have found on the internet to try. Note that this a school organization and we are not using MVC. I am then using the codebehind file to pull this method like this:
&lt;br&gt;
&lt;pre&gt;&lt;code&gt;protected void GenerateReport(Object o, EventArgs e)
    {
        //NamingContainer.FindControl("ReportsControl").Visible = false;
        //NamingContainer.FindControl("ReportsGenerateControl").Visible = true;
        Session["reportSession"] = ddReport.SelectedItem.Value.ToString();


        int [] arr = new int [ReportRepository.GetAgencyCounts().Count];
        ReportRepository.GetAgencyCounts().CopyTo(arr, 0);

        ExcelPackage pck = ExportDocument.CreateExcelDocument(arr);
        /*try
        {
            byte [] data = ExportDocument.CreateExcelDocument(arr).GetAsByteArray();
            Response.Clear();
            Response.Buffer = true;
            Response.BinaryWrite(data);
            Response.AddHeader("content-length", data.Length.ToString());
            Response.ContentType = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";

            Response.Flush();
            Response.Close();
            Response.End();
        }
        catch (Exception ex) { }*/

        /*var stream = new MemoryStream();
        pck.SaveAs(stream);

        String filename = "myfile.xlsx";
        String contentType = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";
        var cd = new System.Net.Mime.ContentDisposition
        {
            Inline = false,
            FileName = filename
        };
        Response.AppendHeader("Content-Disposition", cd.ToString());
        stream.Position = 0;

        return File(stream, contentType, filename);*/

        /*Response.ContentType = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";
        Response.AppendHeader("Content-Disposition", "attachment; filename=" + file.Name);
        Response.TransmitFile(Path.GetFullPath(file.Name));
        Response.Flush();
        Response.Close();*/

        /*Response.ClearHeaders();
        Response.BinaryWrite(pck.GetAsByteArray());
        Response.ContentType = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";
        Response.AddHeader("content-disposition", "attachment;  filename=Sample2.xlsx");
        Response.Flush();
        Response.Close();*/
    }&lt;/code&gt;&lt;/pre&gt;
Again note that all the commented code is things that I have found from various sources that have not worked.
&lt;br&gt;
&lt;br&gt;
So I am not getting any errors but when I click the button on my application to execute the codebehind method, nothing is happening. It is loading and it runs through but there are no files created, nothing is opening up. This is the first time I have ever
 used epplus and I am not wholly familiar with exporting things to excel programmatically so I feel lost here.
&lt;br&gt;
&lt;br&gt;
Are there any suggestions that you guys have? I would be happy to clarify any points that I have not hit upon fully as well.
&lt;br&gt;
&lt;br&gt;
Thanks&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="IS Import Xml feature implemented?">
      <Posts>
        <Post From="Andron" When="27/03/2013 21:14:21">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
I was reading in some very old posts that the XML importing feature is going to be implemented in EPPLus. Is it currently implemented?
&lt;br&gt;
How can I Import data to a excel document that has a XML mapped to its cells. I can't use the interop services, because the excel file is big and I use many technics from EPPLUS library to fill it with data. Or should I rewrite all this fillings by Interop
 library?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to delete an existing table?">
      <Posts>
        <Post From="kdalons" When="20/06/2011 05:17:47">
          <Html>
        
&lt;p&gt;I need to "repopulate/resize" an existing table in an Excel 2007 spreadsheet...&lt;/p&gt;
&lt;p&gt;I saw the discussion&amp;nbsp;&lt;a href="http://epplus.codeplex.com/discussions/253630" rel="nofollow"&gt;http://epplus.codeplex.com/discussions/253630&lt;/a&gt;&amp;nbsp;which discusses reusing tables, but I am not familiar with the advanced technique of modifying the table attributes using
 the TableXml feature...&lt;/p&gt;
&lt;p&gt;It seems a simpler solution for me would be to just remove the table and recreated it, but table removal does not appear to be supported in 2.9.0.1 either, is there a way to do this using an advanced technique...&lt;br&gt;
&lt;br&gt;
Is there any documentation on either of the above advanced techniques or can any provide some sample code showing how to do either?&lt;/p&gt;
&lt;p&gt;Thanks in advance!&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="22/06/2011 19:36:15">
          <Html>
        
&lt;p&gt;I haven't implemented a delete method for tables or resizing, but I guess i should.&amp;nbsp; The suggestion in the discussion is undocumented and I have not done it.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="red1939" When="28/01/2013 12:09:56">
          <Html>
        
&lt;p&gt;Could you propose a brief guideline how this could be implemented? I assume that deleting should be done through the ExcelTableCollection and resizing could be implemented through Ref?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="melkin" When="26/03/2013 21:49:37">
          <Html>
        &lt;div class="markDownOutput "&gt;any update on this ? it does not seem to be any other way to remove the existing worksheet table - I have noticed the Remove() method has been added to the Drawings collection in the latest update - could you please do same for worksheet.Tables ?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Allow Users to Edit Ranges">
      <Posts>
        <Post From="grobelny" When="26/03/2013 10:30:30">
          <Html>
        &lt;div class="markDownOutput "&gt;Is it possible to create a document using EPPlus that would have the functionality that can be achieved from Excel GUI using Review tab -&amp;gt; Changes group -&amp;gt; Allow Users to Edit Ranges?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Range Selection for clustered column chart">
      <Posts>
        <Post From="sagar_inty" When="25/03/2013 11:32:11">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi All, &lt;br&gt;
I have the data which looks like this. &lt;br&gt;
&lt;br&gt;
Design pass fail todo na blk &lt;br&gt;
design1 10 20 12 3 5 &lt;br&gt;
design2 13 12 14 3 3 &lt;br&gt;
design3 11 13 1 1 4 &lt;br&gt;
&lt;br&gt;
I need to generate a clustered column graph in which x-axis contains pass, fail, todo,na and blk groups and Y-Axis contains numbers. and bars/columns should indicate different designs.
&lt;br&gt;
&lt;br&gt;
I am struck at selecting the range to generate proper graph. &lt;br&gt;
Could anyone help me to get out of this blocking issue? &lt;br&gt;
&lt;br&gt;
Thanks and Regards &lt;br&gt;
Sagar G K&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Is there any facility to use EPPlus as ActiveX Component?">
      <Posts>
        <Post From="datadevices" When="23/03/2013 13:46:35">
          <Html>
        &lt;div class="markDownOutput "&gt;Dear all, &lt;br&gt;
&lt;br&gt;
Is there any facility to use EPPlus as an ActiveX? &lt;br&gt;
&lt;br&gt;
Or can someone provide a COM Callable Wrapper? &lt;br&gt;
&lt;br&gt;
Because the development tool / language we use is Alaska - Visual Xbase++ and it supports only ActiveX and not any direct .NET library.
&lt;br&gt;
&lt;br&gt;
Thanks in advance, &lt;br&gt;
&lt;br&gt;
Jacob&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Joining date from multiple Worksheets using LINQ">
      <Posts>
        <Post From="kst" When="22/03/2013 15:54:37">
          <Html>
        &lt;div class="markDownOutput "&gt;Is there any way to join data from multiple worksheets using LINQ? &lt;br&gt;
All worksheets have a column that serves as a key.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="xav2075" When="23/03/2013 00:26:13">
          <Html>
        &lt;div class="markDownOutput "&gt;It may be more efficient to query the data within Excel using SQL queries and VBA macros unless you have a specific need to get the data outside of Excel to manipulate in a .NET program using Epplus.
&lt;br&gt;
&lt;br&gt;
Have a look at this stackoverflow.com thread &lt;a href="http://stackoverflow.com/questions/8756802/excel-function-to-make-sql-like-queries-on-worksheet-data" rel="nofollow"&gt;
http://stackoverflow.com/questions/8756802/excel-function-to-make-sql-like-queries-on-worksheet-data&lt;/a&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to make columns to be auto width when texts in columns are long?">
      <Posts>
        <Post From="penganleang" When="22/03/2013 10:14:17">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
How to make columns to be auto width when texts in columns are long? &lt;br&gt;
&lt;br&gt;
I use this code worksheet.Column(colIndex).autofitColumn() on all column or worksheet.cells.autofitColumns(), And it's not working
&lt;br&gt;
&lt;br&gt;
Is there any ways to make it work? &lt;br&gt;
&lt;br&gt;
Note &lt;br&gt;
Some of my texts use Unicode. &lt;br&gt;
Thank&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="BorderAround2">
      <Posts>
        <Post From="penganleang" When="21/03/2013 17:58:52">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
How to create borderAround2 method like in excel com object? &lt;br&gt;
&lt;br&gt;
It borderAround Method, it just draws line of left, right, top and bottom so is there anyways which can draw another more diagonal line as well?
&lt;br&gt;
&lt;br&gt;
Thank&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="penganleang" When="22/03/2013 03:46:37">
          <Html>
        &lt;div class="markDownOutput "&gt;I can answer it by myself now &lt;br&gt;
&lt;br&gt;
All you have to do is: &lt;br&gt;
&lt;br&gt;
1) Select range of cells which you want to make border around &lt;br&gt;
2) put border style to left, right, top, bottom and diagonal &lt;br&gt;
&lt;br&gt;
Done&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to get the width and height of an existing shape and picture?">
      <Posts>
        <Post From="jxnim" When="21/03/2013 10:19:37">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi all, &lt;br&gt;
&lt;br&gt;
I am trying to get the width and height of an existing shape in a template. &lt;br&gt;
&lt;br&gt;
Does anyone know how can I achieve that? It seems like EPPlus doesn't have a function to do that.
&lt;br&gt;
&lt;br&gt;
Thank you in advance.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Pivot Chart in EXCEL">
      <Posts>
        <Post From="Bhanu1423" When="21/03/2013 07:59:56">
          <Html>
        &lt;div class="markDownOutput "&gt;Can i create Pivot chart in Excel ... through EPPLUS&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="ExcelPackage file size limit?">
      <Posts>
        <Post From="tlaford" When="20/03/2013 18:59:21">
          <Html>
        &lt;div class="markDownOutput "&gt;I have written a web application that reads a database, creates an ExcelPackage in memory, and downloads the XLSX file to the client PC. This works great for small data sets and big data sets (up to about 1500 rows * 160 columns). But if the data set increases
 any larger (2000 rows) EXCEL can not open the file. When I save the file on my PC and try to open it in EXCEL 2007, an error is displayed saying:
&lt;br&gt;
&lt;br&gt;
Excel cannot open the file 'XXX.xlsx' because the file format or file extension is not valid. Verify that the file has not been corrupted and that the file extension matches the format of the file.
&lt;br&gt;
&lt;br&gt;
Does anyone have any ideas why this works for "smaller" data sets but not larger data sets?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="tlaford" When="20/03/2013 19:11:20">
          <Html>
        &lt;div class="markDownOutput "&gt;I opened my excel file using notepad and a System.ApplicationException was embedded in the file. I searched for that exception and it led me
&lt;br&gt;
&lt;a href="http://labs.episerver.com/en/Blogs/Svante-Seleborg/Dates/2008/10/IsolatedStorage-Access-Denied/" rel="nofollow"&gt;here&lt;/a&gt; for the solution.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="VBA Macros do not work with EPPlus 3.1 &amp;amp; Pie charts do not work in 3.0.0.2">
      <Posts>
        <Post From="nitsmule" When="20/03/2013 18:47:43">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello,&lt;br&gt;
&lt;br&gt;
I am using a macro enabled (.XLSM) template to generate excel files using EPPlus. If I use the 3.1 version of this DLL, then I run into an issue. Files are generated fine but the macros are disabled. I have a button on the sheet that triggers the macro. But
 in generated excel files, the button does not trigger the macro at all. If I run the macro on its own, it runs fine. My code implements the template using the "using" block, which means I should ideally not worry about disposing the excelPackage
 variable. &lt;br&gt;
&lt;br&gt;
I tried downgrading the DLL to v3.0.0.2. Problem I mentioned above is solved now. But there is another problem. For one of my excel based reports, I am detecting a pie chart on a sheet and modifying its attributes using EPPlus.
&lt;br&gt;
&lt;br&gt;
I am using following code to read pie chart - &lt;br&gt;
&lt;br&gt;
var chart = (OfficeOpenXml.Drawing.Chart.ExcelChart)ws.Drawings[rpTemplate.ChartName];&lt;br&gt;
&lt;br&gt;
if (chart == null)&lt;br&gt;
{&lt;br&gt;
&lt;pre&gt;&lt;code&gt;    chart = (OfficeOpenXml.Drawing.Chart.ExcelPieChart)ws.Drawings[0];
&lt;/code&gt;&lt;/pre&gt;
}&lt;br&gt;
&lt;br&gt;
For EPPlus v3.0.0.2, this code throws an exception in first line - &lt;br&gt;
var chart = (OfficeOpenXml.Drawing.Chart.ExcelChart)ws.Drawings[rpTemplate.ChartName];&lt;br&gt;
&lt;br&gt;
The exception is - &lt;br&gt;
Index was out of range. Must be non-negative and less than the size of the collection.&lt;br&gt;
Parameter name: index&lt;br&gt;
&lt;br&gt;
Following is the StackTrace - &lt;br&gt;
&lt;pre&gt;&lt;code&gt;    StackTrace  "   at System.Collections.Generic.List`1.get_Item(Int32 index)\r\n   at OfficeOpenXml.Drawing.Chart.ExcelChartSeries.get_Item(Int32 PositionID)\r\n   at OfficeOpenXml.Drawing.Chart.ExcelPieChart.GetChartType(String name)\r\n   at OfficeOpenXml.Drawing.Chart.ExcelChart..ctor(ExcelDrawings drawings, XmlNode node, Uri uriChart, PackagePart part, XmlDocument chartXml, XmlNode chartNode)\r\n   at OfficeOpenXml.Drawing.Chart.ExcelPieChart..ctor(ExcelDrawings drawings, XmlNode node, Uri uriChart, PackagePart part, XmlDocument chartXml, XmlNode chartNode)\r\n   at OfficeOpenXml.Drawing.Chart.ExcelChart.GetChart(XmlElement chartNode, ExcelDrawings drawings, XmlNode node, Uri uriChart, PackagePart part, XmlDocument chartXml, ExcelChart topChart)\r\n   at OfficeOpenXml.Drawing.Chart.ExcelChart.GetChart(ExcelDrawings drawings, XmlNode node)\r\n   at OfficeOpenXml.Drawing.ExcelDrawing.GetDrawing(ExcelDrawings drawings, XmlNode node)\r\n   at OfficeOpenXml.Drawing.ExcelDrawings.AddDrawings()\r\n   at OfficeOpenXml.Drawing.ExcelDrawings..ctor(ExcelPackage xlPackage, ExcelWorksheet sheet)\r\n   at OfficeOpenXml.ExcelWorksheet.get_Drawings()\r\n   at Queue_Manager.AdHocExcelReport.ExportToSheet(ExcelWorkbook workbook, ExcelWorksheet ws, Int32 iSheetNo, Int32 sessionID, TemplateSheet templateSheet, Int32 templateID, SqlConnection sqlConn, Int32 taskID) in C:\\Users\\mule\\Documents\\M&amp;amp;TDev\\Application1\\QM RS\\QM\\Queue Manager\\AdHocExcelReport.cs:line 714\r\n   at Queue_Manager.AdHocExcelReport.MakeAdHocExcelReport(Int32 templateID, Int32 sessionID, String userName, String userEmail, String server, String strSheetName, String strDownloadTemplateName, String database, Int32 taskID) in C:\\Users\\mule\\Documents\\M&amp;amp;TDev\\Application1\\QM RS\\QM\\Queue Manager\\AdHocExcelReport.cs:line 142\r\n   at Queue_Manager.QueueManager.RunQueue(String strServer, String strDatabase, String strSheetName, String strDownloadTemplateName, Boolean blnDebug) in C:\\Users\\mule\\Documents\\M&amp;amp;TDev\\Application1\\QM RS\\QM\\Queue Manager\\QueueManager.cs:line 339"   string&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to detect error when read existing validations from package?">
      <Posts>
        <Post From="sr_codeplex" When="20/03/2013 16:51:42">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello, &lt;br&gt;
Is there any ways to check data validation error(green tag on top left of cell) while reading input value from package when user pasting invalid data into a cell, I need to throw that exception back to user for correct it.
&lt;br&gt;
&lt;br&gt;
Thank in advance.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Add Great Than Condition Format">
      <Posts>
        <Post From="Phinehas" When="18/02/2013 01:51:12">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
I'm trying to add great than condition format to Excel. However, I cannot find any function that can set the rule (e.g. set Red color for all value great than 1000). How can I set the rule?
&lt;br&gt;
&lt;br&gt;
My coding is following:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;            ExcelAddress formatAddress = new ExcelAddress("A1");
            ws.ConditionalFormatting.AddGreaterThan(formatAddress);
            OfficeOpenXml.ConditionalFormatting.Contracts.IExcelConditionalFormattingRule conditionalFormat = ws.ConditionalFormatting[ws.ConditionalFormatting.Count - 1];
            conditionalFormat.Style.Fill.PatternType = OfficeOpenXml.Style.ExcelFillStyle.Solid;
            conditionalFormat.Style.Fill.BackgroundColor.Color = System.Drawing.Color.Red;
            &lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="grimmdp" When="19/03/2013 20:30:52">
          <Html>
        &lt;div class="markDownOutput "&gt;All you need to do is assign the result of AddGreaterThan to a variable, then set its values. Here's how I do a NotBetween condition:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;ExcelAddress addr = new ExcelAddress(myrange.Address);
IExcelConditionalFormattingNotBetween cond = sheet.ConditionalFormatting.AddNotBetween(addr);
String first_cell = sheet.Cells[y, x].Address;
cond.Formula = "IF(" + first_cell + "&amp;lt;-1,1,0)";
cond.Formula2 = "IF(" + first_cell + "&amp;gt;1,1,0)";
&lt;/code&gt;&lt;/pre&gt;
Then modify cond.Style to suit your needs. &lt;br&gt;
&lt;br&gt;
Hope this helps, &lt;br&gt;
Dean&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to autosize columns?">
      <Posts>
        <Post From="MadBoy" When="04/07/2010 16:55:59">
          <Html>
        
&lt;p&gt;Hello,&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Is there a way to autosize columns so that it always extends the column to fit the size of data? Or how to do it manually so that one could go thru all rows in one column and see the longest size and then apply that size for column?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;With regards,&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;MadBoy&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="05/07/2010 07:19:56">
          <Html>
        
&lt;p&gt;No, you have to use the Column.width to adjust the size.&lt;/p&gt;
&lt;p&gt;(It would be very hard to get autosize&amp;nbsp;to work as expected, since you need to measure the formated text. To do that you have to to implement Excel number-formats and calculate output from formulas, and thats just to much work to do)&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="MadBoy" When="05/07/2010 08:13:58">
          <Html>
        
&lt;p&gt;&lt;span style="color: rgb(0, 0, 0);"&gt;&lt;span style='font-family: "Segoe UI","Microsoft Sans Serif",Arial,Geneva,Sans-Serif;'&gt;Hello,&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(0, 0, 0);"&gt;&lt;span style='font-family: "Segoe UI","Microsoft Sans Serif",Arial,Geneva,Sans-Serif;'&gt;How can I measure formated text then so I can at least set some values for Column.Width based on text.&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(0, 0, 0);"&gt;&lt;span style='font-family: "Segoe UI","Microsoft Sans Serif",Arial,Geneva,Sans-Serif;'&gt;MadBoy&lt;br&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="05/07/2010 08:27:21">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;There is not support for that in the component, but i guess you can always loop the values and use the GDI to measure the text...&lt;/p&gt;
&lt;p&gt;Something like...&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;for&lt;/span&gt;(&lt;span style="color: blue;"&gt;int&lt;/span&gt; row=1;row&amp;lt;=worksheet.Dimension.End.Row;row++)
{
  &lt;span style="color: blue;"&gt;string&lt;/span&gt; value=worksheet.Cells[row, yourColumn].Value;
  &lt;span style="color: green;"&gt;//the code to measure the text.&lt;/span&gt;
}
&lt;/pre&gt;
&lt;pre&gt;/Jan&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="MadBoy" When="05/07/2010 11:51:58">
          <Html>
        I've done it following way: &lt;br&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;
        private static void setColumnWidth(ExcelWorksheet ws, int dataRows, int dataColumns, string textToAdd) {
            double cellSize = ws.Cells[dataRows, dataColumns].Worksheet.Column(dataColumns).Width;
            double proposedCellSize = textToAdd.Trim().Length * 1.3;
            if (cellSize &amp;lt;= proposedCellSize) {
                ws.Cells[dataRows, dataColumns].Worksheet.Column(dataColumns).Width = proposedCellSize;
            }
        }
&lt;/span&gt;&lt;/pre&gt;
&lt;br&gt;
So I'm always checking for current cell size (so I don't have it set to lower then its already set), and I'm executing this method every time I add some new data.
&lt;br&gt;
&lt;br&gt;
This approach may not be the best as it doesn't take many things in consideration but it looks pretty okay. Probably it could use some work and depending on font size, font choice could be changed. Right now I've set length * double const 1.3 which is blind
 shot :-) &lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="nimdakiller" When="08/11/2010 13:17:17">
          <Html>
        
&lt;p&gt;Thank you very much. Indeed help me a lot in fitting column values.&lt;/p&gt;
&lt;p&gt;Thank you very much also to Jan for the fantastic library.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="MadBoy" When="08/11/2010 13:36:32">
          <Html>
        
&lt;p&gt;Glad you find it useful. I wish someone would extend it to take into cosnideration size of text and font ;-) Or like Jan said GDI to measure text.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="esteuart" When="29/12/2010 18:13:14">
          <Html>
        
&lt;p&gt;I wrote a method to measure the string. It seems pretty accurate, at least on the dataset I've been testing...&lt;/p&gt;
&lt;p&gt;First, replace the proposedCellSize definition with this:&lt;/p&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: blue;"&gt;double&lt;/span&gt; proposedCellSize = EstimateSize(textToAdd, ws.Cells[dataRows, dataColumns].Style);
&lt;/pre&gt;
&lt;p&gt;Next, declare your EstimateSize method:&lt;/p&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;private&lt;/span&gt; &lt;span style="color: blue;"&gt;double&lt;/span&gt; EstimateSize(&lt;span style="color: blue;"&gt;string&lt;/span&gt; text, &lt;span style="color: rgb(43, 145, 175);"&gt;ExcelStyle&lt;/span&gt; s)
{
    &lt;span style="color: blue;"&gt;using&lt;/span&gt; (&lt;span style="color: rgb(43, 145, 175);"&gt;Bitmap&lt;/span&gt; i = &lt;span style="color: blue;"&gt;new&lt;/span&gt; &lt;span style="color: rgb(43, 145, 175);"&gt;Bitmap&lt;/span&gt;(100, 100))
    {
        &lt;span style="color: blue;"&gt;using&lt;/span&gt; (&lt;span style="color: rgb(43, 145, 175);"&gt;Graphics &lt;/span&gt;g = &lt;span style="color: rgb(43, 145, 175);"&gt;Graphics&lt;/span&gt;.FromImage(i))
        {
             &lt;span style="color: blue;"&gt;using&lt;/span&gt; (&lt;span style="color: rgb(43, 145, 175);"&gt;Font &lt;/span&gt;f = &lt;span style="color: blue;"&gt;new&lt;/span&gt; &lt;span style="color: rgb(43, 145, 175);"&gt;Font&lt;/span&gt;(s.Font.Name, s.Font.Size))
             {
                 &lt;span style="color: blue;"&gt;return&lt;/span&gt; .146 * g.MeasureString(text.ToString(), f).Width;
             }
         }
     }
}
&lt;/pre&gt;
&lt;p&gt;The constant .146 is (from my testing) the ratio between pixels and whatever unit of measure excel uses for column widths.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="MadBoy" When="29/12/2010 18:20:17">
          <Html>
        
&lt;p&gt;Hello,&lt;/p&gt;
&lt;p&gt;Thanks for this. I've just tested it and it seems to do fine job. We will see how it goes in production :-)&lt;/p&gt;
&lt;p&gt;With regards,&lt;/p&gt;
&lt;p&gt;MadBoy&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="yuvalw123" When="03/02/2011 18:26:15">
          <Html>
        
&lt;p&gt;If most of the values is letters/digits so this could be an estimate:&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: green;"&gt;// Get all column's cells&lt;/span&gt;
ExcelRange columnCells = sheet.Cells[sheet.Dimension.Start.Row, columnIndex, sheet.Dimension.End.Row, columnIndex];

&lt;span style="color: green;"&gt;// Check what is the longest string and set the length&lt;/span&gt;
&lt;span style="color: blue;"&gt;int&lt;/span&gt; maxLength = columnCells.Max(cell =&amp;gt; cell.Value.ToString().Count(c =&amp;gt; &lt;span style="color: blue;"&gt;char&lt;/span&gt;.IsLetterOrDigit(c)));

sheet.Column(columnIndex).Width = maxLength + 2;&lt;span style="color: green;"&gt; // 2 is just an extra buffer for all that is not letter/digits.&lt;/span&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;span style="color: green;"&gt;&lt;br&gt;Works for me so far...&lt;br&gt;&lt;br&gt;&lt;/span&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="nervoux" When="09/02/2012 17:21:51">
          <Html>
        
&lt;p&gt;Any news if this feature will be implemented in any time in the future ?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thx 4 Any Answer&lt;/p&gt;
&lt;p&gt;\.Andrea&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="12/02/2012 15:25:11">
          <Html>
        
&lt;p&gt;Range.AutoSizeColumns or Column.AutoSize was implemented in version 2.9, so it should solve your problem.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="ecaplock" When="23/03/2012 04:49:16">
          <Html>
        
&lt;p&gt;Hi, Jan&lt;/p&gt;
&lt;p&gt;I created the column name with Datatable column name like the following. So, How I can do column autosize ?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;    &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; dt &lt;span style="color: blue;"&gt;as&lt;/span&gt; DataTable = GetDataSource()
    &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; colIndex &lt;span style="color: blue;"&gt;As&lt;/span&gt; &lt;span style="color: blue;"&gt;Integer&lt;/span&gt; = 1
    &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; rowIndex &lt;span style="color: blue;"&gt;As&lt;/span&gt; &lt;span style="color: blue;"&gt;Integer&lt;/span&gt; = 2
  
  &lt;span style="color: blue;"&gt;For&lt;/span&gt; &lt;span style="color: blue;"&gt;Each&lt;/span&gt; dc &lt;span style="color: blue;"&gt;As&lt;/span&gt; DataColumn &lt;span style="color: blue;"&gt;In&lt;/span&gt; dt.Columns

                &lt;span style="color: green;"&gt;'Creating Headings&lt;/span&gt;
                &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; cell = ws.Cells(rowIndex, colIndex)

                &lt;span style="color: green;"&gt;'Setting Value in cell&lt;/span&gt;

                cell.Value = dc.ColumnName
                colIndex += 1
   &lt;span style="color: blue;"&gt;Next&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
Thank you.
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="azorr" When="04/04/2012 03:13:52">
          <Html>
        
&lt;p&gt;Autofit works well, thanks! ecaplock, you would do:&lt;/p&gt;
&lt;p&gt;ws.Columns(1).AutoFit()&lt;/p&gt;
&lt;p&gt;(This is C# format, you will need to translate to VB).&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="pashkatarakashka" When="19/03/2013 18:50:28">
          <Html>
        &lt;div class="markDownOutput "&gt;There is no AutoFit in the version that I've downloaded. How to auto-fit the column?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Autofit cell">
      <Posts>
        <Post From="pashkatarakashka" When="19/03/2013 18:49:19">
          <Html>
        &lt;div class="markDownOutput "&gt;From what I googled there are suggestions to use ws.Columns(1).AutoFit(), but there is no such method in the latest version. I also found bestfit boolean property for cell, but still this has no effect. Any idea how to make the cell fit auto adjust based
 on content?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to Auto fit the width?">
      <Posts>
        <Post From="pashkatarakashka" When="19/03/2013 18:48:53">
          <Html>
        &lt;div class="markDownOutput "&gt;From what I googled there are suggestions to use ws.Columns(1).AutoFit(), but there is no such method in the latest version. I also found bestfit boolean property for cell, but still this has no effect. Any idea how to make the cell fit auto adjust based
 on content?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="WordArt">
      <Posts>
        <Post From="gwoody1984" When="19/03/2013 16:13:23">
          <Html>
        &lt;div class="markDownOutput "&gt;Is it possible to insert word art into an excel sheet. I am trying to mock up a "watermark" on all sheets and have not been able to determine if there is an a decent analog.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Zoomscale Property">
      <Posts>
        <Post From="namit101" When="04/03/2012 01:47:17">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I tried calling&amp;nbsp;&lt;/p&gt;
&lt;p&gt;ExcelWorksheet.View.ZoomScale&lt;/p&gt;
&lt;p&gt;In order to attempt to set the default zoom. &amp;nbsp;I can't figure out what proper values for it should be and there don't seem to be any examples. &amp;nbsp;Any time I run it (with whatever values I choose), I get an error:&lt;/p&gt;
&lt;p&gt;KeyNotFoundException - "The given key was not present in the dictionary"&lt;/p&gt;
&lt;p&gt;Not sure at all what this means, but is Zoomscale currently supported? &amp;nbsp;And, if it is, how do I use it?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Dunc_" When="19/03/2013 09:28:32">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
This seems to be working in v3.1.2 at least, e.g.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;using (var package = new ExcelPackage(new FileInfo(@"c:\file.xlsx"), true))
{
    ExcelWorksheet ws = package.Workbook.Worksheets[1];
    ws.View.ZoomScale = 78;
    package.Save();
}&lt;/code&gt;&lt;/pre&gt;
This sets the zoom level of the first worksheet to 78%.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Template with data on Sheet1  and Chart on the Sheet1">
      <Posts>
        <Post From="rohitmca" When="18/03/2013 12:08:21">
          <Html>
        &lt;div class="markDownOutput "&gt;I have a template with two sheets, &lt;br&gt;
Sheet1 has 2 columns with data. &lt;br&gt;
Sheet2 has bar Chart corresponding to 2 columns on Sheet1. &lt;br&gt;
&lt;br&gt;
Now I want to generate an excel in which when i update the data on Sheet1 manually the corresponding Chart on Sheet2 also gets updated.
&lt;br&gt;
&lt;br&gt;
I am able to do the same thing when the data and chart are on the same sheet. But i am not able to do it when the data and chart are on different sheets.
&lt;br&gt;
&lt;br&gt;
&lt;strong&gt;Here is my working code when data and chart are on same sheet :-&lt;/strong&gt;
&lt;br&gt;
&lt;br&gt;
string connectionString = "mydbconnstring";&lt;br&gt;
&lt;pre&gt;&lt;code&gt;        FileInfo template = new FileInfo(Server.MapPath("GraphTemplate.xlsx"));
        using (ExcelPackage p = new ExcelPackage(template, true))
        {
            //Select worksheet and set the start rows for data
            ExcelWorksheet ws = p.Workbook.Worksheets[1];

            int startRow = 1;
            int row = startRow;

            //Connect to the database and fill the data
            using (SqlConnection sqlConn = new SqlConnection(connectionString))
            {
                sqlConn.Open();
                using (SqlCommand sqlCmd = new SqlCommand("SELECT CurrencyRateDate, SUM(Case when ToCurrencyCode = 'JPY' Then EndOfDayRate Else 0 END) AS [JPY] FROM [Sales].[CurrencyRate]  where [FromCurrencyCode]='USD' AND ToCurrencyCode in ('JPY', 'EUR', 'GBP') GROUP BY CurrencyRateDate  ORDER BY CurrencyRateDate", sqlConn))
                {
                    using (SqlDataReader sqlReader = sqlCmd.ExecuteReader())
                    {
                        // get the data and fill rows
                        int i = 1;
                        while (sqlReader.Read())
                        {
                            ws.Cells[row, 1].Value = "Flight " + i;
                            ws.Cells[row, 2].Value = sqlReader[1];
                            row++;
                            i++;
                            if (row &amp;gt; 40)
                                break;
                        }
                    }                        
                }
            }

            //Set the series for the chart. The series must exist in the template or the program will crash.
            ExcelBarChart chart = ((ExcelBarChart)wsGraph.Drawings["BarChart"]);

            chart.Series.Add(ExcelRange.GetAddress(1, 2, row - 1, 2), ExcelRange.GetAddress(1, 1, row - 1, 1));

&lt;/code&gt;&lt;/pre&gt;
The above code is working if i have the chart and data on sheet[1]. __I am not able to decipher how to do the same when the chart is on other sheet. __
&lt;br&gt;
&lt;br&gt;
Although i can get the reference of second sheet with graph in the following way:-
&lt;br&gt;
ExcelWorksheet wsGraph = p.Workbook.Worksheets[2]; &lt;br&gt;
But, how to add series from sheet1 to chart on sheet2? &lt;br&gt;
&lt;br&gt;
Any suggestions will be highly appreciated.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="xav2075" When="18/03/2013 18:23:04">
          <Html>
        &lt;div class="markDownOutput "&gt;Here is an example of adding a series of data from a given worksheet to a chart.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;scatter_chart.Series.Add(excel_worksheet_2.Cells["B2:B10"], excel_worksheet_2.Cells["A2:A10"]);&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="rohitmca" When="19/03/2013 05:36:17">
          <Html>
        &lt;div class="markDownOutput "&gt;Thanks a lot xav2075, it worked. Great.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Dinamic scaling table and copy to PowerPoint slide.">
      <Posts>
        <Post From="wasilij" When="17/03/2013 15:40:36">
          <Html>
        &lt;div class="markDownOutput "&gt;First, I want to thank you for a convenient system. &lt;br&gt;
&lt;br&gt;
I need to create the Excel spreadsheet and display it on a slide presentation. &lt;br&gt;
Questions - &lt;br&gt;
1) How can I determine the width and height of the table dynamically? &lt;br&gt;
2) How to change the size of the table and its contents to a certain extent? &lt;br&gt;
(something like worksheet.Cells[i, 2].Style.Font.Size = 14; &lt;br&gt;
&lt;pre&gt;&lt;code&gt;            worksheet.DefaultColWidth = 20;
            worksheet.DefaultRowHeight = 20;
            worksheet.Column(1).Width = 100;
            &amp;amp; etc )&lt;/code&gt;&lt;/pre&gt;
3) And what the best way to copy a table to slide it to make it look good? &lt;br&gt;
&lt;br&gt;
Thank you!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Shapes and Pictures Collection">
      <Posts>
        <Post From="jxnim" When="15/03/2013 04:32:35">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi all, &lt;br&gt;
&lt;br&gt;
I was wondering whether EPPlus is able to get the existing Shapes and Pictures collection in the worksheet and allow editing the shape and picture.
&lt;br&gt;
&lt;br&gt;
I can only get the Drawings collection in EPPlus. Does anyone know how to do it? &lt;br&gt;
&lt;br&gt;
Thanks.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Microsoft Excel has stopped working">
      <Posts>
        <Post From="tlaford" When="14/03/2013 20:35:06">
          <Html>
        &lt;div class="markDownOutput "&gt;I am in the process of creating a web application to create and display an Excel spreadsheet when I click a button. I decided to start simple and canibalize the sample web app.
&lt;br&gt;
&lt;br&gt;
When I click on the button Internet Explorer displays "Do you want to open or save ...", so I click OPEN. Then an EXCEL session starts followed by a dialog saying "Microsoft Excel has stopped working - Windows is checking for a solution to the
 problem...". Then (without touching the cancel buton) a second dialog replaces the first saying "Microsoft Excel is trying to recover your information - This might take several minutes." And then (without touching the Cancel button) a third
 dialog pops up saying "Microsoft Excel has stopped working - A problem caused the program to stop working correctly. Windows will close the program and notify you if a solution is available."
&lt;br&gt;
&lt;br&gt;
But if I click SAVE or SAVE AS instead of OPEN, the file saves fine and when I double click it, it opens without problem.
&lt;br&gt;
&lt;br&gt;
Here's my code:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;        Dim excel As New ExcelPackage()
        Dim wkst As ExcelWorksheet = excel.Workbook.Worksheets.Add("Sample2")

        wkst.Cells("A1").Value = "Sample 2"
        wkst.Cells("A1").Style.Font.Bold = True

        Response.ClearHeaders()
        Response.BinaryWrite(excel.GetAsByteArray())
        Response.ContentType = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"
        Response.AddHeader("content-disposition", "attachment;  filename=Sample2.xlsx")
        Response.End()&lt;/code&gt;&lt;/pre&gt;
Can anyone offer any insight into what I'm doing wrong?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="tlaford" When="14/03/2013 21:29:25">
          <Html>
        &lt;div class="markDownOutput "&gt;Response.End() is causing a ThreadAbortException. I tried adding a TRY/CATCH around the code, but that didn't stop the error.&lt;br&gt;
&lt;br&gt;
When I remove the Response.End(), the EXCEL message changes to "Excel found unreadable content in 'Sample2.xlsx'. Do you want to recover the contents of the workbook? If you trust the source of this workbook, click Yes." Once I click YES the file
 opens just fine.&lt;br&gt;
&lt;br&gt;
Could the problem have to do with the UpdatePanel(s) I'm using?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="tlaford" When="14/03/2013 21:30:51">
          <Html>
        &lt;div class="markDownOutput "&gt;Is there a way to "roll back" to the original response if some other exception is encountered?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Excel found unreadable content in &quot;xxxxxx.xlsx&quot;">
      <Posts>
        <Post From="RaviJoshi" When="22/02/2013 14:23:25">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi Guys, I am using following code to write the DATATABLE into ExcelSheet.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;Public Shared Sub DumpExcel(ByVal dr As SqlDataReader, ByVal filename As String)
        Dim tbl As New DataTable
        tbl.Load(dr)
        Using pck As New OfficeOpenXml.ExcelPackage()
            'Create the worksheet
            Dim ws As OfficeOpenXml.ExcelWorksheet = pck.Workbook.Worksheets.Add(filename)

            'Load the datatable into the sheet, starting from cell A1. Print the column names on row 1
            ws.Cells("A1").LoadFromDataTable(tbl, True)

            'Write it back to the client
            HttpContext.Current.Response.Clear()
            HttpContext.Current.Response.ContentType = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"
            HttpContext.Current.Response.AddHeader("content-disposition", String.Format("attachment;  filename={0}.xlsx", filename))
            HttpContext.Current.Response.BinaryWrite(pck.GetAsByteArray())
        End Using
End Sub&lt;/code&gt;&lt;/pre&gt;
But I am getting following error : &lt;br&gt;
&lt;strong&gt;Excel found unreadable content in "xxxxxx.xlsx". Do you want to recover the contents of this workbook?&lt;/strong&gt;
&lt;br&gt;
&lt;br&gt;
Thanks.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="tlaford" When="14/03/2013 21:13:41">
          <Html>
        &lt;div class="markDownOutput "&gt;I think you are missing&lt;br&gt;
&lt;pre&gt;&lt;code&gt;HttpContext.Current.Response.End()&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Insert a cell below an existing one">
      <Posts>
        <Post From="sagitario2020" When="14/03/2013 19:19:27">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi everyone, &lt;br&gt;
&lt;br&gt;
I was wondering if it is possible to add a cell below an existing one. I don't want to add a new row, because it will affect the other columns in the worksheet, i just want to insert a cell below an existing one. I'm able to do this with the ms interop library
 but i can't figure out how to do it with epplus. &lt;br&gt;
&lt;br&gt;
Searching on the internet I found that there are (or used to be) some extensions methods for the ExcelWorksheet class, and one of it is something like:
&lt;br&gt;
&lt;br&gt;
Add(InsertDirection, IEnumerable&amp;lt;T&amp;gt;). &lt;br&gt;
&lt;br&gt;
I don't know if that method do what i am searching for, because it is not present in the latest version of EPPlus, but it is the closest i am to the answer to my question.
&lt;br&gt;
&lt;br&gt;
Does anyone know if this can be done with epplus? &lt;br&gt;
&lt;br&gt;
Thanks in advance &lt;br&gt;
&lt;br&gt;
Pablo.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Problems with inserting data into cells">
      <Posts>
        <Post From="Josip84" When="13/03/2013 13:12:27">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi! &lt;br&gt;
&lt;br&gt;
I have formatted excel file with borders, formulas etc... made in Excel 2010. &lt;br&gt;
By using EPPlus my task was to write some numbers into specific cells. I do that, but after opening file in Excel 2010 the file isn't same like original. Some border lines are removed and other formatting as well. The only thing I do from my code is open file,
 chose right worksheet, store some integer number into specific cells, save file and that's all.
&lt;br&gt;
&lt;br&gt;
Does anybody knows what is the problem? &lt;br&gt;
&lt;br&gt;
Thanks&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Josip84" When="13/03/2013 15:17:04">
          <Html>
        &lt;div class="markDownOutput "&gt;This topic can be closed. &lt;br&gt;
&lt;br&gt;
The solution is on &lt;a href="http://epplus.codeplex.com/discussions/402572" rel="nofollow"&gt;
http://epplus.codeplex.com/discussions/402572&lt;/a&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Cell Value on date column returns a decimal">
      <Posts>
        <Post From="dmaidlow" When="12/03/2013 16:57:15">
          <Html>
        &lt;div class="markDownOutput "&gt;I've encountered something strange with EPPlus while reading cell values. I have a spreadsheet that has a column of dates. Every cell in this column points to a single field on another tab. On row three I access the value using ExcelWorkSheet.Cells[rowNum,cellNum].Value
 and the library returns the correct date. On the next row I again access the cell value with the same logic but I get the Decimal value returned of days since 1/1/1900.
&lt;br&gt;
&lt;br&gt;
When looking at the cell in question in Excel the value is ='Employer Entry'!$C$12 for cells. The referenced cell in the other sheet has a value of 12/23/2012. On the problematic iteration a value of 41266.0 is returned.
&lt;br&gt;
&lt;br&gt;
I've tried changing the formatting on the various cells to no avail. Any suggestions would be appreciated. I can provide a copy of the xls file if needed. Thank you!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="dmaidlow" When="12/03/2013 17:15:25">
          <Html>
        &lt;div class="markDownOutput "&gt;Ahh I was pointed to another post that seems to explain my problem: &lt;a href="http://epplus.codeplex.com/discussions/255476" rel="nofollow"&gt;
http://epplus.codeplex.com/discussions/255476&lt;/a&gt; - sorry for the duplication.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Compilation Error after publishing online">
      <Posts>
        <Post From="ChengzhiZhao" When="11/03/2013 14:59:45">
          <Html>
        &lt;div class="markDownOutput "&gt;Dear friends, &lt;br&gt;
I am currently using EPPlus with my work. It works really well in Debug model(Reference is added).
&lt;br&gt;
However, when I released the project. I got a Compilation Error said&lt;br&gt;
&lt;pre&gt;&lt;code&gt;CS0246: The type or namespace name 'OfficeOpenXml' could not be found (are you missing a using directive or an assembly reference?)&lt;/code&gt;&lt;/pre&gt;
Can anyone help me to figure this out. &lt;br&gt;
Thanks &lt;br&gt;
Chengzhi&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Incorrect image sizes in all but last row">
      <Posts>
        <Post From="dhgoldman" When="16/06/2012 21:21:28">
          <Html>
        
&lt;p&gt;Hello,&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Really enjoying the EPPlus library, but I'm having an issue inserting an image into each row of an Excel file. I tried to mimic the calls in a previous discussion thread (&lt;a href="http://epplus.codeplex.com/discussions/229134" rel="nofollow"&gt;http://epplus.codeplex.com/discussions/229134&lt;/a&gt;),
 but all the images except the image in the final row seem to be sized incorrectly. In fact, when I tried adjusting the sizes of the images by setting the height to half of the actual image height (just to see what would happen), only the final row was affected;
 the rest were the same (incorrect) size they had been before. Not sure what I'm doing wrong, but here's my approach:&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;pre&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span&gt;var&lt;/span&gt;&amp;nbsp;image&amp;nbsp;=&amp;nbsp;&lt;span&gt;Image&lt;/span&gt;.FromStream(s);
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;row.Height&amp;nbsp;=&amp;nbsp;ConvertPixelsToRowHeight(image.Height);
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;sheet.Column(columnNumber).Width&amp;nbsp;=&amp;nbsp;ConvertPixelsToColumnWidth(sheet,&amp;nbsp;image.Width&amp;nbsp;+&amp;nbsp;1);
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span&gt;ExcelPicture&lt;/span&gt;&amp;nbsp;picture&amp;nbsp;=&amp;nbsp;sheet.Drawings.AddPicture(&lt;span&gt;"Row-"&lt;/span&gt;&amp;nbsp;+&amp;nbsp;rowNumber.ToString()&amp;nbsp;+&amp;nbsp;&lt;span&gt;"-Col-"&lt;/span&gt;&amp;nbsp;+&amp;nbsp;columnNumber.ToString(),&amp;nbsp;image);
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;picture.SetPosition(rowNumber&amp;nbsp;-&amp;nbsp;1,&amp;nbsp;2,&amp;nbsp;columnNumber&amp;nbsp;-&amp;nbsp;1,&amp;nbsp;2);
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;picture.SetSize(image.Width,&amp;nbsp;image.Height);&lt;/pre&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Any assistance is greatly appreciated. Thanks very much,&lt;/p&gt;
&lt;p&gt;- Daniel&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="fba71" When="20/09/2012 00:23:48">
          <Html>
        
&lt;p&gt;I'm having the same problem as Daniel.&lt;/p&gt;
&lt;p&gt;Has there been a solution?&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;
&lt;p&gt;Frédéric&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jlorenzini" When="08/03/2013 22:37:37">
          <Html>
        &lt;div class="markDownOutput "&gt;You have to set all the row heights first, before you embed a single image. The minute you touch a row height it distorts all the images again.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="suggest remove ole32.dll reference">
      <Posts>
        <Post From="piyongcai" When="08/03/2013 03:33:27">
          <Html>
        &lt;div class="markDownOutput "&gt;if remove ole32 reference, EPPlus can use on mono.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Unreadable Content on 1 site, not on other.">
      <Posts>
        <Post From="Rem51" When="07/03/2013 16:08:34">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi all, &lt;br&gt;
&lt;br&gt;
I've noticed there's a bunch of these "unreadable content" posts, but I still think mine is a little different.
&lt;br&gt;
&lt;br&gt;
When I run the code on my development machine, everything runs fine and I get no errors.
&lt;br&gt;
When I run the code on one of the servers in the webfarm, I get the unreadable content error.
&lt;br&gt;
&lt;br&gt;
I'm not quite sure if there's any prerequisites, but I couldn't find any references to them.
&lt;br&gt;
&lt;br&gt;
Any suggestions are appreciated! &lt;br&gt;
&lt;br&gt;
Thank you for your time.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="xav2075" When="07/03/2013 22:09:56">
          <Html>
        &lt;div class="markDownOutput "&gt;As far as I know there are two ways to save the ExcelPackage to a file. The first is a simple excelPackage.Save(); which works for me. The second way below prompts the user where to save the spreadsheet but produces a corrupted spreadsheet.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;    Response.BinaryWrite(excelPackage.GetAsByteArray());
    Response.ContentType = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";
    Response.AddHeader("content-disposition", "attachment;  filename=Sample2.xlsx");      &lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="C++/CLI syntax on VerticalAlignment e.g.">
      <Posts>
        <Post From="felix_b" When="06/03/2013 14:41:08">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi volks, &lt;br&gt;
&lt;br&gt;
i have to say, that i'm a beginner in programming (only some C-Code and java in the past) and have some problems to "convert" some of the C#-examples to my C++/CLI Code. (Apart from that: great lib ;) ).
&lt;br&gt;
&lt;br&gt;
Currently i'm working on the cellformat and have problems with the syntax for the verticalAlignment or BackgroundColors (e.g.).
&lt;br&gt;
&lt;br&gt;
C# Code from some examples:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;ws.Cells.Style.VerticalAlignment = ExcelVerticalAlignment.Center;
ws.Cells.Style.Fill.BackgroundColor.SetColor(Color.Green);&lt;/code&gt;&lt;/pre&gt;
C++/CLI:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;ws-&amp;gt;Cells-&amp;gt;Style-&amp;gt;VerticalAlignment-&amp;gt;Top;   =&amp;gt; [error C2039: 'Top' : is not a member of 'System::Enum']
ws-&amp;gt;Cells-&amp;gt;Style-&amp;gt;VerticalAlignment = ExcelVerticalAligment-&amp;gt;Top;    [error C2275: 'OfficeOpenXml::Style::ExcelVerticalAlignment' : illegal use of this type as an expression]

both and many other variants arent working :(  

ws-&amp;gt;Cells-&amp;gt;Style-&amp;gt;Fill-&amp;gt;BackgroundColor-&amp;gt;SetColor(Color-&amp;gt;Green);
[error C2065: 'Color' : undeclared identifier]
[error C2227: left of '-&amp;gt;Green' must point to class/struct/union/generic type]&lt;/code&gt;&lt;/pre&gt;
I've replaced the "." with "-&amp;gt;" - no question of that, but that doesnt fit with all lines of Code.
&lt;br&gt;
Furthermore I tested with :: (no success) or so on... well... &lt;br&gt;
... apart from that, i can generate excelsheets now, but only without the settings above.
&lt;br&gt;
Maybe youre asking yourself why i'm using C++/CLI ... a good question - currently i'm really thinking to switch to C# at all (mainly because of the thousands of C#-examples) :/.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="felix_b" When="06/03/2013 16:08:20">
          <Html>
        &lt;div class="markDownOutput "&gt;Well... &lt;br&gt;
Skill comes with practice ;) &lt;br&gt;
&lt;br&gt;
I've resolved ...&lt;br&gt;
&lt;pre&gt;&lt;code&gt;ws.Cells.Style.VerticalAlignment = ExcelVerticalAlignment.Center [/or Top ;)  ];&lt;/code&gt;&lt;/pre&gt;
to:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;ws-&amp;gt;Cells-&amp;gt;Style-&amp;gt;VerticalAlignment = ExcelVerticalAlignment::Top;&lt;/code&gt;&lt;/pre&gt;
obviously this was the only way i dont try before i posted here... . &lt;br&gt;
Same procedure with: &lt;br&gt;
ws-&amp;gt;Cells[x, y]-&amp;gt;Style-&amp;gt;Border-&amp;gt;Bottom-&amp;gt;Style = ExcelBorderStyle::Thick;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Unfortunately the BackgroundColor seems to work in another way - obviously a function/method - but actually I have no clue or luck ( ;) ) to resolve the problem.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="xav2075" When="07/03/2013 11:25:32">
          <Html>
        &lt;div class="markDownOutput "&gt;This C# code will set a cell background color:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;    worksheet.Cells["A1:B1"].Style.Fill.PatternType = ExcelFillStyle.Solid;
    worksheet.Cells["A1:B1"].Style.Fill.BackgroundColor.SetColor(Color.FromArgb(79, 129, 189));
&lt;/code&gt;&lt;/pre&gt;
The Color.FromArgb(79, 129, 189) bit references a 'using System.Drawing'&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="felix_b" When="07/03/2013 16:08:36">
          <Html>
        &lt;div class="markDownOutput "&gt;Thanks!&lt;br&gt;
&lt;br&gt;
With your help i found my mistakes in the c++/cli-Code ;)&lt;br&gt;
&lt;br&gt;
I have to add the following lines/things:&lt;br&gt;
&lt;br&gt;
&lt;strong&gt;C++/CLI&lt;/strong&gt; (!)&lt;br&gt;
&lt;pre&gt;&lt;code&gt;#using &amp;lt;System.Drawing.dll&amp;gt;
using namespace System::Drawing;
...

worksheet-&amp;gt;Cells[x, y]-&amp;gt;Style-&amp;gt;Fill-&amp;gt;PatternType = ExcelFillStyle::Solid;
worksheet-&amp;gt;Cells[x, y]-&amp;gt;Style-&amp;gt;Fill-&amp;gt;BackgroundColor-&amp;gt;SetColor(Color::Gray);&lt;/code&gt;&lt;/pre&gt;
The "using"-part was the main point i forgot ...&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="InsertRow method also inserts a column.">
      <Posts>
        <Post From="Roma8716" When="07/03/2013 15:48:46">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello, I'm usin a file as template and need to add some rows but when I use the InsertRow method it is also inserting a Column.
&lt;br&gt;
&lt;br&gt;
Thanks.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Graph background gradient fill?">
      <Posts>
        <Post From="Cursorkeys" When="07/03/2013 13:24:38">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi everyone, &lt;br&gt;
&lt;br&gt;
I've found that you can set a gradient fill on a graph by: &lt;br&gt;
&lt;br&gt;
chart.Fill.Style = eFillStyle.GradientFill; &lt;br&gt;
&lt;br&gt;
but I can't find any way of configuring the gradient colors and stops. Is this possible? If not how do I raise this as a feature request?
&lt;br&gt;
&lt;br&gt;
Many thanks, &lt;br&gt;
&lt;br&gt;
Jon&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="AddDateTimeValidation crashes excel 2010, but works well on excel 2007">
      <Posts>
        <Post From="singh181" When="05/03/2013 11:09:41">
          <Html>
        &lt;div class="markDownOutput "&gt;Dear Team, &lt;br&gt;
&lt;br&gt;
Currently, I am using EPplus 3.1.1.0. I have a code that adds DateTime Validation to a cell. Below piece of code works well in Excel 2007, but it crashes Excel 2010:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;var validation = _worksheet.DataValidations.AddDateTimeValidation(cellDateAddress);

 //Format date in mm/dd/yyyy
                    string numberFormat = "MM/DD/YYYY";
                    range.Style.Numberformat.Format = numberFormat;
                    validation.Formula.Value = DateTime.Now.Date;
                    validation.ShowErrorMessage = true;
                    validation.ErrorStyle = ExcelDataValidationWarningStyle.stop;
                    validation.Error = "Invalid date,Enter in mm-dd-yyyy!";&lt;/code&gt;&lt;/pre&gt;
Any help on above is much appreciated.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to turnoff the drill down option for the Pivot table">
      <Posts>
        <Post From="Malluri" When="04/03/2013 13:59:24">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
I am unable to turnoff the drill down option for the Pivot table.I am using the below code.
&lt;br&gt;
&lt;br&gt;
pivotTable1.ShowDrill = false; &lt;br&gt;
pivotTable1.EnableDrill = false; &lt;br&gt;
&lt;br&gt;
Thanks, &lt;br&gt;
Alluri&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Pivot table Report layout to Tabular">
      <Posts>
        <Post From="Malluri" When="27/02/2013 16:52:07">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
Using epplus how to set the Report layout of the Pivot table to Tabular. Currently it is showing in the drill down structure.
&lt;br&gt;
&lt;br&gt;
Design--Report Layout--Show in Tabular format. &lt;br&gt;
&lt;br&gt;
I to set this using code with epplus. Please help me regarding this report layout.
&lt;br&gt;
&lt;br&gt;
Thanks, &lt;br&gt;
Alluri&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="micronn386" When="03/03/2013 14:51:50">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
For each ExcelPivotTableField, set its Outline property to false. &lt;br&gt;
&lt;br&gt;
Something like: &lt;br&gt;
&lt;pre&gt;&lt;code&gt;foreach(var field in pivot.Fields)
{
   field.Outline = false;
}&lt;/code&gt;&lt;/pre&gt;
Regards, &lt;br&gt;
&lt;br&gt;
Ivan&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Malluri" When="04/03/2013 13:57:15">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
Thank you so much. This worked perfectly. &lt;br&gt;
&lt;br&gt;
I also having one more issue where I am unable to remove the drill down option. &lt;br&gt;
I am using the below code. &lt;br&gt;
&lt;br&gt;
pivotTable1.EnableDrill = false; &lt;br&gt;
pivotTable1.ShowDrill = false; &lt;br&gt;
&lt;br&gt;
Please suggest. &lt;br&gt;
&lt;br&gt;
Regards, &lt;br&gt;
Alluri&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Pivot Table Data Source">
      <Posts>
        <Post From="Phinehas" When="04/03/2013 06:16:58">
          <Html>
        &lt;div class="markDownOutput "&gt;I'm can use wsPivot.PivotTables.Add to add a pivot table with address range.
&lt;br&gt;
&lt;br&gt;
In Excel, we can set the pivot table data source to a table (e.g. "Data"). How can I implement it with EPPlus?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Hyperlink from Database">
      <Posts>
        <Post From="fcholmes" When="28/02/2013 07:05:25">
          <Html>
        &lt;div class="markDownOutput "&gt;Cutting my teeth in C# and appreciating what EPPlus can do. I am able to manually generate hyperlinks for the excel file output but, of course, all of the links are to the same file. Here is the code I'm using:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;string FileRootPath = @".\folder\013.jpg";
string DisplayText = "Text";
ws.Cells[2, 4, 1 + tbl.Rows.Count, 4].Formula = "HYPERLINK(\"" + FileRootPath + "\",\"" + DisplayText + "\")";&lt;/code&gt;&lt;/pre&gt;
I would like the FileRootPath to be dynamic; based on the output from the database. The datatable already has the imgname (such as "013.jpg" or "mew.jpg"), each of which is unique, so I would like to have something like:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;string FileRootPath = @".\expense\" + imgname;&lt;/code&gt;&lt;/pre&gt;
The result being that each cell has a link to the image for its specific imgname. Any help would be greatly appreciated.&lt;br&gt;
&lt;br&gt;
&lt;strong&gt;Edit&lt;/strong&gt;&lt;br&gt;
I think I am a little closer. I can loop through the imgnames but in the end all of the hyperlinks get set to the last imgname in the list. I also haven't added back in the \folder\ part of the path.&lt;br&gt;
&lt;pre&gt;&lt;code&gt;string DisplayText = "Text";
int rows = tbl.Rows.Count + 1;
for (int i = 1; i &amp;lt; rows; i++)
{
ws.Cells[2, 4, 1 + (i), 4].Formula = "HYPERLINK(\"" + ws.Cells[1 + (i), 4].GetValue&amp;lt;string&amp;gt;() + "\",\"" + DisplayText + "\")";
}&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="xav2075" When="28/02/2013 20:58:20">
          <Html>
        &lt;div class="markDownOutput "&gt;It seems like you are not referencing the datatable tbl when assigning a hyperlink value to a cell within a for loop.&lt;br&gt;
&lt;br&gt;
Try starting the program in debug mode (F5) and set breakpoints on lines of code with F9. You can right click on a variable or some type of array and inspect its values at a certain point during the codes execution.&lt;br&gt;
&lt;br&gt;
Myself I am not a good programmer but I can get by with using the debugger a lot.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="fcholmes" When="01/03/2013 03:12:28">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi xav2075, thanks for taking the time to reply. Here is the code where I select and bind the data to the datatable ("tbl"):&lt;br&gt;
&lt;pre&gt;&lt;code&gt;SqlCommand cmd = new SqlCommand("SELECT date, desc, imgname FROM users WHERE email=@userstr", conn);
cmd.Parameters.AddWithValue("@userstr", Session["user"].ToString());

DataTable tbl = new DataTable();
cmd.CommandType = CommandType.Text;
SqlDataAdapter da = new SqlDataAdapter();
da.SelectCommand = cmd;
da.Fill(tbl);&lt;/code&gt;&lt;/pre&gt;
I have used the debug tool on the for statement, and I can see it iterating through, so for example the first time through (where i=1) it returns:&lt;br&gt;
&lt;br&gt;
ws.Cells[2, 4, 1 + (i), 4].Formula = HYPERLINK("013.jpg","Text")&lt;br&gt;
&lt;br&gt;
The second, and final, time it iterates (where i=2) it returns:&lt;br&gt;
&lt;br&gt;
ws.Cells[2, 4, 1 + (i), 4].Formula = HYPERLINK("mew.jpg","Text")&lt;br&gt;
&lt;br&gt;
When the excel file is created ALL of the cells in column 4 (rows 2 and 3) are hyperlinked to mew.jpg, instead of row 2 hyperlinking to 013.jpg and row 3 hyperlinking to mew.jpg.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="PageBreaks">
      <Posts>
        <Post From="Alexs6" When="26/02/2013 13:53:14">
          <Html>
        &lt;div class="markDownOutput "&gt;Excel inserts page breaks automatically. I want to know, where page break was inserted. Does anybody knows, how to get this information? Row.PageBreak is only for inserting manual PageBreaks. When i check this property for each row in the sheet, it is
 always false. &lt;br&gt;
&lt;br&gt;
Any suggestions?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Incorrect Excel dates &amp;amp; EPOCH">
      <Posts>
        <Post From="edegroot" When="01/02/2012 22:01:00">
          <Html>
        
&lt;p&gt;While reading an excel spreadsheet using this fantastic library I noticed that the dates in the spreadsheet did not match up with the dates in my code.&lt;br&gt;
As mentioned in previous articles, Excel stores the date/time values as integers representing the offset from 1 jan 1900 (EPoch date). However after some extensive googling this 'offset' is different when the spreadsheet is created on a Mac, and guess what....
 my spreadsheet originated from a Mac.&lt;br&gt;
Turns out that the Mac is using 1 jan 1904 and all my dates are out by exactly&amp;nbsp; 4 years.&lt;/p&gt;
&lt;p&gt;Sure enough, Excel didn't seem to have any problems displaying the correct dates, which suggested that this setting is part of the document itself. And after further investigation I found the attribute hidden in the 'workbook.xml' (= internal xlsx)&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;workbookPr&lt;/span&gt; &lt;span style="color: red;"&gt;autoCompressPictures&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;0&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: red;"&gt;showInkAnnotation&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;0&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: red;"&gt;date1904&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;1&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;/&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;After that it was easy enough to add a little bit of logic to my code to compensate for the EPOCH effect:&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;TimeSpan dateShift = TimeSpan.Zero;
&lt;span style="color: blue;"&gt;var&lt;/span&gt; node = document.Workbook.WorkbookXml.SelectSingleNode(&lt;span style="color: rgb(163, 21, 21);"&gt;"//@date1904"&lt;/span&gt;);
&lt;span style="color: blue;"&gt;if&lt;/span&gt; (node != &lt;span style="color: blue;"&gt;null&lt;/span&gt; &amp;amp;&amp;amp; node.Value == &lt;span style="color: rgb(163, 21, 21);"&gt;"1"&lt;/span&gt;)
    dateShift = TimeSpan.FromDays(365 * 4 + 2);  &lt;span style="color: green;"&gt;//+2 to compensate for both leap years&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;By adding the data shift to each date time value I was able to resolve this issue.&lt;br&gt;
It would make sense to incorporate this functionality in the core library to shield of this nasty Mac habit and automatically retrieve the correct dates in a simular fashion to Excel.&lt;/p&gt;
&lt;p&gt;Cheers, Elmar&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="06/02/2012 21:48:10">
          <Html>
        
&lt;p&gt;Ok, I'll add this propery to the next check-in&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="ghigh" When="07/01/2013 06:04:06">
          <Html>
        
&lt;p&gt;I am testing the current 3.1 release and this bug still seems to be in there. &amp;nbsp;Was this never fixed?&lt;/p&gt;
&lt;p&gt;Thanks,&lt;br&gt;
Gerry&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="rhayward" When="22/02/2013 15:41:05">
          <Html>
        &lt;div class="markDownOutput "&gt;I just ran into the same problem and cannot solve this issue by adding the dateShift to the dates. More specifically, I am not finding the date1904 node.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="edegroot" When="26/02/2013 06:41:39">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi bud, &lt;br&gt;
Too be honest I haven't actively been using this library in a while... but I'd be happy to have a look for you if you can reply with a link to the spreadsheet in it.
&lt;br&gt;
&lt;br&gt;
Ciao, &lt;br&gt;
Elmar&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Colring Pivot Table">
      <Posts>
        <Post From="Bhanu1423" When="12/02/2013 05:34:19">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello, &lt;br&gt;
How to give color to Pivot Table in excel Sheet ,which is generated through epplus.
&lt;br&gt;
&lt;br&gt;
Thanks in advance&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="xav2075" When="12/02/2013 17:40:52">
          <Html>
        &lt;div class="markDownOutput "&gt;You can assign one of the sixty TableStyles to set a color scheme to the pivot table.&lt;br&gt;
&lt;br&gt;
For example: pivotTable.TableStyle = TableStyles.Medium2;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="bhanu1423" When="18/02/2013 15:44:25">
          <Html>
        &lt;div class="markDownOutput "&gt;Thank you for ur reply.. &lt;br&gt;
&lt;br&gt;
but i need to conditional format pivot table... i.e, giving certain colors based on values in the pivot sheet.
&lt;br&gt;
&lt;br&gt;
Thanks in advance&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Bhanu1423" When="25/02/2013 12:41:39">
          <Html>
        &lt;div class="markDownOutput "&gt;I can conditional format excel data, but i cannot apply conditional format pivot table. I think this feature is not provided in EPPLus&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Unreadable contents found after using xlPackage.Save()">
      <Posts>
        <Post From="xmz919" When="19/02/2013 19:19:30">
          <Html>
        &lt;div class="markDownOutput "&gt;Here's the code I'm using, but keep on getting unreadable error when try to open the saved file with Excel 2010.
&lt;br&gt;
&lt;pre&gt;&lt;code&gt;        FileInfo regFile = new FileInfo(@"mysample.xlsx");
        using (ExcelPackage xlPackage = new ExcelPackage(regFile)) 
        {

            ExcelWorksheet allApp = xlPackage.Workbook.Worksheets[1];

            allApp.Cells[2, 1].Value = "1";

            xlPackage.Save();

        }

&lt;/code&gt;&lt;/pre&gt;
Everything works fine, and the sheet has been changed to what I want, just the above error came out when I open the excel file.&lt;br&gt;
I believe is the way Epplus writes xml is different from what Excel expects? Can anyone help?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="xav2075" When="19/02/2013 19:52:27">
          <Html>
        &lt;div class="markDownOutput "&gt;edit.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="xav2075" When="19/02/2013 20:45:18">
          <Html>
        &lt;div class="markDownOutput "&gt;Worksheet\array numbering starts at zero - 0. So the first worksheet in referenced at [0] in the array of worksheets.&lt;br&gt;
&lt;br&gt;
And when defining the ExcelPackage by default one file parameter is a new spreadsheet and the 2nd a template. For example:&lt;br&gt;
&lt;br&gt;
ExcelPackage xlPackage = new &lt;a href='mailto:ExcelPackage(@"d:\newspreadsheet.xlsx",' rel="nofollow"&gt;
ExcelPackage(@"d:\newspreadsheet.xlsx",&lt;/a&gt; &lt;a href='mailto:@"d:\templatespreadsheet.xlsx");' rel="nofollow"&gt;
@"d:\templatespreadsheet.xlsx");&lt;/a&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="xmz919" When="20/02/2013 00:31:21">
          <Html>
        &lt;div class="markDownOutput "&gt;Well, the excel file mysample.xlsx and its spreadsheets are created by me manually. So actually there're several sheets and data in it already.
&lt;br&gt;
I just want to get access to one of the sheets and make some changes then save it.
&lt;br&gt;
After I did all these, I tried to open the excel with ms office 2010, and it gave me the unreadable contents error.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="xav2075" When="20/02/2013 17:26:42">
          <Html>
        &lt;div class="markDownOutput "&gt;If you could post as much code as possible I could try it and find the bugs.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="xmz919" When="23/02/2013 09:44:47">
          <Html>
        &lt;div class="markDownOutput "&gt;Well, actually above are all the codes I have been using. When I use Excel to open the file I have just changed by my web application, it told me there's some unreadable contents and asked me to repair them or not, if I click on yes, then it repair some
 .xml style files for the spreadsheets. The contents in the spreadsheets are what I expected, just cannot get rid of the unreadable contents error.
&lt;br&gt;
mysample.xlsx has three empty spreadsheets, and I just tried to write something into it.
&lt;br&gt;
Nothing else. &lt;br&gt;
Just wondering no one has the similar problem? Is it because the version of my Excel? Or is it because of windows 8 system?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="xav2075" When="23/02/2013 18:12:47">
          <Html>
        &lt;div class="markDownOutput "&gt;Your operating system will have no affect at all on spreadsheets. If you create a Microsoft hotmail\outlook email account you will have access to Microsoft's web version of Excel which can you use for additional testing.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Row height">
      <Posts>
        <Post From="okilele" When="22/02/2013 13:00:13">
          <Html>
        &lt;div class="markDownOutput "&gt;Hello, &lt;br&gt;
&lt;br&gt;
Simple question : Can anybody confirm row height can be setup with ePPlus ? &lt;br&gt;
&lt;br&gt;
Thanks&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="22/02/2013 13:09:01">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
Yes, you can set row height with EPPlus.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="okilele" When="22/02/2013 16:03:09">
          <Html>
        &lt;div class="markDownOutput "&gt;Simple question, small answer but this saves me a lot of time, thanks !&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to override the digit grouping">
      <Posts>
        <Post From="Phero_" When="18/02/2013 15:53:04">
          <Html>
        &lt;div class="markDownOutput "&gt;I am using Swedish settings with a whitespace in the digit grouping, but I want to use american digit grouping with "," separator instead but still using the swedish settings. How could I solve this issue? I guess there are several solutions.&lt;br&gt;
&lt;br&gt;
Currency 1 000(SE) 1,000 (US)&lt;br&gt;
&lt;br&gt;
I have tried Style.Numberformat.Format = "#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00 $;-#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00 $"&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Recalculate existing function in Excel">
      <Posts>
        <Post From="deserialized" When="13/02/2013 08:53:32">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
could someone point me to an example how to recalculate existing function in an excel sheet?
&lt;br&gt;
&lt;br&gt;
Thanks&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="weismat" When="18/02/2013 15:50:53">
          <Html>
        &lt;div class="markDownOutput "&gt;EPPlus is about the creation of Excel files. &lt;br&gt;
A recalculation is a feature of Excel when opening the spreadsheet in Excel or when calling recalc inside Excel. the recalculation is not a property of the Excel file.
&lt;br&gt;
If you want to trigger a recalc from an application, look at COM Interop from C# to Excel.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Gradient in shapes like rectangle">
      <Posts>
        <Post From="Daniel1809" When="14/02/2013 01:44:50">
          <Html>
        &lt;div class="markDownOutput "&gt;So, how can i set a gradient in shapes? &lt;br&gt;
&lt;br&gt;
shape.Fill.Style = eFillStyle.GradientFill; &lt;br&gt;
shape.Fill.Color ?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="xav2075" When="14/02/2013 02:51:28">
          <Html>
        &lt;div class="markDownOutput "&gt;Have a look at this thread for assigning colors: &lt;a href="http://epplus.codeplex.com/discussions/431854" rel="nofollow"&gt;
http://epplus.codeplex.com/discussions/431854&lt;/a&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="Daniel1809" When="14/02/2013 03:49:45">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi!! Thanks for your response!!&lt;br&gt;
But i need to add a gradient to a shape... but may be i'll use a full RGB color.&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
As you can see, the cells hava Color1 and Color2 for gradients but the shapes don't have!&lt;br&gt;
&lt;br&gt;
ws.Cells["A1:C3"].Style.Fill.Gradient.Type = ExcelFillGradientType.Linear;&lt;br&gt;
ws.Cells["A1:C3"].Style.Fill.Gradient.Color1.SetColor(Color.Red);&lt;br&gt;
ws.Cells["A1:C3"].Style.Fill.Gradient.Color2.SetColor(Color.Blue);&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="xav2075" When="14/02/2013 04:41:55">
          <Html>
        &lt;div class="markDownOutput "&gt;I tried the following code: &lt;br&gt;
&lt;br&gt;
var shape1 = excel_worksheet_2.Drawings.AddShape("shape1", eShapeStyle.RoundRect);&lt;br&gt;
&lt;pre&gt;&lt;code&gt;  shape1.SetPosition(0, 5, 5, 5);
  shape1.SetSize(200, 200);
  shape1.Fill.Style = eFillStyle.GradientFill; // &amp;lt;-- error 'not implented' but --&amp;gt; eFillStyle.SolidFill; works
  shape1.Fill.Color = Color.FromArgb(79, 129, 189);
&lt;/code&gt;&lt;/pre&gt;
But at run time it fails with an error saying eFillStyle.GradientFill is not implemented. Also I could not find the shape on the worksheet using the other property eFillStyle.SolidFill which does not cause a run time error.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="I can't read EPPLus 3.1.chm contents">
      <Posts>
        <Post From="giorgiobenedetti" When="12/02/2013 08:04:28">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
when I open chm file to read help about classes, index is displayed, but every detail page display an error.
&lt;br&gt;
&lt;br&gt;
I'm using Windows 7 Professional, full updated. &lt;br&gt;
&lt;br&gt;
Thanks and B/R &lt;br&gt;
&lt;br&gt;
(Giorgio)&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="xav2075" When="12/02/2013 17:45:41">
          <Html>
        &lt;div class="markDownOutput "&gt;You could try another program to view chm files. Such as kchmviewer:&lt;a href="http://sourceforge.net/projects/kchmviewer/files/kchmviewer/6.0/" rel="nofollow"&gt;http://sourceforge.net/projects/kchmviewer/files/kchmviewer/6.0/&lt;/a&gt; --&amp;gt; download InstallKchmviewer-6.0.exe.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="giorgiobenedetti" When="13/02/2013 13:08:41">
          <Html>
        &lt;div class="markDownOutput "&gt;&lt;strong&gt;xav2075 wrote:&lt;/strong&gt;&lt;br&gt;
&lt;blockquote&gt;You could try another program to view chm files. Such as kchmviewer:&lt;a href="http://sourceforge.net/projects/kchmviewer/files/kchmviewer/6.0/" rel="nofollow"&gt;http://sourceforge.net/projects/kchmviewer/files/kchmviewer/6.0/&lt;/a&gt; --&amp;gt; download InstallKchmviewer-6.0.exe.&lt;br&gt;
&lt;/blockquote&gt;
Many thanks, It seems to be a good solution!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Empty value in cell with formula in office 2010">
      <Posts>
        <Post From="betito_no1" When="16/10/2011 20:46:36">
          <Html>
        
&lt;p&gt;&lt;span id="result_box" lang="en"&gt;&lt;span&gt;Hi&lt;/span&gt;&lt;span&gt;, I need help&lt;/span&gt;&lt;br&gt;
&lt;br&gt;
&lt;span&gt;When you&lt;/span&gt; &lt;span&gt;assign a&lt;/span&gt; &lt;span&gt;formula&lt;/span&gt; &lt;span&gt;to a cell&lt;/span&gt;
&lt;span&gt;value is&lt;/span&gt; &lt;span&gt;empty&lt;/span&gt; &lt;span&gt;in&lt;/span&gt; &lt;span&gt;office 2010&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;
&lt;span&gt;When&lt;/span&gt; &lt;span&gt;I&lt;/span&gt; &lt;span&gt;edit the cell&lt;/span&gt; &lt;span&gt;shows the value&lt;/span&gt;&lt;br&gt;
&lt;br&gt;
&lt;span&gt;As&lt;/span&gt; &lt;span&gt;I&lt;/span&gt; &lt;span&gt;do so that&lt;/span&gt; &lt;span&gt;I can&lt;/span&gt; &lt;span&gt;show me&lt;/span&gt;
&lt;span&gt;the result in&lt;/span&gt; &lt;span&gt;the cell.&lt;/span&gt;&lt;br&gt;
&lt;br&gt;
&lt;span&gt;The&lt;/span&gt; &lt;span&gt;version&lt;/span&gt; &lt;span&gt;I use is&lt;/span&gt; &lt;span&gt;EPPlus&lt;/span&gt; &lt;span&gt;
2.9.0.1&lt;/span&gt;&lt;br&gt;
&lt;br&gt;
&lt;span&gt;In&lt;/span&gt; &lt;span&gt;office 2007&lt;/span&gt; &lt;span&gt;works perfect&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="19/10/2011 07:03:37">
          <Html>
        
&lt;p&gt;EPPlus&amp;nbsp;does not&amp;nbsp;calculate formulas, so you have to make sure you set Excel up to calculate formulas when loading a workbook.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="lcreagh" When="12/02/2013 17:46:43">
          <Html>
        &lt;div class="markDownOutput "&gt;I have a somewhat related question. I have a template file with summation formulas in it that I use to create another spreadsheet with. The formulas copy correctly into the new spreadsheet. If the newly copied spreadsheet only has 1 tab, the values from
 the formulas show up correctly, but if the spreadsheet has more than 1 tab, the formulas are in the cells exactly the way they should be, but the values don't show up-they are blank. So there are no errors, but in a multi-tab spreadsheet the totals don't show
 up, even though the formulas are present in exactly the same way (as far as I can tell) as they are in the single-tab spreadsheet, where the totals do show up.
&lt;br&gt;
&lt;br&gt;
I can't tell why this is occuring. I'm doing this in memory, without persisting the spreadsheet until all of the tabs have been created.
&lt;br&gt;
&lt;br&gt;
I notice that when I open the spreadsheet in Excel I can 'F2' on the cell that has a formula but is not displaying a value, and then it will calculate it. Is there a way to find a formula through EPPlus and 'F2' before persisting the file.
&lt;br&gt;
&lt;br&gt;
Another thing that might be relevant: I am opening these files in Excel 2003 with the compatibility pack. I'm not sure if the values would show up in later versions of Excel.
&lt;br&gt;
&lt;br&gt;
Thanks. &lt;br&gt;
&lt;br&gt;
Laura&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="xav2075" When="12/02/2013 18:00:36">
          <Html>
        &lt;div class="markDownOutput "&gt;If you have or create a hotmail account you have access to Skydrive which has a web version of Excel you can also use for testing.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Searching for rows with a certain column value">
      <Posts>
        <Post From="killnine" When="12/02/2013 13:35:27">
          <Html>
        &lt;div class="markDownOutput "&gt;First off, I just want to commend all the folks on the EPPlus team for their awesome library. Creating Excel sheets is a snap and it has really helped not to require MS Office installed on the machine that uses my app.
&lt;br&gt;
&lt;br&gt;
However, I have an existing spreadsheet with 6-7 columns, and I'd like to select a row of that data if one of those columns has a certain value.
&lt;br&gt;
&lt;br&gt;
I wasn't sure if there was an existing mechanism to do this sort of thing but searching each cell seemed quite expensive.
&lt;br&gt;
&lt;br&gt;
The worksheet isn't huge, about 500 rows. &lt;br&gt;
&lt;br&gt;
Thanks!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Searching for rows with a certain column value">
      <Posts>
        <Post From="killnine" When="12/02/2013 13:35:26">
          <Html>
        &lt;div class="markDownOutput "&gt;First off, I just want to commend all the folks on the EPPlus team for their awesome library. Creating Excel sheets is a snap and it has really helped not to require MS Office installed on the machine that uses my app.
&lt;br&gt;
&lt;br&gt;
However, I have an existing spreadsheet with 6-7 columns, and I'd like to select a row of that data if one of those columns has a certain value.
&lt;br&gt;
&lt;br&gt;
I wasn't sure if there was an existing mechanism to do this sort of thing but searching each cell seemed quite expensive.
&lt;br&gt;
&lt;br&gt;
The worksheet isn't huge, about 500 rows. &lt;br&gt;
&lt;br&gt;
Thanks!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="ArgumentOutOfRangeException in OfficeOpenXml.ExcelStyles.CreateNamedStyle()">
      <Posts>
        <Post From="MikeMangum" When="11/05/2011 05:23:06">
          <Html>
        
&lt;p&gt;I'm calling OfficeOpenXml.ExcelStyles.CreateNamedStyle() with the template overload and running into an ArgumentOutOfRange exception.&lt;/p&gt;
&lt;p&gt;My code:&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;ExcelRange styleRng = worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A"&lt;/span&gt; + emptyRow + &lt;span style="color: rgb(163, 21, 21);"&gt;":"&lt;/span&gt; + atlaswebCol + emptyRow];
ExcelStyle tempStyle = styleRng.Style;
&lt;span style="color: blue;"&gt;var&lt;/span&gt; namedStyle = xlPackage.Workbook.Styles.CreateNamedStyle(&lt;span style="color: rgb(163, 21, 21);"&gt;"HyperLink"&lt;/span&gt;, tempStyle);  
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;It is ultimately blowing up here:&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;class&lt;/span&gt; ExcelStyleCollection&amp;lt;T&amp;gt; : IEnumerable&amp;lt;T&amp;gt;
{
&lt;span style="color: green;"&gt;/*
 ...
*/&lt;/span&gt;
&lt;span style="color: blue;"&gt;public&lt;/span&gt; T &lt;span style="color: blue;"&gt;this&lt;/span&gt;[&lt;span style="color: blue;"&gt;int&lt;/span&gt; PositionID]
{
    &lt;span style="color: blue;"&gt;get&lt;/span&gt;
    {
        &lt;span style="color: blue;"&gt;return&lt;/span&gt; _list[PositionID]; &amp;lt;---
    }
}
&lt;/pre&gt;
&lt;pre&gt;this.PositionID = 8, whereas this.Count = 2;&lt;/pre&gt;
&lt;pre&gt;EPPlus.dll!OfficeOpenXml.Style.ExcelStyle.ExcelStyle(OfficeOpenXml.ExcelStyles styles = {OfficeOpenXml.ExcelStyles}, OfficeOpenXml.XmlHelper.ChangedEventHandler ChangedEvent = {Method = {System.Reflection.RuntimeMethodInfo}}, int PositionID = -1, string Address = "HyperLink", &lt;span style="color: rgb(255, 0, 0);"&gt;int xfsId = 8&lt;/span&gt;)&lt;/pre&gt;
&lt;pre&gt;I wasn't able to dig too deeply, but it looks like the we are passing the wrong value to the ctor. In the ExcelStyle ctor styles._styleXml.InnerXml contains, amongst other things:&lt;/pre&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;cellStyles&lt;/span&gt; &lt;span style="color: red;"&gt;count&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;2&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
  &lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;cellStyle&lt;/span&gt; &lt;span style="color: red;"&gt;name&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;Hyperlink&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: red;"&gt;xfId&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;1&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: red;"&gt;builtinId&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;8&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: blue;"&gt;/&amp;gt;&lt;/span&gt; 
  &lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;cellStyle&lt;/span&gt; &lt;span style="color: red;"&gt;name&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;Normal&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: red;"&gt;xfId&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;0&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: red;"&gt;builtinId&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;0&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: blue;"&gt;/&amp;gt;&lt;/span&gt; 
  &lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;cellStyles&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;

Are we possibly swapping the style ID for the index here?&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="12/05/2011 18:48:59">
          <Html>
        
&lt;p&gt;Hi&lt;/p&gt;
&lt;p&gt;Currently templates only works if you have another namedstyle, not a style from a cell.&lt;/p&gt;
&lt;p&gt;This is a bug, so I'll add a fix for it.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jxnim" When="07/02/2013 08:33:20">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
Is this bug getting fix now? &lt;br&gt;
&lt;br&gt;
If it's not, how can I make a cell's original style into a named style? &lt;br&gt;
&lt;br&gt;
Thank you.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Any solution for dum colections and DataTable">
      <Posts>
        <Post From="Datar" When="07/02/2013 08:20:39">
          <Html>
        &lt;div class="markDownOutput "&gt;Give me please any solution, for export data from my collection and DataTable to Excel with customize column names, format settings and maybe other properties. Thx&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Show Chart in Web using EPPlus">
      <Posts>
        <Post From="Phinehas" When="06/02/2013 03:04:37">
          <Html>
        &lt;div class="markDownOutput "&gt;Is it possible to show the chart (shown in image format) created in EPPlus to Web page?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="selecting Values from autofilter">
      <Posts>
        <Post From="natla" When="21/12/2010 12:40:27">
          <Html>
        
&lt;p&gt;I would like to select values from autofilter. can you please give me an example of code how i can do it.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="akronite" When="21/12/2010 13:27:10">
          <Html>
        Hi, could you please explain more of what you mean by autofilter?&lt;br&gt;
Just so I don't misunderstand you.&lt;br&gt;
&lt;br&gt;
On 12/21/10, natla &amp;lt;notifications@codeplex.com&amp;gt; wrote:&lt;br&gt;
&amp;gt; From: natla&lt;br&gt;
&amp;gt;&lt;br&gt;
&amp;gt; I would like to select values from autofilter. can you please give me an&lt;br&gt;
&amp;gt; example of code how i can do it.&lt;br&gt;
&amp;gt;&lt;br&gt;
&amp;gt; &lt;br&gt;
&lt;br&gt;
-- &lt;br&gt;
Sent from my mobile device
        
    </Html>
        </Post>
        <Post From="natla" When="21/12/2010 13:43:36">
          <Html>
        
&lt;p&gt;Hello akronite,&lt;/p&gt;
&lt;p&gt;&amp;nbsp; First of all thanks alot&amp;nbsp;for your quick reply. The Autofilter&amp;nbsp;keeps a&amp;nbsp;drop down arrow ﻿﻿on the top of every column in worksheet,to filter the data accordingly. Below code will explain how to keep auotfilter&lt;/p&gt;
&lt;p&gt;using System;&lt;br&gt;
using System.Collections.Generic;&lt;br&gt;
using System.Text;&lt;br&gt;
using System.IO;&lt;br&gt;
using OfficeOpenXml;&lt;br&gt;
using System.Xml;&lt;br&gt;
using System.Drawing;&lt;br&gt;
using OfficeOpenXml.Style;&lt;br&gt;
using System.Windows.Forms;&lt;br&gt;
&lt;br&gt;
namespace try1&lt;br&gt;
{&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; public partial class Form1 : Form&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; public Form1()&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; InitializeComponent();&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; private void Form1_Load(object sender, EventArgs e)&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; FileInfo shilpaFile = new FileInfo(@"C:\Book1.xlsx");&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; using (ExcelPackage package = new ExcelPackage(shilpaFile))&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ExcelWorksheet worksheet = package.Workbook.Worksheets[1];&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; //Create an autofilter for the range&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; worksheet.Cells["A1:ZZ1"].AutoFilter = true;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; package.Save();&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;/p&gt;
&lt;pre&gt;Now i want to select specific values from those autofilter. Dont know how to do it. please help with this.&lt;/pre&gt;
&lt;pre&gt;Thanks,&lt;/pre&gt;
&lt;pre&gt;Natla&lt;/pre&gt;

        
    </Html>
        </Post>
        <Post From="akronite" When="21/12/2010 14:24:40">
          <Html>
        Hrmmm... I see what you are trying to do. I'm not at my computer at&lt;br&gt;
the moment...&lt;br&gt;
Do you need this urgently? If so email Jan, he might be able to help&lt;br&gt;
you out straight away.&lt;br&gt;
Or if you can wait, then I'll take a look at it first thing in the morning.&lt;br&gt;
&lt;br&gt;
On 12/21/10, natla &amp;lt;notifications@codeplex.com&amp;gt; wrote:&lt;br&gt;
&amp;gt; From: natla&lt;br&gt;
&amp;gt;&lt;br&gt;
&amp;gt; Hello akronite, First of all thanks alot for your quick reply. The&lt;br&gt;
&amp;gt; Autofilter keeps a drop down arrow ﻿﻿on the top of every&lt;br&gt;
&amp;gt; column in worksheet,to filter the data accordingly. Below code will explain&lt;br&gt;
&amp;gt; how to keep auotfilterusing System;&lt;br&gt;
&amp;gt; using System.Collections.Generic;&lt;br&gt;
&amp;gt; using System.Text;&lt;br&gt;
&amp;gt; using System.IO;&lt;br&gt;
&amp;gt; using OfficeOpenXml;&lt;br&gt;
&amp;gt; using System.Xml;&lt;br&gt;
&amp;gt; using System.Drawing;&lt;br&gt;
&amp;gt; using OfficeOpenXml.Style;&lt;br&gt;
&amp;gt; using System.Windows.Forms;&lt;br&gt;
&amp;gt;&lt;br&gt;
&amp;gt; namespace try1&lt;br&gt;
&amp;gt; {&lt;br&gt;
&amp;gt; public partial class Form1 : Form&lt;br&gt;
&amp;gt; {&lt;br&gt;
&amp;gt; public Form1()&lt;br&gt;
&amp;gt; {&lt;br&gt;
&amp;gt; InitializeComponent();&lt;br&gt;
&amp;gt; }&lt;br&gt;
&amp;gt;&lt;br&gt;
&amp;gt; private void Form1_Load(object sender, EventArgs e)&lt;br&gt;
&amp;gt; {&lt;br&gt;
&amp;gt;&lt;br&gt;
&amp;gt; FileInfo shilpaFile = new FileInfo(@"C:\Book1.xlsx");&lt;br&gt;
&amp;gt;&lt;br&gt;
&amp;gt; using (ExcelPackage package = new ExcelPackage(shilpaFile))&lt;br&gt;
&amp;gt; {&lt;br&gt;
&amp;gt; ExcelWorksheet worksheet = package.Workbook.Worksheets[1];&lt;br&gt;
&amp;gt;&lt;br&gt;
&amp;gt; //Create an autofilter for the range&lt;br&gt;
&amp;gt; worksheet.Cells["A1:ZZ1"].AutoFilter = true;&lt;br&gt;
&amp;gt;&lt;br&gt;
&amp;gt;&lt;br&gt;
&amp;gt; package.Save();&lt;br&gt;
&amp;gt; }&lt;br&gt;
&amp;gt; }&lt;br&gt;
&amp;gt; }Now i want to select specific values from those autofilter. Dont know&lt;br&gt;
&amp;gt; how to do it. please help with this.Thanks,Natla&lt;br&gt;
&amp;gt;&lt;br&gt;
&amp;gt; &lt;br&gt;
&lt;br&gt;
-- &lt;br&gt;
Sent from my mobile device
        
    </Html>
        </Post>
        <Post From="natla" When="21/12/2010 15:11:38">
          <Html>
        
&lt;p&gt;Hello Akronite, i mailed Jan. If he could respond today,can you please look at it tomorrow morning.&lt;/p&gt;
&lt;p&gt;Thanks,&lt;/p&gt;
&lt;p&gt;Natla&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="akronite" When="21/12/2010 15:20:40">
          <Html>
        Yes, I'll certainly look into this first thing in the morning for you.&lt;br&gt;
&lt;br&gt;
Regards,&lt;br&gt;
-Michael T.&lt;br&gt;
&lt;br&gt;
On 12/21/10, natla &amp;lt;notifications@codeplex.com&amp;gt; wrote:&lt;br&gt;
&amp;gt; From: natla&lt;br&gt;
&amp;gt;&lt;br&gt;
&amp;gt; Hello Akronite, i mailed Jan. If he could respond today,can you please look&lt;br&gt;
&amp;gt; at it tomorrow morning.Thanks,Natla&lt;br&gt;
&amp;gt;&lt;br&gt;
&amp;gt; &lt;br&gt;
&lt;br&gt;
-- &lt;br&gt;
Sent from my mobile device
        
    </Html>
        </Post>
        <Post From="jankallman" When="21/12/2010 19:01:17">
          <Html>
        
&lt;p&gt;Hi, there is not support in the library to do that at the moment. If you must do it, you have to&amp;nbsp;work directly with&amp;nbsp;the WorksheetXml or add it to the component yourself.&lt;/p&gt;
&lt;p&gt;Since I have not done it I have no samples how to do it.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="ajmh" When="05/07/2011 20:43:26">
          <Html>
        
&lt;p&gt;In the interests of lending a hand, here's a quick workaround I used to add a straight value filter and a simple numeric filter on a sheet. You can always experiment with Excel to test what the output should be for other filter types and then apply accordingly.
 Here's a VB.Net snippet. The namespace stuff at the start is so that you can use the XPath request (a default namespace needs to be given an alias so you can query it).&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: green;"&gt;'&lt;/span&gt;
&lt;span style="color: green;"&gt;'... Assumes you've already defined an auto-filter range&lt;/span&gt;
&lt;span style="color: green;"&gt;'&lt;/span&gt;

&lt;span style="color: green;"&gt;'Create a namespace manager and add a default namespace so&lt;/span&gt;
&lt;span style="color: green;"&gt;'that we can actually use xpath to query nodes in the ns&lt;/span&gt;
&lt;span style="color: blue;"&gt;Dim&lt;/span&gt; nsMgr = &lt;span style="color: blue;"&gt;New&lt;/span&gt; System.Xml.XmlNamespaceManager(ws.WorksheetXml.NameTable)
nsMgr.AddNamespace(&lt;span style="color: rgb(163, 21, 21);"&gt;"default"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"http://schemas.openxmlformats.org/spreadsheetml/2006/main"&lt;/span&gt;)

&lt;span style="color: blue;"&gt;Dim&lt;/span&gt; autoFilterNode &lt;span style="color: blue;"&gt;As&lt;/span&gt; System.Xml.XmlNode = _&lt;br&gt;              ws.WorksheetXml.SelectSingleNode(&lt;span style="color: rgb(163, 21, 21);"&gt;"//default:autoFilter"&lt;/span&gt;, nsMgr)

&lt;span style="color: green;"&gt;' Create a simple value filter on the first column (0)&lt;/span&gt;
&lt;span style="color: blue;"&gt;Dim&lt;/span&gt; filterDef = &lt;span style="color: blue;"&gt;New&lt;/span&gt; XElement(&lt;span style="color: rgb(163, 21, 21);"&gt;"filterColumn"&lt;/span&gt;)
filterDef.Add(&lt;span style="color: blue;"&gt;New&lt;/span&gt; XAttribute(&lt;span style="color: rgb(163, 21, 21);"&gt;"colId"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"0"&lt;/span&gt;))
filterDef.Add(&lt;span style="color: blue;"&gt;New&lt;/span&gt; XElement(&lt;span style="color: rgb(163, 21, 21);"&gt;"filters"&lt;/span&gt;, _&lt;br&gt;              &lt;span style="color: blue;"&gt;New&lt;/span&gt; XElement(&lt;span style="color: rgb(163, 21, 21);"&gt;"filter"&lt;/span&gt;, &lt;span style="color: blue;"&gt;New&lt;/span&gt; XAttribute(&lt;span style="color: rgb(163, 21, 21);"&gt;"val"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"Some Text Label"&lt;/span&gt;))))
autoFilterNode.InnerXml = filterDef.ToString()

&lt;span style="color: green;"&gt;' Create a numeric comparison filter on the third column&lt;/span&gt;
filterDef = &lt;span style="color: blue;"&gt;New&lt;/span&gt; XElement(&lt;span style="color: rgb(163, 21, 21);"&gt;"filterColumn"&lt;/span&gt;)
filterDef.Add(&lt;span style="color: blue;"&gt;New&lt;/span&gt; XAttribute(&lt;span style="color: rgb(163, 21, 21);"&gt;"colId"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"2"&lt;/span&gt;))
filterDef.Add(&lt;span style="color: blue;"&gt;New&lt;/span&gt; XElement(&lt;span style="color: rgb(163, 21, 21);"&gt;"filters"&lt;/span&gt;, _&lt;br&gt;             &amp;nbsp;&lt;span style="color: blue;"&gt;New&lt;/span&gt; XElement(&lt;span style="color: rgb(163, 21, 21);"&gt;"filter"&lt;/span&gt;, &lt;span style="color: blue;"&gt;New&lt;/span&gt; XAttribute(&lt;span style="color: rgb(163, 21, 21);"&gt;"operator"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"greaterThanOrEqual"&lt;/span&gt;), _&lt;br&gt;             &amp;nbsp;&lt;span style="color: blue;"&gt;New&lt;/span&gt; XAttribute(&lt;span style="color: rgb(163, 21, 21);"&gt;"val"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"30"&lt;/span&gt;))))
autoFilterNode.InnerXml += filterDef.ToString()
&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="ajmh" When="05/02/2013 04:44:16">
          <Html>
        &lt;div class="markDownOutput "&gt;For folks who stumble across this thread now and in the future, I cannot make this statement strongly enough...
&lt;br&gt;
&lt;br&gt;
If you want / need to do something with this package which isn't already supported, try doing it in an Excel file using Excel, then unpack the source (it's just a zip archive with components inside) and see what Excel did - then copy!
&lt;br&gt;
&lt;br&gt;
Some of the things you may wish to do will require you to do some work to achieve - e.g. calculating resultant values or adding extra nodes to the XML tree to make sure the file opens consistently in Excel and other packages (like Open Office). Do what the
 pro's do; try it in Excel and copy :-) (Disclaimer: I'm not a pro, but I have been fortunate to know a few to learn from.)
&lt;br&gt;
&lt;br&gt;
With filters in the raw XML, there are some tricky little gotcha's where you may have to set additional attributes on the rows which need to be filtered out; if you read the MS packaging format documentation it describes the behavior in detail, even if it is
 a little tough to digest.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Get &quot;Unreadable content&quot; when saving any file">
      <Posts>
        <Post From="hiZis" When="04/02/2013 21:56:52">
          <Html>
        &lt;div class="markDownOutput "&gt;EPPlus is a great project and all, but I'm a bit confused here. Creating files goes flawlessly but when it comes to opening and saving I get an "Unreadable content" error and suggestion to repair it by Excel. It's actually working, but seeing
 this error each time is annoying. &lt;br&gt;
Not much to describe here... just doing this:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;FileInfo f = new FileInfo("test.xlsx"); // Newly created file in Excel.
ExcelPackage p = new ExcelPackage(f);
p.Save();&lt;/code&gt;&lt;/pre&gt;
And that's it. I'm using Russian localization for Windows and Excel, can it be the issue? Also when Excel repairs the file it says this (rough translation from Russian):&lt;br&gt;
&lt;blockquote&gt;Deleted records: Style from part /xl/styles.xml (Styles)&lt;br&gt;
Recovered records: Information about cells from part /xl/worksheets/sheet1.xml&lt;br&gt;
&lt;/blockquote&gt;
P.S.: Also, editing an EPPlus-created file goes without errors.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="04/02/2013 22:07:45">
          <Html>
        &lt;div class="markDownOutput "&gt;Several issues leads to unreadable content, please take a look at this threads&lt;br&gt;
&lt;br&gt;
&lt;a href="http://epplus.codeplex.com/discussions/223843" rel="nofollow"&gt;http://epplus.codeplex.com/discussions/223843&lt;/a&gt;&lt;br&gt;
&lt;a href="http://epplus.codeplex.com/discussions/265191" rel="nofollow"&gt;http://epplus.codeplex.com/discussions/265191&lt;/a&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="hiZis" When="04/02/2013 22:12:19">
          <Html>
        &lt;div class="markDownOutput "&gt;Yes, I googled it. It has nothing to do with my case, because I just trying to open and save an empty file without editing. So it can't be bad formula or something. I'm also not working with web stuff.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="04/02/2013 22:40:33">
          <Html>
        &lt;div class="markDownOutput "&gt;So lets try something else... &lt;br&gt;
&lt;br&gt;
1) Create a file with epplus, after open and repair the file with excel, "Save As" this copy.
&lt;br&gt;
2) Rename both file to zip and extract them &lt;br&gt;
3) Do a diff folder merge with winmerge, tell us where is the difference. &lt;br&gt;
&lt;br&gt;
Maybe we can figure out your problem. &lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="hiZis" When="04/02/2013 23:33:57">
          <Html>
        &lt;div class="markDownOutput "&gt;Okey... I compared the EPPlus resaved file and the same file repaired by Excel. So the problem is with the styles.xml file with a complete empty file and also the sheet1.xml with file including some data.
&lt;br&gt;
&lt;br&gt;
So, the diffs. &lt;br&gt;
Styles.xml from new Excel file:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;fonts x14ac:knownFonts="1" count="1"&amp;gt;&lt;/code&gt;&lt;/pre&gt;
After EPPlus:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;numFmts count="0"/&amp;gt;
&amp;lt;fonts count="1"&amp;gt;&lt;/code&gt;&lt;/pre&gt;
And from repaired it is again:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;fonts x14ac:knownFonts="1" count="1"&amp;gt;&lt;/code&gt;&lt;/pre&gt;
Sheet1.xml file with some data:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;sheetData&amp;gt;
   &amp;lt;row r="1"&amp;gt;
      &amp;lt;c r="A1" s="2"&amp;gt;
         &amp;lt;v&amp;gt;123&amp;lt;/v&amp;gt;
      &amp;lt;/c&amp;gt;
      &amp;lt;c r="B1" s="2" t="s"&amp;gt;
          &amp;lt;v&amp;gt;0&amp;lt;/v&amp;gt;
      &amp;lt;/c&amp;gt;
      &amp;lt;c r="C1" s="2"&amp;gt;
         &amp;lt;f&amp;gt;A1*2&amp;lt;/f&amp;gt;
      &amp;lt;/c&amp;gt;
   &amp;lt;/row&amp;gt;
&amp;lt;/sheetData&amp;gt;&lt;/code&gt;&lt;/pre&gt;
And from repaired file:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;sheetData&amp;gt;
   &amp;lt;row r="1" x14ac:dyDescent="0.25" spans="1:3"&amp;gt;
      &amp;lt;c r="A1"&amp;gt;
         &amp;lt;v&amp;gt;123&amp;lt;/v&amp;gt;
      &amp;lt;/c&amp;gt;
      &amp;lt;c r="B1" t="s"&amp;gt;
         &amp;lt;v&amp;gt;0&amp;lt;/v&amp;gt;
      &amp;lt;/c&amp;gt;
      &amp;lt;c r="C1"&amp;gt;
         &amp;lt;f&amp;gt;A1*2&amp;lt;/f&amp;gt;
         &amp;lt;v&amp;gt;246&amp;lt;/v&amp;gt;
      &amp;lt;/c&amp;gt;
   &amp;lt;/row&amp;gt;
&amp;lt;/sheetData&amp;gt;&lt;/code&gt;&lt;/pre&gt;
Here's the bunch of files: &lt;a href="https://dl.dropbox.com/u/11472736/ExcleEpplus.zip" rel="nofollow"&gt;
https://dl.dropbox.com/u/11472736/ExcleEpplus.zip&lt;/a&gt;&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="System.Security.Permissions.IsolatedStorageFilePermission">
      <Posts>
        <Post From="rivka" When="04/02/2013 22:21:55">
          <Html>
        &lt;div class="markDownOutput "&gt;I'm getting a security error when creating an excel file:&lt;br&gt;
&lt;br&gt;
__Security Exception&lt;br&gt;
&lt;br&gt;
Description: The application attempted to perform an operation not allowed by the security policy. To grant this application the required permission please contact your system administrator or change the application's trust level in the configuration file.
&lt;br&gt;
&lt;br&gt;
Exception Details: System.Security.SecurityException: Request for the permission of type 'System.Security.Permissions.IsolatedStorageFilePermission, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' failed.__&lt;br&gt;
&lt;br&gt;
Source Error: &lt;br&gt;
&lt;br&gt;
An unhandled exception was generated during the execution of the current web request. Information regarding the origin and location of the exception can be identified using the exception stack trace below.&lt;br&gt;
&lt;br&gt;
Stack Trace: &lt;br&gt;
&lt;br&gt;
&lt;br&gt;
[SecurityException: Request for the permission of type 'System.Security.Permissions.IsolatedStorageFilePermission, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' failed.]&lt;br&gt;
System.Security.CodeAccessSecurityEngine.Check(Object demand, StackCrawlMark&amp;amp; stackMark, Boolean isPermSet) +0&lt;br&gt;
System.Security.CodeAccessSecurityEngine.Check(CodeAccessPermission cap, StackCrawlMark&amp;amp; stackMark) +31&lt;br&gt;
System.Security.CodeAccessPermission.Demand() +46&lt;br&gt;
System.IO.IsolatedStorage.IsolatedStorage.DemandPermission(IsolatedStorageScope scope) +769&lt;br&gt;
System.IO.IsolatedStorage.IsolatedStorage.&lt;em&gt;InitStore(IsolatedStorageScope scope, Evidence domainEv, Type domainEvidenceType, Evidence assemEv, Type assemblyEvidenceType, Evidence appEv, Type appEvidenceType) +51&lt;br&gt;
System.IO.IsolatedStorage.IsolatedStorage.InitStore(IsolatedStorageScope scope, Type domainEvidenceType, Type assemblyEvidenceType) +160&lt;br&gt;
System.IO.IsolatedStorage.IsolatedStorageFile.GetStore(IsolatedStorageScope scope, Type domainEvidenceType, Type assemblyEvidenceType) +59&lt;br&gt;
MS.Internal.IO.Packaging.ReliableIsolatedStorageFileFolder.GetCurrentStore() +48&lt;br&gt;
MS.Internal.IO.Packaging.ReliableIsolatedStorageFileFolder..ctor() +64&lt;br&gt;
MS.Internal.IO.Packaging.PackagingUtilities.GetDefaultIsolatedStorageFile() +54&lt;br&gt;
MS.Internal.IO.Packaging.PackagingUtilities.CreateUserScopedIsolatedStorageFileStreamWithRandomName(Int32 retryCount, String&amp;amp; fileName) +122&lt;br&gt;
MS.Internal.IO.Packaging.SparseMemoryStream.SwitchModeIfNecessary() +373&lt;br&gt;
MS.Internal.IO.Packaging.SparseMemoryStream.Write(Byte[] buffer, Int32 offset, Int32 count) +189&lt;br&gt;
MS.Internal.IO.Packaging.CompressEmulationStream.Write(Byte[] buffer, Int32 offset, Int32 count) +60&lt;br&gt;
MS.Internal.IO.Packaging.CompressStream.Write(Byte[] buffer, Int32 offset, Int32 count) +138&lt;br&gt;
MS.Internal.IO.Zip.ProgressiveCrcCalculatingStream.Write(Byte[] buffer, Int32 offset, Int32 count) +170&lt;br&gt;
MS.Internal.IO.Zip.ZipIOModeEnforcingStream.Write(Byte[] buffer, Int32 offset, Int32 count) +86&lt;br&gt;
System.IO.StreamWriter.Flush(Boolean flushStream, Boolean flushEncoder) +98&lt;br&gt;
System.IO.StreamWriter.Write(String value) +109&lt;br&gt;
System.IO.TextWriter.Write(String format, Object arg0, Object arg1) +90&lt;br&gt;
OfficeOpenXml.ExcelWorksheet.UpdateRowCellData(StreamWriter sw) +5750&lt;br&gt;
OfficeOpenXml.ExcelWorksheet.SaveXml() +537&lt;br&gt;
OfficeOpenXml.ExcelWorksheet.Save() +218&lt;br&gt;
OfficeOpenXml.ExcelWorkbook.Save() +476&lt;br&gt;
OfficeOpenXml.ExcelPackage.Save() +52&lt;/em&gt;&lt;br&gt;
&lt;br&gt;
Here's my code:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;    public static FileInfo GenerateExcelFile(string filePath, DataTable dt, string headerText)
    {
        using (ExcelPackage pck = new ExcelPackage())
        {
            //Create the worksheet
            ExcelWorksheet ws = pck.Workbook.Worksheets.Add(string.IsNullOrEmpty(dt.TableName) ? "Sheet1" : dt.TableName);
            int startRow = 1;

            if (!string.IsNullOrEmpty(headerText))
            {
                ws.Cells[1, 1].Value = headerText;
                startRow = 2;
            }

            ws.Cells[startRow, 1].LoadFromDataTable(dt, true);

            pck.SaveAs(new FileInfo(filePath));


        }

        return new FileInfo(filePath);
    }
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="No color palette class in EPPlus?">
      <Posts>
        <Post From="jxnim" When="04/02/2013 07:39:36">
          <Html>
        &lt;div class="markDownOutput "&gt;Hi, &lt;br&gt;
&lt;br&gt;
I was trying to access the color palette of the excel workbook, and realized that there isn't one in EPPlus. Is there plan on implementing this?
&lt;br&gt;
&lt;br&gt;
Thank you for your fantastic work!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="xav2075" When="04/02/2013 08:19:48">
          <Html>
        &lt;div class="markDownOutput "&gt;Since Excel 2007 spreadsheets can support the full Windows RGB 16.7 million color palate. Add a reference to C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework.NETFramework\v4.0\System.Drawing.dll. And add using System.Drawing to your code
 file.&lt;br&gt;
&lt;br&gt;
Here is an example for setting a color:&lt;br&gt;
&lt;br&gt;
excel_worksheet_1.Cells["A1"].Style.Fill.PatternType = ExcelFillStyle.Solid;&lt;br&gt;
excel_worksheet_1.Cells["A1"].Style.Fill.BackgroundColor.SetColor(Color.FromArgb(79, 129, 189));&lt;br&gt;
&lt;br&gt;
If you see a particular color you want press the "PRINT SCRN" key then open the Windows paint program (type mspaint {enter} from the Run prompt). Paste\CTRL+V the snapshot of your windows desktop into paint then select the color picker tool, click
 on a color you want from the pasted image, 'Color 1' should change to the picked color, then click 'Edit colors', The chosen color will be selected with its respective Red, Green, Blue values.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="jxnim" When="04/02/2013 10:04:03">
          <Html>
        &lt;div class="markDownOutput "&gt;How if we want &lt;br&gt;
&lt;ul&gt;
&lt;li&gt;to use a particular color from the palette? &lt;br&gt;
Say, color at 20th index in palette?&lt;br&gt;
&lt;/li&gt;&lt;li&gt;check if the used color is a color from palette? &lt;br&gt;
Say, to check if Color.FromArgb(79, 129, 189) is a color in palette?&lt;br&gt;
&lt;/li&gt;&lt;/ul&gt;
Any idea how to achieve these using EPPlus?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Performance issue writing DateTimes to DataTable">
      <Posts>
        <Post From="joaster" When="14/01/2013 22:47:06">
          <Html>
        
&lt;p&gt;Hi there,&lt;br&gt;
&lt;br&gt;
We are using EPPlus to read and write data between Excel and a DataTable.&lt;/p&gt;
&lt;p&gt;&lt;span style="font-size: 10pt;"&gt;The tests below were performed using 2500 rows (we need to import 30.000 rows in practice).&lt;br&gt;
&lt;br&gt;
1. Baseline, read Excel sheet into DataTable as Strings takes &amp;lt; 1 second.&amp;nbsp;&lt;br&gt;
&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-size: 10pt;"&gt;2. Change the DataTable second column to the correct DataType Double. The import takes again &amp;lt; 1 second.&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-size: 10pt;"&gt;3. Change the&amp;nbsp;DataTable first column to the correct DataType DateTime. The import takes 27 seconds! Imaging if we are going to read 30.000 rows.&lt;br&gt;
&lt;br&gt;
Currently we loop through the rows to read them. Is there a beter way to do this because 27 seconds for 2500 rows is to long.&lt;br&gt;
&lt;br&gt;
&lt;/span&gt;&lt;span style="font-size: 10pt;"&gt;Regards,&lt;br&gt;
&lt;/span&gt;&lt;span style="font-size: 10pt;"&gt;Joost.&amp;nbsp;&lt;br&gt;
&lt;br&gt;
&lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="xav2075" When="15/01/2013 22:42:36">
          <Html>
        
&lt;p&gt;Code novice checking in.&amp;nbsp; If I could look at the spreadsheet in question and know exactly what you want to read from the spreadsheet into a DataTable I could try and do some speedy code.&lt;/p&gt;
&lt;p&gt;/EDIT:&amp;nbsp; If the spreadsheet has private data then I can understand if you can't provide that.&amp;nbsp; So instead if you could detail:&amp;nbsp; How many columns.&amp;nbsp; Per spreadsheet column what is the cell formatting type - Numeric\Date\Currency, etc.&amp;nbsp;
 Does Date column also include an hours\minutes\second.&amp;nbsp; What regional date format is used..&amp;nbsp; What is the typical\max length in characters of string column, etc, etc.&amp;nbsp;&amp;nbsp; So enough detail for me to create a test spreadsheet with some random
 data that fills 30,000 rows that is a good analogy of the data structure of your spreadsheet.&amp;nbsp; Also what are the Datatable columns and .Net DataTypes.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="joaster" When="16/01/2013 22:26:36">
          <Html>
        
&lt;p&gt;xav2075,&amp;nbsp;Thanks for responding. I have no problem sharing the Excel sheet, it contains test data. I don't see a way to attach it though.&lt;/p&gt;
&lt;p&gt;As I wrote above, everything goes quickly until I want to convert the first colum in Excel (formatted as Date with time part) into a DataTable column with datatype DateTime.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="xav2075" When="18/01/2013 12:49:30">
          <Html>
        
&lt;p&gt;I have sent you a forum message about sending me the spreadsheet.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="joaster" When="03/02/2013 20:28:44">
          <Html>
        &lt;div class="markDownOutput "&gt;xav2075, excuses for responding so late. I did not get the forum message, however the problem went away by itself this week.
&lt;br&gt;
&lt;br&gt;
My previous tests were done in a virtual machine, doing the tests on the host itself yielded the following results: 29.994 rows in 4.748 seconds.
&lt;br&gt;
&lt;br&gt;
This is acceptable to me.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Convert A1 address to integer row and column?">
      <Posts>
        <Post From="deserialized" When="31/01/2013 16:48:12">
          <Html>
        &lt;div class="markDownOutput "&gt;What is the best way to convert A1, E14 etc address to a row x and y? &lt;br&gt;
&lt;br&gt;
thanks&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="xav2075" When="31/01/2013 21:56:22">
          <Html>
        &lt;div class="markDownOutput "&gt;Here is an example that takes integer row and integer column values to create Excel "A1" type cell address to create a formula that uses a range of cells B2 to B65 -&amp;gt; = SUM(B2:B65)&lt;br&gt;
&lt;br&gt;
excel_worksheet_1.Cells[67, 2].Formula = string.Format("SUM({0}:{1})", ExcelCellBase.GetAddress(2, 2), ExcelCellBase.GetAddress(65, 2));&lt;br&gt;
&lt;br&gt;
Is this what you are looking for?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="deserialized" When="31/01/2013 22:01:24">
          <Html>
        &lt;div class="markDownOutput "&gt;Thanks but I do not see it. I have E14 address and want to get the underlying x,y in integer.
&lt;br&gt;
&lt;br&gt;
The GetAdress only seems to accept integers and not strings.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="xav2075" When="31/01/2013 22:35:26">
          <Html>
        &lt;div class="markDownOutput "&gt;I found a solution at &lt;a href="http://stackoverflow.com/questions/13994121/get-cells-row-number-using-epplus" rel="nofollow"&gt;
http://stackoverflow.com/questions/13994121/get-cells-row-number-using-epplus&lt;/a&gt;
&lt;br&gt;
&lt;br&gt;
So this will work: &lt;br&gt;
&lt;br&gt;
ExcelRange cella = excel_worksheet_0.Cells["E14"]; &lt;br&gt;
Int32 cell_row = cella.Start.Row; // returns 14 &lt;br&gt;
Int32 cell_column = cella.Start.Column; // returns 5&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="xav2075" When="31/01/2013 23:08:07">
          <Html>
        &lt;div class="markDownOutput "&gt;This is simpler:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;  Int32 cellb_row = excel_worksheet_0.Cells["E14"].Start.Row; // returns 14
  Int32 cellb_column = excel_worksheet_0.Cells["E14"].Start.Column; // returns 5&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="deserialized" When="31/01/2013 23:09:52">
          <Html>
        &lt;div class="markDownOutput "&gt;That worked great - thanks. This is not related but when I have found it and try to write a string value like this:
&lt;br&gt;
&lt;br&gt;
ws.Cells(startRow, curCol).Value = col &lt;br&gt;
&lt;br&gt;
Then Save. But nothing is updated in the document. Any ideas? &lt;br&gt;
&lt;br&gt;
I tried to hard code with ws.Cells(1, 1).Value = "test" but nothing was updated.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="xav2075" When="01/02/2013 03:40:59">
          <Html>
        &lt;div class="markDownOutput "&gt;Text that is not a number and will not be used for numeric\date like calculations should be assigned to a cell as:&lt;br&gt;
&lt;br&gt;
worksheet.Cells(1,1).Text = a_string;&lt;br&gt;
&lt;br&gt;
Otherwise assigning a string of text to a cell as a value:&lt;br&gt;
&lt;br&gt;
worksheet.Cells(1,1).Value = a_string;&lt;br&gt;
&lt;br&gt;
Will put a string into a worksheet cell but Excel will flag it as an error 'The number in the cell is formatted as text or preceded by an apostrophe'&lt;br&gt;
&lt;br&gt;
..?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="deserialized" When="02/02/2013 10:26:21">
          <Html>
        &lt;div class="markDownOutput "&gt;Thank you for all your help and answers!&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="method LoadFromText with column style properties">
      <Posts>
        <Post From="Datar" When="02/02/2013 10:13:19">
          <Html>
        &lt;div class="markDownOutput "&gt;Can you make method LoadFromText (and maybee all other similar methods) with column style properties (Alignment, Format, etc)? Posible expand ExcelTextFormat with ColumnStyles properties or DataTypes with style properties for column.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Add Picture in Comments of cell">
      <Posts>
        <Post From="artzxp" When="02/02/2013 05:43:45">
          <Html>
        &lt;div class="markDownOutput "&gt;Are there plans to allow inserting images into cell comments? I have searched everywhere and have not found a way to do this with EPPlus. Spreadsheet Light (&lt;a href="http://www.spreadsheetlight.com" rel="nofollow"&gt;http://www.spreadsheetlight.com&lt;/a&gt;) has
 this feature and it uses the same Open XML sdk but it lacks support for LINQ and only allows bulk loading from datatables. Is there any kind of workaround at the moment besides using VBA? Thanks.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="xav2075" When="02/02/2013 07:37:32">
          <Html>
        &lt;div class="markDownOutput "&gt;Sometimes people mix epplus code with lower level OpenXML code. So I suppose you could do stuff with epplus to prepare your spreadsheet. Save it and close it with epplus then perhaps open the same spreadsheet with spreadsheetlight and then add the comment
 with the image.&lt;br&gt;
&lt;br&gt;
I tried to use the excel_worksheet_2.Cells["A15"].Comment.RichText.Add() with the most minimal rich text format string including '\' escape character handling. But it would not work at run time. I assume If I could read a RTF file that has an image
 I could somehow in inject that as an epplus RTF string comment. But I could not get that to work either.&lt;br&gt;
&lt;br&gt;
/EDIT: From spreadsheetlight.com:&lt;br&gt;
&lt;br&gt;
Compiling the source code? Create your own (Visual Studio?) solution/project and add these references:&lt;br&gt;
&lt;pre&gt;&lt;code&gt;DocumentFormat.OpenXml (from the Open XML SDK)
System
System.Data
System.Drawing
System.Windows.Forms
System.XML
System.Xml.Linq
WindowsBase
&lt;/code&gt;&lt;/pre&gt;
.. The source code is not packaged into a Visual Studio .sln solution file which is a bit weird but as it says above you can use the source code into a new empty Visual Studio project and then add the using.. references so you can use all of .NET features including
 LINQ.&lt;br&gt;
&lt;br&gt;
I am new to coding and initially started using DataTables as they are flexible but since I have found that List&amp;lt;&amp;gt;'s with class wrappers are far faster for loading from a database and querying.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Using Sample 7 as a Guide unable to load a template and save as a workbook">
      <Posts>
        <Post From="mdesnoyer" When="07/08/2012 21:19:59">
          <Html>
        
&lt;p&gt;I am using Sample 7 as a guid. I am loading an excel template .xlt and saving it as an .xlsx&lt;/p&gt;
&lt;p&gt;I get an error when trying to open wsing Excel 2007. However, if I renamr the xlsx to a xltx excel will open it. (I tried both save ans saveas)&lt;/p&gt;
&lt;p&gt;﻿﻿﻿&lt;/p&gt;
&lt;p&gt;&amp;nbsp;OpenFileDialog dlg = new OpenFileDialog();&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; dlg.DefaultExt = "xltx; *.*";&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; dlg.FileName = "*.xltx";&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; if (dlg.ShowDialog() != DialogResult.OK)&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; return;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; FileInfo templateFile = new FileInfo(dlg.FileName);&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; //FileInfo newFile = new FileInfo(Path.ChangeExtension(dlg.FileName, "xlsx"));&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; string fPath = Path.GetDirectoryName(dlg.FileName);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; FileInfo newFile = new FileInfo( (Path.GetDirectoryName(dlg.FileName))+@"\testfile.xlsx");&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; if (newFile.Exists)&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; newFile.Delete();&amp;nbsp; // ensures we create a new workbook&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; //newFile = new FileInfo(outputDir.FullName + @"\sample5.xlsx");&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; newFile = new FileInfo((Path.GetDirectoryName(dlg.FileName)) + @"\testfile.xlsx");&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; using (ExcelPackage package = new ExcelPackage(newFile, templateFile))&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; //Open worksheet 1&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ExcelWorksheet worksheet = package.Workbook.Worksheets[1];&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; // save our new workbook and we are done!&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; package.Save();&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="weismat" When="08/08/2012 07:02:28">
          <Html>
        
&lt;p&gt;Did you get the repair dialog in Excel? Did you loose any information?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mdesnoyer" When="08/08/2012 15:49:20">
          <Html>
        
&lt;p&gt;1) I get this error message&lt;/p&gt;
&lt;p&gt;Excel cannot open the file 'testfile.xls' because the file format or the file extension is not valid, Verify that the file has not been corrupted and that the file extension matches the format of the file.&lt;/p&gt;
&lt;p&gt;2) When renamed to .xltx the file didi not loose any information. In fact in amother run I wrote into some cell and that was in the new file.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="robrbaron" When="01/02/2013 06:28:08">
          <Html>
        &lt;div class="markDownOutput "&gt;it appears that there is more involved in saving an XLTM file as XLSM than just changing the extension.
&lt;br&gt;
&lt;br&gt;
&lt;a href="http://epplus.codeplex.com/discussions/387657" rel="nofollow"&gt;http://epplus.codeplex.com/discussions/387657&lt;/a&gt; seems to use the MS OpenXML object, but i dont know how to implement.
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
I would like the EP+ object to support SaveAs with a format, as the Excel VBA workbook does.
&lt;br&gt;
&lt;br&gt;
xpression.SaveAs(FileName, FileFormat, ...&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="In Sample13, LoadFromDataTable + AutoFilter = Unreadable Content Error">
      <Posts>
        <Post From="jayschm" When="31/01/2013 14:24:59">
          <Html>
        &lt;div class="markDownOutput "&gt;In Sample13.cs, I added one line&lt;br&gt;
&lt;pre&gt;&lt;code&gt;        wsDt.Cells[wsDt.Dimension.Address].AutoFitColumns();
        wsDt.Cells[wsDt.Dimension.Address].AutoFilter = true; // this line added
&lt;/code&gt;&lt;/pre&gt;
When I run the SampleApp and then try to open Sample13.xlsx, I get a warning about unreadable content. Here is the recovery log:
&lt;br&gt;
&lt;br&gt;
&amp;lt;?xml version="1.0" encoding="UTF-8" standalone="yes" ?&amp;gt;
&lt;br&gt;
&lt;ul&gt;
&lt;li&gt;&amp;lt;recoveryLog xmlns="&lt;a href="http://schemas.openxmlformats.org/spreadsheetml/2006/main" rel="nofollow"&gt;http://schemas.openxmlformats.org/spreadsheetml/2006/main&lt;/a&gt;"&amp;gt;
&lt;br&gt;
&amp;lt;logFileName&amp;gt;error100440_01.xml&amp;lt;/logFileName&amp;gt; &lt;br&gt;
&amp;lt;summary&amp;gt;Errors were detected in file 'D:\EPPlus\SampleApp\bin\SampleApp\Sample13.xlsx'&amp;lt;/summary&amp;gt;
&lt;/li&gt;&lt;li&gt;&amp;lt;removedFeatures summary="Following is a list of removed features:"&amp;gt;
&lt;br&gt;
&amp;lt;removedFeature&amp;gt;Removed Feature: AutoFilter from /xl/tables/table1.xml part (Table)&amp;lt;/removedFeature&amp;gt;
&lt;br&gt;
&amp;lt;removedFeature&amp;gt;Removed Feature: Table from /xl/tables/table1.xml part (Table)&amp;lt;/removedFeature&amp;gt;
&lt;br&gt;
&amp;lt;/removedFeatures&amp;gt; &lt;br&gt;
&amp;lt;/recoveryLog&amp;gt;&lt;br&gt;
&lt;/li&gt;&lt;/ul&gt;
I tried it with the LoadFromCollection worksheets, and they gave the error as well.
&lt;br&gt;
&lt;br&gt;
I then tried removing the LoadFromDataTable and replaced that with manually iterating across the columns and rows to directly set cell values from the data table and then add the AutoFilter (similar to what Sample1 does), and that worked!
&lt;br&gt;
&lt;br&gt;
In playing with this, I noticed that LoadFromDataTable does result in autofiltering being enabled; that is, the column headers have the dropdown on them, whereas in the manual approach, that only happens if I set AutoFilter = true.
&lt;br&gt;
&lt;br&gt;
So, I tried setting AutoFilter = false with LoadFromDataTable, and that also gives me the unreadable content error.
&lt;br&gt;
&lt;br&gt;
Looking through the source, it looks like LoadFromDataTable basically does what I did, but then goes ahead and creates an ExcelTable from the populated addresses, whereas the manual approach does not have that ExcelTable in the mix.
&lt;br&gt;
&lt;br&gt;
So performance-wise, looks like it should be a wash and I can just use the manual approach. But it does seem like a bug.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
        <Post From="xav2075" When="01/02/2013 03:45:07">
          <Html>
        &lt;div class="markDownOutput "&gt;&lt;em&gt;googles what Autofilter does&lt;/em&gt;.. I think you can achieve what Autofilter does with a TableStyle. However when using the .LoadFromDataTable() method and specifying a Tablestyle is bugged and can produce a corrupted Excel package file. See discussion
&lt;a href="http://epplus.codeplex.com/discussions/349770" rel="nofollow"&gt;http://epplus.codeplex.com/discussions/349770&lt;/a&gt;. It shows how to create a TableStyle seperate from the .LoadFromDataTable method that has a Autofilter ability on the column headers.&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="export image in excel without distortion">
      <Posts>
        <Post From="readyjamil" When="30/01/2013 17:26:37">
          <Html>
        
&lt;p&gt;hi,&lt;/p&gt;
&lt;p&gt;when i export image in excel using epplus then image is distort&lt;/p&gt;
&lt;p&gt;how can handle this please give me solution .....&lt;/p&gt;
&lt;p&gt;urgent&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="tick mark for string cells">
      <Posts>
        <Post From="math1611" When="31/08/2011 22:18:20">
          <Html>
        
&lt;p&gt;I am trying to add string data to a cell. (Example:&amp;nbsp; 012)&lt;/p&gt;
&lt;p&gt;When it opens up in Excel, there is a green triangle in the upper left corner with the warning 'The number in this cell is formatted as text or preceded by an apostrophe'.&lt;/p&gt;
&lt;p&gt;I cannot change the excel options on the users machine.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;In VBA, you can do something like this to ignore the error:&lt;br&gt;
&amp;lt;tableObject&amp;gt;.Range("Q1:Q1000").Errors.Item(&amp;lt;errorNo&amp;gt;).Ignore = true
&lt;/li&gt;&lt;li&gt;In Spreadsheeet XML you can do something like this to ignore the error:&lt;br&gt;
&amp;lt;Cell&amp;gt;&amp;lt;Data ss:type="String" x:ticked="1"&amp;gt;012&amp;lt;/Data&amp;gt;&amp;lt;/Cell&amp;gt;
&lt;/li&gt;&lt;/ul&gt;
&lt;p&gt;Is there something equivalent to this in EPPlus?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="01/09/2011 19:28:29">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;No there is no support for suppressing errors on individual cells&amp;nbsp;in the current version, but its a good point, so I'lll add it to my TODO list.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="iceman1" When="31/07/2012 19:38:33">
          <Html>
        
&lt;p&gt;Any update on this issue? As I am also looking for a way to ignore these errors.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks,&lt;/p&gt;
&lt;p&gt;Rob&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="31/07/2012 20:43:20">
          <Html>
        
&lt;p&gt;I´m pretty sure that there is no news about this feature. But in our lastest version you can embed VBA code, maybe you can take a look at vba approach said in first post.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="math1611" When="28/11/2012 19:39:42">
          <Html>
        
&lt;p&gt;The following code will remove the triangles for cell A1.&amp;nbsp; I could not get it to work for a range of cells.&amp;nbsp; I can then loop through all cells (ie rows and columns) to set it.
&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;Workbook.CreateVBAProject();
&lt;span style="color: blue;"&gt;var&lt;/span&gt; sb = &lt;span style="color: blue;"&gt;new&lt;/span&gt; StringBuilder();
sb.AppendLine(&lt;span style="color: rgb(163, 21, 21);"&gt;"Public Sub IgnoreErrorNumberAsText()"&lt;/span&gt;);
sb.AppendLine(SheetName.Range(\&lt;span style="color: rgb(163, 21, 21);"&gt;"A1\").Errors.Item(xlNumberAsText).Ignore = True"&lt;/span&gt;);
sb.AppendLine(&lt;span style="color: rgb(163, 21, 21);"&gt;"End Sub"&lt;/span&gt;);
&lt;span style="color: blue;"&gt;var&lt;/span&gt; module = Workbook.VbaProject.Modules.AddModule(&lt;span style="color: rgb(163, 21, 21);"&gt;"AnyModuleName"&lt;/span&gt;);
module.Code = sb.ToString();
Workbook.CodeModule.code = &lt;span style="color: rgb(163, 21, 21);"&gt;"Private Sub Workbook_Open()\r\nCall IgnoreErrorNumberAstext()\r\nEndSub"&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="math1611" When="28/11/2012 19:58:25">
          <Html>
        
&lt;p&gt;The attached code only works in version 3.1 and the user must enable macros.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jayschm" When="30/01/2013 16:36:33">
          <Html>
        
&lt;p&gt;An alternative, which does require getting the source and modifying it slightly&lt;/p&gt;
&lt;p&gt;&lt;a href="http://stackoverflow.com/questions/11858109/using-epplus-excel-how-to-ignore-excel-error-checking-or-remove-green-tag-on-t" target="_blank" rel="nofollow"&gt;http://stackoverflow.com/questions/11858109/using-epplus-excel-how-to-ignore-excel-error-checking-or-remove-green-tag-on-t&lt;/a&gt;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Setting the title of a chart to a formula">
      <Posts>
        <Post From="JChristian11" When="29/01/2013 16:08:44">
          <Html>
        
&lt;p&gt;When I attempt to set the title of a chart to a formula it only shows the formula. When you click on the title, the formula does not show up in the formula bar'&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt; chart.Title.Text = &lt;span style="color: rgb(163, 21, 21);"&gt;"='"&lt;/span&gt; + tabName + &lt;span style="color: rgb(163, 21, 21);"&gt;"'!$A$12"&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;How do I change this so it shows the value of the formula and not the text itself?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="xav2075" When="29/01/2013 20:01:40">
          <Html>
        
&lt;p&gt;Have a look at this discussion thread &lt;a title=' ExcelWorksheet worksheet = package.Workbook.Worksheets[1];                 worksheet.InsertRow(5, 2);                  worksheet.Cells["A5"].Value = "12010";                 worksheet.Cells["B5"].Value = "Drill";                 worksheet.Cells["C5"].Value = 20;                 worksheet.Cells["D5"].Value = 8;                  worksheet.Cells["A6"].Value = "12011";                 worksheet.Cells["B6"].Value = "Crowbar";                 worksheet.Cells["C6"].Value = 7;                 worksheet.Cells["D6"].Value = 23.48;                  worksheet.Cells["E2:E6"].FormulaR1C1 = "RC[-2]*RC[-1]";                                  var name = worksheet.Names.Add("SubTotalName", worksheet.Cells["C7:E7"]);                 name.Style.Font.Italic = true;                 name.Formula = "SUBTOTAL(9,C2:C6)";                  //Format the new rows                 worksheet.Cells["C5:C6"].Style.Numberformat.Format = "#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;";                 worksheet.Cells["D5:E6"].Style.Numberformat.Format = "#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00";                  var chart = (worksheet.Drawings.AddChart("PieChart", eChartType.Pie3D) as ExcelPieChart);                  chart.Title.Text = "Total";                 //From row 1 colum 5 with five pixels offset                 chart.SetPosition(0, 0, 5, 5);                 chart.SetSize(600, 300);                  ExcelAddress valueAddress = new ExcelAddress(2, 5, 6, 5);                 var ser = (chart.Series.Add(valueAddress.Address, "B2:B6") as ExcelPieChartSerie);                 chart.DataLabel.ShowCategory = true;                 chart.DataLabel.ShowPercent = true;                   chart.Legend.Border.LineStyle = eLineStyle.Solid;                 chart.Legend.Border.Fill.Style = eFillStyle.SolidFill;                 chart.Legend.Border.Fill.Color = Color.DarkBlue;                  //Switch the PageLayoutView back to normal                 worksheet.View.PageLayoutView = false;' href=' ExcelWorksheet worksheet = package.Workbook.Worksheets[1];                 worksheet.InsertRow(5, 2);                  worksheet.Cells["A5"].Value = "12010";                 worksheet.Cells["B5"].Value = "Drill";                 worksheet.Cells["C5"].Value = 20;                 worksheet.Cells["D5"].Value = 8;                  worksheet.Cells["A6"].Value = "12011";                 worksheet.Cells["B6"].Value = "Crowbar";                 worksheet.Cells["C6"].Value = 7;                 worksheet.Cells["D6"].Value = 23.48;                  worksheet.Cells["E2:E6"].FormulaR1C1 = "RC[-2]*RC[-1]";                                  var name = worksheet.Names.Add("SubTotalName", worksheet.Cells["C7:E7"]);                 name.Style.Font.Italic = true;                 name.Formula = "SUBTOTAL(9,C2:C6)";                  //Format the new rows                 worksheet.Cells["C5:C6"].Style.Numberformat.Format = "#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;";                 worksheet.Cells["D5:E6"].Style.Numberformat.Format = "#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00";                  var chart = (worksheet.Drawings.AddChart("PieChart", eChartType.Pie3D) as ExcelPieChart);                  chart.Title.Text = "Total";                 //From row 1 colum 5 with five pixels offset                 chart.SetPosition(0, 0, 5, 5);                 chart.SetSize(600, 300);                  ExcelAddress valueAddress = new ExcelAddress(2, 5, 6, 5);                 var ser = (chart.Series.Add(valueAddress.Address, "B2:B6") as ExcelPieChartSerie);                 chart.DataLabel.ShowCategory = true;                 chart.DataLabel.ShowPercent = true;                   chart.Legend.Border.LineStyle = eLineStyle.Solid;                 chart.Legend.Border.Fill.Style = eFillStyle.SolidFill;                 chart.Legend.Border.Fill.Color = Color.DarkBlue;                  //Switch the PageLayoutView back to normal                 worksheet.View.PageLayoutView = false;' rel="nofollow"&gt;
https://epplus.codeplex.com/discussions/430509&lt;/a&gt; .&amp;nbsp; Particulary my post at the bottom that mentions .Formula.ToString();&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JChristian11" When="30/01/2013 12:26:26">
          <Html>
        
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Doing the following gives me the same result:&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div&gt;
&lt;pre&gt;                wsData.Cells[&lt;span&gt;"A13"&lt;/span&gt;].Formula = &lt;span&gt;"='"&lt;/span&gt; + tabName + &lt;span&gt;"'!$A$12"&lt;/span&gt;;
                chart.Title.Text = wsData.Cells[&lt;span&gt;"A13"&lt;/span&gt;].Formula.ToString();

&lt;/pre&gt;
&lt;pre&gt;It shows me the formula and not the result. Title doesn't have a formula property so I can't set a formula for it.&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Why do i not get the forumlar shown by Excel?">
      <Posts>
        <Post From="frederik310" When="30/01/2013 12:25:05">
          <Html>
        
&lt;p&gt;Hello&lt;/p&gt;
&lt;p&gt;I'm trying to get the formular of a cell in a worksheet. I know that the formular looks like this:&lt;/p&gt;
&lt;p&gt;='S:\test\[source1.xlsx]Sheet1'!A1&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;FileInfo excelFile = &lt;span style="color: blue;"&gt;new&lt;/span&gt; FileInfo(&lt;span style="color: rgb(163, 21, 21);"&gt;@"S:\test\Refs.xlsx"&lt;/span&gt;);
ExcelPackage excelPackage = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(excelFile);

ExcelWorksheet excelWorksheet = excelPackage.Workbook.Worksheets [1];
&lt;span style="color: blue;"&gt;var&lt;/span&gt; result = excelWorksheet.Cells [&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;].Formula;

&lt;span style="color: green;"&gt;// result ends up being:&lt;/span&gt;
&lt;span style="color: green;"&gt;// [1]Sheet1!A1&lt;/span&gt;

&lt;/pre&gt;
&lt;/div&gt;
Why do i not get the&amp;nbsp;whole formular? and why has the [source1.xlsx] been resolved to [1]?&lt;/div&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="StackOverflowException when saving a package ...">
      <Posts>
        <Post From="dvdwouwe" When="23/09/2012 11:45:25">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I developed a simple method to create a spreadsheet from a database view:&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;        public&lt;/span&gt; &lt;span style="color: blue;"&gt;static&lt;/span&gt; &lt;span style="color: blue;"&gt;byte&lt;/span&gt;[] CreateXlsFile(Type xlsReportType, IRelationPredicateBucket predicate, &lt;span style="color: blue;"&gt;int&lt;/span&gt; maxNumberOfTuplesToReturn, ISortExpression sortExpression)
        {
            IEnumerable&amp;lt;&lt;span style="color: blue;"&gt;string&lt;/span&gt;&amp;gt; fieldNames;
            &lt;span style="color: blue;"&gt;if&lt;/span&gt; (!s_EntityToXlsMappings.TryGetValue(xlsReportType, &lt;span style="color: blue;"&gt;out&lt;/span&gt; fieldNames))
            {
                &lt;span style="color: blue;"&gt;throw&lt;/span&gt; &lt;span style="color: blue;"&gt;new&lt;/span&gt; ApplicationException(String.Format(&lt;span style="color: rgb(163, 21, 21);"&gt;"Export of type {0} not supported."&lt;/span&gt;, xlsReportType.Name));
            }

            &lt;span style="color: blue;"&gt;using&lt;/span&gt; (ExcelPackage package = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage())
            {
                &lt;span style="color: green;"&gt;// Add a new worksheet to the empty workbook&lt;/span&gt;
                ExcelWorksheet worksheet = package.Workbook.Worksheets.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"Data"&lt;/span&gt;);
                &lt;span style="color: blue;"&gt;if&lt;/span&gt; (worksheet != &lt;span style="color: blue;"&gt;null&lt;/span&gt;)
                {
                    ExcelRangeBase range = worksheet
                        .Cells[1, 1]
                        .LoadFromArrays(
                            GetData(
                                xlsReportType,
                                predicate,
                                maxNumberOfTuplesToReturn,
                                sortExpression));
                    range.AutoFitColumns();
                }
                &lt;span style="color: blue;"&gt;return&lt;/span&gt; package.GetAsByteArray();
            }
        }

        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;static&lt;/span&gt; &lt;span style="color: blue;"&gt;byte&lt;/span&gt;[] CreateXlsFile&amp;lt;T&amp;gt;(IRelationPredicateBucket predicate, &lt;span style="color: blue;"&gt;int&lt;/span&gt; maxNumberOfTuplesToReturn, ISortExpression sortExpression)
            &lt;span style="color: blue;"&gt;where&lt;/span&gt; T : CommonEntityBase
        {
            &lt;span style="color: blue;"&gt;return&lt;/span&gt; CreateXlsFile(&lt;span style="color: blue;"&gt;typeof&lt;/span&gt;(T), predicate, maxNumberOfTuplesToReturn, sortExpression);
        }
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;All went well in my tests using following code, I could generate sheets with more then 50000 rows:&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;        [SetUp]
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;void&lt;/span&gt; MyTestInitialize()
        {
            InitializeLlblgenPro();
            GlobalService = &lt;span style="color: blue;"&gt;new&lt;/span&gt; GlobalService();
        }

        [Test]
        [Category(Categories.GlobalService)]
        [Ignore(&lt;span style="color: rgb(163, 21, 21);"&gt;@"ExportToXls integration test"&lt;/span&gt;)]
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;void&lt;/span&gt; ExportToXls()
        {
            IRelationPredicateBucket filterBucket = &lt;span style="color: blue;"&gt;null&lt;/span&gt;;&lt;span style="color: green;"&gt;// new RelationPredicateBucket(TobePaidOverviewFields.PaymentTypeId == (int)PaymentStateEntity.Values.SENDFTCS);&lt;/span&gt;
            &lt;span style="color: blue;"&gt;byte&lt;/span&gt;[] spreadSheet = GlobalService.ExportToXls(&lt;span style="color: blue;"&gt;typeof&lt;/span&gt;(TobePaidOverviewEntity), filterBucket);
            File.WriteAllBytes(&lt;span style="color: rgb(163, 21, 21);"&gt;@"d:\test\test.xlsx"&lt;/span&gt;, spreadSheet);
            Process.Start(&lt;span style="color: rgb(163, 21, 21);"&gt;@"d:\test\test.xlsx"&lt;/span&gt;);
        }
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Now the GlobalService class is designed for using WCF:&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;    [ServiceContract(Namespace = &lt;span style="color: rgb(163, 21, 21);"&gt;"http://Peopleware/Osiris"&lt;/span&gt;)]
    &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;interface&lt;/span&gt; IGlobalService
    {
        ...&lt;/pre&gt;
&lt;pre&gt;        [OperationContract, NetDataContract]
        &lt;span style="color: blue;"&gt;byte&lt;/span&gt;[] ExportToXls(Type type, IRelationPredicateBucket filterBucket);
    }


    [ServiceBehavior(
        InstanceContextMode = InstanceContextMode.PerCall,
        UseSynchronizationContext = &lt;span style="color: blue;"&gt;false&lt;/span&gt;,
        ConcurrencyMode = ConcurrencyMode.Multiple)]
    &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;class&lt;/span&gt; GlobalService : IGlobalService
    {
        ...&lt;/pre&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;        public&lt;/span&gt; &lt;span style="color: blue;"&gt;byte&lt;/span&gt;[] ExportToXls(Type entityType, IRelationPredicateBucket filterBucket)
        {
           &lt;span style="color: blue;"&gt;return&lt;/span&gt; Export.CreateXlsFile(&lt;span style="color: blue;"&gt;typeof&lt;/span&gt;(TobePaidOverviewEntity), filterBucket, 20000, &lt;span style="color: blue;"&gt;new&lt;/span&gt; SortExpression(TobePaidOverviewFields.Id | SortOperator.Ascending));
        }
    }
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;Calling the method ExportToXls from a client works for a low number of rows, but trying to export more then 7500 rows gives me a StackOverflowExcpetion. &amp;nbsp;I tried to execute the export on another thread with an increased StackSize (It seems that the
 worker threads of WCF doesn't use the default size of 1MB of stacksize) but it didn't solve it. &amp;nbsp;Any one have an idea to find the cause?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;The exception occurs at:&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;pre&gt;// file ExcelWorkSheet.cs

        private void UpdateRowCellData(StreamWriter sw)
        {
             ...
             sw.Write("", cell.CellAddress, (num3 &amp;lt; 0L) ? 0L : num3);
             ...
        }
&lt;/pre&gt;
When writing a cell containing a DB.Null value.
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;Danny&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="bplumlee_rtc" When="29/01/2013 22:31:17">
          <Html>
        
&lt;p&gt;I ran into the same problem yesterday with version 3.1.2. Building the WCF service in Release configuration fixed it for me. Still not certain why it won't work in a debug build of my WCF service.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="EPPlus search Worksheet by name">
      <Posts>
        <Post From="AlexZiani" When="18/12/2012 15:34:58">
          <Html>
        
&lt;p&gt;Hello everybody&lt;/p&gt;
&lt;p&gt;Now i'm using&amp;nbsp;workBook.Worksheets.First() to open the first worksheet of a XLSX file.&lt;/p&gt;
&lt;p&gt;There's a way to open a specify worksheet through a given string?&lt;/p&gt;
&lt;p&gt;Thanks everybody&lt;/p&gt;
&lt;p&gt;Alex&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Mateuszef" When="19/12/2012 12:37:13">
          <Html>
        
&lt;p&gt;Yes it is possible, &lt;span style="color: rgb(255, 0, 0);"&gt;Worksheets&lt;/span&gt; is indexed with string.&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;        &lt;span style="color: blue;"&gt;public&lt;/span&gt; ExcelWorksheet GetWorksheet(&lt;span style="color: blue;"&gt;string&lt;/span&gt; a_name)
        {
            &lt;span style="color: blue;"&gt;return&lt;/span&gt; m_excelPackage.Workbook.&lt;span style="color: rgb(255, 0, 0);"&gt;Worksheets&lt;/span&gt;[a_name];
        }&lt;br&gt;&lt;br&gt;&amp;nbsp;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Mateusz&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JasonSTX" When="29/01/2013 22:07:47">
          <Html>
        
&lt;p&gt;Or&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;static&lt;/span&gt; &lt;span style="color: blue;"&gt;void&lt;/span&gt; HideSheet(&lt;span style="color: blue;"&gt;string&lt;/span&gt; srcFile, &lt;span style="color: blue;"&gt;string&lt;/span&gt; sheet)
        {
            &lt;span style="color: blue;"&gt;try&lt;/span&gt;
            {                        
                FileInfo file = &lt;span style="color: blue;"&gt;new&lt;/span&gt; FileInfo(srcFile);
                ExcelPackage package = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(file);
                ExcelWorksheet mySheet = package.Workbook.Worksheets.First(x =&amp;gt; x.Name == sheet);
                mySheet.Hidden = eWorkSheetHidden.Hidden;                
                package.Save();               
            }
            &lt;span style="color: blue;"&gt;catch&lt;/span&gt; (Exception ex)
            {
               
            }
        }
&lt;/pre&gt;
&lt;/div&gt;
That way you can use things like x.Name.Comtains, etc.
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Can you please post a version compiled against Framework 4?">
      <Posts>
        <Post From="mkamoski" When="29/01/2013 21:01:04">
          <Html>
        
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Dear EPPlus Developers --&lt;/p&gt;
&lt;p&gt;Thank you for your nice project.&lt;/p&gt;
&lt;p&gt;Please help.&lt;/p&gt;
&lt;p&gt;Can you please post a version compiled against Framework 4?&lt;/p&gt;
&lt;p&gt;&lt;span style="white-space: pre;"&gt;C&lt;/span&gt;urrently, with the file "EPPlus 3.1.2" we get a version of the DLL that was compiled against "v2.0.50727" so it would be a good idea to post one compiled against Runtime Version "v4.0.30319"
 like the vast majority of the other DLLs in the new Visual Studio 2012 world, etc.&lt;/p&gt;
&lt;p&gt;This would help one to avoid any possible Framework glitches, etc.&lt;/p&gt;
&lt;p&gt;Please do consider this request.&lt;/p&gt;
&lt;p&gt;(Yes, I am going to try to "do it myself" to see if it works but I would rather the experts do it and it is impractical for me to do it over-and-over after each new release, etc.)&lt;/p&gt;
&lt;p&gt;(Regardless, the product is GREAT as-is so I am grateful for all your excellent work so far.)&lt;/p&gt;
&lt;p&gt;Thanks.&lt;/p&gt;
&lt;p&gt;-- Mark Kamoski&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mkamoski" When="29/01/2013 21:28:35">
          <Html>
        
&lt;blockquote style="margin: 0.25em 1em 0px; padding: 0px 0.25em; border: 0.1em solid rgb(204, 204, 204); border-image: none; font-style: italic;"&gt;
&lt;strong&gt;mkamoski wrote:&lt;/strong&gt;&lt;br&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;...(Yes, I am going to try to "do it myself" [compile in Framework 4] to see if it works but I would rather the experts do it and it is impractical for me to do it over-and-over after each new release, etc.)...&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Dear EpPlus Developers --&lt;/p&gt;
&lt;p&gt;FYI, I did try to compile the current source with Framework 4 and it seems fine.&lt;/p&gt;
&lt;p&gt;So it would be real easy for you to do it as a matter of course, going forward into the future, for the sake of progress at-large, etc.&lt;/p&gt;
&lt;p&gt;HTH.&lt;/p&gt;
&lt;p&gt;Thanks.&lt;/p&gt;
&lt;p&gt;-- Mark Kamoski&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Any install needed on server for EPPlus to work?">
      <Posts>
        <Post From="Zarc87" When="28/03/2011 10:33:17">
          <Html>
        
&lt;p&gt;I have a problem and need some help! :)&lt;/p&gt;
&lt;p&gt;&lt;span style="text-decoration: underline;"&gt;Short version:&amp;nbsp;&lt;/span&gt;&lt;br&gt;
Do I need to have something installed on the server for EPPlus.dll to work?&lt;/p&gt;
&lt;p&gt;&lt;span style="text-decoration: underline;"&gt;Longer version:&lt;/span&gt;&lt;br&gt;
I have used EPPlus when creating an application that reads data from an excel document and populates a database. The uploaded Excel document must follow a specified template. If this template is not followed the user will recieve error messages, depending on
 what was wrong with the document. One of the things the template requires is for the Excel-document to have 4 worksheets. If the document uploaded by the user doesn't have 4 worksheets an error message is displayed telling the user that the document should
 have 4 worksheets.&lt;/p&gt;
&lt;p&gt;Now, when running the application on my local machine everything works fine. But after having deployed it to my server I get my error message for when the document doesn't have 4 worksheets. So it seems that when on the server EPPlus cannot see that my .xlsx
 file has 4 worksheets (although it does). It does however pass the part of the code where I check if Workbook is null or not... so it seems like it understand that there is a workbook, but not that there are worksheets... workbook.Worksheets.Count is 0...&lt;/p&gt;
&lt;p&gt;On my local machine I have Office excel installed, on my server I do not. Do I need to have something installed on the server for EPPlus.dll to work properly?&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Zarc87" When="28/03/2011 14:36:10">
          <Html>
        
&lt;p&gt;I really need some serious help with this. Other people must have come across this too? It works on my local machine (where I have stuff like Microsoft Office installed) but not when deployed to the server (where I do not have Office installed)... any and
 all help would be much appreciated.&lt;/p&gt;
&lt;p&gt;I tried to install &lt;a href="http://www.microsoft.com/downloads/en/details.aspx?FamilyId=C6E744E5-36E9-45F5-8D8C-331DF206E0D0&amp;amp;displaylang=en" rel="nofollow"&gt;
Open XML SDK 2.0 for Microsoft Office&lt;/a&gt;&amp;nbsp;thinking that might be needed... it did not difference. What am I missing?&lt;/p&gt;
&lt;p&gt;Here is some of my code, if that helps anyone to help me, this works locally but not on the server, on the server workBook.Worksheets.Count is 0...&lt;/p&gt;
&lt;pre&gt;&lt;div style="color: black; background-color: white;"&gt;&lt;pre&gt;&lt;span style="color: blue;"&gt;if&lt;/span&gt; (file != &lt;span style="color: blue;"&gt;null&lt;/span&gt;)
            {
                &lt;span style="color: green;"&gt;//Open and read XLSX file&lt;/span&gt;
                &lt;span style="color: blue;"&gt;using&lt;/span&gt; (ExcelPackage package = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(file))
                {
                    &lt;span style="color: green;"&gt;//Get the work book in the file&lt;/span&gt;
                    ExcelWorkbook workBook = package.Workbook;
                    &lt;span style="color: blue;"&gt;if&lt;/span&gt; (workBook != &lt;span style="color: blue;"&gt;null&lt;/span&gt;)
                    {
                        &lt;span style="color: green;"&gt;//Get the worksheets of the document&lt;/span&gt;
                        &lt;span style="color: blue;"&gt;if&lt;/span&gt; (workBook.Worksheets.Count != 4)
                        {
                            ExcelWorksheet ws_FullService = workBook.Worksheets.ElementAt(0);
                            ExcelWorksheet ws_SMPrices = workBook.Worksheets.ElementAt(1);
                            ExcelWorksheet ws_VisitsPerYear = workBook.Worksheets.ElementAt(2);
                            ExcelWorksheet ws_WheelsPerMonth = workBook.Worksheets.ElementAt(3);&lt;/pre&gt;
&lt;/div&gt;
&lt;br&gt;&lt;/pre&gt;

        
    </Html>
        </Post>
        <Post From="swmal" When="28/03/2011 15:40:39">
          <Html>
        
&lt;p&gt;EPPlus does not require any Office software installed on the machine where you are using it. All it does is reading and writing xml files in the same format as Excel 2007 and higher.&lt;/p&gt;
&lt;p&gt;In the code you have provided you are testing if the number of worksheets is anything but 4. Is that your intention?&lt;/p&gt;
&lt;p&gt;﻿&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Zarc87" When="28/03/2011 15:56:30">
          <Html>
        
&lt;p&gt;Hello, thank you for your reply!&lt;/p&gt;
&lt;p&gt;Yes, the admin users have to follow an agreed upon template for the Excel files they upload. This template specified that the document should contian 4 worksheets. This works on my local machine, but not on my server. On the server the worksheets.Counts
 is 0. Also, if I were to skip that Count check and move on to the workBook.Worksheets.ElementAt(0) part I get that there is no such index. Same if I try .First() or just workBook.Worksheets[1]&lt;/p&gt;
&lt;p&gt;As I said, everything works just fine on my local machine... it really does seem like I've missed something when deploying my solution to my server.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Zarc87" When="28/03/2011 16:55:55">
          <Html>
        
&lt;p&gt;Okay, the solution to this problem was much easier (and more stupid) then I thought. &amp;nbsp;I made a small test application to try and isolate the issue, and with my test application everything works fine on the server.&amp;nbsp;&lt;/p&gt;
&lt;p&gt;You see, the "part" of my application that reads the excel data is in the form of a plugin ( using Managed Extensibility Framework (MEF)) so it could be easily replaced by some other way of reading the data... anyhow, it seems like the plugin simply doesn't
 know where to find the EPPlus.dll. So thank you for your time, I loved this library and as usual I hate the configuration involved with deploying my application to the server. :)&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="swmal" When="28/03/2011 17:17:32">
          <Html>
        
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;My best guess would be that you&amp;nbsp;should verify that the path of the existing Excel file is correct on your server. If EPPlus does not find the file it will create a new, blank workbook - which could explain why Worksheets.Count is 0.&lt;/p&gt;
&lt;p&gt;Edit: sorry, did not see your last message. Happy coding;)&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="lcreagh" When="29/01/2013 17:14:53">
          <Html>
        
&lt;p&gt;thanks for the response.&amp;nbsp; originally i thought i did not have a pathing issue, but indeed i did.&amp;nbsp; locally the hardcoded path was fine, and even though the exact same path exists in development, my fully qualiffied path wasn't working.&amp;nbsp; i changed
 the hardcoded path to server.mappath and a relative one, and it worked fine.&lt;/p&gt;
&lt;p&gt;thanks again,&lt;/p&gt;
&lt;p&gt;laura&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Create excel file on server from template">
      <Posts>
        <Post From="little_MASTER" When="04/05/2012 13:04:39">
          <Html>
        
&lt;p&gt;Hi all, first of all thanks for Your work, I've just started using this library but seeing thing it can done...wow :)&lt;/p&gt;
&lt;p&gt;I'm having a trouble figuring one little thing.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I would like to create an excel file from a template - create a new ExcelPackage in MemoryStream but using a file that I will load from server.&lt;/p&gt;
&lt;p&gt;Something like:&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;using (ExcelPackage p = new ExcelPackage(new MemoryStream(), new FileInfo("~/Test.xlsx")))
            {
            }
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;But I can't pass FileInfo as second parameter :/ Any ideas how to do that?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;My second question is how to copy a row (cells having name) add data to it.&lt;/p&gt;
&lt;p&gt;In my template I have 3 cells called "row" I would like to add copy of this row for every row in my DataTable and update formulas in summary row that is after template row.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;EDIT:&lt;/p&gt;
&lt;p&gt;I've solved first part like so:&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;using (ExcelPackage p = new ExcelPackage(new MemoryStream(), new MemoryStream(File.ReadAllBytes(System.Web.HttpContext.Current.Server.MapPath("Test.xlsx")))))
            {
            }
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;I'm using System.Web.HttpContext.Current.Server.MapPath() because I'm generating my excel in ashx&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="lcreagh" When="29/01/2013 16:47:14">
          <Html>
        
&lt;p&gt;I have&amp;nbsp;a template&amp;nbsp;problem&amp;nbsp;as well.&amp;nbsp; I have&amp;nbsp;template.xlsx&amp;nbsp;that I'm opening, then adding a new sheet which is a copy of the first sheet.&amp;nbsp; I can copy the template to a new worksheet locally, but failure occurs when I push
 the code to my dev server.&amp;nbsp; The following line of code works fine on localhost, but not when I push to my dev server.&lt;/p&gt;
&lt;p&gt;Dim worksheet As ExcelWorksheet = excelPackage.Workbook.Worksheets.Add("Sheet2", excelPackage.Workbook.Worksheets(1))&lt;/p&gt;
&lt;p&gt;That line of code throws the following error:&lt;/p&gt;
&lt;p&gt;System.Web.HttpUnhandledException (0x80004005): Exception of type 'System.Web.HttpUnhandledException' was thrown. ---&amp;gt; System.Collections.Generic.KeyNotFoundException: The given key was not present in the dictionary.&lt;br&gt;
at OfficeOpenXml.ExcelWorksheets.get_Item(Int32 PositionID)&lt;/p&gt;
&lt;p&gt;the rest of the stack trace just points to line numbers in my code&lt;/p&gt;
&lt;p&gt;The file permissions are the same for the template on both servers.&amp;nbsp; Locally I have Excel installed, but that shouldn't matter.&amp;nbsp; The only file I've deployed to the dev server's bin&amp;nbsp;is EPPlus.dll.&lt;/p&gt;
&lt;p&gt;Anyone have any ideas?&lt;/p&gt;
&lt;p&gt;Thanks.&lt;/p&gt;
&lt;p&gt;Laura&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Format percent on a specific slice in a pie chart.">
      <Posts>
        <Post From="JChristian11" When="29/01/2013 12:54:54">
          <Html>
        &lt;div class="markDownOutput "&gt;I have a pie chart where I am using show percent to show the percentage of each slice. One of the slices is less that one percent so it is showing zero. How to I programmatically format that value to show 2 decimal places if the percent is less than 1?
&lt;br&gt;
&lt;br&gt;
UPDATE: I still have not had any luck with this. I was hoping that there is a DataLabel collection or list that I could loop through and change the format based on the value. Is this possible?&lt;br&gt;
&lt;/div&gt;
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="conditional formatting pivot table">
      <Posts>
        <Post From="Bhanu1423" When="29/01/2013 11:12:11">
          <Html>
        
&lt;p&gt;hi all,&lt;/p&gt;
&lt;p&gt;When i apply conditional formatting to pivot table,formatting is applied only to&amp;nbsp; row headers and column headers &amp;nbsp;, but not data in pivot table,&lt;/p&gt;
&lt;p&gt;how to apply conditional formatting to data in pivot table&amp;nbsp;&lt;/p&gt;
&lt;p&gt;-- Thanks in advance&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Demo">
      <Posts>
        <Post From="han6man" When="29/01/2013 09:34:28">
          <Html>
        
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;using&lt;/span&gt; System;
&lt;span style="color: blue;"&gt;using&lt;/span&gt; System.Data;
&lt;span style="color: blue;"&gt;using&lt;/span&gt; System.Drawing;
&lt;span style="color: blue;"&gt;using&lt;/span&gt; System.IO;
&lt;span style="color: blue;"&gt;using&lt;/span&gt; System.Linq;
&lt;span style="color: blue;"&gt;using&lt;/span&gt; System.Windows.Forms;
&lt;span style="color: blue;"&gt;using&lt;/span&gt; Inz.Forms;
&lt;span style="color: blue;"&gt;using&lt;/span&gt; Inz.Identity;
&lt;span style="color: blue;"&gt;using&lt;/span&gt; Inz.Reports;
&lt;span style="color: blue;"&gt;using&lt;/span&gt; OfficeOpenXml;
&lt;span style="color: blue;"&gt;using&lt;/span&gt; OfficeOpenXml.Style;&lt;/pre&gt;
&lt;/div&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;        &lt;span style="color: blue;"&gt;private&lt;/span&gt; &lt;span style="color: blue;"&gt;bool&lt;/span&gt; hdr = &lt;span style="color: blue;"&gt;false&lt;/span&gt;;
        &lt;span style="color: blue;"&gt;private&lt;/span&gt; &lt;span style="color: blue;"&gt;bool&lt;/span&gt; frt = &lt;span style="color: blue;"&gt;false&lt;/span&gt;;
        &lt;span style="color: blue;"&gt;private&lt;/span&gt; &lt;span style="color: blue;"&gt;bool&lt;/span&gt; hdc = &lt;span style="color: blue;"&gt;false&lt;/span&gt;;&lt;/pre&gt;
&lt;pre&gt;        &lt;span style="color: blue;"&gt;private&lt;/span&gt; &lt;span style="color: blue;"&gt;int&lt;/span&gt; firstRowIndex
        {
            &lt;span style="color: blue;"&gt;get&lt;/span&gt;
            {
                &lt;span style="color: blue;"&gt;int&lt;/span&gt; result = 1;

                &lt;span style="color: blue;"&gt;if&lt;/span&gt; (hdr &amp;amp;&amp;amp; frt)
                    result = 3;
                &lt;span style="color: blue;"&gt;else&lt;/span&gt; &lt;span style="color: blue;"&gt;if&lt;/span&gt; (hdr || frt)
                    result = 2;
                &lt;span style="color: blue;"&gt;else&lt;/span&gt; &lt;span style="color: blue;"&gt;if&lt;/span&gt; (!hdr &amp;amp;&amp;amp; !frt)
                    result = 1;

                &lt;span style="color: blue;"&gt;return&lt;/span&gt; result;
            }
        }&lt;/pre&gt;
&lt;pre&gt;        &lt;span style="color: blue;"&gt;private&lt;/span&gt; &lt;span style="color: blue;"&gt;int&lt;/span&gt; firstColIndex
        {
            &lt;span style="color: blue;"&gt;get&lt;/span&gt;
            {
                &lt;span style="color: blue;"&gt;int&lt;/span&gt; result = 1;

                &lt;span style="color: blue;"&gt;if&lt;/span&gt; (hdc)
                    result = 2;
                &lt;span style="color: blue;"&gt;else&lt;/span&gt;
                    result = 1;

                &lt;span style="color: blue;"&gt;return&lt;/span&gt; result;
            }
        }&lt;/pre&gt;
&lt;pre&gt;        &lt;span style="color: blue;"&gt;string&lt;/span&gt; _reportTitle = &lt;span style="color: blue;"&gt;string&lt;/span&gt;.Empty;
        &lt;span style="color: blue;"&gt;string&lt;/span&gt; _reportDescpiption = &lt;span style="color: blue;"&gt;string&lt;/span&gt;.Empty;
        &lt;span style="color: blue;"&gt;protected&lt;/span&gt; DataTable _reportDataTable;
        &lt;span style="color: blue;"&gt;protected&lt;/span&gt; ReportDataSet _reportDataSet;
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; ReportDataSet ReportDSet
        {
            &lt;span style="color: blue;"&gt;get&lt;/span&gt; { &lt;span style="color: blue;"&gt;return&lt;/span&gt; &lt;span style="color: blue;"&gt;this&lt;/span&gt;._reportDataSet; }
            &lt;span style="color: blue;"&gt;set&lt;/span&gt;
            {
                value.DataSetName = &lt;span style="color: blue;"&gt;this&lt;/span&gt;._reportTitle;
                value.ExtendedProperties.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"_reportDescpiption"&lt;/span&gt;, &lt;span style="color: blue;"&gt;this&lt;/span&gt;._reportDescpiption);
                &lt;span style="color: blue;"&gt;this&lt;/span&gt;._reportDataSet = value;

                &lt;span style="color: blue;"&gt;this&lt;/span&gt;._reportDataTable = &lt;span style="color: blue;"&gt;this&lt;/span&gt;._reportDataSet.Tables[0];
                &lt;span style="color: blue;"&gt;this&lt;/span&gt;._reportDataTable.TableName = &lt;span style="color: blue;"&gt;this&lt;/span&gt;._reportTitle;
                &lt;span style="color: blue;"&gt;this&lt;/span&gt;._reportDataTable.ExtendedProperties.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"_reportDescpiption"&lt;/span&gt;, &lt;span style="color: blue;"&gt;this&lt;/span&gt;._reportDescpiption);
            }
        }
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; DataTable ReportDTable
        {
            &lt;span style="color: blue;"&gt;get&lt;/span&gt; { &lt;span style="color: blue;"&gt;return&lt;/span&gt; &lt;span style="color: blue;"&gt;this&lt;/span&gt;._reportDataSet.Tables[0]; }
            &lt;span style="color: blue;"&gt;set&lt;/span&gt;
            {
                &lt;span style="color: blue;"&gt;this&lt;/span&gt;._reportDataTable = value;

                &lt;span style="color: blue;"&gt;if&lt;/span&gt; (&lt;span style="color: blue;"&gt;this&lt;/span&gt;._reportDataSet.Tables[0] != &lt;span style="color: blue;"&gt;null&lt;/span&gt;)
                {
                    &lt;span style="color: blue;"&gt;this&lt;/span&gt;._reportDataSet.Tables[0].Clear();
                    &lt;span style="color: blue;"&gt;foreach&lt;/span&gt; (DataColumn item &lt;span style="color: blue;"&gt;in&lt;/span&gt; value.Columns)
                    {
                        &lt;span style="color: blue;"&gt;this&lt;/span&gt;._reportDataSet.Tables[0].Columns.Add(item);
                    }
                    &lt;span style="color: blue;"&gt;foreach&lt;/span&gt; (DataRow item &lt;span style="color: blue;"&gt;in&lt;/span&gt; value.Rows)
                    {
                        &lt;span style="color: blue;"&gt;this&lt;/span&gt;._reportDataSet.Tables[0].Rows.Add(item);
                    }
                }
                &lt;span style="color: blue;"&gt;else&lt;/span&gt;
                {
                    value.TableName = &lt;span style="color: blue;"&gt;this&lt;/span&gt;._reportTitle;
                    value.ExtendedProperties.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"_reportDescpiption"&lt;/span&gt;, &lt;span style="color: blue;"&gt;this&lt;/span&gt;._reportDescpiption);

                    &lt;span style="color: blue;"&gt;this&lt;/span&gt;._reportDataSet.Tables.Add(value);
                }
            }
        }
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; ReportTitle
        {
            &lt;span style="color: blue;"&gt;get&lt;/span&gt; { &lt;span style="color: blue;"&gt;return&lt;/span&gt; &lt;span style="color: blue;"&gt;this&lt;/span&gt;._reportTitle; }
            &lt;span style="color: blue;"&gt;set&lt;/span&gt;
            {
                &lt;span style="color: blue;"&gt;this&lt;/span&gt;._reportTitle = value;
                &lt;span style="color: blue;"&gt;this&lt;/span&gt;._reportDataSet.DataSetName = &lt;span style="color: blue;"&gt;this&lt;/span&gt;._reportTitle;
            }
        }
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; ReportDescription
        {
            &lt;span style="color: blue;"&gt;get&lt;/span&gt; { &lt;span style="color: blue;"&gt;return&lt;/span&gt; &lt;span style="color: blue;"&gt;this&lt;/span&gt;._reportDescpiption; }
            &lt;span style="color: blue;"&gt;set&lt;/span&gt;
            {
                &lt;span style="color: blue;"&gt;this&lt;/span&gt;._reportDescpiption = value;
                &lt;span style="color: blue;"&gt;if&lt;/span&gt; (&lt;span style="color: blue;"&gt;this&lt;/span&gt;._reportDataSet.ExtendedProperties.Count == 0 || !&lt;span style="color: blue;"&gt;this&lt;/span&gt;._reportDataSet.ExtendedProperties.Contains(&lt;span style="color: rgb(163, 21, 21);"&gt;"_reportDescpiption"&lt;/span&gt;))
                {
                    &lt;span style="color: blue;"&gt;this&lt;/span&gt;._reportDataSet.ExtendedProperties.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"_reportDescpiption"&lt;/span&gt;, &lt;span style="color: blue;"&gt;this&lt;/span&gt;._reportDescpiption);
                }
                &lt;span style="color: blue;"&gt;else&lt;/span&gt;
                {
                    &lt;span style="color: blue;"&gt;this&lt;/span&gt;._reportDataSet.ExtendedProperties[&lt;span style="color: rgb(163, 21, 21);"&gt;"_reportDescpiption"&lt;/span&gt;] = &lt;span style="color: blue;"&gt;this&lt;/span&gt;._reportDescpiption;
                }
            }
        }
        
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;int&lt;/span&gt; RowsCount
        {
            &lt;span style="color: blue;"&gt;get&lt;/span&gt; { &lt;span style="color: blue;"&gt;return&lt;/span&gt; &lt;span style="color: blue;"&gt;this&lt;/span&gt;._reportDataTable.Rows.Count; }
        }
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;int&lt;/span&gt; ColumnsCount
        {
            &lt;span style="color: blue;"&gt;get&lt;/span&gt; { &lt;span style="color: blue;"&gt;return&lt;/span&gt; &lt;span style="color: blue;"&gt;this&lt;/span&gt;._reportDataTable.Columns.Count; }
        }
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;private&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; EscapeSheetName(&lt;span style="color: blue;"&gt;string&lt;/span&gt; sheetName)
        {
            &lt;span style="color: blue;"&gt;var&lt;/span&gt; escapedSheetName = sheetName
                                        .Replace(&lt;span style="color: rgb(163, 21, 21);"&gt;"/"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"-"&lt;/span&gt;)
                                        .Replace(&lt;span style="color: rgb(163, 21, 21);"&gt;"\\", "&lt;/span&gt; ")
                                        .Replace(&lt;span style="color: rgb(163, 21, 21);"&gt;"?"&lt;/span&gt;, &lt;span style="color: blue;"&gt;string&lt;/span&gt;.Empty)
                                        .Replace(&lt;span style="color: rgb(163, 21, 21);"&gt;"*"&lt;/span&gt;, &lt;span style="color: blue;"&gt;string&lt;/span&gt;.Empty)
                                        .Replace(&lt;span style="color: rgb(163, 21, 21);"&gt;"["&lt;/span&gt;, &lt;span style="color: blue;"&gt;string&lt;/span&gt;.Empty)
                                        .Replace(&lt;span style="color: rgb(163, 21, 21);"&gt;"]"&lt;/span&gt;, &lt;span style="color: blue;"&gt;string&lt;/span&gt;.Empty)
                                        .Replace(&lt;span style="color: rgb(163, 21, 21);"&gt;":"&lt;/span&gt;, &lt;span style="color: blue;"&gt;string&lt;/span&gt;.Empty);

            &lt;span style="color: blue;"&gt;if&lt;/span&gt; (escapedSheetName.Length &amp;gt; MaximumSheetNameLength)
                escapedSheetName = escapedSheetName.Substring(0, MaximumSheetNameLength);

            &lt;span style="color: blue;"&gt;return&lt;/span&gt; escapedSheetName;
        }
        &lt;span style="color: blue;"&gt;private&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; SetNumberFormat(Type type)
        {
            &lt;span style="color: blue;"&gt;string&lt;/span&gt; result = &lt;span style="color: rgb(163, 21, 21);"&gt;"@"&lt;/span&gt;;

            &lt;span style="color: blue;"&gt;if&lt;/span&gt; (type == &lt;span style="color: blue;"&gt;typeof&lt;/span&gt;(&lt;span style="color: blue;"&gt;string&lt;/span&gt;))
                result = &lt;span style="color: rgb(163, 21, 21);"&gt;"@"&lt;/span&gt;;
            &lt;span style="color: blue;"&gt;else&lt;/span&gt; &lt;span style="color: blue;"&gt;if&lt;/span&gt; (type == &lt;span style="color: blue;"&gt;typeof&lt;/span&gt;(&lt;span style="color: blue;"&gt;sbyte&lt;/span&gt;))
                result = &lt;span style="color: rgb(163, 21, 21);"&gt;"#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;"&lt;/span&gt;;
            &lt;span style="color: blue;"&gt;else&lt;/span&gt; &lt;span style="color: blue;"&gt;if&lt;/span&gt; (type == &lt;span style="color: blue;"&gt;typeof&lt;/span&gt;(&lt;span style="color: blue;"&gt;byte&lt;/span&gt;))
                result = &lt;span style="color: rgb(163, 21, 21);"&gt;"#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;"&lt;/span&gt;;
            &lt;span style="color: blue;"&gt;else&lt;/span&gt; &lt;span style="color: blue;"&gt;if&lt;/span&gt; (type == &lt;span style="color: blue;"&gt;typeof&lt;/span&gt;(&lt;span style="color: blue;"&gt;bool&lt;/span&gt;))
                result = &lt;span style="color: rgb(163, 21, 21);"&gt;"0"&lt;/span&gt;;
            &lt;span style="color: blue;"&gt;else&lt;/span&gt; &lt;span style="color: blue;"&gt;if&lt;/span&gt; (type == &lt;span style="color: blue;"&gt;typeof&lt;/span&gt;(&lt;span style="color: blue;"&gt;short&lt;/span&gt;))
                result = &lt;span style="color: rgb(163, 21, 21);"&gt;"###&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;"&lt;/span&gt;;
            &lt;span style="color: blue;"&gt;else&lt;/span&gt; &lt;span style="color: blue;"&gt;if&lt;/span&gt; (type == &lt;span style="color: blue;"&gt;typeof&lt;/span&gt;(&lt;span style="color: blue;"&gt;ushort&lt;/span&gt;))
                result = &lt;span style="color: rgb(163, 21, 21);"&gt;"###&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;"&lt;/span&gt;;
            &lt;span style="color: blue;"&gt;else&lt;/span&gt; &lt;span style="color: blue;"&gt;if&lt;/span&gt; (type == &lt;span style="color: blue;"&gt;typeof&lt;/span&gt;(&lt;span style="color: blue;"&gt;int&lt;/span&gt;))
                result = &lt;span style="color: rgb(163, 21, 21);"&gt;"#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;"&lt;/span&gt;;
            &lt;span style="color: blue;"&gt;else&lt;/span&gt; &lt;span style="color: blue;"&gt;if&lt;/span&gt; (type == &lt;span style="color: blue;"&gt;typeof&lt;/span&gt;(&lt;span style="color: blue;"&gt;uint&lt;/span&gt;))
                result = &lt;span style="color: rgb(163, 21, 21);"&gt;"#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;"&lt;/span&gt;;
            &lt;span style="color: blue;"&gt;else&lt;/span&gt; &lt;span style="color: blue;"&gt;if&lt;/span&gt; (type == &lt;span style="color: blue;"&gt;typeof&lt;/span&gt;(&lt;span style="color: blue;"&gt;long&lt;/span&gt;))
                result = &lt;span style="color: rgb(163, 21, 21);"&gt;"#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;"&lt;/span&gt;;
            &lt;span style="color: blue;"&gt;else&lt;/span&gt; &lt;span style="color: blue;"&gt;if&lt;/span&gt; (type == &lt;span style="color: blue;"&gt;typeof&lt;/span&gt;(&lt;span style="color: blue;"&gt;ulong&lt;/span&gt;))
                result = &lt;span style="color: rgb(163, 21, 21);"&gt;"#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;"&lt;/span&gt;;
            &lt;span style="color: blue;"&gt;else&lt;/span&gt; &lt;span style="color: blue;"&gt;if&lt;/span&gt; (type == &lt;span style="color: blue;"&gt;typeof&lt;/span&gt;(&lt;span style="color: blue;"&gt;float&lt;/span&gt;))
                result = &lt;span style="color: rgb(163, 21, 21);"&gt;".#######"&lt;/span&gt;;
            &lt;span style="color: blue;"&gt;else&lt;/span&gt; &lt;span style="color: blue;"&gt;if&lt;/span&gt; (type == &lt;span style="color: blue;"&gt;typeof&lt;/span&gt;(&lt;span style="color: blue;"&gt;double&lt;/span&gt;))
                result = &lt;span style="color: rgb(163, 21, 21);"&gt;".################"&lt;/span&gt;;
            &lt;span style="color: blue;"&gt;else&lt;/span&gt; &lt;span style="color: blue;"&gt;if&lt;/span&gt; (type == &lt;span style="color: blue;"&gt;typeof&lt;/span&gt;(&lt;span style="color: blue;"&gt;decimal&lt;/span&gt;))
                result = &lt;span style="color: rgb(163, 21, 21);"&gt;"₪ .00##########################"&lt;/span&gt;;
            &lt;span style="color: blue;"&gt;else&lt;/span&gt; &lt;span style="color: blue;"&gt;if&lt;/span&gt; (type == &lt;span style="color: blue;"&gt;typeof&lt;/span&gt;(DateTime))
                result = &lt;span style="color: rgb(163, 21, 21);"&gt;"dd/mm/yyyy"&lt;/span&gt;;

            &lt;span style="color: blue;"&gt;return&lt;/span&gt; result;
        }
        &lt;span style="color: blue;"&gt;private&lt;/span&gt; &lt;span style="color: blue;"&gt;bool&lt;/span&gt; ExcelBuilder(ExcelPackage excelPackage)
        {
            hdr = &lt;span style="color: blue;"&gt;false&lt;/span&gt;;
            frt = &lt;span style="color: blue;"&gt;false&lt;/span&gt;;
            hdc = &lt;span style="color: blue;"&gt;false&lt;/span&gt;;

            &lt;span style="color: blue;"&gt;#region&lt;/span&gt; ExcelPackageSetup
            &lt;span style="color: green;"&gt;//Step 4 : (Optional) Set the file properties like title, author and subject&lt;/span&gt;
            excelPackage.Workbook.Properties.Title = &lt;span style="color: blue;"&gt;this&lt;/span&gt;._reportTitle;
            excelPackage.Workbook.Properties.Author = &lt;span style="color: rgb(163, 21, 21);"&gt;"Inz"&lt;/span&gt;;
            excelPackage.Workbook.Properties.Subject = &lt;span style="color: blue;"&gt;this&lt;/span&gt;._reportDescpiption;
            excelPackage.Workbook.Properties.Company = &lt;span style="color: rgb(163, 21, 21);"&gt;"Inz"&lt;/span&gt;;
            &lt;span style="color: blue;"&gt;#endregion&lt;/span&gt;

            &lt;span style="color: blue;"&gt;#region&lt;/span&gt; ExcelWorksheetSetup
            &lt;span style="color: green;"&gt;//Step 2 : Add a new worksheet to ExcelPackage object and give a suitable name&lt;/span&gt;
            excelPackage.Workbook.Worksheets.Add(&lt;span style="color: blue;"&gt;this&lt;/span&gt;.EscapeSheetName(&lt;span style="color: blue;"&gt;this&lt;/span&gt;._reportTitle));
            ExcelWorksheet ws = excelPackage.Workbook.Worksheets[1];
            &lt;span style="color: green;"&gt;//Setting Sheet's name&lt;/span&gt;
            ws.Name = &lt;span style="color: blue;"&gt;this&lt;/span&gt;._reportDataTable.TableName;
            &lt;span style="color: green;"&gt;//ws.BackgroundImage.SetFromFile(new FileInfo("SemelInzBlack.png"));&lt;/span&gt;

            &lt;span style="color: green;"&gt;//Default style for whole sheet&lt;/span&gt;
            &lt;span style="color: green;"&gt;//ws.Cells.Style.Font.SetFromFont(new Font("Calibri", 11, FontStyle.Regular));&lt;/span&gt;
            ws.Cells.Style.Font.Size = 11; &lt;span style="color: green;"&gt;//Default font size for whole sheet&lt;/span&gt;
            ws.Cells.Style.Font.Name = &lt;span style="color: rgb(163, 21, 21);"&gt;"Calibri"&lt;/span&gt;; &lt;span style="color: green;"&gt;//Default Font name for whole sheet&lt;/span&gt;
            ws.Cells.Style.Font.Color.SetColor(Color.Black);
            ws.Cells.Style.HorizontalAlignment = ExcelHorizontalAlignment.Right;
            ws.Cells.Style.VerticalAlignment = ExcelVerticalAlignment.Center;
            &lt;span style="color: green;"&gt;//Setting borders of cell&lt;/span&gt;
            ws.Cells.Style.Border.Left.Style = ws.Cells.Style.Border.Right.Style = ExcelBorderStyle.None;
            ws.Cells.Style.Numberformat.Format = &lt;span style="color: rgb(163, 21, 21);"&gt;"General"&lt;/span&gt;;

            &lt;span style="color: green;"&gt;//Step 5 : Save all changes to ExcelPackage object which will create Excel 2007 file.&lt;/span&gt;
            &lt;span style="color: green;"&gt;// lets set the header text &lt;/span&gt;
            ws.HeaderFooter.OddHeader.CenteredText = &lt;span style="color: rgb(163, 21, 21);"&gt;"&amp;amp;"&lt;/span&gt; + 11 + &lt;span style="color: rgb(163, 21, 21);"&gt;"&amp;amp;U&amp;amp;\""&lt;/span&gt; + &lt;span style="color: rgb(163, 21, 21);"&gt;"Calibri"&lt;/span&gt; + &lt;span style="color: rgb(163, 21, 21);"&gt;",Regular Bold\" "&lt;/span&gt; + ws.Name;
            &lt;span style="color: green;"&gt;// add the page number to the footer plus the total number of pages&lt;/span&gt;
            ws.HeaderFooter.OddFooter.RightAlignedText = &lt;span style="color: blue;"&gt;string&lt;/span&gt;.Format(&lt;span style="color: rgb(163, 21, 21);"&gt;"Page {0} of {1}"&lt;/span&gt;, ExcelHeaderFooter.PageNumber, ExcelHeaderFooter.NumberOfPages);
            &lt;span style="color: green;"&gt;// add the sheet name to the footer&lt;/span&gt;
            ws.HeaderFooter.OddFooter.CenteredText = ExcelHeaderFooter.SheetName;
            &lt;span style="color: green;"&gt;// add the file path to the footer&lt;/span&gt;
            &lt;span style="color: green;"&gt;//ws.HeaderFooter.OddFooter.LeftAlignedText = ExcelHeaderFooter.FilePath + ExcelHeaderFooter.FileName;&lt;/span&gt;
            &lt;span style="color: green;"&gt;// Set RTL&lt;/span&gt;
            ws.View.RightToLeft = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
            ws.View.ShowGridLines = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
            ws.View.ShowHeaders = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
            &lt;span style="color: blue;"&gt;#endregion&lt;/span&gt;

            &lt;span style="color: blue;"&gt;#region&lt;/span&gt; CenterTopTitle
            &lt;span style="color: green;"&gt;//Merging cells and create a center heading for out table&lt;/span&gt;
            ws.Cells[firstRowIndex, firstColIndex].Value = &lt;span style="color: blue;"&gt;this&lt;/span&gt;.ReportDescription;
            ws.Cells[firstRowIndex, firstColIndex, 1, &lt;span style="color: blue;"&gt;this&lt;/span&gt;.ColumnsCount].Merge = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
            ws.Cells[firstRowIndex, firstColIndex, 1, &lt;span style="color: blue;"&gt;this&lt;/span&gt;.ColumnsCount].Style.Font.Bold = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
            ws.Cells[firstRowIndex, firstColIndex, 1, &lt;span style="color: blue;"&gt;this&lt;/span&gt;.ColumnsCount].Style.HorizontalAlignment = ExcelHorizontalAlignment.Center;
            frt = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
            &lt;span style="color: blue;"&gt;#endregion&lt;/span&gt;

            &lt;span style="color: blue;"&gt;#region&lt;/span&gt; Setting Headers
            &lt;span style="color: blue;"&gt;int&lt;/span&gt; colIndex = firstColIndex;
            &lt;span style="color: blue;"&gt;int&lt;/span&gt; rowIndex = firstRowIndex;

            &lt;span style="color: green;"&gt;//Creating Headings&lt;/span&gt;
            &lt;span style="color: blue;"&gt;foreach&lt;/span&gt; (DataColumn dc &lt;span style="color: blue;"&gt;in&lt;/span&gt; &lt;span style="color: blue;"&gt;this&lt;/span&gt;._reportDataTable.Columns)
            {
                &lt;span style="color: blue;"&gt;var&lt;/span&gt; cell = ws.Cells[rowIndex, colIndex];

                &lt;span style="color: green;"&gt;//Setting font of header cells&lt;/span&gt;
                &lt;span style="color: blue;"&gt;var&lt;/span&gt; font = cell.Style.Font;
                font.SetFromFont(&lt;span style="color: blue;"&gt;new&lt;/span&gt; Font(&lt;span style="color: rgb(163, 21, 21);"&gt;"Calibri"&lt;/span&gt;, 11, FontStyle.Bold));
                font.Color.SetColor(Color.White);

                &lt;span style="color: green;"&gt;//Setting the background color of header cells to Gray&lt;/span&gt;
                &lt;span style="color: blue;"&gt;var&lt;/span&gt; fill = cell.Style.Fill;
                fill.PatternType = ExcelFillStyle.Solid;
                fill.BackgroundColor.SetColor(Color.CadetBlue);


                &lt;span style="color: green;"&gt;//Setting Top/left,right/bottom borders.&lt;/span&gt;
                &lt;span style="color: blue;"&gt;var&lt;/span&gt; border = cell.Style.Border;
                border.Bottom.Style =
                    border.Top.Style =
                    border.Left.Style =
                    border.Right.Style = ExcelBorderStyle.Double;

                &lt;span style="color: green;"&gt;//Setting Value in cell&lt;/span&gt;
                cell.Value = &lt;span style="color: green;"&gt;/*"pre_" +*/&lt;/span&gt; dc.ColumnName;

                colIndex++;
            }

            hdr = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;

            &lt;span style="color: blue;"&gt;#endregion&lt;/span&gt;

            &lt;span style="color: blue;"&gt;#region&lt;/span&gt; LoadingData
            &lt;span style="color: green;"&gt;//ws.Cells["A3"].LoadFromDataTable(this._reportDataTable, false, TableStyles.Dark1);&lt;/span&gt;

            colIndex = firstColIndex;
            rowIndex = firstRowIndex;

            &lt;span style="color: blue;"&gt;foreach&lt;/span&gt; (DataRow dr &lt;span style="color: blue;"&gt;in&lt;/span&gt; &lt;span style="color: blue;"&gt;this&lt;/span&gt;._reportDataTable.Rows) &lt;span style="color: green;"&gt;// Adding Data into rows&lt;/span&gt;
            {
                &lt;span style="color: blue;"&gt;foreach&lt;/span&gt; (&lt;span style="color: blue;"&gt;object&lt;/span&gt; value &lt;span style="color: blue;"&gt;in&lt;/span&gt; dr.ItemArray)
                {
                    &lt;span style="color: blue;"&gt;var&lt;/span&gt; cell = ws.Cells[rowIndex, colIndex];
                    &lt;span style="color: green;"&gt;//Setting Value in cell&lt;/span&gt;
                    cell.Value = value; &lt;span style="color: green;"&gt;// Convert.ChangeType(value, value.GetType());&lt;/span&gt;

                    &lt;span style="color: blue;"&gt;var&lt;/span&gt; style = cell.Style;
                    style.Numberformat.Format = SetNumberFormat(value.GetType());
                    &lt;span style="color: green;"&gt;// this.dataFormats[colIndex - 1];&lt;/span&gt;
                    &lt;span style="color: green;"&gt;//style.HorizontalAlignment = ExcelHorizontalAlignment.Right;&lt;/span&gt;
                    &lt;span style="color: green;"&gt;//style.VerticalAlignment = ExcelVerticalAlignment.Center;&lt;/span&gt;
                    &lt;span style="color: green;"&gt;//style.Font.SetFromFont(new Font("Calibri", 11, FontStyle.Regular));&lt;/span&gt;
                    &lt;span style="color: green;"&gt;//style.Font.Color.SetColor(Color.Black);&lt;/span&gt;

                    &lt;span style="color: gray;"&gt;///&lt;/span&gt;&lt;span style="color: green;"&gt;/Setting borders of cell&lt;/span&gt;
                    &lt;span style="color: green;"&gt;//var border = cell.Style.Border;&lt;/span&gt;
                    &lt;span style="color: green;"&gt;//border.Left.Style =&lt;/span&gt;
                    &lt;span style="color: green;"&gt;//    border.Right.Style = ExcelBorderStyle.Thin;&lt;/span&gt;
                    colIndex++;
                }
                colIndex = firstColIndex;
                rowIndex++;

            }

            &lt;span style="color: blue;"&gt;#endregion&lt;/span&gt;

            &lt;span style="color: green;"&gt;//Create an autofilter for the range&lt;/span&gt;
            &lt;span style="color: blue;"&gt;if&lt;/span&gt; (&lt;span style="color: blue;"&gt;this&lt;/span&gt;.RowsCount &amp;gt; 0 &amp;amp;&amp;amp; &lt;span style="color: blue;"&gt;this&lt;/span&gt;.ColumnsCount &amp;gt; 0)
            {
                ws.Cells[(firstRowIndex - 1), firstColIndex, ((firstRowIndex - 1) + &lt;span style="color: blue;"&gt;this&lt;/span&gt;.RowsCount), &lt;span style="color: blue;"&gt;this&lt;/span&gt;.ColumnsCount].AutoFilter = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
            }

            &lt;span style="color: green;"&gt;//Autofit columns for all cells            &lt;/span&gt;
            ws.Cells.AutoFitColumns(0);

            ExcelPrinterSettings ps = ws.PrinterSettings;
            ps.BlackAndWhite = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
            ps.Draft = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
            ps.FitToPage = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
            ps.PaperSize = ePaperSize.A4;
            ps.PrintArea = ws.Cells[1, 1, (&lt;span style="color: blue;"&gt;this&lt;/span&gt;.RowsCount - 1) + &lt;span style="color: blue;"&gt;this&lt;/span&gt;.firstRowIndex, &lt;span style="color: blue;"&gt;this&lt;/span&gt;.ColumnsCount];

            &lt;span style="color: blue;"&gt;return&lt;/span&gt; &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
        }
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Select / Focus a cell">
      <Posts>
        <Post From="halex" When="14/03/2012 14:56:34">
          <Html>
        
&lt;p&gt;Hi all!&lt;/p&gt;
&lt;p&gt;I am trying to select a cell so that it is focused when the workbook is opened.&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I have this:&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;var&lt;/span&gt; ws = ..&lt;span style="color: green;"&gt;//my Worksheet&lt;/span&gt;
ws.Select(&lt;span style="color: rgb(163, 21, 21);"&gt;"A2"&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;However, this only *selects* the cell. I have many columns and when the workbook is opened, the A2 cell is selected but it is not focused, i.e. it's not shown in the visible area of Excel.&lt;/p&gt;
&lt;p&gt;If somebody can help, that'd be awesome :)&lt;/p&gt;
&lt;p&gt;Cheers!&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="divaperdomo" When="21/01/2013 22:39:50">
          <Html>
        
&lt;p&gt;when you save the .xlsx, make sure the selected cell is "A2", I guess that's the one you want to be selected/focused. It work perfectly for me! :)&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="halex" When="21/01/2013 23:15:41">
          <Html>
        
&lt;p&gt;Thanks for answering :)&lt;/p&gt;
&lt;p&gt;That was not the problem. A2 is selected. But, I have many columns .. like it goes all the way to AB or something like that, so when the worksheet is opened, A2 is selected, but you cannot see it, because the visible columns are e.g. F-A2. :)&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="lcreagh" When="28/01/2013 16:13:27">
          <Html>
        
&lt;p&gt;This is a late reply to an old post, but I'm having the same problem.&amp;nbsp; I do some calculations in the worksheet, then save it, but when reopened, the focus is at the bottom, whether I 'select' cells at the top or not.&amp;nbsp; I want to be able to set the
 focus to the top row of the sheet so that when opened, the sheet is scrolled to the top.&amp;nbsp; I've googled high and low and cannot find a way to do this.&amp;nbsp; Is it possible?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="xav2075" When="28/01/2013 17:16:57">
          <Html>
        
&lt;p&gt;I tried to find a epplus method to do this but I could not find anything.&amp;nbsp; Doing a compare of spreadsheets using the Microsoft Open XML SDK 2.5 Productivity Tool I found that the extra xml needed to set visable focus to a cell is only in one xml file
 within the Excel xml package.&amp;nbsp; But I don't know how to modify say .WorkbookXML to add the extra xml:-&lt;/p&gt;
&lt;p&gt;Differences in /xl/worksheets/sheet1.xml between a spreadsheet that has no viewable cell focused beyond its default of A1 and a spreadsheet that has its visible focus set to A86:-&lt;/p&gt;
&lt;p&gt;&amp;lt;?xml version="1.0" encoding="UTF-8" standalone="yes" ?&amp;gt;&lt;br&gt;
&amp;lt;worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"&amp;gt;&lt;br&gt;
&amp;nbsp;&amp;lt;dimension ref="A1"/&amp;gt;&lt;br&gt;
&amp;nbsp;&amp;lt;sheetViews&amp;gt;&lt;br&gt;
&amp;nbsp; &lt;span style="text-decoration: underline;"&gt;&amp;lt;sheetView tabSelected="1" workbookViewId="0"&amp;gt;&lt;/span&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;br&gt;
&amp;nbsp; &amp;lt;/sheetView&amp;gt;&lt;br&gt;
&amp;nbsp;&amp;lt;/sheetViews&amp;gt;&lt;br&gt;
&amp;nbsp;&amp;lt;sheetFormatPr defaultRowHeight="15"/&amp;gt;&lt;br&gt;
&amp;nbsp;&amp;lt;sheetData/&amp;gt;&lt;br&gt;
&amp;nbsp;&amp;lt;pageMargins left="0.7" right="0.7" top="0.75" bottom="0.75" header="0.3" footer="0.3"/&amp;gt;&lt;br&gt;
&amp;lt;/worksheet&amp;gt;&lt;/p&gt;
&lt;p&gt;&amp;lt;?xml version="1.0" encoding="UTF-8" standalone="yes" ?&amp;gt;&lt;br&gt;
&amp;lt;worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"&amp;gt;&lt;br&gt;
&amp;nbsp;&amp;lt;dimension ref="A1"/&amp;gt;&lt;br&gt;
&amp;nbsp;&amp;lt;sheetViews&amp;gt;&lt;br&gt;
&amp;nbsp; &lt;span style="text-decoration: underline;"&gt;&amp;lt;sheetView tabSelected="1"&lt;strong&gt; topLeftCell="A64"&lt;/strong&gt; workbookViewId="0"&lt;strong&gt;&amp;gt;&lt;/strong&gt;&lt;/span&gt;&lt;br&gt;
&lt;span style="text-decoration: underline;"&gt;&lt;strong&gt;&amp;nbsp;&amp;nbsp; &amp;lt;selection activeCell="A86" sqref="A86"/&lt;/strong&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;
&amp;nbsp; &amp;lt;/sheetView&amp;gt;&lt;br&gt;
&amp;nbsp;&amp;lt;/sheetViews&amp;gt;&lt;br&gt;
&amp;nbsp;&amp;lt;sheetFormatPr defaultRowHeight="15"/&amp;gt;&lt;br&gt;
&amp;nbsp;&amp;lt;sheetData/&amp;gt;&lt;br&gt;
&amp;nbsp;&amp;lt;pageMargins left="0.7" right="0.7" top="0.75" bottom="0.75" header="0.3" footer="0.3"/&amp;gt;&lt;br&gt;
&amp;lt;/worksheet&amp;gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="lcreagh" When="28/01/2013 17:41:29">
          <Html>
        
&lt;p&gt;Thanks, xav2075.&amp;nbsp; Laura&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Headers for Excel worksheet using EPPlus">
      <Posts>
        <Post From="murali7" When="24/01/2013 14:34:37">
          <Html>
        
&lt;p&gt;I am using EPPLus to create and format an excel sheet from my data set. I want to set headers on the excel sheet using EPPlus. I could not find a way to do it. I want to set the left header, right header and center header. I have done this using VBA code,
 but I wan to move away from that. In VBA I would just do&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&lt;span&gt;With&lt;/span&gt;&lt;span&gt; ActiveSheet&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;PageSetup
&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;LeftHeader &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt; &lt;/span&gt;&lt;span class="str"&gt;""&lt;/span&gt;&lt;span&gt;
&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;RightHeader &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span class="str"&gt;""&lt;/span&gt;&lt;span&gt;
&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;CenterHeader&lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt; &lt;/span&gt;&lt;span class="str"&gt;""&lt;/span&gt;&lt;span&gt;
&lt;/span&gt;&lt;span&gt;End&lt;/span&gt;&lt;span&gt; &lt;/span&gt;&lt;span&gt;With&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Help!! Thanks&lt;/p&gt;
&lt;p&gt;PS: I am creating a winforms application. I was not sure if that would change anything but just wanted to mention it here. Thanks&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="xav2075" When="25/01/2013 00:59:52">
          <Html>
        
&lt;pre style="background: white; color: black; font-family: Consolas;"&gt;In visual studio after you type in a worksheet name followed by a dot symbol a pop up list should appear with a list of class members.  Scroll down and you will find 'Headerfooter'&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; excel_worksheet_2.HeaderFooter.FirstHeader.CenteredText&amp;nbsp;=&amp;nbsp;&lt;span style="color: rgb(163, 21, 21);"&gt;"FirstHeader.Centered&amp;nbsp;Text-&amp;nbsp;This&amp;nbsp;goes&amp;nbsp;top&amp;nbsp;of&amp;nbsp;(A4&amp;nbsp;portrait)&amp;nbsp;page&amp;nbsp;1&amp;nbsp;of&amp;nbsp;2&amp;nbsp;as&amp;nbsp;a&amp;nbsp;header&amp;nbsp;centrued"&lt;/span&gt;;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;excel_worksheet_2.HeaderFooter.FirstFooter.CenteredText&amp;nbsp;=&amp;nbsp;&lt;span style="color: rgb(163, 21, 21);"&gt;"FirstFooter.Centered&amp;nbsp;Text&amp;nbsp;-&amp;nbsp;This&amp;nbsp;goes&amp;nbsp;bottom&amp;nbsp;of&amp;nbsp;(A4&amp;nbsp;portrait)&amp;nbsp;page&amp;nbsp;1&amp;nbsp;of&amp;nbsp;2&amp;nbsp;as&amp;nbsp;a&amp;nbsp;footer&amp;nbsp;centrued"&lt;/span&gt;;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;excel_worksheet_2.HeaderFooter.EvenHeader.LeftAlignedText&amp;nbsp;=&amp;nbsp;&lt;span style="color: rgb(163, 21, 21);"&gt;"EvenHeader.Left&amp;nbsp;Aligned&amp;nbsp;-&amp;nbsp;This&amp;nbsp;goes&amp;nbsp;top&amp;nbsp;left&amp;nbsp;of&amp;nbsp;(A4&amp;nbsp;portrait)&amp;nbsp;page&amp;nbsp;2&amp;nbsp;at&amp;nbsp;the&amp;nbsp;top"&lt;/span&gt;;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;excel_worksheet_2.HeaderFooter.differentFirst&amp;nbsp;=&amp;nbsp;&lt;span style="color: white;"&gt;true&lt;/span&gt;;&amp;nbsp;&lt;span style="color: green;"&gt;//Gets/sets&amp;nbsp;the&amp;nbsp;flag&amp;nbsp;that&amp;nbsp;tells&amp;nbsp;Excel&amp;nbsp;to&amp;nbsp;display&amp;nbsp;different&amp;nbsp;headers&amp;nbsp;and&amp;nbsp;footers&amp;nbsp;on&amp;nbsp;the&amp;nbsp;first&amp;nbsp;page&amp;nbsp;of&amp;nbsp;the&amp;nbsp;worksheet.&lt;/span&gt;&lt;/pre&gt;
&lt;p&gt;My experience with Excel itself is not that extensive.&amp;nbsp; I am learning it now through epplus.&amp;nbsp; I suppose other people look for a lot of things they have done with Excel to do with epplus.&lt;/p&gt;
&lt;p&gt;From the epplus 3.1 help chm --&amp;gt; ExcelHeaderFooter&lt;/p&gt;
&lt;p&gt;The &lt;a href="9827c5c9-037b-49c5-4ce9-ec2b6cd6020f.htm" rel="nofollow"&gt;ExcelHeaderFooter&lt;/a&gt; type exposes the following members.&lt;/p&gt;
&lt;h1&gt;&lt;span&gt;&lt;img id="propertyTableToggle" alt="Collapse image"&gt;Properties&lt;/span&gt;&lt;/h1&gt;
&lt;div id="propertyTableSection"&gt;
&lt;table id="memberList" frame="lhs" cellpadding="2"&gt;
&lt;colgroup&gt;&lt;col width="10%"&gt;&lt;/colgroup&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;th&gt;&lt;br&gt;
&lt;/th&gt;
&lt;th&gt;Name&lt;/th&gt;
&lt;th&gt;Description&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;br&gt;
&lt;/td&gt;
&lt;td&gt;&lt;a href="1f29bb07-e221-19ba-50c4-5db7a95b14ec.htm" rel="nofollow"&gt;AlignWithMargins&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;
&lt;div&gt;Gets/sets the alignWithMargins attribute&lt;/div&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;br&gt;
&lt;/td&gt;
&lt;td&gt;&lt;a href="4fa9bf77-65f0-14db-2e31-e4f9377d0b07.htm" rel="nofollow"&gt;differentFirst&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;
&lt;div&gt;Gets/sets the flag that tells Excel to display &lt;span style="color: rgb(255, 255, 255); background-color: rgb(10, 36, 106);"&gt;
different&lt;/span&gt; headers and footers on the first page of the worksheet.&lt;/div&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;br&gt;
&lt;/td&gt;
&lt;td&gt;&lt;a href="b30dfafb-6960-d7f3-72e5-d7679d97fb8c.htm" rel="nofollow"&gt;differentOddEven&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;
&lt;div&gt;Gets/sets the flag that tells Excel to display &lt;span style="color: rgb(255, 255, 255); background-color: rgb(10, 36, 106);"&gt;
different&lt;/span&gt; headers and footers on odd and even pages.&lt;/div&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;br&gt;
&lt;/td&gt;
&lt;td&gt;&lt;a href="8128eea1-863c-a30a-ae0b-e040ba68c905.htm" rel="nofollow"&gt;EvenFooter&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;
&lt;div&gt;Provides access to the footer on even numbered pages of the document.&lt;/div&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;br&gt;
&lt;/td&gt;
&lt;td&gt;&lt;a href="bfd7897a-e440-c651-37be-7f5b0ac5bee8.htm" rel="nofollow"&gt;EvenHeader&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;
&lt;div&gt;Provides access to the header on even numbered pages of the document.&lt;/div&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;br&gt;
&lt;/td&gt;
&lt;td&gt;&lt;a href="c4003c6f-ae5a-7ac1-210d-b4ac566e704c.htm" rel="nofollow"&gt;FirstFooter&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;
&lt;div&gt;Provides access to the footer on the first page of the document.&lt;/div&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;br&gt;
&lt;/td&gt;
&lt;td&gt;&lt;a href="9ee65f2a-a23f-1d28-0ce4-f95d95a07f1d.htm" rel="nofollow"&gt;FirstHeader&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;
&lt;div&gt;Provides access to the header on the first page of the document.&lt;/div&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;br&gt;
&lt;/td&gt;
&lt;td&gt;&lt;a href="71e91c75-7df2-988b-ae43-6e5388c07424.htm" rel="nofollow"&gt;OddFooter&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;
&lt;div&gt;Provides access to the footer on odd numbered pages of the document. If you want the same footer on both odd and even pages, then only set values in this ExcelHeaderFooterText class.&lt;/div&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;br&gt;
&lt;/td&gt;
&lt;td&gt;&lt;a href="12ea0a68-8ea9-5e1f-d6db-0b3b65612b22.htm" rel="nofollow"&gt;OddHeader&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;
&lt;div&gt;Provides access to the header on odd numbered pages of the document. If you want the same header on both odd and even pages, then only set values in this ExcelHeaderFooterText class.&lt;/div&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;br&gt;
&lt;/td&gt;
&lt;td&gt;&lt;a href="5d1cb71f-5f61-a5ad-5401-02a964253904.htm" rel="nofollow"&gt;Pictures&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;
&lt;div&gt;Vml drawings. Underlaying object for Header footer images&lt;/div&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;h1&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;/h1&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Error under .NET 4.5">
      <Posts>
        <Post From="yfl8910" When="24/01/2013 13:54:44">
          <Html>
        
&lt;p&gt;when changged to&amp;nbsp;.NET 4.5，it can not work ,why?&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Adding a COUNTIF formula to a cell that counts text values causes spreadsheet not to work">
      <Posts>
        <Post From="JChristian11" When="21/01/2013 17:47:37">
          <Html>
        
&lt;p&gt;I have a simple table where one column is a name and the second column is a value. I want to count the number of rows on another sheet with the same name. When I attempt to set this formula, it appears to work but when I try to open the spreadsheet that
 is saved, it closes before I can see it. If I comment out the formula line, the code works fine. Has anyone encountered this issue before? &amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;string&lt;/span&gt; sName = Convert.ToChar(34) + sNames[i] + Convert.ToChar(34);                    
wSheet.Cells[4 + i, 2].Value = sNames[i];                   
wSheet.Cells[4 + i, 3].Formula = &lt;span style="color: blue;"&gt;string&lt;/span&gt;.Format(&lt;span style="color: rgb(163, 21, 21);"&gt;"COUNTIF('YTD Detail'!K:K|"&lt;/span&gt; + &lt;span style="font-size: 1em;"&gt;sName &lt;/span&gt; + &lt;span style="color: rgb(163, 21, 21);"&gt;")"&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="JChristian11" When="22/01/2013 14:23:05">
          <Html>
        
&lt;p&gt;The problem is the "pipe" symbol in the COUNTIF.&amp;nbsp;&lt;/p&gt;
&lt;pre&gt;&lt;span&gt;"COUNTIF('YTD Detail'!K:K&lt;span style="color: rgb(255, 0, 0);"&gt;&lt;strong&gt;|&lt;/strong&gt;&lt;/span&gt;"&lt;/span&gt; + &lt;span&gt;sName &lt;/span&gt; + &lt;span&gt;")"&lt;/span&gt;&lt;/pre&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Keep numeric format using Cells.LoadFromText method">
      <Posts>
        <Post From="gcb713" When="18/01/2013 12:12:41">
          <Html>
        
&lt;p&gt;Hi. I want to load a string that contains scientific number values (e.g. &amp;nbsp;2,80414e+000) into a sheet using:&lt;/p&gt;
&lt;p&gt;&lt;span style="white-space: pre;"&gt;&lt;/span&gt;&lt;strong style="font-size: 10pt;"&gt;sheet.Cells["A1"].LoadFromText(textString,TextFormat);&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;The rest of the data is loaded right but the scientific value format changes (e.g. 2,80) .&lt;/p&gt;
&lt;p&gt;I tried to set the format with&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;span style="white-space: pre;"&gt;&lt;/span&gt;&lt;strong&gt;sheet.Cells.Style.Numberformat.Format = "#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.0E+000";&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;but this data string has integer values that should not be converted.&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-size: 10pt;"&gt;Is there any way to load the data avoiding using a loop running over each cell setting the format&lt;/span&gt;&lt;span style="font-size: 10pt;"&gt;?&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-size: 10pt;"&gt;Thanks&lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="OpenOffice won't display graphs correctly!">
      <Posts>
        <Post From="MintyAnt" When="31/07/2012 16:58:05">
          <Html>
        
&lt;p&gt;Hello,&lt;/p&gt;
&lt;p&gt;I have begun to use EPPlus, and I definitley want to continue using it.&lt;/p&gt;
&lt;p&gt;However, whenever I attempt to create a graph, it will not display the actual graphic inside the graph, only in OpenOffice.&lt;/p&gt;
&lt;p&gt;Also, the position never works. It always shows up at the top left, and is in the way of everything.&lt;/p&gt;
&lt;p&gt;All other data is shown correctly. Any idea's why this is happening?&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;void&lt;/span&gt; GenerateAndAddPieChart(ExcelWorksheet inExcelWorksheet, &lt;span style="color: blue;"&gt;string&lt;/span&gt; inRange1, &lt;span style="color: blue;"&gt;string&lt;/span&gt; inRange2, &lt;span style="color: blue;"&gt;string&lt;/span&gt; inTitle, &lt;span style="color: blue;"&gt;int&lt;/span&gt; inPosRow, &lt;span style="color: blue;"&gt;int&lt;/span&gt; inPosCol)
        {
            ExcelPieChart pieChart = (ExcelPieChart)inExcelWorksheet.Drawings.AddChart(inTitle, eChartType.Pie);
            pieChart.SetSize(400, 400);
            pieChart.SetPosition(inPosRow, inPosCol);

            pieChart.Title.Text = inTitle;
            pieChart.DataLabel.ShowCategory = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
            pieChart.DataLabel.ShowPercent = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
            pieChart.Style = eChartStyle.Style1;

            pieChart.Series.Add(inExcelWorksheet.Cells[inRange1], inExcelWorksheet.Cells[inRange2]);
        }
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="anirudhkkw" When="18/01/2013 07:41:52">
          <Html>
        
&lt;p&gt;Hi MintyAnt,&lt;/p&gt;
&lt;p&gt;dunno abt the graphics not getting displayed properly but i can help you with the positioning of the graph.&lt;/p&gt;
&lt;p&gt;The problem if u have used the wrong function for setting position. Rather the wrong overload.&lt;/p&gt;
&lt;p&gt;try&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;pre&gt;pieChart.SetPosition(inPosRow,0, inPosCol,0);
&lt;/pre&gt;
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="anirudhkkw" When="18/01/2013 07:43:28">
          <Html>
        
&lt;blockquote style="margin: 0.25em 1em 0px; padding: 0px 0.25em; border: 0.1em solid rgb(204, 204, 204); border-image: none; font-style: italic;"&gt;
&lt;strong&gt;anirudhkkw wrote:&lt;/strong&gt;&lt;br&gt;
&lt;p&gt;Hi MintyAnt,&lt;/p&gt;
&lt;p&gt;dunno abt the graphics not getting displayed properly but i can help you with the positioning of the graph.&lt;/p&gt;
&lt;p&gt;The problem if u have used the wrong function for setting position. Rather the wrong overload.&lt;/p&gt;
&lt;p&gt;try&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;pre&gt;pieChart.SetPosition(inPosRow,0, inPosCol,0);
&lt;/pre&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;oh try&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;pre&gt;pieChart.Series.Add(inRange1, inRange2);&lt;/pre&gt;
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Custom echartstyle">
      <Posts>
        <Post From="anirudhkkw" When="18/01/2013 07:35:49">
          <Html>
        
&lt;p&gt;Hi, I would like to start by saying that this plugin is brilliant!!&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Now to my Question. Is there anyway to create custom echartstyles?? I would like to add my own colors to the chart.&lt;/p&gt;
&lt;p&gt;Thanks in advance :)&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Unable to open an EPPlus-created, protected workbook after Excel has opened it">
      <Posts>
        <Post From="HenryETaylor" When="18/11/2011 18:37:51">
          <Html>
        
&lt;p&gt;First and most importantly,... Thank You Jan!&amp;nbsp; EPPlus is amazing and I greatly appreciate your efforts creating and supporting it!&amp;nbsp; You have simplified a difficult task for me and before anything else, I wanted to say Thank you!&lt;/p&gt;
&lt;p&gt;I'm using EPPlus to allow some laptop users to edit a SQL database table without providing them with a direct connection to the database.&amp;nbsp; They identify a set of rows which they want to change and&amp;nbsp; through EPPlus, my software creates an excel workbook
 and emails it to them.&amp;nbsp; The workbook that is created is protected as are each of the worksheets it contains.&amp;nbsp; It is an xlsm file created using an unprotected xlsm file as a template which allows it to be macro enabled with data validations and interactive
 instruction displays throughout.&amp;nbsp; The users are only allowed to modify the values of a few columns and they do not have the ability to add or delete worksheets, columns or in most cases, rows.&amp;nbsp; On one worksheet, a macro-button is available to pop
 up a dialog box through which users can safely add new rows.&amp;nbsp; Over-all, the created spreadsheet provided these users with an easy and realtime-validated interface through which they can modify specific parts of rows they selected, all in a disconnected
 manner.&amp;nbsp; Finally, protected nature of the workbook and worksheets assures me that when the spreadsheet gets emailed back to my program, only its contents (and not its structure) will have changed.&amp;nbsp; That makes parsing out the user's changes and posting
 those changes to the SQL database table easy.&amp;nbsp; ...and none of it would be possible without EPPlus.&lt;/p&gt;
&lt;p&gt;So again... Thanks!&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;Now on to the reason for this forum entry...&lt;/p&gt;
&lt;p&gt;Given a workbook-protected EPPlus-created xlsm file which has previously been opened by Microsoft Office Excel 2007 without a password; has received modifications to unprotected cells and been subsequently saved to disk.&lt;br&gt;
The following code...&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(0, 0, 255);"&gt;FileInfo newFile = new FileInfo(strSourceFileWithPath);&lt;/span&gt;&lt;br&gt;
&lt;span style="color: rgb(0, 0, 255);"&gt;ExcelPackage package = null;&lt;/span&gt;&lt;br&gt;
&lt;span style="color: rgb(0, 0, 255);"&gt;try&lt;/span&gt;&lt;br&gt;
&lt;span style="color: rgb(0, 0, 255);"&gt;{&lt;/span&gt;&lt;br&gt;
&lt;span style="color: rgb(0, 0, 255);"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; package = new ExcelPackage(newFile);&lt;/span&gt;&lt;br&gt;
&lt;span style="color: rgb(0, 0, 255);"&gt;}&lt;/span&gt;&lt;br&gt;
&lt;span style="color: rgb(0, 0, 255);"&gt;catch(Exception ex1)&lt;/span&gt;&lt;br&gt;
&lt;span style="color: rgb(0, 0, 255);"&gt;{&lt;/span&gt;&lt;br&gt;
&lt;span style="color: rgb(0, 0, 255);"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; error_message += "Open Without Password Result [" + ex1.Message + "]\n";&lt;/span&gt;&lt;br&gt;
&lt;span style="color: rgb(0, 0, 255);"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; try&lt;/span&gt;&lt;br&gt;
&lt;span style="color: rgb(0, 0, 255);"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;/span&gt;&lt;br&gt;
&lt;span style="color: rgb(0, 0, 255);"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; package = new ExcelPackage(newFile, true, "Password");&lt;/span&gt;&lt;br&gt;
&lt;span style="color: rgb(0, 0, 255);"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;/span&gt;&lt;br&gt;
&lt;span style="color: rgb(0, 0, 255);"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; catch(Exception ex2)&lt;/span&gt;&lt;br&gt;
&lt;span style="color: rgb(0, 0, 255);"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;/span&gt;&lt;br&gt;
&lt;span style="color: rgb(0, 0, 255);"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; error_message += "Open With Password Result [" + ex2.Message + "]\n\n";&lt;/span&gt;&lt;br&gt;
&lt;span style="color: rgb(0, 0, 255);"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;/span&gt;&lt;br&gt;
&lt;span style="color: rgb(0, 0, 255);"&gt;}&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;...produces the following error_message contents...&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(128, 0, 0);"&gt;Open Without Password Result [Can not open the package. Package is an OLE compound document. If this is an encrypted package, please supply the password]&lt;/span&gt;&lt;br&gt;
&lt;span style="color: rgb(128, 0, 0);"&gt;Open With Password Result [Invalid password]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;...If I then open the file again with Microsoft Office Excel 2007 and use the Unprotect WorkBook button on the Review tab to remove the workbook protection, the code above will open the spreadsheet without firing off any exceptions.&lt;/p&gt;
&lt;p&gt;Any ideas what is causing this or what I can do avoid having to manually open each file in Excel and manually unprotect it?&lt;br&gt;
&lt;br&gt;
Thanks in advance for any assistance!&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="gordonp" When="12/12/2011 22:47:02">
          <Html>
        
&lt;p&gt;I would like to also find out what the resolution to this issue is. I will be using the component to generate scoring files from a template. Those scoring files are distributed to users, and then the users upload the files back into my system. At this point,
 I open the files and read in the data. These files have to be protected, workbook and worksheet(s) since there&amp;nbsp;are hidden columns with identifier information. We also do not want the users to sort the rows, or any other manipulation. So the files that
 get imported back into the system will be protected workbooks and worksheet(s).&lt;/p&gt;
&lt;p&gt;Can I open the file and read in data from those protected sheets? Currently we use excel automation, but we would like to get away from this since it requires an installation of Excel 2003 on the server.&lt;/p&gt;
&lt;p&gt;Thank You!&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="HenryETaylor" When="13/12/2011 12:53:55">
          <Html>
        
&lt;p&gt;Hi Gordonp,&lt;/p&gt;
&lt;p&gt;Sorry your also experiencing this difficulty.&lt;/p&gt;
&lt;p&gt;I never found a resolution for it, so every time one of my remote users mails me back a workbook, I have to open it in Excel (using the password that only I know) and turn off the protection. &amp;nbsp;I then save the workbook and move it to a directory where
 a filesystemwatcher detects its arrival and using epplus, processes it. &amp;nbsp;My current solution is all manual right now and like yourself I am hoping there will someday be a solution.&lt;/p&gt;
&lt;p&gt;It sounds like your excel automation solution may be superior to what I've done for the import portion of the project, but I still strongly recommend using EPPlus for the file generation portion of your project. &amp;nbsp;With the exception of this one unresolved
 issue, I am very happy with the library.&lt;/p&gt;
&lt;p&gt;Best of Luck with your project! &amp;nbsp;Drop me an email if you find a solution to our problem!&lt;/p&gt;
&lt;p&gt;- HenryETaylor&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="13/12/2011 13:15:36">
          <Html>
        
&lt;p&gt;I have a similar process and I never got this error. All my files are protected but doesnt have any macros.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="HenryETaylor" When="13/12/2011 15:05:22">
          <Html>
        
&lt;p&gt;Hi Mrxrsd,&lt;/p&gt;
&lt;p&gt;Are your users opening your epplus-created protected workbook in between when you create them and when you later attempt to open and read them?&lt;br&gt;
If so, what spreadsheet application are they using?&lt;/p&gt;
&lt;p&gt;When I just create the sheet (using a template with macros and an epplus-based program) and then import them with another epplus-based program, everything works.&lt;/p&gt;
&lt;p&gt;Only when Excel 2010 or Excel 2007 opens ﻿the workbook and then saves it back to disk does the import program have trouble.&lt;/p&gt;
&lt;p&gt;Also, are you protecting just the workbook, the individual spreadsheets within the workbook, or both?&amp;nbsp; I'm doing both.&lt;/p&gt;
&lt;p&gt;When I started this thread a couple months ago, I had plans to create an extremely simplified version of my creator and importer programs and publish the source here so that others could replicate my finding and maybe identify what I am doing wrong.&amp;nbsp;
 Unfortunately, the project got sidelined so I am handling what little traffic it is generating is being handled manually by yours truely.&amp;nbsp; I never got back here with the simplified source code.&amp;nbsp; I hope to pursue this again after the holidays.&lt;/p&gt;
&lt;p&gt;Thanks for your interest and let me know on the questions above.&lt;/p&gt;
&lt;p&gt;Happy Holidays,&lt;/p&gt;
&lt;p&gt;- HenryETaylor&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="14/12/2011 11:52:02">
          <Html>
        
&lt;p&gt;Yes, we are using Excel 2007/2010. I'm just protecting the individual sheets. Did you try to create your sheet without template-based?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="HenryETaylor" When="14/12/2011 12:53:22">
          <Html>
        
&lt;p&gt;No, in my case I couldn't... I needed the macros and an xlsm template is the only way to make that happen.&lt;/p&gt;
&lt;p&gt;What I haven't tried is not protecting the workbook. &amp;nbsp;I wanted to keep them from adding sheets but what would be the big deal if they did add sheets; it wouldn't affect them import process.&lt;/p&gt;
&lt;p&gt;Thanks for helping me think about this. &amp;nbsp;I'll give that a try and get back here with the results... and that simplified test code that I described earlier.&lt;/p&gt;
&lt;p&gt;Thanks again,&lt;/p&gt;
&lt;p&gt;- HenryETaylor&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="14/12/2011 13:06:23">
          <Html>
        
&lt;p&gt;I know, but if you try without macro and works, you will know where the problem is. Maybe you can remove them before open with epplus like Jan said here:&lt;/p&gt;
&lt;p&gt;&lt;a href="http://epplus.codeplex.com/discussions/282220" rel="nofollow"&gt;http://epplus.codeplex.com/discussions/282220&lt;/a&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="HenryETaylor" When="14/12/2011 13:15:59">
          <Html>
        
&lt;p&gt;Not a bad idea. &amp;nbsp; Something to try. &amp;nbsp;&lt;/p&gt;
&lt;p&gt;If removing the macros works then its not the locked workbook that's causing the grief.&lt;/p&gt;
&lt;p&gt;If removing the locked workbook as I was already planning to do, works then it would prove that to be the cause.&lt;/p&gt;
&lt;p&gt;If neither works alone then it is the combination of the two.&lt;/p&gt;
&lt;p&gt;I'll get back to you.&lt;/p&gt;
&lt;p&gt;Thanks Again&lt;/p&gt;
&lt;p&gt;- HenryETaylor&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="gordonp" When="14/12/2011 18:44:22">
          <Html>
        
&lt;p&gt;Thanks for your reply and information. Based on some of the other posts on this thread, I think I might try to get the import process to work. All I want to do is unlock the sheets so I can then use OLEDB to extract the data. If this does not work, then
 maybe I'll just try to extract the data with EPPlus. The only issue before I test is that I only have excel 2003 files that were created through automation. I could probably dummy one&amp;nbsp;up quickly, but that would not give me the example from end to end
 as you have described. (Creating with EPPlus, Opening in excel, adding data to the file in excel, saving, and then importing with EPPlus)&lt;/p&gt;
&lt;p&gt;Still, I'll let you know what happens. Also, I have thought about looking into the source code to see if I can figure out a way to add a method that will unlock sheets.&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="BashanAmit" When="16/01/2013 09:46:03">
          <Html>
        
&lt;p&gt;I have the same problem.&lt;/p&gt;
&lt;p&gt;the problem is connected to Internet Explorer uploaded to server (i dont have the problem under Chrome or Firefox).&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Disable row subtotals on Pivot Table">
      <Posts>
        <Post From="traigo" When="03/01/2013 21:03:10">
          <Html>
        
&lt;p&gt;I'm trying to disable row subtotals on a Pivot Table. &amp;nbsp;I turned them off in Excel and saved the worksheet to see what it was doing. &amp;nbsp;It added defaultSubtotal="0" to the pivotField element.&lt;/p&gt;
&lt;pre&gt;&amp;lt;pivotField axis="axisRow" showAll="0" defaultSubtotal="0"&amp;gt;&lt;/pre&gt;
&lt;p&gt;I found this in&amp;nbsp;ExcelPivotTableField so I set the SubTotalFunctions to none.&lt;/p&gt;
&lt;pre&gt;rowField.SubTotalFunctions = eSubTotalFunctions.None;&lt;/pre&gt;
&lt;pre&gt;pivot.RowFields.Add(rowField);&lt;/pre&gt;
&lt;pre&gt;colField.SubTotalFunctions = eSubTotalFunctions.None;&lt;/pre&gt;
&lt;pre&gt;pivot.ColumnFields.Add(colField);&lt;/pre&gt;
&lt;p&gt;When I add this, Excel says there's invalid XML and fixes it, but the totals are still there. Any help please?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="xav2075" When="04/01/2013 05:59:44">
          <Html>
        
&lt;p&gt;Code novice checking in!&lt;/p&gt;
&lt;p&gt;Can you post as much code as possible so I could paste it into Visual Studio and have a look at it.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="traigo" When="04/01/2013 21:34:22">
          <Html>
        
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;static&lt;/span&gt; ExcelPackage ExportDataSetAsExcelPivot(&lt;span style="color: blue;"&gt;this&lt;/span&gt; SqlDataReader rs, &lt;span style="color: blue;"&gt;string&lt;/span&gt; sheetName, &lt;span style="color: blue;"&gt;string&lt;/span&gt; title, Portlet portlet)
        {
            List&amp;lt;PortletColumn&amp;gt; columns = portlet.cols;
            List&amp;lt;PortletAxis&amp;gt; axes = portlet.axes;
            List&amp;lt;PortletAggregate&amp;gt; aggregates = portlet.aggregates;

            &lt;span style="color: blue;"&gt;string&lt;/span&gt; curFormat = &lt;span style="color: rgb(163, 21, 21);"&gt;"#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;"&lt;/span&gt;;
            &lt;span style="color: blue;"&gt;if&lt;/span&gt; (portlet.curScale &amp;gt; 0)
                curFormat += &lt;span style="color: rgb(163, 21, 21);"&gt;"."&lt;/span&gt; + &lt;span style="color: blue;"&gt;new&lt;/span&gt; String(&lt;span style="color: rgb(163, 21, 21);"&gt;'0'&lt;/span&gt;, portlet.curScale);
            &lt;span style="color: blue;"&gt;if&lt;/span&gt; (portlet.curSymbol.Length &amp;gt; 1)
                curFormat += &lt;span style="color: rgb(163, 21, 21);"&gt;" "&lt;/span&gt; + portlet.curSymbol;
            &lt;span style="color: blue;"&gt;else&lt;/span&gt;
                curFormat = portlet.curSymbol + curFormat;


            ExcelPackage pck = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage();
            &lt;span style="color: green;"&gt;//Order of Add() determines order in workbook&lt;/span&gt;
            ExcelWorksheet wsPivot = pck.Workbook.Worksheets.Add(sheetName); 
            ExcelWorksheet wsData = pck.Workbook.Worksheets.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"data"&lt;/span&gt;);

            DataTable dt = &lt;span style="color: blue;"&gt;new&lt;/span&gt; DataTable();
            dt.Load(rs);

            &lt;span style="color: blue;"&gt;int&lt;/span&gt; i = 1;
            &lt;span style="color: blue;"&gt;int&lt;/span&gt; record = 1;
            &lt;span style="color: blue;"&gt;foreach&lt;/span&gt; (PortletColumn column &lt;span style="color: blue;"&gt;in&lt;/span&gt; columns)
            {
                wsData.Column(i).Style.Numberformat.Format = column.GetFormatter(curFormat);
                &lt;span style="color: blue;"&gt;try&lt;/span&gt;
                {
                    dt.Columns[column.name].ColumnName = column.GetHeader();
                }
                &lt;span style="color: blue;"&gt;catch&lt;/span&gt; (DuplicateNameException) { }

                i++;
            }
            record++;

            List&amp;lt;PortletAxis&amp;gt; leftAxes = axes.Where(a =&amp;gt; a.axisPosition.ToLower() == PortletAxis.Positions.LEFT).ToList();
            &lt;span style="color: blue;"&gt;int&lt;/span&gt; leftAxesCount = leftAxes.Count();
            List&amp;lt;PortletAxis&amp;gt; topAxes = axes.Where(a =&amp;gt; a.axisPosition.ToLower() == PortletAxis.Positions.TOP).ToList();
            &lt;span style="color: blue;"&gt;int&lt;/span&gt; topAxesCount = topAxes.Count();


            wsData.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;].LoadFromDataTable(dt, &lt;span style="color: blue;"&gt;true&lt;/span&gt;, TableStyles.None);

            ExcelRange dataRange = wsData.Cells[wsData.Dimension.Address.ToString()];
            dataRange.AutoFitColumns();


            &lt;span style="color: green;"&gt;//The title in the first cell.  It's a pivot so we don't know what the total columns will be (and they channge as you use the pivot)&lt;/span&gt;
            wsPivot.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;].Value = title;
            wsPivot.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;].Style.Font.Bold = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
            wsPivot.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;].Style.Font.Size = 14;

            ExcelPivotTable pivot = wsPivot.PivotTables.Add(wsPivot.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A4"&lt;/span&gt;], dataRange, title);
            pivot.MultipleFieldFilters = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
            pivot.RowGrandTotals = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
            pivot.ColumGrandTotals = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
            pivot.Compact = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
            pivot.CompactData = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
            pivot.GridDropZones = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
            pivot.Outline = &lt;span style="color: blue;"&gt;false&lt;/span&gt;;
            pivot.OutlineData = &lt;span style="color: blue;"&gt;false&lt;/span&gt;;
            pivot.ShowError = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
            pivot.ErrorCaption = &lt;span style="color: rgb(163, 21, 21);"&gt;"[error]"&lt;/span&gt;;
            pivot.ShowHeaders = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
            pivot.UseAutoFormatting = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
            pivot.ApplyWidthHeightFormats = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
            pivot.ShowDrill = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
            pivot.FirstDataCol = leftAxesCount + 1;
            pivot.TableStyle = TableStyles.Medium2;
            pivot.RowHeaderCaption = portlet.pivotAxisTitle;


            &lt;span style="color: blue;"&gt;foreach&lt;/span&gt; (PortletAxis axis &lt;span style="color: blue;"&gt;in&lt;/span&gt; leftAxes)
            {
                ExcelPivotTableField rowField = pivot.Fields[axis.dataIndex];
                &lt;span style="color: blue;"&gt;if&lt;/span&gt; (rowField == &lt;span style="color: blue;"&gt;null&lt;/span&gt;)
                {
                    &lt;span style="color: blue;"&gt;string&lt;/span&gt; dataIndex = columns.Single(c =&amp;gt; c.name == axis.dataIndex).GetHeader();
                    rowField = pivot.Fields[dataIndex];
                }
                &lt;span style="color: green;"&gt;//rowField.SubTotalFunctions = eSubTotalFunctions.None;&lt;/span&gt;
                pivot.RowFields.Add(rowField);
            }

            &lt;span style="color: blue;"&gt;foreach&lt;/span&gt; (PortletAxis axis &lt;span style="color: blue;"&gt;in&lt;/span&gt; topAxes)
            {
                ExcelPivotTableField colField = pivot.Fields[axis.dataIndex];
                &lt;span style="color: blue;"&gt;if&lt;/span&gt; (colField == &lt;span style="color: blue;"&gt;null&lt;/span&gt;)
                {
                    &lt;span style="color: blue;"&gt;string&lt;/span&gt; dataIndex = columns.Single(c =&amp;gt; c.name == axis.dataIndex).GetHeader();
                    colField = pivot.Fields[dataIndex];
                }
                pivot.ColumnFields.Add(colField);
            }

            &lt;span style="color: blue;"&gt;foreach&lt;/span&gt; (PortletAggregate agg &lt;span style="color: blue;"&gt;in&lt;/span&gt; aggregates)
            {
                ExcelPivotTableField aggField = pivot.Fields[agg.dataIndex];
                PortletColumn col = columns.Single(c =&amp;gt; c.name == agg.dataIndex);
                &lt;span style="color: blue;"&gt;if&lt;/span&gt; (aggField == &lt;span style="color: blue;"&gt;null&lt;/span&gt;)
                {
                    aggField = pivot.Fields[col.GetHeader()];
                }
                ExcelPivotTableDataField dataField = pivot.DataFields.Add(aggField);
                dataField.Format = col.GetFormatter(curFormat);
                &lt;span style="color: blue;"&gt;switch&lt;/span&gt; (agg.summaryType.ToLower())
                {
                    &lt;span style="color: blue;"&gt;case&lt;/span&gt; PortletAggregate.SummaryTypes.COUNT:
                        dataField.Function = DataFieldFunctions.Count;
                        &lt;span style="color: blue;"&gt;break&lt;/span&gt;;
                    &lt;span style="color: blue;"&gt;case&lt;/span&gt; PortletAggregate.SummaryTypes.SUM:
                        dataField.Function = DataFieldFunctions.Sum;
                        &lt;span style="color: blue;"&gt;break&lt;/span&gt;;
                    &lt;span style="color: blue;"&gt;case&lt;/span&gt; PortletAggregate.SummaryTypes.MAX:
                        dataField.Function = DataFieldFunctions.Max;
                        &lt;span style="color: blue;"&gt;break&lt;/span&gt;;
                    &lt;span style="color: blue;"&gt;case&lt;/span&gt; PortletAggregate.SummaryTypes.MIN:
                        dataField.Function = DataFieldFunctions.Min;
                        &lt;span style="color: blue;"&gt;break&lt;/span&gt;;
                    &lt;span style="color: blue;"&gt;case&lt;/span&gt; PortletAggregate.SummaryTypes.AVERAGE:
                        dataField.Function = DataFieldFunctions.Average;
                        &lt;span style="color: blue;"&gt;break&lt;/span&gt;;
                    &lt;span style="color: blue;"&gt;default&lt;/span&gt;:
                        dataField.Function = DataFieldFunctions.None;
                        &lt;span style="color: blue;"&gt;break&lt;/span&gt;;
                }
            }

            &lt;span style="color: blue;"&gt;return&lt;/span&gt; pck;
        }

&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="xav2075" When="05/01/2013 06:25:49">
          <Html>
        
&lt;p&gt;At first glance without checking all the code you posted I noticed that you specified a TableStyles.None parameter with the .LoadFromDataTable method.&amp;nbsp; This randomly can cause a corrupted xlsx spreadsheet.&amp;nbsp; Have a Look at this thread and my last
 post at the bottom:&amp;nbsp; http://epplus.codeplex.com/discussions/349770.&amp;nbsp; So firstly try .LoadFromDataTable with no TableStyles.x parameter at all.&lt;/p&gt;
&lt;p&gt;I don't think I can try the code you posted as it does not include stuff like a class definition for portlet and what is loaded to datatable dt from rs.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="traigo" When="07/01/2013 23:19:57">
          <Html>
        
&lt;p&gt;I tried your suggestion. &amp;nbsp;It didn't work:&amp;nbsp;Excel completed file level validation and repair. Some parts of this workbook may have been repaired or discarded.Repaired Records: PivotTable report from /xl/pivotTables/pivotTable1.xml part (PivotTable
 view)&lt;/p&gt;
&lt;p&gt;The data loaded is dynamic. &amp;nbsp;The&amp;nbsp;definitions&amp;nbsp;for the pivot tables are stored in a database, then loaded into these classes. &amp;nbsp;Sorry for the delay. &amp;nbsp;Even though I have the email me replies checked down there, I don't get them.&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;    &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;class&lt;/span&gt; Portlet
    {
        [DataMember]
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; url { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }
        [DataMember]
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; title { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }
        [DataMember]
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;int&lt;/span&gt; portletId { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }
        [DataMember]
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;int&lt;/span&gt; userPortletId { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }
        [DataMember]
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; type { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }
        [DataMember]
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;bool&lt;/span&gt; fill { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }
        [DataMember]
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;bool&lt;/span&gt; alive { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }
        [DataMember]
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; groupField { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }
        [DataMember]
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; curSymbol { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }
        [DataMember]
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;int&lt;/span&gt; curScale { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }
        [DataMember]
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; List&amp;lt;PortletColumn&amp;gt; cols { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }
        [DataMember]
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; pivotAxisTitle { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }
        [DataMember]
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; List&amp;lt;PortletAxis&amp;gt; axes { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }
        [DataMember]
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; List&amp;lt;PortletAggregate&amp;gt; aggregates { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }

        &lt;span style="color: blue;"&gt;public&lt;/span&gt; List&amp;lt;PortletParameter&amp;gt; parameters { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }

        &lt;span style="color: blue;"&gt;public&lt;/span&gt; Portlet()
        {
            &lt;span style="color: blue;"&gt;this&lt;/span&gt;.cols = &lt;span style="color: blue;"&gt;new&lt;/span&gt; List&amp;lt;PortletColumn&amp;gt;();
            &lt;span style="color: blue;"&gt;this&lt;/span&gt;.axes = &lt;span style="color: blue;"&gt;new&lt;/span&gt; List&amp;lt;PortletAxis&amp;gt;();
            &lt;span style="color: blue;"&gt;this&lt;/span&gt;.aggregates = &lt;span style="color: blue;"&gt;new&lt;/span&gt; List&amp;lt;PortletAggregate&amp;gt;();
        }

    }
&lt;/pre&gt;
&lt;/div&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;   &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;class&lt;/span&gt; PortletColumn
    {
        [DataMember]
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; name { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }
        [DataMember]
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; renderer { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }
        [DataMember]
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; type { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }
        [DataMember]
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; summaryType { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }
        [DataMember]
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; text { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }
        [DataMember]
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;bool&lt;/span&gt; hidden { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }

        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;class&lt;/span&gt; DataTypes
        {
            &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;const&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; STRING = &lt;span style="color: rgb(163, 21, 21);"&gt;"string"&lt;/span&gt;;
            &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;const&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; NUMBER = &lt;span style="color: rgb(163, 21, 21);"&gt;"number"&lt;/span&gt;;
            &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;const&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; INTEGER = &lt;span style="color: rgb(163, 21, 21);"&gt;"int"&lt;/span&gt;;
            &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;const&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; CURRENCY = &lt;span style="color: rgb(163, 21, 21);"&gt;"currency"&lt;/span&gt;;
        }

        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;class&lt;/span&gt; SummaryTypes
        {
            &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;const&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; COUNT = &lt;span style="color: rgb(163, 21, 21);"&gt;"count"&lt;/span&gt;;
            &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;const&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; SUM = &lt;span style="color: rgb(163, 21, 21);"&gt;"sum"&lt;/span&gt;;
            &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;const&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; MAX = &lt;span style="color: rgb(163, 21, 21);"&gt;"max"&lt;/span&gt;;
            &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;const&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; MIN = &lt;span style="color: rgb(163, 21, 21);"&gt;"min"&lt;/span&gt;;
            &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;const&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; AVERAGE = &lt;span style="color: rgb(163, 21, 21);"&gt;"average"&lt;/span&gt;;
            &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;const&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; DISTINCT_COUNT = &lt;span style="color: rgb(163, 21, 21);"&gt;"distinct"&lt;/span&gt;;
        }

        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; GetHeader()
        {
            &lt;span style="color: blue;"&gt;return&lt;/span&gt; &lt;span style="color: blue;"&gt;this&lt;/span&gt;.text.IsEmpty() ? &lt;span style="color: blue;"&gt;this&lt;/span&gt;.name : &lt;span style="color: blue;"&gt;this&lt;/span&gt;.text;
        }

        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; GetFormatter(&lt;span style="color: blue;"&gt;string&lt;/span&gt; curFormat)
        {
            &lt;span style="color: blue;"&gt;switch&lt;/span&gt; (&lt;span style="color: blue;"&gt;this&lt;/span&gt;.type.ToLower())
            {
                &lt;span style="color: blue;"&gt;case&lt;/span&gt; PortletColumn.DataTypes.INTEGER:
                    &lt;span style="color: blue;"&gt;return&lt;/span&gt; &lt;span style="color: rgb(163, 21, 21);"&gt;"#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;"&lt;/span&gt;;
                &lt;span style="color: blue;"&gt;case&lt;/span&gt; PortletColumn.DataTypes.NUMBER:
                    &lt;span style="color: blue;"&gt;return&lt;/span&gt; &lt;span style="color: rgb(163, 21, 21);"&gt;"#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.0"&lt;/span&gt;;
                &lt;span style="color: blue;"&gt;case&lt;/span&gt; PortletColumn.DataTypes.CURRENCY:
                    &lt;span style="color: blue;"&gt;return&lt;/span&gt; curFormat;
            }
            &lt;span style="color: blue;"&gt;return&lt;/span&gt; &lt;span style="color: rgb(163, 21, 21);"&gt;""&lt;/span&gt;;
        }
    }
&lt;/pre&gt;
&lt;/div&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;    &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;class&lt;/span&gt; PortletAxis
    {
        [DataMember]
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; axisPosition { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }
        [DataMember]
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; dataIndex { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }
        [DataMember]
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; title { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }

        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;class&lt;/span&gt; Positions
        {
            &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;const&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; LEFT = &lt;span style="color: rgb(163, 21, 21);"&gt;"left"&lt;/span&gt;;
            &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;const&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; TOP = &lt;span style="color: rgb(163, 21, 21);"&gt;"top"&lt;/span&gt;;
        }
    }
&lt;/pre&gt;
&lt;/div&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;    &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;class&lt;/span&gt; PortletAggregate
    {
        [DataMember]
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; dataIndex { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }
        [DataMember]
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; title { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }
        [DataMember]
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; summaryType { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }
        [DataMember]
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; renderer { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }

        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;class&lt;/span&gt; SummaryTypes
        {
            &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;const&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; COUNT = &lt;span style="color: rgb(163, 21, 21);"&gt;"count"&lt;/span&gt;;
            &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;const&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; SUM = &lt;span style="color: rgb(163, 21, 21);"&gt;"sum"&lt;/span&gt;;
            &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;const&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; MAX = &lt;span style="color: rgb(163, 21, 21);"&gt;"max"&lt;/span&gt;;
            &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;const&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; MIN = &lt;span style="color: rgb(163, 21, 21);"&gt;"min"&lt;/span&gt;;
            &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;const&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; AVERAGE = &lt;span style="color: rgb(163, 21, 21);"&gt;"average"&lt;/span&gt;;
        }
    }
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="bhanu1423" When="11/01/2013 11:04:16">
          <Html>
        
&lt;p&gt;subtotal hiding is possible in new version of epplus dll.. i tried it.. and i succeded.. :)&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="traigo" When="11/01/2013 15:00:37">
          <Html>
        
&lt;p&gt;can you post some code?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="xav2075" When="11/01/2013 15:29:20">
          <Html>
        
&lt;p&gt;I pasted all the code you posted into Visual Studio.&amp;nbsp; It has flagged a missing class definition for PortletParameter.&amp;nbsp; Also I need to know what raw data you are using which I presume you are passing to the function:&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;pre&gt;public static ExcelPackage ExportDataSetAsExcelPivot(this SqlDataReader rs, string sheetName, string title, Portlet portlet)&lt;/pre&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;When I can start flogging the debugger I will try to find a fix that disables row subtotals on a pivot table.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="traigo" When="11/01/2013 16:17:48">
          <Html>
        
&lt;p&gt;PortletParameter isn't used in this case, you can delete that property from the Portlet class.&lt;/p&gt;
&lt;p&gt;Here's raw from one of my tests (it's in JSON)&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;{
    &lt;span style="color: rgb(163, 21, 21);"&gt;"userPortletId"&lt;/span&gt;: 6,
    &lt;span style="color: rgb(163, 21, 21);"&gt;"url"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;""&lt;/span&gt;,
    &lt;span style="color: rgb(163, 21, 21);"&gt;"portletId"&lt;/span&gt;: 55017,
    &lt;span style="color: rgb(163, 21, 21);"&gt;"alive"&lt;/span&gt;: &lt;span style="color: blue;"&gt;true&lt;/span&gt;,
    &lt;span style="color: rgb(163, 21, 21);"&gt;"fill"&lt;/span&gt;: &lt;span style="color: blue;"&gt;false&lt;/span&gt;,
    &lt;span style="color: rgb(163, 21, 21);"&gt;"groupField"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;""&lt;/span&gt;,
    &lt;span style="color: rgb(163, 21, 21);"&gt;"curSymbol"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"$"&lt;/span&gt;,
    &lt;span style="color: rgb(163, 21, 21);"&gt;"curScale"&lt;/span&gt;: 2,
    &lt;span style="color: rgb(163, 21, 21);"&gt;"pivotAxisTitle"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"Table"&lt;/span&gt;,
    &lt;span style="color: rgb(163, 21, 21);"&gt;"title"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"Price Table Analysis"&lt;/span&gt;,
    &lt;span style="color: rgb(163, 21, 21);"&gt;"name"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"Price Table Analysis"&lt;/span&gt;,
    &lt;span style="color: rgb(163, 21, 21);"&gt;"type"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"pivotGrid"&lt;/span&gt;,
    &lt;span style="color: rgb(163, 21, 21);"&gt;"cols"&lt;/span&gt;: [
        {
            &lt;span style="color: rgb(163, 21, 21);"&gt;"hidden"&lt;/span&gt;: &lt;span style="color: blue;"&gt;false&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"name"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"mly"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"renderer"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;""&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"summaryType"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;""&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"text"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"Layer"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"type"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"string"&lt;/span&gt;
        },
        {
            &lt;span style="color: rgb(163, 21, 21);"&gt;"hidden"&lt;/span&gt;: &lt;span style="color: blue;"&gt;false&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"name"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"mrg"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"renderer"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;""&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"summaryType"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;""&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"text"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"Group"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"type"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"string"&lt;/span&gt;
        },
        {
            &lt;span style="color: rgb(163, 21, 21);"&gt;"hidden"&lt;/span&gt;: &lt;span style="color: blue;"&gt;false&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"name"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"mrw"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"renderer"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;""&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"summaryType"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;""&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"text"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"Discount"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"type"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"string"&lt;/span&gt;
        },
        {
            &lt;span style="color: rgb(163, 21, 21);"&gt;"hidden"&lt;/span&gt;: &lt;span style="color: blue;"&gt;false&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"name"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"mcl"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"renderer"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;""&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"summaryType"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;""&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"text"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"Column"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"type"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"string"&lt;/span&gt;
        },
        {
            &lt;span style="color: rgb(163, 21, 21);"&gt;"hidden"&lt;/span&gt;: &lt;span style="color: blue;"&gt;false&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"name"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"amt"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"renderer"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;""&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"summaryType"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;""&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"text"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"Price"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"type"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"number"&lt;/span&gt;
        }
    ],
    &lt;span style="color: rgb(163, 21, 21);"&gt;"axes"&lt;/span&gt;: [
        {
            &lt;span style="color: rgb(163, 21, 21);"&gt;"axisPosition"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"left"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"dataIndex"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"mly"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"title"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"Layer"&lt;/span&gt;
        },
        {
            &lt;span style="color: rgb(163, 21, 21);"&gt;"axisPosition"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"left"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"dataIndex"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"mrg"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"title"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"Group"&lt;/span&gt;
        },
        {
            &lt;span style="color: rgb(163, 21, 21);"&gt;"axisPosition"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"left"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"dataIndex"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"mrw"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"title"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"Discount"&lt;/span&gt;
        },
        {
            &lt;span style="color: rgb(163, 21, 21);"&gt;"axisPosition"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"top"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"dataIndex"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"mcl"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"title"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"Column"&lt;/span&gt;
        }
    ],
    &lt;span style="color: rgb(163, 21, 21);"&gt;"aggregates"&lt;/span&gt;: [
        {
            &lt;span style="color: rgb(163, 21, 21);"&gt;"dataIndex"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"amt"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"renderer"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"PriceTableAmount"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"summaryType"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;""&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"title"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"Price"&lt;/span&gt;
        }
    ],
    &lt;span style="color: rgb(163, 21, 21);"&gt;"data"&lt;/span&gt;: [
        {
            &lt;span style="color: rgb(163, 21, 21);"&gt;"mly"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"Base Prices"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"mrg"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"Early Bird"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"mrw"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"(EMP) Employee"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"mcl"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"A"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"amt"&lt;/span&gt;: 25
        },
        {
            &lt;span style="color: rgb(163, 21, 21);"&gt;"mly"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"Base Prices"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"mrg"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"Early Bird"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"mrw"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"(STU) Student"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"mcl"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"A"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"amt"&lt;/span&gt;: 20
        },
        {
            &lt;span style="color: rgb(163, 21, 21);"&gt;"mly"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"Base Prices"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"mrg"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"Standard Rates"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"mrw"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"(ADU) Adult"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"mcl"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"A"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"amt"&lt;/span&gt;: 30
        },
        {
            &lt;span style="color: rgb(163, 21, 21);"&gt;"mly"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"Base Prices"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"mrg"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"Standard Rates"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"mrw"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"(CHI) Child"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"mcl"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"A"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"amt"&lt;/span&gt;: 25
        },
        {
            &lt;span style="color: rgb(163, 21, 21);"&gt;"mly"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"Base Prices"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"mrg"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"Standard Rates"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"mrw"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"(COM) Complimentary"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"mcl"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"A"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"amt"&lt;/span&gt;: 0
        },
        {
            &lt;span style="color: rgb(163, 21, 21);"&gt;"mly"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"Base Prices"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"mrg"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"Early Bird"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"mrw"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"(EMP) Employee"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"mcl"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"B"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"amt"&lt;/span&gt;: 30
        },
        {
            &lt;span style="color: rgb(163, 21, 21);"&gt;"mly"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"Base Prices"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"mrg"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"Early Bird"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"mrw"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"(STU) Student"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"mcl"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"B"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"amt"&lt;/span&gt;: 25
        },
        {
            &lt;span style="color: rgb(163, 21, 21);"&gt;"mly"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"Base Prices"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"mrg"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"Standard Rates"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"mrw"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"(ADU) Adult"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"mcl"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"B"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"amt"&lt;/span&gt;: 35
        },
        {
            &lt;span style="color: rgb(163, 21, 21);"&gt;"mly"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"Base Prices"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"mrg"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"Standard Rates"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"mrw"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"(CHI) Child"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"mcl"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"B"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"amt"&lt;/span&gt;: 30
        },
        {
            &lt;span style="color: rgb(163, 21, 21);"&gt;"mly"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"Base Prices"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"mrg"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"Standard Rates"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"mrw"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"(COM) Complimentary"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"mcl"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"B"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"amt"&lt;/span&gt;: 0
        },
        {
            &lt;span style="color: rgb(163, 21, 21);"&gt;"mly"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"Booking Fee"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"mrg"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"Standard Rates"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"mrw"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"(ADU) Adult"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"mcl"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"A"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"amt"&lt;/span&gt;: 5
        },
        {
            &lt;span style="color: rgb(163, 21, 21);"&gt;"mly"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"Booking Fee"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"mrg"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"Standard Rates"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"mrw"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"(CHI) Child"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"mcl"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"A"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"amt"&lt;/span&gt;: 2.5
        },
        {
            &lt;span style="color: rgb(163, 21, 21);"&gt;"mly"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"Booking Fee"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"mrg"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"Standard Rates"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"mrw"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"(ADU) Adult"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"mcl"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"B"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"amt"&lt;/span&gt;: 5
        },
        {
            &lt;span style="color: rgb(163, 21, 21);"&gt;"mly"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"Booking Fee"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"mrg"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"Standard Rates"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"mrw"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"(CHI) Child"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"mcl"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"B"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"amt"&lt;/span&gt;: 2.5
        }
    ]
}
&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="xav2075" When="12/01/2013 11:44:26">
          <Html>
        
&lt;p&gt;The Portlet class seems to be missing a variable definition for as the JSON you pasted contains:&amp;nbsp;&lt;/p&gt;
&lt;pre&gt; &lt;span style="color: rgb(163, 21, 21);"&gt;"name"&lt;/span&gt;: &lt;span style="color: rgb(163, 21, 21);"&gt;"Price Table Analysis"&lt;/span&gt;,&lt;br&gt;&lt;br&gt;I am new to JSON and was not able to 'JavaScriptSerializer'-&amp;gt; 'Deserialize' the JSON you posted from a text file with an additional name &lt;br&gt;variable  in the Portlet class as above.  And also I  re-ordered the Portlet class variables to follow the JSON you posted.  &lt;br&gt;&amp;nbsp;If you could mail me a working visual studio solution set of files I could try that.  Otherwise I cant assist further.&lt;/pre&gt;

        
    </Html>
        </Post>
        <Post From="xav2075" When="15/01/2013 20:07:26">
          <Html>
        
&lt;p&gt;The best I could do is a partial fix which can produce a xlsx spreadsheet that has a pivot table with no subtotals that is constrained to your pre defined data structure but can accept new values:-&lt;/p&gt;
&lt;p&gt;1.&amp;nbsp; Run your original code that does not have &lt;strong&gt;rowField.SubTotalFunctions = eSubTotalFunctions.None;
&lt;/strong&gt;which produces a spreadsheet that has subtotals.&lt;/p&gt;
&lt;p&gt;2.&amp;nbsp; Manually edit the spreadsheet in Excel to remove subtotals.&amp;nbsp; Delete the 'data' worksheet.&amp;nbsp; As the Pivot table does not automatically refresh it retains its structure&amp;nbsp; and old data from the 'data' worksheet that is now deleted as a
 placeholder. Save this spreadsheet as &lt;strong&gt;pivot_table_no_subtotals_template.xlsx&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;3.&amp;nbsp; I commented out all of your code that creates the pivot table worksheet and the code that creates and defines
&lt;strong&gt;ExcelPivotTable pivot = wsPivot.PivotTables.Add(wsPivot.Cells["A4"], dataRange, title);
&lt;/strong&gt;I added code that loads &lt;br&gt;
&lt;strong&gt;pivot_table_no_subtotals_template.xlsx &lt;/strong&gt;as a template file.&amp;nbsp; So the ExcelPackage pck when created has the pre-defined 'Pivot' worksheet with the pivot table that has no subtotals injected into it.&amp;nbsp; Your code that defines the structure
 and values of the data is retained.&amp;nbsp; I changed the values of the data to demonstrate that the pivot table which references the 'data' worksheet will update correctly when the new final spreadsheet is opened in Excel.&lt;strong&gt;&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Using the Microsoft Office Open XML SDK 2.5 Productivity Tool I compared the spreadsheet that has pivot table subtotals to another spreadsheet that I manually removed the subtotals in Excel.&amp;nbsp; The no subtotals xlsx xml package had changes in almost every
 xml file and was 26kb in total size (unzipped) compared to 12kb total size (unziped) of the xlsx xml package that has subtotals.&lt;/p&gt;
&lt;p&gt;And this Microsoft tool did not detect errors from a spreadsheet generated using your original code with
&lt;strong&gt;rowField.SubTotalFunctions = eSubTotalFunctions.None; &lt;/strong&gt;included \ un-commented when using the 'Validate' button.&lt;strong&gt;&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;OpenOffice 3.0 Calc and LibreOffice 3.6 Calc actually can open the xlsx spreadsheet that has
&lt;br&gt;
&lt;strong&gt;rowField.SubTotalFunctions = eSubTotalFunctions.None; &lt;/strong&gt;included in your code.&amp;nbsp; But almost all the custom formatting\styles are not translated.&amp;nbsp; Even though the Pivot table with no sub totals is.&amp;nbsp; Excel 2007 and online Excel through
 SkyDrive report it as corrupted \ cant open the spreadsheet.&lt;strong&gt;&lt;br&gt;
&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;The modified code that uses a temaplate xlsx file generated from your old code:-&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;using&lt;/span&gt; System;
&lt;span style="color: blue;"&gt;using&lt;/span&gt; System.Collections.Generic;
&lt;span style="color: blue;"&gt;using&lt;/span&gt; System.IO;
&lt;span style="color: blue;"&gt;using&lt;/span&gt; System.Linq;
&lt;span style="color: blue;"&gt;using&lt;/span&gt; System.Text;
&lt;span style="color: blue;"&gt;using&lt;/span&gt; System.Runtime.Serialization;
&lt;span style="color: blue;"&gt;using&lt;/span&gt; OfficeOpenXml;
&lt;span style="color: blue;"&gt;using&lt;/span&gt; System.ComponentModel;
&lt;span style="color: blue;"&gt;using&lt;/span&gt; System.Data;
&lt;span style="color: blue;"&gt;using&lt;/span&gt; OfficeOpenXml.Table;
&lt;span style="color: blue;"&gt;using&lt;/span&gt; OfficeOpenXml.Table.PivotTable;

&lt;span style="color: blue;"&gt;namespace&lt;/span&gt; EPPlusSubtotalTest
{
    &lt;span style="color: blue;"&gt;class&lt;/span&gt; Program
    {
        &lt;span style="color: blue;"&gt;static&lt;/span&gt; &lt;span style="color: blue;"&gt;void&lt;/span&gt; Main(&lt;span style="color: blue;"&gt;string&lt;/span&gt;[] args)
        {
            FileInfo newFile = &lt;span style="color: blue;"&gt;new&lt;/span&gt; FileInfo(Path.Combine(Path.GetTempPath(), &lt;span style="color: rgb(163, 21, 21);"&gt;@"d:\sample1.xlsx"&lt;/span&gt;)); &lt;span style="color: green;"&gt;// CHANGED&lt;/span&gt;
            &lt;span style="color: blue;"&gt;if&lt;/span&gt; (newFile.Exists)
            {
                newFile.Delete();
                newFile = &lt;span style="color: blue;"&gt;new&lt;/span&gt; FileInfo(Path.Combine(Path.GetTempPath(), &lt;span style="color: rgb(163, 21, 21);"&gt;@"d:\sample1.xlsx"&lt;/span&gt;)); &lt;span style="color: green;"&gt;// CHANGED&lt;/span&gt;
            }


            Portlet portlet = &lt;span style="color: blue;"&gt;new&lt;/span&gt; Portlet()
                {
                    userPortletId = 6,
                    url = &lt;span style="color: rgb(163, 21, 21);"&gt;""&lt;/span&gt;,
                    portletId = 55017,
                    alive = &lt;span style="color: blue;"&gt;true&lt;/span&gt;,
                    fill = &lt;span style="color: blue;"&gt;false&lt;/span&gt;,
                    groupField = &lt;span style="color: rgb(163, 21, 21);"&gt;""&lt;/span&gt;,
                    curSymbol = &lt;span style="color: rgb(163, 21, 21);"&gt;"$"&lt;/span&gt;,
                    curScale = 2,
                    pivotAxisTitle = &lt;span style="color: rgb(163, 21, 21);"&gt;"Table"&lt;/span&gt;,
                    title = &lt;span style="color: rgb(163, 21, 21);"&gt;"Price Table Analysis"&lt;/span&gt;,
                    type = &lt;span style="color: rgb(163, 21, 21);"&gt;"pivotGrid"&lt;/span&gt;
                };
            portlet.cols.Add(&lt;span style="color: blue;"&gt;new&lt;/span&gt; PortletColumn{hidden = &lt;span style="color: blue;"&gt;false&lt;/span&gt;,name = &lt;span style="color: rgb(163, 21, 21);"&gt;"mly"&lt;/span&gt;,renderer = &lt;span style="color: rgb(163, 21, 21);"&gt;""&lt;/span&gt;,summaryType = &lt;span style="color: rgb(163, 21, 21);"&gt;""&lt;/span&gt;,text = &lt;span style="color: rgb(163, 21, 21);"&gt;"Layer"&lt;/span&gt;,type = &lt;span style="color: rgb(163, 21, 21);"&gt;"string"&lt;/span&gt;});
            portlet.cols.Add(&lt;span style="color: blue;"&gt;new&lt;/span&gt; PortletColumn{hidden = &lt;span style="color: blue;"&gt;false&lt;/span&gt;,name = &lt;span style="color: rgb(163, 21, 21);"&gt;"mrg"&lt;/span&gt;,renderer = &lt;span style="color: rgb(163, 21, 21);"&gt;""&lt;/span&gt;,summaryType = &lt;span style="color: rgb(163, 21, 21);"&gt;""&lt;/span&gt;,text = &lt;span style="color: rgb(163, 21, 21);"&gt;"Group"&lt;/span&gt;,type = &lt;span style="color: rgb(163, 21, 21);"&gt;"string"&lt;/span&gt;});
            portlet.cols.Add(&lt;span style="color: blue;"&gt;new&lt;/span&gt; PortletColumn{hidden = &lt;span style="color: blue;"&gt;false&lt;/span&gt;,name = &lt;span style="color: rgb(163, 21, 21);"&gt;"mrw"&lt;/span&gt;,renderer = &lt;span style="color: rgb(163, 21, 21);"&gt;""&lt;/span&gt;,summaryType = &lt;span style="color: rgb(163, 21, 21);"&gt;""&lt;/span&gt;,text = &lt;span style="color: rgb(163, 21, 21);"&gt;"Discount"&lt;/span&gt;,type = &lt;span style="color: rgb(163, 21, 21);"&gt;"string"&lt;/span&gt;});
            portlet.cols.Add(&lt;span style="color: blue;"&gt;new&lt;/span&gt; PortletColumn{hidden = &lt;span style="color: blue;"&gt;false&lt;/span&gt;,name = &lt;span style="color: rgb(163, 21, 21);"&gt;"mcl"&lt;/span&gt;,renderer = &lt;span style="color: rgb(163, 21, 21);"&gt;""&lt;/span&gt;,summaryType = &lt;span style="color: rgb(163, 21, 21);"&gt;""&lt;/span&gt;,text = &lt;span style="color: rgb(163, 21, 21);"&gt;"Column"&lt;/span&gt;,type = &lt;span style="color: rgb(163, 21, 21);"&gt;"string"&lt;/span&gt;});
            portlet.cols.Add(&lt;span style="color: blue;"&gt;new&lt;/span&gt; PortletColumn{hidden = &lt;span style="color: blue;"&gt;false&lt;/span&gt;,name = &lt;span style="color: rgb(163, 21, 21);"&gt;"amt"&lt;/span&gt;,renderer = &lt;span style="color: rgb(163, 21, 21);"&gt;""&lt;/span&gt;,summaryType = &lt;span style="color: rgb(163, 21, 21);"&gt;""&lt;/span&gt;,text = &lt;span style="color: rgb(163, 21, 21);"&gt;"Price"&lt;/span&gt;,type = &lt;span style="color: rgb(163, 21, 21);"&gt;"number"&lt;/span&gt;});

            portlet.axes.Add(&lt;span style="color: blue;"&gt;new&lt;/span&gt; PortletAxis{axisPosition = &lt;span style="color: rgb(163, 21, 21);"&gt;"left"&lt;/span&gt;,dataIndex = &lt;span style="color: rgb(163, 21, 21);"&gt;"mly"&lt;/span&gt;,title = &lt;span style="color: rgb(163, 21, 21);"&gt;"Layer"&lt;/span&gt;});
            portlet.axes.Add(&lt;span style="color: blue;"&gt;new&lt;/span&gt; PortletAxis{axisPosition = &lt;span style="color: rgb(163, 21, 21);"&gt;"left"&lt;/span&gt;,dataIndex = &lt;span style="color: rgb(163, 21, 21);"&gt;"mrg"&lt;/span&gt;,title = &lt;span style="color: rgb(163, 21, 21);"&gt;"Group"&lt;/span&gt;});
            portlet.axes.Add(&lt;span style="color: blue;"&gt;new&lt;/span&gt; PortletAxis{axisPosition = &lt;span style="color: rgb(163, 21, 21);"&gt;"left"&lt;/span&gt;,dataIndex = &lt;span style="color: rgb(163, 21, 21);"&gt;"mrw"&lt;/span&gt;,title = &lt;span style="color: rgb(163, 21, 21);"&gt;"Discount"&lt;/span&gt;});
            portlet.axes.Add(&lt;span style="color: blue;"&gt;new&lt;/span&gt; PortletAxis{axisPosition = &lt;span style="color: rgb(163, 21, 21);"&gt;"top"&lt;/span&gt;,dataIndex = &lt;span style="color: rgb(163, 21, 21);"&gt;"mcl"&lt;/span&gt;,title = &lt;span style="color: rgb(163, 21, 21);"&gt;"Column"&lt;/span&gt;});

            portlet.aggregates.Add(&lt;span style="color: blue;"&gt;new&lt;/span&gt; PortletAggregate{dataIndex = &lt;span style="color: rgb(163, 21, 21);"&gt;"amt"&lt;/span&gt;, renderer = &lt;span style="color: rgb(163, 21, 21);"&gt;"PriceTableAmount"&lt;/span&gt;, summaryType = &lt;span style="color: rgb(163, 21, 21);"&gt;""&lt;/span&gt;, title = &lt;span style="color: rgb(163, 21, 21);"&gt;"Price"&lt;/span&gt;});
            &lt;span style="color: green;"&gt;// CHANGED VALUES&lt;/span&gt;
            portlet.data.Add(&lt;span style="color: blue;"&gt;new&lt;/span&gt; DataObject { mly = &lt;span style="color: rgb(163, 21, 21);"&gt;"Base Prices"&lt;/span&gt;, mrg = &lt;span style="color: rgb(163, 21, 21);"&gt;"Early Bird"&lt;/span&gt;, mrw = &lt;span style="color: rgb(163, 21, 21);"&gt;"(EMP) Employee"&lt;/span&gt;, mcl = &lt;span style="color: rgb(163, 21, 21);"&gt;"A"&lt;/span&gt;, amt = 50 });
            portlet.data.Add(&lt;span style="color: blue;"&gt;new&lt;/span&gt; DataObject { mly = &lt;span style="color: rgb(163, 21, 21);"&gt;"Base Prices"&lt;/span&gt;, mrg = &lt;span style="color: rgb(163, 21, 21);"&gt;"Early Bird"&lt;/span&gt;, mrw = &lt;span style="color: rgb(163, 21, 21);"&gt;"(STU) Student"&lt;/span&gt;, mcl = &lt;span style="color: rgb(163, 21, 21);"&gt;"A"&lt;/span&gt;, amt = 40 });
            portlet.data.Add(&lt;span style="color: blue;"&gt;new&lt;/span&gt; DataObject { mly = &lt;span style="color: rgb(163, 21, 21);"&gt;"Base Prices"&lt;/span&gt;, mrg = &lt;span style="color: rgb(163, 21, 21);"&gt;"Standard Rates"&lt;/span&gt;, mrw = &lt;span style="color: rgb(163, 21, 21);"&gt;"(ADU) Adult"&lt;/span&gt;, mcl = &lt;span style="color: rgb(163, 21, 21);"&gt;"A"&lt;/span&gt;, amt = 60 });
            portlet.data.Add(&lt;span style="color: blue;"&gt;new&lt;/span&gt; DataObject { mly = &lt;span style="color: rgb(163, 21, 21);"&gt;"Base Prices"&lt;/span&gt;, mrg = &lt;span style="color: rgb(163, 21, 21);"&gt;"Standard Rates"&lt;/span&gt;, mrw = &lt;span style="color: rgb(163, 21, 21);"&gt;"(CHI) Child"&lt;/span&gt;, mcl = &lt;span style="color: rgb(163, 21, 21);"&gt;"A"&lt;/span&gt;, amt = 50 });
            portlet.data.Add(&lt;span style="color: blue;"&gt;new&lt;/span&gt; DataObject { mly = &lt;span style="color: rgb(163, 21, 21);"&gt;"Base Prices"&lt;/span&gt;, mrg = &lt;span style="color: rgb(163, 21, 21);"&gt;"Standard Rates"&lt;/span&gt;, mrw = &lt;span style="color: rgb(163, 21, 21);"&gt;"(COM) Complimentary"&lt;/span&gt;, mcl = &lt;span style="color: rgb(163, 21, 21);"&gt;"A"&lt;/span&gt;, amt = 0 });
            portlet.data.Add(&lt;span style="color: blue;"&gt;new&lt;/span&gt; DataObject { mly = &lt;span style="color: rgb(163, 21, 21);"&gt;"Base Prices"&lt;/span&gt;, mrg = &lt;span style="color: rgb(163, 21, 21);"&gt;"Early Bird"&lt;/span&gt;, mrw = &lt;span style="color: rgb(163, 21, 21);"&gt;"(EMP) Employee"&lt;/span&gt;, mcl = &lt;span style="color: rgb(163, 21, 21);"&gt;"B"&lt;/span&gt;, amt = 60 });
            portlet.data.Add(&lt;span style="color: blue;"&gt;new&lt;/span&gt; DataObject { mly = &lt;span style="color: rgb(163, 21, 21);"&gt;"Base Prices"&lt;/span&gt;, mrg = &lt;span style="color: rgb(163, 21, 21);"&gt;"Early Bird"&lt;/span&gt;, mrw = &lt;span style="color: rgb(163, 21, 21);"&gt;"(STU) Student"&lt;/span&gt;, mcl = &lt;span style="color: rgb(163, 21, 21);"&gt;"B"&lt;/span&gt;, amt = 50 });
            portlet.data.Add(&lt;span style="color: blue;"&gt;new&lt;/span&gt; DataObject { mly = &lt;span style="color: rgb(163, 21, 21);"&gt;"Base Prices"&lt;/span&gt;, mrg = &lt;span style="color: rgb(163, 21, 21);"&gt;"Standard Rates"&lt;/span&gt;, mrw = &lt;span style="color: rgb(163, 21, 21);"&gt;"(ADU) Adult"&lt;/span&gt;, mcl = &lt;span style="color: rgb(163, 21, 21);"&gt;"B"&lt;/span&gt;, amt = 70 });
            portlet.data.Add(&lt;span style="color: blue;"&gt;new&lt;/span&gt; DataObject { mly = &lt;span style="color: rgb(163, 21, 21);"&gt;"Base Prices"&lt;/span&gt;, mrg = &lt;span style="color: rgb(163, 21, 21);"&gt;"Standard Rates"&lt;/span&gt;, mrw = &lt;span style="color: rgb(163, 21, 21);"&gt;"(CHI) Child"&lt;/span&gt;, mcl = &lt;span style="color: rgb(163, 21, 21);"&gt;"B"&lt;/span&gt;, amt = 60 });
            portlet.data.Add(&lt;span style="color: blue;"&gt;new&lt;/span&gt; DataObject { mly = &lt;span style="color: rgb(163, 21, 21);"&gt;"Base Prices"&lt;/span&gt;, mrg = &lt;span style="color: rgb(163, 21, 21);"&gt;"Standard Rates"&lt;/span&gt;, mrw = &lt;span style="color: rgb(163, 21, 21);"&gt;"(COM) Complimentary"&lt;/span&gt;, mcl = &lt;span style="color: rgb(163, 21, 21);"&gt;"B"&lt;/span&gt;, amt = 0 });
            portlet.data.Add(&lt;span style="color: blue;"&gt;new&lt;/span&gt; DataObject { mly = &lt;span style="color: rgb(163, 21, 21);"&gt;"Booking Fee"&lt;/span&gt;, mrg = &lt;span style="color: rgb(163, 21, 21);"&gt;"Standard Rates"&lt;/span&gt;, mrw = &lt;span style="color: rgb(163, 21, 21);"&gt;"(ADU) Adult"&lt;/span&gt;, mcl = &lt;span style="color: rgb(163, 21, 21);"&gt;"A"&lt;/span&gt;, amt = 10 });
            portlet.data.Add(&lt;span style="color: blue;"&gt;new&lt;/span&gt; DataObject { mly = &lt;span style="color: rgb(163, 21, 21);"&gt;"Booking Fee"&lt;/span&gt;, mrg = &lt;span style="color: rgb(163, 21, 21);"&gt;"Standard Rates"&lt;/span&gt;, mrw = &lt;span style="color: rgb(163, 21, 21);"&gt;"(CHI) Child"&lt;/span&gt;, mcl = &lt;span style="color: rgb(163, 21, 21);"&gt;"A"&lt;/span&gt;, amt = 5.5 });
            portlet.data.Add(&lt;span style="color: blue;"&gt;new&lt;/span&gt; DataObject { mly = &lt;span style="color: rgb(163, 21, 21);"&gt;"Booking Fee"&lt;/span&gt;, mrg = &lt;span style="color: rgb(163, 21, 21);"&gt;"Standard Rates"&lt;/span&gt;, mrw = &lt;span style="color: rgb(163, 21, 21);"&gt;"(ADU) Adult"&lt;/span&gt;, mcl = &lt;span style="color: rgb(163, 21, 21);"&gt;"B"&lt;/span&gt;, amt = 10.5 });
            portlet.data.Add(&lt;span style="color: blue;"&gt;new&lt;/span&gt; DataObject { mly = &lt;span style="color: rgb(163, 21, 21);"&gt;"Booking Fee"&lt;/span&gt;, mrg = &lt;span style="color: rgb(163, 21, 21);"&gt;"Standard Rates"&lt;/span&gt;, mrw = &lt;span style="color: rgb(163, 21, 21);"&gt;"(CHI) Child"&lt;/span&gt;, mcl = &lt;span style="color: rgb(163, 21, 21);"&gt;"B"&lt;/span&gt;, amt = 5.5 });

            &lt;span style="color: blue;"&gt;string&lt;/span&gt; curFormat = &lt;span style="color: rgb(163, 21, 21);"&gt;"$#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00"&lt;/span&gt;;
            &lt;span style="color: green;"&gt;//string sheetName = "Pivot";&lt;/span&gt;
            &lt;span style="color: green;"&gt;//string title = "Test Pivot Table";&lt;/span&gt;

            List&amp;lt;PortletColumn&amp;gt; columns = portlet.cols;
            List&amp;lt;PortletAxis&amp;gt; axes = portlet.axes;
            List&amp;lt;PortletAggregate&amp;gt; aggregates = portlet.aggregates;

            FileInfo pivot_table_template_spreadsheet = &lt;span style="color: blue;"&gt;new&lt;/span&gt; FileInfo(&lt;span style="color: rgb(163, 21, 21);"&gt;@"d:\pivot_table_no_subtotals_template.xlsx"&lt;/span&gt;); &lt;span style="color: green;"&gt;// NEW&lt;/span&gt;

            ExcelPackage pck = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(newFile, pivot_table_template_spreadsheet);
            &lt;span style="color: green;"&gt;//ExcelWorksheet wsPivot = pck.Workbook.Worksheets.Add(sheetName);&lt;/span&gt;
            ExcelWorksheet wsData = pck.Workbook.Worksheets.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"data"&lt;/span&gt;);

            DataTable dt = ToDataTable(portlet.data);
            &lt;span style="color: blue;"&gt;int&lt;/span&gt; i = 1;
            &lt;span style="color: blue;"&gt;int&lt;/span&gt; record = 1;
            &lt;span style="color: blue;"&gt;foreach&lt;/span&gt; (PortletColumn column &lt;span style="color: blue;"&gt;in&lt;/span&gt; columns)
            {
                wsData.Column(i).Style.Numberformat.Format = column.GetFormatter(curFormat);
                &lt;span style="color: blue;"&gt;try&lt;/span&gt;
                {
                    dt.Columns[column.name].ColumnName = column.GetHeader();
                }
                &lt;span style="color: blue;"&gt;catch&lt;/span&gt; (DuplicateNameException) { }

                i++;
            }
            record++;

            List&amp;lt;PortletAxis&amp;gt; leftAxes = axes.Where(a =&amp;gt; a.axisPosition.ToLower() == PortletAxis.Positions.LEFT).ToList();
            &lt;span style="color: blue;"&gt;int&lt;/span&gt; leftAxesCount = leftAxes.Count();
            List&amp;lt;PortletAxis&amp;gt; topAxes = axes.Where(a =&amp;gt; a.axisPosition.ToLower() == PortletAxis.Positions.TOP).ToList();
            &lt;span style="color: blue;"&gt;int&lt;/span&gt; topAxesCount = topAxes.Count();


            wsData.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;].LoadFromDataTable(dt, &lt;span style="color: blue;"&gt;true&lt;/span&gt;);

            ExcelRange dataRange = wsData.Cells[wsData.Dimension.Address.ToString()];
            dataRange.AutoFitColumns();


            &lt;span style="color: green;"&gt;//The title in the first cell.  It's a pivot so we don't know what the total columns will be (and they channge as you use the pivot)&lt;/span&gt;
            &lt;span style="color: green;"&gt;/*wsPivot.Cells["A1"].Value = title;
            wsPivot.Cells["A1"].Style.Font.Bold = true;
            wsPivot.Cells["A1"].Style.Font.Size = 14;

            ExcelPivotTable pivot = wsPivot.PivotTables.Add(wsPivot.Cells["A4"], dataRange, title);
            pivot.MultipleFieldFilters = true;
            pivot.RowGrandTotals = true;
            pivot.ColumGrandTotals = true;
            pivot.Compact = true;
            pivot.CompactData = true;
            pivot.GridDropZones = true;
            pivot.Outline = false;
            pivot.OutlineData = false;
            pivot.ShowError = true;
            pivot.ErrorCaption = "[error]";
            pivot.ShowHeaders = true;
            pivot.UseAutoFormatting = true;
            pivot.ApplyWidthHeightFormats = true;
            pivot.ShowDrill = true;
            pivot.FirstDataCol = leftAxesCount + 1;
            pivot.TableStyle = TableStyles.Medium2;
            pivot.RowHeaderCaption = portlet.pivotAxisTitle;*/&lt;/span&gt;


            &lt;span style="color: green;"&gt;/*foreach (PortletAxis axis in leftAxes)
            {
                ExcelPivotTableField rowField = pivot.Fields[axis.dataIndex];
                if (rowField == null)
                {
                    string dataIndex = columns.Single(c =&amp;gt; c.name == axis.dataIndex).GetHeader();
                    rowField = pivot.Fields[dataIndex];
                }
                //THIS LINE BELOW IS CAUSING PROBLEMS, uncomment and Excel is happy
                rowField.SubTotalFunctions = eSubTotalFunctions.None;
                pivot.RowFields.Add(rowField);
            }

            foreach (PortletAxis axis in topAxes)
            {
                ExcelPivotTableField colField = pivot.Fields[axis.dataIndex];
                if (colField == null)
                {
                    string dataIndex = columns.Single(c =&amp;gt; c.name == axis.dataIndex).GetHeader();
                    colField = pivot.Fields[dataIndex];
                }
                pivot.ColumnFields.Add(colField);
            }

            foreach (PortletAggregate agg in aggregates)
            {
                ExcelPivotTableField aggField = pivot.Fields[agg.dataIndex];
                PortletColumn col = columns.Single(c =&amp;gt; c.name == agg.dataIndex);
                if (aggField == null)
                {
                    aggField = pivot.Fields[col.GetHeader()];
                }
                //aggField.SubTotalFunctions = eSubTotalFunctions.None;
                ExcelPivotTableDataField dataField = pivot.DataFields.Add(aggField);
                dataField.Format = col.GetFormatter(portlet.curSymbol);
                switch (agg.summaryType.ToLower())
                {
                    case PortletAggregate.SummaryTypes.COUNT:
                        dataField.Function = DataFieldFunctions.Count;
                        break;
                    case PortletAggregate.SummaryTypes.SUM:
                        dataField.Function = DataFieldFunctions.Sum;
                        break;
                    case PortletAggregate.SummaryTypes.MAX:
                        dataField.Function = DataFieldFunctions.Max;
                        break;
                    case PortletAggregate.SummaryTypes.MIN:
                        dataField.Function = DataFieldFunctions.Min;
                        break;
                    case PortletAggregate.SummaryTypes.AVERAGE:
                        dataField.Function = DataFieldFunctions.Average;
                        break;
                    default:
                        dataField.Function = DataFieldFunctions.None;
                        break;
                }
            }*/&lt;/span&gt;

            pck.Save();
            Console.WriteLine();
            Console.WriteLine(&lt;span style="color: rgb(163, 21, 21);"&gt;"Press the return key to exit..."&lt;/span&gt;);
            Console.Read();
        }

        &lt;span style="color: blue;"&gt;private&lt;/span&gt; &lt;span style="color: blue;"&gt;static&lt;/span&gt; DataTable ToDataTable&amp;lt;T&amp;gt;(IList&amp;lt;T&amp;gt; list)
        {
            PropertyDescriptorCollection props =
                TypeDescriptor.GetProperties(&lt;span style="color: blue;"&gt;typeof&lt;/span&gt;(T));
            DataTable table = &lt;span style="color: blue;"&gt;new&lt;/span&gt; DataTable();
            &lt;span style="color: blue;"&gt;for&lt;/span&gt; (&lt;span style="color: blue;"&gt;int&lt;/span&gt; i = 0; i &amp;lt; props.Count; i++)
            {
                PropertyDescriptor prop = props[i];
                table.Columns.Add(prop.Name, prop.PropertyType);
            }
            &lt;span style="color: blue;"&gt;object&lt;/span&gt;[] values = &lt;span style="color: blue;"&gt;new&lt;/span&gt; &lt;span style="color: blue;"&gt;object&lt;/span&gt;[props.Count];
            &lt;span style="color: blue;"&gt;foreach&lt;/span&gt; (T item &lt;span style="color: blue;"&gt;in&lt;/span&gt; list)
            {
                &lt;span style="color: blue;"&gt;for&lt;/span&gt; (&lt;span style="color: blue;"&gt;int&lt;/span&gt; i = 0; i &amp;lt; values.Length; i++)
                {
                    values[i] = props[i].GetValue(item);
                }
                table.Rows.Add(values);
            }
            &lt;span style="color: blue;"&gt;return&lt;/span&gt; table;
        }
    }

    &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;class&lt;/span&gt; Portlet
    {
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; url { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; title { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;int&lt;/span&gt; portletId { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;int&lt;/span&gt; userPortletId { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; type { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;bool&lt;/span&gt; fill { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;bool&lt;/span&gt; alive { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; groupField { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; curSymbol { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;int&lt;/span&gt; curScale { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; List&amp;lt;PortletColumn&amp;gt; cols { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; pivotAxisTitle { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; List&amp;lt;PortletAxis&amp;gt; axes { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; List&amp;lt;PortletAggregate&amp;gt; aggregates { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; List&amp;lt;DataObject&amp;gt; data { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }

        &lt;span style="color: blue;"&gt;public&lt;/span&gt; Portlet()
        {
            &lt;span style="color: blue;"&gt;this&lt;/span&gt;.cols = &lt;span style="color: blue;"&gt;new&lt;/span&gt; List&amp;lt;PortletColumn&amp;gt;();
            &lt;span style="color: blue;"&gt;this&lt;/span&gt;.axes = &lt;span style="color: blue;"&gt;new&lt;/span&gt; List&amp;lt;PortletAxis&amp;gt;();
            &lt;span style="color: blue;"&gt;this&lt;/span&gt;.aggregates = &lt;span style="color: blue;"&gt;new&lt;/span&gt; List&amp;lt;PortletAggregate&amp;gt;();
            &lt;span style="color: blue;"&gt;this&lt;/span&gt;.data = &lt;span style="color: blue;"&gt;new&lt;/span&gt; List&amp;lt;DataObject&amp;gt;();
        }

    }

    &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;class&lt;/span&gt; PortletColumn
    {
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; name { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; renderer { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; type { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; summaryType { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; text { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;bool&lt;/span&gt; hidden { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }

        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;class&lt;/span&gt; DataTypes
        {
            &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;const&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; STRING = &lt;span style="color: rgb(163, 21, 21);"&gt;"string"&lt;/span&gt;;
            &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;const&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; NUMBER = &lt;span style="color: rgb(163, 21, 21);"&gt;"number"&lt;/span&gt;;
            &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;const&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; INTEGER = &lt;span style="color: rgb(163, 21, 21);"&gt;"int"&lt;/span&gt;;
            &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;const&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; CURRENCY = &lt;span style="color: rgb(163, 21, 21);"&gt;"currency"&lt;/span&gt;;
        }

        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;class&lt;/span&gt; SummaryTypes
        {
            &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;const&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; COUNT = &lt;span style="color: rgb(163, 21, 21);"&gt;"count"&lt;/span&gt;;
            &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;const&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; SUM = &lt;span style="color: rgb(163, 21, 21);"&gt;"sum"&lt;/span&gt;;
            &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;const&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; MAX = &lt;span style="color: rgb(163, 21, 21);"&gt;"max"&lt;/span&gt;;
            &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;const&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; MIN = &lt;span style="color: rgb(163, 21, 21);"&gt;"min"&lt;/span&gt;;
            &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;const&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; AVERAGE = &lt;span style="color: rgb(163, 21, 21);"&gt;"average"&lt;/span&gt;;
            &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;const&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; DISTINCT_COUNT = &lt;span style="color: rgb(163, 21, 21);"&gt;"distinct"&lt;/span&gt;;
        }

        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; GetHeader()
        {
            &lt;span style="color: blue;"&gt;return&lt;/span&gt; &lt;span style="color: blue;"&gt;this&lt;/span&gt;.text == &lt;span style="color: rgb(163, 21, 21);"&gt;""&lt;/span&gt; ? &lt;span style="color: blue;"&gt;this&lt;/span&gt;.name : &lt;span style="color: blue;"&gt;this&lt;/span&gt;.text;
        }

        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; GetFormatter(&lt;span style="color: blue;"&gt;string&lt;/span&gt; curFormat)
        {
            &lt;span style="color: blue;"&gt;switch&lt;/span&gt; (&lt;span style="color: blue;"&gt;this&lt;/span&gt;.type.ToLower())
            {
                &lt;span style="color: blue;"&gt;case&lt;/span&gt; PortletColumn.DataTypes.INTEGER:
                    &lt;span style="color: blue;"&gt;return&lt;/span&gt; &lt;span style="color: rgb(163, 21, 21);"&gt;"#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;"&lt;/span&gt;;
                &lt;span style="color: blue;"&gt;case&lt;/span&gt; PortletColumn.DataTypes.NUMBER:
                    &lt;span style="color: blue;"&gt;return&lt;/span&gt; &lt;span style="color: rgb(163, 21, 21);"&gt;"#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.0"&lt;/span&gt;;
                &lt;span style="color: blue;"&gt;case&lt;/span&gt; PortletColumn.DataTypes.CURRENCY:
                    &lt;span style="color: blue;"&gt;return&lt;/span&gt; curFormat;
            }
            &lt;span style="color: blue;"&gt;return&lt;/span&gt; &lt;span style="color: rgb(163, 21, 21);"&gt;""&lt;/span&gt;;
        }
    }
    &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;class&lt;/span&gt; PortletAxis
    {
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; axisPosition { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; dataIndex { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; title { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }

        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;class&lt;/span&gt; Positions
        {
            &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;const&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; LEFT = &lt;span style="color: rgb(163, 21, 21);"&gt;"left"&lt;/span&gt;;
            &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;const&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; TOP = &lt;span style="color: rgb(163, 21, 21);"&gt;"top"&lt;/span&gt;;
        }
    }
    &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;class&lt;/span&gt; PortletAggregate
    {
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; dataIndex { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; title { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; summaryType { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; renderer { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }

        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;class&lt;/span&gt; SummaryTypes
        {
            &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;const&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; COUNT = &lt;span style="color: rgb(163, 21, 21);"&gt;"count"&lt;/span&gt;;
            &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;const&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; SUM = &lt;span style="color: rgb(163, 21, 21);"&gt;"sum"&lt;/span&gt;;
            &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;const&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; MAX = &lt;span style="color: rgb(163, 21, 21);"&gt;"max"&lt;/span&gt;;
            &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;const&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; MIN = &lt;span style="color: rgb(163, 21, 21);"&gt;"min"&lt;/span&gt;;
            &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;const&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; AVERAGE = &lt;span style="color: rgb(163, 21, 21);"&gt;"average"&lt;/span&gt;;
        }
    }

    &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;class&lt;/span&gt; DataObject
    {
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; mly { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; mrg { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; mrw { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; mcl { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;double&lt;/span&gt; amt { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }
    }

}

&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="traigo" When="16/01/2013 04:50:29">
          <Html>
        
&lt;p&gt;Thanks for all the help. &amp;nbsp;I really appreciate it. &amp;nbsp;Unfortunately, it doesn't fix my problem. &amp;nbsp;The pivots are user defined and the definition is saved in the database. &amp;nbsp;I couldn't create the template file with the subtotals removed as
 the data, columns, axes, and aggregates are all dynamic. &amp;nbsp;I'll just stick with the "You can disable them yourself in Excel" approach for users until, hopefully, this is fixed at some point.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="SaveAs InvalidOperationException">
      <Posts>
        <Post From="tacotortilla" When="11/01/2013 18:11:40">
          <Html>
        
&lt;p&gt;&lt;span style='font-family: "Segoe UI","Microsoft Sans Serif",Arial,Geneva,sans-serif; white-space: normal;'&gt;I have a file where EPPlus.dll v3.1.2.0 throws "InvalidOperationException: Index was outside the bounds of the array"on the SaveAs line in the
 example code below:&lt;/span&gt;&lt;/p&gt;
&lt;pre&gt;&lt;div style="color: black; background-color: white;"&gt;&lt;pre&gt;&lt;span style="color: blue;"&gt;string&lt;/span&gt; _sFile = &lt;span style="color: rgb(163, 21, 21);"&gt;"test.xlsm"&lt;/span&gt;;
&lt;span style="color: blue;"&gt;using&lt;/span&gt; (FileStream stream = File.Open(_sFile, FileMode.Open, FileAccess.ReadWrite))
{
    &lt;span style="color: blue;"&gt;using&lt;/span&gt; (ExcelPackage ep = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage((stream)))
    {
        String newFilename = _sFile + &lt;span style="color: rgb(163, 21, 21);"&gt;".modified.xlsm"&lt;/span&gt;;
        FileInfo fi = &lt;span style="color: blue;"&gt;new&lt;/span&gt; FileInfo(newFilename);
        ep.SaveAs(fi);
    }
}
&lt;/pre&gt;
&lt;/div&gt;
&lt;/pre&gt;
&lt;p&gt;I don't see how to attach this file at the moment, as has been done in this post: http://epplus.codeplex.com/workitem/14710.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="VBA and Pivots">
      <Posts>
        <Post From="mkay" When="03/12/2012 14:21:48">
          <Html>
        
&lt;p&gt;Hello, I think I've found a bug:&lt;br&gt;
&lt;br&gt;
Whenever I put both a pivot table and a VBA project in the same file (such as by loading Sample12 file in Sample15 and then continuing as usual) Excel (version 2010) says that it has found unreadable content and then after trying to recover it, it shows another
 message 'Removed Feature: PivotTable report from /xl/pivotTables/pivotTable1.xml part (PivotTable view)'&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="rohithshenoyg" When="13/12/2012 08:00:03">
          <Html>
        
&lt;p&gt;This happened to me too. Any solutions yet?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mkay" When="11/01/2013 08:02:01">
          <Html>
        
&lt;p&gt;Any comment or update on this?&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="move pivot table to new address">
      <Posts>
        <Post From="Phinehas" When="10/01/2013 02:00:10">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;How can I move pivot table to new address?&lt;/p&gt;
&lt;p&gt;For example, after I create a pivot table in cell A1, I want to insert two page field in pivot table. Therefore, I have to move pivot table to cell A4.&lt;/p&gt;
&lt;p&gt;Is there any method to move pivot table to new cell (address)?&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="reading richtext content from DB to Excel without loosing the formatting using Epplus">
      <Posts>
        <Post From="nkrishna" When="08/01/2013 19:51:41">
          <Html>
        
&lt;p&gt;Is it possible to read richtext content from DB to Excel without loss in formatting&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Need to save Excel Package every time a change is made">
      <Posts>
        <Post From="mohnkern" When="08/01/2013 19:02:11">
          <Html>
        
&lt;p&gt;Hello,&lt;/p&gt;
&lt;p&gt;We are using an Excel spreadsheet for processing a list of data and need to update the current index to process after each one is complete. &amp;nbsp;In other words, we need to open Excel and make multiple saves to it. &amp;nbsp; When we use the Save command, it
 saves but then closes the package. &amp;nbsp;Does anyone know a way to save without having to then reopen each time?&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How do I use EPPlus? Poor documentation!">
      <Posts>
        <Post From="Smokehouse_Joe" When="06/01/2013 03:52:37">
          <Html>
        
&lt;p&gt;I'm new to C# and I'm trying to write a windows form project, where I am creating a log book of running (jogging) "start time" and "stop time", subtract the difference and tell me the "total run time"...&amp;nbsp; all of this works...
 I am looking for help! I want to hit the save button and utilize EPPlus to write the three textbox.text information to an excel file. After the file is written after the first time... obviously I don't want to create a file again, just add the next entries
 just below the last entry and so on...&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Any advice would be greatly appreciated!&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mjslane" When="08/01/2013 13:30:34">
          <Html>
        
&lt;p&gt;This is basic programming, and nothing to do with EPPluss documentation. &amp;nbsp;Epplus is pretty easy to use and doesn't need much more documentation than the examples, especially if you are used to Excel COM.&lt;/p&gt;
&lt;p&gt;When creating the fileinfo object to pass into the package object, do something like this.&lt;/p&gt;
&lt;p&gt;using(var fi = File.Open(myfile, FileMode.OpenOrCreate))&lt;/p&gt;
&lt;p&gt;{&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; using(var package = new ExcelPackage(fi))&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &amp;nbsp; {&lt;br&gt;
&amp;nbsp; &amp;nbsp; }&amp;nbsp;&lt;/p&gt;
&lt;p&gt;}&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Pivot Table Summation Problem">
      <Posts>
        <Post From="Phinehas" When="08/01/2013 01:22:43">
          <Html>
        
&lt;p&gt;When I add multi-datafields to data area, a summation value is automatically inserted to row area.&lt;/p&gt;
&lt;p&gt;However, in Excel, when I drag multi-datafields to data area, the summation value is inserted to column area (not row area).&lt;/p&gt;
&lt;p&gt;How can I set the summation value to column area in EPPlus?&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Pivot Table Help: First RowField gets replaced by the second">
      <Posts>
        <Post From="JChristian11" When="04/01/2013 19:45:26">
          <Html>
        
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;I have a couple of problems but first things first. I'm trying to create a pivot table that groups on the type column and the Degree column. I haven't added the grouping yet because I couldn't find a method to group on a string. However the first problem that I am having is that when I try to add a second row field, it always replaces the first one. Has anyone encountered this?&lt;/pre&gt;
&lt;pre&gt;Sorry in advance if this has been asked before but I can't seem to find the answer.&lt;/pre&gt;
&lt;pre&gt;        &lt;span style="color: blue;"&gt;private&lt;/span&gt; &lt;span style="color: blue;"&gt;static&lt;/span&gt; &lt;span style="color: blue;"&gt;bool&lt;/span&gt; CreateCrosstab()
        {
            &lt;span style="color: blue;"&gt;using&lt;/span&gt; (ExcelPackage pck = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(newFile))
            {
                &lt;span style="color: green;"&gt;// get the handle to the existing worksheet&lt;/span&gt;
                &lt;span style="color: green;"&gt;//ExcelWorksheet wsData = pck.Workbook.Worksheets.Add("Summary");&lt;/span&gt;

                &lt;span style="color: blue;"&gt;var&lt;/span&gt; wsPivot2 = pck.Workbook.Worksheets.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"Summary"&lt;/span&gt;);
                &lt;span style="color: blue;"&gt;var&lt;/span&gt; pivotTable2 = wsPivot2.PivotTables.Add(wsPivot2.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;], dataRange, &lt;span style="color: rgb(163, 21, 21);"&gt;"PerAttendee"&lt;/span&gt;);

                &lt;span style="color: green;"&gt;//Also need rowfield for ProgramType&lt;/span&gt;
                pivotTable2.RowFields.Add(pivotTable2.Fields[&lt;span style="color: rgb(163, 21, 21);"&gt;"Type"&lt;/span&gt;]);
                pivotTable2.RowFields.Add(pivotTable2.Fields[&lt;span style="color: rgb(163, 21, 21);"&gt;"Degree"&lt;/span&gt;]);
                pivotTable2.ColumnFields.Add(pivotTable2.Fields[&lt;span style="color: rgb(163, 21, 21);"&gt;"Region"&lt;/span&gt;]);

                pivotTable2.DataOnRows = &lt;span style="color: blue;"&gt;false&lt;/span&gt;;                
                pck.Save();
            }&lt;br&gt;&lt;/pre&gt;
&lt;pre&gt;            &lt;span style="color: blue;"&gt;return&lt;/span&gt; &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
        }
&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="JChristian11" When="04/01/2013 20:07:51">
          <Html>
        
&lt;p&gt;It actually did work. The problem was that some of the types were null so I needed to scroll down quite a bit to see the first one.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to set Column Type to Date">
      <Posts>
        <Post From="_manvel_" When="25/03/2012 12:25:26">
          <Html>
        
&lt;p&gt;Hey guys,&lt;/p&gt;
&lt;p&gt;I'm populating ExcelWorkSheet by using LoadFromDataTable() method, and passing to it DataTable. In DataTable create method I'm setting one of it's column's type to DateTime. However when Excel gets populated, Date column cell's type is Number, if I manually
 change it to Date, it shows correct data. So the question is, can I programmatically set type of COLUMN to particular type, and if I can, how to do that ?&lt;/p&gt;
&lt;p&gt;Thanks in advance.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="alackan" When="25/03/2012 13:25:29">
          <Html>
        
&lt;p&gt;This worked for me where ExpiryDate is of type DateTime:&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;worksheet_1.Cells[row, 3].Style.Numberformat.Format = &lt;span style="color: rgb(163, 21, 21);"&gt;"dd-mmm-yy"&lt;/span&gt;;
worksheet_1.Cells[row, 3].Value = ExpiryDate;
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="_manvel_" When="25/03/2012 15:04:44">
          <Html>
        
&lt;p&gt;Thanks for response. And yes your code works, but can't we set Cell's type to Date from code ?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="lybax" When="04/01/2013 16:27:43">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I had the same issue, as the generated cell format is "Custom" not "Date".
&lt;br&gt;
But I finally found a way to generate a proper "Date" format:&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;worksheet_1.Cells[row, 3].Style.Numberformat.Format = DateTimeFormatInfo.CurrentInfo.ShortDatePattern;&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Count merge cell">
      <Posts>
        <Post From="Cartman1333" When="04/01/2013 15:17:47">
          <Html>
        
&lt;p&gt;Hello,&lt;/p&gt;
&lt;p&gt;Is there possible to get column count number for a merged cells ?&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Formulas in named ranges causing corruption on saving file">
      <Posts>
        <Post From="the_jdl" When="04/01/2013 06:52:18">
          <Html>
        
&lt;p&gt;Are formulas in named ranges supported?&amp;nbsp; I'm having trouble with a spreadsheet which has some pre-defined named ranges in it.&amp;nbsp; When I save the file, the file is corrupted and can't be opened by excel&amp;nbsp; The range is defined as,&lt;/p&gt;
&lt;p&gt;=OFFSET(Sheet1!$A1,0,0,COUNT(Sheet1!$A:$A)-1,1)&lt;/p&gt;
&lt;p&gt;The file with this named range is called test_simple.xlsm&lt;/p&gt;
&lt;p&gt;When I run the following code, the resulting file test_simple1.xlsm can't be opend by Excel (complains of corruption).&amp;nbsp; Any help would be appreciated.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;div style="color: black; background-color: white;"&gt;&lt;pre&gt;&lt;span style="color: blue;"&gt;var&lt;/span&gt; tmp = &lt;span style="color: rgb(163, 21, 21);"&gt;@"c:\temp\test_simple1.xlsm"&lt;/span&gt;;
            File.Copy(&lt;span style="color: rgb(163, 21, 21);"&gt;@"c:\temp\test_simple.xlsm"&lt;/span&gt;, tmp, &lt;span style="color: blue;"&gt;true&lt;/span&gt;);

            &lt;span style="color: blue;"&gt;using&lt;/span&gt; (ExcelPackage oo = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(&lt;span style="color: blue;"&gt;new&lt;/span&gt; FileInfo(tmp)))
            {
                oo.Workbook.Worksheets.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"something"&lt;/span&gt;);
                oo.Save();
            }
&lt;/pre&gt;
&lt;/div&gt;
&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How Can I Dynamically Format Columns?">
      <Posts>
        <Post From="lxchavez" When="02/01/2013 20:21:01">
          <Html>
        
&lt;p&gt;Hi all,&lt;/p&gt;
&lt;p&gt;Is there a way I can dynamically format columns in a spreadsheet based on the datatype of a DataTable? Once I've exported the contents of a database table into a spreadsheet, I would like to iterate through each column of a DataTable (loaded from a database
 table) and map its datatype to an arbitrary Excel format type so I can do a&amp;nbsp;
&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;ws.Column(col).Style.Numberformat.Format = ... 
&lt;/pre&gt;
&lt;/div&gt;
on-the-fly.
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;e.g. a DATE column from a DB table would be mapped to m/d/yy, DECIMAL would be mapped to 0.00, VARCHAR would be mapped to General, etc.&lt;/p&gt;
&lt;p&gt;Any assistance would be appreciated! Thank you :)&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How Can I Dynamically Format Columns?">
      <Posts>
        <Post From="lxchavez" When="02/01/2013 20:21:01">
          <Html>
        
&lt;p&gt;Hi all,&lt;/p&gt;
&lt;p&gt;Is there a way I can dynamically format columns in a spreadsheet based on the datatype of a DataTable? Once I've exported the contents of a database table into a spreadsheet, I would like to iterate through each column of a DataTable (loaded from a database
 table) and map its datatype to an arbitrary Excel format type so I can do a&amp;nbsp;ws.Column(col).Style.Numberformat.Format = ... on-the-fly.&lt;/p&gt;
&lt;p&gt;e.g. a DATE column from a DB table would be mapped to m/d/yy, DECIMAL would be mapped to 0.00, VARCHAR would be mapped to General, etc.&lt;/p&gt;
&lt;p&gt;Any assistance would be appreciated! Thank you :)&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Create CSVs?">
      <Posts>
        <Post From="jeff00seattle" When="31/12/2012 21:13:03">
          <Html>
        
&lt;p&gt;Hi&lt;/p&gt;
&lt;p&gt;I know this is overkill using &lt;strong&gt;EPPlus&lt;/strong&gt;, but can it create &lt;strong&gt;
CSV files&lt;/strong&gt; from DataTables?&lt;/p&gt;
&lt;p&gt;Jeff in Seattle&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="insert RichText from .rtf file">
      <Posts>
        <Post From="SaintSandro" When="28/12/2012 12:38:34">
          <Html>
        
&lt;p&gt;I got some troubles inserting text from .rtf file to a cell. Is it possible to insert text from .rtf file to a cell with text colors saved?&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Coloring Pivot table datafields">
      <Posts>
        <Post From="Bhanu1423" When="26/12/2012 05:00:00">
          <Html>
        
&lt;p&gt;hi..&lt;/p&gt;
&lt;p&gt;i have pivot table.. generated from the&amp;nbsp;data Table.&lt;/p&gt;
&lt;p&gt;I need to color the data field values of pivot table, based on certain conditions... (grater than, smaller than.. etc)&lt;/p&gt;
&lt;p&gt;i tried with conditional&amp;nbsp;formatting&amp;nbsp;in epplus.. but it is not&amp;nbsp;applying&amp;nbsp;to&amp;nbsp;data field&amp;nbsp;values...&lt;/p&gt;
&lt;p&gt;Please help me in this...&lt;/p&gt;
&lt;p&gt;Thanks in Advance ..&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="EPPlus LoadFromDatatable at nth cell is not Working.....">
      <Posts>
        <Post From="UserName123" When="18/12/2012 10:08:17">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &amp;nbsp; When exporting to excel with LoadFromDatatble to 'AA' Column i am getting following error!!!&lt;/p&gt;
&lt;p&gt;"Specified argument was out of the range of valid values.Parameter name: Start cell Address must be less or equal to End cell address"&lt;/p&gt;
&lt;p&gt;Please let me know about this..&lt;/p&gt;
&lt;p&gt;is there any way to write to any column in Excel at once from Datatable.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="xav2075" When="18/12/2012 15:22:27">
          <Html>
        
&lt;p&gt;If you refer to the cell address in number format it should work:&amp;nbsp; worksheet.Cells[1,27].LoadFromDataTable(datatable, true) would load it from the top left at row 1, column 27 (AA).&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="UserName123" When="19/12/2012 04:53:29">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;&amp;nbsp; i am using like this. &amp;nbsp;[&amp;nbsp;NewSheet.Cells [1 , 27].LoadFromDataTable (dt , true); ], am still getting the Error!!!&lt;/p&gt;
&lt;p&gt;"&lt;span&gt;Specified argument was out of the range of valid values.Parameter name: Start cell Address must be less or equal to End cell address"&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="xav2075" When="19/12/2012 10:11:52">
          <Html>
        
&lt;p&gt;If you could post as much code as you can I can have a look at it in visual studio.&amp;nbsp; Btw I am a novice programmer but I like to help out where I can as website like stackoverflow.com that have guidance from seasoned programmers are very useful to me.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="UserName123" When="19/12/2012 10:23:57">
          <Html>
        
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;my code is just simple writing to Excel at "AA" column using Template..&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;public void GenerateTemplateFromIEnumerableColl (DataTable dt &amp;nbsp;, int ToColumnVal)&lt;span&gt;
&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;{&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &amp;nbsp;&amp;nbsp;FileInfo Template ="Template path here";&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &amp;nbsp; FileInfo NewFile ="Path to save excel file";&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &amp;nbsp;using (ExcelPackage ExlPackage = new ExcelPackage (NewFile , Template))&lt;span&gt;
&lt;/span&gt;{&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span&gt; &lt;/span&gt;NewSheet.Cells [1 , 27].LoadFromDataTable (dt , true); // This line is capturing error!!!&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&amp;nbsp;ExlPackage.Save ();&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;}&lt;/p&gt;
&lt;p&gt;}&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="xav2075" When="19/12/2012 13:23:57">
          <Html>
        
&lt;p&gt;From the code fragment you have posted there is no declaration for a new worksheet that is part of ExcelPackage-&amp;gt;ExlPackage.&lt;/p&gt;
&lt;p&gt;You would need to add:&amp;nbsp; ExcelWorksheet NewSheet = ExlPackage.Workbook.Worksheets.Add("worksheet name");&lt;/p&gt;
&lt;p&gt;But Visual Studio should flag an error that you have not declared NewSheet in the first place.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="origfla" When="24/12/2012 15:24:43">
          <Html>
        
&lt;p&gt;I am getting the exact same error!! And it has nothing to do with the Package or the worksheet!&lt;/p&gt;
&lt;p&gt;For example, I can run the following code without error:&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; .Cells(2, &lt;strong&gt;20&lt;/strong&gt;).LoadFromDataTable(dtMyTable,True)&lt;/p&gt;
&lt;p&gt;BUT When I change it to this:&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; .Cells(2, &lt;strong&gt;26&lt;/strong&gt;).LoadFromDataTable(dtMyTable,True)&lt;/p&gt;
&lt;p&gt;I get an &lt;strong&gt;ArgumentOutOfRangeException - Specified argument was out of the range of valid values. Parameter name: Start cell Address must be less or equal to End cell address.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Anyone have any thoughts??&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="origfla" When="24/12/2012 15:45:26">
          <Html>
        
&lt;p&gt;&lt;span&gt;As added info on the question, when I changed my EPPlus from Version 3.1.2 to 3.0, it now works again...&lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Can not read any cells if the Excel-file contains a division-by-zero error">
      <Posts>
        <Post From="Altiplano" When="22/12/2012 14:18:02">
          <Html>
        
&lt;p&gt;Say my Excel-file looks like this:&lt;/p&gt;
&lt;p style="padding-left: 30px;"&gt;Cell A1: 1&lt;br&gt;
Cell A2: 0&lt;br&gt;
Cell A3: =A1 / A2 &amp;nbsp;&lt;/p&gt;
&lt;p&gt;Obviously A3 will result in&amp;nbsp;&lt;span&gt;"#DIV/0!"&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;However, this also prevents me from reading the content of cell A1:&lt;/span&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre style="padding-left: 30px;"&gt;&lt;div style="color: black; background-color: white;"&gt;&lt;pre&gt;FileInfo excelFile = &lt;span style="color: blue;"&gt;new&lt;/span&gt; FileInfo(fileName);
ExcelPackage package = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(excelFile);
&lt;span style="color: blue;"&gt;var&lt;/span&gt; test = package.Workbook.Worksheets[1].Cells[1, 1].Value;&lt;/pre&gt;
&lt;/div&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;will throw me an "Index was out of range error". If I put a different value in cell A2 the code works just fine.&lt;/p&gt;
&lt;p&gt;Is there a way to read the content of cell A1 regardles of any errors elsewhere in the Excel-sheet?&lt;/p&gt;
&lt;p&gt;regards,&lt;br&gt;
Michiel&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Autofilter on multiple sheets : unreadable content">
      <Posts>
        <Post From="maxl49" When="21/12/2012 15:07:43">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I started using this great component to export data to excel and I'm having a small issue when trying to set autofilters on multiple sheets in the same workbook.&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I get an "unreadable content" warning when opening the file in excel, yet the filters work just fine. &amp;nbsp;The problem seems to be in the definedNames section of the xl/workbook.xml.&lt;/p&gt;
&lt;p&gt;Here's the bad xml :&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre style="color: black;"&gt;&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;workbook&lt;/span&gt; &lt;span style="color: red;"&gt;xmlns:r&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;http://schemas.openxmlformats.org/officeDocument/2006/relationships&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: red;"&gt;xmlns&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;http://schemas.openxmlformats.org/spreadsheetml/2006/main&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
  &lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;bookViews&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
    &lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;workbookView&lt;/span&gt; &lt;span style="color: blue;"&gt;/&amp;gt;&lt;/span&gt;
  &lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;bookViews&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
  &lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;sheets&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
    &lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;sheet&lt;/span&gt; &lt;span style="color: red;"&gt;name&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;Code magasins doublons&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: red;"&gt;sheetId&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;1&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: red;"&gt;r:id&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;R1472518796f14431&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: blue;"&gt;/&amp;gt;&lt;/span&gt;
    &lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;sheet&lt;/span&gt; &lt;span style="color: red;"&gt;name&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;Quantité d'équipements &lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: red;"&gt;sheetId&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;2&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: red;"&gt;r:id&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;Rb8ad4bd3047f4ffe&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: blue;"&gt;/&amp;gt;&lt;/span&gt;
    &lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;sheet&lt;/span&gt; &lt;span style="color: red;"&gt;name&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;Portrait du parc d'équipements&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: red;"&gt;sheetId&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;3&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: red;"&gt;r:id&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;R38fbefa2ba02414a&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: blue;"&gt;/&amp;gt;&lt;/span&gt;
  &lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;sheets&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
  &lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;definedNames&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
    &lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;definedName&lt;/span&gt; &lt;span style="color: red;"&gt;name&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;_xlnm._FilterDatabase&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: red;"&gt;localSheetId&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;0&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: red;"&gt;hidden&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;1&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;'Code magasins doublons'!$A$7:$F$21&lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;definedName&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
    &lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;definedName&lt;/span&gt; &lt;span style="color: red;"&gt;name&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;_xlnm._FilterDatabase&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: red;"&gt;localSheetId&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;1&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: red;"&gt;hidden&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;1&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;'Quantité d'équipements '!$A$7:$I$443&lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;definedName&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
    &lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;definedName&lt;/span&gt; &lt;span style="color: red;"&gt;name&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;_xlnm._FilterDatabase&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: red;"&gt;localSheetId&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;2&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: red;"&gt;hidden&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;1&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;'Portrait du parc d'équipements'!$A$7:$B$12&lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;definedName&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
  &lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;definedNames&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
&lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;workbook&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;span style="color: rgb(0, 0, 0);"&gt;And the "repaired&lt;/span&gt; by excel" version :&lt;/pre&gt;
&lt;pre&gt;&lt;span style="color: rgb(0, 0, 0);"&gt;&lt;div style="color: black; background-color: white;"&gt;&lt;pre&gt;&lt;span style="color: blue;"&gt;&amp;lt;?&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;xml&lt;/span&gt; &lt;span style="color: red;"&gt;version&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;1.0&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: red;"&gt;encoding&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;UTF-8&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: red;"&gt;standalone&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;yes&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;?&amp;gt;&lt;/span&gt;
&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;workbook&lt;/span&gt; &lt;span style="color: red;"&gt;xmlns&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;http://schemas.openxmlformats.org/spreadsheetml/2006/main&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: red;"&gt;xmlns:r&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;http://schemas.openxmlformats.org/officeDocument/2006/relationships&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
  &lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;fileVersion&lt;/span&gt; &lt;span style="color: red;"&gt;appName&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;xl&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: red;"&gt;lastEdited&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;5&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: red;"&gt;lowestEdited&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;5&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: red;"&gt;rupBuild&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;9302&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;/&amp;gt;&lt;/span&gt;
  &lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;workbookPr&lt;/span&gt; &lt;span style="color: red;"&gt;defaultThemeVersion&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;124226&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;/&amp;gt;&lt;/span&gt;
  &lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;bookViews&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
    &lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;workbookView&lt;/span&gt; &lt;span style="color: red;"&gt;xWindow&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;330&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: red;"&gt;yWindow&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;450&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: red;"&gt;windowWidth&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;28200&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: red;"&gt;windowHeight&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;12195&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;/&amp;gt;&lt;/span&gt;
  &lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;bookViews&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
  &lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;sheets&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
    &lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;sheet&lt;/span&gt; &lt;span style="color: red;"&gt;name&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;Code magasins doublons&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: red;"&gt;sheetId&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;1&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: red;"&gt;r:id&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;rId1&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;/&amp;gt;&lt;/span&gt;
    &lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;sheet&lt;/span&gt; &lt;span style="color: red;"&gt;name&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;Quantité d'équipements &lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: red;"&gt;sheetId&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;2&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: red;"&gt;r:id&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;rId2&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;/&amp;gt;&lt;/span&gt;
    &lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;sheet&lt;/span&gt; &lt;span style="color: red;"&gt;name&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;Portrait du parc d'équipements&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: red;"&gt;sheetId&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;3&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: red;"&gt;r:id&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;rId3&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;/&amp;gt;&lt;/span&gt;
  &lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;sheets&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
  &lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;definedNames&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
    &lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;definedName&lt;/span&gt; &lt;span style="color: red;"&gt;name&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;_xlnm._FilterDatabase&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: red;"&gt;localSheetId&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;0&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: red;"&gt;hidden&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;1&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;'Code magasins doublons'!$A$7:$F$21&lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;definedName&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
  &lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;definedNames&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
  &lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;calcPr&lt;/span&gt; &lt;span style="color: red;"&gt;calcId&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;0&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;/&amp;gt;&lt;/span&gt;
  &lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;fileRecoveryPr&lt;/span&gt; &lt;span style="color: red;"&gt;repairLoad&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;1&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;/&amp;gt;&lt;/span&gt;
&lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;workbook&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;/span&gt;Anf finally the VB code that produces the file :&lt;/pre&gt;
&lt;pre&gt;&lt;div style="color: black; background-color: white;"&gt;&lt;pre&gt; &lt;span style="color: blue;"&gt;Public&lt;/span&gt; &lt;span style="color: blue;"&gt;Function&lt;/span&gt; export(&lt;span style="color: blue;"&gt;ByVal&lt;/span&gt; firstRow &lt;span style="color: blue;"&gt;As&lt;/span&gt; &lt;span style="color: blue;"&gt;Integer&lt;/span&gt;, &lt;span style="color: blue;"&gt;ByVal&lt;/span&gt; lastColMin &lt;span style="color: blue;"&gt;As&lt;/span&gt; &lt;span style="color: blue;"&gt;Integer&lt;/span&gt;, &lt;span style="color: blue;"&gt;ByVal&lt;/span&gt; logo &lt;span style="color: blue;"&gt;As&lt;/span&gt; FileInfo, &lt;span style="color: blue;"&gt;ByVal&lt;/span&gt; logoSize &lt;span style="color: blue;"&gt;As&lt;/span&gt; &lt;span style="color: blue;"&gt;Integer&lt;/span&gt;) &lt;span style="color: blue;"&gt;As&lt;/span&gt; &lt;span style="color: blue;"&gt;String&lt;/span&gt;

        &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; fi &lt;span style="color: blue;"&gt;As&lt;/span&gt; &lt;span style="color: blue;"&gt;New&lt;/span&gt; FileInfo(&lt;span style="color: blue;"&gt;Me&lt;/span&gt;.dir &amp;amp; &lt;span style="color: rgb(163, 21, 21);"&gt;"\"&lt;/span&gt; &amp;amp; &lt;span style="color: blue;"&gt;Me&lt;/span&gt;.fileName)

        &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; lastCol &lt;span style="color: blue;"&gt;As&lt;/span&gt; &lt;span style="color: blue;"&gt;Integer&lt;/span&gt;

        &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; pck &lt;span style="color: blue;"&gt;As&lt;/span&gt; &lt;span style="color: blue;"&gt;New&lt;/span&gt; ExcelPackage(fi)

        &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; i &lt;span style="color: blue;"&gt;As&lt;/span&gt; &lt;span style="color: blue;"&gt;Integer&lt;/span&gt; = firstRow
        &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; k &lt;span style="color: blue;"&gt;As&lt;/span&gt; &lt;span style="color: blue;"&gt;Integer&lt;/span&gt; = 1

        &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; r &lt;span style="color: blue;"&gt;As&lt;/span&gt; rapport = &lt;span style="color: blue;"&gt;DirectCast&lt;/span&gt;(&lt;span style="color: blue;"&gt;Me&lt;/span&gt;.source, rapport)

        r.loadOnglets()

        &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; dt &lt;span style="color: blue;"&gt;As&lt;/span&gt; DataTable
        &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; ws &lt;span style="color: blue;"&gt;As&lt;/span&gt; ExcelWorksheet

        &lt;span style="color: blue;"&gt;For&lt;/span&gt; &lt;span style="color: blue;"&gt;Each&lt;/span&gt; o &lt;span style="color: blue;"&gt;As&lt;/span&gt; ongletRapport &lt;span style="color: blue;"&gt;In&lt;/span&gt; r.onglets

            ws = pck.Workbook.Worksheets.Add(HttpContext.GetGlobalResourceObject(&lt;span style="color: blue;"&gt;Me&lt;/span&gt;.resourcePrefix, o.TITRE &amp;amp; &lt;span style="color: rgb(163, 21, 21);"&gt;"ABG"&lt;/span&gt;))

            ws.Drawings.AddPicture(o.TITRE &amp;amp; &lt;span style="color: rgb(163, 21, 21);"&gt;"_logo"&lt;/span&gt;, logo)
            ws.Drawings(o.TITRE &amp;amp; &lt;span style="color: rgb(163, 21, 21);"&gt;"_logo"&lt;/span&gt;).SetPosition(0, 0)
            ws.Drawings(o.TITRE &amp;amp; &lt;span style="color: rgb(163, 21, 21);"&gt;"_logo"&lt;/span&gt;).SetSize(logoSize)

            k = 1
            i = firstRow + 2

            dt = o.getData(r.parametres)

            &lt;span style="color: blue;"&gt;For&lt;/span&gt; &lt;span style="color: blue;"&gt;Each&lt;/span&gt; c &lt;span style="color: blue;"&gt;As&lt;/span&gt; DataColumn &lt;span style="color: blue;"&gt;In&lt;/span&gt; dt.Columns

                ws.Cells(i, k).Value = HttpContext.GetGlobalResourceObject(&lt;span style="color: blue;"&gt;Me&lt;/span&gt;.resourcePrefix, c.ColumnName)
                ws.Cells(i, k).Style.Font.Bold = &lt;span style="color: blue;"&gt;True&lt;/span&gt;

                lastCol = k

                k += 1

            &lt;span style="color: blue;"&gt;Next&lt;/span&gt; c

            i += 1

            &lt;span style="color: blue;"&gt;For&lt;/span&gt; &lt;span style="color: blue;"&gt;Each&lt;/span&gt; row &lt;span style="color: blue;"&gt;As&lt;/span&gt; DataRow &lt;span style="color: blue;"&gt;In&lt;/span&gt; dt.Rows

                k = 1

                &lt;span style="color: blue;"&gt;For&lt;/span&gt; &lt;span style="color: blue;"&gt;Each&lt;/span&gt; c &lt;span style="color: blue;"&gt;As&lt;/span&gt; DataColumn &lt;span style="color: blue;"&gt;In&lt;/span&gt; dt.Columns

                    ws.Cells(i, k).Value = row(c.ColumnName)

                    k += 1

                &lt;span style="color: blue;"&gt;Next&lt;/span&gt; c

                i += 1

            &lt;span style="color: blue;"&gt;Next&lt;/span&gt; row

            ws.Cells(getColIndex(1) &amp;amp; (firstRow + 2).ToString() &amp;amp; &lt;span style="color: rgb(163, 21, 21);"&gt;":"&lt;/span&gt; &amp;amp; getColIndex(lastCol) &amp;amp; (i - 1).ToString()).AutoFilter = &lt;span style="color: blue;"&gt;True&lt;/span&gt;

            &lt;span style="color: blue;"&gt;If&lt;/span&gt; lastCol &amp;lt; lastColMin &lt;span style="color: blue;"&gt;Then&lt;/span&gt;

                lastCol = lastColMin

            &lt;span style="color: blue;"&gt;End&lt;/span&gt; &lt;span style="color: blue;"&gt;If&lt;/span&gt;

            &lt;span style="color: blue;"&gt;For&lt;/span&gt; j &lt;span style="color: blue;"&gt;As&lt;/span&gt; &lt;span style="color: blue;"&gt;Integer&lt;/span&gt; = 1 &lt;span style="color: blue;"&gt;To&lt;/span&gt; lastCol

                ws.Column(j).AutoFit()

            &lt;span style="color: blue;"&gt;Next&lt;/span&gt;

            ws.View.FreezePanes(firstRow + 3, lastCol + 1)

        &lt;span style="color: blue;"&gt;Next&lt;/span&gt; o

        pck.Save()

        pck.Dispose()

        &lt;span style="color: blue;"&gt;Return&lt;/span&gt; pck.File.FullName

    &lt;span style="color: blue;"&gt;End&lt;/span&gt; &lt;span style="color: blue;"&gt;Function&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
Is this a bug or am I doing something wrong ? Any help would be greatly appreciated !&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Coloring Pivot table dataField">
      <Posts>
        <Post From="Bhanu1423" When="21/12/2012 10:34:58">
          <Html>
        
&lt;p&gt;//A1:G6 is the range where my pivot table is located&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;ExcelAddress cell=new ExcelAddress("A1:G6");&lt;/p&gt;
&lt;p&gt;&amp;nbsp; pt.WorkSheet.ConditionalFormatting.AddTwoColorScale(cell);&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;//when i apply this colring is given to only row fields and column fields, but not to data fileds... can, any one can help me in this&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Automatically sorting the column and surrounding columns">
      <Posts>
        <Post From="chrbut2435" When="28/08/2012 22:56:10">
          <Html>
        
&lt;p&gt;I have 6 columns, A-F, I need to sort these in ascending order based on column F. I can't find a sort function anywhere in the examples so either I'm overlooking it or something. Help is appricated&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="29/08/2012 12:44:29">
          <Html>
        
&lt;p&gt;I'm pretty sure only with pivot table you can sort columns, but you can sort your collection programmatically using linq ( or another sort method ). Another option, maybe it is using a template file or do it with vba code.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Kyopaxa" When="01/11/2012 19:03:04">
          <Html>
        
&lt;p&gt;Are there any thoughts of adding the possibility to set the sort for different columns when AutoFilter is ON? That feature would be very welcome by me.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mateuszef" When="06/12/2012 09:52:04">
          <Html>
        
&lt;p&gt;I am also interested in it. Is it possible to use sorting within one column? When I click on filters in Excel spreadsheet then there are options to sort it from largest to smallest values and vice versa.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Regards,&lt;/p&gt;
&lt;p&gt;Mateusz&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="tednyberg" When="20/12/2012 09:51:44">
          <Html>
        
&lt;p&gt;I've added a &lt;a href="http://epplus.codeplex.com/workitem/14791" rel="nofollow"&gt;feature request
&lt;/a&gt;for sorting by column, please vote for it if you think it's important.&lt;/p&gt;
&lt;p&gt;&lt;a href="http://epplus.codeplex.com/workitem/14791" rel="nofollow"&gt;http://epplus.codeplex.com/workitem/14791&lt;/a&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="xav2075" When="21/12/2012 06:41:30">
          <Html>
        
&lt;p&gt;My approach is to organize the data first into a DataTable that has the layout&amp;nbsp; I want.&amp;nbsp; Then to import it into&amp;nbsp; a worksheet using&amp;nbsp; .LoadFromDataTable method.&amp;nbsp; The neat thing with DataTables is that if you are working with data from
 SQL Server or MySQL you can do a SQL Select and shovel the whole SQL query result into a DataTable with one line of code using a SqlDataReader (SQL Server) or MySqlDataReader (MySQL).&amp;nbsp; This way you use the flexibility of C# to get and organize the data
 how you want it and are less reliant on epplus.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="TextDirection in cell">
      <Posts>
        <Post From="shayshal" When="17/12/2012 09:41:26">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Is there a way to change the text direction for a cell to RTL?&lt;/p&gt;
&lt;p&gt;The default is 'context' and it is working ok, as much as I can see, but is there a way to control the value for text direction (between LTR, RTL)?&lt;/p&gt;
&lt;p&gt;many thanks.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Mateuszef" When="19/12/2012 12:32:15">
          <Html>
        
&lt;p&gt;Use&amp;nbsp; TextRotation Property of Style to set particular angle.&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;using&lt;/span&gt; (ExcelRange verticalTitle = a_worksheet.Cells[fromRow,1,toRow,1])
            {
                verticalTitle.Merge = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
                verticalTitle.Style.Font.Size = 18;
                verticalTitle.Style.Font.Bold = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
                verticalTitle.Style.Fill.PatternType = OfficeOpenXml.Style.ExcelFillStyle.Solid;
                verticalTitle.Style.Fill.BackgroundColor.SetColor(systemColor);
                verticalTitle.Style.VerticalAlignment = ExcelVerticalAlignment.Center;
                verticalTitle.Style.HorizontalAlignment = ExcelHorizontalAlignment.Center;
                &lt;span style="color: rgb(255, 0, 0);"&gt;&lt;strong&gt;verticalTitle.Style.TextRotation = 90;&lt;/strong&gt;&lt;/span&gt;
                verticalTitle.Style.Border.BorderAround(ExcelBorderStyle.Thin);
                verticalTitle.Value = m_model.Name;
            }
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;One thing to notice is the fact that alignment has to be made before setting TextRotation. I don't know why this dependency exists it might be a bug, but it exists. So, first set alignment if needed and then set TextRotation.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="shayshal" When="19/12/2012 15:31:34">
          <Html>
        
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks for the answer, but I'm not looking for text rotation. I'm looking for text direction, like in Hebrew, when the text goes from right-to-left, instead of the default left-to-right.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Mateuszef" When="20/12/2012 11:50:43">
          <Html>
        
&lt;p&gt;So, there are two threads which you might be interested in.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;using&lt;/span&gt; (ExcelRange someRange = a_worksheet.Cells[fromRow,fromCol,toRow,toCol])
{
someRange.Style.ReadingOrder = ExcelReadingOrder.RightToLeft;
}
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;a title="ReadingOrder Property" href="http://epplus.codeplex.com/workitem/14527" target="_blank" rel="nofollow"&gt;http://epplus.codeplex.com/workitem/14527&lt;/a&gt; &amp;lt;--&amp;nbsp; (above mentioned seems to not work properly however you might check it by yourself)&lt;/p&gt;
&lt;p&gt;You may also be interested in changing layout to RightToLeft which will cause that&amp;nbsp; CELLS numeration will start from right upper corner.&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;a_worksheet.View.RightToLeft = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;a title="ExcelWorksheetView.RightToLeft Property" href="https://epplus.codeplex.com/discussions/220543" target="_blank" rel="nofollow"&gt;https://epplus.codeplex.com/discussions/220543&lt;/a&gt; &amp;lt;-- This one works well.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Regards,&lt;/p&gt;
&lt;p&gt;Mateusz&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="shayshal" When="20/12/2012 13:03:23">
          <Html>
        
&lt;p&gt;Thanks. The first example is exactly what I was looking for.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Mateuszef" When="20/12/2012 15:03:48">
          <Html>
        
&lt;p&gt;btw, does it work for you ?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="shayshal" When="20/12/2012 15:28:53">
          <Html>
        
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Yes, I forgot to mention.&lt;/p&gt;
&lt;p&gt;someRange.Style.ReadingOrder = ExcelReadingOrder.RightToLeft;&lt;/p&gt;
&lt;p&gt;This property works fine.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Mateuszef" When="20/12/2012 17:14:46">
          <Html>
        
&lt;p&gt;Strange, because it didnt work for me.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Getting Out of memory Exception for more than 2 lakh Records.....what's the Maximum number of Records EPPLUS  3.1.2 supports????">
      <Posts>
        <Post From="SunilBabu" When="18/12/2012 05:08:51">
          <Html>
        
&lt;p&gt;Hi ,&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp; I'm using EPPLus 3.1.2 to create Microsoft Excel document from Data table in a ASP.NET Web Application.Actually Data table contains more than 5lakh records with 15 columns ......So , is it possible to create Excel using EPPLus 3.1.2 library
 for 5 lakh records...??&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Actually if i try to generate a excel for more than 2 lakh records i'm getting Out of memory Exception....How can i solve this problem.....Please do reply ASAP.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks,&lt;/p&gt;
&lt;p&gt;SunilBabu&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Can an Shape (line) be added to a Chart (yet)?">
      <Posts>
        <Post From="seddleman" When="16/12/2012 20:42:19">
          <Html>
        
&lt;p&gt;I'd like to draw a scatter chart and then put a horizontal line showing the average using epplus.&lt;/p&gt;
&lt;p&gt;I've not seen it done yet, and not sure if it's possible. &amp;nbsp;Can it be done?&lt;/p&gt;
&lt;p&gt;Thanks, Stephen&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="xav2075" When="17/12/2012 04:57:24">
          <Html>
        
&lt;pre&gt;Here is an example that adds a average\trendline to a scatter chart:-&lt;/pre&gt;
&lt;pre&gt;      FileInfo excel_new_file = new FileInfo("C:\\test1.xlsx");&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ExcelPackage excel_package = new ExcelPackage(excel_new_file)&lt;br&gt;      ExcelWorksheet excel_worksheet = excel_package.Workbook.Worksheets.Add("Scatter Chart");&lt;br&gt;      excel_worksheet.Cells["A1"].Value = "Daily Rainfall";
      excel_worksheet.Cells["B1"].Value = "Particulate";
      excel_worksheet.Cells["A2"].Value = 4.2; excel_worksheet.Cells["B2"].Value = 122;
      excel_worksheet.Cells["A3"].Value = 4.3; excel_worksheet.Cells["B3"].Value = 117;
      excel_worksheet.Cells["A4"].Value = 5.7; excel_worksheet.Cells["B4"].Value = 112;
      excel_worksheet.Cells["A5"].Value = 5.4; excel_worksheet.Cells["B5"].Value = 114;
      excel_worksheet.Cells["A6"].Value = 5.9; excel_worksheet.Cells["B6"].Value = 110;
      excel_worksheet.Cells["A7"].Value = 5.0; excel_worksheet.Cells["B7"].Value = 114;
      excel_worksheet.Cells["A8"].Value = 3.6; excel_worksheet.Cells["B8"].Value = 128;
      excel_worksheet.Cells["A9"].Value = 1.9; excel_worksheet.Cells["B9"].Value = 137;
      excel_worksheet.Cells["A10"].Value = 7.3; excel_worksheet.Cells["B10"].Value = 104;
      excel_worksheet.Cells["A1:B12"].AutoFitColumns(); 
      var scatter_chart = (excel_worksheet.Drawings.AddChart("scatter chart", eChartType.XYScatter) as ExcelScatterChart);
      scatter_chart.Title.Text = "Particulate Levels In Rainfall";
      scatter_chart.SetPosition(0, 200);
      scatter_chart.SetSize(800, 400);
      scatter_chart.Series.Add(excel_worksheet.Cells["B2:B10"], excel_worksheet.Cells["A2:A10"]);
      scatter_chart.Series[0].TrendLines.Add(eTrendLine.Linear);&lt;br&gt;      excel_package.Save();&lt;/pre&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="2 worksheets">
      <Posts>
        <Post From="pradeepbhat92" When="13/12/2012 17:22:59">
          <Html>
        
&lt;p&gt;So here is my code&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;div style="color: black; background-color: white;"&gt;&lt;pre&gt;Using package As New ExcelPackage(newFile)
            ' add a new worksheet to the empty workbook
            Dim worksheet As ExcelWorksheet = package.Workbook.Worksheets.Add("Analysis")
            Dim worksheet2 As ExcelWorksheet = package.Workbook.Worksheets.Add("Data")
            'Add the headers
            worksheet.Cells(1, 2).Value = "Key Performance Indicators"
            worksheet.Cells(1, 6).Value = MWHtotal &amp;amp; "MW Hours"
            worksheet.Cells(2, 3).Value = "Before Deslag"
            worksheet.Cells(2, 4).Value = "After Deslag"
            worksheet.Cells(2, 5).Value = "Percent Change"
            worksheet.Cells(2, 2).Value = aunit
            worksheet.Cells(2, 6).Value = auser &amp;amp; " analysis"

            worksheet.Cells(3, 2).Value = "Primary SuperHeat Draft Loss"
            worksheet.Cells(4, 2).Value = "Primary SuperHeat Draft Loss Rate"
            worksheet.Cells(5, 2).Value = "Zolo FEGT"
            worksheet.Cells(6, 2).Value = "Max Ramp Rate"
            worksheet.Cells(7, 2).Value = "Max Load"
            worksheet.Cells(8, 2).Value = "Throttle Set Pressure"
            worksheet.Cells(9, 2).Value = "Water Wall Cleanliness"
            worksheet.Cells(10, 2).Value = "Platen SH Cleanliness"
            worksheet.Cells(11, 2).Value = "SSH Cleanliness"
            worksheet.Cells(12, 2).Value = "SSH Delta Temp"
            worksheet.Cells(13, 2).Value = "Primary SH Cleanliness"
            worksheet.Cells(14, 2).Value = "SHT Attemp"
            worksheet.Cells(15, 2).Value = "DP Across SSH"
            worksheet.Cells(16, 2).Value = "RH Cleanliness"
            worksheet.Cells(17, 2).Value = "RH Delta Temp"
            worksheet.Cells(18, 2).Value = "RH Attemp"
            worksheet.Cells(19, 2).Value = "DP Across RH"
            worksheet.Cells(20, 2).Value = "Boiler Efficiency"
            worksheet.Cells(21, 2).Value = "Reheat Gas Temp(Above Horiz Reheater Grid)"
            worksheet.Cells(22, 2).Value = "Econ Gas Outlet Temp"
            worksheet.Cells(23, 2).Value = "Furnace Exit Gas Temp"
            worksheet.Cells(24, 2).Value = "East FEGT"
            worksheet.Cells(25, 2).Value = "West FEGT"
            worksheet.Cells(26, 2).Value = "Secondary SuperHeat Draft Loss"
            worksheet.Cells(27, 2).Value = "Vertical ReHeat Cleanliness Factor"
            worksheet.Cells(28, 2).Value = "Air Heat Gas Outlet Temp"
            worksheet.Cells(29, 2).Value = "Total Air Flow"
            worksheet.Cells(30, 2).Value = "MW"
            worksheet.Cells(3, 6).Value = "H2O"
            worksheet.Cells(4, 6).Value = "H2O/Min"
            worksheet.Cells(5, 6).Value = "Deg F"
            worksheet.Cells(6, 6).Value = "MW/Min"
            worksheet.Cells(7, 6).Value = "MW"
            worksheet.Cells(8, 6).Value = "Psig"
            worksheet.Cells(9, 6).Value = "Percent"
            worksheet.Cells(10, 6).Value = "Percent"
            worksheet.Cells(11, 6).Value = "Percent"
            worksheet.Cells(12, 6).Value = "Deg F"
            worksheet.Cells(13, 6).Value = "Percent"
            worksheet.Cells(14, 6).Value = "lb/hr"
            worksheet.Cells(15, 6).Value = "H2O"
            worksheet.Cells(16, 6).Value = "Percent"
            worksheet.Cells(17, 6).Value = "Deg F"
            worksheet.Cells(18, 6).Value = "lb/hr"
            worksheet.Cells(19, 6).Value = "H2O"
            worksheet.Cells(20, 6).Value = "Percent"
            worksheet.Cells(21, 6).Value = "Deg F"
            worksheet.Cells(22, 6).Value = "Deg F"
            worksheet.Cells(23, 6).Value = "Deg F"
            worksheet.Cells(24, 6).Value = "Deg F"
            worksheet.Cells(25, 6).Value = "Deg F"
            worksheet.Cells(26, 6).Value = "H2O"
            worksheet.Cells(27, 6).Value = "Percent"
            worksheet.Cells(28, 6).Value = "Deg F"
            worksheet.Cells(29, 6).Value = "KPPH"
            worksheet.Cells(30, 6).Value = "MW"
            arraycol = 0
            arrayrow = 0
            For i = 0 To pdata.Count
                worksheet2.Cells(arrayrow + 1, arraycol + 1).Value = PIArray(arrayrow, arraycol)
            Next

            worksheet.Cells(3, 3).Value = wa
            worksheet.Cells(4, 3).Value = za
            worksheet.Cells(5, 3).Value = ua
            worksheet.Cells(6, 3).Value = amaxrate
            worksheet.Cells(7, 3).Value = amax
            worksheet.Cells(8, 3).Value = ta
            worksheet.Cells(9, 3).Value = aa
            worksheet.Cells(10, 3).Value = ba
            worksheet.Cells(11, 3).Value = ca
            worksheet.Cells(12, 3).Value = da
            worksheet.Cells(13, 3).Value = ea
            worksheet.Cells(14, 3).Value = fa
            worksheet.Cells(15, 3).Value = ga
            worksheet.Cells(16, 3).Value = ha
            worksheet.Cells(17, 3).Value = ia
            worksheet.Cells(18, 3).Value = ja
            worksheet.Cells(19, 3).Value = ka
            worksheet.Cells(20, 3).Value = la
            worksheet.Cells(21, 3).Value = ma
            worksheet.Cells(22, 3).Value = na
            worksheet.Cells(23, 3).Value = oa
            worksheet.Cells(24, 3).Value = qa
            worksheet.Cells(25, 3).Value = ra
            worksheet.Cells(26, 3).Value = xa
            worksheet.Cells(27, 3).Value = ya
            worksheet.Cells(28, 3).Value = pa
            worksheet.Cells(29, 3).Value = sa
            worksheet.Cells(30, 3).Value = va
            worksheet.Cells(3, 4).Value = wb
            worksheet.Cells(4, 4).Value = zb
            worksheet.Cells(5, 4).Value = ub
            worksheet.Cells(9, 4).Value = ab
            worksheet.Cells(10, 4).Value = bb
            worksheet.Cells(11, 4).Value = cb
            worksheet.Cells(12, 4).Value = db
            worksheet.Cells(13, 4).Value = eb
            worksheet.Cells(14, 4).Value = fb
            worksheet.Cells(15, 4).Value = gb
            worksheet.Cells(16, 4).Value = hb
            worksheet.Cells(17, 4).Value = ib
            worksheet.Cells(18, 4).Value = jb
            worksheet.Cells(19, 4).Value = kb
            worksheet.Cells(20, 4).Value = lb
            worksheet.Cells(21, 4).Value = mb
            worksheet.Cells(22, 4).Value = nb
            worksheet.Cells(23, 4).Value = ob
            worksheet.Cells(24, 4).Value = qb
            worksheet.Cells(25, 4).Value = rb
            worksheet.Cells(26, 4).Value = xb
            worksheet.Cells(27, 4).Value = yb
            worksheet.Cells(28, 4).Value = pb
            worksheet.Cells(29, 4).Value = sb
            worksheet.Cells(30, 4).Value = vb
            worksheet.Cells(3, 5).Value = wpercent
            worksheet.Cells(4, 5).Value = zpercent
            worksheet.Cells(5, 5).Value = upercent
            worksheet.Cells(9, 5).Value = apercent
            worksheet.Cells(10, 5).Value = bpercent
            worksheet.Cells(11, 5).Value = cpercent
            worksheet.Cells(12, 5).Value = dpercent
            worksheet.Cells(13, 5).Value = epercent
            worksheet.Cells(14, 5).Value = fpercent
            worksheet.Cells(15, 5).Value = gpercent
            worksheet.Cells(16, 5).Value = hpercent
            worksheet.Cells(17, 5).Value = ipercent
            worksheet.Cells(18, 5).Value = jpercent
            worksheet.Cells(19, 5).Value = kpercent
            worksheet.Cells(20, 5).Value = lpercent
            worksheet.Cells(21, 5).Value = mpercent
            worksheet.Cells(22, 5).Value = npercent
            worksheet.Cells(23, 5).Value = opercent
            worksheet.Cells(24, 5).Value = qpercent
            worksheet.Cells(25, 5).Value = rpercent
            worksheet.Cells(26, 5).Value = xpercent
            worksheet.Cells(27, 5).Value = ypercent
            worksheet.Cells(28, 5).Value = ppercent
            worksheet.Cells(29, 5).Value = spercent
            worksheet.Cells(30, 5).Value = vpercent
            worksheet.Cells(3, 7).Value = wcolor
            worksheet.Cells(4, 7).Value = zcolor
            worksheet.Cells(5, 7).Value = ucolor
            worksheet.Cells(9, 7).Value = acolor
            worksheet.Cells(10, 7).Value = bcolor
            worksheet.Cells(11, 7).Value = ccolor
            worksheet.Cells(12, 7).Value = dcolor
            worksheet.Cells(13, 7).Value = ecolor
            worksheet.Cells(14, 7).Value = fcolor
            worksheet.Cells(15, 7).Value = gcolor
            worksheet.Cells(16, 7).Value = hcolor
            worksheet.Cells(17, 7).Value = icolor
            worksheet.Cells(18, 7).Value = jcolor
            worksheet.Cells(19, 7).Value = kcolor
            worksheet.Cells(20, 7).Value = lcolor
            worksheet.Cells(21, 7).Value = mcolor
            worksheet.Cells(22, 7).Value = ncolor
            worksheet.Cells(23, 7).Value = ocolor
            worksheet.Cells(24, 7).Value = qcolor
            worksheet.Cells(25, 7).Value = rcolor
            worksheet.Cells(26, 7).Value = xcolor
            worksheet.Cells(27, 7).Value = ycolor
            worksheet.Cells(28, 7).Value = pcolor
            worksheet.Cells(29, 7).Value = scolor
            worksheet.Cells(30, 7).Value = vcolor

            Response.Clear()

            Response.ContentType = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"
            Response.AppendHeader("Content-Disposition", "attachment;filename=analyze.xlsx")
            package.SaveAs(Response.OutputStream)

            Response.End()
        End Using
&lt;/pre&gt;
&lt;/div&gt;
&lt;div style="color: black; background-color: white;"&gt;&lt;/div&gt;
&lt;div style="color: black; background-color: white;"&gt;I get this error&lt;/div&gt;
&lt;div style="color: black; background-color: white;"&gt;&lt;/div&gt;
&lt;div style="color: black; background-color: white;"&gt;0x800a139e - Microsoft JScript runtime error: Sys.WebForms.PageRequestManagerParserErrorException: The message received from the server could not be parsed.&lt;/div&gt;
&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="xav2075" When="14/12/2012 07:20:04">
          <Html>
        
&lt;p&gt;I suggest using google.com and stackoverflow.com for tracking down what causes errors.&amp;nbsp; I do not know how the error
&lt;strong&gt;0x800a139e - Microsoft JScript runtime error: Sys.WebForms.PageRequestManagerParserErrorException: The message received from the server could not be parsed
&lt;/strong&gt;relates to the code fragment you have posted.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Setting a consistent row height/column width?">
      <Posts>
        <Post From="jburkett" When="13/12/2012 17:22:26">
          <Html>
        
&lt;p&gt;I assumed that the following would set the row and column dimensions:&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;            worksheet.Column(1).Width = 20;
            worksheet.Column(2).Width = 20;
            worksheet.Column(3).Width = 10;
            worksheet.Column(4).Width = 25;
            worksheet.Column(5).Width = 25;
            worksheet.DefaultRowHeight = 15;
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Instead, my rows are coming out as height of 10, and the columns are smaller than what I've set. What am I doing wrong?&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Complex issue Problem with IsolatedStorage while downloading Excel">
      <Posts>
        <Post From="mad2064" When="10/12/2012 07:22:49">
          <Html>
        
&lt;p&gt;Hi&lt;/p&gt;
&lt;p&gt;We have hosted our website on two severs U1 and P1.&lt;/p&gt;
&lt;p&gt;We are able to generate excel of more than 35MB on U1 and also few other excels on P1.&lt;/p&gt;
&lt;p&gt;We have a problem with generating saving our excel data. This only happens with some queries, but not with others. And it works perfectly in U1.&lt;/p&gt;
&lt;p&gt;&lt;span&gt;Does anyone have any idea what we can do to get around this?&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;h2&gt;&lt;em&gt;Unable to create the store directory. (Exception from HRESULT: 0x80131468)&lt;/em&gt;&lt;/h2&gt;
&lt;span style="font-family: Arial,Helvetica,Geneva,SunSans-Regular,sans-serif;"&gt;&lt;strong&gt;Description:&amp;nbsp;&lt;/strong&gt;An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the
 error and where it originated in the code.&amp;nbsp;&lt;br&gt;
&lt;br&gt;
&lt;strong&gt;Exception Details:&amp;nbsp;&lt;/strong&gt;System.IO.IsolatedStorage.IsolatedStorageException: Unable to create the store directory. (Exception from HRESULT: 0x80131468)&lt;br&gt;
&lt;br&gt;
&lt;strong&gt;Source Error:&lt;/strong&gt;&amp;nbsp;&lt;br&gt;
&lt;br&gt;
&lt;/span&gt;
&lt;p&gt;&lt;/p&gt;
&lt;table width="100%" bgcolor="#ffffcc"&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;An unhandled exception was generated during the execution of the current web request. Information regarding the origin and location of the exception can be identified using the exception stack trace below.&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;span style="font-family: Arial,Helvetica,Geneva,SunSans-Regular,sans-serif;"&gt;&lt;br&gt;
&lt;strong&gt;Stack Trace:&lt;/strong&gt;&amp;nbsp;&lt;br&gt;
&lt;br&gt;
&lt;/span&gt;&lt;/p&gt;
&lt;table width="100%" bgcolor="#ffffcc"&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;
&lt;pre&gt;[IsolatedStorageException: Unable to create the store directory. (Exception from HRESULT: 0x80131468)]
   System.IO.IsolatedStorage.IsolatedStorageFile.GetRootDir(IsolatedStorageScope scope, StringHandleOnStack retRootDir) +0
   System.IO.IsolatedStorage.IsolatedStorageFile.InitGlobalsNonRoamingUser(IsolatedStorageScope scope) +148
   System.IO.IsolatedStorage.IsolatedStorageFile.GetRootDir(IsolatedStorageScope scope) +229
   System.IO.IsolatedStorage.IsolatedStorageFile.GetGlobalFileIOPerm(IsolatedStorageScope scope) +213
   System.IO.IsolatedStorage.IsolatedStorageFile.Init(IsolatedStorageScope scope) +53
   System.IO.IsolatedStorage.IsolatedStorageFile.GetStore(IsolatedStorageScope scope, Type domainEvidenceType, Type assemblyEvidenceType) +68
   MS.Internal.IO.Packaging.ReliableIsolatedStorageFileFolder.GetCurrentStore() +34
   MS.Internal.IO.Packaging.ReliableIsolatedStorageFileFolder..ctor() +64
   MS.Internal.IO.Packaging.PackagingUtilities.GetDefaultIsolatedStorageFile() +54
   MS.Internal.IO.Packaging.PackagingUtilities.CreateUserScopedIsolatedStorageFileStreamWithRandomName(Int32 retryCount, String&amp;amp; fileName) +122
   MS.Internal.IO.Packaging.SparseMemoryStream.SwitchModeIfNecessary() +373
   MS.Internal.IO.Packaging.SparseMemoryStream.Write(Byte[] buffer, Int32 offset, Int32 count) +189
   MS.Internal.IO.Packaging.CompressEmulationStream.Write(Byte[] buffer, Int32 offset, Int32 count) +60
   MS.Internal.IO.Packaging.CompressStream.Write(Byte[] buffer, Int32 offset, Int32 count) +138
   MS.Internal.IO.Zip.ProgressiveCrcCalculatingStream.Write(Byte[] buffer, Int32 offset, Int32 count) +170
   MS.Internal.IO.Zip.ZipIOModeEnforcingStream.Write(Byte[] buffer, Int32 offset, Int32 count) +86
   System.IO.StreamWriter.Flush(Boolean flushStream, Boolean flushEncoder) +98
   System.IO.StreamWriter.Write(String value) +109
   System.IO.TextWriter.Write(String format, Object arg0) +76
   OfficeOpenXml.ExcelWorksheet.UpdateRowCellData(StreamWriter sw) +6265
   OfficeOpenXml.ExcelWorksheet.SaveXml() +537
   OfficeOpenXml.ExcelWorksheet.Save() +217
   OfficeOpenXml.ExcelWorkbook.Save() +472
   OfficeOpenXml.ExcelPackage.GetAsByteArray(Boolean save) +34
   ACTagging.Admin.DumpExcel(DataTable tbl, String filename, String sheetname) in C:\Users\PSivaShankar\Desktop\DIR Mapping  - V2\ACTagging\Admin.aspx.cs:183
   ACTagging.Admin.BtnExcelReportAdmin_Click(Object sender, CommandEventArgs e) in C:\Users\PSivaShankar\Desktop\DIR Mapping  - V2\ACTagging\Admin.aspx.cs:139
   System.Web.UI.WebControls.Button.OnCommand(CommandEventArgs e) +115
   System.Web.UI.WebControls.Button.RaisePostBackEvent(String eventArgument) +167
   System.Web.UI.WebControls.Button.System.Web.UI.IPostBackEventHandler.RaisePostBackEvent(String eventArgument) +10
   System.Web.UI.Page.RaisePostBackEvent(IPostBackEventHandler sourceControl, String eventArgument) +13
   System.Web.UI.Page.RaisePostBackEvent(NameValueCollection postData) +36
   System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +5563&lt;/pre&gt;
&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;span style="font-family: Arial,Helvetica,Geneva,SunSans-Regular,sans-serif;"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;br&gt;
&lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="swmal" When="11/12/2012 19:17:58">
          <Html>
        
&lt;p&gt;There is an issue with large files, IIS and isolated storage. A solution is on the way - the next release will not utlize system.io.packaging (which in its turn uses isolated storage) - but I cannot say when that release will be.&lt;/p&gt;
&lt;p&gt;It has been discussed before in this thread: http://epplus.codeplex.com/discussions/215730&lt;/p&gt;
&lt;p&gt;Regards, Mats&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mad2064" When="12/12/2012 07:46:22">
          <Html>
        
&lt;p&gt;Hi Swmal,&lt;/p&gt;
&lt;p&gt;We are able&amp;nbsp;download&amp;nbsp;&amp;nbsp;35MB of file in&amp;nbsp;&lt;span&gt;U1 sever but same file is causing error in P1 sever and one more thing in P1 sever we are able to donwload other excel files.&lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Cartman1333" When="12/12/2012 20:51:15">
          <Html>
        
&lt;p&gt;I have the same exception with eeplus.&lt;br&gt;
When i try do write a large excel file (~of over 5MB), it's not possible to save the result :
&lt;span style="font-family: Arial,Helvetica,Geneva,SunSans-Regular,sans-serif;"&gt;IsolatedStorageException.&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;How it's possible to fix that ?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="12/12/2012 21:55:41">
          <Html>
        
&lt;p&gt;there are two way to fix this:&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;1)&amp;nbsp;&lt;span&gt;add the folder and set the permission as described here &amp;gt;&amp;nbsp;http://labs.episerver.com/en/Blogs/Svante-Seleborg/Dates/2008/10/IsolatedStorage-Access-Denied/&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;2) try the new (beta) version with DotNetZip instead IO.Packaging &amp;gt;&amp;nbsp;&lt;a href="http://epplus.codeplex.com/SourceControl/changeset/view/af16b68ec2e5" rel="nofollow"&gt;http://epplus.codeplex.com/SourceControl/changeset/view/af16b68ec2e5&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="test.xlsx couldn't be downloaded - EPPlus">
      <Posts>
        <Post From="mailarama" When="11/12/2012 18:03:09">
          <Html>
        
&lt;p&gt;When I try to open test.xlsx created by the code below, I get "test.xlsx couldn't be downloaded". That said, if I choose to save the file, I am able to save and open the file just fine.&lt;/p&gt;
&lt;p&gt;Please let me know what I am doing wrong.&lt;/p&gt;
&lt;p&gt;Thanks!&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&lt;span&gt;    &lt;/span&gt;&lt;span&gt;Dim&lt;/span&gt;&lt;span&gt; pack &lt;/span&gt;&lt;span&gt;As&lt;/span&gt;&lt;span&gt; &lt;/span&gt;&lt;span&gt;New&lt;/span&gt;&lt;span&gt; ExcelPackage
    &lt;/span&gt;&lt;span&gt;Dim&lt;/span&gt;&lt;span&gt; ws &lt;/span&gt;&lt;span&gt;As&lt;/span&gt;&lt;span&gt; ExcelWorksheet &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt; pack&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;Workbook&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;Worksheets&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;Add&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span class="str"&gt;"Sheet1"&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;span&gt;
    &lt;/span&gt;&lt;span&gt;Dim&lt;/span&gt;&lt;span&gt; ms &lt;/span&gt;&lt;span&gt;As&lt;/span&gt;&lt;span&gt; &lt;/span&gt;&lt;span&gt;New&lt;/span&gt;&lt;span&gt; MemoryStream
    &lt;/span&gt;&lt;span&gt;Dim&lt;/span&gt;&lt;span&gt; dt &lt;/span&gt;&lt;span&gt;As&lt;/span&gt;&lt;span&gt; &lt;/span&gt;&lt;span&gt;New&lt;/span&gt;&lt;span&gt; DataTable

    ws&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;Cells&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;1&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt; &lt;/span&gt;&lt;span&gt;1&lt;/span&gt;&lt;span&gt;).&lt;/span&gt;&lt;span&gt;Value &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt; &lt;/span&gt;&lt;span class="str"&gt;"Test"&lt;/span&gt;&lt;span&gt;

    pack&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;SaveAs&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;ms&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;span&gt;

    ms&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;WriteTo&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;Context&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;Response&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;OutputStream&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;span&gt;

    Context&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;Response&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;Clear&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;&lt;span&gt;
    Context&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;Response&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;ContentType &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt; &lt;/span&gt;&lt;span class="str"&gt;"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"&lt;/span&gt;&lt;span&gt;
    Context&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;Response&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;AddHeader&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span class="str"&gt;"Content-Disposition"&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt; &lt;/span&gt;&lt;span class="str"&gt;"attachment;filename=test.xlsx"&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;span&gt;
    Context&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;Response&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;StatusCode &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt; &lt;/span&gt;&lt;span&gt;200&lt;/span&gt;&lt;span&gt;
    Context&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;Response&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;End&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

        
    </Html>
        </Post>
        <Post From="swmal" When="11/12/2012 19:07:35">
          <Html>
        
&lt;p&gt;It seems like you are calling Response.Clear() after you have written to the Outputstream?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mailarama" When="11/12/2012 21:26:32">
          <Html>
        
&lt;p&gt;@swmal I tried it, but it did not work.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="swmal" When="12/12/2012 18:17:25">
          <Html>
        
&lt;p&gt;In the source code there is a sample that describes how you can use EPPlus in ASP.NET (also available if you download the samples).&lt;/p&gt;
&lt;p&gt;&lt;a href="http://epplus.codeplex.com/SourceControl/changeset/view/c7f28bd90c59#EPPlusWebSample%2fGetSample.aspx.cs" rel="nofollow"&gt;http://epplus.codeplex.com/SourceControl/changeset/view/c7f28bd90c59#EPPlusWebSample%2fGetSample.aspx.cs&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;/Mats&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Is it going to work on 2013 ?">
      <Posts>
        <Post From="dnanetwork88" When="05/12/2012 14:32:38">
          <Html>
        
&lt;p&gt;Is it going to work on 2013 ? Did anyone tested yet ?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="ryanmch" When="07/12/2012 17:01:00">
          <Html>
        
&lt;p&gt;Yes, files generated by the library do work in Excel 2013&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="dnanetwork" When="11/12/2012 04:40:36">
          <Html>
        
&lt;p&gt;Thnx man.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Conditional Formatting problem">
      <Posts>
        <Post From="Mateuszef" When="10/12/2012 14:14:56">
          <Html>
        
&lt;p&gt;Hi,&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I read data from yaml files and use this data to fill sheets. From each yaml file one sheet is generated.&lt;/p&gt;
&lt;p&gt;basically it starts from iterating over files and all files which have the same group are put to the one xlsx file. Inside Generate method I format conditionally some particular columns. If xlsx file has one sheet then I have twoscale formatting from white
 to red, but when I put more than one sheet to the workbook then only one sheet uses red and white colors, other sheets use red and green. I have no idea why it works like this? Is conditional formatting not read properly? Because between populating next sheets
 I save file and open it.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;  &lt;span style="color: blue;"&gt;foreach&lt;/span&gt; (&lt;span style="color: blue;"&gt;string&lt;/span&gt; yaml_filepath &lt;span style="color: blue;"&gt;in&lt;/span&gt; GetFilesForProcessing())
            {
                &lt;span style="color: blue;"&gt;string&lt;/span&gt; output_filepath = Path.ChangeExtension(yaml_filepath, &lt;span style="color: rgb(163, 21, 21);"&gt;".xlsx"&lt;/span&gt;);

                SessionDropoutStatsModel sdsm = modelLoader.Load(yaml_filepath);
                &lt;span style="color: blue;"&gt;if&lt;/span&gt; (!groupToFilePath.ContainsKey(sdsm.Group))
                {
                    &lt;span style="color: blue;"&gt;if&lt;/span&gt; (sdsm.Group.CompareTo(&lt;span style="color: rgb(163, 21, 21);"&gt;""&lt;/span&gt;) != 0)
                    {
                        groupToFilePath.Add(sdsm.Group, output_filepath);
                        output_filepath = groupToFilePath[sdsm.Group];
                    }
                }
                &lt;span style="color: blue;"&gt;else&lt;/span&gt;
                {
                    output_filepath = groupToFilePath[sdsm.Group];
                }

                
                ConcreteExcelGenerator excelGenerator = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ConcreteExcelGenerator(sdsm, &lt;span style="color: blue;"&gt;new&lt;/span&gt; FileInfo(output_filepath));
                &lt;span style="color: rgb(255, 0, 0);"&gt;excelGenerator.Generate();
                excelGenerator.SaveAs(new System.IO.FileInfo(output_filepath));&lt;/span&gt;
                Console.WriteLine(&lt;span style="color: rgb(163, 21, 21);"&gt;"File : "&lt;/span&gt; + yaml_filepath + &lt;span style="color: rgb(163, 21, 21);"&gt;" used to fill excel file: "&lt;/span&gt; + output_filepath + &lt;span style="color: rgb(163, 21, 21);"&gt;" with data"&lt;/span&gt;);
            }
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;     &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;void&lt;/span&gt; Generate()
        {
            AddWorksheet(m_model.Name);
          &lt;span style="color: green;"&gt;//  AddWorksheet(m_model.Name + " graph");&lt;/span&gt;
            &lt;span style="color: rgb(255, 0, 0);"&gt;GenerateFirstSheet(GetWorksheet(m_model.Name))&lt;/span&gt;
           &lt;span style="color: green;"&gt;// GenerateSecondSheet(GetWorksheet(m_model.Name + " graph"));&lt;/span&gt;
        }

        &lt;span style="color: blue;"&gt;private&lt;/span&gt; &lt;span style="color: blue;"&gt;void&lt;/span&gt; GenerateFirstSheet(ExcelWorksheet a_worksheet)
        {            
            a_worksheet.View.ZoomScale = 80;
            create1Row1Sheet(a_worksheet);
            create2Row1Sheet(a_worksheet);
            create3Row1Sheet(a_worksheet);
            create4Row1Sheet(a_worksheet);
            create1Column(a_worksheet);
            createStatistics1Sheet(a_worksheet);
           &lt;span style="color: rgb(255, 0, 0);"&gt; createConditionalFormatting1Sheet(a_worksheet);&lt;/span&gt;
            createMovedToOffPoolLinks1Sheet(a_worksheet);
        }


  &lt;span style="color: green;"&gt;// Create two color scale conditional formatting for scores&lt;/span&gt;
        &lt;span style="color: blue;"&gt;private&lt;/span&gt; &lt;span style="color: blue;"&gt;void&lt;/span&gt; createConditionalFormatting1Sheet(ExcelWorksheet a_worksheet)
        {
            System.Windows.Media.Color mediaColor = (System.Windows.Media.Color)System.Windows.Media.ColorConverter.ConvertFromString(&lt;span style="color: rgb(163, 21, 21);"&gt;"#C00000"&lt;/span&gt;);
            System.Drawing.Color systemColor = System.Drawing.Color.FromArgb(mediaColor.A, mediaColor.R, mediaColor.G, mediaColor.B);

            &lt;span style="color: blue;"&gt;int&lt;/span&gt; zoneWidth = m_model.Types.Count;
            &lt;span style="color: blue;"&gt;int&lt;/span&gt; fromColumn = 4;
            &lt;span style="color: blue;"&gt;int&lt;/span&gt; fromRow = 5;
            &lt;span style="color: blue;"&gt;int&lt;/span&gt; toRow = fromRow + m_model.Data.Count -1;
            &lt;span style="color: blue;"&gt;if&lt;/span&gt; (0 == m_model.Data.Count())
                &lt;span style="color: blue;"&gt;return&lt;/span&gt;;

            &lt;span style="color: blue;"&gt;foreach&lt;/span&gt; (Title title &lt;span style="color: blue;"&gt;in&lt;/span&gt; m_model.Titles)
            {
                &lt;span style="color: blue;"&gt;foreach&lt;/span&gt; (Zone zone &lt;span style="color: blue;"&gt;in&lt;/span&gt; m_model.Zones)
                {
                    &lt;span style="color: blue;"&gt;using&lt;/span&gt; (ExcelRange scoreRange = a_worksheet.Cells[fromRow, fromColumn, toRow, fromColumn])
                    {
                        ExcelAddress rangeAddress = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelAddress(scoreRange.Address);
                        &lt;span style="color: blue;"&gt;var&lt;/span&gt; rule = a_worksheet.ConditionalFormatting.AddTwoColorScale(rangeAddress);
                       &lt;span style="color: rgb(255, 0, 0);"&gt; rule.LowValue.Type = eExcelConditionalFormattingValueObjectType.Min;
                        rule.LowValue.Color = System.Drawing.Color.White;
                        rule.HighValue.Type = eExcelConditionalFormattingValueObjectType.Max;
                        rule.HighValue.Color = systemColor;&lt;/span&gt;

                    }
                    fromColumn += zoneWidth;
                }
            }


        }

&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to set the Date Category (Number Format)">
      <Posts>
        <Post From="mpaul31" When="06/12/2012 20:09:11">
          <Html>
        
&lt;p&gt;Hello,&lt;/p&gt;
&lt;p&gt;I am using a SqlDataReader to populate my sheet data and when I use the following number format for dates, it formats correctly but when I look at the "Format Cells" from excel, the category is "Custom" not "Date".&lt;/p&gt;
&lt;p&gt;I looked at some of the code examples in the download and it looks like the category is being set to "Date" but I'm not sure what I am missing. Any help would be great.&lt;/p&gt;
&lt;pre&gt;// set the format
xlsSheet.Cells[rowIndex, i].Style.Numberformat.Format = "mm/dd/yyyy";

// ...

// read and write the value from the data row
xlsSheet.SetValue(rowIndex, i, dr[i - 1]);&lt;/pre&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Removing Major Gridlines from chart?">
      <Posts>
        <Post From="ScottyDell" When="29/03/2012 04:55:55">
          <Html>
        
&lt;p&gt;I'm generating a line chart and all looks as it should, except I can't figure out how to remove the major gridlines from the chart itself.&lt;/p&gt;
&lt;p&gt;Take a look at the screenshot here: http://www.eco.ca/gridlines.png to see what I mean. I don't want the 4 black lines going across my chart.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="ScottyDell" When="30/03/2012 06:07:24">
          <Html>
        
&lt;p&gt;I'm not sure if there is a better way, but after much messing around, I compared the two Excel files XML and found the section for the gridLines. Here's how I removed them:&lt;/p&gt;
&lt;p&gt;' remove the major gridlines&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;br&gt;
Dim nl As System.Xml.XmlNodeList = chart.ChartXml.GetElementsByTagName("c:majorGridlines")&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;
&lt;br&gt;
For i As Integer = 0 To nl.Count - 1&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;br&gt;
Dim n As System.Xml.XmlNode = nl(i)&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;br&gt;
Dim pn As System.Xml.XmlNode = n.ParentNode&lt;br&gt;
pn.RemoveChild(n)&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;br&gt;
Next&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="02/04/2012 06:40:42">
          <Html>
        This discussion has been copied to a work item. Click &lt;a href="http://epplus.codeplex.com/workitem/14681" rel="nofollow"&gt;
here&lt;/a&gt; to go to the work item and continue the discussion.
        
    </Html>
        </Post>
        <Post From="drbrady" When="06/12/2012 20:02:18">
          <Html>
        
&lt;p&gt;Here is some C# for people who care.&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;System.Xml.XmlNodeList nl = chart.ChartXml.GetElementsByTagName(&lt;span style="color: rgb(163, 21, 21);"&gt;"c:majorGridlines"&lt;/span&gt;);
&lt;span style="color: blue;"&gt;for&lt;/span&gt; (&lt;span style="color: blue;"&gt;int&lt;/span&gt; i = 0; i &amp;lt; nl.Count; i++)
{
    nl[i].ParentNode.RemoveChild(nl[i]);
}
&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Conditional Formatting">
      <Posts>
        <Post From="Mateuszef" When="04/12/2012 16:43:47">
          <Html>
        
&lt;p&gt;I am trying to put some conditional formatting on cells in given range. Unfortunately nothing happens. I want cells to change colour from white to red in an ascending manner. When exactly conditional formatting is applied? Do I have to do something more
 with the &lt;span style="color: rgb(255, 0, 0);"&gt;rule&lt;/span&gt; instance or Conditional Formatting is going to be applied at the same time it is created (when calling
&lt;span style="color: rgb(0, 128, 0);"&gt;AddTwoColorScale&lt;span style="color: rgb(0, 0, 0);"&gt;) ?&lt;/span&gt;&lt;br&gt;
&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;here is a code:&lt;/p&gt;
&lt;p&gt;I tried to follow the sample concerning conditional formatting which is published, but obviously I have to miss something...&lt;/p&gt;
&lt;p&gt;Any suggestions?&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;using&lt;/span&gt; (ExcelRange scoreRange = a_worksheet.Cells[fromRow, fromColumn, toRow, fromColumn])
{
   ExcelAddress rangeAddress = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelAddress(scoreRange.Address);
   &lt;span style="color: blue;"&gt;var&lt;/span&gt; &lt;span style="color: rgb(255, 0, 0);"&gt;rule&lt;/span&gt; = a_worksheet.ConditionalFormatting.&lt;span style="color: rgb(0, 128, 0);"&gt;AddTwoColorScale&lt;/span&gt;(rangeAddress);
   &lt;span style="color: rgb(255, 0, 0);"&gt;rule&lt;/span&gt;.LowValue.Type = eExcelConditionalFormattingValueObjectType.Min;
   &lt;span style="color: rgb(255, 0, 0);"&gt;rule&lt;/span&gt;.LowValue.Color = System.Drawing.Color.White;
   &lt;span style="color: rgb(255, 0, 0);"&gt;rule&lt;/span&gt;.HighValue.Type = eExcelConditionalFormattingValueObjectType.Max;                         &lt;span style="color: rgb(255, 0, 0);"&gt;&lt;br&gt;   rule&lt;/span&gt;.HighValue.Color = System.Drawing.Color.DarkRed;                     &lt;br&gt;}&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="mateuszef" When="05/12/2012 13:42:57">
          <Html>
        
&lt;p&gt;It is solved, The cause of this situation was the fact that in samples, when you show conditional formatting you assign to the cell.Value an Integer. In my case I assigned a string and set up NumberFormat which was not a proper approach. So I filled cells
 in this way:&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;foreach&lt;/span&gt; (Tokens tokens &lt;span style="color: blue;"&gt;in&lt;/span&gt; m_model.Data)
{
  &lt;span style="color: blue;"&gt;int&lt;/span&gt; colCounter = fromColumn;
  &lt;span style="color: blue;"&gt;foreach&lt;/span&gt; (&lt;span style="color: blue;"&gt;string&lt;/span&gt; dataValue &lt;span style="color: blue;"&gt;in&lt;/span&gt; tokens)
  {
    &lt;span style="color: blue;"&gt;long&lt;/span&gt; numericDataValue;
    &lt;span style="color: blue;"&gt;using&lt;/span&gt; (ExcelRange cell = a_worksheet.Cells[rowCounter, colCounter])
    {
      cell.Value = dataValue;
      cell.Style.Border.BorderAround(ExcelBorderStyle.Thin);
      &lt;span style="color: blue;"&gt;bool&lt;/span&gt; canConvert = &lt;span style="color: blue;"&gt;long&lt;/span&gt;.TryParse(dataValue, &lt;span style="color: blue;"&gt;out&lt;/span&gt; numericDataValue);
      &lt;span style="color: blue;"&gt;if&lt;/span&gt; (canConvert == &lt;span style="color: blue;"&gt;true&lt;/span&gt;)
        cell.Style.Numberformat.Format = &lt;span style="color: rgb(163, 21, 21);"&gt;"0"&lt;/span&gt;;                    
    }
    colCounter++;
  }
  rowCounter++;
}
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;And it is supposed to be filled in this way if conditional formatting is supposed to work:&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;foreach&lt;/span&gt; (Tokens tokens &lt;span style="color: blue;"&gt;in&lt;/span&gt; m_model.Data)
{
    &lt;span style="color: blue;"&gt;int&lt;/span&gt; colCounter = fromColumn;
    &lt;span style="color: blue;"&gt;foreach&lt;/span&gt; (&lt;span style="color: blue;"&gt;string&lt;/span&gt; dataValue &lt;span style="color: blue;"&gt;in&lt;/span&gt; tokens)
    {
        &lt;span style="color: blue;"&gt;long&lt;/span&gt; numericDataValue;
        &lt;span style="color: blue;"&gt;using&lt;/span&gt; (ExcelRange cell = a_worksheet.Cells[rowCounter, colCounter])
        {
            cell.Style.Border.BorderAround(ExcelBorderStyle.Thin);
            &lt;span style="color: blue;"&gt;bool&lt;/span&gt; canConvert = &lt;span style="color: blue;"&gt;long&lt;/span&gt;.TryParse(dataValue, &lt;span style="color: blue;"&gt;out&lt;/span&gt; numericDataValue);
            &lt;span style="color: blue;"&gt;if&lt;/span&gt; (canConvert == &lt;span style="color: blue;"&gt;true&lt;/span&gt;)
            {
                cell.Style.Numberformat.Format = &lt;span style="color: rgb(163, 21, 21);"&gt;"0"&lt;/span&gt;;
                cell.Value = numericDataValue;
            }
            &lt;span style="color: blue;"&gt;else&lt;/span&gt;
            {
                cell.Value = dataValue;
            }             
        }
        colCounter++;
    }
    rowCounter++;
}
&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to use OfficeOpenXml.Table.TableStyles">
      <Posts>
        <Post From="bhavtoshsharma" When="23/03/2012 13:36:52">
          <Html>
        
&lt;p&gt;hi all,&lt;/p&gt;
&lt;p&gt;im creating excel from scratch without loading data from string, file or datatable. Now i dont know how to apply TableStyle to my worksheet object.&lt;/p&gt;
&lt;p&gt;any help pls...&lt;/p&gt;
&lt;p&gt;thanks&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="23/03/2012 14:02:55">
          <Html>
        
&lt;p&gt;I´m pretty sure&amp;nbsp;you cant do this without template. You need to change your cell style "line by line".&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="bhavtoshsharma" When="23/03/2012 15:13:05">
          <Html>
        thanks mrxrsd&lt;br&gt;
&lt;br&gt;
Greetings,&lt;br&gt;
Bhavtosh Sharma&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
On Fri, Mar 23, 2012 at 6:33 PM, [email removed] wrote:&lt;br&gt;
&amp;gt; From: mrxrsd&lt;br&gt;
&amp;gt;&lt;br&gt;
&amp;gt; I´m pretty sure you cant do this without template. You need to change your&lt;br&gt;
&amp;gt; cell style "line by line".&lt;br&gt;
&amp;gt;&lt;br&gt;
&amp;gt; Read the full discussion online.&lt;br&gt;
&amp;gt;&lt;br&gt;
&amp;gt; To add a post to this discussion, reply to this email&lt;br&gt;
&amp;gt; ([email removed])&lt;br&gt;
&amp;gt;&lt;br&gt;
&amp;gt; To start a new discussion for this project, email&lt;br&gt;
&amp;gt; [email removed]&lt;br&gt;
&amp;gt;&lt;br&gt;
&amp;gt; You are receiving this email because you subscribed to this discussion on&lt;br&gt;
&amp;gt; CodePlex. You can unsubscribe on CodePlex.com.&lt;br&gt;
&amp;gt;&lt;br&gt;
&amp;gt; Please note: Images and attachments will be removed from emails. Any posts&lt;br&gt;
&amp;gt; to this discussion will also be available online at CodePlex.com
        
    </Html>
        </Post>
        <Post From="xav2075" When="05/12/2012 01:37:27">
          <Html>
        
&lt;p&gt;Using V3.1.2.0 \ Excel 2007 SP3&lt;/p&gt;
&lt;p&gt;Firstly worksheet.Cells["A1"].LoadFromDataTable(datatable, true, TableStyles.Medium9)&amp;nbsp; - To load from a datatable and to apply a TableStyle.x onto it can produce a corrupted xlsx spreadsheet file.&amp;nbsp; Where I have had this happen to me&amp;nbsp;
 I was able to bypass the error by not specifying a TableStyle.x in the .LoadFromDataTable method.&amp;nbsp; And after to define a range and table.&amp;nbsp; Then apply a TableStyle.&amp;nbsp; For example:-&lt;/p&gt;
&lt;p&gt;worksheet.Cells["A1"].LoadFromDataTable(datatable, true);&lt;/p&gt;
&lt;p&gt;var range = worksheet.Cells["A1:B50"];&amp;nbsp;&lt;/p&gt;
&lt;p&gt;var table = worksheet.Tables.Add(range, "tablename");&lt;/p&gt;
&lt;p&gt;table.TableStyle = TablesStyles.Medium9;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Error opening XLSX Excel file">
      <Posts>
        <Post From="hedzx" When="07/11/2012 09:23:23">
          <Html>
        
&lt;p&gt;Hello there,&amp;nbsp;&lt;/p&gt;
&lt;p&gt;thank you for this great tool.&lt;/p&gt;
&lt;p&gt;I am having issues opening this excel file, that opens correctly on the Excel 2010.&lt;/p&gt;
&lt;p&gt;http://www37.zippyshare.com/v/7834578/file.html&lt;/p&gt;
&lt;p&gt;Any Ideas why?&lt;/p&gt;
&lt;p&gt;here it is the code. I receive&amp;nbsp;Object reference not set to an instance of an object at last line.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;pre&gt;            System.IO.FileInfo newFile = new System.IO.FileInfo(@"C:\Temp\grid.xlsx");

            ExcelPackage excelP = new ExcelPackage(newFile);

            ExcelWorksheet ws = excelP.Workbook.Worksheets[1];&lt;/pre&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;thank you and regards&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="07/11/2012 10:32:31">
          <Html>
        
&lt;p&gt;hedzx,&lt;/p&gt;
&lt;p&gt;&lt;span style="white-space: pre;"&gt;&lt;/span&gt;Please download lastest version, works fine here with 3.1.2.&lt;/p&gt;
&lt;p&gt;Regards,&lt;/p&gt;
&lt;p&gt;Thiago&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="hedzx" When="07/11/2012 11:07:15">
          <Html>
        
&lt;p&gt;it works!!&amp;nbsp;&lt;/p&gt;
&lt;p&gt;thank you so much man, you made my day happier :)&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="hedzx" When="07/11/2012 12:57:51">
          <Html>
        
&lt;p&gt;by the way I can edit and save the file, but I am having another issue.&lt;/p&gt;
&lt;p&gt;after saving and open in excel 2010 the Excel is complaining about some unreadable content and asks if I want to recover.&lt;/p&gt;
&lt;p&gt;http://www13.zippyshare.com/v/31858409/file.html&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;pre&gt;System.IO.FileInfo newFile = new System.IO.FileInfo(@"C:\Temp\grid.xlsx");
ExcelPackage excelP = new ExcelPackage(newFile);
ExcelWorksheet ws = excelP.Workbook.Worksheets[1];
excelP.Save();&lt;/pre&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&amp;lt;?xml version="1.0" encoding="UTF-8" standalone="true"?&amp;gt;-&amp;lt;recoveryLog xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main"&amp;gt;&amp;lt;logFileName&amp;gt;error051800_01.xml&amp;lt;/logFileName&amp;gt;&amp;lt;summary&amp;gt;Errors were detected in file 'C:\Temp\grid.xlsx'&amp;lt;/summary&amp;gt;-&amp;lt;repairedRecords
 summary="Following is a list of repairs:"&amp;gt;&amp;lt;repairedRecord&amp;gt;Repaired Records: Cell information from /xl/worksheets/sheet0.xml part&amp;lt;/repairedRecord&amp;gt;&amp;lt;/repairedRecords&amp;gt;&amp;lt;/recoveryLog&amp;gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;any ideas?&lt;/p&gt;
&lt;p&gt;regards.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="hedzx" When="08/11/2012 12:31:13">
          <Html>
        
&lt;p&gt;this is very strange... the xlsx excel files comes from an external .net component grid view that exports to this format.&lt;/p&gt;
&lt;p&gt;the Excel opens very well the unchanged version.&lt;/p&gt;
&lt;p&gt;if I save with epplus this excel sheet becomes with errors.&lt;/p&gt;
&lt;p&gt;if I save with excel this file before opening with epplus the file gain 5 kbs and after saving in epplus it is ok.&lt;/p&gt;
&lt;p&gt;so i am&amp;nbsp;supposing&amp;nbsp;this 5 kbs that excel 2010 adds is some missing cels information or something like that. did anyone had this problem?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;regards.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="hedzx" When="08/11/2012 16:17:59">
          <Html>
        
&lt;p&gt;I&amp;nbsp;succeed&amp;nbsp;to bypass this issue by creating new sheet. strange issue.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;pre&gt;          System.IO.FileInfo changedFile = new System.IO.FileInfo(@"C:\Temp\grida.xlsx");

            ExcelPackage test = new ExcelPackage(changedFile);

            test.Workbook.Worksheets.Add("newsstuff", ws.Workbook.Worksheets[1]);

            test.Save();&lt;/pre&gt;
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="vmoskalenko" When="04/12/2012 22:59:17">
          <Html>
        
&lt;p&gt;Well, I've like the same issue. And bypass is not working to me.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="05/12/2012 00:48:10">
          <Html>
        
&lt;p&gt;There are several situations which leads you to "unreadable content", please take a look at our discussion list to see if it´s not your case.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Setting Alignment for a Vertically Merged Cells with rotated text.">
      <Posts>
        <Post From="Mateuszef" When="04/12/2012 12:55:27">
          <Html>
        
&lt;p&gt;Hi guys, does setting alignment for vertically merged cells work?&lt;/p&gt;
&lt;p&gt;When I set an alignment on horizontally merged cells then it works fine, however when I want to do the same with cells which were merged vertically nothing happens. Below, there is a sample code..&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(255, 0, 0);"&gt;verticalTitle&lt;/span&gt; appears on the bottom of merged cells as default alignment is used.&lt;/p&gt;
&lt;p&gt;Any suggestions?&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;   &lt;span style="color: blue;"&gt;using&lt;/span&gt; (ExcelRange &lt;span style="color: rgb(255, 0, 0);"&gt;verticalTitle&lt;/span&gt; = a_worksheet.Cells[fromRow,1,toRow,1])
            {
                verticalTitle.Merge = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
                &lt;span style="color: rgb(128, 0, 128);"&gt;verticalTitle.Style.TextRotation = 90;&lt;/span&gt;
                verticalTitle.Style.Font.Size = 18;
                verticalTitle.Style.Font.Bold = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
                verticalTitle.Style.Fill.PatternType = OfficeOpenXml.Style.ExcelFillStyle.Solid;
                verticalTitle.Style.Fill.BackgroundColor.SetColor(systemColor);
                &lt;span style="color: rgb(0, 0, 255);"&gt;verticalTitle.Style.VerticalAlignment = ExcelVerticalAlignment.Center;&lt;/span&gt;
                verticalTitle.Value = m_model.Name;
            }
&lt;br&gt;&lt;br&gt;&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="mateuszef" When="04/12/2012 13:05:38">
          <Html>
        
&lt;p&gt;Ok, I think it is solved, I tested it a little bit and it occurs that the order of assignments is meaningful. So, if alignment is set before setting text rotation it works properly. Strange, but fortunately I found simple solution for what I want to achieve.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;using&lt;/span&gt; (ExcelRange verticalTitle = a_worksheet.Cells[fromRow,1,toRow,1])
            {
                verticalTitle.Merge = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
                verticalTitle.Style.Font.Size = 18;
                verticalTitle.Style.Font.Bold = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
                verticalTitle.Style.Fill.PatternType = OfficeOpenXml.Style.ExcelFillStyle.Solid;
                verticalTitle.Style.Fill.BackgroundColor.SetColor(systemColor);
                &lt;span style="color: rgb(0, 0, 255);"&gt;verticalTitle.Style.VerticalAlignment = ExcelVerticalAlignment.Center;&lt;/span&gt;
                verticalTitle.Style.HorizontalAlignment = ExcelHorizontalAlignment.Center;
                &lt;span style="color: rgb(128, 0, 128);"&gt;verticalTitle.Style.TextRotation = 90;&lt;/span&gt;
                verticalTitle.Value = m_model.Name;
            }
&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Position a DataLabel">
      <Posts>
        <Post From="ralphtrentacosta" When="09/04/2012 21:46:47">
          <Html>
        
&lt;p&gt;Hello&lt;/p&gt;
&lt;p&gt;I have a PieChart with DataLabels visible. &amp;nbsp; &amp;nbsp;Is there a way to position the DataLabel? &amp;nbsp;It looks like
&lt;em&gt;Best Fit &lt;/em&gt;&amp;nbsp;is only used but I would like them to be on the outside.&lt;/p&gt;
&lt;p&gt;Thanks,&lt;/p&gt;
&lt;p&gt;RalphTrent&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="12/04/2012 18:49:55">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Try to something like this (on the series)...&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;ser.DataLabel.Position = eLabelPosition.OutEnd; &lt;/pre&gt;
&lt;pre&gt;Jan&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="ralphtrentacosta" When="12/04/2012 18:59:13">
          <Html>
        Thanks for the reply. &lt;br&gt;
&lt;br&gt;
here is my code:
&lt;div&gt;&lt;br&gt;
&lt;/div&gt;
&lt;div&gt;
&lt;div&gt;OfficeOpenXml.Drawing.Chart.ExcelPieChart chartPie = (OfficeOpenXml.Drawing.Chart.ExcelPieChart)productDetailsWorksheet.Drawings.AddChart(lstrTitle + " PIE", OfficeOpenXml.Drawing.Chart.eChartType.Pie);&lt;/div&gt;
&lt;div&gt;chartPie.DataLabel.ShowPercent = true;&lt;/div&gt;
&lt;div&gt;chartPie.DataLabel.ShowLeaderLines = true;&lt;/div&gt;
&lt;div&gt;chartPie.Legend.Position = eChart.eLegendPosition.Bottom;&lt;/div&gt;
&lt;div&gt;chartPie.ShowHiddenData = true;&lt;/div&gt;
&lt;div&gt;chartPie.Title.Text = lstrTitle;&lt;/div&gt;
&lt;div&gt;chartPie.SetSize(500, 400);&lt;/div&gt;
&lt;div&gt;chartPie.SetPosition(chart.From.Row, 0, chart.To.Column+1, 10);&lt;/div&gt;
&lt;div&gt;chartPie.Series.Add(lerbValue, lerbTitle);&lt;/div&gt;
&lt;div&gt;&lt;br&gt;
&lt;/div&gt;
&lt;div&gt;I tried to do as you suggested:&lt;/div&gt;
&lt;div&gt;chartPie.Series[0].(looking for DataLabel.Position here)..&lt;/div&gt;
&lt;div&gt;&lt;br&gt;
&lt;/div&gt;
&lt;div&gt;but I do not see a DataLabel class . Did I interpret your suggestion incorrectly?&lt;/div&gt;
&lt;div&gt;There is also no Position property on chartPie.DataLabel&lt;/div&gt;
&lt;div&gt;&lt;br&gt;
&lt;/div&gt;
&lt;div&gt;Please let me know if I missed something.&lt;/div&gt;
&lt;div&gt;&lt;br&gt;
&lt;/div&gt;
&lt;div&gt;Thanks&lt;/div&gt;
&lt;div&gt;RalphTrent&lt;/div&gt;
&lt;div&gt;&lt;/div&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="wegginho" When="04/12/2012 10:43:36">
          <Html>
        
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;pre&gt;&lt;span&gt;ExcelChartSerieDataLabel&lt;/span&gt;&amp;nbsp;&lt;span&gt;dl&lt;/span&gt;&amp;nbsp;=&amp;nbsp;&lt;span&gt;myChartOrSeries&lt;/span&gt;.&lt;span&gt;DataLabel&lt;/span&gt;;
&lt;span&gt;dl&lt;/span&gt;.&lt;span&gt;Position...&lt;/span&gt;&lt;/pre&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="will this work for Excel 2013 ?">
      <Posts>
        <Post From="dnanetwork88" When="03/12/2012 09:59:03">
          <Html>
        
&lt;p&gt;It works really fine 2007/ 2010.Has anyone checked with Excel 2013 ?&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="TimeSpan">
      <Posts>
        <Post From="narmer" When="07/12/2010 17:38:23">
          <Html>
        
&lt;p&gt;Hello,&lt;/p&gt;
&lt;p&gt;What format must I use to write a timespan format?&lt;/p&gt;
&lt;p&gt;I tested hh:mm:ss, but when we try to add the rows value excel don't add them.&lt;/p&gt;
&lt;p&gt;Best regards,&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(0, 128, 0); font-size: x-small;"&gt;&lt;span style="color: rgb(0, 128, 0); font-size: x-small;"&gt;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="08/12/2010 08:00:02">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;That should work. Make sure you add set value as DateTime and not as a string...&lt;/p&gt;
&lt;p&gt;ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;].Value = DateTime.Now;&lt;br&gt;
ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;].Style.Numberformat.Format =
&lt;span style="color: rgb(163, 21, 21);"&gt;"hh:mm:ss"&lt;/span&gt;;&lt;br&gt;
&lt;br&gt;
Have a look at the section about styling in the FAQ.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="narmer" When="08/12/2010 17:01:16">
          <Html>
        
&lt;p&gt;I'm setting the value as "TimeSpan" and excel shows fine the value. I think I didn't explain the problem correcly in my post.&lt;/p&gt;
&lt;p&gt;When we write with timespan format ("hh:mm:ss"), excel shows fine the value (ex. 12:54:12). But if you put this values in a table and then you setup thecolumn to add all values as a total, excel don't calculate the total of the column. Then when
 you edit this cell and clic enter excel calculate the total.&lt;/p&gt;
&lt;p&gt;Thanks for your help and best regards,&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="09/12/2010 09:01:15">
          <Html>
        
&lt;p&gt;Ok, I'm not sure I understand you correctly, since you haven't provided any code, but if you try this...&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;].Value=&lt;span style="color: blue;"&gt;new&lt;/span&gt; TimeSpan(1, 1, 10);
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;...the value will be converted to a string. The library has no build in support for TimeSpann's, so it will call the ToString() mehod on the object (like all other objects as well).&lt;/p&gt;
&lt;p&gt;What you should do is to convert it to a date or a double.&lt;/p&gt;
&lt;p&gt;Try this...&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;] = &lt;span style="color: blue;"&gt;new&lt;/span&gt; DateTime(&lt;span style="color: blue;"&gt;new&lt;/span&gt; TimeSpan(1, 1, 10).Ticks);
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;...and the value should appear correctly.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="AaronLS" When="30/11/2012 20:36:51">
          <Html>
        
&lt;p&gt;FYI since this came high on Google, I found all I had to do was assign the Value and then set the format&lt;/p&gt;
&lt;p&gt;worksheet.Cells["A1"].Value=new TimeSpan(1, 1, 10);&lt;/p&gt;
&lt;pre&gt;worksheet.Cells["A1"].Style.Numberformat.Format&amp;nbsp;=&amp;nbsp;&lt;span&gt;"h:mm&amp;nbsp;AM/PM"&lt;/span&gt;;// 3:45 PM, best when your TimeSpan represents a time of the day
&lt;/pre&gt;
&lt;pre&gt;or&lt;/pre&gt;
&lt;pre&gt;worksheet.Cells["A1"].Style.Numberformat.Format&amp;nbsp;=&amp;nbsp;"h:mm";// 15:45, best when your TimeSpan represents an amount of time elapsed&lt;/pre&gt;
&lt;pre&gt;&lt;br&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;pre&gt;The nice thing is this does not include any kind of date component that would create nonsense date parts in Excel.&lt;/pre&gt;
...Never liked Microsoft's post editor...&lt;/pre&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Problems in version 3.1.2.0, not exisiting in 3.0.0.2">
      <Posts>
        <Post From="password_trust" When="29/11/2012 11:43:17">
          <Html>
        
&lt;p&gt;I have a excel file (named ex1.xlsx) , that contains a chart in a specific sheet (named "PlotSheet").&lt;/p&gt;
&lt;p&gt;The type of chart is &lt;strong&gt;XY (Dispersion).&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="text-decoration: underline;"&gt;Case 1:&lt;/span&gt; With version EPPlus 3.0.0.2., I was able to open ex1.xlsx and make changes in any sheet ( I didnt do any change in "PlotSheet"), and when I saved the changes in a new file (ex2.xlsx) and opened
 it, the sheet "PlotSheet" was there.&lt;/p&gt;
&lt;p&gt;&lt;span style="text-decoration: underline;"&gt;Case 2: &lt;/span&gt;However, now that I use EPPlus 3.1.2.0, if I open ex1.xlsx and make changes in any sheet ( excepting "PlotSheet", as I did in case 1), and then I save the changes in a new file (ex2.xlsx) and
 opened it, &lt;strong&gt;the sheet "PlotSheet" was NOT there&lt;/strong&gt;, because there is any problem in the format.&lt;/p&gt;
&lt;p&gt;Does someone&amp;nbsp; know how this is happening? Any solution?&lt;/p&gt;
&lt;p&gt;Thanks in advance.&lt;/p&gt;
&lt;p&gt;Mónica.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Is EPPlus supports OLE Objects ? i need to create checkbox , dorpdown ...etc in excel 2007.">
      <Posts>
        <Post From="prabhuthilsri" When="29/11/2012 07:09:09">
          <Html>
        
&lt;p&gt;fastest answer should be help fill.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks for advance for help.&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Preventing Excel from autoformatting cells to dates">
      <Posts>
        <Post From="Danthar" When="28/11/2012 09:28:22">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I know i can prevent this problem, by preformatting the cells to Text. (ctrl-1 -&amp;gt; Number tab -&amp;gt; Text ).&lt;/p&gt;
&lt;p&gt;But how do i do that with EPPlus ?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="28/11/2012 10:42:32">
          <Html>
        
&lt;p&gt;hum, I'm not in front of pc now and I can't think in another way, but I guess if you set your data as string, probably will do the job.&lt;/p&gt;
&lt;p&gt;If you don't have no value to set and you want to prevent when your client are editing the file, maybe you can initialize your cells with string.empty.&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Danthar" When="28/11/2012 12:37:59">
          <Html>
        
&lt;p&gt;That didn't work..&lt;/p&gt;
&lt;p&gt;What I ended up doing is creating a excel file in which I set the celltype to text, for all cells. And used that as an template...&lt;/p&gt;
&lt;p&gt;But why isn't this an property that I can specify on a cell/column/row ?&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Problem with date/time format and autofit columns?">
      <Posts>
        <Post From="AaronLS" When="27/11/2012 17:59:43">
          <Html>
        
&lt;p&gt;I am formatting some cells as date times, but the AutoFitColumns resizes these to be very small, sometimes as small as just 4 characters wide. &amp;nbsp;It is always too small, but seems to be random in how small from column to column. &amp;nbsp;I am making sure
 I apply the time formats before calling AutoFitColumns. &amp;nbsp;Any ideas?&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;DateTable dt = &lt;span style="color: green;"&gt;//some data&lt;/span&gt;

&lt;span style="color: blue;"&gt;var&lt;/span&gt; timeColumns = &lt;span style="color: blue;"&gt;from&lt;/span&gt; DataColumn d &lt;span style="color: blue;"&gt;in&lt;/span&gt; dt.Columns
    &lt;span style="color: blue;"&gt;where&lt;/span&gt; d.DataType == &lt;span style="color: blue;"&gt;typeof&lt;/span&gt;(DateTime) &amp;amp;&amp;amp;
    (d.ColumnName.EndsWith(&lt;span style="color: rgb(163, 21, 21);"&gt;"Time"&lt;/span&gt;) || d.ColumnName.EndsWith(&lt;span style="color: rgb(163, 21, 21);"&gt;"UTC"&lt;/span&gt;))
    &lt;span style="color: blue;"&gt;select&lt;/span&gt; d.Ordinal + 1;

&lt;span style="color: blue;"&gt;foreach&lt;/span&gt; (&lt;span style="color: blue;"&gt;int&lt;/span&gt; column &lt;span style="color: blue;"&gt;in&lt;/span&gt; timeColumns)
{
    worksheet.Cells[2, column, dt.Rows.Count + 1, column].Style.Numberformat.Format = &lt;span style="color: rgb(163, 21, 21);"&gt;"m/d/yyyy h:mm AM/PM"&lt;/span&gt;;
}
&lt;span style="color: green;"&gt;//Header rows don't affect autosize.&lt;/span&gt;
worksheet.Cells[2, 1, dt.Rows.Count + 2, dt.Columns.Count + 1].AutoFitColumns(5, 50);
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="27/11/2012 18:52:23">
          <Html>
        
&lt;p&gt;I don't know if it is a bug or not, I dig a little and find out that format parameter in ExcelRangeBase class maybe it isn't right.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;ExcelRangeBase.cs, line 822&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;if&lt;/span&gt; (nf.DataType == ExcelNumberFormatXml.eFormatType.DateTime)
{
&lt;span style="color: blue;"&gt;    return&lt;/span&gt; ((DateTime)v).ToString(format, nf.Culture);
}
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;My version:&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;if&lt;/span&gt; (nf.DataType == ExcelNumberFormatXml.eFormatType.DateTime)
{
      &lt;span style="color: blue;"&gt;return&lt;/span&gt; ((DateTime)v).ToString(textFormat, nf.Culture);
}
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;After my change, autofit is quite fine, but again, I don't know why, ExcelFormatTranslator remove "AM/PM" from cell styles before calculating its size.&lt;/p&gt;
&lt;p&gt;Why do you want to call autofit? This column will always have almost &amp;nbsp;the same size "(9)9/(9)9/9999 (9)9:99 AM(PM)", I think fixed size will works fine, no?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="AaronLS" When="27/11/2012 18:56:46">
          <Html>
        
&lt;p&gt;Yes, I did use a fixed size for now, but that requires I sprinkle fixed sizes here and there depending on what the format is and font size/bolded. &amp;nbsp;My preference was to use AutoFit because it resulted in more generic code.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="27/11/2012 19:10:45">
          <Html>
        
&lt;p&gt;Yes, indeed it is =) &amp;nbsp;&lt;/p&gt;
&lt;p&gt;Let's wait for Jan to save us hehehe&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to load custom object list to epplus">
      <Posts>
        <Post From="vladakg85" When="27/11/2012 17:35:22">
          <Html>
        
&lt;p&gt;&lt;span&gt;I have to make export from list with collapse/expand feature as I have object in object. I don't have luck to implement this here what I have try:&lt;/span&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&lt;span&gt;&lt;/span&gt;&lt;pre&gt;&lt;div style="color: black; background-color: white;"&gt;&lt;pre&gt;Person p1 = &lt;span style="color: blue;"&gt;new&lt;/span&gt; Person {UserId = 1, FirstName = &lt;span style="color: rgb(163, 21, 21);"&gt;"John"&lt;/span&gt;, LastName = &lt;span style="color: rgb(163, 21, 21);"&gt;"Doe"&lt;/span&gt;};
            Person p2 = &lt;span style="color: blue;"&gt;new&lt;/span&gt; Person { UserId = 2, FirstName = &lt;span style="color: rgb(163, 21, 21);"&gt;"Super"&lt;/span&gt;, LastName = &lt;span style="color: rgb(163, 21, 21);"&gt;"Man"&lt;/span&gt; };
            Address a1 = &lt;span style="color: blue;"&gt;new&lt;/span&gt; Address {AddressId = 56, City = &lt;span style="color: rgb(163, 21, 21);"&gt;"Washington"&lt;/span&gt;, Title = &lt;span style="color: rgb(163, 21, 21);"&gt;"Some Address"&lt;/span&gt;};
            p1.Address = a1;
            p2.Address = a1;

            List people = &lt;span style="color: blue;"&gt;new&lt;/span&gt; List();
            people.Add(p1);
            people.Add(p2);

&lt;span style="color: blue;"&gt;string&lt;/span&gt; excelSheetName = &lt;span style="color: rgb(163, 21, 21);"&gt;"test"&lt;/span&gt;;

            &lt;span style="color: blue;"&gt;string&lt;/span&gt; fileName = &lt;span style="color: rgb(163, 21, 21);"&gt;"ByteOfCode"&lt;/span&gt;;
            &lt;span style="color: blue;"&gt;string&lt;/span&gt; currentDirectorypath = Environment.CurrentDirectory;
            &lt;span style="color: blue;"&gt;string&lt;/span&gt; finalFileNameWithPath = &lt;span style="color: blue;"&gt;string&lt;/span&gt;.Empty;

            fileName = &lt;span style="color: blue;"&gt;string&lt;/span&gt;.Format(&lt;span style="color: rgb(163, 21, 21);"&gt;"{0}_{1}"&lt;/span&gt;, fileName, DateTime.Now.ToString(&lt;span style="color: rgb(163, 21, 21);"&gt;"dd-MM-yyyy"&lt;/span&gt;));
            finalFileNameWithPath = &lt;span style="color: blue;"&gt;string&lt;/span&gt;.Format(&lt;span style="color: rgb(163, 21, 21);"&gt;"{0}\\{1}.xlsx"&lt;/span&gt;, currentDirectorypath, fileName);

            &lt;span style="color: blue;"&gt;if&lt;/span&gt; (File.Exists(finalFileNameWithPath))
                File.Delete(finalFileNameWithPath);

            &lt;span style="color: blue;"&gt;var&lt;/span&gt; newFile = &lt;span style="color: blue;"&gt;new&lt;/span&gt; FileInfo(finalFileNameWithPath);

            &lt;span style="color: blue;"&gt;using&lt;/span&gt; (&lt;span style="color: blue;"&gt;var&lt;/span&gt; package = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(newFile))
            {
                ExcelWorksheet worksheet = package.Workbook.Worksheets.Add(excelSheetName);

                worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;].LoadFromCollection(people, &lt;span style="color: blue;"&gt;true&lt;/span&gt;, TableStyles.None);
&lt;/pre&gt;
&lt;/div&gt;
&lt;br&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;p&gt;But when I export this to xslx I don't get collapse/expand:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&lt;span&gt;UserId&lt;/span&gt;&lt;span&gt;  &lt;/span&gt;&lt;span&gt;FirstName&lt;/span&gt;&lt;span&gt;   &lt;/span&gt;&lt;span&gt;LastName&lt;/span&gt;&lt;span&gt;    &lt;/span&gt;&lt;span&gt;Address&lt;/span&gt;&lt;span&gt;
&lt;/span&gt;&lt;span&gt;1&lt;/span&gt;&lt;span&gt;          &lt;/span&gt;&lt;span&gt;John&lt;/span&gt;&lt;span&gt;      &lt;/span&gt;&lt;span&gt;Doe&lt;/span&gt;&lt;span&gt;        &lt;/span&gt;&lt;span&gt;Demo_Export_Xls&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;Address&lt;/span&gt;&lt;span&gt;
&lt;/span&gt;&lt;span&gt;2&lt;/span&gt;&lt;span&gt;          &lt;/span&gt;&lt;span&gt;Super&lt;/span&gt;&lt;span&gt;     &lt;/span&gt;&lt;span&gt;Man&lt;/span&gt;&lt;span&gt;    &lt;/span&gt;&lt;span&gt;Demo_Export_Xls&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;Address&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;br&gt;&lt;/pre&gt;
&lt;/code&gt;&lt;/pre&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Performance - EPPlus versus Spreadsheet Gear">
      <Posts>
        <Post From="andreashedin" When="22/11/2012 11:47:59">
          <Html>
        
&lt;div&gt;
&lt;p&gt;First off: Thanks for a great product!&lt;/p&gt;
&lt;p&gt;Secondly: I've made a simple performance test between EPPlus and Spreadsheet Gear to see if there is any significant difference that would justify buying Spreadsheet Gear.&lt;/p&gt;
&lt;p&gt;I am no expert at either application so it's possible the tests aren't written the most efficient way.&lt;/p&gt;
&lt;p&gt;The test does the following:&lt;/p&gt;
&lt;p&gt;1. Opens an existing Excel-file with 1000 rows and 3 columns. Saves the three values into an entity that is saved into a List&amp;lt;&amp;gt;.&lt;/p&gt;
&lt;p&gt;2. Open a new Excel-object&lt;/p&gt;
&lt;p&gt;3. Create a header row (bold) with the title of each column.&lt;/p&gt;
&lt;p&gt;4. Write back the 1000 entities.&lt;/p&gt;
&lt;p&gt;5. Save the new Excelfile.&lt;/p&gt;
&lt;p&gt;If I run this test once EPPlus comes out the winner (approx times are EPPlus = 280ms, SG = 500ms). If I run the test 10 times in a row instead (a for-loop opening, copying, saving 10 seperate times) Spreadsheet Gear is faster instead (approx times per file:
 EPPlus = 165ms, SG = 95ms). For 20 tests the approx times are EPPlus = 160ms / file and SG = 60ms / file.&lt;/p&gt;
&lt;p&gt;It seems like (to a certain extent at least) Spreadsheet Gears gets faster and faster the more files I create. Could anyone explain why EPPlus is the slower one when running consecutive tests? And can I make changes to the code to change this?&lt;/p&gt;
&lt;p&gt;EPPlus test function:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  var timer = new Stopwatch();
  timer.Start();
  var data = new List&amp;lt;Item&amp;gt;();
  using (var excelIn = new ExcelPackage(new FileInfo(folder + fileIn)))
  {
    var sheet = excelIn.Workbook.Worksheets[1];
    var row = 2;
    while (sheet.Cells[row, 1].Value != null)
    {
      data.Add(new Item()
        {
          Id = int.Parse(sheet.Cells[row, 1].Text),
          Title =  sheet.Cells[row, 2].Text,
          Value = int.Parse(sheet.Cells[row, 3].Text)
        });

      row++;
    }
  }

  using (var excelOut = new ExcelPackage())
  {
    var sheet = excelOut.Workbook.Worksheets.Add("Out");
    sheet.Cells.LoadFromCollection(data);
    sheet.InsertRow(1, 1);
    sheet.Cells[1, 1, 1, 3].Style.Font.Bold = true;
    sheet.Cells[1, 1].Value = "Id";
    sheet.Cells[1, 2].Value = "Title";
    sheet.Cells[1, 3].Value = "Value";

    excelOut.SaveAs(new FileInfo(folder + "EPPlus_" + Guid.NewGuid() + ".xlsx"));
  }

  timer.Stop();
  return timer.ElapsedMilliseconds;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Spreadsheet Gear:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  var timer = new Stopwatch();
  timer.Start();

  var data = new List&amp;lt;Item&amp;gt;();
  var excelIn = Factory.GetWorkbook(folder + fileIn);
  var sheetIn = excelIn.Worksheets[0];
  var rowIn = 1;
  while (sheetIn.Cells[rowIn, 0].Value != null)
  {
    data.Add(new Item()
    {
      Id = int.Parse(sheetIn.Cells[rowIn, 0].Text),
      Title = sheetIn.Cells[rowIn, 1].Text,
      Value = int.Parse(sheetIn.Cells[rowIn, 2].Text)
    });

    rowIn++;
  }
  excelIn.Close();

  var excelOut = Factory.GetWorkbook();
  var sheetOut = excelOut.Worksheets.Add();
  sheetOut.Name = "Out";
  var rowOut = 0;
  sheetOut.Cells[rowOut, 0, rowOut, 2].Font.Bold = true;
  sheetOut.Cells[rowOut, 0].Value = "Id";
  sheetOut.Cells[rowOut, 1].Value = "Title";
  sheetOut.Cells[rowOut++, 2].Value = "Value";

  foreach (var item in data)
  {
    sheetOut.Cells[rowOut, 0].Value = item.Id;
    sheetOut.Cells[rowOut, 1].Value = item.Title;
    sheetOut.Cells[rowOut++, 2].Value = item.Value;
  }

  excelOut.SaveAs(folder + "SpreadsheetGear_" + Guid.NewGuid() + ".xlsx", FileFormat.OpenXMLWorkbook);
  excelOut.Close();

  timer.Stop();
  return timer.ElapsedMilliseconds;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Main function&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  var runs = 1;
  var testerG = new TestSpreadsheetGear();
  var testerE = new TestEpPlus();
  var msE = 0.0;
  var msG = 0.0;
  var i = 0;
  for (i = 0; i &amp;lt; runs; ++i)
  {
    msG += new TestSpreadsheetGear().Run(folder, originalFile);
  }

  for(i = 0; i &amp;lt; runs; ++i)
  {
    msE += new TestEpPlus().Run(folder, originalFile);
  }

  Console.WriteLine("Spreadsheet time: " + msG + ". Per file: " + msG / runs);
  Console.WriteLine("EP Plus time: " + msE + ". Per file: " + msE / runs);
  Console.ReadKey();
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;&lt;code&gt;&lt;br&gt;
&lt;/code&gt;&lt;/div&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="22/11/2012 12:38:11">
          <Html>
        
&lt;p&gt;Probably, EPPlus is faster for editing cells but not for opening and closing file, when you execute your test once, this is not a problem, but when you are running a dozen times, it is.&lt;/p&gt;
&lt;p&gt;I am guessing here =)&amp;nbsp;&lt;/p&gt;
&lt;p&gt;The only way to discover the truth is running your code with a profilling tool, like jetbrain dotTrace.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="andreashedin" When="23/11/2012 07:15:58">
          <Html>
        
&lt;p&gt;Good idea, I should try that! Thank you!&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Removing comments causes errors when opening excel file">
      <Posts>
        <Post From="sm_user" When="22/11/2012 18:22:07">
          <Html>
        
&lt;p&gt;I am using EPPlus to add/remove comments to/from an excel file after processing.&lt;/p&gt;
&lt;p&gt;When I try to open the file after it has been processed I get the following error:&lt;/p&gt;
&lt;p&gt;"Excel found unreadable content in 'xxxx.xlsx'. Do you want to recover the contents..........."&lt;/p&gt;
&lt;p&gt;After clicking on "Yes", this error is followed by the error:&lt;/p&gt;
&lt;p&gt;"Removed Part: /xl/comments1.xml part with XML error. &amp;nbsp;(Comments) Incorrect document syntax. Line 63, column 14."&lt;/p&gt;
&lt;p&gt;The file still opens but these errors cause all comments on the file to disappear. This only seems to happen after a certain number of comments have been removed by the EPPlus library.&lt;/p&gt;
&lt;p&gt;Has anyone encountered this problem before or know why this may be happening?&lt;/p&gt;
&lt;p&gt;Thanks,&lt;/p&gt;
&lt;p&gt;SM.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Remove Images EPPLUS">
      <Posts>
        <Post From="dlahuerta" When="22/11/2012 14:45:56">
          <Html>
        
&lt;p&gt;First sorry for my Inglish.&lt;/p&gt;
&lt;p&gt;I work with EPPLUS and i need remove all images of a sheet of excel.&lt;/p&gt;
&lt;p&gt;¿How I can do it?&lt;/p&gt;
&lt;p&gt;Thanks and best regards.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Green marker and SUM">
      <Posts>
        <Post From="deserialized" When="21/11/2012 09:02:24">
          <Html>
        
&lt;p&gt;I have generated a sheet with "number" - 0 - values in it. When I open the Excel document I see green markers in top left corner of each cell.&lt;/p&gt;
&lt;p&gt;If I (manually) create a SUM on that column I always get 0. The strange thing is that if I edit anything within the sell, replace comma or add a number the green marker disappears, the cell value is right justified and included in SUM.&lt;/p&gt;
&lt;p&gt;I have confirmed by right clicking that original format is Number.&lt;/p&gt;
&lt;p&gt;Not sure what I am doing wrong here?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="deserialized" When="21/11/2012 09:35:04">
          <Html>
        
&lt;p&gt;I figured out that setting format is not enough - I also have to convert the datatype (I was setting string everywhere because I am converting from a flat file).&lt;/p&gt;
&lt;p&gt;I do not know if there is a better way to detect if it should be converted to a number before saving than this:&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;                      &lt;span style="color: blue;"&gt;If&lt;/span&gt; col.Format.Contains(&lt;span style="color: rgb(163, 21, 21);"&gt;"#"&lt;/span&gt;) &lt;span style="color: blue;"&gt;Or&lt;/span&gt; col.Format.Contains(&lt;span style="color: rgb(163, 21, 21);"&gt;"0"&lt;/span&gt;) &lt;span style="color: blue;"&gt;Or&lt;/span&gt; col.Format.Contains(&lt;span style="color: rgb(163, 21, 21);"&gt;"%"&lt;/span&gt;) &lt;span style="color: blue;"&gt;Or&lt;/span&gt; col.Format.Contains(&lt;span style="color: rgb(163, 21, 21);"&gt;"?"&lt;/span&gt;) &lt;span style="color: blue;"&gt;Then&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I only know format - not the data type.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="21/11/2012 13:06:09">
          <Html>
        
&lt;p&gt;from http://epplus.codeplex.com/discussions/392635&lt;/p&gt;
&lt;blockquote style="margin: 0.25em 1em 0px; padding: 0px 0.25em; border: 0.1em solid rgb(204, 204, 204); border-image: none; font-style: italic;"&gt;
&lt;strong&gt;jan wrote:&lt;/strong&gt;&lt;br&gt;
&lt;p&gt;EPPlus will use the datatype of the object for the cell values, so make sure you add the datatable colums as numeric if they contains numeric data. In this case there is no need to use the datatable. Set the cell values directly instead.&lt;/p&gt;
&lt;/blockquote&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Help on datavalidation for integer/decimal only">
      <Posts>
        <Post From="kavernlks" When="20/11/2012 06:55:47">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I am trying to have cells with integer/decimal only. Here is the link to actual excel datavalidation that i want to achieve.&lt;/p&gt;
&lt;p&gt;http://www.techonthenet.com/excel/cells/validation2_2010.php&lt;/p&gt;
&lt;p&gt;Currently trying out the integer.&lt;/p&gt;
&lt;p&gt;Here is my code&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;var&lt;/span&gt; validation3 = ws.DataValidations.AddIntegerValidation(&lt;span style="color: rgb(163, 21, 21);"&gt;"AI2:AI"&lt;/span&gt; + rowCount.ToString());
validation3.ShowErrorMessage = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
validation3.ErrorStyle = OfficeOpenXml.DataValidation.ExcelDataValidationWarningStyle.warnivalidation3.ErrorTitle = &lt;span style="color: rgb(163, 21, 21);"&gt;"An invalid value was entered"&lt;/span&gt;;
validation3.Error = &lt;span style="color: rgb(163, 21, 21);"&gt;"Must be integer only"&lt;/span&gt;;

validation3.Operator = OfficeOpenXml.DataValidation.ExcelDataValidationOperator.greaterThan;
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;When it runs it says i am missing some formula. I believe it is .Formula but not sure how the structure is. Any help ? Thanks.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="swmal" When="21/11/2012 06:23:20">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;The code you have supplied does add an integer validation to the range "AI2:AI..." and uses the greaterthan operator. But you also need to add the integer value it self to the validation (that it should be greater than).&lt;/p&gt;
&lt;p&gt;it is done this way:&lt;/p&gt;
&lt;pre&gt;validation.Formula.Value = 5;&lt;/pre&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;...if you want the validation to only allow values above 5.&lt;/p&gt;
&lt;p&gt;For more examples on DataValidation, download the samles (at the downloads section) and check out sample 11.&lt;/p&gt;
&lt;p&gt;/Mats&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="EPPlus with Classic ASP">
      <Posts>
        <Post From="mailarama" When="15/11/2012 15:45:53">
          <Html>
        
&lt;p&gt;Anyone have experience using EPPlus with Classic ASP? I need to read a .xlsm file from within a Classic ASP page, say excelreader.asp.&lt;/p&gt;
&lt;p&gt;I am calling excelreader.asp from within another page, say, master.asp. I am using AJAX from within master.asp to call excelreader.asp.&lt;/p&gt;
&lt;p&gt;Please do not get me wrong, I am not expecting anyone to write code for me. I am only looking for assistance with the EPPlus part of things; rest of it is contextual information.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Set name for the new shape - how?">
      <Posts>
        <Post From="Grzesiek" When="14/11/2012 15:15:50">
          <Html>
        
&lt;p&gt;Hello!&lt;/p&gt;
&lt;p&gt;Can anyone help me and explain how can I set the name for the new creating shape?&lt;/p&gt;
&lt;p&gt;My code at the moment is below:&lt;/p&gt;
&lt;p&gt;private void InsertLine(ShapesToAdd toAdd, Worksheet oSheet)&lt;/p&gt;
&lt;p&gt;{&lt;/p&gt;
&lt;p&gt;Microsoft.Office.Interop.Excel.Shape _shape = oSheet.Shapes.AddLine(toAdd.beginX, toAdd.beginY, toAdd.endX, toAdd.endY);&lt;/p&gt;
&lt;p&gt;//....&lt;/p&gt;
&lt;p&gt;}&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Named Table Styles">
      <Posts>
        <Post From="CellBent" When="14/11/2012 14:37:18">
          <Html>
        
&lt;p&gt;I love the implementation of NamedStyles.&amp;nbsp; Is there a way to create Named Table Styles?&amp;nbsp; I believe the Samples all assign prebuilt styles, which is handy, but I'd like to create a custom Table Style so that users can modify the style and all the
 tables using that style would get this change.&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks team for all your hard work.&amp;nbsp; EPPlus is awesome!&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Copy one worksheet to another workbook and loosing cell format.">
      <Posts>
        <Post From="Grzesiek" When="13/11/2012 19:36:11">
          <Html>
        
&lt;p&gt;Hello!&lt;br&gt;
&lt;br&gt;
I would like to copy worksheet from one workbook to another.&lt;/p&gt;
&lt;p&gt;I have problem after save, because I'm loosing style formats for my cells (date style is settings for numbers).&lt;/p&gt;
&lt;p&gt;Can anyone help me?&lt;/p&gt;
&lt;p&gt;Thanks.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Make Column or Cell protected.">
      <Posts>
        <Post From="bhavtoshsharma" When="24/05/2012 10:20:42">
          <Html>
        
&lt;p&gt;hi all,&lt;/p&gt;
&lt;p&gt;is there a way i can make a particular column or a cell *protected* using epplus? i still want that user should be able to edit everything else except *protected* column or cell&lt;/p&gt;
&lt;p&gt;i've already tested .Protection property of Worksheet object but this is protecting the whole sheet :(&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;thanks in advance&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="warkakw" When="12/11/2012 13:33:03">
          <Html>
        
&lt;p&gt;Hi&lt;br&gt;
&lt;br&gt;
I have similar problem. I want to protect worksheet without some range of cells. In EPPlus I see xml:&lt;/p&gt;
&lt;p&gt;&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;sheetProtection&lt;/span&gt;
&lt;span style="color: red;"&gt;sheet&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;1&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;
&lt;span style="color: red;"&gt;objects&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;1&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;
&lt;span style="color: red;"&gt;scenarios&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;1&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;
&lt;span style="color: blue;"&gt;/&amp;gt;&lt;br&gt;
&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;protectedRanges&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;protectedRange&lt;/span&gt;
&lt;span style="color: red;"&gt;sqref&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;D3:D11&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;
&lt;span style="color: red;"&gt;name&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;section1&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;
&lt;span style="color: blue;"&gt;/&amp;gt;&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;protectedRanges&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;...&lt;/p&gt;
&lt;p&gt;but I can't find it in epplus object. Range D3:D11 is editable and was created in Excel.&lt;/p&gt;
&lt;p&gt;Is this functionality implemented?&amp;nbsp;If Yes, where it is?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="warkakw" When="12/11/2012 13:37:51">
          <Html>
        
&lt;p&gt;hmmm&lt;/p&gt;
&lt;p&gt;I found the answer :)&lt;/p&gt;
&lt;p&gt;worksheets.Cells[row, col].Style.Locked = false;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="_x00D_ showing in Excel by using EPPlus 3.0 librery?">
      <Posts>
        <Post From="srikanthv" When="29/05/2012 20:56:44">
          <Html>
        
&lt;p&gt;I am using EPPlus 3.0 &amp;nbsp;library for download excel file. Everything working fine but some columns showing with&amp;nbsp;&lt;strong&gt;&lt;code&gt;"_x00D_"&lt;/code&gt;&lt;/strong&gt;&amp;nbsp;string on data. I researched in google, everybody saying it is newline character.
 I tried all scenarios still doesn't work. Please my code.&lt;/p&gt;
&lt;p&gt;Please advice me.&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;Using&lt;/span&gt; pck &lt;span style="color: blue;"&gt;As&lt;/span&gt; &lt;span style="color: blue;"&gt;New&lt;/span&gt; ExcelPackage()
                    &lt;span style="color: green;"&gt;'Create the worksheets&lt;/span&gt;
   &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; wsAll &lt;span style="color: blue;"&gt;As&lt;/span&gt; ExcelWorksheet = pck.Workbook.Worksheets.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"All"&lt;/span&gt;)
   &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; wsManufacturing &lt;span style="color: blue;"&gt;As&lt;/span&gt; ExcelWorksheet = pck.Workbook.Worksheets.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"Manufacturing"&lt;/span&gt;)
   &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; wsHealthcare &lt;span style="color: blue;"&gt;As&lt;/span&gt; ExcelWorksheet = pck.Workbook.Worksheets.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"Healthcare"&lt;/span&gt;)
   &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; wsManagement &lt;span style="color: blue;"&gt;As&lt;/span&gt; ExcelWorksheet = pck.Workbook.Worksheets.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"Management"&lt;/span&gt;)
   &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; wsSelling &lt;span style="color: blue;"&gt;As&lt;/span&gt; ExcelWorksheet = pck.Workbook.Worksheets.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"Selling"&lt;/span&gt;)

   &lt;span style="color: green;"&gt;'Load the datatable into the sheet, starting from cell A1. Print the column names on row 1&lt;/span&gt;
   wsAll.Cells(&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;).LoadFromDataTable(dtAllDownload, &lt;span style="color: blue;"&gt;True&lt;/span&gt;)
   &lt;span style="color: blue;"&gt;If&lt;/span&gt; dtManufacturing.Rows.&lt;span style="color: blue;"&gt;Count&lt;/span&gt; &amp;gt; 0 &lt;span style="color: blue;"&gt;Then&lt;/span&gt;
     wsManufacturing.Cells(&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;).LoadFromDataTable(dtManufacturing, &lt;span style="color: blue;"&gt;True&lt;/span&gt;)
   &lt;span style="color: blue;"&gt;End&lt;/span&gt; &lt;span style="color: blue;"&gt;If&lt;/span&gt;
   &lt;span style="color: blue;"&gt;If&lt;/span&gt; dtChinaHealthcare.Rows.&lt;span style="color: blue;"&gt;Count&lt;/span&gt; &amp;gt; 0 &lt;span style="color: blue;"&gt;Then&lt;/span&gt;
     wsHealthcare.Cells(&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;).LoadFromDataTable(dtHealthcare, &lt;span style="color: blue;"&gt;True&lt;/span&gt;)
   &lt;span style="color: blue;"&gt;End&lt;/span&gt; &lt;span style="color: blue;"&gt;If&lt;/span&gt;
   &lt;span style="color: blue;"&gt;If&lt;/span&gt; dtChinaManagement.Rows.&lt;span style="color: blue;"&gt;Count&lt;/span&gt; &amp;gt; 0 &lt;span style="color: blue;"&gt;Then&lt;/span&gt;
       wsManagement.Cells(&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;).LoadFromDataTable(dtManagement, &lt;span style="color: blue;"&gt;True&lt;/span&gt;)
   &lt;span style="color: blue;"&gt;End&lt;/span&gt; &lt;span style="color: blue;"&gt;If&lt;/span&gt;
   &lt;span style="color: blue;"&gt;If&lt;/span&gt; dtSelling.Rows.&lt;span style="color: blue;"&gt;Count&lt;/span&gt; &amp;gt; 0 &lt;span style="color: blue;"&gt;Then&lt;/span&gt;
      wsSelling.Cells(&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;).LoadFromDataTable(dtSelling, &lt;span style="color: blue;"&gt;True&lt;/span&gt;)
   &lt;span style="color: blue;"&gt;End&lt;/span&gt; &lt;span style="color: blue;"&gt;If&lt;/span&gt;

   &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; filename &lt;span style="color: blue;"&gt;As&lt;/span&gt; &lt;span style="color: blue;"&gt;String&lt;/span&gt; = &lt;span style="color: rgb(163, 21, 21);"&gt;"FullExtract_"&lt;/span&gt; &amp;amp; Now.Year.ToString &amp;amp; Now.Month.ToString &amp;amp; Now.Day.ToString &amp;amp; &lt;span style="color: rgb(163, 21, 21);"&gt;".xlsx"&lt;/span&gt;
    &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; fileBytes &lt;span style="color: blue;"&gt;As&lt;/span&gt; [&lt;span style="color: blue;"&gt;Byte&lt;/span&gt;]() = pck.GetAsByteArray()
    HttpContext.Current.Response.Clear()
    HttpContext.Current.Response.ClearContent()
    HttpContext.Current.Response.ClearHeaders()
    HttpContext.Current.Response.Cookies.Clear()
    HttpContext.Current.Response.Cache.SetCacheability(HttpCacheability.[&lt;span style="color: blue;"&gt;Private&lt;/span&gt;])
    HttpContext.Current.Response.CacheControl = &lt;span style="color: rgb(163, 21, 21);"&gt;"private"&lt;/span&gt;
    HttpContext.Current.Response.Charset = System.Text.UTF8Encoding.UTF8.WebName
    HttpContext.Current.Response.ContentEncoding = System.Text.UTF8Encoding.UTF8
    HttpContext.Current.Response.AppendHeader(&lt;span style="color: rgb(163, 21, 21);"&gt;"Content-Length"&lt;/span&gt;, fileBytes.Length.ToString())
    HttpContext.Current.Response.AppendHeader(&lt;span style="color: rgb(163, 21, 21);"&gt;"Pragma"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"cache"&lt;/span&gt;)
    HttpContext.Current.Response.AppendHeader(&lt;span style="color: rgb(163, 21, 21);"&gt;"Expires"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"60"&lt;/span&gt;)
    HttpContext.Current.Response.AddHeader(&lt;span style="color: rgb(163, 21, 21);"&gt;"content-disposition"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"attachment;  filename="&lt;/span&gt; &amp;amp; filename)
    HttpContext.Current.Response.ContentType = &lt;span style="color: rgb(163, 21, 21);"&gt;"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"&lt;/span&gt;
    HttpContext.Current.Response.BinaryWrite(fileBytes)
    HttpContext.Current.Response.[&lt;span style="color: blue;"&gt;End&lt;/span&gt;]()
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="phoxware" When="12/11/2012 08:42:51">
          <Html>
        
&lt;p&gt;Sure its a newline character issue, had same issue &amp;amp; fix by downloading the latest version of EpPlus package&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Changing trendline properties">
      <Posts>
        <Post From="rivaldo555" When="12/11/2012 08:01:40">
          <Html>
        
&lt;p&gt;Initially I have ExcelLineChart and added trendline to it. After that I want to remove all captions from trendline:&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;ExcelLineChart ec = (ExcelLineChart)wsGraph.Drawings.AddChart(graphic.graphicName, eChartType.Line);
for(...)
{
    ec.Series.Add(...);
    ec.Series[ec.Series.Count - 1].TrendLines.Add(eTrendLine.Linear);
    ec.Series[ec.Series.Count - 1].TrendLines.ElementAt(0).DisplayEquation = false;
    ec.Series[ec.Series.Count - 1].TrendLines.ElementAt(0).DisplayRSquaredValue = false;
}&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;And got error "Collection have no elements". It's strange, because then I open file - trendline exists in chart.&lt;br&gt;
&lt;br&gt;
So, how can I access properties of existing trendline?&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="SaveAs MemoryStream leads to unreadable content">
      <Posts>
        <Post From="blackpuppy" When="10/11/2012 03:53:32">
          <Html>
        
&lt;p&gt;I am using EPPlus 3.1.2 (added using NuGet).&amp;nbsp; The following test leads to unreadable content.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; [Test]&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; public void CanWriteExcle2007UsingStream()&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; string templateFilePath = @"D:\Temp\Template.xlsx";&amp;nbsp; // just an empty Excel workbook created by Excel 2010&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; string filePath = @"D:\Temp\Test.xlsx";&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; FileInfo templateFile = new FileInfo(templateFilePath);&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; using (ExcelPackage package = new ExcelPackage(templateFile, true))&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ExcelWorksheet worksheet = package.Workbook.Worksheets["Sheet1"];&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; worksheet.Cells[3, 2].Value = "Test Using Stream";&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; // using MemoryStream&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; using (MemoryStream ms = new MemoryStream())&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; package.SaveAs(ms);&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Assert.IsNotNull(ms);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Assert.IsTrue(ms.Length &amp;gt; 0);&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; SaveToFile(ms, filePath);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; protected void SaveToFile(MemoryStream ms, string filePath)&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; byte[] data = ms.GetBuffer();&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; SaveToFile(data, filePath);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; protected void SaveToFile(byte[] data, string filePath)&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; try&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; using (Stream file = File.OpenWrite(filePath))&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; file.Write(data, 0, data.Length);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; catch&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; throw;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;/p&gt;
&lt;p&gt;My project needs to use MemoryStream so it can be transferred between different layers.&amp;nbsp; After it's written to Test.xlsx, open it with Excel 2010.&amp;nbsp; And I got the following error message:&lt;/p&gt;
&lt;p&gt;Excel found unreadable content in 'Test.xlsx'.&amp;nbsp; Do you want to recover the content of this workbook?&amp;nbsp; If you trust the source of this workbook, click Yes.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="swmal" When="11/11/2012 19:03:28">
          <Html>
        
&lt;p&gt;Hi blackpuppy,&lt;/p&gt;
&lt;p&gt;This is not an EPPlus issue.&lt;/p&gt;
&lt;p&gt;Change ms.GetBuffer() to ms.ToArray(), delete Test.xlsx and rerun your test. GetBuffer() will return the entire buffer including unused bytes. ToArray() returns only the data.&lt;/p&gt;
&lt;p&gt;Regards,&lt;/p&gt;
&lt;p&gt;Mats&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="blackpuppy" When="12/11/2012 01:33:43">
          <Html>
        
&lt;p&gt;Hi, Mats,&lt;/p&gt;
&lt;p&gt;Ya, that does solve the problem. Thanks a lot!&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Best regards!&lt;/p&gt;
&lt;p&gt;Zhu Ming&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Style Changed After Saving ExcelPackage">
      <Posts>
        <Post From="benhysell" When="06/08/2012 18:32:37">
          <Html>
        
&lt;p&gt;Using the following code to open and close an existing Excel document:&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;FileInfo existingFile = &lt;span style="color: blue;"&gt;new&lt;/span&gt; FileInfo(excelFile);
&lt;span style="color: blue;"&gt;using&lt;/span&gt; (ExcelPackage wb = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(existingFile))
{
     wb.Save();
}
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;The style of the whole workbook is changed, any idea what might be happening here?&lt;/p&gt;
&lt;p&gt;Before I start my Excel workbook has a white background with all of the&amp;nbsp;grid lines&amp;nbsp;showing. &amp;nbsp;After saving the file with EPPlus the background turns yellow and all of the grid lines are gone.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="06/08/2012 18:47:14">
          <Html>
        
&lt;p&gt;Is this all your code? &amp;nbsp;If so, create an issue and upload xlsx file and your code.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="benhysell" When="06/08/2012 19:27:23">
          <Html>
        
&lt;p&gt;Right now it appears it is my Excel workbook and not the library. &amp;nbsp;Starting with an empty Excel file I can't reproduce the error.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="bad_j" When="09/11/2012 15:33:21">
          <Html>
        
&lt;p&gt;I have same issue, but I;ve created excel file from scratch and the problem remains...&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How convert xlsx to xml">
      <Posts>
        <Post From="Grief" When="24/10/2012 11:02:22">
          <Html>
        
&lt;p&gt;Hello!&lt;/p&gt;
&lt;p&gt;I have xlsx file. I want convert it into xml file. How I make did this?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="MespX78" When="02/11/2012 21:13:00">
          <Html>
        
&lt;p&gt;Read the Excel File&amp;nbsp; and put it on a DataSet, then use DataSet.WriteXML() to Create the XML file.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Taking a lot of time to create an Excel file with data">
      <Posts>
        <Post From="kailash_ravuri" When="02/11/2012 09:33:19">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;First of all, i like the features of Ep Plus and would like to implement in my project. For a test scenario i tried the following sample in a simple console&amp;nbsp;application. It is taking a lot of time.&amp;nbsp;Will it works like that or i am missing something.
 please help me&lt;/p&gt;
&lt;p&gt;The below example will add 10,000 rows for 10 columns&lt;/p&gt;
&lt;p&gt;CODE:&lt;/p&gt;
&lt;p&gt;&amp;nbsp;using (ExcelPackage package = new ExcelPackage(newFile))&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/p&gt;
&lt;p&gt;{ &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;// add a new worksheet to the empty workbook&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/p&gt;
&lt;p&gt;ExcelWorksheet ws1 = package.Workbook.Worksheets.Add("Inventory");&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;char[] alphabets = "ABCDEFGHIJ".ToCharArray();&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/p&gt;
&lt;p&gt;foreach (char ch in alphabets)&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; {&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/p&gt;
&lt;p&gt;for (int i = 1; i &amp;lt; 10000; i++)&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; {&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/p&gt;
&lt;p&gt;string cellName = ch + i.ToString();&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/p&gt;
&lt;p&gt;ws1.Cells[cellName].Value = "Sample Text";&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/p&gt;
&lt;p&gt;ws1.Cells[cellName].Style.Font.Bold = true;&amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp; }&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/p&gt;
&lt;p&gt;// save our new workbook and we are done!&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp; package.Save(); &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;Console.ReadKey();&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Output: it is taking 29-30 seconds for this example.&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Resources:&lt;/p&gt;
&lt;p&gt;&lt;span style="white-space: pre;"&gt;&lt;/span&gt;running sample in VSTS 2010, core i5 processor with 8 gb Ram and Windows 7 64-bit operating system&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Parse the Excel worksheet name from a cell address">
      <Posts>
        <Post From="DavidHary" When="31/10/2012 17:54:14">
          <Html>
        
&lt;p&gt;Presently, I use my own code to parse out the sheet name from cell addresses such as 'sheet1!A1'. The Excel Address class has an internal method that parses the sheet name.&amp;nbsp;&lt;/p&gt;
&lt;p&gt;My questions are:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Is there a public method that parses the cell address to return the sheet name?
&lt;/li&gt;&lt;li&gt;Would it make sense to add such functionally, perhaps to the Excel Address or the Excel Cell Address class or expose an existing internal method for this purpose?
&lt;/li&gt;&lt;/ol&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="WPPlus?">
      <Posts>
        <Post From="harag" When="31/10/2012 15:23:59">
          <Html>
        
&lt;p&gt;Hi all&lt;/p&gt;
&lt;p&gt;I've only just started using this and found it very useful and easy to use.&lt;/p&gt;
&lt;p&gt;Is there a WPPlus (Word Package Plus) version for accessing word documents?&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;
&lt;p&gt;H&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Changing series colors">
      <Posts>
        <Post From="Wegginho" When="29/10/2012 09:48:25">
          <Html>
        
&lt;p&gt;Hey everyone,&lt;/p&gt;
&lt;p&gt;seems to me like a pretty simple task but I don't really understand how to change the series color of a stacked column char. Or have you already implemented some function to do that Jan?&lt;/p&gt;
&lt;p&gt;Kind regards &amp;amp; keep on the good work!&lt;/p&gt;
&lt;p&gt;Bastian&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to find Headerrow">
      <Posts>
        <Post From="mnvraghuram" When="24/10/2012 22:13:41">
          <Html>
        
&lt;p&gt;Hi&lt;/p&gt;
&lt;p&gt;I am looking a way to find out the header row in somecases it can be row 1 or row 2 so if we use the oledb adapter it does it but not sure how&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Problem with large files">
      <Posts>
        <Post From="houssam_hamdan" When="11/06/2010 15:33:16">
          <Html>
        
&lt;p&gt;Hello,&lt;/p&gt;
&lt;p&gt;We are using your library in our asp.net project whereby the administrator exports the list of customers to excel. It is working successfully for 62,344 rows in excel file (approx. 5 mb) on the development server. Unfortunately, the export does not work
 on production server only when the file exceeds 4 mb. !?&lt;/p&gt;
&lt;p&gt;Any help would be highly appreciated.&lt;/p&gt;
&lt;p&gt;Best Regards,&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="13/06/2010 19:31:44">
          <Html>
        
&lt;p&gt;Do you upload a file to the server? If so I think the default max size in&amp;nbsp;IIS is 4MB. You can change it somewhere&amp;nbsp;in the machine.config file,&amp;nbsp;I think.&lt;/p&gt;
&lt;p&gt;Jan&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="houssam_hamdan" When="14/06/2010 06:58:12">
          <Html>
        
&lt;p&gt;Hello Jan,&lt;/p&gt;
&lt;p&gt;No File System included. I just return the array of byte[] &amp;gt; 4 MB generated on the server and having the following exception:&lt;/p&gt;
&lt;p&gt;Message: Access is denied. (Exception from HRESULT: 0x80070005 (E_ACCESSDENIED)), Trace:&amp;nbsp;&amp;nbsp;&amp;nbsp; at System.IO.IsolatedStorage.IsolatedStorageFile.nGetRootDir(IsolatedStorageScope scope)&lt;br&gt;
&amp;nbsp;&amp;nbsp; at System.IO.IsolatedStorage.IsolatedStorageFile.InitGlobalsNonRoamingUser(IsolatedStorageScope scope)&lt;br&gt;
&amp;nbsp;&amp;nbsp; at System.IO.IsolatedStorage.IsolatedStorageFile.GetRootDir(IsolatedStorageScope scope)&lt;br&gt;
&amp;nbsp;&amp;nbsp; at System.IO.IsolatedStorage.IsolatedStorageFile.GetGlobalFileIOPerm(IsolatedStorageScope scope)&lt;br&gt;
&amp;nbsp;&amp;nbsp; at System.IO.IsolatedStorage.IsolatedStorageFile.Init(IsolatedStorageScope scope)&lt;br&gt;
&amp;nbsp;&amp;nbsp; at System.IO.IsolatedStorage.IsolatedStorageFile.GetStore(IsolatedStorageScope scope, Type domainEvidenceType, Type assemblyEvidenceType)&lt;br&gt;
&amp;nbsp;&amp;nbsp; at MS.Internal.IO.Packaging.PackagingUtilities.ReliableIsolatedStorageFileFolder.GetCurrentStore()&lt;br&gt;
&amp;nbsp;&amp;nbsp; at MS.Internal.IO.Packaging.PackagingUtilities.ReliableIsolatedStorageFileFolder..ctor()&lt;br&gt;
&amp;nbsp;&amp;nbsp; at MS.Internal.IO.Packaging.PackagingUtilities.GetDefaultIsolatedStorageFile()&lt;br&gt;
&amp;nbsp;&amp;nbsp; at MS.Internal.IO.Packaging.PackagingUtilities.CreateUserScopedIsolatedStorageFileStreamWithRandomName(Int32 retryCount, String&amp;amp; fileName)&lt;br&gt;
&amp;nbsp;&amp;nbsp; at MS.Internal.IO.Packaging.SparseMemoryStream.EnsureIsolatedStoreStream()&lt;br&gt;
&amp;nbsp;&amp;nbsp; at MS.Internal.IO.Packaging.SparseMemoryStream.SwitchModeIfNecessary()&lt;br&gt;
&amp;nbsp;&amp;nbsp; at MS.Internal.IO.Packaging.SparseMemoryStream.Write(Byte[] buffer, Int32 offset, Int32 count)&lt;br&gt;
&amp;nbsp;&amp;nbsp; at MS.Internal.IO.Packaging.CompressEmulationStream.Write(Byte[] buffer, Int32 offset, Int32 count)&lt;br&gt;
&amp;nbsp;&amp;nbsp; at MS.Internal.IO.Packaging.CompressStream.Write(Byte[] buffer, Int32 offset, Int32 count)&lt;br&gt;
&amp;nbsp;&amp;nbsp; at MS.Internal.IO.Zip.ProgressiveCrcCalculatingStream.Write(Byte[] buffer, Int32 offset, Int32 count)&lt;br&gt;
&amp;nbsp;&amp;nbsp; at MS.Internal.IO.Zip.ZipIOModeEnforcingStream.Write(Byte[] buffer, Int32 offset, Int32 count)&lt;br&gt;
&amp;nbsp;&amp;nbsp; at System.IO.StreamWriter.Flush(Boolean flushStream, Boolean flushEncoder)&lt;br&gt;
&amp;nbsp;&amp;nbsp; at System.IO.StreamWriter.Write(String value)&lt;br&gt;
&amp;nbsp;&amp;nbsp; at System.IO.TextWriter.Write(String format, Object arg0, Object arg1)&lt;br&gt;
&amp;nbsp;&amp;nbsp; at OfficeOpenXml.ExcelWorksheet.UpdateRowCellData(StreamWriter sw)&lt;br&gt;
&amp;nbsp;&amp;nbsp; at OfficeOpenXml.ExcelWorksheet.SaveXml()&lt;br&gt;
&amp;nbsp;&amp;nbsp; at OfficeOpenXml.ExcelWorksheet.Save()&lt;br&gt;
&amp;nbsp;&amp;nbsp; at OfficeOpenXml.ExcelWorkbook.Save()&lt;br&gt;
&amp;nbsp;&amp;nbsp; at OfficeOpenXml.ExcelPackage.GetAsByteArray(Boolean save)&lt;br&gt;
&amp;nbsp;&amp;nbsp; at OfficeOpenXml.ExcelPackage.GetAsByteArray()&amp;nbsp;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I will search how to change the 4 MB default Max as you suggested and let you know.&lt;/p&gt;
&lt;p&gt;Thank you for your help.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="14/06/2010 07:12:03">
          <Html>
        
&lt;p&gt;Seems to be a permission problem with isolated storage. Found &lt;a title="this" href="http://labs.episerver.com/en/Blogs/Svante-Seleborg/Dates/2008/10/IsolatedStorage-Access-Denied/" rel="nofollow"&gt;
this&lt;/a&gt;&amp;nbsp;when i had a quick search.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="houssam_hamdan" When="15/06/2010 06:12:02">
          <Html>
        
&lt;p&gt;Great article,&lt;/p&gt;
&lt;p&gt;After creating the IsolatedStorage folder at the right location and setting the designated permission. Everything worked as expected.&lt;/p&gt;
&lt;p&gt;Thank you for your kind cooperation.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Sohaibs" When="18/08/2011 20:18:44">
          <Html>
        
&lt;p&gt;I also had the same issue. I followed that article but now I get the error below. Any ideas what it could be?&lt;/p&gt;
&lt;p&gt;Thank You&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: Arial,Helvetica,Geneva,SunSans-Regular,sans-serif;"&gt;System.IO.IsolatedStorage.IsolatedStorageException: Initialization failed.&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: Arial,Helvetica,Geneva,SunSans-Regular,sans-serif;"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;pre&gt;[IsolatedStorageException: Initialization failed.]
   System.IO.IsolatedStorage.IsolatedStorageFile.CreateRandomDirectory(String rootDir) +131
   System.IO.IsolatedStorage.IsolatedStorageFile.InitGlobalsNonRoamingUser(IsolatedStorageScope scope) +244
   System.IO.IsolatedStorage.IsolatedStorageFile.GetRootDir(IsolatedStorageScope scope) +137
   System.IO.IsolatedStorage.IsolatedStorageFile.GetGlobalFileIOPerm(IsolatedStorageScope scope) +213
   System.IO.IsolatedStorage.IsolatedStorageFile.Init(IsolatedStorageScope scope) +56
   System.IO.IsolatedStorage.IsolatedStorageFile.GetStore(IsolatedStorageScope scope, Type domainEvidenceType, Type assemblyEvidenceType) +59
   MS.Internal.IO.Packaging.ReliableIsolatedStorageFileFolder.GetCurrentStore() +34
   MS.Internal.IO.Packaging.ReliableIsolatedStorageFileFolder..ctor() +64
   MS.Internal.IO.Packaging.PackagingUtilities.GetDefaultIsolatedStorageFile() +54
   MS.Internal.IO.Packaging.PackagingUtilities.CreateUserScopedIsolatedStorageFileStreamWithRandomName(Int32 retryCount, String&amp;amp; fileName) +114
   MS.Internal.IO.Packaging.SparseMemoryStream.EnsureIsolatedStoreStream() +23
   MS.Internal.IO.Packaging.SparseMemoryStream.SwitchModeIfNecessary() +310
   MS.Internal.IO.Packaging.SparseMemoryStream.Write(Byte[] buffer, Int32 offset, Int32 count) +184
   MS.Internal.IO.Packaging.DeflateEmulationTransform.Decompress(Stream source, Stream sink) +198
   MS.Internal.IO.Packaging.CompressEmulationStream..ctor(Stream baseStream, Stream tempStream, Int64 position, IDeflateTransform transformer) +163
   MS.Internal.IO.Packaging.CompressStream.ChangeMode(Mode newMode) +246
   MS.Internal.IO.Packaging.CompressStream.Seek(Int64 offset, SeekOrigin origin) +313
   MS.Internal.IO.Zip.ProgressiveCrcCalculatingStream.Seek(Int64 offset, SeekOrigin origin) +34
   MS.Internal.IO.Zip.ZipIOModeEnforcingStream.Read(Byte[] buffer, Int32 offset, Int32 count) +159
   System.IO.StreamReader.ReadBuffer(Char[] userBuffer, Int32 userOffset, Int32 desiredChars, Boolean&amp;amp; readToUserBuffer) +82
   System.IO.StreamReader.Read(Char[] buffer, Int32 index, Int32 count) +119
   System.IO.TextReader.ReadBlock(Char[] buffer, Int32 index, Int32 count) +32
   OfficeOpenXml.ExcelWorksheet.GetWorkSheetXml(Stream stream, Int64 start, Int64 end) +153
   OfficeOpenXml.ExcelWorksheet.CreateXml() +219
   OfficeOpenXml.ExcelWorksheet..ctor(XmlNamespaceManager ns, ExcelPackage excelPackage, String relID, Uri uriWorksheet, String sheetName, Int32 sheetID, Int32 positionID, eWorkSheetHidden hide) +620
   OfficeOpenXml.ExcelWorksheets..ctor(ExcelPackage xlPackage) +752
   OfficeOpenXml.ExcelWorkbook.get_Worksheets() +32
   test.myTest() in E:\inetpub\ea\PayrollDeductions\test.aspx.cs:76
   test.onClick(Object sender, EventArgs e) in E:\inetpub\ea\PayrollDeductions\test.aspx.cs:49
   System.Web.UI.WebControls.Button.OnClick(EventArgs e) +111
   System.Web.UI.WebControls.Button.RaisePostBackEvent(String eventArgument) +110
   System.Web.UI.WebControls.Button.System.Web.UI.IPostBackEventHandler.RaisePostBackEvent(String eventArgument) +10
   System.Web.UI.Page.RaisePostBackEvent(IPostBackEventHandler sourceControl, String eventArgument) +13
   System.Web.UI.Page.RaisePostBackEvent(NameValueCollection postData) +36
   System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +1565&lt;/pre&gt;

&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="23/08/2011 19:59:14">
          <Html>
        
&lt;p&gt;Not sure, I haven't had this problem, but Isolated storage have a build in limit of 1Mb, so make sure the user running the context&amp;nbsp;have permission to write to the isolateds storage folder.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="markpittsnh" When="20/10/2011 17:12:18">
          <Html>
        
&lt;p&gt;I am reading an excel file, of over 5MB, using a stream.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;using (var package = new ExcelPackage(this._Stream))&lt;/p&gt;
&lt;p&gt;I am encountering this error.&lt;/p&gt;
&lt;p&gt;Any suggestions would be appreciated.&lt;/p&gt;
&lt;p&gt;Message "Unable to determine the identity of domain."&lt;br&gt;
&lt;br&gt;
StackTrace &amp;nbsp;&amp;nbsp; at System.IO.IsolatedStorage.IsolatedStorage._GetAccountingInfo(Evidence evidence, Type evidenceType, IsolatedStorageScope fAssmDomApp, Object&amp;amp; oNormalized)&amp;nbsp; at System.IO.IsolatedStorage.IsolatedStorage.GetAccountingInfo(Evidence
 evidence, Type evidenceType, IsolatedStorageScope fAssmDomApp, String&amp;amp; typeName, String&amp;amp; instanceName)&amp;nbsp; at System.IO.IsolatedStorage.IsolatedStorage._InitStore(IsolatedStorageScope scope, Evidence domainEv, Type domainEvidenceType, Evidence assemEv,
 Type assemblyEvidenceType, Evidence appEv, Type appEvidenceType)&amp;nbsp; at System.IO.IsolatedStorage.IsolatedStorage.InitStore(IsolatedStorageScope scope, Type domainEvidenceType, Type assemblyEvidenceType)&amp;nbsp; at System.IO.IsolatedStorage.IsolatedStorageFile.GetStore(IsolatedStorageScope
 scope, Type domainEvidenceType, Type assemblyEvidenceType)&amp;nbsp; at MS.Internal.IO.Packaging.PackagingUtilities.ReliableIsolatedStorageFileFolder..ctor()&amp;nbsp; at MS.Internal.IO.Packaging.PackagingUtilities.GetDefaultIsolatedStorageFile()&amp;nbsp; at MS.Internal.IO.Packaging.PackagingUtilities.CreateUserScopedIsolatedStorageFileStreamWithRandomName(Int32
 retryCount, String&amp;amp; fileName)&amp;nbsp; at MS.Internal.IO.Packaging.SparseMemoryStream.EnsureIsolatedStoreStream()&amp;nbsp; at MS.Internal.IO.Packaging.SparseMemoryStream.SwitchModeIfNecessary()&amp;nbsp; at MS.Internal.IO.Packaging.DeflateEmulationTransform.Decompress(Stream
 source, Stream sink)&amp;nbsp; at MS.Internal.IO.Packaging.CompressEmulationStream..ctor(Stream baseStream, Stream tempStream, Int64 position, IDeflateTransform transformer)&amp;nbsp; at MS.Internal.IO.Packaging.CompressStream.ChangeMode(Mode newMode)&amp;nbsp; at MS.Internal.IO.Packaging.CompressStream.Seek(Int64
 offset, SeekOrigin origin)&amp;nbsp; at MS.Internal.IO.Zip.ProgressiveCrcCalculatingStream.Seek(Int64 offset, SeekOrigin origin)&amp;nbsp; at MS.Internal.IO.Zip.ZipIOModeEnforcingStream.Read(Byte[] buffer, Int32 offset, Int32 count)&amp;nbsp; at System.IO.StreamReader.ReadBuffer(Char[]
 userBuffer, Int32 userOffset, Int32 desiredChars, Boolean&amp;amp; readToUserBuffer)&amp;nbsp; at System.IO.StreamReader.Read(Char[] buffer, Int32 index, Int32 count)&amp;nbsp; at System.IO.TextReader.ReadBlock(Char[] buffer, Int32 index, Int32 count)&amp;nbsp; at OfficeOpenXml.ExcelWorksheet.GetWorkSheetXml(Stream
 stream, Int64 start, Int64 end)&amp;nbsp; at OfficeOpenXml.ExcelWorksheet.CreateXml()&amp;nbsp; at OfficeOpenXml.ExcelWorksheet..ctor(XmlNamespaceManager ns, ExcelPackage excelPackage, String relID, Uri uriWorksheet, String sheetName, Int32 sheetID, Int32 positionID,
 eWorkSheetHidden hide)&amp;nbsp; at OfficeOpenXml.ExcelWorksheets..ctor(ExcelPackage xlPackage)&amp;nbsp; at OfficeOpenXml.ExcelWorkbook.get_Worksheets()&amp;nbsp; at OfficeOpenXml.ExcelWorkbook.GetDefinedNames()&amp;nbsp; at OfficeOpenXml.ExcelPackage.get_Workbook()&amp;nbsp;
 at Sylvania.LRG.Adapter.ExcelAdapter.ImportFromExcelFile()&amp;nbsp; at SharePoint.SiteMapGeneratorFeature.LoadLRGData.ImportData()&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="28/10/2011 15:07:09">
          <Html>
        
&lt;p&gt;No, I haven't had this problem, but my guess is that this is a permission problem when isolated storage tries to write to disc.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="amircharania" When="12/01/2012 21:26:14">
          <Html>
        
&lt;p&gt;My file sizes were 2 times larger before implementing this workaround. Basically, I now check to see if what is being written to the cell has a valid value or is an empty string. If it is empty, I simply skip writing to that cell. Since many of the cells
 are empty, it reduces file size by 50%.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;if (String.IsNullOrEmpty(Convert.ToString(row[j]))&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; || Convert.ToString(row[j]) == ""&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;
 &amp;nbsp; &amp;nbsp; &amp;nbsp; )&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; {&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;
 &amp;nbsp; &amp;nbsp; else&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; {&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I spent a lot of time figuring this out, hopefully, you won't have too :)&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="richardtallent" When="24/10/2012 21:18:44">
          <Html>
        
&lt;p&gt;After 10MB, System.IO.Packaging automatically switches to Isolated File Storage, which is not actually available in some situations (particularly running on a server). This behavior cannot be changed within EPPlus, it's part of the MS BCL.&lt;/p&gt;
&lt;p&gt;Related issue and more information:&lt;/p&gt;
&lt;p&gt;&lt;a href="http://epplus.codeplex.com/workitem/14762" rel="nofollow"&gt;http://epplus.codeplex.com/workitem/14762&lt;/a&gt;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Store must be open for this operation">
      <Posts>
        <Post From="PatsPal2011" When="16/03/2011 22:41:31">
          <Html>
        
&lt;p&gt;I have a .NET console application that uses EPPlus. Running more then one instances of the console application produces the error "Store must be open for this operation".&amp;nbsp; It ocurrs when performing a save on the package. Any ideas? The stack
 trace is;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-size: x-small;"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;at System.IO.IsolatedStorage.IsolatedStorageFile.Lock()&lt;/p&gt;
&lt;p&gt;at System.IO.IsolatedStorage.IsolatedStorageFileStream..ctor(String path, FileMode mode, FileAccess access, FileShare share, Int32 bufferSize, IsolatedStorageFile isf)&lt;/p&gt;
&lt;p&gt;at MS.Internal.IO.Packaging.PackagingUtilities.SafeIsolatedStorageFileStream..ctor(String path, FileMode mode, FileAccess access, FileShare share, ReliableIsolatedStorageFileFolder folder)&lt;/p&gt;
&lt;p&gt;at MS.Internal.IO.Packaging.PackagingUtilities.CreateUserScopedIsolatedStorageFileStreamWithRandomName(Int32 retryCount, String&amp;amp; fileName)&lt;/p&gt;
&lt;p&gt;at MS.Internal.IO.Packaging.SparseMemoryStream.EnsureIsolatedStoreStream()&lt;/p&gt;
&lt;p&gt;at MS.Internal.IO.Packaging.SparseMemoryStream.SwitchModeIfNecessary()&lt;/p&gt;
&lt;p&gt;at MS.Internal.IO.Packaging.SparseMemoryStream.Write(Byte[] buffer, Int32 offset, Int32 count)&lt;/p&gt;
&lt;p&gt;at MS.Internal.IO.Packaging.CompressEmulationStream.Write(Byte[] buffer, Int32 offset, Int32 count)&lt;/p&gt;
&lt;p&gt;at MS.Internal.IO.Packaging.CompressStream.Write(Byte[] buffer, Int32 offset, Int32 count)&lt;/p&gt;
&lt;p&gt;at MS.Internal.IO.Zip.ProgressiveCrcCalculatingStream.Write(Byte[] buffer, Int32 offset, Int32 count)&lt;/p&gt;
&lt;p&gt;at MS.Internal.IO.Zip.ZipIOModeEnforcingStream.Write(Byte[] buffer, Int32 offset, Int32 count)&lt;/p&gt;
&lt;p&gt;at System.IO.StreamWriter.Flush(Boolean flushStream, Boolean flushEncoder)&lt;/p&gt;
&lt;p&gt;at System.IO.StreamWriter.Write(String value)&lt;/p&gt;
&lt;p&gt;at System.IO.TextWriter.Write(String format, Object arg0, Object arg1)&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="17/03/2011 19:51:36">
          <Html>
        
&lt;p&gt;No, I have never heard of this problem before. But it seams it is a problem with the isolated storage used by the System.Packaging API.&lt;/p&gt;
&lt;p&gt;I can have a look at it if you create an issue and attach some code to reproduce the problem.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="patspal2011" When="17/03/2011 22:50:22">
          <Html>
        
&lt;p&gt;Create a simple console application and reference the epplus library. Run two or more instance of the console application where template and newfile are commandline args (diff for each instance) and you will recieve the error. The files sizes to be produced
 are around 13,500KB. IsolatedStorage was also my guess but I can't find a solution. I also believe it has something to do with the file size. Running a single instance is no problem. Each instance runs under the same user/domain.&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;using&lt;/span&gt; (ExcelPackage xlPackage = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(newFile, template))
{

&lt;span style="color: green;"&gt;// get the data and fill rows onwards&lt;/span&gt;
    &lt;span style="color: blue;"&gt;foreach&lt;/span&gt; (DataRow drRow &lt;span style="color: blue;"&gt;in&lt;/span&gt; dt.Rows)
     {
                               
           xlcol = 1;
           &lt;span style="color: blue;"&gt;foreach&lt;/span&gt; (DataColumn dcCol &lt;span style="color: blue;"&gt;in&lt;/span&gt; dt.Columns)
          {
                                   
               xlworksheet.Cell(xlrow, xlcol++).Value = drRow[dcCol];
           }
          xlrow++;
      }

xlPackage.Save();

{
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="18/03/2011 15:41:28">
          <Html>
        
&lt;p&gt;I had a quick search for this and it might be the isolated storage size that need to be increased.&lt;/p&gt;
&lt;p&gt;Not sure if this will help, but check this thread...&lt;/p&gt;
&lt;p&gt;&lt;a href="http://forums.silverlight.net/forums/p/189926/437329.aspx" rel="nofollow"&gt;http://forums.silverlight.net/forums/p/189926/437329.aspx&lt;/a&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="patspal2011" When="18/03/2011 18:47:00">
          <Html>
        
&lt;p&gt;I don't think it is the size. My guess is that multiple instances are sharing the same isolatedstorge file. This is because both instances running are running under the same user. So if the file is locked then I think a timeout occurs and hence the﻿ ﻿﻿"Store
 must be Open". I'm running a test where I run the same EXE from two separate machines... I will let you know but if this is the case I have no clue on how to resolve it? Maybe a mutex? Or maybe create a new appdomain for each instance?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="patspal2011" When="21/03/2011 18:20:44">
          <Html>
        
&lt;p&gt;I found this on the openxml website. Any ideas?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div id="_ctl0__ctl1_bcr__ctl0___PostRepeater__ctl3_PostViewWrapper"&gt;
&lt;p&gt;Hi All,&lt;/p&gt;
&lt;p&gt;I have found a resolution to the problem I mentioned yesterday. I apologise for not being able to update.I guess I'll try to explain what was happening but would be nice if you guys can have a better explanation.&lt;/p&gt;
&lt;p&gt;There seemed to be a problem with the' initial' Package instance, some kind of 'resource leak' has occured that .Net has reported as &amp;nbsp;Access Denied or probably something held on to a resource during the Save operation. I'll reiterate the sequence&amp;nbsp;that
 I did to reproduce the problem at a high level.&lt;/p&gt;
&lt;p&gt;1. Open the docx file in '&lt;strong&gt;&lt;span style="text-decoration: underline;"&gt;ReadWrite'&lt;/span&gt;&lt;/strong&gt; mode using the Package.Open&lt;/p&gt;
&lt;p&gt;2. Access the Document Part and Load it into a XmlDocument object&lt;/p&gt;
&lt;p&gt;3. A helper class &amp;nbsp;builds the document.xml with the data.&lt;/p&gt;
&lt;p&gt;4. A streamWriter is created.&lt;/p&gt;
&lt;p&gt;5.&amp;nbsp; XMLDocument.Save(outStream) - This is where the exception was thrown on IIS.(Not on local dev server!!! Why is that ?)&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Resolution&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;1. I modified the initial Package access mode to '&lt;strong&gt;Read'&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Steps 2 ,3 and 4 remain the same.&lt;/p&gt;
&lt;p&gt;5. I &lt;strong&gt;closed &lt;/strong&gt;the package instance and re-opened in '&lt;strong&gt;ReadWrite'&lt;/strong&gt; mode&lt;/p&gt;
&lt;p&gt;6.&amp;nbsp; XmlDocument.Save(outstream) -&amp;nbsp; (End result: Success)&lt;/p&gt;
&lt;p&gt;Basically there seemed to be a problem with the &lt;strong&gt;package/zip file&lt;/strong&gt;. I don't know why though but it's narrowed down to it. Though I can get my application across to production with more testing, &amp;nbsp;I'd be keen to know what the underlying
 problem really is.&lt;/p&gt;
&lt;p&gt;For those of you who have used this mechanism of Opening a package and writing to document.xml, could you try a stress test(huge data that takes a bit of time to get to the Save part)&amp;nbsp;and see how it handles it.&lt;/p&gt;
&lt;p&gt;I hope to have explained it. Again thanks for those who responded and viewed.&lt;/p&gt;
&lt;p&gt;Cheers&lt;/p&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="25/03/2011 15:56:20">
          <Html>
        
&lt;p&gt;It's would be a&amp;nbsp;lot of work to implement this workaround and I'm not convinced it will solve your problem.&lt;/p&gt;
&lt;p&gt;When I get some time over I will try to do a stresstest and see if I can reproduce this error.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="patspal2011" When="26/03/2011 18:03:36">
          <Html>
        
&lt;p&gt;Much appreciated. I'm pulling my hair out over this one. I have to schedule the creation of excel docs at different times or on different machines unless the isolatedstorage error occurs. Running in windows 2003 or XP with framework 3.5 doesn't allow you
 to increase the isolatedstorge qouta. As I said it only seems to occur with larger files, at least that is my assumption because the error doesn't occur when I run simutanously with small size files being produced so I assume I'm running into a isolatedstorage
 size issue. Anyway, the plans are to use this solution increasingly and I will start running into issue trying to schedule the generation of excel workbooks avoiding running the app at the same time on the same machine by the same service user. Any input from
 anyone reading this is so much appreciated.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="fkfouri" When="23/04/2012 14:32:00">
          <Html>
        
&lt;p&gt;Dear All...&lt;/p&gt;
&lt;p&gt;This problem is associeated the buffer server limit (IIS).&lt;/p&gt;
&lt;p&gt;You need increase the attribute AspBufferingLimit in MetaBase.xml.&lt;/p&gt;
&lt;p&gt;Beware when manipulate this file... you could increase the fragility at Server.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="richardtallent" When="23/10/2012 22:34:43">
          <Html>
        
&lt;p&gt;fkfouri is absolutely wrong --&amp;nbsp;AspBufferingLimit is related to ASP, not ASP.NET, and has been replaced anyway with the &amp;lt;limits&amp;gt; directive.&lt;/p&gt;
&lt;p&gt;The issue is related directly to the size of the document being produced. Above a certain size,
&lt;span&gt;MS.Internal.IO.Packaging.SparseMemoryStream attempts to use Isolated Storage for the zip file rather than&lt;/span&gt;&amp;nbsp;keeping it in memory. On a development machine, where IIS generally impersonates a real user, this isn't a big problem.&lt;/p&gt;
&lt;p&gt;But when running as Network Service or&amp;nbsp;ApplicationPoolIdentity, there's something wonky with using IsolatedFileStorage. Various people have looked at registry entries, creating or changing ACLs on isolated storage temporary directories, and locking
 the type to prevent multi-threaded access. None of these paths seem to be working for me.&lt;/p&gt;
&lt;p&gt;I believe the problem just gets worse when generating more than one file at a time, and in that case, I think the IsolatedFileStorage quota is the issue.&amp;nbsp;If a single file is large enough, it has the same problem, and I'm not convinced yet that
&lt;em&gt;any&lt;/em&gt;&amp;nbsp;file that is large enough to use IsolatedFileStorage will successfully generate over IIS in a production environment.&lt;/p&gt;
&lt;p&gt;I'm also pulling my hair out here. I can't be sure, but I think this got worse when I switched from WOW32 to 64-bit mode in IIS -- but that may just be because I made the switch to support larger workbooks.&lt;/p&gt;
&lt;p&gt;I think the only course of action is to re-implement the internals of Microsoft's Packaging library, but without the use on IsolatedFileStorage. The symbol libraries are available freely and would someone to create an alternative packaging API with that
 minor tweak, but mucking around in VS to do this is just beyond the time I can commit to learn.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="23/10/2012 22:49:06">
          <Html>
        
&lt;p&gt;richard,&lt;/p&gt;
&lt;p&gt;Yes, you are right. &amp;nbsp;&lt;span&gt;I've done a little research too and for now I think the only way is change&amp;nbsp;&lt;/span&gt;&lt;span&gt;System.IO.Packaging&lt;/span&gt;&lt;span&gt;&amp;nbsp;to another one, like donetzip, but it isnt a simple task, there are a high coupling between
 epplus and packaging api. I´ve had this issue in my production server too, if you want to reproduce it more easily, you can just create a file in isolated storage, like this:&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;br&gt;
&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;            &lt;span style="color: blue;"&gt;try&lt;/span&gt;
            {                
                &lt;span style="color: blue;"&gt;var&lt;/span&gt; store1 = IsolatedStorageFile.GetUserStoreForDomain();
                store1.CreateDirectory(&lt;span style="color: rgb(163, 21, 21);"&gt;"Test1_"&lt;/span&gt; + DateTime.Now.Ticks.ToString());                
                IsolatedStorageFileStream isoStream1 = &lt;span style="color: blue;"&gt;new&lt;/span&gt; IsolatedStorageFileStream(DateTime.Now.Ticks.ToString() + &lt;span style="color: rgb(163, 21, 21);"&gt;"_InTheRoot1.txt"&lt;/span&gt;, FileMode.Create, store1);                
                isoStream1.Close();                
            }
            &lt;span style="color: blue;"&gt;catch&lt;/span&gt;(Exception e)
            {   
            }
			

            &lt;span style="color: blue;"&gt;try&lt;/span&gt;
            {
                &lt;span style="color: blue;"&gt;var&lt;/span&gt; store2 = IsolatedStorageFile.GetUserStoreForAssembly();
                store2.CreateDirectory(&lt;span style="color: rgb(163, 21, 21);"&gt;"Test2_"&lt;/span&gt; + DateTime.Now.Ticks.ToString());                
                IsolatedStorageFileStream isoStream2 = &lt;span style="color: blue;"&gt;new&lt;/span&gt; IsolatedStorageFileStream(DateTime.Now.Ticks.ToString() + &lt;span style="color: rgb(163, 21, 21);"&gt;"_InTheRoot2.txt"&lt;/span&gt;, FileMode.Create, store2);
                isoStream2.Close();                

            }
            &lt;span style="color: blue;"&gt;catch&lt;/span&gt; (Exception e)
            {
            }


            &lt;span style="color: blue;"&gt;try&lt;/span&gt;
            {
                &lt;span style="color: blue;"&gt;var&lt;/span&gt; store3 = IsolatedStorageFile.GetUserStoreForApplication();
                store3.CreateDirectory(&lt;span style="color: rgb(163, 21, 21);"&gt;"Test3_"&lt;/span&gt; + DateTime.Now.Ticks.ToString());
                IsolatedStorageFileStream isoStream3 = &lt;span style="color: blue;"&gt;new&lt;/span&gt; IsolatedStorageFileStream(DateTime.Now.Ticks.ToString() + &lt;span style="color: rgb(163, 21, 21);"&gt;"_InTheRoot3.txt"&lt;/span&gt;, FileMode.Create, store3);

            }
            &lt;span style="color: blue;"&gt;catch&lt;/span&gt; (Exception e)
            {
            }			
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I don't know exactly how our infra team fixed that problem, but I know they find out where create isolated storage folder and gave permissions for our app pool user.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="richardtallent" When="24/10/2012 21:10:12">
          <Html>
        
&lt;p&gt;I've done a bit more research and opened up a separate Issue with more details.&lt;/p&gt;
&lt;p&gt;&lt;a href="http://epplus.codeplex.com/workitem/14762" rel="nofollow"&gt;http://epplus.codeplex.com/workitem/14762&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;(I figured a new issue would be better than continuing this one.)&lt;/p&gt;
&lt;p&gt;As an aside, I &lt;em&gt;may &lt;/em&gt;have found a workaround for me -- I'm now running my IIS application pool under a newly-created, local user account rather than AppPoolIdentity or Network Service. Since switching, I've been able to generate and open much larger
 files than before at least and haven't seen this issue again.&lt;/p&gt;
&lt;p&gt;That's not a workable solution for some people, but it's at least an option for people generating Excel files server-side in an intranet environment.&lt;/p&gt;
&lt;p&gt;I've suggested porting the code from Mono's implementation of System.IO.Packaging, since it is also LGPL. The developer of that code (who also contributes to EPPlus) tells me he's not sure that code is bug-free enough to use within EPPlus, but it's at least
 a path forward that wouldn't require a full re-implementation of this portion of the BCL.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Resolving column index to string">
      <Posts>
        <Post From="ldestevens" When="24/10/2012 20:09:51">
          <Html>
        
&lt;p&gt;Hey all,&lt;/p&gt;
&lt;p&gt;So I was just trying to create a list validation object and found I needed to specify the address as a string address. &amp;nbsp;Before I realized I could just use ExcelWorksheet.Cells[row, column].Address, I wrote a static method for ExcelColumn to convert
 the integer to a string. &amp;nbsp;I thought it might be useful to hang onto.&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: gray;"&gt;///&lt;/span&gt; &lt;span style="color: gray;"&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
&lt;span style="color: gray;"&gt;///&lt;/span&gt;&lt;span style="color: green;"&gt; Converts the integer representation a column index to the string representation.&lt;/span&gt;
&lt;span style="color: gray;"&gt;///&lt;/span&gt;&lt;span style="color: green;"&gt; Note: Index must be between 1 and 16584 (inclusive), which is A to XFD, the max column.&lt;/span&gt;
&lt;span style="color: gray;"&gt;///&lt;/span&gt; &lt;span style="color: gray;"&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
&lt;span style="color: gray;"&gt;///&lt;/span&gt; &lt;span style="color: gray;"&gt;&amp;lt;param name="index"&amp;gt;&lt;/span&gt;&lt;span style="color: green;"&gt;Column index, between 1 and 16584&amp;lt;/param&amp;gt;&lt;/span&gt;
&lt;span style="color: gray;"&gt;///&lt;/span&gt; &lt;span style="color: gray;"&gt;&amp;lt;returns&amp;gt;&lt;/span&gt;&lt;span style="color: gray;"&gt;&amp;lt;/returns&amp;gt;&lt;/span&gt;
&lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;static&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; ConvertToString(&lt;span style="color: blue;"&gt;int&lt;/span&gt; index)
{
    &lt;span style="color: green;"&gt;// A to XFD&lt;/span&gt;
    &lt;span style="color: blue;"&gt;if&lt;/span&gt; (index &amp;lt;= 0 || index &amp;gt; 16384)
        &lt;span style="color: blue;"&gt;throw&lt;/span&gt; &lt;span style="color: blue;"&gt;new&lt;/span&gt; ArgumentOutOfRangeException(&lt;span style="color: rgb(163, 21, 21);"&gt;"index must be between 1 and 16384 (inclusive)"&lt;/span&gt;);

    &lt;span style="color: blue;"&gt;string&lt;/span&gt; result = &lt;span style="color: blue;"&gt;string&lt;/span&gt;.Empty;
    &lt;span style="color: blue;"&gt;while&lt;/span&gt; (index &amp;gt; 0)
    {
        &lt;span style="color: blue;"&gt;int&lt;/span&gt; i = index % 26;
        index /= 26;
        result = (&lt;span style="color: blue;"&gt;char&lt;/span&gt;)((&lt;span style="color: blue;"&gt;int&lt;/span&gt;)&lt;span style="color: rgb(163, 21, 21);"&gt;'A'&lt;/span&gt; + (i - 1)) + result;
    }

    &lt;span style="color: blue;"&gt;return&lt;/span&gt; result;
}
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;It may also be worth considering overloading the validation objects' constructors to take an address as an ExcelAddress object, as well as (int row, int col).&lt;/p&gt;
&lt;p&gt;Luke&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="ldestevens" When="24/10/2012 20:22:51">
          <Html>
        
&lt;p&gt;Correction, it may be worth overloading the ExcelDataValidationCollection.Add___Validation methods to allow for ExcelAddress and integer values. &amp;nbsp;So, maybe something like...&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;public&lt;/span&gt; IExcelDataValidationList AddListValidation(ExcelAddress address)
{
    &lt;span style="color: blue;"&gt;return&lt;/span&gt; AddListValidation(address.Address);
}

&lt;span style="color: blue;"&gt;public&lt;/span&gt; IExcelDataValidationList AddListValidation(&lt;span style="color: blue;"&gt;int&lt;/span&gt; row, &lt;span style="color: blue;"&gt;int&lt;/span&gt; col)
{
    &lt;span style="color: blue;"&gt;return&lt;/span&gt; AddListValidation(&lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelAddress(row, col, row, col));
    &lt;span style="color: green;"&gt;//return AddListValidation(ExcelColumn.ConvertToString(col) + row.ToString());&lt;/span&gt;
}

&lt;span style="color: blue;"&gt;public&lt;/span&gt; IExcelDataValidationList AddListValidation(&lt;span style="color: blue;"&gt;int&lt;/span&gt; fromRow, &lt;span style="color: blue;"&gt;int&lt;/span&gt; fromCol, &lt;span style="color: blue;"&gt;int&lt;/span&gt; toRow, &lt;span style="color: blue;"&gt;int&lt;/span&gt; toCol)
{
    &lt;span style="color: blue;"&gt;return&lt;/span&gt; AddListValidation(&lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelAddress(fromRow, fromCol, toRow, toCol));
    &lt;span style="color: green;"&gt;//return AddListValidation(String.Format("{0}{1}:{2}{3}",&lt;/span&gt;
    &lt;span style="color: green;"&gt;//    ExcelColumn.ConvertToString(fromCol), fromRow.ToString(), ExcelColumn.ConvertToString(toCol), toRow.ToString()));&lt;/span&gt;
}
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Flush feature">
      <Posts>
        <Post From="tempar" When="24/10/2012 17:13:47">
          <Html>
        
&lt;p&gt;Hi,&lt;br&gt;
&lt;br&gt;
I am writing an application that usually run for few hours and write every few seconds a row to excel file using EPPlus.&lt;br&gt;
I want to&amp;nbsp; allow the client to see the file before the application finish to run by flushing the written rows every few minutes.&lt;br&gt;
Is there any way to flush the written rows to the excel file?&lt;br&gt;
&lt;br&gt;
&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Xls support">
      <Posts>
        <Post From="orik123" When="23/10/2012 09:09:28">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Any chance you'd add support to old .xls files?&lt;/p&gt;
&lt;p&gt;Anyway, thanks for the great dll!&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="23/10/2012 11:18:59">
          <Html>
        
&lt;p&gt;No, if you want xls support please take a look at npoi project.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Regards,&lt;/p&gt;
&lt;p&gt;Thiago&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Shape, Chart, Images Copy">
      <Posts>
        <Post From="SClause" When="22/10/2012 15:48:49">
          <Html>
        
&lt;p&gt;Is it possible to copy a chart, shape or image from one file to another one?&lt;/p&gt;
&lt;p&gt;Using EPPlus for me depends on it :-(&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="EPPlus Deployment - Pls Help CRITICAL !!">
      <Posts>
        <Post From="prabhupandian" When="18/10/2012 20:07:34">
          <Html>
        
&lt;p&gt;Hi.. EPPlus works cool in my dev machine directly by running the solution with or without office installed. But when deployed in IIS, the client machines not able to read the excel. Same case when i deploy in production servers, it does not work.&lt;/p&gt;
&lt;p&gt;Where Am i going wrong? pls Help!!!&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="swmal" When="20/10/2012 07:27:23">
          <Html>
        
&lt;p&gt;Hi&lt;/p&gt;
&lt;p&gt;Its not easy to understand what is going wrong out of your description. But one common problem when writing the epplus bytes to the outputstream in iis is that ASP.NET adds some characters before and/or after the epplus content. This can be fixed by calling
 Response.Clear() before you write the epplus bytes the output stream and the calling Response.End() directly after.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to open file in Run-Time">
      <Posts>
        <Post From="Grief" When="17/10/2012 09:10:43">
          <Html>
        
&lt;p&gt;Hi,&lt;br&gt;
I open my existing file, changing and save him. But I don't know how after all changes open him in MSOffice through C#-code?&lt;br&gt;
&lt;br&gt;
Thanks,&lt;/p&gt;
&lt;p&gt;Vera&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="18/10/2012 13:47:08">
          <Html>
        
&lt;p&gt;I never tried, but you can call Microsoft Excel passing your xlsx file as parameter, probably will work.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Regards,&lt;/p&gt;
&lt;p&gt;Thiago&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Grief" When="19/10/2012 05:36:50">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Thanks for answer. Can you give example how call MsExcel passing file as parameter.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks,&lt;/p&gt;
&lt;p&gt;Vera&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="swmal" When="20/10/2012 07:07:40">
          <Html>
        
&lt;p&gt;Hi Vera,&lt;/p&gt;
&lt;p&gt;use the System.Diagnostics.Process class and its static method Start(..).&lt;/p&gt;
&lt;p&gt;/Mats&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Problem with height after autosize merged cells">
      <Posts>
        <Post From="kotlyarovsa" When="19/10/2012 11:45:52">
          <Html>
        
&lt;p&gt;I have a several row with data, like example:&lt;/p&gt;
&lt;p&gt;_____________________________&lt;/p&gt;
&lt;p&gt;1&amp;nbsp; &amp;nbsp; |&amp;nbsp; &amp;nbsp;data1 &amp;nbsp; &amp;nbsp; |&amp;nbsp; &amp;nbsp;longdata1&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; | &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;| &amp;nbsp; longdata2&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; | &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;| &amp;nbsp; longdata3&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; | &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;| &amp;nbsp; longdata4&lt;/p&gt;
&lt;p&gt;_____|_____________|___________&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp; &amp;nbsp; &amp;nbsp;| &amp;nbsp; data2 &amp;nbsp; &amp;nbsp; |&lt;/p&gt;
&lt;p&gt;_____|_____________|___________&lt;/p&gt;
&lt;p&gt;&amp;nbsp;I need to merge rows in 1-st and 3-rd columns, but after that, height of merged cells equals to height of data1 + data2, like that:&lt;/p&gt;
&lt;p&gt;_____________________________&lt;/p&gt;
&lt;p&gt;1&amp;nbsp; &amp;nbsp; |&amp;nbsp; &amp;nbsp;data1 &amp;nbsp; &amp;nbsp; |&amp;nbsp; &amp;nbsp;longdata1&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; |_____________| &amp;nbsp; longdata2&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; | &amp;nbsp; data2&amp;nbsp; &amp;nbsp; &amp;nbsp;| &amp;nbsp;&amp;nbsp;longdata3&lt;/p&gt;
&lt;p&gt;_____|_____________|___________&lt;/p&gt;
&lt;p&gt;&amp;nbsp;But i need height of rows equals to height of "longdata". When i trying get height of "longdata" cell before merging (ws.Row(i).Height), i always have default value 15&lt;/p&gt;
&lt;p&gt;How i can get and set current height of row and merged cells?&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="NumberFormat for string as text performance">
      <Posts>
        <Post From="varunagg100" When="16/10/2012 12:33:45">
          <Html>
        
&lt;p&gt;We are generating around 7000 rows and 81 columns in one of our reports. The problem is performance, it is taking quite a lot of time generating the report and upon analysis, it was found that most of time is being spent on setting NumberFormat. We are using
 following code to set the format for string columns as text for each column of type string.&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(43, 145, 175);"&gt;ExcelNumberFormat&lt;/span&gt;.Format = "@"&lt;/p&gt;
&lt;p&gt;Further digging down, we found out most of time is being spent in &lt;br&gt;
OfficeOpenXml.RangeCollection.Insert(int ix, IRangeId cell)&lt;/p&gt;
&lt;p&gt;Below is the stack trace for further information.&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src=""&gt;&lt;/p&gt;
&lt;p&gt;Could someone please help?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="18/10/2012 21:23:48">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Make sure you set cells from left to right, top to bottom. That means, access all cells in the sheet starting from A1--&amp;gt;XX1--&amp;gt;XX7000.&lt;/p&gt;
&lt;p&gt;(setting all cell related properties, like style, formula will create a new cell and forcing a copy in the internal indexetc.)&lt;/p&gt;
&lt;p&gt;Read the FAQ for futher info&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="When copying rows % format changed to currency">
      <Posts>
        <Post From="mnvraghuram" When="18/10/2012 16:31:30">
          <Html>
        
&lt;p&gt;Hi&lt;/p&gt;
&lt;p&gt;Thank you all for looking at this. I am copying rows from one workbook to another and was able to do so but having issue with when we have a column formatted as Percentage(%) its getting converted to currency after copying. Can anyone suggest please&lt;/p&gt;
&lt;p&gt;Thanking you all in anticipation&lt;/p&gt;
&lt;p&gt;Regards&lt;/p&gt;
&lt;p&gt;Raghu&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Load string or bytearray into Excelpackage?">
      <Posts>
        <Post From="scottg918514" When="16/10/2012 20:49:06">
          <Html>
        
&lt;p&gt;Is there a way to put a string or bytearray into an Excelpackage?&lt;/p&gt;
&lt;p&gt;I already have a string of formated xml, with data and styles.&amp;nbsp; I don't want to have to recode it all, cell by cell in the excelpackage.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="18/10/2012 14:11:53">
          <Html>
        
&lt;p&gt;If you have a memory stream of an existing xlsx file, just pass it to epplus constructor. When you open your file. some exceptions may be raised if your existing file was not created by epplus because its does not support all excel features.&lt;/p&gt;
&lt;p&gt;Look at this thread:&amp;nbsp;http://epplus.codeplex.com/discussions/256064&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Regards,&lt;/p&gt;
&lt;p&gt;Thiago&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How convert xlsx file into XML Spreadsheet?">
      <Posts>
        <Post From="Grief" When="18/10/2012 12:17:16">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I create in C# new xlsx document and then a would like convert him into xml Spreadsheet format.&lt;/p&gt;
&lt;p&gt;In standart library Microsoft.Office.Interop.Excel it's simple:&lt;/p&gt;
&lt;p&gt;Workbook wb = app.Workbooks[1];&lt;br&gt;
wb.SaveAs(path, XlFileFormat.xlXMLSpreadsheet);&lt;/p&gt;
&lt;p&gt;And how in EPPlus?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks,&lt;/p&gt;
&lt;p&gt;Vera&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="18/10/2012 12:39:37">
          <Html>
        
&lt;p&gt;There is no built-in method to do this in EPPlus.&lt;/p&gt;
&lt;p&gt;Regards,&lt;/p&gt;
&lt;p&gt;Thiago&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="LoadFromDataTable With TableStyles creates an Error upon re-opening Excel Workbook">
      <Posts>
        <Post From="origfla" When="24/09/2012 20:24:14">
          <Html>
        
&lt;p&gt;Experts... HELP!!!&lt;/p&gt;
&lt;p&gt;I've gone looking online for this solution and can't find anything that explains my problem.&lt;/p&gt;
&lt;p&gt;I am using EPPLus for vb.net (using OfficeOpenXml) and my code looks something like this:&lt;br&gt;
&lt;span style="color: blue;"&gt;Dim&lt;/span&gt; Package &lt;span style="color: blue;"&gt;As&lt;/span&gt; &lt;span style="color: blue;"&gt;
New&lt;/span&gt; ExcelPackage&lt;br&gt;
&lt;span style="color: blue;"&gt;Dim&lt;/span&gt; wks &lt;span style="color: blue;"&gt;As&lt;/span&gt; ExcelWorksheet&lt;br&gt;
&lt;span style="color: blue;"&gt;Dim&lt;/span&gt; dt &lt;span style="color: blue;"&gt;As&lt;/span&gt; DataTable&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
wks.Cells(&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;).LoadFromDataTable(dt,
&lt;span style="color: blue;"&gt;True&lt;/span&gt;, TableStyles.Medium9)&lt;br&gt;
&lt;br&gt;
&lt;span style="color: blue;"&gt;Dim&lt;/span&gt; SaveAs &lt;span style="color: blue;"&gt;As&lt;/span&gt; &lt;span style="color: blue;"&gt;
New&lt;/span&gt; FileInfo([...somelocation.xlsx])&lt;br&gt;
Package.SaveAs(SaveAs)&lt;/p&gt;
&lt;p&gt;Now, when I run this, it works perfectly well and saves the .xlsx file as wanted / expected. HOWEVER, when I try and open it in Excel, I get an error saying:&lt;br&gt;
"Excel found unreadable content in... Do you want to recover the contents of this workbook?"&lt;/p&gt;
&lt;p&gt;If I then click "Yes", It opens it perfectly fine and gives me an error report saying:&lt;br&gt;
"Excel was able to open the file by repairing or removing the unreadable content"&lt;br&gt;
with lots of erros (one for each datatable loaded):&lt;br&gt;
"Repaired Records: Table from /xl/tables/table1.xml part (Table)"&lt;/p&gt;
&lt;p&gt;NOW... If I change the line of code from:&lt;br&gt;
&lt;span style="color: blue;"&gt;wks.Cells(&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;).LoadFromDataTable(dt,
&lt;span style="color: blue;"&gt;True&lt;/span&gt;, TableStyles.Medium9)&lt;br&gt;
&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;To:&lt;/p&gt;
&lt;p&gt;wks.Cells(&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;).LoadFromDataTable(dt,
&lt;span style="color: blue;"&gt;True)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Then everything work perfectly well with no errors...&lt;/p&gt;
&lt;p&gt;Any help would be GREATLY appreciated!!!&lt;/p&gt;
&lt;p&gt;Thanks!!&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="origfla" When="17/10/2012 21:55:52">
          <Html>
        
&lt;p&gt;... So I figured out what MY problem was and I'm just putting it in here in case anyone is as stupid as I was...&lt;/p&gt;
&lt;p&gt;In my case, I created the Datatable with custom columns names that were split up over 2 lines as follows:&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;dt.Columns.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"First Line's Text"&lt;/span&gt; &amp;amp; vbCrLf &amp;amp; &lt;span style="color: rgb(163, 21, 21);"&gt;"Second Line"&lt;/span&gt;)
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;The problem was the &lt;strong&gt;vbCrLf&lt;/strong&gt; - I changed it to:&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;dt.Columns.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"First Line's Text"&lt;/span&gt; &amp;amp; vbLf &amp;amp; &lt;span style="color: rgb(163, 21, 21);"&gt;"Second Line"&lt;/span&gt;)&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;And the error went away :)&lt;/p&gt;
&lt;p&gt;Hope this saves someone else all the annoyance I went through!!&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="EPPlus lost numberformat and cell width with Copy method">
      <Posts>
        <Post From="wIt" When="15/10/2012 15:39:26">
          <Html>
        
&lt;p&gt;I have create an excel with template rows. In the model, I set the background color, border style, width, and numberformat for some cell.&lt;/p&gt;
&lt;p&gt;In my code the template was copied many time, but only first time the format of the cell is right (except cell width).&lt;/p&gt;
&lt;p&gt;For example in a cell I had this formula, "=IF(B12&amp;lt;&amp;gt;"";IF(B12+1&amp;gt;=DATE.MONTH($B$8;1);"";B12+1);"")", with this for every cell I had the next date from previous cell (B12=dd/mm/yyy). In my model this
 cell is formatted with this numberformat "dd//ddd". When I copy this row for first time, it work fine, but for the other time, numberformat is "dd/mm/yyyy".&lt;/p&gt;
&lt;p&gt;Width don't work anytime. Background color &amp;amp; border style work perfectly.&lt;/p&gt;
&lt;p&gt;The metod I use to copy range from model to destination file is ExcelBase.Copy.&lt;/p&gt;
&lt;p&gt;Someone can help me on my problem?&lt;/p&gt;
&lt;p&gt;Thanks to everyone.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Get average column count">
      <Posts>
        <Post From="TiSch" When="15/10/2012 11:36:32">
          <Html>
        
&lt;p&gt;What's the easiest method to get the average column count?&lt;/p&gt;
&lt;p&gt;I need to know it because i want to know when the report starts (there are some lines above that don't belong to the report itself).&lt;/p&gt;
&lt;p&gt;I would like to know how to achieve following with LINQ:&lt;/p&gt;
&lt;pre&gt;&lt;div style="color: black; background-color: white;"&gt;&lt;pre&gt;&lt;span style="color: blue;"&gt;Dim&lt;/span&gt; totalColumnCount &lt;span style="color: blue;"&gt;As&lt;/span&gt; Int32 = 0
&lt;span style="color: blue;"&gt;For&lt;/span&gt; r = 1 &lt;span style="color: blue;"&gt;To&lt;/span&gt; ws.Dimension.&lt;span style="color: blue;"&gt;End&lt;/span&gt;.Row
    &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; row = ws.Cells(r, 1, r, ws.Dimension.&lt;span style="color: blue;"&gt;End&lt;/span&gt;.Column)
    totalColumnCount += row.&lt;span style="color: blue;"&gt;Count&lt;/span&gt;()
&lt;span style="color: blue;"&gt;Next&lt;/span&gt;
&lt;span style="color: blue;"&gt;Dim&lt;/span&gt; avgCount = &lt;span style="color: blue;"&gt;CInt&lt;/span&gt;(Math.Round(totalColumnCount / ws.Dimension.&lt;span style="color: blue;"&gt;End&lt;/span&gt;.Row, MidpointRounding.AwayFromZero))&lt;/pre&gt;
&lt;pre&gt;&lt;br&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/pre&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="conditional formatting not working on workbooks">
      <Posts>
        <Post From="llester1878" When="12/10/2012 20:13:19">
          <Html>
        
&lt;p&gt;it seems like the formatting works on a single workbook. However, when I add another workbook, the formatting applies to the new one but not the previously created workbook&lt;/p&gt;
&lt;p&gt;ExcelAddress ansAddress = new ExcelAddress(2, 4, row, 4 );&amp;nbsp; //="F2:F*"&lt;br&gt;
var trueColor = worksheet.ConditionalFormatting.AddContainsText(ansAddress);&lt;br&gt;
trueColor.Text = "Y";&lt;br&gt;
trueColor.Style.Fill.BackgroundColor.Color = Color.GreenYellow;&lt;/p&gt;
&lt;p&gt;var falseColor = worksheet.ConditionalFormatting.AddContainsText(ansAddress);&lt;br&gt;
falseColor.Text = "N";&lt;br&gt;
falseColor.Style.Fill.BackgroundColor.Color = Color.Orange;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title=".Cells.End.Row returns wrong value">
      <Posts>
        <Post From="Quindrupel" When="23/09/2012 22:41:26">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;first of all thank you for this great lib. It makes my work a lot easier.&lt;/p&gt;
&lt;p&gt;but i have a problem here. If I use .Cells.End.Row it always returns 1048576.&lt;/p&gt;
&lt;p&gt;I don't know wether this is a bug or I'm just using it the wrong way.&lt;/p&gt;
&lt;p&gt;here's my source:&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;if&lt;/span&gt; (!kartehinzufuegen)
            {
                testblatt.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A32:C57"&lt;/span&gt;].Copy(testblatt.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"D6:F31"&lt;/span&gt;]);
                testblatt.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A32:C57"&lt;/span&gt;].Clear();

                testblatt.Cells[58, 1, testblatt.Cells.End.Row, 6].Copy(testblatt.Cells[32, 1, testblatt.Cells.End.Row-26, 6]);
                testblatt.Cells[testblatt.Cells.End.Row - 26, 1, testblatt.Cells.End.Row, 6].Clear();
            }
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;Thanks.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="gsbell" When="28/09/2012 16:45:07">
          <Html>
        
&lt;p&gt;&lt;span&gt;&lt;em&gt;Use&lt;/em&gt; Worksheet.Dimension.End.Row &lt;em&gt;instead.&lt;/em&gt; &lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Quindrupel" When="11/10/2012 18:23:17">
          <Html>
        
&lt;p&gt;Thanks that was it.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Can we provide list of columns to be selected">
      <Posts>
        <Post From="mnvraghuram" When="11/10/2012 16:19:55">
          <Html>
        
&lt;p&gt;Can we provide list of column names which needs to be selected ? as we do with oledb jet provider&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Can i get the DataType of the column">
      <Posts>
        <Post From="mnvraghuram" When="11/10/2012 15:54:32">
          <Html>
        
&lt;p&gt;Hi&lt;/p&gt;
&lt;p&gt;I want to get the datatype of the column so that when exporting the excel data to a table i can specify the type as we use&amp;nbsp;GetSchemaTable() available if we use OLEDB Jet provider&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Please kindly advice.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="GetAsByteArray throwing NullReferenceException">
      <Posts>
        <Post From="alientourist2001" When="11/10/2012 08:55:37">
          <Html>
        
&lt;p&gt;I have an existing spreadsheet that I open and edit and then save using GetAsByteArray.&lt;/p&gt;
&lt;p&gt;Something in the last couple of EPPlus updates has caused it to stop working, sorry to say I don't know exactly which changeset caused it. I tried downloading both stable 3.1.1 and latest&amp;nbsp;f23162df86ce but the error exists in both.&lt;/p&gt;
&lt;p&gt;Any help is appreciated.&lt;/p&gt;
&lt;p&gt;Best regards,&lt;/p&gt;
&lt;p&gt;Andreas&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;This is the stack trace:&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Exception Details: &lt;/strong&gt;System.NullReferenceException: Object reference not set to an instance of an object.&lt;/p&gt;
&lt;p&gt;&lt;br&gt;
&lt;strong&gt;Source Error:&lt;/strong&gt; &lt;br&gt;
&lt;br&gt;
&lt;/p&gt;
&lt;table width="100%" bgcolor="#ffffcc"&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;
&lt;pre&gt;Line 188:    private static eExcelConditionalFormattingRuleType GetIconSetType(XmlNode topNode, XmlNamespaceManager nameSpaceManager)
Line 189:    {
&lt;span style="color: red;"&gt;Line 190:        var v = topNode.SelectSingleNode("d:iconSet/@iconSet", nameSpaceManager).Value;
&lt;/span&gt;Line 191:
Line 192:        if (v[0] == '3')&lt;/pre&gt;
&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;br&gt;
&lt;strong&gt;Source File: &lt;/strong&gt;C:\svnwc\EPPlus f23162df86ce\EPPlus\ConditionalFormatting\ExcelConditionalFormattingRuleType.cs&lt;strong&gt; &amp;nbsp;&amp;nbsp; Line:
&lt;/strong&gt;190 &lt;br&gt;
&lt;br&gt;
&lt;strong&gt;Stack Trace:&lt;/strong&gt; &lt;br&gt;
&lt;br&gt;
&lt;/p&gt;
&lt;table width="100%" bgcolor="#ffffcc"&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;
&lt;pre&gt;[NullReferenceException: Object reference not set to an instance of an object.]
   OfficeOpenXml.ConditionalFormatting.ExcelConditionalFormattingRuleType.GetIconSetType(XmlNode topNode, XmlNamespaceManager nameSpaceManager) in C:\svnwc\EPPlus f23162df86ce\EPPlus\ConditionalFormatting\ExcelConditionalFormattingRuleType.cs:190
   OfficeOpenXml.ConditionalFormatting.ExcelConditionalFormattingRuleType.GetTypeByAttrbiute(String attribute, XmlNode topNode, XmlNamespaceManager nameSpaceManager) in C:\svnwc\EPPlus f23162df86ce\EPPlus\ConditionalFormatting\ExcelConditionalFormattingRuleType.cs:136
   OfficeOpenXml.ConditionalFormatting.ExcelConditionalFormattingCollection..ctor(ExcelWorksheet worksheet) in C:\svnwc\EPPlus f23162df86ce\EPPlus\ConditionalFormatting\ExcelConditionalFormattingCollection.cs:153
   OfficeOpenXml.ExcelWorksheet.get_ConditionalFormatting() in C:\svnwc\EPPlus f23162df86ce\EPPlus\ExcelWorksheet.cs:2723
   OfficeOpenXml.ExcelStyles.UpdateXml() in C:\svnwc\EPPlus f23162df86ce\EPPlus\ExcelStyles.cs:608
   OfficeOpenXml.ExcelWorkbook.Save() in C:\svnwc\EPPlus f23162df86ce\EPPlus\ExcelWorkbook.cs:649
   OfficeOpenXml.ExcelPackage.GetAsByteArray(Boolean save) in C:\svnwc\EPPlus f23162df86ce\EPPlus\ExcelPackage.cs:935
   OfficeOpenXml.ExcelPackage.GetAsByteArray() in C:\svnwc\EPPlus f23162df86ce\EPPlus\ExcelPackage.cs:905
   HartleyAndMarks.Services.Controllers.OrderFormController.FileExcel(String filename, String sheetname, String country, Nullable`1 lastActivity, Nullable`1 useStoreLocator) in C:\svnwc\HartleyAndMarks.Services\HartleyAndMarks.Services\Controllers\OrderFormController.cs:223
   lambda_method(Closure , ControllerBase , Object[] ) +378
   System.Web.Mvc.ActionMethodDispatcher.Execute(ControllerBase controller, Object[] parameters) +17
   System.Web.Mvc.ReflectedActionDescriptor.Execute(ControllerContext controllerContext, IDictionary`2 parameters) +208
   System.Web.Mvc.ControllerActionInvoker.InvokeActionMethod(ControllerContext controllerContext, ActionDescriptor actionDescriptor, IDictionary`2 parameters) +27
   System.Web.Mvc.&amp;lt;&amp;gt;c__DisplayClass15.&amp;lt;InvokeActionMethodWithFilters&amp;gt;b__12() +55
   System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodFilter(IActionFilter filter, ActionExecutingContext preContext, Func`1 continuation) +263
   System.Web.Mvc.&amp;lt;&amp;gt;c__DisplayClass17.&amp;lt;InvokeActionMethodWithFilters&amp;gt;b__14() +19
   System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodWithFilters(ControllerContext controllerContext, IList`1 filters, ActionDescriptor actionDescriptor, IDictionary`2 parameters) +191
   System.Web.Mvc.ControllerActionInvoker.InvokeAction(ControllerContext controllerContext, String actionName) +343
   System.Web.Mvc.Controller.ExecuteCore() +116
   System.Web.Mvc.ControllerBase.Execute(RequestContext requestContext) +97
   System.Web.Mvc.ControllerBase.System.Web.Mvc.IController.Execute(RequestContext requestContext) +10
   System.Web.Mvc.&amp;lt;&amp;gt;c__DisplayClassb.&amp;lt;BeginProcessRequest&amp;gt;b__5() +37
   System.Web.Mvc.Async.&amp;lt;&amp;gt;c__DisplayClass1.&amp;lt;MakeVoidDelegate&amp;gt;b__0() +21
   System.Web.Mvc.Async.&amp;lt;&amp;gt;c__DisplayClass8`1.&amp;lt;BeginSynchronous&amp;gt;b__7(IAsyncResult _) +12
   System.Web.Mvc.Async.WrappedAsyncResult`1.End() +62
   System.Web.Mvc.&amp;lt;&amp;gt;c__DisplayClasse.&amp;lt;EndProcessRequest&amp;gt;b__d() +50
   System.Web.Mvc.SecurityUtil.&amp;lt;GetCallInAppTrustThunk&amp;gt;b__0(Action f) +7
   System.Web.Mvc.SecurityUtil.ProcessInApplicationTrust(Action action) +22
   System.Web.Mvc.MvcHandler.EndProcessRequest(IAsyncResult asyncResult) +60
   System.Web.Mvc.MvcHandler.System.Web.IHttpAsyncHandler.EndProcessRequest(IAsyncResult result) +9
   System.Web.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +8967885
   System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean&amp;amp; completedSynchronously) +184
&lt;/pre&gt;
&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="alientourist2001" When="11/10/2012 11:11:35">
          <Html>
        
&lt;p&gt;I did a quick fix that seems to work. But my knowledge of both EPPlus source and xml is very limited so it might be a very bad solution.)&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;private&lt;/span&gt; &lt;span style="color: blue;"&gt;static&lt;/span&gt; eExcelConditionalFormattingRuleType GetIconSetType(XmlNode topNode, XmlNamespaceManager nameSpaceManager)
{
	&lt;span style="color: green;"&gt;//var v = topNode.SelectSingleNode("d:iconSet/@iconSet", nameSpaceManager).Value;&lt;/span&gt;

	&lt;span style="color: green;"&gt;//if (v[0] == '3')&lt;/span&gt;
	&lt;span style="color: blue;"&gt;if&lt;/span&gt; (topNode.SelectSingleNode(&lt;span style="color: rgb(163, 21, 21);"&gt;"d:iconSet/d:cfvo[position()=3]"&lt;/span&gt;, nameSpaceManager) != &lt;span style="color: blue;"&gt;null&lt;/span&gt;)
	{
		&lt;span style="color: blue;"&gt;return&lt;/span&gt; eExcelConditionalFormattingRuleType.ThreeIconSet;
	}
	&lt;span style="color: green;"&gt;//else if (v[0] == '4')&lt;/span&gt;
	&lt;span style="color: blue;"&gt;else&lt;/span&gt; &lt;span style="color: blue;"&gt;if&lt;/span&gt; (topNode.SelectSingleNode(&lt;span style="color: rgb(163, 21, 21);"&gt;"d:iconSet/d:cfvo[position()=4]"&lt;/span&gt;, nameSpaceManager) != &lt;span style="color: blue;"&gt;null&lt;/span&gt;)
	{
		&lt;span style="color: blue;"&gt;return&lt;/span&gt; eExcelConditionalFormattingRuleType.FourIconSet;
	}
	&lt;span style="color: blue;"&gt;else&lt;/span&gt;
	{
	  &lt;span style="color: blue;"&gt;return&lt;/span&gt; eExcelConditionalFormattingRuleType.FiveIconSet;
	}
}
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="LoadFromDataTable bug introduced in 5892cd3f330e">
      <Posts>
        <Post From="alientourist2001" When="11/10/2012 11:05:31">
          <Html>
        
&lt;p&gt;Returning ExcelBaseRange the toColumn is computed incorrectly.&lt;/p&gt;
&lt;p&gt;Structuring the code like LoadFromArrays and LoadFromCollection it should probably look like:&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;public&lt;/span&gt; ExcelRangeBase LoadFromDataTable(DataTable Table, &lt;span style="color: blue;"&gt;bool&lt;/span&gt; PrintHeaders)
{
	&lt;span style="color: blue;"&gt;if&lt;/span&gt; (Table == &lt;span style="color: blue;"&gt;null&lt;/span&gt;)
	{
		&lt;span style="color: blue;"&gt;throw&lt;/span&gt; (&lt;span style="color: blue;"&gt;new&lt;/span&gt; ArgumentNullException(&lt;span style="color: rgb(163, 21, 21);"&gt;"Table can't be null"&lt;/span&gt;));
	}

	&lt;span style="color: blue;"&gt;int&lt;/span&gt; col = _fromCol, row = _fromRow;
	&lt;span style="color: blue;"&gt;if&lt;/span&gt; (PrintHeaders)
	{
		&lt;span style="color: blue;"&gt;foreach&lt;/span&gt; (DataColumn dc &lt;span style="color: blue;"&gt;in&lt;/span&gt; Table.Columns)
		{
			&lt;span style="color: green;"&gt;// If no caption is set, the ColumnName property is called implicitly.&lt;/span&gt;
			_worksheet.Cell(row, col++).Value = dc.Caption;
		}
		row++;
	}
	&lt;span style="color: blue;"&gt;foreach&lt;/span&gt; (DataRow dr &lt;span style="color: blue;"&gt;in&lt;/span&gt; Table.Rows)
	{
		col = _fromCol;
		&lt;span style="color: blue;"&gt;foreach&lt;/span&gt; (&lt;span style="color: blue;"&gt;object&lt;/span&gt; value &lt;span style="color: blue;"&gt;in&lt;/span&gt; dr.ItemArray)
		{
			_worksheet.Cell(row, col++).Value = value;
		}
		row++;
	}
	&lt;span style="color: blue;"&gt;return&lt;/span&gt; _worksheet.Cells[_fromRow, _fromCol, row - 1, col - 1];
}&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;Cheers,&lt;/p&gt;
&lt;p&gt;Andreas&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Entity Framework &amp;amp; EPPlus - entitystate and other columns being output">
      <Posts>
        <Post From="griffijg" When="08/10/2012 23:01:21">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I'm using EPPlus to output the contents of database tables via Entity Framework. It works beautifully except at the moment columns are also being output showing the entity state and entity collection attributes.&lt;/p&gt;
&lt;p&gt;Is there a quick way to prevent these columns from being output? &amp;nbsp;I know I could specify the selected columns in my EF query but would prefer to have something a little more flexible.&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;
&lt;p&gt;John&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Line, LineInv and Excel converter error.">
      <Posts>
        <Post From="GrzesiekP" When="08/10/2012 10:01:30">
          <Html>
        
&lt;p&gt;Hello!&lt;/p&gt;
&lt;p&gt;I know, that EPPlus is targeting at .xlsx format, but unfortunately I need compatibility with Office 2003.&lt;/p&gt;
&lt;p&gt;I wrote some code and it works great at Office 2007.&lt;br&gt;
After that I tried to use it with Office 2003 (I mean, opening file .xlsx in Excel 2003 by using MS's in-fly converter).&lt;/p&gt;
&lt;p&gt;When I insert Line everything is OK, but when I insert LineInv converter cannot read the file.&lt;/p&gt;
&lt;p&gt;Why?&lt;br&gt;
And why I cannot simply draw Line with negative Y-coordinates and I have to select LineInv instead of Line?&lt;br&gt;
&lt;br&gt;
Thanks.&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How do I get count instead of Sum [SOLVED]">
      <Posts>
        <Post From="rohithshenoyg" When="05/10/2012 12:23:16">
          <Html>
        
&lt;p&gt;In the datafield of my pivot table, i've set the subtotalfunction to count. But it doesnt reflect when the excel sheet is generated and it still shows the sum and not the count. Is there any solution to this? :)&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="rohithshenoyg" When="08/10/2012 05:15:17">
          <Html>
        
&lt;p&gt;Bump... Anyone? :(&lt;/p&gt;
&lt;p&gt;This is the code i'm trying.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;var&lt;/span&gt; wsPivot = package.Workbook.Worksheets.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"Pivot"&lt;/span&gt;);

                &lt;span style="color: blue;"&gt;var&lt;/span&gt; pivotTable = wsPivot.PivotTables.Add(wsPivot.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A55"&lt;/span&gt;], dataRange, &lt;span style="color: rgb(163, 21, 21);"&gt;"Table"&lt;/span&gt;);
                pivotTable.MultipleFieldFilters = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
                pivotTable.RowGrandTotals = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
                pivotTable.ColumGrandTotals = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
                pivotTable.Compact = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
                pivotTable.CompactData = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
                pivotTable.GridDropZones = &lt;span style="color: blue;"&gt;false&lt;/span&gt;;
                pivotTable.Outline = &lt;span style="color: blue;"&gt;false&lt;/span&gt;;
                pivotTable.OutlineData = &lt;span style="color: blue;"&gt;false&lt;/span&gt;;
                pivotTable.ShowError = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
                pivotTable.ErrorCaption = &lt;span style="color: rgb(163, 21, 21);"&gt;"[error]"&lt;/span&gt;;
                pivotTable.ShowHeaders = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
                pivotTable.UseAutoFormatting = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
                pivotTable.ApplyWidthHeightFormats = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
                pivotTable.ShowDrill = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
                pivotTable.FirstDataCol = 3;
                pivotTable.RowHeaderCaption = &lt;span style="color: rgb(163, 21, 21);"&gt;"Caption"&lt;/span&gt;;

                &lt;span style="color: blue;"&gt;var&lt;/span&gt; pageField = pivotTable.Fields[&lt;span style="color: rgb(163, 21, 21);"&gt;"field1"&lt;/span&gt;];
                pivotTable.PageFields.Add(pageField);

                &lt;span style="color: blue;"&gt;var&lt;/span&gt; rowField = pivotTable.Fields[&lt;span style="color: rgb(163, 21, 21);"&gt;"cust"&lt;/span&gt;];                    
                pivotTable.RowFields.Add(rowField);

                &lt;span style="color: blue;"&gt;var&lt;/span&gt; dataField = pivotTable.Fields[&lt;span style="color: rgb(163, 21, 21);"&gt;"id"&lt;/span&gt;];

                dataField.SubTotalFunctions = OfficeOpenXml.Table.PivotTable.eSubTotalFunctions.Count;
                pivotTable.DataFields.Add(dataField);

&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="rohithshenoyg" When="08/10/2012 07:16:08">
          <Html>
        
&lt;p&gt;I figured it out. This worked for me&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;pivotTable.DataFields.Add(dataField);&lt;br&gt;
pivotTable.DataFields[0].Function = DataFieldFunctions.Count;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Designate which worksheet to open">
      <Posts>
        <Post From="cmullender" When="05/10/2012 20:56:24">
          <Html>
        
&lt;p&gt;Is there an option to designate which worksheet opens when you open the spreadsheet you have created?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="05/10/2012 21:24:34">
          <Html>
        
&lt;p&gt;Look at this thread&amp;nbsp;&lt;a href="http://epplus.codeplex.com/discussions/277184" rel="nofollow"&gt;http://epplus.codeplex.com/discussions/277184&lt;/a&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="cmullender" When="05/10/2012 21:36:04">
          <Html>
        
&lt;blockquote style="margin: 0.25em 1em 0px; padding: 0px 0.25em; border: 0.1em solid rgb(204, 204, 204); border-image: none; font-style: italic;"&gt;
&lt;strong&gt;mrxrsd wrote:&lt;/strong&gt;&lt;br&gt;
&lt;p&gt;Look at this thread&amp;nbsp;&lt;a href="http://epplus.codeplex.com/discussions/277184" rel="nofollow"&gt;http://epplus.codeplex.com/discussions/277184&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;I knew I couldn't be the first to come across this!&amp;nbsp; Thank you!&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to set chart label text alignment direction to horizontal?">
      <Posts>
        <Post From="geocabs" When="05/10/2012 20:01:04">
          <Html>
        
&lt;p&gt;Can I get assistance on how to&amp;nbsp;set chart label text alignment direction to horizontal?&lt;/p&gt;
&lt;p&gt;Thank you&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Cannot Hide Worksheet">
      <Posts>
        <Post From="drpib81" When="04/10/2012 21:42:35">
          <Html>
        
&lt;p&gt;Hi everyone. I have a somewhat frustrating problem.&lt;/p&gt;
&lt;p&gt;I am using EPPlus to populate and format a excel template which includes hiding three worksheets. I have tried numerous ways, but the end result is that two of the three get hidden, with the first one being the one that gets skipped.&lt;/p&gt;
&lt;p&gt;Here is my code. Please let me know what I am doing wrong. i just downloaded the newest library so I should have the most updated version.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;Dim fi As FileInfo = New FileInfo(strTemplate)
Dim xl As ExcelPackage = New ExcelPackage(fi)

Dim ws As ExcelWorksheet

For i = 2 To xl.Workbook.Worksheets.Count

ws = xl.Workbook.Worksheets(i)
ws.Hidden = eWorkSheetHidden.Hidden

Next
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="04/10/2012 22:24:13">
          <Html>
        
&lt;p&gt;Excel doesn't allow you to hide all yours sheets.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="drpib81" When="05/10/2012 18:43:36">
          <Html>
        
&lt;p&gt;Hi everyone.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;mrxrsd, In the code above, I wasn't hiding all, just the second through the last sheet.&lt;/p&gt;
&lt;p&gt;So I fixed the issue, although I don't know why.&lt;/p&gt;
&lt;p&gt;I had saved my template with the active sheet being one of the sheets i needed hidden. I went back to my sheet, moved the the first worksheet and saved. Magic. Again, not sure why this worked, I would think that EPPlus would be able to hide any sheet as
 long as not all of the sheets are being hidden.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Hope this helps someone else.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="drpib81" When="05/10/2012 18:44:11">
          <Html>
        
&lt;p&gt;Hi everyone.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;mrxrsd, In the code above, I wasn't hiding all, just the second through the last sheet.&lt;/p&gt;
&lt;p&gt;So I fixed the issue, although I don't know why.&lt;/p&gt;
&lt;p&gt;I had saved my template with the active sheet being one of the sheets i needed hidden. I went back to my sheet, moved the the first worksheet and saved. Magic. Again, not sure why this worked, I would think that EPPlus would be able to hide any sheet as
 long as not all of the sheets are being hidden.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Hope this helps someone else.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="geocabs" When="05/10/2012 19:52:02">
          <Html>
        
&lt;p&gt;I had the same issue. &amp;nbsp;I had two worksheet and I was trying to hide the first worksheet. &amp;nbsp;This was resolved when I change the worksheet order. &amp;nbsp;Sheet 1 becomes Sheet 2 and Sheet 2 to Sheet 1 and I set Sheet 2 to hidden.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Existing Spreadsheet with Conditional Formatting - Error">
      <Posts>
        <Post From="daveherron" When="04/10/2012 00:33:48">
          <Html>
        
&lt;p&gt;&lt;strong&gt;&lt;span style="color: rgb(0, 128, 0);"&gt;RESOLVED:&amp;nbsp; This problem was fixed in&amp;nbsp;F23162df86ce changeset.&amp;nbsp; Source was released for testing 10/07/2012.&amp;nbsp; --DaveH&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;I have an existing spreadsheet that was converted from 2003 xls to 2007 xlsx.&amp;nbsp; The spreadsheet is happy when I open and save using excel 2007.&amp;nbsp; The spreadsheet has extensive pre-existing conditional formatting used.&lt;/p&gt;
&lt;p&gt;When the "xlPackage.Save()" executes in the code below, I get the error below.&lt;/p&gt;
&lt;p&gt;Any ideas? Is the conversion from 2003 the problem?&lt;/p&gt;
&lt;p&gt;See also: &lt;a title="http://epplus.codeplex.com/workitem/14749" href="http://epplus.codeplex.com/workitem/14749" target="_blank" rel="nofollow"&gt;
http://epplus.codeplex.com/workitem/14749&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Here is the code to load and save the spreadsheet:&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;string&lt;/span&gt; newFileName = &lt;span style="color: rgb(163, 21, 21);"&gt;@"C:\TEMP\ProductCofC.xlsx"&lt;/span&gt;;
FileInfo fileInfo = &lt;span style="color: blue;"&gt;new&lt;/span&gt; FileInfo(&lt;span style="color: rgb(163, 21, 21);"&gt;@"CofCTemplate.xlsx"&lt;/span&gt;);
fileInfo.CopyTo(newFileName);
fileInfo = &lt;span style="color: blue;"&gt;null&lt;/span&gt;;
fileInfo = &lt;span style="color: blue;"&gt;new&lt;/span&gt; FileInfo(newFileName);

ExcelPackage xlPackage = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(fileInfo);

xlPackage.Save();&lt;br&gt;&lt;br&gt;&lt;br&gt;The error...&lt;br&gt;System.InvalidOperationException was unhandled&lt;br&gt;&amp;nbsp; Message=Error saving file C:\TEMP\ProductCofC_20123003_173025.xlsx&lt;br&gt;&amp;nbsp; Source=EPPlus&lt;br&gt;&amp;nbsp; StackTrace:&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; at OfficeOpenXml.ExcelPackage.Save() in C:\Users\dherron\Downloads\EPPlus-7afb9506d6e0\epplus_7afb9506d6e0\EPPlus\ExcelPackage.cs:line 761&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; at App.ShipDocs.ProductCofC_EPP.CreateDocument() in U:\dherron\Projects\csharp\ExcelTestProject\clsProductCofC_EPP.cs:line 36&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; at ExcelTestProject.frmMain.button1_Click_1(Object sender, EventArgs e) in U:\dherron\Projects\csharp\ExcelTestProject\frmMain.cs:line 72&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; at System.Windows.Forms.Control.OnClick(EventArgs e)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; at System.Windows.Forms.Button.OnClick(EventArgs e)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; at System.Windows.Forms.Button.OnMouseUp(MouseEventArgs mevent)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; at System.Windows.Forms.Control.WmMouseUp(Message&amp;amp; m, MouseButtons button, Int32 clicks)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; at System.Windows.Forms.Control.WndProc(Message&amp;amp; m)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; at System.Windows.Forms.ButtonBase.WndProc(Message&amp;amp; m)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; at System.Windows.Forms.Button.WndProc(Message&amp;amp; m)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; at System.Windows.Forms.Control.ControlNativeWindow.OnMessage(Message&amp;amp; m)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; at System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message&amp;amp; m)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; at System.Windows.Forms.NativeWindow.DebuggableCallback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; at System.Windows.Forms.UnsafeNativeMethods.DispatchMessageW(MSG&amp;amp; msg)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; at System.Windows.Forms.Application.ComponentManager.System.Windows.Forms.UnsafeNativeMethods.IMsoComponentManager.FPushMessageLoop(Int32 dwComponentID, Int32 reason, Int32 pvLoopData)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; at System.Windows.Forms.Application.ThreadContext.RunMessageLoopInner(Int32 reason, ApplicationContext context)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; at System.Windows.Forms.Application.ThreadContext.RunMessageLoop(Int32 reason, ApplicationContext context)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; at System.Windows.Forms.Application.Run(Form mainForm)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; at ExcelTestProject.Program.Main() in U:\dherron\Projects\csharp\ExcelTestProject\Program.cs:line 18&lt;br&gt;&amp;nbsp; InnerException: &lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Message=Unexpected eExcelConditionalFormattingRuleType attribute in Conditional Formatting Rule&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Source=EPPlus&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; StackTrace:&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; at OfficeOpenXml.ConditionalFormatting.ExcelConditionalFormattingRuleType.GetTypeByAttrbiute(String attribute, XmlNode topNode, XmlNamespaceManager nameSpaceManager) in C:\Users\dherron\Downloads\EPPlus-7afb9506d6e0\epplus_7afb9506d6e0\EPPlus\ConditionalFormatting\ExcelConditionalFormattingRuleType.cs:line 140&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; at OfficeOpenXml.ConditionalFormatting.ExcelConditionalFormattingCollection..ctor(ExcelWorksheet worksheet) in C:\Users\dherron\Downloads\EPPlus-7afb9506d6e0\epplus_7afb9506d6e0\EPPlus\ConditionalFormatting\ExcelConditionalFormattingCollection.cs:line 153&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; at OfficeOpenXml.ExcelWorksheet.get_ConditionalFormatting() in C:\Users\dherron\Downloads\EPPlus-7afb9506d6e0\epplus_7afb9506d6e0\EPPlus\ExcelWorksheet.cs:line 2722&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; at OfficeOpenXml.ExcelStyles.UpdateXml() in C:\Users\dherron\Downloads\EPPlus-7afb9506d6e0\epplus_7afb9506d6e0\EPPlus\ExcelStyles.cs:line 609&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; at OfficeOpenXml.ExcelWorkbook.Save() in C:\Users\dherron\Downloads\EPPlus-7afb9506d6e0\epplus_7afb9506d6e0\EPPlus\ExcelWorkbook.cs:line 649&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; at OfficeOpenXml.ExcelPackage.Save() in C:\Users\dherron\Downloads\EPPlus-7afb9506d6e0\epplus_7afb9506d6e0\EPPlus\ExcelPackage.cs:line 710&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; InnerException: &lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="daveherron" When="04/10/2012 15:18:15">
          <Html>
        
&lt;p&gt;&lt;strong&gt;&lt;span style="color: rgb(255, 0, 0);"&gt;From my investigation into the source code, the "CellIs" conditional formatting type has not been fully implemented.&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;OuterXml = "&amp;lt;cfRule type=\"cellIs\" dxfId=\"493\" priority=\"91\" stopIfTrue=\"1\" operator=\"greaterThan\" xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\"&amp;gt;&amp;lt;formula&amp;gt;$G$24&amp;lt;/formula&amp;gt;&amp;lt;/cfRule&amp;gt;"&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="daveherron" When="04/10/2012 16:23:18">
          <Html>
        
&lt;p&gt;This is the function call where there is no support for the ruletype "cellIs".&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;pre&gt;internal static class ExcelConditionalFormattingRuleType
	{
&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp; /// &amp;lt;summary&amp;gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp; /// &lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp; /// &amp;lt;/summary&amp;gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp; /// &amp;lt;param name="attribute"&amp;gt;&amp;lt;/param&amp;gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp; /// &amp;lt;param name="topNode"&amp;gt;&amp;lt;/param&amp;gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp; /// &amp;lt;param name="nameSpaceManager"&amp;gt;&amp;lt;/param&amp;gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp; /// &amp;lt;returns&amp;gt;&amp;lt;/returns&amp;gt;
		&lt;span style="color: rgb(255, 0, 0);"&gt;internal static eExcelConditionalFormattingRuleType GetTypeByAttrbiute(&lt;/span&gt;
		  string attribute,
		  XmlNode topNode,
		  XmlNamespaceManager nameSpaceManager)
		{
			switch (attribute)
			{
				case ExcelConditionalFormattingConstants.RuleType.AboveAverage:
					return GetAboveAverageType(
					  topNode,
					  nameSpaceManager);

				case ExcelConditionalFormattingConstants.RuleType.Top10:
					return GetTop10Type(
					  topNode,
					  nameSpaceManager);

				case ExcelConditionalFormattingConstants.RuleType.TimePeriod:
					return GetTimePeriodType(
					  topNode,
					  nameSpaceManager);

				case ExcelConditionalFormattingConstants.RuleType.BeginsWith:
					return eExcelConditionalFormattingRuleType.BeginsWith;

				case ExcelConditionalFormattingConstants.RuleType.Between:
					return eExcelConditionalFormattingRuleType.Between;

				case ExcelConditionalFormattingConstants.RuleType.ContainsBlanks:
					return eExcelConditionalFormattingRuleType.ContainsBlanks;

				case ExcelConditionalFormattingConstants.RuleType.ContainsErrors:
					return eExcelConditionalFormattingRuleType.ContainsErrors;

				case ExcelConditionalFormattingConstants.RuleType.ContainsText:
					return eExcelConditionalFormattingRuleType.ContainsText;

				case ExcelConditionalFormattingConstants.RuleType.DuplicateValues:
					return eExcelConditionalFormattingRuleType.DuplicateValues;

				case ExcelConditionalFormattingConstants.RuleType.EndsWith:
					return eExcelConditionalFormattingRuleType.EndsWith;

				case ExcelConditionalFormattingConstants.RuleType.Equal:
					return eExcelConditionalFormattingRuleType.Equal;

				case ExcelConditionalFormattingConstants.RuleType.Expression:
					return eExcelConditionalFormattingRuleType.Expression;

				case ExcelConditionalFormattingConstants.RuleType.GreaterThan:
					return eExcelConditionalFormattingRuleType.GreaterThan;

				case ExcelConditionalFormattingConstants.RuleType.GreaterThanOrEqual:
					return eExcelConditionalFormattingRuleType.GreaterThanOrEqual;

				case ExcelConditionalFormattingConstants.RuleType.LessThan:
					return eExcelConditionalFormattingRuleType.LessThan;

				case ExcelConditionalFormattingConstants.RuleType.LessThanOrEqual:
					return eExcelConditionalFormattingRuleType.LessThanOrEqual;

				case ExcelConditionalFormattingConstants.RuleType.NotBetween:
					return eExcelConditionalFormattingRuleType.NotBetween;

				case ExcelConditionalFormattingConstants.RuleType.NotContainsBlanks:
					return eExcelConditionalFormattingRuleType.NotContainsBlanks;

				case ExcelConditionalFormattingConstants.RuleType.NotContainsErrors:
					return eExcelConditionalFormattingRuleType.NotContainsErrors;

				case ExcelConditionalFormattingConstants.RuleType.NotContainsText:
					return eExcelConditionalFormattingRuleType.NotContainsText;

				case ExcelConditionalFormattingConstants.RuleType.NotEqual:
					return eExcelConditionalFormattingRuleType.NotEqual;

				case ExcelConditionalFormattingConstants.RuleType.UniqueValues:
					return eExcelConditionalFormattingRuleType.UniqueValues;

				case ExcelConditionalFormattingConstants.RuleType.ColorScale:
					return GetColorScaleType(
					  topNode,
					  nameSpaceManager);
				case ExcelConditionalFormattingConstants.RuleType.IconSet:
					return GetIconSetType(topNode, nameSpaceManager);
				case ExcelConditionalFormattingConstants.RuleType.DataBar:
					return eExcelConditionalFormattingRuleType.DataBar;
			}

			&lt;span style="color: rgb(255, 0, 0);"&gt;throw new Exception(
			  ExcelConditionalFormattingConstants.Errors.UnexpectedRuleTypeAttribute);&lt;/span&gt;
		}&lt;/pre&gt;
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="04/10/2012 18:21:19">
          <Html>
        
&lt;p&gt;Ok, thanks we'll have a look at it.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Possible solution to corrupt excel file">
      <Posts>
        <Post From="marcot" When="03/10/2012 16:20:59">
          <Html>
        
&lt;p&gt;We have found a possible cause for corrupt excel file message, removing this line from our code:&lt;/p&gt;
&lt;p&gt;pck.Workbook.Properties.LastPrinted = DateTime.Now.ToUniversalTime().ToString(CultureInfo.InvariantCulture);&lt;/p&gt;
&lt;p&gt;Hope this helps someone..&lt;/p&gt;
&lt;p&gt;Marco&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Number formats">
      <Posts>
        <Post From="manukj06" When="03/10/2012 01:56:13">
          <Html>
        
&lt;p&gt;My code exports varchar data from my database to an Excel sheet but&amp;nbsp;a problem crops up with Excel showing all integar data as text. Basically, I see a small triange in the left top corner in all the cells saying "number is stored as text".
 What can I do to get my data in the right format. I am using VB.Net as my backend.&amp;nbsp; Thanks.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="03/10/2012 02:09:03">
          <Html>
        
&lt;p&gt;If you are using any helper method, like LoadFromCollection, LoadFromDatatable, etc,&amp;nbsp;&lt;span&gt;make sure you add the datatable colums as numeric if they contains numeric data. If not, set the cell value directly without toString().&lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="manukj06" When="03/10/2012 02:36:23">
          <Html>
        
&lt;p&gt;I am not using any helper method, please find a snippet of my code below, thanks for ur immediate response&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-size: x-small;"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;xlWorkSheet.Cells(row, col + 1).Value = dt.Rows(dtrow).ItemArray(col)&lt;/p&gt;
&lt;p&gt;&lt;span style="font-size: x-small;"&gt;&amp;nbsp;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;where dt is my data table, this runs in a loop.&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Format Shape &amp;gt; Text Box &amp;gt; Internal margin">
      <Posts>
        <Post From="MichaelCsikos" When="22/02/2012 00:47:50">
          <Html>
        
&lt;p&gt;How do I change the internal margin for text on an ExcelShape?&lt;/p&gt;
&lt;p&gt;Kind regards&lt;br&gt;
Michael&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="yonghan" When="28/08/2012 03:32:04">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;you can add this code in ExcelShape.cs&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;        &lt;span style="color: blue;"&gt;const&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; TextMarginLeftPath = &lt;span style="color: rgb(163, 21, 21);"&gt;"xdr:sp/xdr:txBody/a:bodyPr/@lIns"&lt;/span&gt;;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt; &lt;span style="color: gray;"&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt;&lt;span style="color: green;"&gt; internal text Left margin in pt&lt;/span&gt;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt; &lt;span style="color: gray;"&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;double&lt;/span&gt; TextMarginLeft
        {
            &lt;span style="color: blue;"&gt;get&lt;/span&gt;
            {
            	&lt;span style="color: blue;"&gt;var&lt;/span&gt; ins = GetXmlNodeDoubleNull(TextMarginLeftPath);
                &lt;span style="color: blue;"&gt;return&lt;/span&gt; ins.HasValue ? ins.Value / 12700.0 : 3175.0;
            }
            &lt;span style="color: blue;"&gt;set&lt;/span&gt;
            {
                SetXmlNodeString(TextMarginLeftPath, (value * 12700).ToString());
            }
        }

        &lt;span style="color: blue;"&gt;const&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; TextMarginTopPath = &lt;span style="color: rgb(163, 21, 21);"&gt;"xdr:sp/xdr:txBody/a:bodyPr/@tIns"&lt;/span&gt;;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt; &lt;span style="color: gray;"&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt;&lt;span style="color: green;"&gt; internal text Top margin in pt&lt;/span&gt;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt; &lt;span style="color: gray;"&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;double&lt;/span&gt; TextMarginTop
        {
            &lt;span style="color: blue;"&gt;get&lt;/span&gt;
            {
                &lt;span style="color: blue;"&gt;var&lt;/span&gt; ins = GetXmlNodeDoubleNull(TextMarginTopPath);
                &lt;span style="color: blue;"&gt;return&lt;/span&gt; ins.HasValue ? ins.Value / 12700.0 : 3175.0;
            }
            &lt;span style="color: blue;"&gt;set&lt;/span&gt;
            {
                SetXmlNodeString(TextMarginTopPath, (value * 12700).ToString());
            }
        }

        &lt;span style="color: blue;"&gt;const&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; TextMarginRightPath = &lt;span style="color: rgb(163, 21, 21);"&gt;"xdr:sp/xdr:txBody/a:bodyPr/@rIns"&lt;/span&gt;;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt; &lt;span style="color: gray;"&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt;&lt;span style="color: green;"&gt; internal text Right margin in pt&lt;/span&gt;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt; &lt;span style="color: gray;"&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;double&lt;/span&gt; TextMarginRight
        {
            &lt;span style="color: blue;"&gt;get&lt;/span&gt;
            {
                &lt;span style="color: blue;"&gt;var&lt;/span&gt; ins = GetXmlNodeDoubleNull(TextMarginRightPath);
                &lt;span style="color: blue;"&gt;return&lt;/span&gt; ins.HasValue ? ins.Value / 12700.0 : 3175.0;
            }
            &lt;span style="color: blue;"&gt;set&lt;/span&gt;
            {
                SetXmlNodeString(TextMarginRightPath, (value * 12700).ToString());
            }
        }

        &lt;span style="color: blue;"&gt;const&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; TextMarginBottomPath = &lt;span style="color: rgb(163, 21, 21);"&gt;"xdr:sp/xdr:txBody/a:bodyPr/@bIns"&lt;/span&gt;;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt; &lt;span style="color: gray;"&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt;&lt;span style="color: green;"&gt; internal text Bottom margin in pt&lt;/span&gt;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt; &lt;span style="color: gray;"&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;double&lt;/span&gt; TextMarginBottom
        {
            &lt;span style="color: blue;"&gt;get&lt;/span&gt;
            {
                &lt;span style="color: blue;"&gt;var&lt;/span&gt; ins = GetXmlNodeDoubleNull(TextMarginBottomPath);
                &lt;span style="color: blue;"&gt;return&lt;/span&gt; ins.HasValue ? ins.Value / 12700.0 : 3175.0;
            }
            &lt;span style="color: blue;"&gt;set&lt;/span&gt;
            {
                SetXmlNodeString(TextMarginBottomPath, (value * 12700).ToString());
            }
        }
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="GrzesiekP" When="30/09/2012 20:14:13">
          <Html>
        
&lt;p&gt;Any changes since the 3.1 realesed?&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Creating number cell">
      <Posts>
        <Post From="potturi_rp1" When="27/09/2012 09:17:35">
          <Html>
        
&lt;p&gt;Hello,&lt;/p&gt;
&lt;p&gt;I am creating excel using EPPLUS. When number is stored in cell, I am getting a message “The number in this cell is formatted as text or preceded by an apostrophe”. How can trun off this message and convert the cell as number cell.&lt;/p&gt;
&lt;p&gt;Thanks in advance.&lt;/p&gt;
&lt;p&gt;Thanks,&lt;/p&gt;
&lt;p&gt;Ram&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mslivetech" When="27/09/2012 18:25:54">
          <Html>
        
&lt;p&gt;I&amp;nbsp; am not sure of your specific situation without seeing the code that you are using.&amp;nbsp; I am pretty sure that it depends on the data type of the variable on the right side of the assignment statement as the Value property is an object.&amp;nbsp; So,
 make sure that you cast your variable to be how you want excel to hold it and then use the column formatting to change the display.&amp;nbsp; For example, if a cell should be treated as a money field, then I would use the following.&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;ExcelWorksheet tab = [Assign &lt;span style="color: blue;"&gt;this&lt;/span&gt; to your worksheet that has the data &lt;span style="color: blue;"&gt;on&lt;/span&gt; it];

&lt;span style="color: blue;"&gt;decimal&lt;/span&gt; cellAmount;
&lt;span style="color: blue;"&gt;string&lt;/span&gt; amount=&lt;span style="color: rgb(163, 21, 21);"&gt;"50.35"&lt;/span&gt;;

&lt;span style="color: blue;"&gt;if&lt;/span&gt;(decimail.TryParse(amount, &lt;span style="color: blue;"&gt;out&lt;/span&gt; cellAmount)){
    tab.Cells[1,1].Value=cellAmount;
    tab.Cells[1, 1].Style.Numberformat =&lt;span style="color: rgb(163, 21, 21);"&gt;"$#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00"&lt;/span&gt;;
}
&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Updated beta in nuget">
      <Posts>
        <Post From="ta" When="21/09/2012 10:19:45">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;is there a chance to get an updated version of the beta in nuget? I would like to start using some of the newer features in conditional formatting.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="25/09/2012 20:42:45">
          <Html>
        
&lt;p&gt;Jan releases a new version today, soon nuget package will be updated.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="swmal" When="26/09/2012 20:12:30">
          <Html>
        
&lt;p&gt;the nuget package has been released now.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="ta" When="27/09/2012 08:40:04">
          <Html>
        
&lt;p&gt;Awesome. Thank you very much.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Purple cells/Normal format">
      <Posts>
        <Post From="isglass" When="26/09/2012 09:47:51">
          <Html>
        
&lt;p&gt;Hi!&lt;/p&gt;
&lt;p&gt;After updating to 3.1.1 most of my cells turned purple :) Looks like the "Normal" style is messed up by default? Any ideas?&lt;/p&gt;
&lt;p&gt;Looks like this: &lt;a href="http://www.greencon.se/purple.jpg" rel="nofollow"&gt;http://www.greencon.se/purple.jpg&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Thx!&lt;/p&gt;
&lt;p&gt;//johan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="subskipper" When="26/09/2012 12:32:51">
          <Html>
        
&lt;p&gt;Not sure if you're having the same issue we did, but if you're in a hurry, do what we did and extract Normal style in ExcelStyles.cs by using&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;var&lt;/span&gt; normal = NamedStyles.First(x =&amp;gt; x.Name == &lt;span style="color: rgb(163, 21, 21);"&gt;"Normal"&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I think EPPlus assumes that normal is the first style, but if it isn't, things get a bit messy. We inserted the above line just before line 470 in ExcelStyles.cs in the EPPlus source and we got rid of our weird style (in our case it was Visited Hyperlink).
 Recompile and ref the new binary.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Again, not sure this helps, but it worked for us.&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;After reading again I realize it wasn't quite the same issue, but I suppose you could edit the normal style&amp;nbsp;programmatically&amp;nbsp;to get what you want. :) Sorry!&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="isglass" When="26/09/2012 12:40:27">
          <Html>
        
&lt;p&gt;Thanks for your reply, I solved it temporarily by using av white fill for all cells... so no hurry but annoying :)&lt;/p&gt;
&lt;p&gt;But I'll give your fix a try the next time it happens and report back if it worked&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="26/09/2012 17:53:27">
          <Html>
        This discussion has been copied to a work item. Click &lt;a href="http://epplus.codeplex.com/workitem/14745" rel="nofollow"&gt;
here&lt;/a&gt; to go to the work item and continue the discussion.
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Error: Cannot add part for the specified URI because it is already in the package.">
      <Posts>
        <Post From="subskipper" When="25/09/2012 14:01:05">
          <Html>
        
&lt;p&gt;Hi guys!&lt;/p&gt;
&lt;p&gt;Running into the same issue as in the linked issue below? Is this one still open? Any hints as to where in the source I should look and we'll be happy to provide a fix. :) We're sort of in a rush here. :)&lt;/p&gt;
&lt;p&gt;Thanks!&lt;/p&gt;
&lt;p&gt;&lt;a href="http://epplus.codeplex.com/workitem/14422" target="_blank" rel="nofollow"&gt;http://epplus.codeplex.com/workitem/14422&lt;/a&gt;&lt;a href="http://epplus.codeplex.com/discussions/392556" target="_blank" rel="nofollow"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;*doh* Fixed broken link.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Saving (processing) files with unknown styles">
      <Posts>
        <Post From="jurisk" When="24/09/2012 20:06:11">
          <Html>
        
&lt;p&gt;Hello,&lt;/p&gt;
&lt;p&gt;the library is really very impressive thanks a lot for your effort.&lt;/p&gt;
&lt;p&gt;I just have a trouble trying save an excel file, that have an unsupported style (in my case: CellIs)&lt;/p&gt;
&lt;p&gt;Unfortunately, all Save methods throw exception and at Styles.UpdateXml() line and let me no chance to save (file i have to process is a valid Office 2007/20120 file and i don't change any existing styles).&lt;/p&gt;
&lt;p&gt;Only bad workaround i found is to disable completely (out comment) this code line - but thereby will be lost all styles, not only unknown one.&lt;/p&gt;
&lt;p&gt;Has somebody solution for this problem?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks in advance!&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Display Units">
      <Posts>
        <Post From="mslivetech" When="20/09/2012 19:35:23">
          <Html>
        
&lt;p&gt;I am currently working on a column graph where my data values have large dollar amounts.&amp;nbsp; In Excel I can change the "Display Units" on that axis to various values such as Millions.&amp;nbsp; This is under the "Format Axis" -&amp;gt; Axis
 Options area in Excel.&lt;/p&gt;
&lt;p&gt;Is there anyway to do that same thing using EPPlus without actually modifying the values of the data?&lt;/p&gt;
&lt;p&gt;Tracy&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="An unhandled exception of type 'System.StackOverflowException' occurred in mscorlib.dll">
      <Posts>
        <Post From="scottietrek" When="20/09/2012 12:54:15">
          <Html>
        
&lt;p&gt;When running the class and creating ExcelPackage. I get this error:&lt;/p&gt;
&lt;p&gt;An unhandled exception of type 'System.StackOverflowException' occurred in mscorlib.dll&lt;/p&gt;
&lt;p&gt;I downloaded the source to checked which line. it is happening ExcelCellBase.cs line 433&lt;/p&gt;
&lt;p&gt;please check into it as there is no stacktrace to check into.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Known issues with Azure Web sites?">
      <Posts>
        <Post From="noocyte" When="07/09/2012 08:03:31">
          <Html>
        
&lt;p&gt;I've had EPPlus working on a Azure Web Role for some time now, but I've been experimenting with Azure Web Sites lately and there I'm getting a very weird error;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;[DivideByZeroException: Attempted to divide &lt;span style="color: blue;"&gt;by&lt;/span&gt; zero.]
   System.Decimal.FCallDivide(Decimal&amp;amp; d1, Decimal&amp;amp; d2) +0
   OfficeOpenXml.Drawing.ExcelDrawing.SetPixelWidth(Int32 pixels, Single dpi) +465
   Compliance.Net.CommonCode.PivotGenerator.GeneratePivotTable(ExcelWorksheet dataWorksheet, ExcelWorksheet pivotWorksheet, Int32 endRow)
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I am getting this on the same data and code as is running on Azure Web Role.&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Any ideas?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Edit:&lt;br&gt;
Also posted on Stackoverflow: &lt;a href="http://stackoverflow.com/questions/12313344/why-am-i-getting-divide-by-zero-exception-on-azure-web-sites" rel="nofollow"&gt;
http://stackoverflow.com/questions/12313344/why-am-i-getting-divide-by-zero-exception-on-azure-web-sites&lt;/a&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="andiih" When="17/09/2012 20:59:34">
          <Html>
        
&lt;p&gt;I'm having the same problem inserting an image, again in SetPixelWidth&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Automatic formatting of dates">
      <Posts>
        <Post From="andyrice" When="08/05/2012 15:50:19">
          <Html>
        
&lt;p&gt;This is a great project.&amp;nbsp; A request is to add automatic formatting of dates and datetimes to the LoadFriom... methods.&amp;nbsp; That would at least set Style.Numberformat.Format and do a column AutoFit().&amp;nbsp; I think that would simplifiy writing dates/datetimes.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="sulmar" When="16/09/2012 14:39:02">
          <Html>
        
&lt;p&gt;+1 Vote!&lt;/p&gt;
&lt;p&gt;I'm using code below currently:&lt;/p&gt;
&lt;p&gt;worksheet.Column(1).Style.Numberformat.Format = CultureInfo.CurrentCulture.DateTimeFormat.ShortDatePattern; &amp;nbsp; &amp;nbsp; &amp;nbsp;worksheet.Column(1).AutoFit();&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Convert excel chart to picture">
      <Posts>
        <Post From="sshah2628" When="14/09/2012 04:59:55">
          <Html>
        
&lt;p&gt;Hey,&lt;/p&gt;
&lt;p&gt;I am entry level programmer.&lt;/p&gt;
&lt;p&gt;How can I convert my Excel chart to picture(any format .jpeg, .png etc)?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="14/09/2012 05:07:29">
          <Html>
        
&lt;p&gt;I don't know how to help you, but I know there is no way to export charts in EPPlus, maybe interop or npoi project can do this.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="sshah2628" When="14/09/2012 05:39:41">
          <Html>
        
&lt;p&gt;Thanks for your quick response. If you have any suggestions for Discussion:395488 please let me know.&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Put excel chart to powerpoint slide">
      <Posts>
        <Post From="sshah2628" When="14/09/2012 05:18:23">
          <Html>
        
&lt;p&gt;Hello All,&lt;/p&gt;
&lt;p&gt;I have generated charts in Excel using Epplus. I need to put chart to powerpoint slide. How can I do that?&lt;/p&gt;
&lt;p&gt;Is there any similar library like EPplus for Powerpoint to generate slides which contains text,charts,tables.&lt;/p&gt;
&lt;p&gt;Currently, I am using Microsoft.Office.Interop.PowerPoint. &amp;nbsp;&lt;/p&gt;
&lt;p&gt;I&amp;nbsp;tried&amp;nbsp;to assign my&amp;nbsp;OfficeOpenXml.Drawing.Chart.ExcelPieChart to&amp;nbsp;Microsoft.Office.Interop.Excel.ChartObject.&lt;/p&gt;
&lt;p&gt;But&amp;nbsp;I am not able to&amp;nbsp;cast object of type 'OfficeOpenXml.Drawing.Chart.ExcelPieChart' to type 'Microsoft.Office.Interop.Excel.ChartObject'.&lt;/p&gt;
&lt;p&gt;I also tried to use Office open XML for powerpoint but I did not find much documentation.&lt;/p&gt;
&lt;p&gt;What do I need to do?&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="EPPlus  &quot;Combobox/DropDownList&quot;">
      <Posts>
        <Post From="aviakd420" When="12/09/2012 07:04:09">
          <Html>
        
&lt;div&gt;
&lt;p&gt;Hello All,&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;Please provide a link where I can find the code to build the Combobox or DropDownList in a particular cell.&lt;/p&gt;
&lt;p&gt;This must be programmatically not by using the templates, because user can add or delete those value in the application and they can take the excel sheet for those record. Again they can import that excel sheet in the application after changing that cell.&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;Please help us to solve this.&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 8pt;"&gt;Thank You &amp;amp; Regards,&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 10pt;"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(54, 95, 145); font-size: 9pt;"&gt;Avinash Dubey | 988 6532 111&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(54, 95, 145); font-size: 9pt;"&gt;&lt;img width="89" height="31" id="Picture_x0020_1" alt="logo" src="cid:image001.png@01CD90DA.F32CC440"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(54, 95, 145); font-size: 9pt;"&gt;Logistics &amp;amp; Supply Chain IT&lt;/span&gt;&lt;span style="color: rgb(54, 95, 145);"&gt;
&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(0, 112, 192);"&gt;&lt;a href="http://www.dream-orbit.com/" rel="nofollow"&gt;&lt;span style="color: rgb(0, 112, 192); font-size: 9pt;"&gt;www.dream-orbit.com&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;&lt;span style="color: rgb(31, 73, 125); font-size: 9pt;"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="12/09/2012 13:06:08">
          <Html>
        
&lt;p&gt;EPPlus doesn't support forms in this current release but you can achieve it through VBA code.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="EPPlus  &quot;Combobox/DropDownList&quot;">
      <Posts>
        <Post From="aviakd420" When="12/09/2012 07:05:55">
          <Html>
        
&lt;p&gt;Hello All,&lt;/p&gt;
&lt;p&gt;Please provide a link where I can find the code to create the &amp;nbsp; Combobox or DropDownList in a particular cell.&lt;/p&gt;
&lt;p&gt;This must be programmatically not by using the templates, because user can add or delete those value in the application and they can take the excel sheet for those record from the application (Windows Application). Again they can import that excel sheet
 in the application after changing that cell.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;Please help us to solve this.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Excel 2010 Protected View from Web Page">
      <Posts>
        <Post From="pbukowski" When="31/08/2012 14:21:12">
          <Html>
        
&lt;p&gt;Hello,&lt;/p&gt;
&lt;p&gt;Our users have recently been upgraded to Excel 2010 and since have been having problems when exporting an Excel file (.xlsx)&amp;nbsp;from our intranet web pages. The Excel file opens, but it displays a message at tope of screen&amp;nbsp;saying it's open in "Protected
 View". It also shows an option to enable editing, but this button will not work. I have found that if the user chooses to SAVE the Excel file (when you&amp;nbsp;get the&amp;nbsp;option to Open or Save), it will work fine and does not display the protected view.&lt;/p&gt;
&lt;p&gt;The issue I have in protected view is that the AutoFilters which I have set will not work in protected view. Are there any work-a-rounds for this, rather than asking the user to save the file, rather than just opening it?&lt;/p&gt;
&lt;p&gt;BTW, this is the code I use to export the excel file:&lt;/p&gt;
&lt;p&gt;Thanks so much !&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;Protected&lt;/span&gt; &lt;span style="color: blue;"&gt;Sub&lt;/span&gt; imgExportToExcel_Click(&lt;span style="color: blue;"&gt;ByVal&lt;/span&gt; sender &lt;span style="color: blue;"&gt;As&lt;/span&gt; &lt;span style="color: blue;"&gt;Object&lt;/span&gt;, &lt;span style="color: blue;"&gt;ByVal&lt;/span&gt; e &lt;span style="color: blue;"&gt;As&lt;/span&gt; System.Web.UI.ImageClickEventArgs) &lt;span style="color: blue;"&gt;Handles&lt;/span&gt; imgExportToExcel.Click

        &lt;span style="color: green;"&gt;'User clicked the button to export to excel.&lt;/span&gt;

        &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; conn &lt;span style="color: blue;"&gt;As&lt;/span&gt; SqlConnection = &lt;span style="color: blue;"&gt;New&lt;/span&gt; SqlConnection(connString)
        &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; adapter &lt;span style="color: blue;"&gt;As&lt;/span&gt; SqlDataAdapter = &lt;span style="color: blue;"&gt;New&lt;/span&gt; SqlDataAdapter
        adapter.SelectCommand = &lt;span style="color: blue;"&gt;New&lt;/span&gt; SqlCommand(lblSqlExcel.Text, conn)
        &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; DT &lt;span style="color: blue;"&gt;As&lt;/span&gt; &lt;span style="color: blue;"&gt;New&lt;/span&gt; DataTable
        conn.Open()
        &lt;span style="color: blue;"&gt;Try&lt;/span&gt;
            adapter.Fill(DT)
        &lt;span style="color: blue;"&gt;Finally&lt;/span&gt;
            &lt;span style="color: blue;"&gt;If&lt;/span&gt; conn &lt;span style="color: blue;"&gt;IsNot&lt;/span&gt; &lt;span style="color: blue;"&gt;Nothing&lt;/span&gt; &lt;span style="color: blue;"&gt;Then&lt;/span&gt;
                &lt;span style="color: blue;"&gt;If&lt;/span&gt; conn.State = ConnectionState.Open &lt;span style="color: blue;"&gt;Then&lt;/span&gt; conn.Close()
                conn = &lt;span style="color: blue;"&gt;Nothing&lt;/span&gt;
            &lt;span style="color: blue;"&gt;End&lt;/span&gt; &lt;span style="color: blue;"&gt;If&lt;/span&gt;
        &lt;span style="color: blue;"&gt;End&lt;/span&gt; &lt;span style="color: blue;"&gt;Try&lt;/span&gt;


        &lt;span style="color: blue;"&gt;Using&lt;/span&gt; pck &lt;span style="color: blue;"&gt;As&lt;/span&gt; &lt;span style="color: blue;"&gt;New&lt;/span&gt; ExcelPackage()
            &lt;span style="color: green;"&gt;'Create the worksheet &lt;/span&gt;
            &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; ws &lt;span style="color: blue;"&gt;As&lt;/span&gt; ExcelWorksheet = pck.Workbook.Worksheets.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"Raw_Data"&lt;/span&gt;)

            &lt;span style="color: green;"&gt;'Load the datatable into the sheet, starting from cell A1. Print the column names on row 1  &lt;/span&gt;
            ws.Cells(&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;).LoadFromDataTable(DT, &lt;span style="color: blue;"&gt;True&lt;/span&gt;)

            &lt;span style="color: green;"&gt;'count the columns&lt;/span&gt;
            &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; ColumnCount &lt;span style="color: blue;"&gt;As&lt;/span&gt; &lt;span style="color: blue;"&gt;String&lt;/span&gt; = &lt;span style="color: rgb(163, 21, 21);"&gt;""&lt;/span&gt;
            ColumnCount = DT.Columns.&lt;span style="color: blue;"&gt;Count&lt;/span&gt; - 1

            &lt;span style="color: green;"&gt;'count the rows&lt;/span&gt;
            &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; RowCount &lt;span style="color: blue;"&gt;As&lt;/span&gt; &lt;span style="color: blue;"&gt;String&lt;/span&gt; = &lt;span style="color: rgb(163, 21, 21);"&gt;""&lt;/span&gt;
            RowCount = DT.Rows.&lt;span style="color: blue;"&gt;Count&lt;/span&gt;

            &lt;span style="color: green;"&gt;'prepare the range for the column headers &lt;/span&gt;
            &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; headerRange &lt;span style="color: blue;"&gt;As&lt;/span&gt; &lt;span style="color: blue;"&gt;String&lt;/span&gt; = &lt;span style="color: rgb(163, 21, 21);"&gt;"A1:J1"&lt;/span&gt;


            &lt;span style="color: green;"&gt;'Format the header for columns &lt;/span&gt;
            &lt;span style="color: blue;"&gt;Using&lt;/span&gt; rng &lt;span style="color: blue;"&gt;As&lt;/span&gt; ExcelRange = ws.Cells(headerRange)
                rng.Style.WrapText = &lt;span style="color: blue;"&gt;False&lt;/span&gt;
                rng.Style.Font.Bold = &lt;span style="color: blue;"&gt;True&lt;/span&gt;

                rng.Style.Fill.PatternType = ExcelFillStyle.Solid
                rng.Style.Fill.BackgroundColor.SetColor(Color.Silver)

                rng.Style.Font.Color.SetColor(Color.Black)
            &lt;span style="color: blue;"&gt;End&lt;/span&gt; &lt;span style="color: blue;"&gt;Using&lt;/span&gt;

            &lt;span style="color: green;"&gt;'format as Date/Time AM/PM&lt;/span&gt;
            ws.Cells(&lt;span style="color: rgb(163, 21, 21);"&gt;"F:F"&lt;/span&gt;).Style.Numberformat.Format = &lt;span style="color: rgb(163, 21, 21);"&gt;"mm/dd/yy h:mm AM/PM;@"&lt;/span&gt;

            ws.Cells(&lt;span style="color: rgb(163, 21, 21);"&gt;"A:J"&lt;/span&gt;).Style.HorizontalAlignment = ExcelHorizontalAlignment.Center
            &lt;span style="color: green;"&gt;'ws.Cells("A:J").Style.WrapText = False&lt;/span&gt;

            &lt;span style="color: green;"&gt;'freeze panes at cell A2&lt;/span&gt;
            ws.View.FreezePanes(2, 1)

            &lt;span style="color: green;"&gt;'Create an autofilter for the header range&lt;/span&gt;
            ws.Cells(headerRange).AutoFilter = &lt;span style="color: blue;"&gt;True&lt;/span&gt;

            &lt;span style="color: green;"&gt;'minimum column width can be specified&lt;/span&gt;
            ws.Cells(&lt;span style="color: rgb(163, 21, 21);"&gt;"A:J"&lt;/span&gt;).AutoFitColumns(10)

            &lt;span style="color: green;"&gt;'Read the Excel file in a byte array&lt;/span&gt;
            &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; fileBytes &lt;span style="color: blue;"&gt;As&lt;/span&gt; [&lt;span style="color: blue;"&gt;Byte&lt;/span&gt;]() = pck.GetAsByteArray()

            &lt;span style="color: green;"&gt;'Clear the response &lt;/span&gt;
            Response.Clear()
            Response.ClearContent()
            Response.ClearHeaders()
            Response.Cookies.Clear()
            &lt;span style="color: green;"&gt;'Add the header &amp;amp; other information &lt;/span&gt;
            Response.Cache.SetCacheability(HttpCacheability.[&lt;span style="color: blue;"&gt;Private&lt;/span&gt;])
            Response.CacheControl = &lt;span style="color: rgb(163, 21, 21);"&gt;"private"&lt;/span&gt;
            Response.Charset = System.Text.UTF8Encoding.UTF8.WebName
            Response.ContentEncoding = System.Text.UTF8Encoding.UTF8
            Response.AppendHeader(&lt;span style="color: rgb(163, 21, 21);"&gt;"Content-Length"&lt;/span&gt;, fileBytes.Length.ToString())
            Response.AppendHeader(&lt;span style="color: rgb(163, 21, 21);"&gt;"Pragma"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"cache"&lt;/span&gt;)
            Response.AppendHeader(&lt;span style="color: rgb(163, 21, 21);"&gt;"Expires"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"60"&lt;/span&gt;)
            Response.AppendHeader(&lt;span style="color: rgb(163, 21, 21);"&gt;"Content-Disposition"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"attachment; "&lt;/span&gt; + &lt;span style="color: rgb(163, 21, 21);"&gt;"filename=""ExcelReport.xlsx""; "&lt;/span&gt; + &lt;span style="color: rgb(163, 21, 21);"&gt;"size="&lt;/span&gt; + fileBytes.Length.ToString() + &lt;span style="color: rgb(163, 21, 21);"&gt;"; "&lt;/span&gt; + &lt;span style="color: rgb(163, 21, 21);"&gt;"creation-date="&lt;/span&gt; + DateTime.Now.ToString(&lt;span style="color: rgb(163, 21, 21);"&gt;"R"&lt;/span&gt;) + &lt;span style="color: rgb(163, 21, 21);"&gt;"; "&lt;/span&gt; + &lt;span style="color: rgb(163, 21, 21);"&gt;"modification-date="&lt;/span&gt; + DateTime.Now.ToString(&lt;span style="color: rgb(163, 21, 21);"&gt;"R"&lt;/span&gt;) + &lt;span style="color: rgb(163, 21, 21);"&gt;"; "&lt;/span&gt; + &lt;span style="color: rgb(163, 21, 21);"&gt;"read-date="&lt;/span&gt; + DateTime.Now.ToString(&lt;span style="color: rgb(163, 21, 21);"&gt;"R"&lt;/span&gt;))
            Response.ContentType = &lt;span style="color: rgb(163, 21, 21);"&gt;"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"&lt;/span&gt;
            &lt;span style="color: green;"&gt;'Write it back to the client &lt;/span&gt;
            Response.BinaryWrite(fileBytes)
            Response.[&lt;span style="color: blue;"&gt;End&lt;/span&gt;]()
        &lt;span style="color: blue;"&gt;End&lt;/span&gt; &lt;span style="color: blue;"&gt;Using&lt;/span&gt;

        &lt;span style="color: green;"&gt;'clear out the data table, we're done with it&lt;/span&gt;
        DT.Clear()
    &lt;span style="color: blue;"&gt;End&lt;/span&gt; &lt;span style="color: blue;"&gt;Sub&lt;/span&gt;

&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Paul&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="31/08/2012 14:37:26">
          <Html>
        
&lt;p&gt;I don't know any workaround to help you, but maybe I can help you to find out a solution. Instead of "Save" your file, choose "Save As", then rename yours files to .zip, extract them, compare their content with WinMerge and search to
 different files.&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="pbukowski" When="31/08/2012 14:50:25">
          <Html>
        
&lt;p&gt;That is an interesting idea, I'll give it a try and if I come up with anything - I'll post back here. Thank you !&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="gsbell" When="11/09/2012 16:36:48">
          <Html>
        
&lt;p&gt;Probably some side-effect of Excel 2010 Protected View, not EPPlus' fault I don't think.&lt;/p&gt;
&lt;p&gt;You can disable in Excel Options -&amp;gt; Trust Center -&amp;gt; Trust Center Settings... button --&amp;gt; Protected View -&amp;gt; and uncheck "Enable Protected View for files originating from the Internet".&amp;nbsp; I'm not sure if there's way to disable Protected
 View just for Intranet though...&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="MaxCols and MaxRows and FileSize">
      <Posts>
        <Post From="bhavtoshsharma" When="11/09/2012 11:54:02">
          <Html>
        
&lt;p&gt;Im trying to load 9 MB excel file.&amp;nbsp;Epplus is able to load the file but the Workbook object is "nothing"&lt;/p&gt;
&lt;p&gt;During testing i found that my excel has:&lt;/p&gt;
&lt;p&gt;MaxCols=16384&lt;/p&gt;
&lt;p&gt;MaxRows=1048576&lt;/p&gt;
&lt;p&gt;Im using latest release version of this component.&lt;/p&gt;
&lt;p&gt;Is there any limit of excel Filesize,&amp;nbsp;MaxCols and MaxRows properties in EPPlus as of today?&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Rounded corners of charts">
      <Posts>
        <Post From="eriove" When="10/09/2012 08:09:30">
          <Html>
        
&lt;p&gt;I couldn't find the option for rounded corners for charts (Format Chart Area &amp;gt; Border Styles &amp;gt; Rounded Corners) so I wrote the following property for the class ExcelChart:&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;        &lt;span style="color: gray;"&gt;///&lt;/span&gt; &lt;span style="color: gray;"&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt;&lt;span style="color: green;"&gt; Is true if if the chart has rounded corners. Is null if rounded corners aren't specfied.&lt;/span&gt;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt; &lt;span style="color: gray;"&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;bool&lt;/span&gt;? HasRoundedCorners
        {
            &lt;span style="color: blue;"&gt;get&lt;/span&gt;
            {
                &lt;span style="color: blue;"&gt;var&lt;/span&gt; node = ChartXml.SelectSingleNode(&lt;span style="color: rgb(163, 21, 21);"&gt;"c:chartSpace/c:roundedCorners"&lt;/span&gt;, NameSpaceManager);
                &lt;span style="color: blue;"&gt;if&lt;/span&gt; (node == &lt;span style="color: blue;"&gt;null&lt;/span&gt;)
                    &lt;span style="color: blue;"&gt;return&lt;/span&gt; &lt;span style="color: blue;"&gt;null&lt;/span&gt;;
                &lt;span style="color: blue;"&gt;return&lt;/span&gt; node.Attributes[&lt;span style="color: rgb(163, 21, 21);"&gt;"val"&lt;/span&gt;].Value == &lt;span style="color: rgb(163, 21, 21);"&gt;"1"&lt;/span&gt;;
            }
            &lt;span style="color: blue;"&gt;set&lt;/span&gt;
            {
                &lt;span style="color: blue;"&gt;var&lt;/span&gt; node = ChartXml.SelectSingleNode(&lt;span style="color: rgb(163, 21, 21);"&gt;"c:chartSpace/c:roundedCorners"&lt;/span&gt;, NameSpaceManager);
                &lt;span style="color: blue;"&gt;if&lt;/span&gt; (node == &lt;span style="color: blue;"&gt;null&lt;/span&gt; &amp;amp;&amp;amp; value.HasValue)
                {
                    node = ChartXml.SelectSingleNode(&lt;span style="color: rgb(163, 21, 21);"&gt;"c:chartSpace"&lt;/span&gt;, NameSpaceManager);
                    &lt;span style="color: blue;"&gt;var&lt;/span&gt; element = ChartXml.CreateNode(XmlNodeType.Element, &lt;span style="color: rgb(163, 21, 21);"&gt;"c"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"roundedCorners"&lt;/span&gt;, NameSpaceManager.LookupNamespace(&lt;span style="color: rgb(163, 21, 21);"&gt;"c"&lt;/span&gt;));
                    &lt;span style="color: blue;"&gt;var&lt;/span&gt; attribute = ChartXml.CreateAttribute(&lt;span style="color: rgb(163, 21, 21);"&gt;"val"&lt;/span&gt;);
                    &lt;span style="color: blue;"&gt;if&lt;/span&gt; (value.Value)
                        attribute.Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"1"&lt;/span&gt;;
                    &lt;span style="color: blue;"&gt;else&lt;/span&gt;
                        attribute.Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"0"&lt;/span&gt;;
                    element.Attributes.Append(attribute);
                    node.AppendChild(element);
                }
                &lt;span style="color: blue;"&gt;else&lt;/span&gt; &lt;span style="color: blue;"&gt;if&lt;/span&gt; (node != &lt;span style="color: blue;"&gt;null&lt;/span&gt; &amp;amp;&amp;amp; !value.HasValue)
                {
                    &lt;span style="color: blue;"&gt;var&lt;/span&gt; chartSpace = ChartXml.SelectSingleNode(&lt;span style="color: rgb(163, 21, 21);"&gt;"c:chartSpace"&lt;/span&gt;, NameSpaceManager);
                    chartSpace.RemoveChild(node);
                }
                &lt;span style="color: blue;"&gt;else&lt;/span&gt; &lt;span style="color: blue;"&gt;if&lt;/span&gt; (node != &lt;span style="color: blue;"&gt;null&lt;/span&gt; &amp;amp;&amp;amp; value.HasValue)
                {
                    &lt;span style="color: blue;"&gt;if&lt;/span&gt; (value.Value)
                        node.Attributes[&lt;span style="color: rgb(163, 21, 21);"&gt;"val"&lt;/span&gt;].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"1"&lt;/span&gt;;
                    &lt;span style="color: blue;"&gt;else&lt;/span&gt;
                        node.Attributes[&lt;span style="color: rgb(163, 21, 21);"&gt;"val"&lt;/span&gt;].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"0"&lt;/span&gt;;
                }
                &lt;span style="color: blue;"&gt;else&lt;/span&gt;
                {
                    &lt;span style="color: green;"&gt;// Value is null and no node exists so nothing should be done&lt;/span&gt;
                }
            }
        }
&lt;/pre&gt;
&lt;/div&gt;
I'm not used to working with XML so I'm sure some things could be done in a better way. But if anyone else needs this feature this may at least give them somewhere to start.
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Blank Column Name">
      <Posts>
        <Post From="rohandm29" When="06/09/2012 07:47:55">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;How can I set Column to Blank.&lt;/p&gt;
&lt;p&gt;I tried various ways but ended up in getting default column name as &lt;strong&gt;'Column1'&lt;/strong&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="TiramisuBxl" When="07/09/2012 06:26:30">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I guess you are using an excel table ? In this case excel itself does not allow you to have an empty cell as column name.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Cell NumberFormat and Displayed Text">
      <Posts>
        <Post From="pvinitha" When="10/08/2011 20:05:21">
          <Html>
        
&lt;p&gt;Hi ,&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I’m trying to format and .xlsx file and read the contents of the formatted file and export to a csv file. When exporting to the csv&amp;nbsp; the datecolumn value some of them are displayed as “40630”.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I have set the column style property as below:&lt;/p&gt;
&lt;p&gt;&lt;span style="color: green; font-size: 10pt;"&gt;worksheet.Column(2).Style.Numberformat.Format&amp;nbsp; = "mmmm dd yyyy"&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(0, 0, 0); font-size: 10pt;"&gt;&amp;nbsp;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(0, 0, 0); font-size: 10pt;"&gt;When I look up the data in column the values look as the above format. While reading in code the cell.value=40630.&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(0, 0, 0); font-size: 10pt;"&gt;&amp;nbsp;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(0, 0, 0); font-size: 10pt;"&gt;Ay ideas?&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(0, 0, 0); font-size: 10pt;"&gt;&amp;nbsp;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(0, 0, 0); font-size: 10pt;"&gt;Cheers,&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: green; font-size: 10pt;"&gt;&amp;nbsp;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: green; font-size: 10pt;"&gt;&amp;nbsp;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: green; font-size: 10pt;"&gt;Vinitha&lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="12/08/2011 14:12:12">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Dates are stored as numbers in Excel. Use the ExcelRange.GetValue&amp;lt;DateTime&amp;gt;() to convert it to a valid DateTime.&lt;/p&gt;
&lt;p&gt;If you want the formatted value, use the ExcelRange.Text property.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="pvinitha" When="12/08/2011 19:17:23">
          <Html>
        
&lt;p&gt;Thanks Jan. Will try that.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="rohandm29" When="06/09/2012 07:06:36">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I want to export Integer values to a column in excel, but I see a small triange in the left top corner in all the cell saying "number is stored as text"&lt;/p&gt;
&lt;p&gt;what should be done?&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Generate Excel withou the Column Sort">
      <Posts>
        <Post From="rohandm29" When="05/09/2012 08:59:14">
          <Html>
        
&lt;p&gt;When the excel is generated the sort order is applied to all the columns by default.&lt;/p&gt;
&lt;p&gt;what should i do to remove it?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="rohandm29" When="06/09/2012 06:56:19">
          <Html>
        
&lt;p&gt;oh. I got it.. :)&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;worksheet.Tables[0].ShowFilter = &lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;
&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;false;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;a&gt;&lt;/a&gt;&lt;a&gt;&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;
&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="VB.net">
      <Posts>
        <Post From="rctaubert" When="30/08/2012 18:19:27">
          <Html>
        
&lt;p&gt;Is there any possibility that sometime in the future you might supply the samples in vb.net as well?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="31/08/2012 07:49:47">
          <Html>
        
&lt;p&gt;No, It's just to much work to keep them both up to date for me, but there are several tools that converts between c# and VB.Net&amp;nbsp;(But i'm not sure about the quality of the code)...&lt;/p&gt;
&lt;p&gt;For example this one ... &lt;a href="http://www.developerfusion.com/tools/convert/csharp-to-vb/" rel="nofollow"&gt;
http://www.developerfusion.com/tools/convert/csharp-to-vb/&lt;/a&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="rctaubert" When="05/09/2012 14:43:13">
          <Html>
        
&lt;p&gt;Thank you for your reply.&amp;nbsp; First I should say thank you for the time and effort you have put into this.&amp;nbsp; This package is fantastic.&amp;nbsp; I often run into cases where I need to do simple reads and writes to an Excel sheet.&amp;nbsp; I have used various
 classes I have found on CodeProject for the vary basic and used Interop for everything else.&amp;nbsp; This code alleviates the need for any other code.&lt;/p&gt;
&lt;p&gt;It is too bad you don't have the time to produce both C# and VB.net samples.&amp;nbsp; There are a lot of VB.net programers out there.&amp;nbsp; I will have to try out your suggested converter and compare the results to the one I use.&lt;/p&gt;
&lt;p&gt;Acutally, I have a converter,&amp;nbsp;&lt;a title="http://tangiblesoftwaresolutions.com/Product_Details/Instant_VB.html" href="InstantVB" target="_blank" rel="nofollow"&gt;InstantVB&lt;/a&gt;, which I have been using for a couple of years.&amp;nbsp; It does a very good job and the developers
 are quick to respond to any anomalies found in the conversion; often in the same day.&lt;/p&gt;
&lt;p&gt;I ran your samples through the converter.&amp;nbsp; There were a few minor descrepancies I was able to fix quickly.&amp;nbsp; However, Samples 12 and 13 are beyond my experience to fix.&lt;/p&gt;
&lt;p&gt;On all the other samples I ran both your original C# code and the converted code,&amp;nbsp;then compared the spreadsheets.&amp;nbsp; I did not do a&amp;nbsp;line-by-line comparison but enough that I am confident they were identical.&lt;/p&gt;
&lt;p&gt;Again thank you.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Question around licensing.">
      <Posts>
        <Post From="Continuity" When="02/09/2012 22:37:20">
          <Html>
        
&lt;p&gt;Hi all,&lt;/p&gt;
&lt;p&gt;Firstly, this is an amzing lib, very very helpful and easy to use.&lt;/p&gt;
&lt;p&gt;My main question though, is as this is licensed under the lgpl, does this mean I am free to use the pre-compiled binary in a peice of sold propriorty web application.&lt;/p&gt;
&lt;p&gt;Reading around the licensence i have been unable to work out if this is possible, or if I need to purchase a license?&lt;/p&gt;
&lt;p&gt;So i thought i would ask here.&lt;/p&gt;
&lt;p&gt;Any ideas?&lt;/p&gt;
&lt;p&gt;Rgds&lt;/p&gt;
&lt;p&gt;Cont//&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="03/09/2012 03:25:48">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Yes, you are free to use in your proprietary web app. There is no need, and no option, to purchase a license.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;http://en.wikipedia.org/wiki/GNU_Lesser_General_Public_License&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Possibility to use in combination with standard HTML writing to Excel?">
      <Posts>
        <Post From="TanmaySoni" When="31/08/2012 13:48:21">
          <Html>
        
&lt;p&gt;We have implemented HTML based export to Excel already.&lt;/p&gt;
&lt;p&gt;Now - facing problem to have the image work offline [currently absolute image url is bound in exported html to excel].&lt;/p&gt;
&lt;p&gt;We see this is possible with EPPlus library - to embed image [which can work offline].&lt;/p&gt;
&lt;p&gt;However, this brings much of the development effort to switch our complete mechanism [export is based on much of business logic conditions, which even complicates cell based coding required per this library] to use EPPlus.&lt;/p&gt;
&lt;p&gt;Given above - we are trying to find out if it's possible to use EPPlus ONLY for image embeding in excel and then use the standard HTML mechanism to write further contents into excel export.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks in advance.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Cell type to numeric">
      <Posts>
        <Post From="ram4nd" When="22/08/2012 17:34:09">
          <Html>
        
&lt;p&gt;I have tried to make my cells numeric but I haven't been able to. My data comes from datagridview. I am out of ideas, so can you help me and tell me how can I set cells except first column and first row to numeric format, so excel would be able to calculate
 with the numbers.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;SaveFileDialog saveFileDialog1 = &lt;span style="color: blue;"&gt;new&lt;/span&gt; SaveFileDialog();
saveFileDialog1.Filter = &lt;span style="color: rgb(163, 21, 21);"&gt;"Microsoft Excel 2007 XML|*.xlsx"&lt;/span&gt;;
saveFileDialog1.Title = &lt;span style="color: rgb(163, 21, 21);"&gt;"Save an Excel File"&lt;/span&gt;;
saveFileDialog1.ShowDialog();

&lt;span style="color: blue;"&gt;if&lt;/span&gt; (saveFileDialog1.FileName != &lt;span style="color: rgb(163, 21, 21);"&gt;""&lt;/span&gt;)
{
	DataSet ds = &lt;span style="color: blue;"&gt;new&lt;/span&gt; DataSet();
	DataTable dt = &lt;span style="color: blue;"&gt;new&lt;/span&gt; DataTable();
	dt.TableName = &lt;span style="color: rgb(163, 21, 21);"&gt;"Prodcuts"&lt;/span&gt;;
	&lt;span style="color: blue;"&gt;foreach&lt;/span&gt; (DataGridViewColumn col &lt;span style="color: blue;"&gt;in&lt;/span&gt; csv_data.Columns)
	{
		dt.Columns.Add(col.HeaderText);
	}
	&lt;span style="color: blue;"&gt;foreach&lt;/span&gt; (DataGridViewRow gridRow &lt;span style="color: blue;"&gt;in&lt;/span&gt; csv_data.Rows)
	{
		&lt;span style="color: blue;"&gt;if&lt;/span&gt; (gridRow.IsNewRow)
			&lt;span style="color: blue;"&gt;continue&lt;/span&gt;;
		DataRow dtRow = dt.NewRow();
		&lt;span style="color: blue;"&gt;for&lt;/span&gt; (&lt;span style="color: blue;"&gt;int&lt;/span&gt; i1 = 0; i1 &amp;lt; csv_data.Columns.Count; i1++)
		{
			dtRow[i1] = (gridRow.Cells[i1].Value == &lt;span style="color: blue;"&gt;null&lt;/span&gt; ? DBNull.Value : gridRow.Cells[i1].Value);&lt;/pre&gt;
&lt;pre&gt;		}
		dt.Rows.Add(dtRow);
	}
	ds.Tables.Add(dt);

	&lt;span style="color: blue;"&gt;var&lt;/span&gt; newFile = &lt;span style="color: blue;"&gt;new&lt;/span&gt; FileInfo(saveFileDialog1.FileName);
	&lt;span style="color: blue;"&gt;if&lt;/span&gt; (newFile.Exists)
	{
		newFile.Delete();
	}

	&lt;span style="color: blue;"&gt;var&lt;/span&gt; table = dt;

	&lt;span style="color: blue;"&gt;using&lt;/span&gt; (&lt;span style="color: blue;"&gt;var&lt;/span&gt; package = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(newFile))
	{
		ExcelWorksheet worksheet = package.Workbook.Worksheets.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"Packages"&lt;/span&gt;);

		worksheet.Cells.LoadFromDataTable(table, &lt;span style="color: blue;"&gt;true&lt;/span&gt;);

		package.Save();
	}
}
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="31/08/2012 12:57:04">
          <Html>
        
&lt;p&gt;EPPlus will use the datatype of the object for the cell values, so make sure you add the datatable colums as numeric if they contains numeric data.&lt;/p&gt;
&lt;p&gt;In this case there is no need&amp;nbsp;to use&amp;nbsp;the datatable. Set the cell values directly instead.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="ram4nd" When="31/08/2012 13:14:41">
          <Html>
        
&lt;p&gt;I did it myself already. placed foreach before package.Save() and looped through cells and used try parse decimal.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Client profile">
      <Posts>
        <Post From="VahidN" When="28/08/2012 08:16:36">
          <Html>
        
&lt;p style="margin: 0in; color: black; font-family: Tahoma; font-size: 10pt;"&gt;Hello,&lt;/p&gt;
&lt;p style="margin: 0in; color: black; font-family: Tahoma; font-size: 10pt;"&gt;It seems there's a reference to System.Design.dll assembly in this library and it's not used any where.&lt;/p&gt;
&lt;p style="margin: 0in; color: black; font-family: Tahoma; font-size: 10pt;"&gt;By removing this dependency it will be possible to target .NET 3.5 client profile, instead of its full profile (which is in use right now).&lt;/p&gt;
&lt;p style="margin: 0in; color: black; font-family: Tahoma; font-size: 10pt;"&gt;&amp;nbsp;&lt;/p&gt;
&lt;p style="margin: 0in; color: black; font-family: Tahoma; font-size: 10pt;"&gt;Thanks!&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="31/08/2012 12:50:47">
          <Html>
        
&lt;p&gt;Yes, You are right. I'll remove the reference.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Second Axis properties overwrite first axis properties">
      <Posts>
        <Post From="chris33" When="31/08/2012 09:22:04">
          <Html>
        
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;Working with the code of the examples:&lt;/pre&gt;
&lt;pre&gt; &lt;/pre&gt;
&lt;pre&gt;chart = ws.Drawings.AddChart(&lt;span style="color: rgb(163, 21, 21);"&gt;"xy"&lt;/span&gt; &amp;amp; zCharts.ToString, Drawing.Chart.eChartType.XYScatterLinesNoMarkers)
chart.SetPosition(100, 100)
chartType2 = chart.PlotArea.ChartTypes.Add(Drawing.Chart.eChartType.XYScatterLinesNoMarkers)

chart.SetSize(800, 400)

chart.XAxis.MinValue = 0
chart.XAxis.MaxValue = 10
chart.YAxis.MinValue = 1
chart.YAxis.MaxValue = 10000
chart.XAxis.LogBase = &lt;span style="color: blue;"&gt;Nothing&lt;/span&gt;
chart.YAxis.LogBase = 10

chart.XAxis.CrossesAt = chart.YAxis.MinValue
chart.YAxis.CrossesAt = chart.XAxis.MinValue

chartType2.XAxis.MinValue = 0
chartType2.XAxis.MaxValue = 10
chartType2.YAxis.MinValue = -100
chartType2.YAxis.MaxValue = 100
chartType2.XAxis.LogBase = &lt;span style="color: blue;"&gt;Nothing&lt;/span&gt;
chartType2.YAxis.LogBase = &lt;span style="color: blue;"&gt;Nothing&lt;/span&gt;

chartType2.XAxis.CrossesAt = chartType2.YAxis.MinValue
chartType2.YAxis.CrossesAt = chartType2.XAxis.MinValue

&lt;span style="color: green;"&gt;'Add some series&lt;/span&gt;

chartType2.XAxis.Deleted = &lt;span style="color: blue;"&gt;False&lt;/span&gt;
chartType2.XAxis.TickLabelPosition = Drawing.Chart.eTickLabelPosition.High
&lt;/pre&gt;
&lt;pre&gt;&lt;hr&gt;&lt;/pre&gt;
&lt;pre&gt;Values of charts axis are now the values of the chartType2 axis. Why?&lt;/pre&gt;
&lt;pre&gt;The hidden XAxis is not shown, but the first horizontally is now on top.&lt;/pre&gt;
&lt;pre&gt;When I work with only one axis(chart), in Excel2010 changing one series yaxis property to secondary, its xaxis is also now secondary, but not displayed. You can change the xaxis log property and you can see that series on the primary yaxis are rescaled, series on the secondary yaxis not.&lt;/pre&gt;
&lt;pre&gt;That's a bug in Excel to not have displayed an axis where a series is calculated and displayed from.&lt;/pre&gt;
&lt;pre&gt;Can anybody help me?&lt;/pre&gt;
&lt;pre&gt;&amp;nbsp;&lt;/pre&gt;
&lt;pre&gt;Regards &lt;/pre&gt;
&lt;pre&gt;Chris&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Would like FormatPainter method to copy Styles/Colors/Formats from one range to another">
      <Posts>
        <Post From="gsbell" When="29/08/2012 21:13:27">
          <Html>
        
&lt;p&gt;I would like a built-in .FormatPainter method in EPPlus to copy styles/colors/formats/borders from one range to another.&amp;nbsp; Something like...&lt;/p&gt;
&lt;p&gt;pkg.Workbook.Worksheets(1).FormatPainter("A:1,B:5", "C:1,D:5")&lt;/p&gt;
&lt;p&gt;pkg.Workbook.Worksheets(1).FormatPainter("1:1", "2:50")&lt;/p&gt;
&lt;p&gt;Or does someone already have a function to do this?&lt;/p&gt;
&lt;p&gt;Thanks,&lt;br&gt;
Gordon&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="gsbell" When="30/08/2012 18:13:07">
          <Html>
        
&lt;p&gt;Well for copying rows, I'm now using &lt;strong&gt;.InsertRows(startRow, numberOfRows, copyFormatFromRow)&lt;br&gt;
&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;The only problem is it doesn't adjust the Row Height of inserted rows to match
&lt;strong&gt;copyFormatFromRow&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;br&gt;
&lt;/strong&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="31/08/2012 07:10:17">
          <Html>
        
&lt;p&gt;I guess we could add that later on, but for now you can copy the StyleID property to the range you want to format.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="#VALUE! Error when manually tryinng to add a cell with numeric value and a empty cell">
      <Posts>
        <Post From="webfriend13" When="28/08/2012 06:53:13">
          <Html>
        
&lt;p&gt;HI All,&lt;/p&gt;
&lt;p&gt;I generated a excel file using EPPlus library. Now I am trying to manually add some of the cells by using follwing method.&lt;/p&gt;
&lt;p&gt;=H23 + H24 (where h23 value is 233 and h24 is blank)&lt;/p&gt;
&lt;p&gt;I get ﻿#VALUE! error. If I evaluate the expression it says 233 + "". The value of H24 cell is considered as "" instead of treating it as null.&lt;/p&gt;
&lt;p&gt;What should i do to resolve this issue.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="28/08/2012 14:42:49">
          <Html>
        
&lt;p&gt;I have tried to reproduce the issue but with no luck. Did I do anything wrong ?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;            FileInfo  arq = &lt;span style="color: blue;"&gt;new&lt;/span&gt; FileInfo(&lt;span style="color: rgb(163, 21, 21);"&gt;@"c:\file.xlsx"&lt;/span&gt;);

            &lt;span style="color: blue;"&gt;using&lt;/span&gt; (ExcelPackage p = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(arq))
            {

                &lt;span style="color: blue;"&gt;var&lt;/span&gt; w = p.Workbook.Worksheets.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"sheet"&lt;/span&gt;);

                w.Cells[1, 1].Value= 2;                
                w.Cells[1, 3].Formula = &lt;span style="color: rgb(163, 21, 21);"&gt;"SUM(A1+B1)"&lt;/span&gt;;
                
                p.Save();
            }
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="webfriend13" When="29/08/2012 04:05:03">
          <Html>
        
&lt;p&gt;HI Mrxrsd,&lt;/p&gt;
&lt;p&gt;Thank you for quick reply. I guess I was not able to explain the problem properly. This is what I am trying.&lt;/p&gt;
&lt;p&gt;I have generated an Excel file using EPPlus library. Some of the cells in the file are empty and some have numeric values. I open the file by double clicking on it (file is saved and I am opening it manually without the help of code).&lt;/p&gt;
&lt;p&gt;Now&amp;nbsp;if I try to add two&amp;nbsp;or more cells (where atleast&amp;nbsp;one cell is empty)&amp;nbsp;I get ﻿#VALUE! error.&lt;/p&gt;
&lt;p&gt;(=H1 + H2 + H3) where H2 is a blank cell. ﻿If I eveluate the expression it says 233 + "" + 20. If I apply sum() to add the cells I get the result back. But users of the application are use to using numeric operators. So I am hoping when I write a null or
 empty value in a cell, instead of storing it as "" it should be store as blank.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="29/08/2012 13:03:17">
          <Html>
        
&lt;p&gt;How do you load your cells? Are you using any helper method, like loadfromdatable, loadfromcollection,etc ? If you are using it, maybe will be necessary to add some check for empty values.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="webfriend13" When="30/08/2012 03:48:35">
          <Html>
        
&lt;p&gt;HI mrxrsd,&lt;/p&gt;
&lt;p&gt;Yes, I am using LoadFromDataTable helper method. Please let me know what sort of chech's I have to add.&lt;/p&gt;
&lt;p&gt;Thank you&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="30/08/2012 04:16:56">
          <Html>
        
&lt;p&gt;I am only guessing here, but try this in ExcelRangeBase.cs line 1547.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;			&lt;span style="color: blue;"&gt;foreach&lt;/span&gt; (DataRow dr &lt;span style="color: blue;"&gt;in&lt;/span&gt; Table.Rows)
			{
				&lt;span style="color: blue;"&gt;foreach&lt;/span&gt; (&lt;span style="color: blue;"&gt;object&lt;/span&gt; value &lt;span style="color: blue;"&gt;in&lt;/span&gt; dr.ItemArray)
				{
&lt;span style="white-space: pre;"&gt;					if ( value!=null &amp;amp;&amp;amp; value.ToString() != string.Empty &amp;nbsp;)&lt;/span&gt;
					_worksheet.Cell(row, col++).Value = value;
				}
				row++;
				col = _fromCol;
			}
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="webfriend13" When="30/08/2012 05:24:28">
          <Html>
        
&lt;p&gt;HI mrxrsd,&lt;/p&gt;
&lt;p&gt;Thank you quick reply. With this check, I am able to add empty cells with the ones which contains numeric values.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="What is the best way to set alignment of columns">
      <Posts>
        <Post From="webfriend13" When="28/08/2012 06:59:40">
          <Html>
        
&lt;p&gt;HI all,&lt;/p&gt;
&lt;p&gt;I am using following code to set alignment of the columns.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;for&lt;/span&gt; (&lt;span style="color: blue;"&gt;int&lt;/span&gt; index = 0; index &amp;lt;= noOfColumns; index++)
                    {
                        worksheet.Column(index).Style.HorizontalAlignment = ExcelHorizontalAlignment.Right;

                         worksheet.Column(index).Style.Numberformat.Format = &lt;span style="color: rgb(163, 21, 21);"&gt;@"#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;_);[Red]\(#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;\)"&lt;/span&gt;;
                    }
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;While it works great when i have 20 odd columns but it takes massive time when i have more than 30 columns. Do we have any faster way of setting alignment and formatting for columns?&lt;/p&gt;
&lt;p&gt;Please provide your suggestions&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="gsbell" When="29/08/2012 21:29:03">
          <Html>
        
&lt;p&gt;You can set multiple columns at once using:&lt;/p&gt;
&lt;p&gt;worksheet.Cells("A:Z").Style.HorizontalAlignment = Style.ExcelHorizontalAlignment.Right&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Writing data in excel in batch's">
      <Posts>
        <Post From="webfriend13" When="29/08/2012 07:30:33">
          <Html>
        
&lt;p&gt;Hi All,&lt;/p&gt;
&lt;p&gt;Is it possible to write data in excel in multiple batch's. Currently after writing 8 million cells into excel, I am getting memoery exception. I am thinking of writing first 4 million cells into excel and then save the file and then write the remaining cells
 in batch of 4 million cells.&lt;/p&gt;
&lt;p&gt;Is it even possible? If not, do we have any work arounds?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="29/08/2012 12:06:02">
          <Html>
        
&lt;p&gt;Yes and No. Yes, you can open an existing excel file, but when you loaded, it will copy entirely to memory.&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="shape.Fill.Color does not work in sample6">
      <Posts>
        <Post From="yonghan" When="27/08/2012 14:16:25">
          <Html>
        
&lt;p&gt;shape.Fill.Color always&amp;nbsp;Color.DarkSlateGray.&lt;/p&gt;
&lt;p&gt;1) How to change shape fill color?&lt;/p&gt;
&lt;p&gt;2) Is it possible set&amp;nbsp;shape.Border.Width to 1/4?&lt;/p&gt;
&lt;p&gt;3) ExcelParagraph.Color does not work. always White.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;pre&gt;            //Add the textbox
            var shape = ws.Drawings.AddShape("txtDesc", eShapeStyle.Rect);
            shape.SetPosition(0, 5, 5, 5);
            shape.SetSize(400, 200);

            //shape.Text = "This example demonstrates how to create various drawing objects like Pictures, Shapes and charts.\n\r\n\rThe first sheet...";
            shape.Fill.Style = eFillStyle.SolidFill;
            &lt;strong&gt;shape.Fill.Color = Color.Magenta&lt;/strong&gt;;
            shape.Fill.Transparancy = 20;
            shape.Border.Fill.Style = eFillStyle.SolidFill;
            shape.Border.LineStyle = eLineStyle.LongDash;
            &lt;strong&gt;shape.Border.Width = 1;&lt;/strong&gt;
            shape.Border.Fill.Color = Color.Black;
            shape.Border.LineCap = eLineCap.Round;
            shape.TextAnchoring = eTextAnchoringType.Top;
            shape.TextVertical = eTextVerticalType.Horizontal;
            shape.TextAnchoringControl=false;&lt;/pre&gt;
&lt;pre&gt;&lt;br&gt;&lt;/pre&gt;
&lt;pre&gt;            var rt = shape.RichText.Add("example");&lt;/pre&gt;
&lt;pre&gt;            &lt;strong&gt;rt.Color =&amp;nbsp;Color.Yellow;&lt;/strong&gt;&lt;/pre&gt;
&lt;pre&gt;            rt.Bold = true;&lt;/pre&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;thanks&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="yonghan" When="28/08/2012 01:14:11">
          <Html>
        
&lt;p&gt;never mind, it solved my self.&lt;/p&gt;
&lt;p&gt;the problem is ExcelDrawingFill.Transparency property setter.&lt;/p&gt;
&lt;p&gt;while set transparancy value Color make to Default Color.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;ExcelDrawingFill.cs&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;pre&gt;        /// Transparancy in percent
        /// 
        public int Transparancy
        {
            get
            {
                return 100 - (GetXmlNodeInt(_fillPath + alphaPath) / 1000);
            }
            set
            {
                if (_fillTypeNode == null)
                {
                    _style = eFillStyle.SolidFill;
                    &lt;span style="color: rgb(0, 128, 128);"&gt;//Color = Color.FromArgb(79, 129, 189);   //Set a Default color   &lt;span style="color: rgb(255, 0, 0);"&gt;&amp;lt;== this line is the problem&lt;/span&gt;&lt;/span&gt;
                    &lt;span style="color: rgb(0, 0, 255);"&gt;this.Color.GetHashCode(); // dummy for insure instance. MY CODE&lt;/span&gt;
                }
                else if (_style != eFillStyle.SolidFill)
                {
                    throw new Exception("FillStyle must be set to SolidFill");
                }
                //CreateNode(_fillPath, false);
                SetXmlNodeString(_fillPath + alphaPath, ((100 - value) * 1000).ToString());
            }
        }&lt;/pre&gt;
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="yonghan" When="28/08/2012 03:36:55">
          <Html>
        
&lt;p&gt;ExcelDrawingBorder.Width should be double!&lt;/p&gt;
&lt;p&gt;integer with can't set 1/4.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;        &lt;span style="color: gray;"&gt;///&lt;/span&gt; &lt;span style="color: gray;"&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt;&lt;span style="color: green;"&gt; Width in pixels&lt;/span&gt;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt; &lt;span style="color: gray;"&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;double&lt;/span&gt; Width
        {
            &lt;span style="color: blue;"&gt;get&lt;/span&gt;
            {
                &lt;span style="color: blue;"&gt;var&lt;/span&gt; lw = GetXmlNodeDoubleNull(_lineWidth);
                &lt;span style="color: blue;"&gt;return&lt;/span&gt; lw.HasValue ? lw.Value / 12700 : 1;
            }
            &lt;span style="color: blue;"&gt;set&lt;/span&gt;
            {
                SetXmlNodeString(_lineWidth, (value * 12700).ToString());
            }
        }
        &lt;span style="color: blue;"&gt;#endregion&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="(SOLVED) Cell formula issue: Sumproduct">
      <Posts>
        <Post From="arnoldus" When="26/08/2012 14:12:04">
          <Html>
        
&lt;p&gt;&lt;span style="color: rgb(192, 192, 192);"&gt;When I enter the following formula as a formula, the workbook opens up with an error that the&amp;nbsp;document has unreadable content, it&amp;nbsp;has been recovered with some cells missing. When I look in the Excel error log, it just
 mentions unreadable cells removed.&lt;/span&gt;&lt;br&gt;
&lt;span style="color: rgb(192, 192, 192);"&gt;If I enter it as a Value, and manually hit enter, it works with no issues.&lt;/span&gt;&lt;br&gt;
&lt;span style="color: rgb(192, 192, 192);"&gt;(in Powershell)&lt;/span&gt;&lt;br&gt;
&lt;span style="color: rgb(192, 192, 192);"&gt;Am I doing something wrong? Can I circumvent this?&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;span style="color: rgb(0, 0, 0);"&gt;SOLVED&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(192, 192, 192);"&gt;&lt;strong&gt;$ws.Cells.item(($r),13).Formula = "Sumproduct($Jan_I;$Jan_M)/Sum($Jan_I)" #errors&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(192, 192, 192);"&gt;&lt;strong&gt;&lt;br&gt;
$ws.Cells.item(($r),13).Value = "=Sumproduct($Jan_I;$Jan_M)/Sum($Jan_I)" #comes up as text,&amp;nbsp;I hit enter manually, and it works.&lt;br&gt;
&lt;br&gt;
&lt;/strong&gt;I will try this tip to see if the formula somehow changes:&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(192, 192, 192);"&gt;&lt;em&gt;The easiest way to check a format or a formula is to create an Excel file --&amp;gt; Do the formatting / Add the formulas --&amp;gt; Save it as XLSX ---&amp;gt; Rename the file *.zip. Extract the file and have a look at the number formats
 in the \xl\styles.xml file and formulas in \xl\worksheets\sheet#.xml.&lt;/em&gt;&lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title=".NET error when a range name contains _ underscore">
      <Posts>
        <Post From="arnoldus" When="25/08/2012 19:39:42">
          <Html>
        
&lt;p&gt;When I do following (with several variations of the string)&lt;/p&gt;
&lt;p&gt;$worksheet.Names.Add("Janus_ABC",$KolB) | out-null&lt;/p&gt;
&lt;p&gt;I always get a "&lt;strong&gt;Exception calling "Add" with "2" argument(s): "An item with the same key has already been added."&lt;/strong&gt;"&lt;/p&gt;
&lt;p&gt;This only happens when the _ is in the name string. This is a legal character in Excel.&lt;br&gt;
Is this a bug or am I overlooking something?&lt;br&gt;
&amp;nbsp;I do not have anything named similarly in my script.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Powershell: FillStyle &amp;amp; colour">
      <Posts>
        <Post From="arnoldus" When="20/08/2012 16:23:46">
          <Html>
        
&lt;p&gt;I'm having a little difficulty with following statements in Powershell (inputting data, merging and font formatting until here have worked just fine), I wonder if someone could point to me what is going wrongly? Should the statement be declared more expressively?&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;$WorkSheet.Cells.item("A2:S4").Style.Fill.PatternType = &lt;span style="text-decoration: underline;"&gt;
ExcelFillStyle.Solid&lt;/span&gt;&lt;/strong&gt;&lt;br&gt;
&lt;strong&gt;$WorkSheet.Cells.item("A2:S4").Style.Fill.BackgroundColor.SetColor(&lt;span style="text-decoration: underline;"&gt;Color.Red&lt;/span&gt;)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;- The fillstyle gives this error:&lt;/p&gt;
&lt;p&gt;The term 'ExcelFillStyle.Solid' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the spelling of the name, or if a path was included, verify that the path is correct and try again.&lt;br&gt;
&lt;br&gt;
+ $WorkSheet.Cells.item("A2:S4").Style.Fill.PatternType = ExcelFillStyle.Solid &amp;lt;&amp;lt;&amp;lt;&amp;lt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; + CategoryInfo&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; : ObjectNotFound: (ExcelFillStyle.Solid:String) [], CommandNotFoundException&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; + FullyQualifiedErrorId : CommandNotFoundException&lt;/p&gt;
&lt;p&gt;- The Color.Red: &lt;br&gt;
Missing ')' in method call.&lt;br&gt;
&lt;br&gt;
+ $WorkSheet.Cells.item("A2:S4").Style.Fill.BackgroundColor.SetColor( &amp;lt;&amp;lt;&amp;lt;&amp;lt; Color.Red)&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; + CategoryInfo&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; : ParserError: (CloseParenToken:TokenId) [], ParentContainsErrorRecordException&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; + FullyQualifiedErrorId : MissingEndParenthesisInMethodCall&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="arnoldus" When="25/08/2012 11:34:38">
          <Html>
        
&lt;p&gt;The easy way to do this is to read the epplus.dll with .NET reflector and understand what goes on in the structures.&lt;br&gt;
With that knowledge, the solution is as follows:&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;$WorkSheet.Cells.item("A2:S4").Style.Fill.PatternType = "Solid" # or you could just write "=1"&lt;br&gt;
&lt;strong&gt;$WorkSheet.Cells.item("A2:S4").Style.Fill.BackgroundColor.SetColor("Red")&lt;/strong&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="read of big files">
      <Posts>
        <Post From="igor_menshikov" When="24/08/2012 09:21:00">
          <Html>
        
&lt;p&gt;When I open a big XLSX file with about 40000 records (in 4&amp;nbsp;Worksheets) I takes about 40 seconds to load.&lt;/p&gt;
&lt;p&gt;Is there a way to speed up that?&lt;/p&gt;
&lt;p&gt;Best regards,&lt;/p&gt;
&lt;p&gt;Igor&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Format cells as Text with Apostrophe">
      <Posts>
        <Post From="reyx" When="22/08/2012 19:57:17">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I must set the cells with the apostrophe to escape numbers and formulas, i know that simply giving a string to the Value property is done, but in a specific&amp;nbsp;case I need to add this character to be recognized in an legacy program.&lt;/p&gt;
&lt;p&gt;Is that possible?&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Creating a named range and add cells to it.">
      <Posts>
        <Post From="RutgerKappers" When="22/08/2012 15:30:06">
          <Html>
        
&lt;p&gt;Hello everyone,&lt;/p&gt;
&lt;p&gt;I dont know if this is possible or not and I couldnt find anything on google.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I want to create a defined name say "Evidence"&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;My excell sheet layout is like this:&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Section
&lt;ul&gt;
&lt;li&gt;question1 &lt;/li&gt;&lt;li&gt;question2 &lt;/li&gt;&lt;li&gt;question3 &lt;/li&gt;&lt;/ul&gt;
&lt;/li&gt;&lt;li&gt;section2
&lt;ul&gt;
&lt;li&gt;question4 &lt;/li&gt;&lt;li&gt;question5 &lt;/li&gt;&lt;li&gt;question6 &lt;/li&gt;&lt;/ul&gt;
&lt;/li&gt;&lt;/ul&gt;
&lt;p&gt;And so on.&lt;/p&gt;
&lt;p&gt;However I want to add all the question cells per row to the defined Name "Evidence", is it possible to skip cells in named ranges? Thank you for your help.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;EDIT:&lt;/p&gt;
&lt;p&gt;Maybe it is possible to do something like&lt;/p&gt;
&lt;p&gt;where evidence is a list of string address'?&lt;/p&gt;
&lt;p&gt;ExcelRange evidenceRange = ws.Cells[string.Join(", ", evidence)];&lt;/p&gt;
&lt;p&gt;Example output: ExcelRange evidenceRange =&amp;nbsp;ws.cells["D1, D2, D3, D7, D9"]&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Close package">
      <Posts>
        <Post From="jordaajo" When="20/08/2012 13:13:34">
          <Html>
        
&lt;p&gt;How do I close a package? I want to close the whole Excel spreadsheet that was opened by EPPlus.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="swmal" When="20/08/2012 23:41:11">
          <Html>
        
&lt;p&gt;The ExcelPackage class implements IDisposable, so either you can&amp;nbsp;declare your package inside a using-statement or you can call the Dispose() method explicitly when you are done. I would recommend using-statement since it will make sure Dispose is called
 even if an exception occurs.&lt;/p&gt;
&lt;p&gt;/Mats&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jordaajo" When="22/08/2012 08:06:29">
          <Html>
        
&lt;p&gt;Yes, thanks for that - my mistake. I looked at my code ( I wrote a wrapper class to implement EPPlus) and realized that I used a shell command to show Excel. So it cannot be closed from EPPlus. Once Excel has opened the file, you must manually close it.
 The alternative is not to show it but to leave it up to the user to open and close.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Cannot add part for the specified URI because it is already in the package.">
      <Posts>
        <Post From="kttee" When="22/08/2012 07:20:02">
          <Html>
        
&lt;p&gt;﻿﻿I got error in this line:&lt;/p&gt;
&lt;p&gt;﻿&lt;/p&gt;
&lt;pre&gt;var chart = xlSheets.Drawings.AddChart(dataSet.DataSetName, OfficeOpenXml.Drawing.Chart.eChartType.ColumnClustered);&lt;/pre&gt;
&lt;pre&gt;I am creating multiple sheets.&lt;/pre&gt;
&lt;pre&gt;Any idea how to fix this?&lt;/pre&gt;

        
    </Html>
        </Post>
        <Post From="kttee" When="22/08/2012 07:40:02">
          <Html>
        
&lt;p&gt;Error: Cannot add part for the specified URI because it is already in the package ﻿﻿&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Axis Name">
      <Posts>
        <Post From="kttee" When="22/08/2012 01:38:12">
          <Html>
        
&lt;p&gt;How to set the X-axis and Y-axis name?&lt;br&gt;
I can't find it.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Percent Format">
      <Posts>
        <Post From="kttee" When="21/08/2012 06:59:28">
          <Html>
        
&lt;p&gt;May I know how can I convert a decimal (eg: 33.33) to percent format.&lt;br&gt;
I have tried with this code:&lt;/p&gt;
&lt;p&gt;﻿﻿ws.Cells[1,1].Value = 0.3333;&lt;br&gt;
ws.Cells[1.1].Style.Numberformat.Format = "0%";&lt;/p&gt;
&lt;p&gt;But this give me 33% instead of 33.33%&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="21/08/2012 15:03:35">
          <Html>
        
&lt;p&gt;Try this...&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;ws.Cells[1, 1].Style.Numberformat.Format = &lt;span style="color: rgb(163, 21, 21);"&gt;"0.00%"&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="kttee" When="22/08/2012 01:34:37">
          <Html>
        
&lt;p&gt;Thanks so much!! It works just fine :)&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Getting End of Rows">
      <Posts>
        <Post From="suek" When="19/08/2012 11:05:20">
          <Html>
        
&lt;table&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;
&lt;div&gt;&lt;a title="This question shows research effort; it is useful and clear (click again to undo)"&gt;&lt;/a&gt;
&lt;div&gt;&lt;strong&gt;&amp;nbsp;&lt;/strong&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;div&gt;
&lt;div&gt;
&lt;p&gt;I use EPPlus to read a worksheet. In this worksheet, the data I need is in columns B-D. In column A there are static values, that I would ignore. The values in col A are filled in till Row 1000. But, the data I need will be there only till, say for example
 Row 450. Currently I use&lt;br&gt;
&lt;strong&gt;int endRow = workSheet.Dimension.End.Row;&lt;/strong&gt; to calculalate the last row to read, but that returns me a value of 1000. Is there a way for me to get the value of endRow to be 450, ignoring col A.&lt;/p&gt;
&lt;p&gt;TIA Sue.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="21/08/2012 15:10:28">
          <Html>
        
&lt;p&gt;worksheet.Dimesion.End will always return&amp;nbsp;&lt;span&gt;the bottom right cell, but you can use a linq query. Take a look at Sample8&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;a href="http://epplus.codeplex.com/SourceControl/changeset/view/90aa5cee8750#SampleApp%2fSample8.cs" rel="nofollow"&gt;http://epplus.codeplex.com/SourceControl/changeset/view/90aa5cee8750#SampleApp%2fSample8.cs&lt;/a&gt;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Read hyperlinks values">
      <Posts>
        <Post From="yschwab" When="21/08/2012 14:49:06">
          <Html>
        
&lt;p&gt;We need to read hyperlinks values from Excel file.&lt;/p&gt;
&lt;p&gt;Sample code :&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;using&lt;/span&gt; (ExcelPackage pack = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(fileInfo))
{
    ExcelWorksheet ws = pack.Workbook.Worksheets[&lt;span style="color: rgb(163, 21, 21);"&gt;"X1"&lt;/span&gt;];
    &lt;span style="color: blue;"&gt;for&lt;/span&gt; (&lt;span style="color: blue;"&gt;int&lt;/span&gt; row = 2; row &amp;lt;= 10; row++)
    {
        ExcelRange cell = ws.Cells[row, 2];
        &lt;span style="color: blue;"&gt;if&lt;/span&gt; (cell.Hyperlink != &lt;span style="color: blue;"&gt;null&lt;/span&gt;)
        {
            &lt;span style="color: blue;"&gt;string&lt;/span&gt; link = cell.Hyperlink.OriginalString;
        }
    }
}

&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;If all rows have the same value / hyperlink, then from the 3rd row, the hyperlink is null !&lt;br&gt;
If the hyperlinks have different values, then it's ok !&lt;/p&gt;
&lt;p&gt;Sample file : &lt;a href="http://91.121.165.66/public/download/test1.zip" rel="nofollow"&gt;http://91.121.165.66/public/download/test1.zip&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="(Question) How Can I Add WorkSheets(At least 60 worksheets) in One Xlsx File?">
      <Posts>
        <Post From="jgpark" When="20/08/2012 07:36:29">
          <Html>
        
&lt;p&gt;Hi All.&lt;/p&gt;
&lt;p&gt;First, I can't Speak Eng Well. Sorry about that.&lt;/p&gt;
&lt;p&gt;I have a Problem about making xlsx file.&lt;/p&gt;
&lt;p&gt;I tried to add&amp;nbsp; worksheets(at least 60 worksheets)&amp;nbsp;in one xlsx file.&lt;/p&gt;
&lt;p&gt;(each worksheets has some images (about under 20 images. not big size)&amp;nbsp;and text)&lt;/p&gt;
&lt;p&gt;but, over 20 Worksheets add in one xlsx file, OutOfMemory error occured.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;My Saving Process is :&lt;/p&gt;
&lt;p&gt;1. new excelpackage,&lt;/p&gt;
&lt;p&gt;2. add worksheet and write it (add images and text)&lt;/p&gt;
&lt;p&gt;3. repeat 2.&lt;/p&gt;
&lt;p&gt;4. save excelPackage.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;when about 20th worksheet added, OutOfMemory occured.&lt;/p&gt;
&lt;p&gt;system using over 1GB memory. (32bit OS and Program.)&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Does EPPlus Can do this? :&lt;/p&gt;
&lt;p&gt;1. Open One xlsx file. &amp;nbsp;&lt;/p&gt;
&lt;p&gt;2. Read xlsx Header Info and Read First worksheet Only&lt;/p&gt;
&lt;p&gt;3. just Add a worksheet and write some text and Images&lt;/p&gt;
&lt;p&gt;4. Add Texts (Hyper Link) in First Worksheet&lt;/p&gt;
&lt;p&gt;5. Save it&lt;/p&gt;
&lt;p&gt;6. repeat 1 to&amp;nbsp;5&lt;/p&gt;
&lt;p&gt;or Can anyone solve this problem?(Using Less Memory..about Saving Many Worksheets in&amp;nbsp; one xlsx File)&amp;nbsp;plz&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="check for empty cell">
      <Posts>
        <Post From="suek" When="15/08/2012 02:22:25">
          <Html>
        
&lt;p&gt;Hello&lt;/p&gt;
&lt;p&gt;When I read a cell by doing Worksheets.Cells[2,5].value.ToString(), I get a error "System.NullReferenceException: Object reference not set to an instance of an object."&lt;/p&gt;
&lt;p&gt;What would be a good way to check for null and then assign the value, without have to have a "if" statement.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="17/08/2012 13:52:50">
          <Html>
        
&lt;p&gt;Hum, to get a clean code maybe you can use an extension method. Something like this:&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;static&lt;/span&gt; &lt;span style="color: blue;"&gt;object&lt;/span&gt; TryValue&amp;lt;T&amp;gt;(&lt;span style="color: blue;"&gt;this&lt;/span&gt; ExcelRange source)
        {

            &lt;span style="color: blue;"&gt;if&lt;/span&gt; (source.Value != &lt;span style="color: blue;"&gt;null&lt;/span&gt;)
            {
                &lt;span style="color: blue;"&gt;return&lt;/span&gt; (T)source.Value;
            }

            &lt;span style="color: blue;"&gt;return&lt;/span&gt; &lt;span style="color: blue;"&gt;null&lt;/span&gt;;
        }

        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;static&lt;/span&gt; &lt;span style="color: blue;"&gt;object&lt;/span&gt; TryValueString(&lt;span style="color: blue;"&gt;this&lt;/span&gt; ExcelRange source)
        {

            &lt;span style="color: blue;"&gt;if&lt;/span&gt; (source.Value != &lt;span style="color: blue;"&gt;null&lt;/span&gt;)
            {
                &lt;span style="color: blue;"&gt;return&lt;/span&gt; source.Value.ToString();
            }

            &lt;span style="color: blue;"&gt;return&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt;.empty;
        }
&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="suek" When="19/08/2012 11:08:22">
          <Html>
        
&lt;blockquote style="margin: 0.25em 1em 0px; padding: 0px 0.25em; border: 0.1em solid rgb(204, 204, 204); border-image: none; font-style: italic;"&gt;
&lt;strong&gt;suek wrote:&lt;/strong&gt;&lt;br&gt;
&lt;p&gt;Hello&lt;/p&gt;
&lt;p&gt;When I read a cell by doing Worksheets.Cells[2,5].value.ToString(), I get a error "System.NullReferenceException: Object reference not set to an instance of an object."&lt;/p&gt;
&lt;p&gt;What would be a good way to check for null and then assign the value, without have to have a "if" statement.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;br&gt;
This is how I solved it:&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;font face="Consolas" size="2"&gt;&lt;/font&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;font face="Consolas" size="2"&gt;
&lt;p&gt;string variableA&amp;nbsp;= workSheet.Cells[30, 4].Value ==&lt;/p&gt;
&lt;/font&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;null&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;
 ? &lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;string&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;
&lt;span style="font-family: Consolas; font-size: x-small;"&gt;.Empty : workSheet.Cells[30, 4].Value.ToString();&lt;font face="Consolas" size="2"&gt;
&lt;/font&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;font face="Consolas" size="2"&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;decimal variableB&amp;nbsp;= workSheet.Cells[30, endColumn].Value ==&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;/font&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;null&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;
 ? 0 : &lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Consolas; font-size: x-small;"&gt;Decimal&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;
&lt;span style="font-family: Consolas; font-size: x-small;"&gt;.Parse(workSheet.Cells[30, endColumn].Value.ToString());&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="&quot;Access denied&quot; when saving an ExcelPackage created from a FileInfo object">
      <Posts>
        <Post From="jGreg311" When="14/08/2012 23:13:20">
          <Html>
        
&lt;p&gt;I create an ExcelPackage by specifying a FileInfo object to a spreadsheet that exists in my user's temporary folder (C:\users\&amp;lt;username&amp;gt;\AppData\Local\Temp on Win7), make changes to the spreadsheet, and call ExcelPackage.Save(). &amp;nbsp;The Save() call
 throws an InvalidOperationException, with an inner exception saying "Error overwriting file", with an inner UnauthorizedAccessException, "Access to path '...' is denied".&lt;/p&gt;
&lt;p&gt;The same user and application created the file we're trying to edit with ExcelPackage, so the permission should not be an issue.&lt;/p&gt;
&lt;p&gt;The same end result occurs if I create a Read/Write FileStream for the existing file and specify that in the ExcelPackage constructor.&lt;/p&gt;
&lt;p&gt;The big picture of what I'm trying to do is to create a new spreadsheet based on a template (embedded as a resource), modify its contents, and save it. &amp;nbsp;The only way I've gotten this to work is to provide ExcelPackage's constructor with both a Stream
 to the embedded resource and a FileStream (OpenOrCreate, Read/Write) for the output file. &amp;nbsp;This is much less convenient because not only do I now have to worry about an open stream, an open file handle, and an ExcelPackage, all of which need to be disposed
 of properly, but I also cannot edit a template if it already exists.&lt;/p&gt;
&lt;p&gt;Why doesn't specifying a FileInfo object work?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jgreg311" When="16/08/2012 15:00:09">
          <Html>
        
&lt;p&gt;I found the issue, and the issue was mine.&lt;/p&gt;
&lt;p&gt;Let me explain what I was doing, because it may help someone else that is migrating code from using traditional COM Microsoft Excel objects to using EPPlus.&lt;br&gt;
Before migrating to EPPlus, what I was doing was creating a copy of a spreadsheet, that is an embedded resource, in the user's temp folder. &amp;nbsp;The key (problem) was that I was also setting the file attribute ReadOnly. &amp;nbsp;I would then modify the contents
 of that spreadsheet in code (adding data to it) and "open" it in Excel (by using the old "worksheet.Application.Visible = true" method) to display the data to the user.&lt;/p&gt;
&lt;p&gt;The reason I set the file to ReadOnly was so that when Excel opened, it would have the data (modifications), but the user wouldn't be able to save the file, requiring them to "SaveAs" (the user would be prompted to SaveAs when closing Excel) and pick a location
 for the file.&lt;br&gt;
This allowed me to run the "report" and show it to the user without 1) requiring the user to take the extra step to save it if they were only interested in viewing it and discarding it and 2) without having to save the modifications to disk (in the user's temp
 folder) if it's not going to be kept. &amp;nbsp;It sounds like a lot of unnecessary steps, but it really did result in a much cleaner experience for the user, especially if they were only interested in viewing the data real quick, without having to spend time
 browsing to a location in which to save it.&lt;/p&gt;
&lt;p&gt;So, of course, when I migrated the code to use EPPlus, I was still setting the ReadOnly file attribute, causing it to bomb when it tired to "overwrite" (delete) the file.&lt;/p&gt;
&lt;p&gt;Coming from using the COM objects, I also wasn't cognizant of the fact that EPPlus *has to* work differently. &amp;nbsp;It doesn't keep an open file handle, and writing modifications as they're made (like how you may be used to if coming from using the COM objects),
 but it reads the entire file contents into memory, makes modifications in memory, and then writes it all back to disk (hence the delete when doing a Save).&lt;/p&gt;
&lt;p&gt;If anyone has any comments or would like to discuss this further, be my guest, but for those who are actively working on EPPlus, please consider this a non-issue/resolved.&lt;/p&gt;
&lt;p&gt;Thanks!&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Problems reading XLSX files generated by DevExpress ASPXGridView control">
      <Posts>
        <Post From="htbrady" When="15/08/2012 17:06:42">
          <Html>
        
&lt;p&gt;I am using the DevExpress suite of controls and they have a very nice grid control. &amp;nbsp;It has the ability to render it's contents to an XLSX file. &amp;nbsp;This is very handy when a user has filtered there data down to whatever level they choose as the export
 just handles what is currently in the grid. &amp;nbsp;The problem though is when I try to access the worksheet within the file. &amp;nbsp;It throws an error with the latest version and the latest beta version of EPPlus. &amp;nbsp;&lt;/p&gt;
&lt;p&gt;The code I am using to access the file is code I have been using for months with much success so I'm sure it's something to do with how the file is rendered. &amp;nbsp;I can upload a file if need be but was hoping maybe someone else had ran into this problem?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks!&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Save in XLS ? (Excel 2003)">
      <Posts>
        <Post From="nicopulse" When="11/04/2011 09:41:03">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;&lt;span title="Cliquer ici pour voir d'autres traductions"&gt;Is&lt;/span&gt;&amp;nbsp;&lt;span title="Cliquer ici pour voir d'autres traductions"&gt;it&lt;/span&gt;&amp;nbsp;&lt;span title="Cliquer ici pour voir d'autres traductions"&gt;possible to&lt;/span&gt;&amp;nbsp;&lt;span title="Cliquer ici pour voir d'autres traductions"&gt;save&lt;/span&gt;&amp;nbsp;&lt;span title="Cliquer ici pour voir d'autres traductions"&gt;in&lt;/span&gt;&amp;nbsp;&lt;span title="Cliquer ici pour voir d'autres traductions"&gt;XLS&lt;/span&gt;&lt;span title="Cliquer ici pour voir d'autres traductions"&gt;?&lt;/span&gt;&lt;br&gt;
&lt;br&gt;
&lt;span title="Cliquer ici pour voir d'autres traductions"&gt;Thank you&lt;/span&gt;&amp;nbsp;&lt;span title="Cliquer ici pour voir d'autres traductions"&gt;for your&lt;/span&gt;&amp;nbsp;&lt;span title="Cliquer ici pour voir d'autres traductions"&gt;advice&lt;/span&gt;&lt;span title="Cliquer ici pour voir d'autres traductions"&gt;.&lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="11/04/2011 11:19:59">
          <Html>
        
&lt;p&gt;No, only XLSX, but you can&amp;nbsp;open it&amp;nbsp;in Excel 2003 if you have the compatibility pack installed.&lt;/p&gt;
&lt;p&gt;If you&amp;nbsp;need XLS, have a look at the NPOI project here on Codeplex.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="nicopulse" When="11/04/2011 13:44:35">
          <Html>
        
&lt;p&gt;&lt;span title="Cliquer ici pour voir d'autres traductions"&gt;ok, thank's but I&lt;/span&gt;&amp;nbsp;&lt;span title="Cliquer ici pour voir d'autres traductions"&gt;desperately&lt;/span&gt;&amp;nbsp;&lt;span title="Cliquer ici pour voir d'autres traductions"&gt;search&lt;/span&gt;&amp;nbsp;&lt;span title="Cliquer ici pour voir d'autres traductions"&gt;program&lt;/span&gt;&amp;nbsp;&lt;span title="Cliquer ici pour voir d'autres traductions"&gt;that
 can&lt;/span&gt;&amp;nbsp;&lt;span title="Cliquer ici pour voir d'autres traductions"&gt;read&lt;/span&gt;&amp;nbsp;and&amp;nbsp;&lt;span title="Cliquer ici pour voir d'autres traductions"&gt;write&lt;/span&gt;&amp;nbsp;&lt;span title="Cliquer ici pour voir d'autres traductions"&gt;both&lt;/span&gt;&amp;nbsp;&lt;span title="Cliquer ici pour voir d'autres traductions"&gt;formats
 : XLS &amp;amp; XLSX...&lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jtpatil" When="11/04/2011 16:40:02">
          <Html>
        
&lt;p&gt;You can save to XLS: example code that I'm using:&lt;/p&gt;
&lt;div&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;ExcelPackage pck = new ExcelPackage();&lt;br&gt;
ExcelWorksheet ws = pck.Workbook.Worksheets.Add("Demo");&lt;br&gt;
ws.Cells["A1"].LoadFromDataTable(dataTable, true);&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;FileStream aFile = new FileStream("c:\\data\\excelfile.xls", FileMode.Create);&lt;br&gt;
byte[] byData = pck.GetAsByteArray(); &lt;br&gt;
aFile.Seek(0, SeekOrigin.Begin);&lt;br&gt;
aFile.Write(byData, 0, byData.Length);&lt;br&gt;
aFile.Close();&lt;a&gt;&lt;/a&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="pkspence" When="27/06/2012 16:14:07">
          <Html>
        
&lt;blockquote style="margin: 0.25em 1em 0px; padding: 0px 0.25em; border: 0.1em solid rgb(204, 204, 204); border-image: none; font-style: italic;"&gt;
&lt;strong&gt;jtpatil wrote:&lt;/strong&gt;&lt;br&gt;
&lt;p&gt;You can save to XLS: example code that I'm using:&lt;/p&gt;
&lt;div&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;ExcelPackage pck = new ExcelPackage();&lt;br&gt;
ExcelWorksheet ws = pck.Workbook.Worksheets.Add("Demo");&lt;br&gt;
ws.Cells["A1"].LoadFromDataTable(dataTable, true);&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;FileStream aFile = new FileStream("c:\\data\\excelfile.xls", FileMode.Create);&lt;br&gt;
byte[] byData = pck.GetAsByteArray(); &lt;br&gt;
aFile.Seek(0, SeekOrigin.Begin);&lt;br&gt;
aFile.Write(byData, 0, byData.Length);&lt;br&gt;
aFile.Close();&lt;a&gt;&lt;/a&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;/blockquote&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;When I attempt to open the .xls file with Excel 2003 I'm getting an error message saying "This file is not in a recognizable format". I've copied your code verbatim so I'm sure I've not fat-fingered something.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mjslane" When="27/06/2012 17:21:13">
          <Html>
        
&lt;p&gt;No you can't save to xls format. &amp;nbsp;This code will just save a 2007 formatted spreadsheet with a file extension of xls.&lt;/p&gt;
&lt;p&gt;If you only need to read xls files, install the compatibility pack and take a look at excelcnv.exe. There is also ofc.exe, which I believe is just a wrapper around excelcnv.exe. &amp;nbsp; You can use one of these to convert your file and then read it into epplus.
 &amp;nbsp;On a 64 bit 2008 server I had to tell ofc to run in XP SP3 compatibility mode, my programs check for this and sets it to be sure.&lt;/p&gt;
&lt;p&gt;&lt;a href="http://www.codingforpeanuts.co.uk/2012/06/one-of-my-applications-uses-epplus.html" rel="nofollow"&gt;http://www.codingforpeanuts.co.uk/2012/06/one-of-my-applications-uses-epplus.html&lt;/a&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="sherryummen" When="02/08/2012 13:44:18">
          <Html>
        
&lt;p&gt;HI, this is a very interesting topic which I bump every now and then.&lt;br&gt;
&lt;br&gt;
I would request the developers that could they please add a feature to convert the generated .xlsx file to .xls a tleast?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="richardtallent" When="10/08/2012 08:28:46">
          <Html>
        
&lt;p&gt;If you need to read or write XLS (BIFF / Excel 97/2000) files, I recommend NPOI. It's not as straightforward as EPPlus, but does a very good job and is also open source.&lt;/p&gt;
&lt;p&gt;http://npoi.codeplex.com/&lt;/p&gt;
&lt;p&gt;NPOI has (or had at some point) some support for XLSX as well, but after using it a few weeks, I strongly prefer EPPlus for that.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mjslane" When="14/08/2012 15:37:29">
          <Html>
        
&lt;p&gt;I don't agree that the&amp;nbsp;developers&amp;nbsp;should spend time adding the&amp;nbsp;ability&amp;nbsp;to write to xls format. &amp;nbsp;The new formats are so ubiquitous now that almost everyone either has office 2007 and above, libreoffice or the compatibility packs installed
 on office 2003. &amp;nbsp;Only legacy apps that can only read xls format are affected by the lack of this feature and that should be a problem for the maintainers of the legacy application.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Limit on number of entries in List Validation">
      <Posts>
        <Post From="tiruvishal" When="14/08/2012 14:07:18">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;While using the AddListValidation(), Is there a limit on the number of entries that can be shown in that list.&lt;/p&gt;
&lt;p&gt;After several testing, I found that one cannot add more than 48 items in that list. I have to show a drop down with 215 items in the drop down list and am just not able to show it.&lt;/p&gt;
&lt;p&gt;Any ideas??? This is urgent.&lt;/p&gt;
&lt;p&gt;Thanks.&lt;/p&gt;
&lt;p&gt;vishal.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Bug? It not work when copy lot of mergecell to other cells at ExcelRangeBase.Copy()">
      <Posts>
        <Post From="torentchan" When="14/08/2012 08:37:46">
          <Html>
        
&lt;p&gt;(v3.0.0.2)this case:&lt;/p&gt;
&lt;p&gt;A1:E1&amp;nbsp; -&amp;gt; mergecell,&amp;nbsp;&amp;nbsp; G1:J1&amp;nbsp; -&amp;gt;&amp;nbsp; mergecel&lt;/p&gt;
&lt;p&gt;sheet.Cells["A1:J1"].Copy(sheet.Cells["A5:J5"]);&lt;/p&gt;
&lt;p&gt;is not work?&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="ExcelPackage Constructor hangs in Event Reciever">
      <Posts>
        <Post From="amcclary" When="10/08/2012 18:19:06">
          <Html>
        
&lt;p&gt;I am simply trying to get values from an excel spreadsheet uploaded to a document library in Sharepoint. I have placed the code in an event receiver similar to this link :&lt;/p&gt;
&lt;p&gt;&lt;a href="http://blogs.msdn.com/b/pranab/archive/2009/05/14/how-to-publish-ms-excel-cell-values-in-metadata-columns-as-in-quickparts-for-ms-word.aspx" rel="nofollow"&gt;http://blogs.msdn.com/b/pranab/archive/2009/05/14/how-to-publish-ms-excel-cell-values-in-metadata-columns-as-in-quickparts-for-ms-word.aspx&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Everything works properly until using (ExcelPackage ep = new ExcelPackage() ). The sublist "testthis" is never populated and the event receiver hangs. I checked to make sure the openBinaryFile method is returning a non empty byte array and also
 that the memory stream is populated. Again, everything works until that using declaration.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;override&lt;/span&gt; &lt;span style="color: blue;"&gt;void&lt;/span&gt; ItemAdded(SPItemEventProperties properties)
        {
            SPDocumentLibrary someLibrary;
            &lt;span style="color: blue;"&gt;base&lt;/span&gt;.ItemAdding(properties);
            web = properties.OpenWeb();
            &lt;span style="color: blue;"&gt;if&lt;/span&gt; (web.Lists[properties.ListTitle] &lt;span style="color: blue;"&gt;is&lt;/span&gt; SPDocumentLibrary)
            {
                someLibrary = (SPDocumentLibrary)web.Lists[properties.ListTitle];
            }


            &lt;span style="color: blue;"&gt;if&lt;/span&gt; (properties.ListItem.File != &lt;span style="color: blue;"&gt;null&lt;/span&gt;)
            {
                SPListItemCollection table = web.Lists[&lt;span style="color: rgb(163, 21, 21);"&gt;"testthis"&lt;/span&gt;].Items;
                SPListItem newRow = table.Add();
                
                
                
                MemoryStream fs = &lt;span style="color: blue;"&gt;new&lt;/span&gt; MemoryStream();
                fs.Write(properties.ListItem.File.OpenBinary(), 0, Convert.ToInt32(properties.ListItem.File.TotalLength));

                &lt;span style="color: blue;"&gt;using&lt;/span&gt; (ExcelPackage ep = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage())
                {

                }


		newRow[&lt;span style="color: rgb(163, 21, 21);"&gt;"Title"&lt;/span&gt;] = &lt;span style="color: rgb(163, 21, 21);"&gt;"test"&lt;/span&gt;;


                fs.Close();
                newRow.Update();


            }
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Delete or Remove an ExcelPicture">
      <Posts>
        <Post From="seadoglove" When="08/08/2012 11:47:30">
          <Html>
        
&lt;p&gt;Dear All,&lt;/p&gt;
&lt;p&gt;I cannot find the feature deleting an existing picture in Excel file. This feature is very useful when we want to delete many pictures and insert new pictures into file.&lt;/p&gt;
&lt;p&gt;If possible, give me a help. Thank you.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="changing series color using macros in client side c#,asp.net">
      <Posts>
        <Post From="kavithak" When="08/08/2012 07:28:36">
          <Html>
        
&lt;p&gt;hi folks,&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; I am able to genarating excel charts using epplus sucessfully but unable to customize the each series color in graph of my choice.&lt;br&gt;
&amp;nbsp;&amp;nbsp; &amp;nbsp;Is there any way&amp;nbsp; or&amp;nbsp; can i change the of series color&amp;nbsp;when excel workbook is opened at client side using macros...&lt;br&gt;
&amp;nbsp;&amp;nbsp; plz help me...&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; urgent..&lt;br&gt;
&lt;br&gt;
thanks ,&lt;br&gt;
kavitha kundena&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Is there any way to create individual cells like we do with HTML table">
      <Posts>
        <Post From="webfriend13" When="01/08/2012 10:38:02">
          <Html>
        
&lt;p&gt;HI All,&lt;/p&gt;
&lt;p&gt;I am using EPPlus library for the first time. I want a create a cell instead of accessing it like ﻿ ﻿worksheet.Cells["A1"] or worksheet.Cells[1,1]. The idea is to create a cell, provide it formatting and add it to a row at a specific
 column based on certain condition. Let me know if I can achieve this.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thank you&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="weismat" When="08/08/2012 06:47:33">
          <Html>
        
&lt;p&gt;The cell is basically empty when you access it the first time.&lt;/p&gt;
&lt;p&gt;Thus there is no need to create/instance a new cell. Conditional/programmaticallty formatting is possible. Do you want to achieve this dynamically with a formula or statically inside the C# program?&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Problem with renaming columnnames and pivot tables - Excel crash">
      <Posts>
        <Post From="SleepyZeebop" When="07/08/2012 10:07:45">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I'm trying to extract data from a database and populating to a datasheet. If I rename the columns to reflect the real names (localized) Excel crashes after I activate editmode (Excels builtin security feature)&lt;/p&gt;
&lt;p&gt;Anyone knows a good solution to this problem? I will probobly create the table by hand instead.&lt;/p&gt;
&lt;p&gt;The row that causes the problem is commented below.&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;
&lt;p&gt;Daniel&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;            &lt;span style="color: blue;"&gt;using&lt;/span&gt; (ExcelPackage pck = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage())
            {
                &lt;span style="color: green;"&gt;//Create the worksheet&lt;/span&gt;
                &lt;span style="color: blue;"&gt;var&lt;/span&gt; wsData = pck.Workbook.Worksheets.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"Source"&lt;/span&gt;);
                
                &lt;span style="color: blue;"&gt;var&lt;/span&gt; dataRange = wsData.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A4"&lt;/span&gt;].LoadFromCollection(
                    &lt;span style="color: blue;"&gt;from&lt;/span&gt; s &lt;span style="color: blue;"&gt;in&lt;/span&gt; listWO
                    &lt;span style="color: blue;"&gt;select&lt;/span&gt; &lt;span style="color: blue;"&gt;new&lt;/span&gt; {
                        WONumber=s.WorkOrderNo,
                        WOName=s.WorkOrderName,
                        Status =s.Status,
                        Planned = s.Planned,
                        Performed =s.Performed,
                        Customer=s.Customer,
                        Category =s.Category,
                        Group =s.Group, 
                        Property=&lt;span style="color: rgb(163, 21, 21);"&gt;""&lt;/span&gt;,
                        Building =&lt;span style="color: rgb(163, 21, 21);"&gt;""&lt;/span&gt;,
                        Object =&lt;span style="color: rgb(163, 21, 21);"&gt;""&lt;/span&gt;,
                        Location =s.Location,
                        WorkOrderType=s.WorkOrderType,
                        Time =s.TimeElapsed,
                        Cost=s.Cost,
                        Description=s.Instruction,
                        Comment = s.Comment
                    },
                   &lt;span style="color: blue;"&gt;true&lt;/span&gt;, OfficeOpenXml.Table.TableStyles.Medium2);

                wsData.Cells[5, (&lt;span style="color: blue;"&gt;int&lt;/span&gt;)Columns.Planned, dataRange.End.Row, (&lt;span style="color: blue;"&gt;int&lt;/span&gt;)Columns.Planned].Style.Numberformat.Format = &lt;span style="color: rgb(163, 21, 21);"&gt;"yyyy-MM-dd hh:mm"&lt;/span&gt;;
                wsData.Cells[5, (&lt;span style="color: blue;"&gt;int&lt;/span&gt;)Columns.Performed, dataRange.End.Row, (&lt;span style="color: blue;"&gt;int&lt;/span&gt;)Columns.Performed].Style.Numberformat.Format = &lt;span style="color: rgb(163, 21, 21);"&gt;"yyyy-MM-dd hh:mm"&lt;/span&gt;;

                &lt;span style="color: green;"&gt;//This row causes Excel to crash&lt;/span&gt;
                &lt;span style="color: green;"&gt;//wsData.Tables.GetFromRange(dataRange).Columns[(int)Columns.Planned-1].Name = "Planerad";&lt;/span&gt;
                
                dataRange.AutoFitColumns();
                
                
                &lt;span style="color: blue;"&gt;var&lt;/span&gt; wsPivot = pck.Workbook.Worksheets.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"PivotSimple"&lt;/span&gt;);
                &lt;span style="color: blue;"&gt;var&lt;/span&gt; pivotTable1 = wsPivot.PivotTables.Add(wsPivot.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;], dataRange, &lt;span style="color: rgb(163, 21, 21);"&gt;"PerEmploee"&lt;/span&gt;);

                pivotTable1.RowFields.Add(pivotTable1.Fields[(&lt;span style="color: blue;"&gt;int&lt;/span&gt;)Columns.Group - 1]);
                pivotTable1.ColumnFields.Add(pivotTable1.Fields[(&lt;span style="color: blue;"&gt;int&lt;/span&gt;)Columns.Status - 1]);
                &lt;span style="color: blue;"&gt;var&lt;/span&gt; dataField = pivotTable1.DataFields.Add(pivotTable1.Fields[(&lt;span style="color: blue;"&gt;int&lt;/span&gt;)Columns.Time - 1]);
                dataField.Format = &lt;span style="color: rgb(163, 21, 21);"&gt;"#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;"&lt;/span&gt;;
                pivotTable1.DataOnRows = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;

                &lt;span style="color: blue;"&gt;return&lt;/span&gt; pck.GetAsByteArray();
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Chart colors">
      <Posts>
        <Post From="_PJ_" When="15/05/2012 01:33:40">
          <Html>
        
&lt;p&gt;Hey !&lt;/p&gt;
&lt;p&gt;Is it possible to change the color from one single element from the series in one&amp;nbsp;column stacked chart ?&lt;/p&gt;
&lt;p&gt;How ?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thank you all&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="kavithak" When="03/08/2012 12:51:57">
          <Html>
        
&lt;p&gt;hi..&lt;/p&gt;
&lt;p&gt;have u find the solution..&lt;/p&gt;
&lt;p&gt;i to have the same requirement .&lt;/p&gt;
&lt;p&gt;plz reply..&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="wendelstam" When="03/08/2012 13:01:16">
          <Html>
        
&lt;p&gt;Actually I did get it to work by using the OpenXML SDK to do some modifications to the document before saving to disk.
&lt;br&gt;
Cant find the code I used though since I did not proceed with EPPlus I must have deleted it, but atleast its possible. (Sorry).&lt;br&gt;
&lt;br&gt;
I never used it in production, since my charting requirements where quite complex so I abandoned EPPlus for Syncfusions XLS IO, it is a commercial product but its an really great product that has really good charting support for XLSX.&lt;br&gt;
&lt;br&gt;
EPPlus is still a great framework as far as I know but the charting support is not as complete and easy as &amp;nbsp;XlsIO if you ask me.&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Mutli-coloured font within the same cell..!!!!">
      <Posts>
        <Post From="nirmalsat" When="03/08/2012 11:11:43">
          <Html>
        
&lt;p&gt;Hi ,&lt;/p&gt;
&lt;p&gt;I would like to know if its possible to have multi -coloured fonts , that is two different text with two different colours within the same cell using this plugin.&lt;/p&gt;
&lt;p&gt;Thanks in advance..&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="03/08/2012 11:59:54">
          <Html>
        
&lt;p&gt;Yes, you can. Take a look at this thread&amp;nbsp;&lt;a href="http://epplus.codeplex.com/discussions/263388" rel="nofollow"&gt;http://epplus.codeplex.com/discussions/263388&lt;/a&gt;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Generating charts">
      <Posts>
        <Post From="kavithak" When="01/08/2012 07:55:08">
          <Html>
        
&lt;p&gt;Hi folks,&lt;/p&gt;
&lt;p&gt;&amp;nbsp; How to generate Column Clustered chart ..&lt;/p&gt;
&lt;p&gt;am able to generate but am getting 4 columns instead of 2 columns.&lt;/p&gt;
&lt;p&gt;the range is taking 2 values from 2 columns each&lt;/p&gt;
&lt;p&gt;this is the code&lt;/p&gt;
&lt;p&gt;&amp;nbsp;ExcelChart chart = xlWorkSheet.Drawings.AddChart("Chart1", eChartType.ColumnClustered);&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; chart.Title.Text = "Direct Expense Efficiency Ratio";&amp;nbsp;&lt;/p&gt;
&lt;p&gt;chart.SetPosition(2, 5, 1, 4);&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;chart.SetSize(640, 440);&amp;nbsp; &amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;var serie = chart.Series.Add(xlWorkSheet.Cells["C28:C29,E28:E29"], xlWorkSheet.Cells["B28:B29"]);&lt;/p&gt;
&lt;p&gt;plz help me urgent..&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="kavithak" When="01/08/2012 08:09:40">
          <Html>
        
&lt;p&gt;hi,,&lt;/p&gt;
&lt;p&gt;i found the solution&amp;nbsp;&lt;/p&gt;
&lt;p&gt;just adding another series an able to get..&lt;/p&gt;
&lt;p&gt;&lt;span&gt;var serie = chart.Series.Add(xlWorkSheet.Cells["C28:C29], xlWorkSheet.Cells["B28:B29"]);&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;var serie = chart.Series.Add(xlWorkSheet.Cells["E28:E29], xlWorkSheet.Cells["B28:B29"]);//added&lt;br&gt;
&lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="kavithak" When="03/08/2012 09:57:11">
          <Html>
        
&lt;p&gt;hi,&lt;/p&gt;
&lt;p&gt;i found another issue while generating report..&lt;/p&gt;
&lt;p&gt;am unable to change the series color in the chart..&lt;/p&gt;
&lt;p&gt;will u plz help me urgent...&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Last used cell in a row/column">
      <Posts>
        <Post From="mjslane" When="10/05/2011 16:26:00">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Is there a way to find the last used cell in a row or column?&amp;nbsp;Similar to range.end(xltoleft) ?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks,&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Matt&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="10/05/2011 19:26:45">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Not for a specific&amp;nbsp;row or column&amp;nbsp;within the worksheet, but you can use the Worksheet.Dimension.End.Row or Worksheet.Dimension.End.Column&amp;nbsp;properties to get the bottom right cell.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="sherryummen" When="02/08/2012 05:49:16">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;It gives a Null pointer exception if the file is a new created file&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;For example:&lt;/p&gt;
&lt;p&gt;using (ExcelPackage package = new ExcelPackage(newFile)) {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; // add a new worksheet to the empty workbook&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ExcelWorksheet worksheet = package.Workbook.Worksheets.Add("POP");&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; //Add the headers&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; int row = worksheet.Dimension.Start.Row;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; int col = worksheet.Dimension.Start.Column;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Do you know whats the reason?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="02/08/2012 13:08:28">
          <Html>
        
&lt;p&gt;&lt;span style="white-space: pre;"&gt;&lt;/span&gt;I think it is by design. I see only two options in this case: return [1,1] or return null. If we choose to return [1,1], we would never know if there is only one cell in our sheet or it is empty.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="sherryummen" When="02/08/2012 13:39:23">
          <Html>
        
&lt;p&gt;Yes, but I feel null would have been a better option rather throwing an exception. What do you think?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="02/08/2012 13:54:21">
          <Html>
        
&lt;p&gt;EPPlus doesnt throw exception, only return null, your code are throwing exception because you don´t test if Dimension is null.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;        &lt;span style="color: gray;"&gt;///&lt;/span&gt; &lt;span style="color: gray;"&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt;&lt;span style="color: green;"&gt; Dimension address for the worksheet. &lt;/span&gt;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt;&lt;span style="color: green;"&gt; Top left cell to Bottom right.&lt;/span&gt;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt;&lt;span style="color: green;"&gt; If the worksheet has no cells, null is returned&lt;/span&gt;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt; &lt;span style="color: gray;"&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; ExcelAddressBase Dimension
        {
            &lt;span style="color: blue;"&gt;get&lt;/span&gt;
            {
                &lt;span style="color: blue;"&gt;if&lt;/span&gt; (_cells.Count &amp;gt; 0)
                {
                    &lt;span style="color: blue;"&gt;return&lt;/span&gt; &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelAddressBase((_cells[0] &lt;span style="color: blue;"&gt;as&lt;/span&gt; ExcelCell).Row, _minCol, (_cells[_cells.Count - 1] &lt;span style="color: blue;"&gt;as&lt;/span&gt; ExcelCell).Row, _maxCol);
                }
                &lt;span style="color: blue;"&gt;else&lt;/span&gt;
                {
                    &lt;span style="color: blue;"&gt;return&lt;/span&gt; &lt;span style="color: blue;"&gt;null&lt;/span&gt;;
                }
            }
        }
&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="sherryummen" When="02/08/2012 15:13:13">
          <Html>
        
&lt;p&gt;ok Thank you. This solves my problem :)&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Excel Named Range - Creating and Reading">
      <Posts>
        <Post From="tiruvishal" When="31/07/2012 16:02:08">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I have been trying to use the Excel Named Range but cannot get it working.&lt;/p&gt;
&lt;p&gt;I am dynamically creating the excel and want to create a named range for a group of cells, but did not find any way of doing it.&lt;/p&gt;
&lt;p&gt;Although, when i manually create a named range in excel and try to read programmatically i am able to read the it.&lt;/p&gt;
&lt;p&gt;Any ideas???&lt;/p&gt;
&lt;p&gt;This is urgent.&lt;/p&gt;
&lt;p&gt;Vishal.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Reading the Data Validation list of a cell from excel">
      <Posts>
        <Post From="tiruvishal" When="27/07/2012 11:34:59">
          <Html>
        
&lt;p&gt;Hello,&lt;/p&gt;
&lt;p&gt;Is it possible to read the Data validation list from the excel file using epplus.&lt;/p&gt;
&lt;p&gt;I do see a Data Validation list field when i expand the cell members. But did not get to a property or field that would expose the actual list contents.&lt;/p&gt;
&lt;p&gt;Can some one help me with a code snippet?&lt;/p&gt;
&lt;p&gt;Thanks.&lt;/p&gt;
&lt;p&gt;Vishal&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Format the Excel Worksheet">
      <Posts>
        <Post From="ssack" When="26/07/2012 20:25:49">
          <Html>
        
&lt;p&gt;Good afternoon,&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I was wondering if there is a way to format an excel worksheet to be landscape, format the sheet to print on one page, and lastly how to automatically resize the columns to its contents..&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks in Advance&lt;/p&gt;
&lt;p&gt;Sal&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="26/07/2012 20:40:27">
          <Html>
        
&lt;p&gt;&lt;span&gt;Use the Worksheet.Printersettings.Orientation property and Worksheet.Columns(i).AutoFit method.&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;br&gt;
&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;br&gt;
&lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="ssack" When="26/07/2012 20:51:01">
          <Html>
        
&lt;p&gt;Thank you&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Adding a Datetime picker in excel">
      <Posts>
        <Post From="tiruvishal" When="26/07/2012 11:08:36">
          <Html>
        
&lt;p&gt;First and foremost, I'd like to thank all the developers for making such a wonderful and efficient library !!!&lt;/p&gt;
&lt;p&gt;I wanted to add a datetime picker in a cell (or range of cells)&amp;nbsp;of the excel using epplus.&lt;/p&gt;
&lt;p&gt;Is it possible? If yes, then please share some code snippet.&lt;/p&gt;
&lt;p&gt;Thanks.&lt;/p&gt;
&lt;p&gt;Vishal.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="26/07/2012 20:41:38">
          <Html>
        
&lt;p&gt;&lt;span&gt;EPPlus doesn't support forms in this current release.&lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Opening Generated files in LibreOffice">
      <Posts>
        <Post From="tcliam" When="19/06/2012 04:53:21">
          <Html>
        
&lt;p&gt;I have been trying to open generated files in LibreOffice with no luck. I see that there were some previous posts
&lt;a href="http://epplus.codeplex.com/discussions/248831" rel="nofollow"&gt;here&lt;/a&gt; and &lt;a href="http://epplus.codeplex.com/workitem/13293" rel="nofollow"&gt;
here&lt;/a&gt; but I am using the latest version and the latest source but with no luck.&lt;/p&gt;
&lt;p&gt;Has support for Libre Office been broken in the newer versions of EPPlus?&lt;/p&gt;
&lt;p&gt;How can I get excel files generated with EPPlus to open in LibreOffice?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="tcliam" When="19/06/2012 13:04:25">
          <Html>
        
&lt;p&gt;OK after trying out the generated excel files on MS Excel 2011 it appears that the issues with the files could be related to the use of Mono. When trying to open the files in MS Excel 2011 I get a corrupted file error. Clicking on the option to repair does
 not help.&lt;/p&gt;
&lt;p&gt;I have seen this &lt;a href="https://github.com/ylatuya/EPPlus/commit/fa0620f8bb5a6916072b5c2a9af5b056aa1c725b" rel="nofollow"&gt;
here &lt;/a&gt;which fixes the issues with URI's. I tried this code. I still get the corrupt error when opening in MS Excel. On repairing, excel keeps the file open but the worksheet is empty.&lt;/p&gt;
&lt;p&gt;Is there any up to date status on using EPPlus on Mono? Can EPPlus be used with mono?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="tcliam" When="19/06/2012 13:09:14">
          <Html>
        
&lt;p&gt;Here is the log output after running the repair:&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;&amp;lt;?&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;xml&lt;/span&gt; &lt;span style="color: red;"&gt;version&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;1.0&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: red;"&gt;encoding&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;UTF-8&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: red;"&gt;standalone&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;yes&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;?&amp;gt;&lt;/span&gt;
&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;recoveryLog&lt;/span&gt; &lt;span style="color: red;"&gt;xmlns&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;http://schemas.openxmlformats.org/spreadsheetml/2006/main&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;&lt;span style="color: blue;"&gt;&lt;br&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;logFileName&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;Repair Result to Policies 2012 - International 08334.xml&lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;logFileName&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;&lt;span style="color: blue;"&gt;&lt;br&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;summary&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;Errors were detected in file 'Macintosh HD:Users:liam:Projects:techcertain:TCDocs:SchemeProjectRoot:Policies 2012 - &lt;br&gt;International.xlsx'&lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;summary&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;br&gt;&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;additionalInfo&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;br&gt;&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;info&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;Excel completed file level validation and repair. Some parts of this workbook may have been repaired or discarded.&lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;info&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;br&gt;&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;additionalInfo&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;removedRecords&lt;/span&gt; &lt;span style="color: red;"&gt;summary&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;Following is a list of removed records:&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;&lt;span style="color: blue;"&gt;&lt;br&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;removedRecord&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;Removed Records: Worksheet properties from /xl/workbook.xml (Workbook)&lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;removedRecord&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;&lt;span style="color: blue;"&gt;&lt;br&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;removedRecords&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;recoveryLog&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="tpokorra" When="27/06/2012 08:00:43">
          <Html>
        
&lt;p&gt;I have just created a workaround for this.&lt;/p&gt;
&lt;p&gt;By the way, for testing xlsx files without owning Microsoft Office, and for more detailed error messages:&lt;br&gt;
get the Open XML SDK 2.0 for Microsoft Office from &lt;a href="http://www.microsoft.com/en-us/download/details.aspx?id=5124" rel="nofollow"&gt;
http://www.microsoft.com/en-us/download/details.aspx?id=5124&lt;/a&gt;&lt;br&gt;
it is installed then for example here: C:\Program Files (x86)\Open XML SDK\V2.0\tool&lt;/p&gt;
&lt;p&gt;I have added a note to &lt;a href="http://epplus.codeplex.com/workitem/13096" rel="nofollow"&gt;http://epplus.codeplex.com/workitem/13096&lt;/a&gt; and committed all the workarounds that I have found for EPPlus to work with Mono to this fork:
&lt;a href="http://epplus.codeplex.com/SourceControl/network/forks/tpokorra/monoWorkarounds" rel="nofollow"&gt;
http://epplus.codeplex.com/SourceControl/network/forks/tpokorra/monoWorkarounds&lt;/a&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="lanks" When="19/07/2012 23:41:24">
          <Html>
        
&lt;p&gt;Hi tpokorra&lt;/p&gt;
&lt;p&gt;Thank you for this. I have tried your branch but I am still having trouble getting it to work. I think it is to do with the uri issue with mono.&lt;/p&gt;
&lt;p&gt;I am getting a null reference exception using Epplus on mono on my mac. The exception is happening in:&lt;/p&gt;
&lt;p&gt;Class: ExcelWorksheet&lt;/p&gt;
&lt;p&gt;Function: CreateXml&lt;/p&gt;
&lt;p&gt;Line #: 545&lt;/p&gt;
&lt;p&gt;Line: Stream stream = packPart.GetStream();&lt;/p&gt;
&lt;p&gt;It seems that the line before this PackagePart packPart = _package.Package.GetPart(WorksheetUri); is not working properly and the pakPart variable is null.&lt;/p&gt;
&lt;p&gt;Any ideas on how to fix this? This error seems to occur in the Web Samples 3 and 4.&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;
&lt;p&gt;Liam&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="tpokorra" When="22/07/2012 22:47:28">
          <Html>
        
&lt;p&gt;Hello Liam,&lt;/p&gt;
&lt;p&gt;I have tried to reproduce your problem.&lt;/p&gt;
&lt;p&gt;What is the stacktrace of the exception? I assume your exception happens in GetSamples.aspx.cs in line 115,&amp;nbsp;ExcelPackage pckTemplate = new ExcelPackage();&lt;br&gt;
If that is the case, this does work for me on Mono 2.10.5. I did not use the websample though, but copied the code into a normal exe, so if your exception happens somewhere else, I might try that instead.&lt;/p&gt;
&lt;p&gt;Which version of Mono are you using?&lt;/p&gt;
&lt;p&gt;All the best,&lt;/p&gt;
&lt;p&gt;&amp;nbsp; Timotheus&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Charts How to set a Date Axis? (Format Axis - Axis Options tab - Axis Type - Date Axis)">
      <Posts>
        <Post From="weismat" When="20/07/2012 10:14:16">
          <Html>
        
&lt;p&gt;I am trying to set the Axis type in a generated chart and I can not find it in the properties of&amp;nbsp;&lt;/p&gt;
&lt;p&gt;ExcelChart.XAxis.&lt;/p&gt;
&lt;p&gt;In Excel this is reached when clicking - Format Axis - Axis Options tab - Axis Type - Date Axis.&lt;/p&gt;
&lt;p&gt;Is this currently possible or not? The values inside the sheet are all doubles, but when the Axis type can not be set, it seems to treat the X-Axis as text, not as number.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="weismat" When="20/07/2012 13:53:07">
          <Html>
        
&lt;p&gt;I have reviewed the code.&lt;/p&gt;
&lt;p&gt;EAxisType has just a getter - is there any specific reason why it is not exposed in the external API?&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Add a name to the UsedRange">
      <Posts>
        <Post From="gavishgeorge" When="01/06/2012 13:32:09">
          <Html>
        
&lt;p&gt;How do you add a name to the UsedRange prop.&lt;/p&gt;
&lt;p&gt;So if I have : &lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;ExcelRange excelRange = xlsWSheet.Cells[startRow, startColumn, endRow, endColumn];
&lt;/pre&gt;
&lt;/div&gt;
How do I have somethng like
&lt;p&gt;&lt;/p&gt;
&lt;pre&gt;excelRange.Name = "XYZ";&lt;br&gt;&lt;br&gt;&amp;nbsp;&lt;/pre&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="13/06/2012 20:37:24">
          <Html>
        
&lt;p&gt;You can add a name using the Worksheet.Names collection or the Workbook.Names collection&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="gavishgeorge" When="20/07/2012 13:03:44">
          <Html>
        
&lt;p&gt;This works just fine. Thank you !!!&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to bring hyperlinked cell to the top of page">
      <Posts>
        <Post From="Aliaksei_Maniuk" When="14/07/2012 23:13:16">
          <Html>
        
&lt;p&gt;I have a lot of information on my page and need to create navigation. But unfortunatelly when I click on same hyperlink I see target cell at the bottom of the page.&lt;/p&gt;
&lt;p&gt;&lt;br&gt;
Could you please provide me some tips how to bring cell to the top of page?&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="The handle is Invalid. IIS Windows Authentication Error.">
      <Posts>
        <Post From="stewy" When="12/07/2012 02:20:14">
          <Html>
        
&lt;p&gt;Hi, I have a MVC 3 app that is giving me this error when I try running EPPLus. It works fine locally with Windows Authentication (Win 7 64 Pro) but when I deploy to the server it fails with Windows Authentication on. If I switch WIndows Authentication off
 then I dont get the error.&lt;/p&gt;
&lt;p&gt;Any help on this would be great.&lt;/p&gt;
&lt;p&gt;Thanks, Dave&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Exception Details: &lt;/strong&gt;System.Runtime.InteropServices.COMException: The handle is invalid. (Exception from HRESULT: 0x80070006 (E_HANDLE))&lt;br&gt;
&lt;br&gt;
&lt;strong&gt;Source Error:&lt;/strong&gt; &lt;br&gt;
&lt;br&gt;
&lt;/p&gt;
&lt;table width="100%" bgcolor="#ffffcc"&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;An unhandled exception was generated during the execution of the current web request. Information regarding the origin and location of the exception can be identified using the exception stack trace below.&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

        
    </Html>
        </Post>
        <Post From="Stewy" When="12/07/2012 02:49:19">
          <Html>
        
&lt;p&gt;It appears that impersonation = "true" causes this issue but I dont know why!&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Stewy" When="12/07/2012 04:04:20">
          <Html>
        
&lt;p&gt;OK, so the solution was to give the app pool account enough permissions to write to c:\windows\temp.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="PKSpence" When="12/07/2012 13:31:44">
          <Html>
        
&lt;div dir="ltr"&gt;From a security stand point, I don't think giving permissions to the c:\windows folder, or any of it's sub-folders, is good idea. Just my .02 worth&lt;br&gt;
&lt;br&gt;
&lt;div&gt;
&lt;div id="SkyDrivePlaceholder"&gt;&lt;/div&gt;
&lt;hr id="stopSpelling"&gt;
From: [email removed]&lt;br&gt;
To: [email removed]&lt;br&gt;
Date: Wed, 11 Jul 2012 20:04:24 -0700&lt;br&gt;
Subject: Re: The handle is Invalid. IIS Windows Authentication Error. [EPPlus:362900]&lt;br&gt;
&lt;br&gt;
From: Stewy&lt;br&gt;
&lt;div id="ecxThreadNotificationPostBody"&gt;OK, so the solution was to give the app pool account enough permissions to write to c:\windows\temp.&lt;br&gt;
&lt;/div&gt;
&lt;div id="ecxThreadNotificationFooter"&gt;Read the &lt;a href="http://epplus.codeplex.com/discussions/362900#post860628" target="_blank" rel="nofollow"&gt;
full discussion online&lt;/a&gt;.&lt;br&gt;
To add a post to this discussion, reply to this email (&lt;a href="mailto:EPPlus@discussions.codeplex.com?subject=[EPPlus:362900]" rel="nofollow"&gt;EPPlus@discussions.codeplex.com&lt;/a&gt;)&lt;br&gt;
To start a new discussion for this project, email &lt;a href="mailto:EPPlus@discussions.codeplex.com" rel="nofollow"&gt;
EPPlus@discussions.codeplex.com&lt;/a&gt;&lt;br&gt;
You are receiving this email because you subscribed to this discussion on CodePlex. You can
&lt;a href="https://epplus.codeplex.com/subscriptions/thread/project/edit" target="_blank" rel="nofollow"&gt;
unsubscribe or change your settings&lt;/a&gt; on codePlex.com.&lt;br&gt;
Please note: Images and attachments will be removed from emails. Any posts to this discussion will also be available online at codeplex.com&lt;br&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Sorting columns?">
      <Posts>
        <Post From="Redth" When="10/07/2012 21:02:01">
          <Html>
        
&lt;p&gt;How do I sort columns?&amp;nbsp;&lt;/p&gt;
&lt;p&gt;For example I'd like to sort in the order of something like:&lt;/p&gt;
&lt;p&gt;Col A ASC, Col B DESC, Col C ASC&lt;/p&gt;
&lt;p&gt;Thanks!&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Troubles processing Excel .xlsx generated with Java POI in Linux">
      <Posts>
        <Post From="juandi" When="10/07/2012 15:58:54">
          <Html>
        
&lt;p&gt;I am getting an excel file from a third party generated automatically in a Linux machine with a Java script using the Apache POI API.&lt;/p&gt;
&lt;p&gt;Afterwards I want to open and read the content using EPPlus. Unfortunately I get the Worksheets object as NULL from the Workbook getting a Null reference exception.&lt;/p&gt;
&lt;p&gt;I can open the file with Excel with no troubles. What is very strange is that I save afterwards the file in Excel just with "Save", and then it gets a bigger size and I can process it without any troubles with EPPlus.&lt;/p&gt;
&lt;p&gt;This third party has already contact POI to check if the file is generated with incomplete data or if there is any problems with the file.&lt;/p&gt;
&lt;p&gt;I was wondering if someone has an idea of how I can solve this problem or whether EPPlus can't process certain excel files.&lt;/p&gt;
&lt;p&gt;I&amp;nbsp;appreciate&amp;nbsp;your help with this.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Trouble with creating PivotTable from my DataTable.">
      <Posts>
        <Post From="msalte" When="10/07/2012 08:30:49">
          <Html>
        
&lt;p&gt;Solved my problem. Can't figure out how to delete the thread.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Error on save to excel">
      <Posts>
        <Post From="silviudc" When="03/07/2012 09:18:55">
          <Html>
        
&lt;p&gt;I have the samples of the EPPlus working ok but when I try to add save to excel option in my code I keep getting the error below:&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;Microsoft JScript runtime error: Sys.WebForms.PageRequestManagerParserErrorException: The message received &lt;span style="color: blue;"&gt;from&lt;/span&gt; the server could not be parsed.&lt;/pre&gt;
I have an UpdatePanel which displays a dynamically created table which is created on a button click event. Then I have another button, Save To Excel which creates the excel file and asks the user where to save it (it actually works fine if added to an empty
 project for example) This is how I end my SaveToExcel method:
&lt;pre&gt;&lt;div style="color: black; background-color: white;"&gt;&lt;pre&gt;Response.Clear();
Response.ContentType = &lt;span style="color: rgb(163, 21, 21);"&gt;"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"&lt;/span&gt;;
Response.AddHeader(&lt;span style="color: rgb(163, 21, 21);"&gt;"content-disposition"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"attachment;  filename=excelFile.xlsx"&lt;/span&gt;);
package.SaveAs(Response.OutputStream);
Response.End();
&lt;/pre&gt;
&lt;/div&gt;
&lt;/pre&gt;
I have been stepping through the whle SaveToExcel() method and it errors on
&lt;pre&gt;Response.End();&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;How to fix that?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="bugmenot2" When="04/07/2012 12:05:04">
          <Html>
        
&lt;p&gt;try to replace your 2 last lines of code with this:&lt;/p&gt;
&lt;p&gt;bytes = package.GetAsByteArray();&lt;/p&gt;
&lt;p&gt;Response.BinaryWrite(bytes);&lt;/p&gt;
&lt;p&gt;Response.End();&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Release Used Memory?">
      <Posts>
        <Post From="mrbart" When="14/06/2012 11:48:43">
          <Html>
        
&lt;p&gt;I seem to have an issue, we are creating files that have between 10,000 and 100,000 rows, the files are created fine, but in watching the process manager for the server, the memory used (several GB) while the file is generating&amp;nbsp;doesn't&amp;nbsp;get released
 afterwards.&lt;/p&gt;
&lt;p&gt;The amount of RAM it uses isnt an issue, but the only way i seem to be able reclaim it is to recycle the app pool for that site.&lt;/p&gt;
&lt;p&gt;Does any one have any ideas of what i can try?&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="akronite" When="28/06/2012 08:07:41">
          <Html>
        
&lt;p&gt;hi there,&lt;/p&gt;
&lt;p&gt;This isn't the best solution (not a proper one anyway).&lt;/p&gt;
&lt;p&gt;However, it's something I know and used in the same instant as you.&lt;/p&gt;
&lt;p&gt;I found that if you recycle the IIS application pool, IIS would flushes out any unused memories.&lt;/p&gt;
&lt;p&gt;Since my applications uses database session states, the user aren't being effected by the IIS recycling.&lt;/p&gt;
&lt;p&gt;Hoped that help or until someone provide a better solutions&lt;/p&gt;
&lt;p&gt;&lt;a href="about.me/michaeltran" rel="nofollow"&gt;about.me/MichaelTran&lt;/a&gt;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to hide subtotals in pivot table using EPPlus">
      <Posts>
        <Post From="raghunarahari" When="28/06/2012 07:25:49">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I want to disable the subtotals when i select 2 or more&amp;nbsp;items in row or column groups. I am able to disable the subtotals if i select one row and one column group, but i need to disable if select 2 or more groups in row or columns.&lt;/p&gt;
&lt;p&gt;Could any one give a solution for this issue.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Delete a picture">
      <Posts>
        <Post From="DanceWtihBamboo" When="27/06/2012 00:07:48">
          <Html>
        
&lt;p&gt;How do you remove an exiting picture from a worksheet? &amp;nbsp;I don't see a "Remove" method on the Drawings collection.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="LoadFromCollection - How to remove the ReturnCode and ReturnMessage columns in exported Excel file">
      <Posts>
        <Post From="DotNetDeveloper2" When="26/06/2012 16:52:05">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I am using the LoadFromCollection method to export my data to an Excel format like such:&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;font face="Consolas" size="2"&gt;&lt;/font&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;font face="Consolas" size="2"&gt;
&lt;p&gt;ws.Cells.LoadFromCollection((&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;List&amp;lt;myObject&amp;gt;,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;true));&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&amp;nbsp;&lt;/font&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&amp;nbsp;&lt;/span&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;However,there are two extra columns that&amp;nbsp;does not exist&amp;nbsp;in my List&amp;lt;myObject&amp;gt; which are&amp;nbsp;ReturnCode and ReturnMessage also get exported to the Excel file.&amp;nbsp; Is there anyway to remove or hide them?&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Load from List&amp;lt;People&amp;gt; instead of dataset">
      <Posts>
        <Post From="DotNetDeveloper2" When="25/06/2012 21:04:40">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I just found this libray and have been trying out the sample codes.&amp;nbsp; I can't seem to find&lt;/p&gt;
&lt;p&gt;any method that allows me to load a List&amp;lt;&amp;gt; of objects to export to Excel.&amp;nbsp; This code below works fine for loading a dataset but&amp;nbsp;is there any method for loading&amp;nbsp;a collection like&amp;nbsp;&lt;strong&gt;List&amp;lt;People&amp;gt;&lt;/strong&gt;&amp;nbsp;?&lt;/p&gt;
&lt;pre&gt;ExcelPackage pack = new ExcelPackage();

            foreach (DataTable tbl in ds.Tables)
            {
                ExcelWorksheet ws = pack.Workbook.Worksheets.Add(tbl.TableName);
                ws.Cells["A1"].LoadFromDataTable(tbl, true);

               
            }&lt;/pre&gt;

        
    </Html>
        </Post>
        <Post From="darrenyoung" When="25/06/2012 22:51:04">
          <Html>
        
&lt;p&gt;You are looking for LoadFromCollection&amp;lt;T&amp;gt;.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Problem with adding series in already existing PieChart...">
      <Posts>
        <Post From="pranay9th" When="21/06/2012 08:22:39">
          <Html>
        
&lt;p&gt;I want to add data nodes to an existing pie chart template. For this I am using following code.&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;static&lt;/span&gt; &lt;span style="color: blue;"&gt;void&lt;/span&gt; Main(&lt;span style="color: blue;"&gt;string&lt;/span&gt;[] args)
        {
            String exlFile = &lt;span style="color: rgb(163, 21, 21);"&gt;@"Input\SpreadsheetTmpl.xlsx"&lt;/span&gt;;
            FileInfo fn = &lt;span style="color: blue;"&gt;new&lt;/span&gt; FileInfo(exlFile);

            &lt;span style="color: blue;"&gt;using&lt;/span&gt; (ExcelPackage exl = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(fn))
            {
                &lt;span style="color: blue;"&gt;var&lt;/span&gt; datasheet = exl.Workbook.Worksheets.FirstOrDefault(sh =&amp;gt; sh.Name == &lt;span style="color: rgb(163, 21, 21);"&gt;"SalesData"&lt;/span&gt;);
                &lt;span style="color: blue;"&gt;var&lt;/span&gt; table = datasheet.Tables.First();
                &lt;span style="color: blue;"&gt;int&lt;/span&gt; datarows = table.Address.End.Row;

                &lt;span style="color: blue;"&gt;var&lt;/span&gt; sh1 = exl.Workbook.Worksheets.FirstOrDefault(sh =&amp;gt; sh.Name == &lt;span style="color: rgb(163, 21, 21);"&gt;"PieChart"&lt;/span&gt;);
                &lt;span style="color: blue;"&gt;if&lt;/span&gt; (sh1 != &lt;span style="color: blue;"&gt;null&lt;/span&gt;)
                {
                    &lt;span style="color: blue;"&gt;var&lt;/span&gt; chart = (ExcelChart)sh1.Drawings.FirstOrDefault(c =&amp;gt; c.Name.Contains(&lt;span style="color: rgb(163, 21, 21);"&gt;"Chart"&lt;/span&gt;));
                    &lt;span style="color: blue;"&gt;if&lt;/span&gt; (chart != &lt;span style="color: blue;"&gt;null&lt;/span&gt;)
                    {
                        
                        &lt;span style="color: blue;"&gt;for&lt;/span&gt; (&lt;span style="color: blue;"&gt;int&lt;/span&gt; colCount = 1; colCount &amp;lt; table.Columns.Count; colCount++)
                        {
                            String cellText = (colCount + 1).NumberToText();
                            String ySeriesRange = &lt;span style="color: rgb(163, 21, 21);"&gt;"SalesData!$"&lt;/span&gt; + cellText + &lt;span style="color: rgb(163, 21, 21);"&gt;"$2:$"&lt;/span&gt; + cellText + &lt;span style="color: rgb(163, 21, 21);"&gt;"$"&lt;/span&gt; + (datarows + 1);
                            String xSeriesRange = &lt;span style="color: rgb(163, 21, 21);"&gt;"SalesData!$A$2:$A$"&lt;/span&gt; + (datarows + 1);
                            &lt;span style="color: blue;"&gt;var&lt;/span&gt; series = chart.Series.Add(ySeriesRange, xSeriesRange);
                            series.Header = table.Columns[colCount].Name;
                        }
                    }
                }
                exl.SaveAs(&lt;span style="color: blue;"&gt;new&lt;/span&gt; FileInfo(&lt;span style="color: rgb(163, 21, 21);"&gt;"SpreadsheetTmpl.xlsx"&lt;/span&gt;));
            }
        }
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;But at code line&lt;/p&gt;
&lt;p&gt;var chart = (ExcelChart)sh1.Drawings.FirstOrDefault(c =&amp;gt; c.Name.Contains("Chart"));&lt;br&gt;
it's giving error as:&lt;/p&gt;
&lt;p&gt;Index was out of range. Must be non-negative and less than the size of the collection.&lt;br&gt;
And for any other type of charts (e.g. column chart, line chart) it's working file..&lt;br&gt;
Can any one help me..&amp;nbsp;What's going wrong in above code...&lt;/p&gt;
&lt;p&gt;&lt;br&gt;
Note: I have attached my sample input file..&lt;br&gt;
Pranay&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="darrenyoung" When="23/06/2012 13:09:29">
          <Html>
        
&lt;p&gt;I have assigned this issue to myself. &amp;nbsp;Will hope to have a look over the weekend.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to add worksheet to existing workbook.">
      <Posts>
        <Post From="Arun911" When="19/06/2012 13:25:58">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I've created a workbook and added single worksheet in it, but i need to add more worksheets to the same workbook, how to proceed please need guidance.&lt;/p&gt;
&lt;p&gt;Thank You&lt;/p&gt;
&lt;p&gt;Arun&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="19/06/2012 13:35:32">
          <Html>
        
&lt;p&gt;package&amp;nbsp;= new ExcelPackage(new FileInfo("temp.xlsx"));&lt;/p&gt;
&lt;p&gt;var worksheet1 = package.Workbook.Worksheets.Add("sheet1");&lt;/p&gt;
&lt;p&gt;var worksheet2 = package.Workbook.Worksheets.Add("sheet2");&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to convert the rtf format to Rich Text format supported by VB.NET RTB">
      <Posts>
        <Post From="bahushekh" When="18/06/2012 15:24:58">
          <Html>
        
&lt;p&gt;I was looking for a parser type utility which can convert the RTF formatting supported by EPPlus in excel to RTF supported by Vb.NET RichetTextbox. If anyone has any suggestion or already done workaround pls let me know.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="corrupted file">
      <Posts>
        <Post From="marcot" When="10/06/2012 09:41:50">
          <Html>
        
&lt;p&gt;Is there a tool to get rid of corrupt message?&lt;/p&gt;
&lt;p&gt;If I check everything from styles, formula and still having these types of messages, what can I do?&lt;/p&gt;
&lt;p&gt;(I think there are localization problems, too..)&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;
&lt;p&gt;Marco&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="13/06/2012 12:10:13">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Look at this thread&amp;nbsp;http://epplus.codeplex.com/discussions/223843&lt;/p&gt;
&lt;p&gt;maybe it can help you.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="marcot" When="18/06/2012 14:06:56">
          <Html>
        
&lt;p&gt;Even if I save&amp;nbsp;byte[] package to the file system, when I open the excel I have the warning.. Excel warning are not helpful..&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Error: converting column into integer in excel using EPPlus (asp.net)">
      <Posts>
        <Post From="srikanthv" When="18/06/2012 06:03:16">
          <Html>
        
&lt;p&gt;I am loading data into excel from datatable using&amp;nbsp;&lt;code&gt;LoadFromDataTable&lt;/code&gt;&amp;nbsp;method then changed cell format to integer still it is showing error&amp;nbsp;&lt;strong&gt;"The number in this cell is formatted as text or preceded by apostrophe"&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;cell was showing to right side only and number format only on cell property.&lt;/p&gt;
&lt;p&gt;still I am not understanding why I am getting this error??.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;Dim&lt;/span&gt; wsManufacturing &lt;span style="color: blue;"&gt;As&lt;/span&gt; ExcelWorksheet = pck.Workbook.Worksheets.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"Manufacturing"&lt;/span&gt;)
wsManufacturing.Cells(&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;).LoadFromDataTable(dtManufacturing, &lt;span style="color: blue;"&gt;True&lt;/span&gt;)
 &lt;span style="color: blue;"&gt;Using&lt;/span&gt; col &lt;span style="color: blue;"&gt;As&lt;/span&gt; ExcelRange = wsManufacturing.Cells(2, 2, 2 + dtManufacturing.Rows.&lt;span style="color: blue;"&gt;Count&lt;/span&gt;, 2)
    col.Style.Numberformat.Format = &lt;span style="color: rgb(163, 21, 21);"&gt;"#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;"&lt;/span&gt;
    col.Style.HorizontalAlignment = ExcelHorizontalAlignment.Right
 &lt;span style="color: blue;"&gt;End&lt;/span&gt; &lt;span style="color: blue;"&gt;Using&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;pre&gt;&lt;span style='font-family: "Segoe UI","Microsoft Sans Serif",Arial,Geneva,sans-serif;'&gt;&lt;span style="white-space: normal;"&gt;&lt;br&gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img alt="error" src="http://i.stack.imgur.com/bz4Cm.jpg"&gt;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="CreateArrayFormula method">
      <Posts>
        <Post From="MikeRoach" When="30/12/2010 20:13:49">
          <Html>
        
&lt;p&gt;Hello Everyone, I am having a problem with the CreateArrayFormula method.&amp;nbsp; It does not seem to create an array formula in the final spreadsheet.&amp;nbsp; Here is test code that creates the same conditions I have been experiencing in my project.&amp;nbsp; I
 wonder if I am doing something wrong?&lt;/p&gt;
&lt;p&gt;using System;&lt;br&gt;
using System.IO;&lt;br&gt;
using OfficeOpenXml;&lt;br&gt;
using System.Diagnostics;&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
namespace EPPlus_ArrayFormula&lt;br&gt;
{&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; class Program&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; static void Main(string[] args)&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; FileInfo test = new FileInfo(@"C:\csharpTest.xlsx");&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; if (File.Exists(test.FullName))&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; File.Delete(test.FullName);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; using (ExcelPackage p = new ExcelPackage(test))&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ExcelWorksheet ws = p.Workbook.Worksheets.Add("Test");&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ws.Names.Add("bid_totals", ws.Cells["A1:F1"]);&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; // I was not sure if the = was necessary, I tried with and without it.&amp;nbsp; The result is the same.&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ws.Cells["D3"].CreateArrayFormula("=MIN(IF(bid_totals&amp;gt;0,bid_totals))");&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ws.Cells["D4"].CreateArrayFormula("MIN(IF(bid_totals&amp;gt;0,bid_totals))");&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; p.Save();&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; if (File.Exists(test.FullName))&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; if (File.Exists(@"c:\csharpTest.zip"))&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; File.Delete(@"c:\csharpTest.zip");&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; File.Copy(test.FullName, @"c:\csharpTest.zip");&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Console.WriteLine("Successful file creation.");&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; else&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Console.WriteLine("File not created.");&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Console.ReadLine();&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Process.Start(test.FullName);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
}&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I have opened and inspected the worksheet XML as detailed in the FAQ.&amp;nbsp; This is how they differ:&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Working array formula XML:&lt;/p&gt;
&lt;div&gt;
&lt;div style="text-indent: -2em; margin-left: 1em;"&gt;&lt;a href="" rel="nofollow"&gt;-&lt;/a&gt; &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;row&lt;/span&gt;&lt;span&gt; r&lt;/span&gt;&lt;span&gt;="&lt;/span&gt;&lt;strong&gt;3&lt;/strong&gt;&lt;span&gt;"&lt;/span&gt;&lt;span&gt; spans&lt;/span&gt;&lt;span&gt;="&lt;/span&gt;&lt;strong&gt;4:4&lt;/strong&gt;&lt;span&gt;"&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;
&lt;div&gt;
&lt;div style="text-indent: -2em; margin-left: 1em;"&gt;&lt;a href="" rel="nofollow"&gt;-&lt;/a&gt; &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;c&lt;/span&gt;&lt;span&gt; r&lt;/span&gt;&lt;span&gt;="&lt;/span&gt;&lt;strong&gt;D3&lt;/strong&gt;&lt;span&gt;"&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;
&lt;div&gt;
&lt;div style="text-indent: -2em; margin-left: 1em;"&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt; &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;f&lt;/span&gt;&lt;span&gt; t&lt;/span&gt;&lt;span&gt;="&lt;/span&gt;&lt;strong&gt;array&lt;/strong&gt;&lt;span&gt;"&lt;/span&gt;&lt;span&gt; ref&lt;/span&gt;&lt;span&gt;="&lt;/span&gt;&lt;strong&gt;D3&lt;/strong&gt;&lt;span&gt;"&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;&lt;span&gt;MIN(IF(bid_totals&amp;gt;0,bid_totals))&lt;/span&gt;&lt;span&gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;f&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div&gt;
&lt;div&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;v&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;&lt;span&gt;0&lt;/span&gt;&lt;span&gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;v&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span&gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;c&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div&gt;&lt;span&gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;row&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Non-working array formula XML:&lt;/p&gt;
&lt;div&gt;
&lt;div style="text-indent: -2em; margin-left: 1em;"&gt;&lt;a href="" rel="nofollow"&gt;-&lt;/a&gt; &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;row&lt;/span&gt;&lt;span&gt; r&lt;/span&gt;&lt;span&gt;="&lt;/span&gt;&lt;strong&gt;3&lt;/strong&gt;&lt;span&gt;"&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;
&lt;div&gt;
&lt;div style="text-indent: -2em; margin-left: 1em;"&gt;&lt;a href="" rel="nofollow"&gt;-&lt;/a&gt; &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;c&lt;/span&gt;&lt;span&gt; r&lt;/span&gt;&lt;span&gt;="&lt;/span&gt;&lt;strong&gt;D3&lt;/strong&gt;&lt;span&gt;"&lt;/span&gt;&lt;span&gt; s&lt;/span&gt;&lt;span&gt;="&lt;/span&gt;&lt;strong&gt;0&lt;/strong&gt;&lt;span&gt;"&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;
&lt;div&gt;
&lt;div&gt;&lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;f&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;&lt;span&gt;=MIN(IF(bid_totals&amp;gt;0,bid_totals))&lt;/span&gt;&lt;span&gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;f&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span&gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;c&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div&gt;&lt;span&gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;row&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;In order to get the working XML, I manually entered the array formula using CTRL+SHIFT ENTER.&lt;/p&gt;
&lt;p&gt;My original project is in VB under VS2008.&amp;nbsp; I wrote the test code in VS2010.&amp;nbsp; I am using Office 2007.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks for your time!&lt;/p&gt;
&lt;p&gt;Mike&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="02/01/2011 19:55:53">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I'll have a closer look at this tomorrow (I have not access to my dev. env. right now), but check out if this is a "single cell" problem. Is it working if you use two cells or more in the indexer,&amp;nbsp;like this? ...&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"D3:D4"&lt;/span&gt;].CreateArrayFormula(&lt;span style="color: rgb(163, 21, 21);"&gt;"=MIN(IF(bid_totals&amp;gt;0,bid_totals))"&lt;/span&gt;);

&lt;br&gt;&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="MikeRoach" When="03/01/2011 06:29:26">
          <Html>
        
&lt;p&gt;Hi Jan, thank you for the reply.&lt;/p&gt;
&lt;p&gt;It does work with multiple cells, as you wrote.&amp;nbsp; It appears to be a single cell problem.&lt;/p&gt;
&lt;p&gt;Mike&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="timdams" When="17/06/2012 18:28:23">
          <Html>
        
&lt;blockquote style="margin: 0.25em 1em 0px; padding: 0px 0.25em; border: 0.1em solid rgb(204, 204, 204); border-image: none; font-style: italic;"&gt;
&lt;strong&gt;jankallman wrote:&lt;/strong&gt;&lt;br&gt;
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I'll have a closer look at this tomorrow (I have not access to my dev. env. right now), but check out if this is a "single cell" problem. Is it working if you use two cells or more in the indexer,&amp;nbsp;like this? ...&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"D3:D4"&lt;/span&gt;].CreateArrayFormula(&lt;span style="color: rgb(163, 21, 21);"&gt;"=MIN(IF(bid_totals&amp;gt;0,bid_totals))"&lt;/span&gt;);

&lt;br&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/blockquote&gt;
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I was wondering if this is a bug or because I'm not using arrayformula's correctly. I know am in desperate need of adding an arrayformula to a single cell, and your workaround (i.e. extend the range) is a no go.&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="The column width and DefaultColumnWidth property">
      <Posts>
        <Post From="nangsaigon" When="14/06/2012 18:36:32">
          <Html>
        
&lt;p&gt;Hi all,&lt;/p&gt;
&lt;p&gt;After creating new Excel file, I would like to get the column width but got problem as below:&lt;/p&gt;
&lt;p&gt;The worksheet.Column(index).Width return 9.140625 and the debugger let me know that it is also the&amp;nbsp;DefaultColumnWidth. but when I opened the file, all the column widths are 8.43&lt;/p&gt;
&lt;p&gt;I just wanted to calculate the width of merged columns.&amp;nbsp;&lt;span&gt;Does any one have any ideas of what i should try&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Thanks,&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Border Color">
      <Posts>
        <Post From="brebey" When="12/06/2012 20:37:09">
          <Html>
        
&lt;p&gt;I just started using EPPlus, and it's PHENOMENAL!&amp;nbsp; Awesome tool!&amp;nbsp; However, I've been sitting here for about an hour and a half trying to figure out how to change a cell's border color, and I've given up.&lt;/p&gt;
&lt;p&gt;Any help?&amp;nbsp; How in heck do I change the border color of a cell!!&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="13/06/2012 20:48:32">
          <Html>
        
&lt;p&gt;Something like this...&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"B2:B3"&lt;/span&gt;].Style.Border.Left.Style=ExcelBorderStyle.Thin;
ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"B2:B3"&lt;/span&gt;].Style.Border.Left.Color.SetColor(Color.Red);

&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;... and the you have to do the same for Right, Top And bottom, if that's what you want.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="brebey" When="14/06/2012 00:58:25">
          <Html>
        
&lt;div&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 11pt;"&gt;FANTASTIC!!! Works beautifully!&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 11pt;"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 11pt;"&gt;Thanks a million for the help and for the tremendous product!&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 11pt;"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 11pt;"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;div&gt;
&lt;div style="border-width: 1pt medium medium; border-style: solid none none; border-color: rgb(181, 196, 223) currentColor currentColor; padding: 3pt 0in 0in; border-image: none;"&gt;
&lt;p&gt;&lt;b&gt;&lt;span style="font-family:; font-size: 10pt;"&gt;From:&lt;/span&gt;&lt;/b&gt;&lt;span style="font-family:; font-size: 10pt;"&gt; JanKallman [email removed]
&lt;br&gt;
&lt;b&gt;Sent:&lt;/b&gt; Wednesday, June 13, 2012 3:49 PM&lt;br&gt;
&lt;b&gt;To:&lt;/b&gt; bill@rebey.com&lt;br&gt;
&lt;b&gt;Subject:&lt;/b&gt; Re: Border Color [EPPlus:359351]&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 9pt;"&gt;From: JanKallman&lt;/span&gt;&lt;/p&gt;
&lt;div id="ThreadNotificationPostBody" style="margin-bottom: 24pt;"&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 9pt;"&gt;Something like this...&lt;/span&gt;&lt;/p&gt;
&lt;div&gt;
&lt;pre style="background: white;"&gt;&lt;span style="color: black; font-size: 11.5pt;"&gt;ws.Cells[&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21); font-size: 11.5pt;"&gt;"B2:B3"&lt;/span&gt;&lt;span style="color: black; font-size: 11.5pt;"&gt;].Style.Border.Left.Style=ExcelBorderStyle.Thin;&lt;/span&gt;&lt;/pre&gt;
&lt;pre style="background: white;"&gt;&lt;span style="color: black; font-size: 11.5pt;"&gt;ws.Cells[&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21); font-size: 11.5pt;"&gt;"B2:B3"&lt;/span&gt;&lt;span style="color: black; font-size: 11.5pt;"&gt;].Style.Border.Left.Color.SetColor(Color.Red);&lt;/span&gt;&lt;/pre&gt;
&lt;pre style="background: white;"&gt;&lt;span style="color: black; font-size: 11.5pt;"&gt; &lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 9pt;"&gt;... and the you have to do the same for Right, Top And bottom, if that's what you want.&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Thread safety">
      <Posts>
        <Post From="sustem" When="13/06/2012 15:05:56">
          <Html>
        
&lt;p&gt;Thank you for an excellent component!&lt;/p&gt;
&lt;p&gt;I have a problem in a production environment where the epplus component just hangs.
&lt;br&gt;
The problem occurs when performing&amp;nbsp;SaveXml in a multithreaded application on the&amp;nbsp;ExcelWorksheet object.&lt;/p&gt;
&lt;p&gt;Epplus works fine almost always but when my multithreaded app starts two excel exports simultaneously they always hang.&lt;/p&gt;
&lt;p&gt;I've entered trace info the epplus sourcecode to try to pinpoint the problem:&lt;/p&gt;
&lt;p&gt;Trace.WriteLine("before"); &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;br&gt;
UpdateRowCellData(sw); &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;br&gt;
Trace.WriteLine("after");&lt;/p&gt;
&lt;p&gt;It hangs inside UpdateRowCellData... The sw object is created with:&lt;/p&gt;
&lt;p&gt;StreamWriter sw = new StreamWriter(Part.GetStream(FileMode.Create, FileAccess.Write));&lt;/p&gt;
&lt;p&gt;I can see that one file is created in the isolatedstorage which i assume is handled by&amp;nbsp;&lt;a href="http://msdn.microsoft.com/en-us/library/system.io.packaging.package.aspx" rel="nofollow"&gt;http://msdn.microsoft.com/en-us/library/system.io.packaging.package.aspx&lt;/a&gt;.
&lt;br&gt;
(I'm not familiar with the package concept... )&lt;br&gt;
&lt;br&gt;
When reading the the link above i found: &lt;br&gt;
&lt;br&gt;
&lt;span&gt;Any public&amp;nbsp;&lt;/span&gt;&lt;span&gt;static&lt;/span&gt;&lt;span&gt;&amp;nbsp;(&lt;/span&gt;&lt;span&gt;Shared&lt;/span&gt;&lt;span&gt;&amp;nbsp;in Visual Basic) members of this type are thread safe. Any instance members are not guaranteed to be thread safe.&lt;/span&gt;&amp;nbsp;&lt;br&gt;
&lt;br&gt;
This means that the GetStream method used to aquire the&amp;nbsp;sw is not guaranteed to be thread safe.&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Does my text above make any sence? &lt;br&gt;
How can I solve or further debug this?&lt;/p&gt;
&lt;p&gt;Regards,&lt;br&gt;
Stefan Sundström&lt;/p&gt;
&lt;p&gt;&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="13/06/2012 21:00:17">
          <Html>
        
&lt;p&gt;hmm, yes, the package api doesn't seem to be thread safe, for some strange reason (and you can't only use the static methods).&amp;nbsp;I haven't deep dived into this subject, but my guess is that this is related to isolated storage, so you will probably only
 notice this on quite large spreadsheet.&amp;nbsp;I have no good idea how to solve this, but I will have a look at it when I get some time over, and get back to you. If you find something out, please let me know.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="13/06/2012 21:23:11">
          <Html>
        
&lt;p&gt;I've done a little research too and for now I think the only way is change&amp;nbsp;&lt;span&gt;System.IO.Packaging&lt;/span&gt; to another one, like donetzip, but it isnt a simple task, there are a high coupling between epplus and packaging api. I tried two months ago
 because my hosting provider have trouble with isolated storage.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Excel saved by EPPlus has problem">
      <Posts>
        <Post From="novenyang" When="05/06/2012 10:42:04">
          <Html>
        
&lt;p&gt;hi,&lt;/p&gt;
&lt;p&gt;when I load data using sheet.cells["A1"]&lt;span&gt;.&lt;/span&gt;&lt;span&gt;LoadFromDataTable&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;_sourceDataTable&lt;span&gt;,&lt;/span&gt;&amp;nbsp;false,&amp;nbsp;TableStyles&lt;span&gt;.&lt;/span&gt;Custom&lt;span&gt;);&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;and save the package, the excel file could not be opened again by EPPlus, and when I use Excel to open the file, it shows error message.&lt;/p&gt;
&lt;p&gt;but when I use&amp;nbsp;sheet.cells["A1"].LoadFromDataTable(_sourceDataTable,&amp;nbsp;false); &amp;nbsp;-- without the 3rd parameter, the file can be re-opened by both EPPlus and Excel without problem.&lt;/p&gt;
&lt;p&gt;I assume the TableStyles parameter may have caused some problem.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="13/06/2012 20:45:39">
          <Html>
        
&lt;p&gt;Yes, TableStyles.Custom requires you to set valid a custom StyleName on the table. (and that requires you to have a template. You can't add custom table styles in EPPlus in the current release.)&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="EEPus - Set cell to format as datetime.">
      <Posts>
        <Post From="shawleigh17" When="29/05/2012 17:39:21">
          <Html>
        
&lt;p&gt;Hello, I am trying to get a cell to show up as a datetime: mm/dd/yyyy hh:mm. I have tried to use the predefined style 22 (out of the 164 predefined styles), but I may not be doing this correctly. I keep getting an index out of range error. How do I set a
 cell to have the correct format in C#, in the code behind file?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Here is what I had: ws.Column(47).Style.XfId = 22;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JasonSTX" When="30/05/2012 20:14:12">
          <Html>
        
&lt;p&gt;try &lt;span&gt;ws.Column(47).&lt;/span&gt;Style.Numberformat.Format = "mm/dd/yyyy";&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Force ColumnFormat to &quot;TEXT&quot;">
      <Posts>
        <Post From="jessehouwing" When="29/11/2010 16:29:28">
          <Html>
        
&lt;p&gt;Can I set the numberformat to TEXT?&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I want to force a number of columns to always show text. I cannot find what value I should provide to get this to work...&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Jesse&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="29/11/2010 16:35:18">
          <Html>
        
&lt;p&gt;Do you want to show a number as a text ?&lt;/p&gt;
&lt;p&gt;Maybe you can try to use formula...something like that:&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ws.Cells[1, 1].Formula = "TEXT(\"" + 2+ "\",\"#\")";&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jessehouwing" When="29/11/2010 16:39:38">
          <Html>
        
&lt;p&gt;Turns out setting the Formatstring to "@" does the trick :D&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="calbert1970" When="04/04/2012 17:17:07">
          <Html>
        
&lt;p&gt;Hi &lt;span&gt;Jesse&lt;/span&gt;, please could you tell us what object the property Formatstring belogs to? Or do you mean&amp;nbsp;ws.Column(i).Style.Numberformat.Format = "@";&lt;/p&gt;
&lt;p&gt;Thanks, Carlos.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jessehouwing" When="04/04/2012 17:41:29">
          <Html>
        
&lt;p&gt;Have to dig a bit.. I'm not on this project any more, so I'll have to do this from memory...But I think you're right. Setting that field should do it.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="cnboland" When="30/05/2012 19:15:16">
          <Html>
        
&lt;p&gt;I found the "@" format in the&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;myPkg.Workbook.Styles.NumberFormats
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;collection. It doesn't have a specific name for referencing (that I can see), but Excel 2010 interprets the format as Text.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Wrong Library Version?">
      <Posts>
        <Post From="Audor27" When="29/05/2012 22:01:52">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I tried to apply this example in &amp;nbsp;Visual studio2008 C#:&lt;br&gt;
&lt;a href="http://epplus.codeplex.com/discussions/258920" rel="nofollow"&gt;http://epplus.codeplex.com/discussions/258920&lt;/a&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;    &lt;span style="color: blue;"&gt;using&lt;/span&gt; (ExcelPackage pck = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage())
            {
                &lt;span style="color: blue;"&gt;foreach&lt;/span&gt; (DataTable tbl &lt;span style="color: blue;"&gt;in&lt;/span&gt; dataSet.Tables)
                {
                    ExcelWorksheet ws = pck.Workbook.Worksheets.Add(tbl.TableName);
                    ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;].LoadFromDataTable(tbl, &lt;span style="color: blue;"&gt;true&lt;/span&gt;);
                }

                HttpResponse Response = System.Web.HttpContext.Current.Response;
                pck.SaveAs(Response.OutputStream);
                Response.ContentType = &lt;span style="color: rgb(163, 21, 21);"&gt;"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"&lt;/span&gt;;
                Response.AddHeader(&lt;span style="color: rgb(163, 21, 21);"&gt;"content-disposition"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"attachment;  filename=Sample1.xlsx"&lt;/span&gt;);
            }
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;But i get an error on the constructor of ExcelPackage:&lt;br&gt;
Cannot resolve constructor 'ExcelPackage' candidates are:&lt;br&gt;
ExcelPackage(System.IO.FileInfo) (in class ExcelPackage)&lt;br&gt;
ExcelPackage(System.IO.FileInfo,&amp;nbsp;System.IO.FileInfo) (in class ExcelPackage)&lt;br&gt;
&lt;br&gt;
Also the object ExcelWorkSheet does not have the method 'SaveAs' only 'Save', I have referenced this dll on my project:&lt;/p&gt;
&lt;p&gt;EPPlus 3.0.0.2&lt;br&gt;
&lt;br&gt;
namespace:&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(0, 0, 255);"&gt;using&lt;/span&gt; OfficeOpenXml;&lt;br&gt;
&lt;br&gt;
Please take me out of my ignorance and excuse my english.&lt;/p&gt;
&lt;p&gt;&lt;br&gt;
Thanks in advance.&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Audor27" When="30/05/2012 00:52:44">
          <Html>
        
&lt;p&gt;I just downloaded&amp;nbsp;EPPlus 3.0.&lt;/p&gt;
&lt;p&gt;Reference to it and&amp;nbsp;now it works.&lt;br&gt;
&lt;br&gt;
Thank you very much for your hard work on this library.&amp;nbsp;&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Chart Object Positioning properties implemented ?">
      <Posts>
        <Post From="crotchy" When="29/05/2012 10:15:55">
          <Html>
        
&lt;p&gt;Hi&lt;/p&gt;
&lt;p&gt;firstly many thanks for your efforts on this library - it really is great.&lt;/p&gt;
&lt;p&gt;Can you tell me whether the Chart -&amp;gt; Format Chart Area -&amp;gt; Object Positioning properties are implemented in EPPlus ??&amp;nbsp; Ive had a good look through the doco and cant find anything.&lt;/p&gt;
&lt;p&gt;Specifically I want to stop a Chart collapsing when the user filters rows using the dropdownlist in the header. ie I want to programmatically set 'Dont move or size with cells'&lt;/p&gt;
&lt;p&gt;Many tia&lt;/p&gt;
&lt;p&gt;crotchy&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Field buttons in pivot charts">
      <Posts>
        <Post From="warnestam" When="24/05/2012 11:50:17">
          <Html>
        
&lt;p&gt;Hi and thanks for your great component!&lt;/p&gt;
&lt;p&gt;I&amp;nbsp; have created a chart with a pivot table as source. I would like to add buttons to the chart (description field, axis field and value field). Is this possible in the current version?&lt;/p&gt;
&lt;p&gt;Best regards&lt;/p&gt;
&lt;p&gt;Robert Warnestam&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Exporting chart from exel sheet (temp.xlsx) to presentation (temp.pptx)">
      <Posts>
        <Post From="pranay9th" When="21/05/2012 11:16:18">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;My requirement is to generate a chart in spreadsheet from data base data. And then extract chart from spreadsheet to presentation (temp.pptx) file.&lt;/p&gt;
&lt;p&gt;I am able to generated the chart in spreadsheet sucessfully.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;But when I exported chart to presentation it's comming as blank (blank plot area without any chart series).&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;When I try to dignose the issue. I found that in spread sheet chart.xml only have reference of data in data sheet. not the actual data nodes.&lt;/p&gt;
&lt;p&gt;Can any one help me in solving this issue.&lt;/p&gt;
&lt;p&gt;All above coding is done in c# dot Net.&lt;/p&gt;
&lt;p&gt;Thanks,&lt;/p&gt;
&lt;p&gt;Pranay&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Delete Comment in Excel Cell">
      <Posts>
        <Post From="emendezrivas" When="28/12/2011 21:34:00">
          <Html>
        
&lt;p&gt;Hello everyone,&lt;/p&gt;
&lt;p&gt;Is there a way to delete a comment in a cell? I have tried the Reset() and Clear() method of the ExcelRange class, but it does not work.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jamiebarrow" When="21/05/2012 11:15:18">
          <Html>
        
&lt;blockquote style="margin: 0.25em 1em 0px; padding: 0px 0.25em; border: 0.1em solid rgb(204, 204, 204); border-image: none; font-style: italic;"&gt;
&lt;strong&gt;emendezrivas wrote:&lt;/strong&gt;&lt;br&gt;
&lt;p&gt;Hello everyone,&lt;/p&gt;
&lt;p&gt;Is there a way to delete a comment in a cell? I have tried the Reset() and Clear() method of the ExcelRange class, but it does not work.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;On the worksheet, there is a Comments collection, which you can use to remove the comments using the .Remove and .RemoveAt methods.&lt;/p&gt;
&lt;p&gt;I have found an issue with trying to clear out all comments for a sheet though, for example:&lt;/p&gt;
&lt;pre style="padding-left: 30px;"&gt;&lt;span style="color: blue;"&gt;while&lt;/span&gt; (_sheet.Comments.Count &amp;gt; 0)
{
    _sheet.Comments.RemoveAt(0);
}
&lt;/pre&gt;
&lt;p&gt;And get the below error that it can't find the key. My problem is that it doesn't always happen, only in some cases.&lt;/p&gt;
&lt;p style="padding-left: 30px;"&gt;&lt;span&gt;[Exception: Key does not exist] OfficeOpenXml.RangeCollection.Delete(UInt64 key)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;I posted a question to StackOverflow regarding this, see [ http://stackoverflow.com/questions/10684372/removing-clearing-comments-in-excel-with-epplus ]&lt;br&gt;
&lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Chart Source Data">
      <Posts>
        <Post From="paulw85" When="30/10/2011 19:54:34">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Firstly let me say great work on the library, it's really cool.&lt;/p&gt;
&lt;p&gt;I'm trying to figure out if Ep-plus can be used to&amp;nbsp;achieve&amp;nbsp;the following - my gut is telling me no but hopefully I'm wrong.&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I have an Excel template which has a chart in it. I'm using Epplus to insert the data for the chart into a&amp;nbsp;particular&amp;nbsp;tab. I need to ideally change the source data address for the chart to update it to the new range for the data i.e. A1:B16 (if
 there were 16 data rows of data on this&amp;nbsp;particular&amp;nbsp;export).&lt;/p&gt;
&lt;p&gt;The number of data rows will be unpredictable as it's the result of what filter criteria are passed to a query that gets the data.&lt;/p&gt;
&lt;p&gt;Many Thanks&lt;/p&gt;
&lt;p&gt;- Paul&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="paulw85" When="31/10/2011 15:58:38">
          <Html>
        
&lt;p&gt;For a pie chart, the solution was to pass the new range into the ExcelChart.Series[0].Series field the new range as a string "Sheet1!$A$1:$A$6".&lt;/p&gt;
&lt;p&gt;However, to update the category labels you also need to pass in the new range for these into the XSeries field i.e. ExcelChart.Series[0].XSeries = "Sheet1!$B$1:$B$6".&lt;/p&gt;
&lt;p&gt;There is a bug in the source code however that if you pass a string into the XSeries property it malforms the XML. This bug is alluded to in this post:&lt;/p&gt;
&lt;p&gt;&lt;span style="font-size: 11pt;"&gt;&lt;a href="http://epplus.codeplex.com/workitem/13128" rel="nofollow"&gt;http://epplus.codeplex.com/workitem/13128&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-size: 11pt;"&gt;The above fix would have to be applied to fix the problem.&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="03/11/2011 16:50:21">
          <Html>
        
&lt;p&gt;Ok, thanks, I'll have a look at it.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="pranay9th" When="18/05/2012 09:02:39">
          <Html>
        
&lt;blockquote style="margin: 0.25em 1em 0px; padding: 0px 0.25em; border: 0.1em solid rgb(204, 204, 204); border-image: none; font-style: italic;"&gt;
&lt;strong&gt;JanKallman wrote:&lt;/strong&gt;&lt;br&gt;
&lt;p&gt;Ok, thanks, I'll have a look at it.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;br&gt;
Hi,&lt;/p&gt;
&lt;p&gt;I was also trying somthing of same kind.&lt;/p&gt;
&lt;p&gt;I have a spreadsheet with 2 sheets of data table, 4-5 sheets of different types of chart template sheet&lt;/p&gt;
&lt;p&gt;I have faced 2 problem.&lt;/p&gt;
&lt;p&gt;&lt;a&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;1. When simpling following code:&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;using&lt;/span&gt; (ExcelPackage exl = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(file))
           {
               &lt;span style="color: blue;"&gt;try&lt;/span&gt;
               {
                   exl.SaveAs(outfile);
               }
               &lt;span style="color: blue;"&gt;catch&lt;/span&gt; (Exception ex)
               { 
               }
           }
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;It's giving me error as "{"Index was out of range. Must be non-negative and less than the size of the collection.\r\nParameter name: index"}"&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Is there somthing wrong with above code.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;strong&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/span&gt;2.
 I removed some of the Chart sheets then tried same thing now there is no error. ﻿﻿But next step is I need to get the chart part from those chart sheets and add reng data from other sheets.For this Can any one let me know how to get the ChartDrawing part from
 a sheet.&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;  &lt;span style="color: blue;"&gt;using&lt;/span&gt; (ExcelPackage exl = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(file))
           {
               &lt;span style="color: blue;"&gt;try&lt;/span&gt;
               {
                   &lt;span style="color: blue;"&gt;var&lt;/span&gt; sheet = exl.Workbook.Worksheets.FirstOrDefault(sh =&amp;gt; sh.Name == &lt;span style="color: rgb(163, 21, 21);"&gt;"ColumnChart"&lt;/span&gt;);
                   &lt;span style="color: blue;"&gt;var&lt;/span&gt; chart = sheet.Drawings.  &lt;span style="color: green;"&gt;//Stuck here on how to get chart part from sheet.&lt;/span&gt;
                   exl.SaveAs(outfile);
               }
               &lt;span style="color: blue;"&gt;catch&lt;/span&gt; (Exception ex)
               { 
               }
           }&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Worksheet is not recognized">
      <Posts>
        <Post From="srikiarya" When="18/05/2012 07:29:32">
          <Html>
        
&lt;p&gt;Hi we are facing an issue in reading excel file, where the workbook is detected and worksheets are not read it is showing as&amp;nbsp;workBook.Worksheets.Count 0 which was not the case earlier it worked brilliant but dont know what is the issue now. &amp;nbsp;Please
 provide solution to solve this issue.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="I get a compile error with the source code">
      <Posts>
        <Post From="ravivulli" When="15/05/2012 17:20:07">
          <Html>
        
&lt;p&gt;Hello,&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &amp;nbsp; I am getting the following compilation error, please help me.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;"The type or namespace name 'Dxf' does not exists in the namespace 'OfficeOpenXmlStyle' (are you missing an assembly reference?)&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks,&lt;/p&gt;
&lt;p&gt;Ravi&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="16/05/2012 08:06:53">
          <Html>
        
&lt;p&gt;Sorry about that, fixed in latest changeset.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Gradient in version 3.0">
      <Posts>
        <Post From="nottoc" When="04/05/2012 05:57:02">
          <Html>
        
&lt;p&gt;The readme for the version 3.0 I just downloaded says gradients were added. I would appreciate some help in using them.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="15/05/2012 20:21:36">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Heres a samples from the test project...&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;&lt;pre&gt;var ws = _pck.Workbook.Worksheets.Add("Fills");

ws.Cells["A1:C3"].Style.Fill.Gradient.Type = ExcelFillGradientType.Linear;
ws.Cells["A1:C3"].Style.Fill.Gradient.Color1.SetColor(Color.Red);
ws.Cells["A1:C3"].Style.Fill.Gradient.Color2.SetColor(Color.Blue);

ws.Cells["A1"].Style.Fill.PatternType = ExcelFillStyle.MediumGray;
ws.Cells["A1"].Style.Fill.BackgroundColor.SetColor(Color.ForestGreen);
var r=ws.Cells["A2:A3"];
r.Style.Fill.Gradient.Type = ExcelFillGradientType.Path;
r.Style.Fill.Gradient.Left = 0.7;
r.Style.Fill.Gradient.Right = 0.7;
r.Style.Fill.Gradient.Top = 0.7;
r.Style.Fill.Gradient.Bottom = 0.7;
            
ws.Cells[4,1,4,360].Style.Fill.Gradient.Type = ExcelFillGradientType.Path;

for (double col = 1; col &amp;lt; 360; col++)
{                
    r = ws.Cells[4, Convert.ToInt32(col)];
    r.Style.Fill.Gradient.Degree = col;
    r.Style.Fill.Gradient.Left = col / 360;
    r.Style.Fill.Gradient.Right = col / 360;
    r.Style.Fill.Gradient.Top = col / 360;
    r.Style.Fill.Gradient.Bottom = col / 360;
}
r = ws.Cells["A5"];
r.Style.Fill.Gradient.Left = .50;
&lt;/pre&gt;
&lt;/span&gt; Jan&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to iterate over a range of cells">
      <Posts>
        <Post From="mese79" When="02/05/2012 21:05:26">
          <Html>
        
&lt;p&gt;Hi&lt;/p&gt;
&lt;p&gt;At first thanks for the great library.&lt;/p&gt;
&lt;p&gt;Here is my problem:&lt;/p&gt;
&lt;p&gt;I want to select a range of worksheet cells and iterate on them, but not in 'foreach cell' way.&lt;/p&gt;
&lt;p&gt;I use code like:&lt;/p&gt;
&lt;p&gt;var range = sheet.cells["C1:D10"];&lt;br&gt;
for(int i=1; i&amp;lt;range.End.Row; i++)&lt;br&gt;
{&lt;br&gt;
&amp;nbsp; &amp;nbsp;Console.WriteLine("{0} = {1}", range[i, 1].Address, range[i, 1].Value.toString());&lt;br&gt;
}&lt;/p&gt;
&lt;p&gt;But i'v got strange result:&lt;/p&gt;
&lt;p&gt;A1 = "a1 value"&lt;/p&gt;
&lt;p&gt;Why?!&lt;/p&gt;
&lt;p&gt;Actually i want loop through the rows of a range, not each cell.&lt;/p&gt;
&lt;p&gt;Thanks.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="15/05/2012 20:14:50">
          <Html>
        
&lt;p&gt;The range indexer uses absolute rows and cols for the entire sheet, so I&amp;nbsp;guess you shoud set
&lt;em&gt;i&lt;/em&gt; to range.Start.Row instead of 1.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="it does not support windows phone.">
      <Posts>
        <Post From="videni" When="14/05/2012 12:05:11">
          <Html>
        
&lt;p&gt;I 've spent a whole day to find the library that can process the excel file in windows phone 7,finally,i get &amp;nbsp;an &amp;nbsp;excellent one,but can't support windows phone 7 , if you build it using windows phone runtime,that would be great.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="the excel 2007 xlsx rows is limlited in 65535 when i use epplus3.o to export data from access db to excel">
      <Posts>
        <Post From="pinglj2004" When="14/05/2012 06:51:12">
          <Html>
        
&lt;p&gt;hi,all, this is a issue i encounted, but i don't know how to resolve it,&amp;nbsp; who can help me ?&lt;/p&gt;
&lt;p&gt;the record number in acccess db is more than 110000, but the result exported to excel is 65535, i don't know why? the excel format i defined is xlsx. i think it should be excel 2007?&lt;/p&gt;
&lt;p&gt;i got some knowledge , the rows in excel2007 should be more than 65535. why there is only 65535 rows exported to excel in this case. who can help me ???&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;the code is as following:&lt;/p&gt;
&lt;p&gt;using OfficeOpenXml;&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
namespace Parse&lt;br&gt;
{&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; public class parsedata&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; string sEntryDir = "D:/downloadv2/";&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; string month = "201205";&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; public void ExportToexcel2007xlsx(DataTable table, string filen, string sheetn)&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; MemoryStream rmemstream = CreateByExcelLibrary(table, sheetn);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; FileStream fs = new FileStream(filen, FileMode.OpenOrCreate);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; BinaryWriter w = new BinaryWriter(fs);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; w.Write(rmemstream.ToArray());&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; fs.Close();&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; rmemstream.Close();&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; MemoryStream CreateByExcelLibrary(DataTable table, string sheetn)&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; using (ExcelPackage package = new ExcelPackage())&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ExcelWorksheet sheet = package.Workbook.Worksheets.Add(sheetn);&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; int colCount = table.Columns.Count;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Console.WriteLine("column: " + colCount);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; for (int i = 0; i &amp;lt; colCount; i++)&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; sheet.Cells[1, i + 1].Value = table.Columns[i].Caption;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; int k = 2;&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; foreach (DataRow row in table.Rows)&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; for (int i = 0; i &amp;lt; colCount; i++)&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; sheet.Cells[k, i + 1].Value = row[i];&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; k++;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Console.WriteLine("&amp;nbsp; ---&amp;gt;&amp;nbsp; "+k);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; MemoryStream ms = new MemoryStream();&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; package.SaveAs(ms);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; return ms;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; private void HandleExport()&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Console.WriteLine("start to load excel...");&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; int tablepage = 1;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; month = "201204";&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Thread.Sleep(10);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; string tablen = "ParseLP" + month + tablepage.ToString();&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; DataTable souraccd = dbAccessInstance.GetParseFromAccessDb(tablen);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; if (souraccd != null)&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Console.WriteLine("return records num: " + souraccd.Rows.Count); //the records is 110000&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; string filename = sEntryDir + month + tablepage.ToString() + ".xlsx";&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; string sheetn = "sheet1";&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Console.WriteLine("start to load..:" + tablen);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ExportToexcel2007xlsx(souraccd, filename, sheetn);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Console.WriteLine("succeed to load :" + tablen);&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Thread.Sleep(1);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
}&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="InsertRow not working...">
      <Posts>
        <Post From="namit101" When="13/05/2012 21:39:31">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I am having some trouble trying to insert a row into sheets (using the latest version of EPPlus). &amp;nbsp;Any ideas on what the issue might be?&lt;/p&gt;
&lt;p&gt;I get the Error:&lt;/p&gt;
&lt;p&gt;Specified argument was out of the range of valid values.Parameter name: Start cell Address must be less or equal to End cell address&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;This is the code:&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;                MemoryStream ms = &lt;span style="color: blue;"&gt;new&lt;/span&gt; MemoryStream();
                &lt;span style="color: blue;"&gt;byte&lt;/span&gt;[] template = ModelBuilder.Properties.Resources.template;
                ms.Write(template, 0, template.Length);

                FileStream fs = &lt;span style="color: blue;"&gt;new&lt;/span&gt; FileStream(outputFileLoc, FileMode.Create);
                p = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(fs, ms);

                p.Workbook.Worksheets[&lt;span style="color: rgb(163, 21, 21);"&gt;"myname"&lt;/span&gt;].Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"test"&lt;/span&gt;;
                p.Workbook.Worksheets[&lt;span style="color: rgb(163, 21, 21);"&gt;"myname"&lt;/span&gt;].Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"B1"&lt;/span&gt;].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"test"&lt;/span&gt;;
                p.Workbook.Worksheets[&lt;span style="color: rgb(163, 21, 21);"&gt;"myname"&lt;/span&gt;].InsertRow(1, 1);
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;And this is the stacktrace:&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &amp;nbsp;at OfficeOpenXml.ExcelAddressBase.Validate()&amp;nbsp; &amp;nbsp;at OfficeOpenXml.ExcelAddressBase.SetAddress(String address)&amp;nbsp; &amp;nbsp;at OfficeOpenXml.ExcelAddress.set_Address(String value)&amp;nbsp; &amp;nbsp;at OfficeOpenXml.ExcelRange.get_Item(String
 Address)&amp;nbsp; &amp;nbsp;at OfficeOpenXml.ExcelWorksheet.AddFormulas(List`1 added, Int32 position, Int32 rows)&amp;nbsp; &amp;nbsp;at OfficeOpenXml.ExcelWorksheet.FixSharedFormulasRows(Int32 position, Int32 rows)&amp;nbsp; &amp;nbsp;at OfficeOpenXml.ExcelWorksheet.InsertRow(Int32
 rowFrom, Int32 rows, Int32 copyStylesFromRow)&amp;nbsp; &amp;nbsp;at OfficeOpenXml.ExcelWorksheet.InsertRow(Int32 rowFrom, Int32 rows)&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="namit101" When="14/05/2012 00:26:56">
          <Html>
        
&lt;p&gt;Figured out the problem. &amp;nbsp;There was a defined name cell it couldn't find (fyi).&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Chinese Characters">
      <Posts>
        <Post From="thebat" When="10/05/2012 20:10:40">
          <Html>
        
&lt;p&gt;I am new to ASP.Net (C#) and have spent all day trying to View Chinese characters within a Excel File created using EPPlus.&lt;/p&gt;
&lt;p&gt;To cut my story short,&amp;nbsp; I am storing data in a database using form in Classic ASP.&amp;nbsp; The content Type is either iso-8859-1 or utf-8 (codepage 1252).&amp;nbsp; The database fields are of NVarchar type (Latin 1)&lt;/p&gt;
&lt;p&gt;Unfortuanatly I am unable to retain the same characters the user entered on the form within the Excel file.&amp;nbsp; I can view them on the HTML page.&lt;/p&gt;
&lt;p&gt;I have tried many different methods of converting the data (System.Text.Encoding, System.Web.HttpUtility.UrlDecode ect).&amp;nbsp; All of which does not resolve the issue.&lt;/p&gt;
&lt;p&gt;Does anyone know to do this&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="TextRotation = 90">
      <Posts>
        <Post From="martinovallara" When="09/05/2012 08:22:23">
          <Html>
        
&lt;p&gt;&lt;span&gt;I can not&lt;/span&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;span&gt;make it work&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;span&gt;What's wrong&lt;/span&gt;&lt;span&gt;?&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;    &lt;span style="color: blue;"&gt;With&lt;/span&gt; Cell
                .Value = value
                .Style.Font.Bold = &lt;span style="color: blue;"&gt;True&lt;/span&gt;
                .Style.TextRotation = 90
    &lt;span style="color: blue;"&gt;End&lt;/span&gt; &lt;span style="color: blue;"&gt;With&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;The Rotation still 0° :-)&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="09/05/2012 15:12:33">
          <Html>
        
&lt;p&gt;I 've tested with lastest version, no problem here =)&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Searching For Blank Cells in a range">
      <Posts>
        <Post From="nlacoff" When="06/05/2012 16:32:23">
          <Html>
        
&lt;p&gt;I am trying to use EPPlus as a validation tool (for example check if there are any blank cells in a range).&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I have a sheet with 25,000 rows and a column Column H) that contains about 2000 inter-dispersed blank cells. &amp;nbsp;&lt;/p&gt;
&lt;p&gt;Using LINQ, I have tried worksheet.Cells["H:H"].Where(m=&amp;gt;m.Value == null).&amp;nbsp; After not being able to get that to work, I noticed that doing worksheet.Cells["H:H"].Count() will only return 23000 cells (omitting the blanks by default).&amp;nbsp;
 Is the only way to handle identification of blank cells in a range is not to use LINQ but&amp;nbsp; to iterate over the range and check each cell or is there a function or method that I have missed that allows one to use LINQ&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Change Address of ExcelTable">
      <Posts>
        <Post From="Lokich" When="05/05/2012 10:56:28">
          <Html>
        
&lt;p&gt;Hello.&lt;/p&gt;
&lt;p&gt;I getting some data from database, and put in on ExcelTable, but i can't change Address, because this property is get; only. Can i change Address of ExcelTable object?&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Pivot table column Labels order">
      <Posts>
        <Post From="EdHogan" When="04/05/2012 15:58:47">
          <Html>
        
&lt;p&gt;Hello&lt;br&gt;
Sweet product. &lt;br&gt;
&lt;br&gt;
I've added a column to my pivot table&lt;br&gt;
pivotTable1.ColumnFields.Add(pivotTable1.Fields["RESOLUTION_STATUS"]);&lt;br&gt;
I've set the data to display by columns&lt;br&gt;
pivotTable1.DataOnRows = false;&lt;br&gt;
&lt;br&gt;
When I open in Excel and view the field list, my new column that I created displays first in the "Column Labels" section followed by the "Values".&lt;br&gt;
&lt;br&gt;
For presentation I would like the "Values" to be first and my new column to be 2nd. Can you tell me if I can control this and how.&lt;br&gt;
&lt;br&gt;
thnx&lt;br&gt;
&lt;br&gt;
ED&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Version 2.9 versus 3.0 Line Chart Formatting">
      <Posts>
        <Post From="BarbaraMorris" When="18/04/2012 20:54:46">
          <Html>
        
&lt;p&gt;I had version 2.9 installed and created a line chart with three lines and everything printed correctly.&amp;nbsp; Then I installed version 3.0 so I could add different markers for each line and the chart changed how it displayed.&amp;nbsp; One of the lines marked
 out what was estimated for a project and had numbers in each column.&amp;nbsp; The second and third lines only had information out to the current values.&amp;nbsp;&amp;nbsp;&amp;nbsp;Before the upgrade the second and third lines stopped printing at the current values but
 after the upgrade the the third line dropped to zero.&amp;nbsp; I know I can fix this by selecting the line and modifying the Hidden and Empty Cell settings but this will not work for my application users.&amp;nbsp; Is there a way to get this to print correctly in
 the new version?&amp;nbsp; I have included both examples of the code.&amp;nbsp; Any help would be greatly appreciated.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div id="_mcePaste" style="left: -10000px; top: 0px; width: 1px; height: 1px; overflow: hidden;"&gt;
﻿&lt;/div&gt;
&lt;pre&gt;Version 2.9

var series1 = wsChart.Series.Add("B29:N29", "B27:N27");
var series2 = wsChart.Series.Add(
    ExcelRange.GetAddress(30, 2, 30, iMonth + 2), ExcelRange.GetAddress(27, 2, 27, iMonth + 2));
var series3 = wsChart.Series.Add(
    ExcelRange.GetAddress(31, 2, 31, iMonth + 2), ExcelRange.GetAddress(27, 2, 27, iMonth + 2));


Version 3.0
var series1 = (wsChart.Series.Add("B29:N29", "B27:N27") as ExcelLineChartSerie);series1.Marker = eMarkerStyle.Diamond;
                                               
var series2 = (wsChart.Series.Add("B30:N30", "B27:N27") as ExcelLineChartSerie);
series2.Marker = eMarkerStyle.Square;

var series3 = (wsChart.Series.Add("B31:N31", "B27:N27") as ExcelLineChartSerie);
series3.Marker = eMarkerStyle.Triangle;
&lt;/pre&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="02/05/2012 19:28:12">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I made some changes due to differences between Excel 2007 and 2010. I'm not sure if this is an bug after these changes, so could you create an issue with your code and the workbook (you&amp;nbsp;can mail&amp;nbsp;workbook to
&lt;a href="mailto:epplusdocs@gmail.com" rel="nofollow"&gt;epplusdocs@gmail.com&lt;/a&gt;&amp;nbsp;if&amp;nbsp;you dont&amp;nbsp;want to expose the data).&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Add worksheet from one workbook to another.">
      <Posts>
        <Post From="Jeff_Schuler" When="27/04/2012 17:03:37">
          <Html>
        
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I'm getting a index out of range when trying to copy a worksheet from one workbook to another.&amp;nbsp; I'm using two different packages.&amp;nbsp; Is this possible?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;templatePackage.Workbook.Worksheets.Add(SpreadsheetTabs.RESULTS, package.Workbook.Worksheets[SpreadsheetTabs.RESULTS]);
&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="02/05/2012 19:19:30">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;It's intended to work (in the latest version).&lt;/p&gt;
&lt;p&gt;Create an issue with your code and the workbooks so I can have a look at it'&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Save the results of the command to a package">
      <Posts>
        <Post From="MasterZZZZ" When="28/04/2012 11:02:08">
          <Html>
        
&lt;p&gt;Hi, how can I save the results of the command to a package?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;SqlDataAdapter da = new SqlDataAdapter(command);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; DataSet ds = new DataSet();&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; da.Fill(ds);&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; FileInfo newFile = new FileInfo(@"C:\Test.xlsx");&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; OfficeOpenXml.ExcelPackage package = new ExcelPackage(newFile);&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ExcelWorksheet ws = package.Workbook.Worksheets.Add("Content");&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;br&gt;
&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="02/05/2012 19:17:22">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Use the ws.Cells["A1"].LoadFromDataTable method (to start loading in cell A1), using the datatable in your dataset.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="This operation is not supported for a relative URI. (Again)">
      <Posts>
        <Post From="PjOoPnE" When="25/04/2012 16:04:40">
          <Html>
        
&lt;p&gt;I know there's already a dead thread about this, but I thought I would create a new one to see if anyone has an answer for this. &amp;nbsp;I'm trying to open an xlsx file, that has an embedded URI \\servername\foldername\file.xlsx. &amp;nbsp;So I'm trying to open
 the file thusly:&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;pre&gt;using (ExcelPackage package = new ExcelPackage(new FileInfo(excelWorkbookFileName)))
{
&lt;span style="white-space: pre;"&gt;	&lt;/span&gt;ExcelWorksheet worksheet = package.Workbook.Worksheets[1]; // Crashes here

        string v = (string)worksheet.Cells[1,1].Value;

}&lt;/pre&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;On the line marked "Crashes here" I get the following error: &amp;nbsp;This operation is not supported for a relative URI.&lt;/p&gt;
&lt;p&gt;My Workaround is to use ExcelPackage since it seems to be able to open the file correctly. &amp;nbsp;However, I'm nervous about sticking with this because it hasn't been updated in several years.&lt;/p&gt;
&lt;p&gt;Any help will be greatly appreciated!&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Cheers, Jon&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="02/05/2012 19:13:16">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Yes, it's a bug. I'll add a fix next time i check in.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Columns in epplus">
      <Posts>
        <Post From="bhavtoshsharma" When="25/04/2012 09:44:38">
          <Html>
        
&lt;p&gt;hi all,&lt;/p&gt;
&lt;p&gt;how do i iterate thru all columns in worksheet object? i want to check if a column exist with a specific name...&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="02/05/2012 19:12:16">
          <Html>
        
&lt;p&gt;If you want to iterate all cells in a worksheet, use..&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;foreach&lt;/span&gt;(&lt;span style="color: blue;"&gt;var&lt;/span&gt; cell &lt;span style="color: blue;"&gt;in&lt;/span&gt; worksheet.Cells)

&lt;span style="color: green;"&gt;//or use...&lt;/span&gt;

Worksheet.Dimensions  &lt;span style="color: green;"&gt;//...to get the boundry of the worksheet&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Gridview to excel with styling">
      <Posts>
        <Post From="digimanus" When="24/04/2012 14:55:52">
          <Html>
        
&lt;p&gt;Hello All,&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I have managed to have my gridviews exported to Excel 2007 (and up) via EPPlus. Only the styling is gone. My HeaderStyle backcolor is gone etc. How to fix this?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="02/05/2012 19:06:59">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I'm note sure what you do, but you have to set the styling yourself for the range you want to style.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Conditional Formatting">
      <Posts>
        <Post From="Timmyag" When="17/04/2012 22:27:08">
          <Html>
        
&lt;p&gt;I'm quite new to EPPlus and working with XML and&amp;nbsp;I&amp;nbsp;needed to do quite a lot of conditional&amp;nbsp;formatting, I had seen one post on how to do it but it seemed rather hard so partly for my own understanding and partly for my&amp;nbsp;&amp;nbsp;own&amp;nbsp;purposes&amp;nbsp;I&amp;nbsp;created
 a&amp;nbsp;class&amp;nbsp;to let me do it&amp;nbsp;easily&amp;nbsp;and quickly. Having almost finished&amp;nbsp;I&amp;nbsp;though i would give back so if any one else can find this&amp;nbsp;useful&amp;nbsp;feel free. I will update it when&amp;nbsp;I&amp;nbsp;come across bugs.&lt;/p&gt;
&lt;p&gt;Disclaimer, I write VB not C# i'm an&amp;nbsp;amateur, and i&amp;nbsp;haven't&amp;nbsp;fully tested this yet&lt;/p&gt;
&lt;p&gt;To use create a new&amp;nbsp;ConditionalFormatDef object, populate it with colours and&amp;nbsp;boundary&amp;nbsp;conditions then &amp;nbsp;use&amp;nbsp;AddConditionalFormatting sub to apply it to an epplus range.&lt;/p&gt;
&lt;p&gt;Any feed back/guidance would be&amp;nbsp;appreciated.&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Tim&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;Imports&lt;/span&gt; System.Collections.Generic
&lt;span style="color: blue;"&gt;Imports&lt;/span&gt; System.Text
&lt;span style="color: blue;"&gt;Imports&lt;/span&gt; System.IO
&lt;span style="color: blue;"&gt;Imports&lt;/span&gt; OfficeOpenXml
&lt;span style="color: blue;"&gt;Imports&lt;/span&gt; System.Xml
&lt;span style="color: blue;"&gt;Imports&lt;/span&gt; OfficeOpenXml.Drawing
&lt;span style="color: blue;"&gt;Imports&lt;/span&gt; OfficeOpenXml.Style


&lt;span style="color: blue;"&gt;Class&lt;/span&gt; ConditionalFormatDef
    &lt;span style="color: blue;"&gt;Private&lt;/span&gt; P_cfvoType(2) &lt;span style="color: blue;"&gt;As&lt;/span&gt; XmlElement
    &lt;span style="color: blue;"&gt;Private&lt;/span&gt; P_Colour(2) &lt;span style="color: blue;"&gt;As&lt;/span&gt; Color
    &lt;span style="color: blue;"&gt;Private&lt;/span&gt; P_ConditionalFormatType &lt;span style="color: blue;"&gt;As&lt;/span&gt; ConditionalFormatOptions
    &lt;span style="color: blue;"&gt;Enum&lt;/span&gt; ConditionalFormatOptions
        DataBar = 1
        TwoColourScale = 2
        ThreeColourScale = 3
    &lt;span style="color: blue;"&gt;End&lt;/span&gt; &lt;span style="color: blue;"&gt;Enum&lt;/span&gt;
    &lt;span style="color: blue;"&gt;Enum&lt;/span&gt; OneTwoThree
        One = 1
        Two = 2
        Three = 3
    &lt;span style="color: blue;"&gt;End&lt;/span&gt; &lt;span style="color: blue;"&gt;Enum&lt;/span&gt;
    &lt;span style="color: blue;"&gt;Enum&lt;/span&gt; MinMax
        &lt;span style="color: blue;"&gt;Min&lt;/span&gt;
        &lt;span style="color: blue;"&gt;Max&lt;/span&gt;
    &lt;span style="color: blue;"&gt;End&lt;/span&gt; &lt;span style="color: blue;"&gt;Enum&lt;/span&gt;
    &lt;span style="color: blue;"&gt;Enum&lt;/span&gt; BoundryType
        Percent
        Percentile
        Number
        formula
    &lt;span style="color: blue;"&gt;End&lt;/span&gt; &lt;span style="color: blue;"&gt;Enum&lt;/span&gt;

    &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; Doc &lt;span style="color: blue;"&gt;As&lt;/span&gt; &lt;span style="color: blue;"&gt;New&lt;/span&gt; XmlDocument

    &lt;span style="color: green;"&gt;''' &amp;lt;summary&amp;gt;&lt;/span&gt;
    &lt;span style="color: green;"&gt;''' Contructor for ConditionalFormatDef&lt;/span&gt;
    &lt;span style="color: green;"&gt;''' Requires the number of colours in the colour scale to set&lt;/span&gt;
    &lt;span style="color: green;"&gt;''' &amp;lt;/summary&amp;gt;&lt;/span&gt;
    &lt;span style="color: green;"&gt;''' &amp;lt;param name="ConditionalFormatType"&amp;gt; The type of the conditional format type&amp;lt;/param&amp;gt;&lt;/span&gt;
    &lt;span style="color: green;"&gt;''' &amp;lt;remarks&amp;gt;&amp;lt;/remarks&amp;gt;&lt;/span&gt;
    &lt;span style="color: blue;"&gt;Public&lt;/span&gt; &lt;span style="color: blue;"&gt;Sub&lt;/span&gt; &lt;span style="color: blue;"&gt;New&lt;/span&gt;(ConditionalFormatType &lt;span style="color: blue;"&gt;As&lt;/span&gt; ConditionalFormatOptions)
        &lt;span style="color: blue;"&gt;Me&lt;/span&gt;.&lt;span style="color: blue;"&gt;New&lt;/span&gt;()
        &lt;span style="color: green;"&gt;'Sets the type of Conditional format being applied&lt;/span&gt;
        P_ConditionalFormatType = ConditionalFormatType
    &lt;span style="color: blue;"&gt;End&lt;/span&gt; &lt;span style="color: blue;"&gt;Sub&lt;/span&gt;

    &lt;span style="color: green;"&gt;''' &amp;lt;summary&amp;gt;&lt;/span&gt;
    &lt;span style="color: green;"&gt;''' Constructor for recreating an object from an XML element to aid working with existing formating&lt;/span&gt;
    &lt;span style="color: green;"&gt;''' &amp;lt;/summary&amp;gt;&lt;/span&gt;
    &lt;span style="color: green;"&gt;''' &amp;lt;param name="XMLElement"&amp;gt; A conditional formatting XMLElement &amp;lt;/param&amp;gt;&lt;/span&gt;
    &lt;span style="color: green;"&gt;''' &amp;lt;remarks&amp;gt; unfinished/tested&amp;lt;/remarks&amp;gt;&lt;/span&gt;
    &lt;span style="color: blue;"&gt;Public&lt;/span&gt; &lt;span style="color: blue;"&gt;Sub&lt;/span&gt; &lt;span style="color: blue;"&gt;New&lt;/span&gt;(XMLElement &lt;span style="color: blue;"&gt;As&lt;/span&gt; XmlElement)
        &lt;span style="color: blue;"&gt;Me&lt;/span&gt;.&lt;span style="color: blue;"&gt;New&lt;/span&gt;()
        &lt;span style="color: blue;"&gt;Select&lt;/span&gt; &lt;span style="color: blue;"&gt;Case&lt;/span&gt; XMLElement.Name
            &lt;span style="color: blue;"&gt;Case&lt;/span&gt; &lt;span style="color: rgb(163, 21, 21);"&gt;"dataBar"&lt;/span&gt;
                P_ConditionalFormatType = ConditionalFormatOptions.DataBar
            &lt;span style="color: blue;"&gt;Case&lt;/span&gt; &lt;span style="color: rgb(163, 21, 21);"&gt;"colorScale"&lt;/span&gt;
                &lt;span style="color: blue;"&gt;If&lt;/span&gt; XMLElement.ChildNodes.&lt;span style="color: blue;"&gt;Count&lt;/span&gt; = 4 &lt;span style="color: blue;"&gt;Then&lt;/span&gt;
                    P_ConditionalFormatType = ConditionalFormatOptions.TwoColourScale
                &lt;span style="color: blue;"&gt;Else&lt;/span&gt;
                    P_ConditionalFormatType = ConditionalFormatOptions.ThreeColourScale
                &lt;span style="color: blue;"&gt;End&lt;/span&gt; &lt;span style="color: blue;"&gt;If&lt;/span&gt;
            &lt;span style="color: blue;"&gt;Case&lt;/span&gt; &lt;span style="color: blue;"&gt;Else&lt;/span&gt;
                &lt;span style="color: blue;"&gt;Exit&lt;/span&gt; &lt;span style="color: blue;"&gt;Sub&lt;/span&gt;
        &lt;span style="color: blue;"&gt;End&lt;/span&gt; &lt;span style="color: blue;"&gt;Select&lt;/span&gt;

        &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; ColoursCount &lt;span style="color: blue;"&gt;As&lt;/span&gt; &lt;span style="color: blue;"&gt;Integer&lt;/span&gt; = 0
        &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; BoundrysCount &lt;span style="color: blue;"&gt;As&lt;/span&gt; &lt;span style="color: blue;"&gt;Integer&lt;/span&gt; = 0

        &lt;span style="color: blue;"&gt;For&lt;/span&gt; &lt;span style="color: blue;"&gt;Each&lt;/span&gt; Node &lt;span style="color: blue;"&gt;As&lt;/span&gt; XmlElement &lt;span style="color: blue;"&gt;In&lt;/span&gt; XMLElement.ChildNodes
            &lt;span style="color: blue;"&gt;If&lt;/span&gt; Node.Name &lt;span style="color: blue;"&gt;Like&lt;/span&gt; &lt;span style="color: rgb(163, 21, 21);"&gt;"cfvo"&lt;/span&gt; &lt;span style="color: blue;"&gt;Then&lt;/span&gt;

            &lt;span style="color: blue;"&gt;End&lt;/span&gt; &lt;span style="color: blue;"&gt;If&lt;/span&gt;
        &lt;span style="color: blue;"&gt;Next&lt;/span&gt;
    &lt;span style="color: blue;"&gt;End&lt;/span&gt; &lt;span style="color: blue;"&gt;Sub&lt;/span&gt;


    &lt;span style="color: green;"&gt;''' &amp;lt;summary&amp;gt;&lt;/span&gt;
    &lt;span style="color: green;"&gt;''' Private constructor, sets some defaults in all the variables.&lt;/span&gt;
    &lt;span style="color: green;"&gt;''' &amp;lt;/summary&amp;gt;&lt;/span&gt;
    &lt;span style="color: green;"&gt;''' &amp;lt;remarks&amp;gt;  &amp;lt;/remarks&amp;gt;&lt;/span&gt;
    &lt;span style="color: blue;"&gt;Private&lt;/span&gt; &lt;span style="color: blue;"&gt;Sub&lt;/span&gt; &lt;span style="color: blue;"&gt;New&lt;/span&gt;()

        &lt;span style="color: green;"&gt;'sets some default colours&lt;/span&gt;
        P_Colour(0) = Colors.Red
        P_Colour(1) = Colors.Yellow
        P_Colour(2) = Colors.Green

        &lt;span style="color: green;"&gt;'Creates CFVO Elemetns&lt;/span&gt;
        P_cfvoType(0) = Doc.CreateElement(&lt;span style="color: rgb(163, 21, 21);"&gt;"cfvo"&lt;/span&gt;)
        P_cfvoType(1) = Doc.CreateElement(&lt;span style="color: rgb(163, 21, 21);"&gt;"cfvo"&lt;/span&gt;)
        P_cfvoType(2) = Doc.CreateElement(&lt;span style="color: rgb(163, 21, 21);"&gt;"cfvo"&lt;/span&gt;)

        &lt;span style="color: green;"&gt;'Add So Default Attributes to &lt;/span&gt;
        AddAttribute(P_cfvoType(0), &lt;span style="color: rgb(163, 21, 21);"&gt;"type"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"num"&lt;/span&gt;)
        AddAttribute(P_cfvoType(0), &lt;span style="color: rgb(163, 21, 21);"&gt;"val"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"10"&lt;/span&gt;)

        AddAttribute(P_cfvoType(0), &lt;span style="color: rgb(163, 21, 21);"&gt;"type"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"num"&lt;/span&gt;)
        AddAttribute(P_cfvoType(0), &lt;span style="color: rgb(163, 21, 21);"&gt;"val"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"20"&lt;/span&gt;)

        AddAttribute(P_cfvoType(0), &lt;span style="color: rgb(163, 21, 21);"&gt;"type"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"num"&lt;/span&gt;)
        AddAttribute(P_cfvoType(0), &lt;span style="color: rgb(163, 21, 21);"&gt;"val"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"30"&lt;/span&gt;)

    &lt;span style="color: blue;"&gt;End&lt;/span&gt; &lt;span style="color: blue;"&gt;Sub&lt;/span&gt;


    &lt;span style="color: green;"&gt;''' &amp;lt;summary&amp;gt;&lt;/span&gt;
    &lt;span style="color: green;"&gt;''' Sets the colours for the colour scale indavidualy&lt;/span&gt;
    &lt;span style="color: green;"&gt;''' &amp;lt;/summary&amp;gt;&lt;/span&gt;
    &lt;span style="color: green;"&gt;''' &amp;lt;param name="inNumber"&amp;gt;The colour number being set {1-3}&amp;lt;/param&amp;gt;&lt;/span&gt;
    &lt;span style="color: green;"&gt;''' &amp;lt;param name="inColour"&amp;gt;The colour refference&amp;lt;/param&amp;gt;&lt;/span&gt;
    &lt;span style="color: green;"&gt;''' &amp;lt;remarks&amp;gt;They default to Red,Green or Red,Yellow,Green if not changed&amp;lt;/remarks&amp;gt;&lt;/span&gt;
    &lt;span style="color: blue;"&gt;Public&lt;/span&gt; &lt;span style="color: blue;"&gt;Sub&lt;/span&gt; SetColour(inNumber &lt;span style="color: blue;"&gt;As&lt;/span&gt; OneTwoThree, inColour &lt;span style="color: blue;"&gt;As&lt;/span&gt; Color)
        P_Colour(inNumber - 1) = inColour
    &lt;span style="color: blue;"&gt;End&lt;/span&gt; &lt;span style="color: blue;"&gt;Sub&lt;/span&gt;


    &lt;span style="color: green;"&gt;''' &amp;lt;summary&amp;gt;&lt;/span&gt;
    &lt;span style="color: green;"&gt;''' Sets a boundry condition&lt;/span&gt;
    &lt;span style="color: green;"&gt;''' &amp;lt;/summary&amp;gt;&lt;/span&gt;
    &lt;span style="color: green;"&gt;''' &amp;lt;param name="inNumber"&amp;gt;The boundry condition to be set&amp;lt;/param&amp;gt;&lt;/span&gt;
    &lt;span style="color: green;"&gt;''' &amp;lt;param name="cell"&amp;gt;The cell to use a refference&amp;lt;/param&amp;gt;&lt;/span&gt;
    &lt;span style="color: green;"&gt;''' &amp;lt;param name="BoundryType"&amp;gt;The type of the boundry condition&amp;lt;/param&amp;gt;&lt;/span&gt;
    &lt;span style="color: green;"&gt;''' &amp;lt;remarks&amp;gt;&amp;lt;/remarks&amp;gt;&lt;/span&gt;
    &lt;span style="color: blue;"&gt;Public&lt;/span&gt; &lt;span style="color: blue;"&gt;Sub&lt;/span&gt; SetBoundrys(inNumber &lt;span style="color: blue;"&gt;As&lt;/span&gt; OneTwoThree, cell &lt;span style="color: blue;"&gt;As&lt;/span&gt; OfficeOpenXml.ExcelCellAddress, BoundryType &lt;span style="color: blue;"&gt;As&lt;/span&gt; BoundryType)
        P_cfvoType(inNumber - 1) = Doc.CreateElement(&lt;span style="color: rgb(163, 21, 21);"&gt;"cfvo"&lt;/span&gt;)
        &lt;span style="color: blue;"&gt;Select&lt;/span&gt; &lt;span style="color: blue;"&gt;Case&lt;/span&gt; BoundryType
            &lt;span style="color: blue;"&gt;Case&lt;/span&gt; &lt;span style="color: blue;"&gt;Is&lt;/span&gt; = ConditionalFormatDef.BoundryType.Number
                AddAttribute(P_cfvoType(inNumber - 1), &lt;span style="color: rgb(163, 21, 21);"&gt;"type"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"num"&lt;/span&gt;)
            &lt;span style="color: blue;"&gt;Case&lt;/span&gt; &lt;span style="color: blue;"&gt;Is&lt;/span&gt; = ConditionalFormatDef.BoundryType.Percent
                AddAttribute(P_cfvoType(inNumber - 1), &lt;span style="color: rgb(163, 21, 21);"&gt;"type"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"percent"&lt;/span&gt;)
            &lt;span style="color: blue;"&gt;Case&lt;/span&gt; &lt;span style="color: blue;"&gt;Is&lt;/span&gt; = ConditionalFormatDef.BoundryType.Percentile
                AddAttribute(P_cfvoType(inNumber - 1), &lt;span style="color: rgb(163, 21, 21);"&gt;"type"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"percentile"&lt;/span&gt;)
            &lt;span style="color: blue;"&gt;Case&lt;/span&gt; &lt;span style="color: blue;"&gt;Is&lt;/span&gt; = ConditionalFormatDef.BoundryType.formula
                AddAttribute(P_cfvoType(inNumber - 1), &lt;span style="color: rgb(163, 21, 21);"&gt;"type"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"formula"&lt;/span&gt;)
        &lt;span style="color: blue;"&gt;End&lt;/span&gt; &lt;span style="color: blue;"&gt;Select&lt;/span&gt;

        AddAttribute(P_cfvoType(inNumber - 1), &lt;span style="color: rgb(163, 21, 21);"&gt;"val"&lt;/span&gt;, cell.Address)
    &lt;span style="color: blue;"&gt;End&lt;/span&gt; &lt;span style="color: blue;"&gt;Sub&lt;/span&gt;

    &lt;span style="color: green;"&gt;''' &amp;lt;summary&amp;gt;&lt;/span&gt;
    &lt;span style="color: green;"&gt;''' Sets a boundry condition&lt;/span&gt;
    &lt;span style="color: green;"&gt;''' &amp;lt;/summary&amp;gt;&lt;/span&gt;
    &lt;span style="color: green;"&gt;''' &amp;lt;param name="inNumber"&amp;gt;The boundry condition to be set&amp;lt;/param&amp;gt;&lt;/span&gt;
    &lt;span style="color: green;"&gt;''' &amp;lt;param name="MinOrMax"&amp;gt;The type of the boundry condition&amp;lt;/param&amp;gt;&lt;/span&gt;
    &lt;span style="color: green;"&gt;''' &amp;lt;remarks&amp;gt;&amp;lt;/remarks&amp;gt;&lt;/span&gt;
    &lt;span style="color: blue;"&gt;Public&lt;/span&gt; &lt;span style="color: blue;"&gt;Sub&lt;/span&gt; SetBoundrys(inNumber &lt;span style="color: blue;"&gt;As&lt;/span&gt; OneTwoThree, MinOrMax &lt;span style="color: blue;"&gt;As&lt;/span&gt; MinMax)
        P_cfvoType(inNumber - 1) = Doc.CreateElement(&lt;span style="color: rgb(163, 21, 21);"&gt;"cfvo"&lt;/span&gt;)
        &lt;span style="color: blue;"&gt;Select&lt;/span&gt; &lt;span style="color: blue;"&gt;Case&lt;/span&gt; MinOrMax
            &lt;span style="color: blue;"&gt;Case&lt;/span&gt; ConditionalFormatDef.MinMax.&lt;span style="color: blue;"&gt;Min&lt;/span&gt;
                AddAttribute(P_cfvoType(inNumber - 1), &lt;span style="color: rgb(163, 21, 21);"&gt;"type"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"Min"&lt;/span&gt;)
            &lt;span style="color: blue;"&gt;Case&lt;/span&gt; ConditionalFormatDef.MinMax.&lt;span style="color: blue;"&gt;Max&lt;/span&gt;
                AddAttribute(P_cfvoType(inNumber - 1), &lt;span style="color: rgb(163, 21, 21);"&gt;"type"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"Max"&lt;/span&gt;)
        &lt;span style="color: blue;"&gt;End&lt;/span&gt; &lt;span style="color: blue;"&gt;Select&lt;/span&gt;
    &lt;span style="color: blue;"&gt;End&lt;/span&gt; &lt;span style="color: blue;"&gt;Sub&lt;/span&gt;

    &lt;span style="color: green;"&gt;''' &amp;lt;summary&amp;gt;&lt;/span&gt;
    &lt;span style="color: green;"&gt;''' Sets a boundry condition&lt;/span&gt;
    &lt;span style="color: green;"&gt;''' &amp;lt;/summary&amp;gt;&lt;/span&gt;
    &lt;span style="color: green;"&gt;''' &amp;lt;param name="inNumber"&amp;gt;The boundry condition to be set&amp;lt;/param&amp;gt;&lt;/span&gt;
    &lt;span style="color: green;"&gt;''' &amp;lt;param name="value"&amp;gt;The value to set the boundry condition at&amp;lt;/param&amp;gt;&lt;/span&gt;
    &lt;span style="color: green;"&gt;''' &amp;lt;param name="BoundryType"&amp;gt;The type of the boundry condition&amp;lt;/param&amp;gt;&lt;/span&gt;
    &lt;span style="color: green;"&gt;''' &amp;lt;remarks&amp;gt;&amp;lt;/remarks&amp;gt;&lt;/span&gt;
    &lt;span style="color: blue;"&gt;Public&lt;/span&gt; &lt;span style="color: blue;"&gt;Sub&lt;/span&gt; SetBoundrys(inNumber &lt;span style="color: blue;"&gt;As&lt;/span&gt; OneTwoThree, value &lt;span style="color: blue;"&gt;As&lt;/span&gt; &lt;span style="color: blue;"&gt;Double&lt;/span&gt;, BoundryType &lt;span style="color: blue;"&gt;As&lt;/span&gt; BoundryType)
        P_cfvoType(inNumber - 1) = Doc.CreateElement(&lt;span style="color: rgb(163, 21, 21);"&gt;"cfvo"&lt;/span&gt;)
        &lt;span style="color: blue;"&gt;Select&lt;/span&gt; &lt;span style="color: blue;"&gt;Case&lt;/span&gt; BoundryType
            &lt;span style="color: blue;"&gt;Case&lt;/span&gt; &lt;span style="color: blue;"&gt;Is&lt;/span&gt; = ConditionalFormatDef.BoundryType.Number
                AddAttribute(P_cfvoType(inNumber - 1), &lt;span style="color: rgb(163, 21, 21);"&gt;"type"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"num"&lt;/span&gt;)
            &lt;span style="color: blue;"&gt;Case&lt;/span&gt; &lt;span style="color: blue;"&gt;Is&lt;/span&gt; = ConditionalFormatDef.BoundryType.Percent
                AddAttribute(P_cfvoType(inNumber - 1), &lt;span style="color: rgb(163, 21, 21);"&gt;"type"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"percent"&lt;/span&gt;)
            &lt;span style="color: blue;"&gt;Case&lt;/span&gt; &lt;span style="color: blue;"&gt;Is&lt;/span&gt; = ConditionalFormatDef.BoundryType.Percentile
                AddAttribute(P_cfvoType(inNumber - 1), &lt;span style="color: rgb(163, 21, 21);"&gt;"type"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"percentile"&lt;/span&gt;)
            &lt;span style="color: blue;"&gt;Case&lt;/span&gt; &lt;span style="color: blue;"&gt;Is&lt;/span&gt; = ConditionalFormatDef.BoundryType.formula
                AddAttribute(P_cfvoType(inNumber - 1), &lt;span style="color: rgb(163, 21, 21);"&gt;"type"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"formula"&lt;/span&gt;)
        &lt;span style="color: blue;"&gt;End&lt;/span&gt; &lt;span style="color: blue;"&gt;Select&lt;/span&gt;

        AddAttribute(P_cfvoType(inNumber - 1), &lt;span style="color: rgb(163, 21, 21);"&gt;"val"&lt;/span&gt;, value)
    &lt;span style="color: blue;"&gt;End&lt;/span&gt; &lt;span style="color: blue;"&gt;Sub&lt;/span&gt;

    &lt;span style="color: green;"&gt;''' &amp;lt;summary&amp;gt;&lt;/span&gt;
    &lt;span style="color: green;"&gt;''' Sets a boundry condition&lt;/span&gt;
    &lt;span style="color: green;"&gt;''' &amp;lt;/summary&amp;gt;&lt;/span&gt;
    &lt;span style="color: green;"&gt;''' &amp;lt;param name="inNumber"&amp;gt;The boundry condition to be set&amp;lt;/param&amp;gt;&lt;/span&gt;
    &lt;span style="color: green;"&gt;''' &amp;lt;param name="value"&amp;gt;The value to set the boundry condition at&amp;lt;/param&amp;gt;&lt;/span&gt;
    &lt;span style="color: green;"&gt;''' &amp;lt;param name="BoundryType"&amp;gt;The type of the boundry condition&amp;lt;/param&amp;gt;&lt;/span&gt;
    &lt;span style="color: green;"&gt;''' &amp;lt;remarks&amp;gt;&amp;lt;/remarks&amp;gt;&lt;/span&gt;
    &lt;span style="color: blue;"&gt;Public&lt;/span&gt; &lt;span style="color: blue;"&gt;Sub&lt;/span&gt; SetBoundrys(inNumber &lt;span style="color: blue;"&gt;As&lt;/span&gt; OneTwoThree, value &lt;span style="color: blue;"&gt;As&lt;/span&gt; &lt;span style="color: blue;"&gt;String&lt;/span&gt;, BoundryType &lt;span style="color: blue;"&gt;As&lt;/span&gt; BoundryType)
        P_cfvoType(inNumber - 1) = Doc.CreateElement(&lt;span style="color: rgb(163, 21, 21);"&gt;"cfvo"&lt;/span&gt;)
        &lt;span style="color: blue;"&gt;Select&lt;/span&gt; &lt;span style="color: blue;"&gt;Case&lt;/span&gt; BoundryType
            &lt;span style="color: blue;"&gt;Case&lt;/span&gt; &lt;span style="color: blue;"&gt;Is&lt;/span&gt; = ConditionalFormatDef.BoundryType.Number
                AddAttribute(P_cfvoType(inNumber - 1), &lt;span style="color: rgb(163, 21, 21);"&gt;"type"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"num"&lt;/span&gt;)
            &lt;span style="color: blue;"&gt;Case&lt;/span&gt; &lt;span style="color: blue;"&gt;Is&lt;/span&gt; = ConditionalFormatDef.BoundryType.Percent
                AddAttribute(P_cfvoType(inNumber - 1), &lt;span style="color: rgb(163, 21, 21);"&gt;"type"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"percent"&lt;/span&gt;)
            &lt;span style="color: blue;"&gt;Case&lt;/span&gt; &lt;span style="color: blue;"&gt;Is&lt;/span&gt; = ConditionalFormatDef.BoundryType.Percentile
                AddAttribute(P_cfvoType(inNumber - 1), &lt;span style="color: rgb(163, 21, 21);"&gt;"type"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"percentile"&lt;/span&gt;)
            &lt;span style="color: blue;"&gt;Case&lt;/span&gt; &lt;span style="color: blue;"&gt;Is&lt;/span&gt; = ConditionalFormatDef.BoundryType.formula
                AddAttribute(P_cfvoType(inNumber - 1), &lt;span style="color: rgb(163, 21, 21);"&gt;"type"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"formula"&lt;/span&gt;)
        &lt;span style="color: blue;"&gt;End&lt;/span&gt; &lt;span style="color: blue;"&gt;Select&lt;/span&gt;

        AddAttribute(P_cfvoType(inNumber - 1), &lt;span style="color: rgb(163, 21, 21);"&gt;"val"&lt;/span&gt;, value)
    &lt;span style="color: blue;"&gt;End&lt;/span&gt; &lt;span style="color: blue;"&gt;Sub&lt;/span&gt;


    &lt;span style="color: green;"&gt;''' &amp;lt;summary&amp;gt;&lt;/span&gt;
    &lt;span style="color: green;"&gt;''' Converts the colour object to an XML element&lt;/span&gt;
    &lt;span style="color: green;"&gt;''' &amp;lt;/summary&amp;gt;&lt;/span&gt;
    &lt;span style="color: green;"&gt;''' &amp;lt;param name="Colour"&amp;gt;Colour to be converted&amp;lt;/param&amp;gt;&lt;/span&gt;
    &lt;span style="color: green;"&gt;''' &amp;lt;returns&amp;gt;&amp;lt;/returns&amp;gt;&lt;/span&gt;
    &lt;span style="color: green;"&gt;''' &amp;lt;remarks&amp;gt;&amp;lt;/remarks&amp;gt;&lt;/span&gt;
    &lt;span style="color: blue;"&gt;Private&lt;/span&gt; &lt;span style="color: blue;"&gt;Function&lt;/span&gt; GetColourElement(Colour &lt;span style="color: blue;"&gt;As&lt;/span&gt; Color) &lt;span style="color: blue;"&gt;As&lt;/span&gt; XmlElement
        GetColourElement = Doc.CreateElement(&lt;span style="color: rgb(163, 21, 21);"&gt;"color"&lt;/span&gt;)
        AddAttribute(GetColourElement, &lt;span style="color: rgb(163, 21, 21);"&gt;"rgb"&lt;/span&gt;, Colour.ToString)
    &lt;span style="color: blue;"&gt;End&lt;/span&gt; &lt;span style="color: blue;"&gt;Function&lt;/span&gt;


    &lt;span style="color: green;"&gt;''' &amp;lt;summary&amp;gt;&lt;/span&gt;
    &lt;span style="color: green;"&gt;''' The function that returns the XMLElement to be intergrated into the document&lt;/span&gt;
    &lt;span style="color: green;"&gt;''' &amp;lt;/summary&amp;gt;&lt;/span&gt;
    &lt;span style="color: green;"&gt;''' &amp;lt;param name="Priority"&amp;gt;Sets the priority of the element &amp;lt;/param&amp;gt;&lt;/span&gt;
    &lt;span style="color: green;"&gt;''' &amp;lt;returns&amp;gt;XML Element containing the conditional formanting&amp;lt;/returns&amp;gt;&lt;/span&gt;
    &lt;span style="color: green;"&gt;''' &amp;lt;remarks&amp;gt;&amp;lt;/remarks&amp;gt;&lt;/span&gt;
    &lt;span style="color: blue;"&gt;Public&lt;/span&gt; &lt;span style="color: blue;"&gt;Function&lt;/span&gt; GetXMLElement(Priority &lt;span style="color: blue;"&gt;As&lt;/span&gt; &lt;span style="color: blue;"&gt;Integer&lt;/span&gt;) &lt;span style="color: blue;"&gt;As&lt;/span&gt; XmlElement
        &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; ChildElement = Doc.CreateElement(&lt;span style="color: rgb(163, 21, 21);"&gt;"colorScale"&lt;/span&gt;)

        &lt;span style="color: blue;"&gt;Select&lt;/span&gt; &lt;span style="color: blue;"&gt;Case&lt;/span&gt; P_ConditionalFormatType
            &lt;span style="color: blue;"&gt;Case&lt;/span&gt; ConditionalFormatOptions.dataBar

                ChildElement.AppendChild(P_cfvoType(0))
                ChildElement.AppendChild(P_cfvoType(1))

                ChildElement.AppendChild(GetColourElement(P_Colour(0)))

                GetXMLElement = Doc.CreateElement(&lt;span style="color: rgb(163, 21, 21);"&gt;"dataBar"&lt;/span&gt;)
                AddAttribute(GetXMLElement, &lt;span style="color: rgb(163, 21, 21);"&gt;"type"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"dataBar"&lt;/span&gt;)
                AddAttribute(GetXMLElement, &lt;span style="color: rgb(163, 21, 21);"&gt;"priority"&lt;/span&gt;, Priority)
                GetXMLElement.AppendChild(ChildElement)

            &lt;span style="color: blue;"&gt;Case&lt;/span&gt; ConditionalFormatOptions.ThreeColourScale
                ChildElement.AppendChild(P_cfvoType(0))
                ChildElement.AppendChild(P_cfvoType(1))
                ChildElement.AppendChild(P_cfvoType(2))

                ChildElement.AppendChild(GetColourElement(P_Colour(0)))
                ChildElement.AppendChild(GetColourElement(P_Colour(1)))
                ChildElement.AppendChild(GetColourElement(P_Colour(2)))

                GetXMLElement = Doc.CreateElement(&lt;span style="color: rgb(163, 21, 21);"&gt;"colorScale"&lt;/span&gt;)
                AddAttribute(GetXMLElement, &lt;span style="color: rgb(163, 21, 21);"&gt;"type"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"colorScale"&lt;/span&gt;)
                AddAttribute(GetXMLElement, &lt;span style="color: rgb(163, 21, 21);"&gt;"priority"&lt;/span&gt;, Priority)
                GetXMLElement.AppendChild(ChildElement)

            &lt;span style="color: blue;"&gt;Case&lt;/span&gt; ConditionalFormatOptions.TwoColourScale
                ChildElement.AppendChild(P_cfvoType(0))
                ChildElement.AppendChild(P_cfvoType(1))
                ChildElement.AppendChild(GetColourElement(P_Colour(0)))
                ChildElement.AppendChild(GetColourElement(P_Colour(1)))

                GetXMLElement = Doc.CreateElement(&lt;span style="color: rgb(163, 21, 21);"&gt;"colorScale"&lt;/span&gt;)
                AddAttribute(GetXMLElement, &lt;span style="color: rgb(163, 21, 21);"&gt;"type"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"colorScale"&lt;/span&gt;)
                AddAttribute(GetXMLElement, &lt;span style="color: rgb(163, 21, 21);"&gt;"priority"&lt;/span&gt;, Priority)
                GetXMLElement.AppendChild(ChildElement)

        &lt;span style="color: blue;"&gt;End&lt;/span&gt; &lt;span style="color: blue;"&gt;Select&lt;/span&gt;

    &lt;span style="color: blue;"&gt;End&lt;/span&gt; &lt;span style="color: blue;"&gt;Function&lt;/span&gt;


&lt;span style="color: blue;"&gt;End&lt;/span&gt; &lt;span style="color: blue;"&gt;Class&lt;/span&gt;

&lt;span style="color: blue;"&gt;Module&lt;/span&gt; ApplyConditionalFormat

    &lt;span style="color: blue;"&gt;Public&lt;/span&gt; &lt;span style="color: blue;"&gt;Sub&lt;/span&gt; AddAttribute(inXmlElement &lt;span style="color: blue;"&gt;As&lt;/span&gt; XmlElement, inAttributeName &lt;span style="color: blue;"&gt;As&lt;/span&gt; &lt;span style="color: blue;"&gt;String&lt;/span&gt;, inAttributeValue &lt;span style="color: blue;"&gt;As&lt;/span&gt; &lt;span style="color: blue;"&gt;String&lt;/span&gt;)
        &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; xmlAttribute &lt;span style="color: blue;"&gt;As&lt;/span&gt; XmlAttribute = inXmlElement.OwnerDocument.CreateAttribute(inAttributeName)
        xmlAttribute.Value = inAttributeValue
        inXmlElement.SetAttributeNode(xmlAttribute)
    &lt;span style="color: blue;"&gt;End&lt;/span&gt; &lt;span style="color: blue;"&gt;Sub&lt;/span&gt;

 
    &lt;span style="color: green;"&gt;''' &amp;lt;summary&amp;gt;&lt;/span&gt;
    &lt;span style="color: green;"&gt;''' Sub that adds the conditional formating XMLElement to the excel doc&lt;/span&gt;
    &lt;span style="color: green;"&gt;''' &amp;lt;/summary&amp;gt;&lt;/span&gt;
    &lt;span style="color: green;"&gt;''' &amp;lt;param name="inSqref"&amp;gt;Range to apply the conditional formatting to&amp;lt;/param&amp;gt;&lt;/span&gt;
    &lt;span style="color: green;"&gt;''' &amp;lt;param name="ConditionalFormatdef"&amp;gt;Conditional format object&amp;lt;/param&amp;gt;&lt;/span&gt;
    &lt;span style="color: green;"&gt;''' &amp;lt;remarks&amp;gt;&amp;lt;/remarks&amp;gt;&lt;/span&gt;
    &lt;span style="color: blue;"&gt;Public&lt;/span&gt; &lt;span style="color: blue;"&gt;Sub&lt;/span&gt; AddConditionalFormatting(inSqref &lt;span style="color: blue;"&gt;As&lt;/span&gt; OfficeOpenXml.ExcelRange, ConditionalFormatdef &lt;span style="color: blue;"&gt;As&lt;/span&gt; ConditionalFormatDef)

        &lt;span style="color: green;"&gt;' The WorksheetXml&lt;/span&gt;
        &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; xmlDoc &lt;span style="color: blue;"&gt;As&lt;/span&gt; XmlDocument = inSqref.Worksheet.WorksheetXml

        &lt;span style="color: green;"&gt;' Root element of the WorksheetXml&lt;/span&gt;
        &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; root &lt;span style="color: blue;"&gt;As&lt;/span&gt; XmlElement = xmlDoc.DocumentElement

        &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; eleConditionalFormatting &lt;span style="color: blue;"&gt;As&lt;/span&gt; XmlElement = xmlDoc.CreateElement(&lt;span style="color: rgb(163, 21, 21);"&gt;"conditionalFormatting"&lt;/span&gt;, root.NamespaceURI)
        AddAttribute(eleConditionalFormatting, &lt;span style="color: rgb(163, 21, 21);"&gt;"sqref"&lt;/span&gt;, inSqref.Address)

        &lt;span style="color: green;"&gt;' &amp;lt;/cfRule&amp;gt;&lt;/span&gt;
        &lt;span style="color: green;"&gt;' -----------------------------------------&lt;/span&gt;
        eleConditionalFormatting.AppendChild(ConditionalFormatdef.GetXMLElement(1))

        &lt;span style="color: green;"&gt;' -----------------------------------------&lt;/span&gt;
        &lt;span style="color: green;"&gt;' &amp;lt;/conditionalFormatting&amp;gt;&lt;/span&gt;
        &lt;span style="color: green;"&gt;' -----------------------------------------&lt;/span&gt;
        root.InsertAfter(eleConditionalFormatting, root.LastChild)

    &lt;span style="color: blue;"&gt;End&lt;/span&gt; &lt;span style="color: blue;"&gt;Sub&lt;/span&gt;
&lt;span style="color: blue;"&gt;End&lt;/span&gt; &lt;span style="color: blue;"&gt;Module&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="02/05/2012 19:03:14">
          <Html>
        
&lt;p&gt;Hi Tim,&lt;/p&gt;
&lt;p&gt;Sorry for my late replay, I have been sick for 1 1/2 week, so I haven't done much lately.&lt;/p&gt;
&lt;p&gt;Thanks for your code.&amp;nbsp;Eyal in the project is working on an implement of conditional formatting&amp;nbsp;to the next version (probably not all features).&lt;/p&gt;
&lt;p&gt;Thanks Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Open Excel file as Readonly">
      <Posts>
        <Post From="PitAttack76" When="17/04/2012 14:36:31">
          <Html>
        
&lt;p&gt;Hi all,&lt;/p&gt;
&lt;p&gt;Is it possible to open an Excel file as ReadOnly? This way I can load the Excel file even when it's still open.&lt;/p&gt;
&lt;p&gt;Now it throws an error, I need to close the file and restart my actions.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thx!&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="02/05/2012 18:47:15">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;You can open the file in a stream (file of memory) yourself and &amp;nbsp;then use the stream in the Excelpackage constructor.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Cell number format">
      <Posts>
        <Post From="gmocontreras" When="16/04/2012 16:07:13">
          <Html>
        
&lt;p&gt;&lt;span id="result_box" lang="en"&gt;&lt;span&gt;Dear&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;br&gt;
&lt;span&gt;I'm&lt;/span&gt; &lt;span&gt;formatting&lt;/span&gt; &lt;span&gt;to cells&lt;/span&gt; &lt;span&gt;with the following value&lt;/span&gt;&lt;span&gt;:
&lt;/span&gt;&lt;/span&gt;workSheet.Cells[nextRow, 7].Style.Numberformat.Format = "$ #,###.&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;";&lt;br&gt;
&lt;span id="result_box" lang="en"&gt;&lt;span&gt;The format&lt;/span&gt; &lt;span&gt;is correct, but&lt;/span&gt;
&lt;span&gt;when I open&lt;/span&gt; &lt;span&gt;the generated file,&lt;/span&gt; &lt;span&gt;should I&lt;/span&gt; &lt;span&gt;
double&lt;/span&gt; &lt;span&gt;click&lt;/span&gt; &lt;span&gt;the cell&lt;/span&gt; &lt;span&gt;to&lt;/span&gt; &lt;span&gt;display the number&lt;/span&gt;
&lt;span&gt;in&lt;/span&gt; &lt;span&gt;the correct format.&lt;/span&gt;&lt;br&gt;
&lt;span&gt;How&lt;/span&gt; &lt;span&gt;I can&lt;/span&gt; &lt;span&gt;do to&lt;/span&gt; &lt;span&gt;prevent this action&lt;/span&gt;&lt;span&gt;?&lt;/span&gt;&lt;br&gt;
&lt;br&gt;
&lt;span&gt;Thank you very much&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Spanish:&lt;/p&gt;
&lt;p&gt;Estimado,&lt;br&gt;
Estoy dando formato a las celdas con el siguiente valor: &lt;span id="result_box" lang="en"&gt;
&amp;nbsp;&lt;/span&gt;workSheet.Cells[nextRow, 7].Style.Numberformat.Format = "$ #,###.&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;";&lt;br&gt;
El formato es correcto, pero cuando abro el archivo generado, debo hacerle doble click a la celda para poder visualizar el número en formato correcto.&lt;br&gt;
¿Como puedo hacer para evitar esta acción?&lt;br&gt;
&lt;br&gt;
Muchas gracias.&lt;/p&gt;
&lt;p&gt;&lt;span lang="en"&gt;&lt;span&gt;&lt;br&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="02/05/2012 18:38:51">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Make sure you don't add the cell data as strings. Also have&amp;nbsp;a look at the FAQ about numberformats.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to show DataTable with Legends Keys">
      <Posts>
        <Post From="syedatifimtiaz" When="16/04/2012 06:40:59">
          <Html>
        
&lt;p&gt;Hi Everyone,&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Could any one please help me how can i show DataTable with legends keys in chart. In excel it is very simple as well as in Interop.Excel dll. But using EPPlus I'm stuck.&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="02/05/2012 18:37:01">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;There is no support for datatables in generated charts. If its an option you can start with a template that has a chart that is formated wit a datatable&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Check boxes">
      <Posts>
        <Post From="ssack" When="24/04/2012 19:37:12">
          <Html>
        
&lt;p&gt;How does one create a group of check boxes in the excel spreadsheet?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;
&lt;p&gt;Sal&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="25/04/2012 13:33:10">
          <Html>
        
&lt;p&gt;EPPlus doesn't support forms in this current release.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="MasterZZZZ" When="28/04/2012 11:04:56">
          <Html>
        
&lt;p&gt;when will it?&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title=".NET 2 Compatibility">
      <Posts>
        <Post From="redenil23" When="23/04/2012 15:45:09">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;i would like to ask if one of the releases is .net 2&amp;nbsp;compatible??&lt;/p&gt;
&lt;p&gt;thanks in advance.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="23/04/2012 21:18:21">
          <Html>
        
&lt;p&gt;No, EPPlus is based on System.IO.Packaging (.NET Framework 3.5).&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="redenil23" When="24/04/2012 10:30:12">
          <Html>
        
&lt;p&gt;thanks&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Specifying an unicode string in formulas">
      <Posts>
        <Post From="costab" When="24/04/2012 00:23:05">
          <Html>
        
&lt;p&gt;I want to be able to assign a formula that references an unicode string and I can't find any information on how to encode the unicode string in order for the formula to be correct.&lt;/p&gt;
&lt;p&gt;So, let's say I have a cell that returns the length of a string literal. This is the formula:&lt;/p&gt;
&lt;p&gt;=Len("Some string")&lt;/p&gt;
&lt;p&gt;If "Some string" would contain unicode chars how to I encode the literal?&lt;/p&gt;
&lt;p&gt;I realize that this is not exactly an EPPlus issue but I was wondering if someone could shed some light.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks,&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="License Question">
      <Posts>
        <Post From="ojm37a" When="05/04/2010 17:24:14">
          <Html>
        
&lt;p&gt;This is licnesed with the GPL, right?&amp;nbsp; Can I use this in commercial software? How do I license it for that purpose?&lt;/p&gt;
&lt;p&gt;Thanks,&lt;br&gt;
Owen&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="06/04/2010 07:09:10">
          <Html>
        
&lt;p&gt;The reason this project is licensed GPL is because the project I started it from, ExcelPackage is licensed GPL. I've properbly rewritten about 99% of the code from the orginal project, but there is still some interface and comments left from the start project.
 That's why I have not changed the license. I really dont know where you draw the line here, but hopfully I can change the license to LGPL some time in the future. Anyway, if you want to use the component commercial, I dont have any problem with that, but if
 you do any changes to the component that could benefit the project, please&amp;nbsp;contribute them.&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Jan Källman&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="ojm37a" When="23/04/2010 17:38:29">
          <Html>
        Thanks. 
        
    </Html>
        </Post>
        <Post From="jahjedtieson" When="22/03/2011 05:31:31">
          <Html>
        
&lt;p&gt;We would love to use this component, but the GPL license prevents us.&amp;nbsp; Is there any update available on the GPL abatement effort?&lt;/p&gt;
&lt;p&gt;Thanks.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="22/03/2011 19:33:18">
          <Html>
        
&lt;p&gt;No, I hav'nt had the time, but I will evetually have to do something.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jahjedtieson" When="22/03/2011 22:37:48">
          <Html>
        
&lt;p&gt;Thanks again.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="sgmoore" When="04/08/2011 14:20:38">
          <Html>
        
&lt;p&gt;I also would like to use the package in our&amp;nbsp;commercial&amp;nbsp;software, but unfortunately can't.&lt;/p&gt;
&lt;p&gt;&amp;gt; Anyway, if you want to use the component commercial, I dont have any problem with that,&lt;/p&gt;
&lt;p&gt;As I understand it, even if you give me your permission to use this library in my commercial software, using it will still make my software GPL and I have to hand over the source code for my software to anyone who asks for it.&lt;/p&gt;
&lt;p&gt;Also, since it is derived from&amp;nbsp;ExcelPackage, I am not sure if you can change the license without the permission of the original author, so your hands may be tied.&amp;nbsp;&lt;/p&gt;
&lt;p&gt;A pity.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="victorkahan" When="12/09/2011 06:42:10">
          <Html>
        
&lt;p&gt;Bump ;O&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mediumrare" When="27/10/2011 01:23:10">
          <Html>
        
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Is there any update on the License for this?&lt;/p&gt;
&lt;p&gt;Would like to be able to use it in our commercial software - but not possible at present.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="noptools" When="17/03/2012 22:47:01">
          <Html>
        
&lt;p&gt;I see that EPPlus is now LGPL, but I'm still not clear on how I can use this in a&amp;nbsp;commercial&amp;nbsp;application. &amp;nbsp; I want to use the compiled EPPlus dll as-is and not modified (e.g. downloaded as a NuGet package), in my application. &amp;nbsp;My .exe
 or my .dll will always be a separate unit. &amp;nbsp;I think this this falls under section 5
&lt;span&gt;"work that uses the Library", and thus&amp;nbsp;&lt;/span&gt;"&lt;span&gt;falls outside the scope of this License." &amp;nbsp; Is my interpretation correct? &amp;nbsp;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;br&gt;
&lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="18/03/2012 22:31:09">
          <Html>
        
&lt;p&gt;Yes, you can use the binary in your comercial appliciation&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="spoida" When="05/04/2012 09:43:17">
          <Html>
        
&lt;p&gt;Sorry for this long post, but I'm also seeking some clarification on using this excellent library in commercial .NET applications.&lt;/p&gt;
&lt;p&gt;Basically, my usage scenario is as follows:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Only use the library in binary form in commercial .NET applications, as obtained from this site (that is, I will never compile my own version and use that).
&lt;/li&gt;&lt;li&gt;If I ever need to make changes/fixes to the library, submit them as a pull request to the official library (which may or may not be included at the project owner's discretion. &amp;nbsp;If they are not included, tough luck for me).
&lt;/li&gt;&lt;/ol&gt;
&lt;p&gt;I've been trying to understand the LGPL v2.1, and how it relates to these requirements. &amp;nbsp;Another user above (noptools) has speculated that this type of usage falls under section 5 of the license. &amp;nbsp;But I think that according to the LGPL v2.1 it
 really means that the work is a derivative since the application is linked against the library, so section 6 is the one that matters.&lt;/p&gt;
&lt;p&gt;There's a good, simplified explanation of using LGPL v2.1 libraries with Java by David Turner at&amp;nbsp;&lt;a title="http://www.gnu.org/licenses/lgpl-java.html" href="http://www.gnu.org/licenses/lgpl-java.html" target="_blank" rel="nofollow"&gt;http://www.gnu.org/licenses/lgpl-java.html&lt;/a&gt;.
 I think fundamentally the same concepts can be applied to .NET applications, which will typically use DLLs instead of JAR files to contain libraries.&lt;/p&gt;
&lt;p&gt;According to David Turner and the LGPL v2.1, if I want to distribute commercial .NET applications that contain EPPLus I need to license my application so that it:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Allows users to modify EPPlus and then use a modified version of it in my application, provided the modified version is interface-compatible.
&lt;/li&gt;&lt;li&gt;Allows users to reverse-engineer my application solely for the purpose of debugging their modified versions of EPPlus.
&lt;/li&gt;&lt;li&gt;Includes source code for the binary version of EPPlus being used, if the EPPlus DLL is distributed with my application.
&lt;/li&gt;&lt;li&gt;Requires the user to download EPPlus separately, if EPPlus is not being distributed with my application.
&lt;/li&gt;&lt;li&gt;Gives prominent notice that the application is using EPPlus, and that EPPlus is covered by the LGPL v2.1
&lt;/li&gt;&lt;/ol&gt;
&lt;p&gt;This all seems fair enough to me. &amp;nbsp;Have I missed anything or am I over-complicating it?&lt;/p&gt;
&lt;p&gt;Basically, do I have permission to use this in a commercial application and not be required to provide my source code?&lt;/p&gt;
&lt;p&gt;Many thanks for your time and this amazing library!&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="12/04/2012 19:07:54">
          <Html>
        
&lt;p&gt;I haven't deep dived into the license questions that much, but if you use the binary you should be fine. (I'm not going to&amp;nbsp;give you any trouble anyway :) )&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="spoida" When="20/04/2012 02:11:39">
          <Html>
        
&lt;p&gt;I don't blame you for avoiding the details of the LGPL.&amp;nbsp; As programmers, it's like reading another language that we don't know the syntax for.&amp;nbsp; We can probably work it out but can't be 100% certain of the operator precedence :p&lt;/p&gt;
&lt;p&gt;Thanks for providing a response and thanks for your library.&amp;nbsp; It's rock solid, works wonderfully, and is easy to use!&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Excel Chart Series">
      <Posts>
        <Post From="syedatifimtiaz" When="13/04/2012 17:47:00">
          <Html>
        
&lt;p&gt;Hi Everyone,&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I'm trying to create excel file with chart like &lt;a title="Image" href="http://imageshack.us/photo/my-images/833/chartsample.png/" target="_blank" rel="nofollow"&gt;
this&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;http://imageshack.us/photo/my-images/833/chartsample.png/&lt;/p&gt;
&lt;p&gt;Below is my sample code, any one can help me on this???&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;string&lt;/span&gt; fileName = &lt;span style="color: rgb(163, 21, 21);"&gt;"graph_"&lt;/span&gt; + DateTime.Now.ToString(&lt;span style="color: rgb(163, 21, 21);"&gt;"yyyyMMdd"&lt;/span&gt;) + DateTime.Now.ToString(&lt;span style="color: rgb(163, 21, 21);"&gt;"HHmmss"&lt;/span&gt;) + &lt;span style="color: rgb(163, 21, 21);"&gt;".xlsx"&lt;/span&gt;;
            FileInfo Newfile = &lt;span style="color: blue;"&gt;new&lt;/span&gt; FileInfo(Server.MapPath(&lt;span style="color: rgb(163, 21, 21);"&gt;"Downloads/"&lt;/span&gt; + fileName));

            &lt;span style="color: green;"&gt;// Create Excel Package&lt;/span&gt;
            ExcelPackage package = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(Newfile);
            &lt;span style="color: green;"&gt;// Add a new sheet &lt;/span&gt;
            ExcelWorksheet Worksheet = package.Workbook.Worksheets.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"Graph"&lt;/span&gt;);

            &lt;span style="color: green;"&gt;// Worksheet Data&lt;/span&gt;

            Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"B1"&lt;/span&gt;].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"W1"&lt;/span&gt;;
            Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"D1"&lt;/span&gt;].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"W2"&lt;/span&gt;;
            Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"F1"&lt;/span&gt;].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"W3"&lt;/span&gt;;
            Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"H1"&lt;/span&gt;].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"W4"&lt;/span&gt;;
            Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"J1"&lt;/span&gt;].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"W5"&lt;/span&gt;;

            Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"B2"&lt;/span&gt;].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"C"&lt;/span&gt;;
            Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"C2"&lt;/span&gt;].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"R"&lt;/span&gt;;
            Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"D2"&lt;/span&gt;].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"C"&lt;/span&gt;;
            Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"E2"&lt;/span&gt;].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"R"&lt;/span&gt;;
            Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"F2"&lt;/span&gt;].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"C"&lt;/span&gt;;
            Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"G2"&lt;/span&gt;].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"R"&lt;/span&gt;;
            Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"H2"&lt;/span&gt;].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"C"&lt;/span&gt;;
            Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"I2"&lt;/span&gt;].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"R"&lt;/span&gt;;
            Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"J2"&lt;/span&gt;].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"C"&lt;/span&gt;;
            Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"K2"&lt;/span&gt;].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"R"&lt;/span&gt;;

            Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A3"&lt;/span&gt;].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"A"&lt;/span&gt;;
            Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A4"&lt;/span&gt;].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"B"&lt;/span&gt;;
            Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A5"&lt;/span&gt;].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"C"&lt;/span&gt;;
            Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A6"&lt;/span&gt;].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"D"&lt;/span&gt;;

            Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"B3"&lt;/span&gt;].Value = 10;
            Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"B4"&lt;/span&gt;].Value = 20;
            Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"B5"&lt;/span&gt;].Value = 30;
            Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"B6"&lt;/span&gt;].Value = 40;

            Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"C3"&lt;/span&gt;].Value = 40;
            Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"C4"&lt;/span&gt;].Value = 30;
            Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"C5"&lt;/span&gt;].Value = 20;
            Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"C6"&lt;/span&gt;].Value = 10;

            Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"D3"&lt;/span&gt;].Value = 10;
            Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"D4"&lt;/span&gt;].Value = 20;
            Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"D5"&lt;/span&gt;].Value = 30;
            Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"D6"&lt;/span&gt;].Value = 40;

            Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"E3"&lt;/span&gt;].Value = 10;
            Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"E4"&lt;/span&gt;].Value = 20;
            Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"E5"&lt;/span&gt;].Value = 30;
            Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"E6"&lt;/span&gt;].Value = 40;

            Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"F3"&lt;/span&gt;].Value = 40;
            Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"F4"&lt;/span&gt;].Value = 30;
            Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"F5"&lt;/span&gt;].Value = 20;
            Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"F6"&lt;/span&gt;].Value = 10;

            Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"G3"&lt;/span&gt;].Value = 10;
            Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"G4"&lt;/span&gt;].Value = 20;
            Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"G5"&lt;/span&gt;].Value = 30;
            Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"G6"&lt;/span&gt;].Value = 40;

            Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"H3"&lt;/span&gt;].Value = 40;
            Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"H4"&lt;/span&gt;].Value = 30;
            Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"H5"&lt;/span&gt;].Value = 20;
            Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"H6"&lt;/span&gt;].Value = 10;

            Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"I3"&lt;/span&gt;].Value = 10;
            Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"I4"&lt;/span&gt;].Value = 20;
            Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"I5"&lt;/span&gt;].Value = 30;
            Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"I6"&lt;/span&gt;].Value = 40;

            Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"J3"&lt;/span&gt;].Value = 40;
            Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"J4"&lt;/span&gt;].Value = 30;
            Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"J5"&lt;/span&gt;].Value = 20;
            Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"J6"&lt;/span&gt;].Value = 10;

            Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"K3"&lt;/span&gt;].Value = 10;
            Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"K4"&lt;/span&gt;].Value = 20;
            Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"K5"&lt;/span&gt;].Value = 30;
            Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"K6"&lt;/span&gt;].Value = 40;

            &lt;span style="color: green;"&gt;// Stacked Column            &lt;/span&gt;
            ExcelChart chart = Worksheet.Drawings.AddChart(&lt;span style="color: rgb(163, 21, 21);"&gt;"ColumnStackedChart"&lt;/span&gt;, eChartType.ColumnStacked);
            chart.Legend.Position = eLegendPosition.Right;
            chart.Legend.Add();
            chart.Title.Text = &lt;span style="color: rgb(163, 21, 21);"&gt;"Graph by Week"&lt;/span&gt;;
            chart.SetPosition(120, 50);
            chart.SetSize(800, 300);
            chart.Series.Add(Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"B3:B6"&lt;/span&gt;], Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"B1:B2"&lt;/span&gt;]);
            chart.Series.Add(Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"C3:C6"&lt;/span&gt;], Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"C1:C2"&lt;/span&gt;]);
            &lt;span style="color: green;"&gt;//chart.Series.Add(Worksheet.Cells["D3:D6"], Worksheet.Cells["D1:D2"]);&lt;/span&gt;
            &lt;span style="color: green;"&gt;//chart.Series.Add(Worksheet.Cells["E3:E6"], Worksheet.Cells["E1:E2"]);&lt;/span&gt;
            &lt;span style="color: green;"&gt;//chart.Series.Add(Worksheet.Cells["F1:F6"], Worksheet.Cells["B1:K2"]);&lt;/span&gt;
            &lt;span style="color: green;"&gt;//chart.Series.Add(Worksheet.Cells["G1:G6"], Worksheet.Cells["B1:K2"]);&lt;/span&gt;
            &lt;span style="color: green;"&gt;//chart.Series.Add(Worksheet.Cells["H1:H6"], Worksheet.Cells["B1:K2"]);&lt;/span&gt;
            &lt;span style="color: green;"&gt;//chart.Series.Add(Worksheet.Cells["I1:I6"], Worksheet.Cells["B1:K2"]);&lt;/span&gt;
            &lt;span style="color: green;"&gt;//chart.Series.Add(Worksheet.Cells["J1:J6"], Worksheet.Cells["B1:K2"]);&lt;/span&gt;
            &lt;span style="color: green;"&gt;//chart.Series.Add(Worksheet.Cells["K1:K6"], Worksheet.Cells["B1:K2"]);&lt;/span&gt;
            &lt;span style="color: green;"&gt;//chart.Style = eChartStyle.Style2;&lt;/span&gt;

            &lt;span style="color: green;"&gt;//Save&lt;/span&gt;
            package.SaveAs(Response.OutputStream);
            Response.ContentType = &lt;span style="color: rgb(163, 21, 21);"&gt;"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"&lt;/span&gt;;
            Response.AddHeader(&lt;span style="color: rgb(163, 21, 21);"&gt;"content-disposition"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"attachment;  filename="&lt;/span&gt; + fileName);
            Response.End();
&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="MikeMayer" When="17/04/2012 21:58:25">
          <Html>
        
&lt;p&gt;Might want to remove those code names from the source you're sharing :)&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="syedatifimtiaz" When="18/04/2012 06:18:50">
          <Html>
        
&lt;p&gt;Done :), chart generated too.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Data table not displaying">
      <Posts>
        <Post From="syedatifimtiaz" When="17/04/2012 05:26:27">
          <Html>
        
&lt;p&gt;Hi Everyone,&lt;/p&gt;
&lt;p&gt;I'm using the following code but the data table didn't rendered on the chart once the excel file created.&lt;/p&gt;
&lt;p&gt;ExcelBarChart chart = Worksheet.Drawings.AddChart("ColumnStackedChart", eChartType.ColumnStacked) as ExcelBarChart; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; chart.DataLabel.ShowLegendKey = true;&lt;/p&gt;
&lt;p&gt;Could any one please guide me.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Unreadable content">
      <Posts>
        <Post From="Caydence" When="21/03/2012 19:27:35">
          <Html>
        
&lt;p&gt;First off, this is an awesome tool!&lt;/p&gt;
&lt;p&gt;I'm using C# with EPPlus to create an excel file (.xlsx).&amp;nbsp; This file then gets emailed to business users.&amp;nbsp; On Windows 7 with Office 2010, I can open the file with no problem.&amp;nbsp; The business users are using Office 2007, and they get the following
 message when trying to open it.&lt;/p&gt;
&lt;p&gt;Excel found unreadable content in 'filename.xlsx'. Do you want to recover the contents of this workbook? If you trust the source of this workbook, click Yes.&lt;/p&gt;
&lt;p&gt;Has anyone dealt with this, or have a solution?&lt;/p&gt;
&lt;p&gt;Thanks!&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Caydence" When="21/03/2012 19:28:53">
          <Html>
        
&lt;p&gt;Forgot to add:&lt;/p&gt;
&lt;p&gt;If the user pushes no, and selects no to any further prompts, it will open.&amp;nbsp; This is an annoyance we would like to get rid of.&lt;/p&gt;
&lt;p&gt;Thanks!&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="pkspence" When="15/04/2012 23:41:25">
          <Html>
        
&lt;p&gt;I'm having similar problems with an .xlsm file. I'm able to successfully open a copy of the file, we don't want to touch the original, get a reference to one of the worksheets and insert rows. However, after the file is saved, when I try to open it with
 Excel 2010, I'm getting the "Excel found unreadable content..." error dialog. Here's a code snippet of that process:&lt;/p&gt;
&lt;p&gt;Anyone?&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;          &lt;span style="color: blue;"&gt;using&lt;/span&gt; (ExcelPackage xlPkg = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(&lt;span style="color: blue;"&gt;new&lt;/span&gt; FileInfo(workingFileName)))
          {
            ExcelWorksheet xlWs = xlPkg.Workbook.Worksheets[&lt;span style="color: rgb(163, 21, 21);"&gt;"Equipment Inventory"&lt;/span&gt;];

            &lt;span style="color: blue;"&gt;foreach&lt;/span&gt; (ImportEquipmentInventoryToDataset.EquipmentInventory.EquipmentInventoryRow row &lt;span style="color: blue;"&gt;in&lt;/span&gt; dt)
            {
              &lt;span style="color: blue;"&gt;string&lt;/span&gt; equipNumber = Convert.ToString(row.EquipmentUnitNumber);
              &lt;span style="color: blue;"&gt;string&lt;/span&gt; equipOperator = Convert.ToString(row.Operator);
              &lt;span style="color: blue;"&gt;string&lt;/span&gt; equipMake = Convert.ToString(row.Make);
              &lt;span style="color: blue;"&gt;string&lt;/span&gt; equipModel = Convert.ToString(row.Model);
              &lt;span style="color: blue;"&gt;string&lt;/span&gt; equipHorsePower = Convert.ToString(row.HorsePower);
              &lt;span style="color: blue;"&gt;string&lt;/span&gt; equipCapacity = Convert.ToString(row.Capacity);
              &lt;span style="color: blue;"&gt;string&lt;/span&gt; equipFEMACostCode = Convert.ToString(row.FEMACostCode);
              &lt;span style="color: blue;"&gt;double&lt;/span&gt; equipAdjustedCostCodeUnitPrice = Convert.ToDouble(row.AdjustedCostCodeUnitPrice);
              &lt;span style="color: blue;"&gt;string&lt;/span&gt; equipComments = Convert.ToString(row.Comments);

              xlWs.Cells[currentRow, 3].Value = equipNumber;
              xlWs.Cells[currentRow, 4].Value = equipOperator;
              xlWs.Cells[currentRow, 5].Value = equipMake;
              xlWs.Cells[currentRow, 6].Value = equipModel;
              xlWs.Cells[currentRow, 7].Value = equipHorsePower;
              xlWs.Cells[currentRow, 8].Value = equipCapacity;
              xlWs.Cells[currentRow, 9].Value = equipFEMACostCode;
              xlWs.Cells[currentRow, 10].Value = equipAdjustedCostCodeUnitPrice;
              xlWs.Cells[currentRow, 11].Value = equipComments;

              currentRow++;

              &lt;span style="color: green;"&gt;//break;&lt;/span&gt;
            }
            xlPkg.Save();

&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="bhavtoshsharma" When="16/04/2012 18:51:15">
          <Html>
        as said EPPlus does not support excel 2010 formats; opt for NPOI&lt;br&gt;
&lt;br&gt;
On 16/04/2012, pkspence &amp;lt;notifications@codeplex.com&amp;gt; wrote:&lt;br&gt;
&amp;gt; From: pkspence&lt;br&gt;
&amp;gt;&lt;br&gt;
&amp;gt; I'm having similar problems with an .xlsm file. I'm able to successfully&lt;br&gt;
&amp;gt; open a copy of the file, we don't want to touch the original, get a&lt;br&gt;
&amp;gt; reference to one of the worksheets and insert rows. However, after the file&lt;br&gt;
&amp;gt; is saved, when I try to open it with Excel 2010, I'm getting the "Excel&lt;br&gt;
&amp;gt; found unreadable content..." error dialog. Here's a code snippet of that&lt;br&gt;
&amp;gt; process: Anyone? using (ExcelPackage xlPkg = new ExcelPackage(new&lt;br&gt;
&amp;gt; FileInfo(workingFileName))) { ExcelWorksheet xlWs =&lt;br&gt;
&amp;gt; xlPkg.Workbook.Worksheets["Equipment Inventory"]; foreach&lt;br&gt;
&amp;gt; (ImportEquipmentInventoryToDataset.EquipmentInventory.EquipmentInventoryRow&lt;br&gt;
&amp;gt; row in dt) { string equipNumber =&lt;br&gt;
&amp;gt; Convert.ToString(row.EquipmentUnitNumber); string&lt;br&gt;
&amp;gt; equipOperator = Convert.ToString(row.Operator); string&lt;br&gt;
&amp;gt; equipMake = Convert.ToString(row.Make); string equipModel =&lt;br&gt;
&amp;gt; Convert.ToString(row.Model); string equipHorsePower =&lt;br&gt;
&amp;gt; Convert.ToString(row.HorsePower); string equipCapacity =&lt;br&gt;
&amp;gt; Convert.ToString(row.Capacity); string equipFEMACostCode =&lt;br&gt;
&amp;gt; Convert.ToString(row.FEMACostCode); double&lt;br&gt;
&amp;gt; equipAdjustedCostCodeUnitPrice =&lt;br&gt;
&amp;gt; Convert.ToDouble(row.AdjustedCostCodeUnitPrice); string&lt;br&gt;
&amp;gt; equipComments = Convert.ToString(row.Comments);&lt;br&gt;
&amp;gt; xlWs.Cells[currentRow, 3].Value = equipNumber;&lt;br&gt;
&amp;gt; xlWs.Cells[currentRow, 4].Value = equipOperator;&lt;br&gt;
&amp;gt; xlWs.Cells[currentRow, 5].Value = equipMake;&lt;br&gt;
&amp;gt; xlWs.Cells[currentRow, 6].Value = equipModel;&lt;br&gt;
&amp;gt; xlWs.Cells[currentRow, 7].Value = equipHorsePower;&lt;br&gt;
&amp;gt; xlWs.Cells[currentRow, 8].Value = equipCapacity;&lt;br&gt;
&amp;gt; xlWs.Cells[currentRow, 9].Value = equipFEMACostCode;&lt;br&gt;
&amp;gt; xlWs.Cells[currentRow, 10].Value = equipAdjustedCostCodeUnitPrice;&lt;br&gt;
&amp;gt; xlWs.Cells[currentRow, 11].Value = equipComments;&lt;br&gt;
&amp;gt; currentRow++; //break; }&lt;br&gt;
&amp;gt; xlPkg.Save();&lt;br&gt;
&amp;gt;&lt;br&gt;
&amp;gt; &lt;br&gt;
&lt;br&gt;
&lt;br&gt;
-- &lt;br&gt;
Greetings,&lt;br&gt;
Bhavtosh Sharma
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="16/04/2012 19:01:51">
          <Html>
        
&lt;p&gt;EPPlus handles OOXML standard, so it will support Excel 2007 and 2010. I cant imagine why works fine local but not works after send by mail.&lt;/p&gt;
&lt;p&gt;How do you send by mail? Did you send using your own code? Did you try to send using another client or web client ?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="pkspence" When="17/04/2012 00:04:50">
          <Html>
        
&lt;blockquote style="margin: 0.25em 1em 0px; padding: 0px 0.25em; border: 0.1em solid rgb(204, 204, 204); border-image: none; font-style: italic;"&gt;
&lt;strong&gt;bhavtoshsharma wrote:&lt;/strong&gt;&lt;br&gt;
as said EPPlus does not support excel 2010 formats; opt for NPOI&lt;br&gt;
&lt;br&gt;
-- &lt;br&gt;
Greetings,&lt;br&gt;
Bhavtosh Sharma&lt;/blockquote&gt;
&lt;p&gt;&amp;nbsp;I'd understood that EEPlus &lt;em&gt;does&lt;/em&gt; support Office 2007/2010 format. I've used NPOI extensively in both web and desktop applications and it's great, but it does
&lt;em&gt;not&lt;/em&gt; support the OOXML standard, at least not yet.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Problem with Numberformat.Format">
      <Posts>
        <Post From="gmocontreras" When="16/04/2012 22:33:57">
          <Html>
        
&lt;p&gt;I tried to set the next formula &lt;strong&gt;\$_-* #.&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/00"&gt;#00&lt;/a&gt;,00&lt;/strong&gt;. But, in the excel appears the next formula
&lt;strong&gt;\$_-* #,&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0000"&gt;#0000&lt;/a&gt;&lt;/strong&gt;, It's a component bug?&lt;/p&gt;
&lt;p&gt;Example:&lt;/p&gt;
&lt;p&gt;&lt;span id="result_box" lang="en"&gt;&lt;span&gt;I do the&lt;/span&gt; &lt;span&gt;following:&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;currencyFormat="\\$_-* #.&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/00"&gt;#00&lt;/a&gt;,00";&lt;/p&gt;
&lt;p&gt;Numberformat.Format = currencyFormat;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="[Solved] Cell SetColor System.ArgumentException">
      <Posts>
        <Post From="hoelzelre" When="13/04/2012 12:20:37">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;i getting te follwing error if i try to add color to a cell:&lt;br&gt;
Eine Ausnahme (erste Chance) des Typs "System.ArgumentException" ist in EPPlus.dll aufgetreten.&lt;/p&gt;
&lt;p&gt;Here is my code:&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;Dim&lt;/span&gt; newFile &lt;span style="color: blue;"&gt;As&lt;/span&gt; FileInfo = &lt;span style="color: blue;"&gt;New&lt;/span&gt; FileInfo(&lt;span style="color: rgb(163, 21, 21);"&gt;"C:\temp\created.xlsx"&lt;/span&gt;)
	&lt;span style="color: blue;"&gt;If&lt;/span&gt; newFile.Exists &lt;span style="color: blue;"&gt;Then&lt;/span&gt;
		newFile.Delete()
	newFile = &lt;span style="color: blue;"&gt;New&lt;/span&gt; FileInfo(&lt;span style="color: rgb(163, 21, 21);"&gt;"C:\temp\created.xlsx"&lt;/span&gt;)
&lt;span style="color: blue;"&gt;End&lt;/span&gt; &lt;span style="color: blue;"&gt;If&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;Using&lt;/span&gt; Package &lt;span style="color: blue;"&gt;As&lt;/span&gt; &lt;span style="color: blue;"&gt;New&lt;/span&gt; ExcelPackage(newFile)
	&lt;span style="color: blue;"&gt;Dim&lt;/span&gt; Worksheet &lt;span style="color: blue;"&gt;As&lt;/span&gt; ExcelWorksheet = Package.Workbook.Worksheets.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"Export"&lt;/span&gt;)

	Worksheet.Cells(&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;).Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"Test"&lt;/span&gt;
	Worksheet.Cells(&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;).Style.Font.Bold = &lt;span style="color: blue;"&gt;True&lt;/span&gt;
	Worksheet.Cells(&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;).Style.Fill.BackgroundColor.SetColor(Color.Brown)
	Package.Save()
&lt;span style="color: blue;"&gt;End&lt;/span&gt; &lt;span style="color: blue;"&gt;Using&lt;/span&gt;
&lt;/pre&gt;
&lt;pre&gt;If i comment Worksheet.Cells(&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;).Style.Fill.BackgroundColor.SetColor(Color.Brown) out, all worked fine.&lt;/pre&gt;
&lt;pre&gt;Any ideas ?&lt;/pre&gt;
&lt;pre&gt;[SOLVED]&lt;/pre&gt;
&lt;pre&gt;L0L... i've found the answer after a little more testing.&lt;/pre&gt;
&lt;pre&gt;Before you can call SetColor(), you must set the PatternType:&lt;div style="color: black; background-color: white;"&gt;&lt;pre&gt;Worksheet.Cells(&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;).Style.Fill.PatternType = ExcelFillStyle.Solid
&lt;/pre&gt;
&lt;/div&gt;
&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="13/04/2012 13:33:48">
          <Html>
        
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;set patterntype before setcolor...

            &lt;span style="color: blue;"&gt;using&lt;/span&gt; (ExcelPackage p = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(tmpl1))
            {
                &lt;span style="color: blue;"&gt;var&lt;/span&gt; ws = p.Workbook.Worksheets.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"teste"&lt;/span&gt;);
                
                ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"Test"&lt;/span&gt;;
	        ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;].Style.Font.Bold = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
                ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;].Style.Fill.PatternType = ExcelFillStyle.Solid;
	        ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;].Style.Fill.BackgroundColor.SetColor(Color.Brown);
	        p.Save();
            }
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;PS:&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Ops, I didnt see you´ve already solved your issue hehehe =)&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Writing Bytestream using EPPlus">
      <Posts>
        <Post From="Atarpan" When="10/04/2012 09:10:37">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Greetings and thanks for the excellent tool. It helped me a lot while developing. I am stuck in a scenario. I hav already a rdlc file from where i am getting bytestream to export the rdlc content to Excel. Is there any way to write the bytestream using EPPlus.
 Thanks in advance. &amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Atarpan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Atarpan" When="12/04/2012 04:16:36">
          <Html>
        
&lt;p&gt;found an workaround ... i have rendered the localreport to an image and converted it to a image byte array ....put the bytearray to the excel sheet and Bingo!!! it worked but its still coming as image if someone has better approch to keep the data as it
 is ,please suggest . Thanks in advance.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="12/04/2012 18:54:33">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;EPPlus can only read and write xlsx, so I cant think of a way to solve your problem.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Atarpan" When="13/04/2012 08:33:33">
          <Html>
        
&lt;p&gt;Hi, Thanks for your reply . yes, i am totally agree with you, EPPlus writes only to xlsx... the data i am getting from an report is in byte array format for an Excel .. we have already some method there to put images ..&lt;/p&gt;
&lt;p&gt;byte[] data = File.ReadAllBytes(@"someimage.jpg");&lt;br&gt;
MemoryStream ms = new MemoryStream(data);&lt;br&gt;
using (System.Drawing.Image img = System.Drawing.Image.FromStream(ms))&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; if (img != null)&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ExcelPicture pic = ws.Drawings.AddPicture("Pic1", img);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; pic.SetSize(pictureWidth, pictureHeight);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;/p&gt;
&lt;p&gt;can you please suggest how can i put an excel MemoryStream to an excel worksheet. I am getting byte array from that rdlc in below format&lt;/p&gt;
&lt;p&gt;string reportType = "Excel";&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; string mimeType;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; string encoding;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; string fileNameExtension;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; string deviceInfo =&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; "&amp;lt;DeviceInfo&amp;gt;" +&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; "&amp;nbsp; &amp;lt;OutputFormat&amp;gt;Excel&amp;lt;/OutputFormat&amp;gt;" +&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; "&amp;nbsp; &amp;lt;PageWidth&amp;gt;20in&amp;lt;/PageWidth&amp;gt;" +&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; "&amp;nbsp; &amp;lt;PageHeight&amp;gt;15in&amp;lt;/PageHeight&amp;gt;" +&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; "&amp;nbsp; &amp;lt;MarginTop&amp;gt;0.5in&amp;lt;/MarginTop&amp;gt;" +&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; "&amp;nbsp; &amp;lt;MarginLeft&amp;gt;1in&amp;lt;/MarginLeft&amp;gt;" +&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; "&amp;nbsp; &amp;lt;MarginRight&amp;gt;1in&amp;lt;/MarginRight&amp;gt;" +&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; "&amp;nbsp; &amp;lt;MarginBottom&amp;gt;0.5in&amp;lt;/MarginBottom&amp;gt;" +&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; "&amp;lt;/DeviceInfo&amp;gt;";&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Warning[] warnings;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; string[] streams;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; byte[] renderedBytes;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; renderedBytes = rptlocalReportName.LocalReport.Render(&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; reportType,&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; deviceInfo,&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; out mimeType,&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; out encoding,&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; out fileNameExtension,&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; out streams,&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; out warnings);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; return renderedBytes;&amp;nbsp;&lt;/p&gt;
&lt;div id="_mcePaste" style="left: -10000px; top: 0px; width: 1px; height: 1px; overflow: hidden;"&gt;
﻿&lt;/div&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Workbook.Worksheets.Count == 0">
      <Posts>
        <Post From="FireShock" When="06/04/2012 12:27:15">
          <Html>
        
&lt;p&gt;I have xlsx-files in this format:&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="http://dl.dropbox.com/u/21533228/xlsx.png"&gt;&lt;/p&gt;
&lt;p&gt;and&amp;nbsp;Workbook.Worksheets.Count == 0.&lt;/p&gt;
&lt;p&gt;&lt;span&gt;If&lt;/span&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;span&gt;I open the file&lt;/span&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;span&gt;in the office and&lt;/span&gt;&lt;span&gt;&amp;nbsp;resave&amp;nbsp;&lt;/span&gt;&lt;span&gt;it&lt;/span&gt;&lt;span&gt;, it&lt;/span&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;span&gt;has the following format:&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="http://dl.dropbox.com/u/21533228/xlsx2.png"&gt;&lt;/p&gt;
&lt;p&gt;and Workbook.Worksheets.Count == 2, a&lt;span&gt;s it should be&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Is there&amp;nbsp;&lt;span&gt;a solution&lt;/span&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;span&gt;to this problem without resave file?&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;Thanks.&lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="12/04/2012 19:01:30">
          <Html>
        
&lt;p&gt;No, I have never seen the&amp;nbsp;first file structure. EPPlus assumes that the xl folder exists.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Does this version support the Axis title?">
      <Posts>
        <Post From="wuhucome" When="29/06/2011 06:04:23">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I want to add Y axis title to tell users the Y axis unit is hours or number.&lt;/p&gt;
&lt;p&gt;Does it support axis title for chart?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;thanks,&lt;/p&gt;
&lt;p&gt;Carlos&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="zone51" When="19/07/2011 10:35:06">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Need this feature too.&lt;/p&gt;
&lt;p&gt;any response?&lt;/p&gt;
&lt;p&gt;10x&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="kingkong0924" When="20/08/2011 04:34:42">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Need this feature. x3&lt;/p&gt;
&lt;p&gt;Thanks!&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="wuhucome" When="23/08/2011 11:23:06">
          <Html>
        
&lt;p&gt;I think this is very common feature for a chart.&amp;nbsp;&lt;/p&gt;
&lt;p&gt;In my code,&amp;nbsp;I used another lable to show the Axis Title.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="23/08/2011 20:11:19">
          <Html>
        
&lt;p&gt;I'll add this to my TODO list.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="sehe147" When="10/04/2012 18:56:13">
          <Html>
        
&lt;p&gt;I am looking for this feature as well. Has there been any update on this?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="12/04/2012 18:55:34">
          <Html>
        This discussion has been copied to a work item. Click &lt;a href="http://epplus.codeplex.com/workitem/14685" rel="nofollow"&gt;
here&lt;/a&gt; to go to the work item and continue the discussion.
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Error when open excel over ASP.NET">
      <Posts>
        <Post From="mihaibig" When="06/04/2012 14:57:45">
          <Html>
        
&lt;p&gt;Hello,&lt;/p&gt;
&lt;p&gt;I have generated an excel using EPPlus and when I open the file (over HttpResponseStream) I get the next messages.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Excel found unreadable content in "ReportName". Do you want to recover the content of this workbook? Yes/No&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;If I choose Yes I get the next message:&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;The File cannot be opened by using Microsoft Excel. Do you want to search the Microsoft Office Online Web site for a converter to open the file? [Yes/No/Cancel]&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;If I choose No the file is opened and I am notified that the file was repaired, and everything looks ok.&lt;/p&gt;
&lt;p&gt;Does someone have experience using EPPlus on ASP.NET applications?&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="xizwyck" When="09/04/2012 18:05:49">
          <Html>
        
&lt;p&gt;I was getting the same error. It wasn't the file creation but transmitting it to the user... I'm still trying to work on a solution myself.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="xizwyck" When="09/04/2012 19:12:02">
          <Html>
        
&lt;p&gt;I ended up emailing the file instead, it works for my purpose.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Calculated Field in pivot table">
      <Posts>
        <Post From="KalpeshPusalkar" When="07/04/2012 13:01:01">
          <Html>
        
&lt;p&gt;Hi Everyone,&lt;/p&gt;
&lt;p&gt;I am using&amp;nbsp;EPPlus 3.0.0.2 library to export advance excelsheets from Asp.net C#.&lt;/p&gt;
&lt;p&gt;Its a very nice and user friendly library.&lt;/p&gt;
&lt;p&gt;I am facing a problem since sometime now while generating a pivot table im not able to insert any&amp;nbsp;Calculated Field in the pivot table.&lt;/p&gt;
&lt;p&gt;I've read that this functionality is avaliable in EPPlus 3.0.0.2 library.&lt;/p&gt;
&lt;p&gt;Would be really glad if someone could help me out with this.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks in advance.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="kalpeshpusalkar" When="09/04/2012 13:22:18">
          <Html>
        
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Hey guys,&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;You cant do that directly, i found a workaround on another thread.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;1. Create an excel spreadsheet template containing a worksheet with the data, and a worksheet with the pivottable.&lt;/p&gt;
&lt;p&gt;2. Setup the pivottable exactly how i need it, including the calculated field,&lt;/p&gt;
&lt;p&gt;3. Load the ExcelPackage with the constructor (Stream newFile, Stream template)&lt;/p&gt;
&lt;p&gt;4. Load the necessary data into the worksheet with the data, then save it.&lt;/p&gt;
&lt;p&gt;Works like a charm!&lt;/p&gt;
&lt;p&gt;Here's a sample&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;pre&gt;//Create a FileInfo object by passsing the source address of the file
FileInfo fInfo = new FileInfo(@"d:\Sample.xlsx");
using (ExcelPackage p = new ExcelPackage(fInfo))// Pass this to the constructor
{
ExcelWorksheet ws = p.Workbook.Worksheets["Sheet1"];//Find your source sheet
//Re draw the table
//Output the excel and your done 
}&lt;/pre&gt;
&lt;p&gt;Hope it helps you&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Calculation field in pivot tables">
      <Posts>
        <Post From="skeesara" When="30/01/2012 10:02:33">
          <Html>
        
&lt;p&gt;I have application which is based on Interop assembly to create pivot table and I create a calculated field using the following code.﻿&lt;/p&gt;
&lt;p&gt;﻿﻿pf.Calculation=Excel.XIPivotFieldCalculation.xlPercentageOfRow;&lt;/p&gt;
&lt;p&gt;I am rewriting this windows app as web app and started using epplus to generate the excel file on the server side.&lt;/p&gt;
&lt;p&gt;But I do not see any option to create ﻿xlPercentageOfRow and xlPercentageColumn fields on the pivot table using eppls.&lt;/p&gt;
&lt;p&gt;How can I do this using eplus?&lt;/p&gt;
&lt;p&gt;-Sudheer&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;﻿﻿﻿﻿﻿﻿﻿﻿﻿&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="31/01/2012 18:43:20">
          <Html>
        
&lt;p&gt;No, that's not implemented in this release.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="kalpeshpusalkar" When="09/04/2012 04:04:45">
          <Html>
        
&lt;p&gt;JanKallman is this functionality implemented in 3.0.0.2 release.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="kalpeshpusalkar" When="09/04/2012 13:21:09">
          <Html>
        
&lt;p&gt;Hey skeesara,&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;You cant do that directly, i found a workaround on another thread.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;1. Create an excel spreadsheet template containing a worksheet with the data, and a worksheet with the pivottable.&lt;/p&gt;
&lt;p&gt;2. Setup the pivottable exactly how i need it, including the calculated field,&lt;/p&gt;
&lt;p&gt;3. Load the ExcelPackage with the constructor (Stream newFile, Stream template)&lt;/p&gt;
&lt;p&gt;4. Load the necessary data into the worksheet with the data, then save it.&lt;/p&gt;
&lt;p&gt;Works like a charm!&lt;/p&gt;
&lt;p&gt;Here's a sample&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;pre&gt;//Create a FileInfo object by passsing the source address of the file
FileInfo fInfo = new FileInfo(@"d:\Sample.xlsx");
using (ExcelPackage p = new ExcelPackage(fInfo))// Pass this to the constructor
{
ExcelWorksheet ws = p.Workbook.Worksheets["Sheet1"];//Find your source sheet
//Re draw the table
//Output the excel and your done 
}&lt;/pre&gt;
Hope it helps you
&lt;p&gt;&lt;/p&gt;
&lt;pre&gt;&lt;/pre&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Adding a calculated field to a PivotTable">
      <Posts>
        <Post From="Makolyte" When="14/09/2011 22:31:55">
          <Html>
        
&lt;p&gt;I can't find anything in the documentation about adding a calculated field to the PivotTable. I was wondering if there is anyway to do this?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Makolyte" When="15/09/2011 00:16:05">
          <Html>
        
&lt;p&gt;Nevermind, i figured out a workaround.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;1. Create an excel spreadsheet template containing a worksheet with the data, and a worksheet with the pivottable.&lt;/p&gt;
&lt;p&gt;2. Setup the pivottable exactly how i need it, including the calculated field,&lt;/p&gt;
&lt;p&gt;3. Load the ExcelPackage with the constructor (Stream newFile, Stream template)&lt;/p&gt;
&lt;p&gt;4. Load the necessary data into the worksheet with the data, then save it.&lt;/p&gt;
&lt;p&gt;Works like a charm!&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Makolyte" When="15/09/2011 02:57:35">
          <Html>
        
&lt;p&gt;Nevermind, that solution doesn't work. In fact, you can't use LoadFromDataTable on a template, it doesn't overwrite the data that's already in there.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Edit: Wow, sorry for all the posts. I figured this out. All you need to do after loading the new data into the template is change the PivotTable.CacheDefinition.SourceRange to the data worksheet's Dimension. Thank god this is open source and i could actually
 figure that out by backtracking through the code. P.S. Keep up the great work on this project.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="kalpeshpusalkar" When="09/04/2012 11:41:12">
          <Html>
        
&lt;p&gt;Hi Makolyte,&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I want to implement the same functionality in one of my project.&lt;/p&gt;
&lt;p&gt;Can you please help me out with the method how you managed to accomplish this?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks in advance.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="kalpeshpusalkar" When="09/04/2012 13:11:10">
          <Html>
        
&lt;p&gt;Hey Makolyte,&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Just googled it a bit more and finally got it.&lt;/p&gt;
&lt;p&gt;But thanks for your this thread, wouldnt even had known if you would not had posted this.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks alot.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Excel found unreadable content in">
      <Posts>
        <Post From="izxp" When="06/04/2012 05:08:25">
          <Html>
        
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;&lt;span style="white-space: pre;"&gt;&lt;div style="color: black; background-color: white;"&gt;&lt;pre&gt;&lt;span style="color: blue;"&gt;               string&lt;/span&gt; picturePath = Server.MapPath(&lt;span style="color: rgb(163, 21, 21);"&gt;"~/Styles/Images/111.jpg"&lt;/span&gt;);
                System.Drawing.Bitmap picture = &lt;span style="color: blue;"&gt;new&lt;/span&gt; System.Drawing.Bitmap(picturePath);
                picture.SetResolution(96.0F, 96.0F);
                ExcelPicture pictureLogo = sheet.Drawings.AddPicture(&lt;span style="color: rgb(163, 21, 21);"&gt;"pictureLogo"&lt;/span&gt;, picture);

                pictureLogo.SetSize(38);
                pictureLogo.SetPosition(1, -65, 14, -235);
&lt;/pre&gt;
&lt;pre&gt;&lt;br&gt;&lt;/pre&gt;
&lt;pre&gt;when I export excel then modify other cell fomart.save the excel then open it.it will show&lt;/pre&gt;
&lt;/div&gt;
&lt;/span&gt;&lt;/span&gt;﻿Excel found unreadable content in ....when I click 'yes'.the picture and sharp will lost all.&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Get all Checkboxes (Choices)">
      <Posts>
        <Post From="suam111" When="05/04/2012 10:01:26">
          <Html>
        
&lt;p&gt;Hello,&lt;/p&gt;
&lt;p&gt;I need to get all checkboxes (choices) and&amp;nbsp;dropdowns&amp;nbsp;out of a xlsx-Document and check programmatically if they are checked or not.&lt;/p&gt;
&lt;p&gt;Is there any posibility to do this with this library? I've already tried, but I wasn't able to get any results...&lt;/p&gt;
&lt;p&gt;Thanks!&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="ColumnClustered chart - Add Data Labels">
      <Posts>
        <Post From="mrfg" When="16/01/2012 04:19:25">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I am new to EPPlus and trying to add Data Labels to&amp;nbsp;ColumnClustered chart.&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I created&amp;nbsp;ColumnClustered chart and using Office 2007 I can add Data Labels (Select Data Series -&amp;gt; Mouse Right Click -&amp;gt; Add Data Labels).&lt;/p&gt;
&lt;p&gt;Is it possible to code to&amp;nbsp;add data labels? (ColumnClustered chart)&lt;br&gt;
Is it possible to set ColumnClustered&amp;nbsp;chart Layout? like setting Style.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="pahamad" When="05/04/2012 07:05:38">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Did you got your solution about this issue?I am trying same thing to show DataLabel on series but didn't saw any property or method.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="pahamad" When="05/04/2012 07:05:39">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Did you got your solution about this issue?I am trying same thing to show DataLabel on series but didn't saw any property or method.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="pahamad" When="05/04/2012 07:55:29">
          <Html>
        
&lt;p&gt;Guys got solution, need typecast as barchart then can show the data label as:&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;pre&gt;&lt;span&gt;var&lt;/span&gt;&amp;nbsp;chart&amp;nbsp;=&amp;nbsp;(sheet.Drawings.AddChart(&lt;span&gt;"chart1"&lt;/span&gt;,&amp;nbsp;&lt;span&gt;eChartType&lt;/span&gt;.ColumnClustered))&amp;nbsp;&lt;span&gt;as&lt;/span&gt;&amp;nbsp;&lt;span&gt;ExcelBarChart&lt;/span&gt;&amp;nbsp;&amp;nbsp;;&lt;/pre&gt;
&lt;pre&gt;chart.DataLabel.ShowValue&amp;nbsp;=&amp;nbsp;true;&lt;/pre&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="This operation is not supported for a relative URI">
      <Posts>
        <Post From="ririck" When="08/03/2012 18:13:56">
          <Html>
        
&lt;p&gt;I am getting this error after upgrading an application that reads excel files to latest release. The application was working with previous release&lt;/p&gt;
&lt;p&gt;I get this error also when I move the excel files in a local directory&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Amaranth" When="04/04/2012 16:33:21">
          <Html>
        
&lt;p&gt;I have the same error when opening the workbook. My filename looks liek this : "\\Server\Folder\File.xlsx". I tried with the version 3.0.2 and 2.9.0.1.&lt;/p&gt;
&lt;p&gt;Here is the code :&lt;/p&gt;
&lt;p&gt;FileInfo file = new FileInfo(_filename);&lt;/p&gt;
&lt;p&gt;ExcelPackage pack = new ExcelPackage(file);&lt;/p&gt;
&lt;p&gt;ExcelWorksheet sheet = pack.Workbook.Worksheets[1]; //Throws exception&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Search for text in worksheet">
      <Posts>
        <Post From="ralphtrentacosta" When="29/03/2012 18:58:53">
          <Html>
        
&lt;p&gt;Hello&lt;/p&gt;
&lt;p&gt;Is it possible to search for text? &amp;nbsp;I know what columns I want to look in but I see now way to search for text in that column.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks,&lt;/p&gt;
&lt;p&gt;Ralph Trent&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="02/04/2012 06:34:41">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I suggest you use Linq. Have a look at the Sample 8.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="ralphtrentacosta" When="02/04/2012 21:36:55">
          <Html>
        Thanks, I will take a look.
&lt;div&gt;&lt;br&gt;
&lt;/div&gt;
&lt;div&gt;Ralph&lt;br&gt;
&lt;br&gt;
&lt;div&gt;On Mon, Apr 2, 2012 at 1:34 AM, jankallman &lt;span dir="ltr"&gt;&amp;lt;&lt;a href="mailto:notifications@codeplex.com" rel="nofollow"&gt;notifications@codeplex.com&lt;/a&gt;&amp;gt;&lt;/span&gt; wrote:&lt;br&gt;
&lt;blockquote style="margin: 0px 0px 0px 0.8ex; padding-left: 1ex; border-left-color: rgb(204, 204, 204); border-left-width: 1px; border-left-style: solid;"&gt;
&lt;div&gt;
&lt;p&gt;From: jankallman&lt;/p&gt;
&lt;div&gt;
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I suggest you use Linq. Have a look at the Sample 8.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;
&lt;/div&gt;
&lt;div&gt;
&lt;p&gt;Read the &lt;a href="http://epplus.codeplex.com/discussions/350521#post818570" target="_blank" rel="nofollow"&gt;
full discussion online&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;To add a post to this discussion, reply to this email (&lt;a href="mailto:EPPlus@discussions.codeplex.com?subject=[EPPlus:350521]" target="_blank" rel="nofollow"&gt;EPPlus@discussions.codeplex.com&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;To start a new discussion for this project, email &lt;a href="mailto:EPPlus@discussions.codeplex.com" target="_blank" rel="nofollow"&gt;
EPPlus@discussions.codeplex.com&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;You are receiving this email because you subscribed to this discussion on CodePlex. You can
&lt;a href="https://epplus.codeplex.com/discussions/350521/unsubscribe/" target="_blank" rel="nofollow"&gt;
unsubscribe&lt;/a&gt; on CodePlex.com.&lt;/p&gt;
&lt;p&gt;Please note: Images and attachments will be removed from emails. Any posts to this discussion will also be available online at CodePlex.com&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/blockquote&gt;
&lt;/div&gt;
&lt;br&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="error when using method cells.copy if row have 2 merge cells">
      <Posts>
        <Post From="hunghm1980" When="02/04/2012 05:32:36">
          <Html>
        
&lt;p&gt;I'm using method cells.copy to copy row, source row have 2 group mercel, example, I merge cell B20:H20 and I20:J20.&lt;/p&gt;
&lt;p&gt;When i using copy method:&amp;nbsp; &lt;strong&gt;worksheet.Cells["A20:K20"].Copy(worksheet.Cells["A30:K30"]);&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;in row 30, Cell merged is &lt;strong&gt;B30:J30 &lt;/strong&gt;while must be &lt;strong&gt;B30:H30 and I30:J30;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;I debug in method copy found, code to check merge cell not correct, i change it to correct loop, (red font)&lt;/p&gt;
&lt;p&gt;Sorry because my bad English.&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &lt;em&gt;&lt;strong&gt;//Add merged cells&lt;/strong&gt;&lt;/em&gt;&lt;br&gt;
&lt;em&gt;&lt;strong&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; if(mergedCells.Count&amp;gt;0)&lt;/strong&gt;&lt;/em&gt;&lt;br&gt;
&lt;em&gt;&lt;strong&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;/strong&gt;&lt;/em&gt;&lt;br&gt;
&lt;em&gt;&lt;strong&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; List&amp;lt;ExcelAddressBase&amp;gt; mergedAddresses = new List&amp;lt;ExcelAddressBase&amp;gt;();&lt;/strong&gt;&lt;/em&gt;&lt;br&gt;
&lt;em&gt;&lt;strong&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; foreach (var cell in mergedCells.Values)&lt;/strong&gt;&lt;/em&gt;&lt;br&gt;
&lt;em&gt;&lt;strong&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;/strong&gt;&lt;/em&gt;&lt;br&gt;
&lt;em&gt;&lt;strong&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; if(!IsAdded(cell, mergedAddresses))&lt;/strong&gt;&lt;/em&gt;&lt;br&gt;
&lt;em&gt;&lt;strong&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;/strong&gt;&lt;/em&gt;&lt;br&gt;
&lt;em&gt;&lt;strong&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; int startRow = cell.Row, startCol = cell.Column, endRow = cell.Row, endCol = cell.Column+1;&lt;/strong&gt;&lt;/em&gt;&lt;br&gt;
&lt;em&gt;&lt;strong&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; while (mergedCells.ContainsKey(ExcelCell.GetCellID(Destination.Worksheet.SheetID, endRow, endCol)))&lt;/strong&gt;&lt;/em&gt;&lt;br&gt;
&lt;em&gt;&lt;strong&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;/strong&gt;&lt;/em&gt;&lt;em&gt;&lt;strong&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/strong&gt;&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
&lt;span style="color: rgb(255, 0, 0);"&gt;// fix error when endCol &amp;gt; mergedCells.Count&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span style="color: rgb(255, 0, 0);"&gt;&amp;nbsp; // endCol exceed mergedCells.Count&lt;/span&gt;&lt;br&gt;
&lt;span style="color: rgb(255, 0, 0);"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; if (endCol == mergedCells.Count)&lt;/span&gt;&lt;br&gt;
&lt;span style="color: rgb(255, 0, 0);"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;/span&gt;&lt;br&gt;
&lt;span style="color: rgb(255, 0, 0);"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; break;&lt;/span&gt;&lt;br&gt;
&lt;span style="color: rgb(255, 0, 0);"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;em&gt;&lt;strong&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
&lt;/strong&gt;&lt;/em&gt;&lt;/span&gt;&lt;br&gt;
&lt;em&gt;&lt;strong&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; endCol++;&lt;/strong&gt;&lt;/em&gt;
&lt;br&gt;
&lt;em&gt;&lt;strong&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;/strong&gt;&lt;/em&gt;&lt;br&gt;
&lt;br&gt;
&lt;em&gt;&lt;strong&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; while(IsMerged(mergedCells, Destination.Worksheet, endRow, startCol,endCol-1))&lt;/strong&gt;&lt;/em&gt;&lt;br&gt;
&lt;em&gt;&lt;strong&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;/strong&gt;&lt;/em&gt;&lt;br&gt;
&lt;em&gt;&lt;strong&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; endRow++;&lt;/strong&gt;&lt;/em&gt;&lt;br&gt;
&lt;em&gt;&lt;strong&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;/strong&gt;&lt;/em&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
&lt;br&gt;
&lt;em&gt;&lt;strong&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; mergedAddresses.Add(new ExcelAddressBase(startRow, startCol, endRow-1, endCol-1));&lt;/strong&gt;&lt;/em&gt;&lt;br&gt;
&lt;em&gt;&lt;strong&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;/strong&gt;&lt;/em&gt;&lt;br&gt;
&lt;em&gt;&lt;strong&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;/strong&gt;&lt;/em&gt;&lt;br&gt;
&lt;em&gt;&lt;strong&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Destination.Worksheet.MergedCells.List.AddRange((from r in mergedAddresses select r.Address));&lt;/strong&gt;&lt;/em&gt;&lt;br&gt;
&lt;em&gt;&lt;strong&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;/strong&gt;&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="02/04/2012 06:35:32">
          <Html>
        This discussion has been copied to a work item. Click &lt;a href="http://epplus.codeplex.com/workitem/14680" rel="nofollow"&gt;
here&lt;/a&gt; to go to the work item and continue the discussion.
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="AutoFilter">
      <Posts>
        <Post From="bhavtoshsharma" When="23/03/2012 08:08:20">
          <Html>
        
&lt;p&gt;hi all,&lt;/p&gt;
&lt;p&gt;im trying to write an excel with worksheet.Cells.AutoFilter = True. File is saved without errors but excel shows error while opening file and removes the filter feature.&lt;/p&gt;
&lt;p&gt;any work around in EPPPlus?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;thanks&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="02/04/2012 06:31:42">
          <Html>
        
&lt;p&gt;Specify the range in the indexer...&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;worksheet.Cells[worksheet.Dimension.Address].AutoFilter=&lt;span style="color: blue;"&gt;true&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;...for the entire worksheet.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Can EPP do this?">
      <Posts>
        <Post From="gte" When="11/02/2012 22:25:08">
          <Html>
        
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I can't find this in the documentation and have been googling for hours, so I apologize if this is a simpleton question. Can EPP create an excel xlsx file, save it, then update it row by row as information is streamed to it?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="12/02/2012 13:42:01">
          <Html>
        
&lt;p&gt;What do you mean by "update it row by row as informations is streamed" ? Epplus can create new files and update existing files.&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="gte" When="12/02/2012 15:25:12">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I cannot find an example of where EPP creates an excel document, creates a header row and saves it. Then after that, it comes back to the document and then inserts/updates a subsequent row of data, closes it, saves it. And then does that as much as the program
 wants to update it.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;So it would look like:&lt;/p&gt;
&lt;p&gt;creates/saves/closes --&amp;gt; updates subsequent row/saves/closes --&amp;gt; updates subsequent row/saves/closes --&amp;gt; updates subsequent row/saves/closes --&amp;gt; etc&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="gte" When="17/02/2012 22:04:24">
          <Html>
        
&lt;p&gt;Does anyone have an example, or a link to instructions on how to open an excel document, write a line and then save/close it?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="21/02/2012 21:52:26">
          <Html>
        
&lt;p&gt;I dont have any sample now, I´m on vacation, its carnival here in brazil hehehe, but its very simple! Just open your file as memorystream and pass to ExcelPackage constructor. =)&lt;/p&gt;
&lt;p&gt;PS: look at this thread&amp;nbsp;http://epplus.codeplex.com/discussions/256064&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jgreg311" When="30/03/2012 22:15:09">
          <Html>
        
&lt;p&gt;There is a sample project in the Downloads section that contains many samples.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Vlookup Formula issues">
      <Posts>
        <Post From="danilomgarcia" When="29/03/2012 14:35:21">
          <Html>
        
&lt;p&gt;Hi,&lt;br&gt;
&lt;br&gt;
Is there some way to do that formula with referenced values of a table?&lt;br&gt;
&lt;br&gt;
Example:&lt;br&gt;
&lt;br&gt;
&lt;/p&gt;
&lt;pre style="background: white; color: black; font-family: Consolas;"&gt;&lt;div style="color: black; background-color: white;"&gt;&lt;pre&gt;ws.Cells[1,1].Formula = &lt;span style="color: rgb(163, 21, 21);"&gt;"=VLOOKUP(\""&lt;/span&gt; + tableName + &lt;span style="color: rgb(163, 21, 21);"&gt;"\"[[#ThisRow],[ColumnName]],sheetname!A:B,2,0)"&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;
&lt;br&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;I'm getting an error "Excel found content that can't be read...".&lt;br&gt;&lt;br&gt;Thanks.&lt;br&gt;&lt;br&gt;&amp;nbsp;&lt;br&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="danilomgarcia" When="29/03/2012 17:18:01">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I've found the problem.&lt;/p&gt;
&lt;p&gt;I don't know if the excel version has something to do with that.&lt;/p&gt;
&lt;p&gt;But i'm using portuguese version of Excel and the formula works this way:&lt;/p&gt;
&lt;pre style="background: white; color: black; font-family: Consolas;"&gt;&lt;pre style="background: white; color: black; font-family: Consolas; font-size: 13px;"&gt;&lt;pre&gt;ws.Cells[1,1].Formula = &lt;span style="color: rgb(163, 21, 21);"&gt;"=VLOOKUP("&lt;/span&gt; + tableName + &lt;span style="color: rgb(163, 21, 21);"&gt;"[[#This Row],["&lt;/span&gt; + ColumnName + &lt;span style="color: rgb(163, 21, 21);"&gt;"]],sheetName!A:B,2,0)"&lt;/span&gt;;&lt;/pre&gt;
&lt;/pre&gt;
&lt;/pre&gt;
&lt;p&gt;I didn't have to use double quotes on string parameters like is said on documentation.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Header/Footer &quot;Scale With Document&quot;">
      <Posts>
        <Post From="Saglorm" When="29/03/2012 12:25:12">
          <Html>
        
&lt;p&gt;Hello,&lt;/p&gt;
&lt;p&gt;First of all, I just started to use it yesterday, it is very success.&lt;/p&gt;
&lt;p&gt;I would be happy if someone give me information about&amp;nbsp;"Scale with document" property for&amp;nbsp;special headers &amp;amp; footers.&amp;nbsp;Is it exists or can't I just find it under Worksheet's Printersettings ~ HeaderFooter ?&lt;/p&gt;
&lt;p&gt;Or are there any ways to disable it programmatically ?&lt;/p&gt;
&lt;p&gt;Thanks.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Multiple Selection using dropdownlist">
      <Posts>
        <Post From="Madhusmk" When="29/03/2012 08:50:04">
          <Html>
        
&lt;p&gt;HI All,&lt;/p&gt;
&lt;p&gt;Is there any option for multiple selection using dropdownlist ?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Regards&lt;/p&gt;
&lt;p&gt;Madhusudhan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Creating Charts without referencing data in excel file">
      <Posts>
        <Post From="ScottyDell" When="28/03/2012 19:50:13">
          <Html>
        
&lt;p&gt;I'm generating a report with numerous data sources and would like to generate a chart for some of this data. When setting up the chart series information, I've noticed that it requests a range of cells. Since my Excel document is being generated by server
 side programming, I'd like to skip the need to have a worksheet just to pull this data.&lt;/p&gt;
&lt;p&gt;Is there any way (an example would be great) to set up the chart series without referencing Excel cells?&lt;/p&gt;
&lt;p&gt;For instance:&lt;/p&gt;
&lt;p&gt;Series1 = 1000, 1050, 2400, 1508, 999&lt;/p&gt;
&lt;p&gt;I don't want to have to set up cells with these values and instead would like to set up the series manually.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="ScottyDell" When="28/03/2012 20:20:36">
          <Html>
        
&lt;p&gt;I've done a lot of searching through past discussions and have now come across a similar question that went without an answer, so even a simple "Yes, this is possible" or "No, this is not possible" answer would be most appreciated.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="ScottyDell" When="28/03/2012 21:07:36">
          <Html>
        
&lt;p&gt;Or, if this is not possible, is it possible to reference a range of cells in a different worksheet? I could then create a new worksheet in the code behind, reference the appropriate cells, then dispose of the temp worksheet.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="ScottyDell" When="28/03/2012 22:57:56">
          <Html>
        
&lt;p&gt;Ok... I've created a sample xlsx file that has a chart with a series that is not linked to any of the spreadsheet data. I then loaded it into a web script in an attempt to figure out how the series would look to EPPlus... however, it appears to be an empty
 string. Here is the code I use:&lt;/p&gt;
&lt;p&gt;Dim file As FileInfo = New FileInfo(Server.MapPath(".") &amp;amp; "\temp.xlsx")&lt;br&gt;
Dim p1 As ExcelPackage = New ExcelPackage(file)&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;br&gt;
Dim ws1 As ExcelWorksheet = p1.Workbook.Worksheets(1)&lt;br&gt;
For Each c1 As Chart.ExcelChart In ws1.Drawings&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;
&lt;br&gt;
&lt;span style="white-space: pre;"&gt;&lt;/span&gt;For i As Integer = 0 To c1.Series.Count - 1&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;
&lt;br&gt;
&lt;span style="white-space: pre;"&gt;&lt;/span&gt;Response.Write(c1.Series(i).Header &amp;amp; "&amp;lt;br&amp;gt;")&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;
&lt;br&gt;
&lt;span style="white-space: pre;"&gt;&lt;/span&gt;Response.Write(c1.Series(i).Series &amp;amp; "&amp;lt;br&amp;gt;") &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;br&gt;
&lt;span style="white-space: pre;"&gt;&lt;/span&gt;Next&lt;br&gt;
Next&lt;/p&gt;
&lt;p&gt;I only see the Header (which is "Test"). The series, as I mentioned, comes out as an empty string.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="[Tutorial] How to add new features/methods to EPPlus">
      <Posts>
        <Post From="BartlomiejSkwira" When="28/02/2012 08:44:38">
          <Html>
        
&lt;p&gt;Here is a &lt;em&gt;"simple"&lt;/em&gt; tutorial how to add new features/methods to EPPlus:&lt;br&gt;
1. Create a blank .xlsx document with Microsoft Office.&lt;br&gt;
2. Add the feature/functionality you would like to have in EPPlus to the document. In my case I wanted to change colors of pie charts so I've created a simple pie chart and changed it's colors (there I noticed that I actually needed to change Data Point Fill
 property).&lt;br&gt;
3. Save the document. Open it with an archive manager (I used 7-Zip) and extract all contents.&amp;nbsp;&lt;/p&gt;
&lt;p&gt;4. Now comes the tricky part. You have to locate what has changed in .xlsx's xml (what code have you added). You could use a diff tool of your choice (WinMerge?) and make a comparison of your files vs a blank document. I've just navigated to xl -&amp;gt; charts
 -&amp;gt; chart1.xml . I've additionally used Notepad++ Tidy Xml (plugin) to make the code more readable. &amp;nbsp;&lt;br&gt;
Now you have to look for xml code that is somehow similar to naming convention used when you created the feature - I was looking for Data Point elements. I've also set the colors to something other than defaults (red and blue) so this would somehow stand out
 from the code (in my case yellow and green).&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&amp;lt;c:chart&amp;gt;
...
	&amp;lt;c:plotArea&amp;gt;
...
		&amp;lt;c:pie3DChart&amp;gt;
			&amp;lt;c:varyColors val=&lt;span style="color: rgb(163, 21, 21);"&gt;"1"&lt;/span&gt;/&amp;gt;
				&amp;lt;c:ser&amp;gt;
					&amp;lt;c:idx val=&lt;span style="color: rgb(163, 21, 21);"&gt;"0"&lt;/span&gt;/&amp;gt;
					&amp;lt;c:order val=&lt;span style="color: rgb(163, 21, 21);"&gt;"0"&lt;/span&gt;/&amp;gt;
					&amp;lt;c:dPt&amp;gt;
						&amp;lt;c:idx val=&lt;span style="color: rgb(163, 21, 21);"&gt;"0"&lt;/span&gt;/&amp;gt;
						&amp;lt;c:bubble3D val=&lt;span style="color: rgb(163, 21, 21);"&gt;"0"&lt;/span&gt;/&amp;gt;
						&amp;lt;c:spPr&amp;gt;
							&amp;lt;a:solidFill&amp;gt;
								&amp;lt;a:srgbClr val=&lt;span style="color: rgb(163, 21, 21);"&gt;"92D050"&lt;/span&gt;/&amp;gt;
							&amp;lt;/a:solidFill&amp;gt;
						&amp;lt;/c:spPr&amp;gt;
					&amp;lt;/c:dPt&amp;gt;
					&amp;lt;c:dPt&amp;gt;
						&amp;lt;c:idx val=&lt;span style="color: rgb(163, 21, 21);"&gt;"1"&lt;/span&gt;/&amp;gt;
						&amp;lt;c:bubble3D val=&lt;span style="color: rgb(163, 21, 21);"&gt;"0"&lt;/span&gt;/&amp;gt;
						&amp;lt;c:spPr&amp;gt;
							&amp;lt;a:solidFill&amp;gt;
								&amp;lt;a:srgbClr val=&lt;span style="color: rgb(163, 21, 21);"&gt;"FFFF00"&lt;/span&gt;/&amp;gt;
							&amp;lt;/a:solidFill&amp;gt;
						&amp;lt;/c:spPr&amp;gt;
					&amp;lt;/c:dPt&amp;gt;
					&amp;lt;c:val&amp;gt;
						...
					&amp;lt;/c:val&amp;gt;
				&amp;lt;/c:ser&amp;gt;
				...
			&amp;lt;/c:pie3DChart&amp;gt;
	&amp;lt;/c:plotArea&amp;gt;
&amp;lt;/c:chart&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;A few minutes later I noticed tag c:dPt ... well, well what do you know, could this be our DataPoint? the other colors values seem to prove my observation. Just to be 100% sure I've change the values of a:srgbClr tag to some other color, used 7zip to pack
 everything to one .zip file, change the extension to .xlsx and voila! it worked.&lt;br&gt;
&lt;br&gt;
5. Now you need to code adding/changing this xml in our document. Take a look at &lt;a href="http://epplus.codeplex.com/discussions/84057#post802025" target="_blank" rel="nofollow"&gt;
my code on how I added DataPoint colors&lt;/a&gt;:&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;&lt;span style="white-space: pre;"&gt;	&lt;/span&gt;const&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; dataPointChildrenPath = &lt;span style="color: rgb(163, 21, 21);"&gt;"c:spPr/a:solidFill/a:srgbClr/@val"&lt;/span&gt;;
        &lt;span style="color: blue;"&gt;const&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; dataPointFullPath = &lt;span style="color: rgb(163, 21, 21);"&gt;"c:dPt/c:spPr/a:solidFill/a:srgbClr/@val"&lt;/span&gt;;
        &lt;span style="color: blue;"&gt;const&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; dataPointPath = &lt;span style="color: rgb(163, 21, 21);"&gt;"c:dPt"&lt;/span&gt;;
        &lt;span style="color: blue;"&gt;const&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; dataPointIdxPath = &lt;span style="color: rgb(163, 21, 21);"&gt;"c:dPt/c:idx/@val"&lt;/span&gt;;
        &lt;span style="color: blue;"&gt;const&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; dataPointBubble3DPath = &lt;span style="color: rgb(163, 21, 21);"&gt;"c:dPt/c:bubble3D/@val"&lt;/span&gt;;
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;void&lt;/span&gt; SetDataPointColor(&lt;span style="color: blue;"&gt;int&lt;/span&gt; dataPointNr, Color newColor)
        {
            &lt;span style="color: green;"&gt;//the list might be longer as there are more pie type charts, haven't tested it on other than Pie3D&lt;/span&gt;
            List supportedChartTypes = &lt;span style="color: blue;"&gt;new&lt;/span&gt; List() {eChartType.Pie3D};
            eChartType currentChartType = _chartSeries.Chart.ChartType;

            &lt;span style="color: blue;"&gt;if&lt;/span&gt; (dataPointNr &amp;lt; 0)
            {
                &lt;span style="color: blue;"&gt;throw&lt;/span&gt; &lt;span style="color: blue;"&gt;new&lt;/span&gt; IndexOutOfRangeException(&lt;span style="color: rgb(163, 21, 21);"&gt;"Data point index can't be less than 0."&lt;/span&gt;);
            }

            &lt;span style="color: blue;"&gt;if&lt;/span&gt; (!supportedChartTypes.Contains(currentChartType)) 
            { 
                StringBuilder types = &lt;span style="color: blue;"&gt;new&lt;/span&gt; StringBuilder();
                &lt;span style="color: blue;"&gt;foreach&lt;/span&gt;(eChartType e &lt;span style="color: blue;"&gt;in&lt;/span&gt; supportedChartTypes)
                {
                    types.Append(e.ToString());
                    types.Append(&lt;span style="color: rgb(163, 21, 21);"&gt;" "&lt;/span&gt;);
                }
                &lt;span style="color: blue;"&gt;throw&lt;/span&gt; &lt;span style="color: blue;"&gt;new&lt;/span&gt; Exception(&lt;span style="color: rgb(163, 21, 21);"&gt;"Unsupported chart type. Please use one of these chart types: "&lt;/span&gt; + types.ToString());
                
            }

            &lt;span style="color: green;"&gt;//supported chart type&lt;/span&gt;
            &lt;span style="color: blue;"&gt;switch&lt;/span&gt; (currentChartType)
            {
                &lt;span style="color: blue;"&gt;case&lt;/span&gt; eChartType.Pie3D:
                    {
                        &lt;span style="color: green;"&gt;//check if index in less than amount of columns (cells?) for this series&lt;/span&gt;
                        &lt;span style="color: green;"&gt;//if chart has DataPoints in rows A1:A2 then serie.SetDataPointColor(2, Color.Red) throws an exception!&lt;/span&gt;
                        ExcelAddress address = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelAddress(XSeries);
                        &lt;span style="color: blue;"&gt;if&lt;/span&gt; (dataPointNr &amp;gt; (address._toCol - address._fromCol))
                        {
                            &lt;span style="color: blue;"&gt;throw&lt;/span&gt; &lt;span style="color: blue;"&gt;new&lt;/span&gt; Exception(&lt;span style="color: rgb(163, 21, 21);"&gt;"Data Point index is higher than  amount of columns (cells?) for this series. Max possible value is: "&lt;/span&gt; + (address._toCol - address._fromCol));
                        }
                        &lt;span style="color: blue;"&gt;else&lt;/span&gt;
                        {
                            &lt;span style="color: green;"&gt;//color string&lt;/span&gt;
                            &lt;span style="color: blue;"&gt;string&lt;/span&gt; color = newColor.ToArgb().ToString(&lt;span style="color: rgb(163, 21, 21);"&gt;"X"&lt;/span&gt;).Substring(2, 6);
                            &lt;span style="color: green;"&gt;//get all Data Point nodes&lt;/span&gt;
                            XmlNodeList nodeList = _node.SelectNodes(&lt;span style="color: rgb(163, 21, 21);"&gt;"c:dPt"&lt;/span&gt;, _ns);
                            &lt;span style="color: green;"&gt;//create node because it doesn't exist&lt;/span&gt;
                            &lt;span style="color: blue;"&gt;if&lt;/span&gt; (dataPointNr + 1 &amp;gt; nodeList.Count)
                            {
                               XmlElement dpt = _node.OwnerDocument.CreateElement(&lt;span style="color: rgb(163, 21, 21);"&gt;"c"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"dPt"&lt;/span&gt;, ExcelPackage.schemaChart);
                               &lt;span style="color: green;"&gt;//index&lt;/span&gt;
                               XmlElement temp = _node.OwnerDocument.CreateElement(&lt;span style="color: rgb(163, 21, 21);"&gt;"c"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"idx"&lt;/span&gt;, ExcelPackage.schemaChart);
                               XmlAttribute tempAttr = _node.OwnerDocument.CreateAttribute(&lt;span style="color: rgb(163, 21, 21);"&gt;"val"&lt;/span&gt;);
                               &lt;span style="color: green;"&gt;//index must be incremental if previous Data Points exist&lt;/span&gt;
                               tempAttr.Value = nodeList.Count.ToString();
                               temp.Attributes.Append(tempAttr);
                               dpt.AppendChild(temp);
                               &lt;span style="color: green;"&gt;//bubble&lt;/span&gt;
                               temp = _node.OwnerDocument.CreateElement(&lt;span style="color: rgb(163, 21, 21);"&gt;"c"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"bubble3D"&lt;/span&gt;, ExcelPackage.schemaChart);
                               tempAttr = _node.OwnerDocument.CreateAttribute(&lt;span style="color: rgb(163, 21, 21);"&gt;"val"&lt;/span&gt;);
                               tempAttr.Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"0"&lt;/span&gt;;
                               temp.Attributes.Append(tempAttr);
                               dpt.AppendChild(temp);
                               temp = _node.OwnerDocument.CreateElement(&lt;span style="color: rgb(163, 21, 21);"&gt;"c"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"spPr"&lt;/span&gt;, ExcelPackage.schemaChart);
                               &lt;span style="color: blue;"&gt;string&lt;/span&gt; nameSpaceURI = NameSpaceManager.LookupNamespace(&lt;span style="color: rgb(163, 21, 21);"&gt;"a"&lt;/span&gt;);
                               XmlElement temp2 = _node.OwnerDocument.CreateElement(&lt;span style="color: rgb(163, 21, 21);"&gt;"a"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"solidFill"&lt;/span&gt;, nameSpaceURI);
                               XmlElement temp3 = _node.OwnerDocument.CreateElement(&lt;span style="color: rgb(163, 21, 21);"&gt;"a"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"srgbClr"&lt;/span&gt;, nameSpaceURI);
                               tempAttr = _node.OwnerDocument.CreateAttribute(&lt;span style="color: rgb(163, 21, 21);"&gt;"val"&lt;/span&gt;);
                               tempAttr.Value = color;
                               temp3.Attributes.Append(tempAttr);
                               temp2.AppendChild(temp3);
                               temp.AppendChild(temp2);
                               dpt.AppendChild(temp);

                               &lt;span style="color: blue;"&gt;if&lt;/span&gt; (nodeList.Count &amp;gt; 0)
                               {
                                   &lt;span style="color: green;"&gt;//if other Data Points exist&lt;/span&gt;
                                   _node.InsertAfter(dpt, nodeList[nodeList.Count - 1]);
                               }
                               &lt;span style="color: blue;"&gt;else&lt;/span&gt;
                               {
                                   &lt;span style="color: green;"&gt;//if first Data Point&lt;/span&gt;
                                   InserAfter(_node, &lt;span style="color: rgb(163, 21, 21);"&gt;"c:tx"&lt;/span&gt;, dpt);
                               }
                            }
                            &lt;span style="color: blue;"&gt;else&lt;/span&gt; 
                            {
                                &lt;span style="color: green;"&gt;//node already exists, change it&lt;/span&gt;
                                SetXmlNodeString(nodeList[dataPointNr], dataPointChildrenPath, color);
                            }
                         }
                         &lt;span style="color: blue;"&gt;break&lt;/span&gt;;
                    }
                &lt;span style="color: blue;"&gt;default&lt;/span&gt;:
                    &lt;span style="color: blue;"&gt;throw&lt;/span&gt; &lt;span style="color: blue;"&gt;new&lt;/span&gt; Exception(&lt;span style="color: rgb(163, 21, 21);"&gt;"Ooops! Update the supported chart type list or the implementation for this chart type, something is missing!"&lt;/span&gt;);
            }
        }&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;6. You also need to change the value of&amp;nbsp;SchemaNodeOrder -&amp;nbsp;Jan Källman helped me here. Jan could you shares with us where do you find the correct schema??&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="namit101" When="01/03/2012 05:19:14">
          <Html>
        
&lt;p&gt;Just to understand this completely, it seems like you are just editing XML that already exists (produced by EPPlus).&lt;/p&gt;
&lt;p&gt;Does this methodology also apply if you are creating an new excel file using epplus?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;(In my case, I was trying to figure out how to create a dataTable in excel. &amp;nbsp;When I open the xml file, I notice I need to just add a simple line to one of the cells:&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;f&lt;/span&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;span&gt;t&lt;/span&gt;&lt;span&gt;="dataTable"&lt;/span&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;span&gt;ref&lt;/span&gt;&lt;span&gt;="C3:E5"&lt;/span&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;span&gt;dt2D&lt;/span&gt;&lt;span&gt;="1"&lt;/span&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;span&gt;dtr&lt;/span&gt;&lt;span&gt;="1"&lt;/span&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;span&gt;r1&lt;/span&gt;&lt;span&gt;="A1"&lt;/span&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;span&gt;r2&lt;/span&gt;&lt;span&gt;="B1"&lt;/span&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;span&gt;/&amp;gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;However, when I try to load the xml using worksheet.WorksheetXml, I noticed the xml for the other cells hasn't been created yet. &amp;nbsp;Can I change the xml ahead of time / is there a proper way to edit the xml directly without having first saved the
 file?)&lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="BartlomiejSkwira" When="01/03/2012 09:15:46">
          <Html>
        
&lt;blockquote style="margin: 0.25em 1em 0px; padding: 0px 0.25em; border: 0.1em solid rgb(204, 204, 204); border-image: none; font-style: italic;"&gt;
&lt;strong&gt;namit101 wrote:&lt;/strong&gt;&lt;br&gt;
&lt;p&gt;Just to understand this completely, it seems like you are just editing XML that already exists (produced by EPPlus).&lt;/p&gt;
&lt;p&gt;Does this methodology also apply if you are creating an new excel file using epplus?&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;First I get all DataPoint nodes which are in _node (which is a Series)&lt;/p&gt;
&lt;pre&gt;&lt;div style="color: black; background-color: white;"&gt;&lt;pre&gt;&lt;span style="color: green;"&gt;//get all Data Point nodes&lt;/span&gt;
XmlNodeList nodeList = _node.SelectNodes(&lt;span style="color: rgb(163, 21, 21);"&gt;"c:dPt"&lt;/span&gt;, _ns);&lt;/pre&gt;
&lt;/div&gt;
&lt;/pre&gt;
&lt;p&gt;Then I check if DataPoint used in my method exists&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;if&lt;/span&gt; (dataPointNr + 1 &amp;gt; nodeList.Count)&lt;/pre&gt;
&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;if it doesn't I'm creating it - that's the longest part in my code which includes creating xml and adding it to this node with methods:&amp;nbsp;_node.InsertAfter, InserAfter
&lt;/li&gt;&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;If it does exist, I'm just changing the xml &lt;/li&gt;&lt;/ul&gt;
&lt;pre&gt;&lt;div style="color: black; background-color: white;"&gt;&lt;pre&gt;&lt;span style="color: green;"&gt;//node already exists, change it&lt;/span&gt;
SetXmlNodeString(nodeList[dataPointNr], dataPointChildrenPath, color);&lt;/pre&gt;
&lt;/div&gt;
&lt;/pre&gt;
&lt;p&gt;When You open .xlsx with MS Excel some additional xml is added to the file (for example formulas are calculated). So in other words You need to add the xml to this node manually&amp;nbsp;if it doesn't exist. Does that answer Your question?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="namit101" When="01/03/2012 22:10:57">
          <Html>
        
&lt;p&gt;I've just started using EPPlus, so forgive the ignorance, but where do these nodes coming from?&lt;/p&gt;
&lt;p&gt;The only interface into the xml that I've seen is using worksheet.&lt;span&gt;WorksheetXml (which if I recall correctly is read-only and has no cell nodes in it until I save down the file).&lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="BartlomiejSkwira" When="02/03/2012 08:28:56">
          <Html>
        
&lt;p&gt;namit&lt;/p&gt;
&lt;p&gt;Sure, no hard feelings ;) My tutorial is about changing EPPlus itself, you would need to download the
&lt;a href="http://epplus.codeplex.com/SourceControl/list/changesets" target="_blank" rel="nofollow"&gt;
source code&lt;/a&gt; first, add your features and then for example link reference to newly created EPPlus dll (and use the new feature).&amp;nbsp;&lt;span&gt;WorksheetXml or ChartXml properties are as You said read-only, you could change this in the source as well. Just go
 to ExcelChart class,&amp;nbsp;public XmlDocument ChartXml { get; internal set; } &amp;lt;- remove internal, but then You would have to modify XmlDocument object.&amp;nbsp;&lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="06/03/2012 16:39:44">
          <Html>
        
&lt;p&gt;Its good to see new people learning about epplus =)&lt;/p&gt;
&lt;p&gt;Thanks for the tutorial.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="BartlomiejSkwira" When="06/03/2012 18:54:14">
          <Html>
        
&lt;p&gt;My pleasure! :)&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="15/03/2012 21:38:12">
          <Html>
        
&lt;p&gt;Nice work.&lt;/p&gt;
&lt;p&gt;The schemas and documentation can be found at..&lt;/p&gt;
&lt;p&gt;&lt;a href="http://www.ecma-international.org/publications/standards/Ecma-376.htm" rel="nofollow"&gt;http://www.ecma-international.org/publications/standards/Ecma-376.htm&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Flou" When="28/03/2012 11:10:24">
          <Html>
        
&lt;p&gt;Hi !&lt;/p&gt;
&lt;p&gt;Thx for your uge work Jan and for your tuto Bart, I finally succed to change all colors.&lt;/p&gt;
&lt;p&gt;The problem was to change the color for the legend too when you've more than 1 serie. I had the theme 1 from Excel each time. I inspected several xlsx and i saw that we have&amp;nbsp;a small part of code for the color legend in the chart1.xml file :&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;        &lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;ser&lt;/span&gt; &lt;span style="color: red;"&gt;xmlns&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;http://schemas.openxmlformats.org/drawingml/2006/chart&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
          &lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;c&lt;/span&gt;&lt;span style="color: blue;"&gt;:&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;idx&lt;/span&gt; &lt;span style="color: red;"&gt;val&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;0&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: blue;"&gt;/&amp;gt;&lt;/span&gt;
          &lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;c&lt;/span&gt;&lt;span style="color: blue;"&gt;:&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;order&lt;/span&gt; &lt;span style="color: red;"&gt;val&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;0&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: blue;"&gt;/&amp;gt;&lt;/span&gt;
          &lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;c&lt;/span&gt;&lt;span style="color: blue;"&gt;:&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;tx&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
            &lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;c&lt;/span&gt;&lt;span style="color: blue;"&gt;:&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;v&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;Serie Name&lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;c&lt;/span&gt;&lt;span style="color: blue;"&gt;:&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;v&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
          &lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;c&lt;/span&gt;&lt;span style="color: blue;"&gt;:&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;tx&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
          &lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;c&lt;/span&gt;&lt;span style="color: blue;"&gt;:&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;spPr&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
            &lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;a&lt;/span&gt;&lt;span style="color: blue;"&gt;:&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;solidFill&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
              &lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;a&lt;/span&gt;&lt;span style="color: blue;"&gt;:&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;srgbClr&lt;/span&gt; &lt;span style="color: red;"&gt;val&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;FF0000&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: blue;"&gt;/&amp;gt;&lt;/span&gt;
            &lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;a&lt;/span&gt;&lt;span style="color: blue;"&gt;:&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;solidFill&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
          &lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;c&lt;/span&gt;&lt;span style="color: blue;"&gt;:&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;spPr&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
          &lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;c&lt;/span&gt;&lt;span style="color: blue;"&gt;:&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;dPt&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
[...My Datapoints...]
&lt;/pre&gt;
&lt;pre&gt;&lt;br&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;So I rewrote a small part of the Bart's function :&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;case&lt;/span&gt; eChartType.ColumnClustered :
                {
                    ExcelAddress address = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelAddress(XSeries);
                    &lt;span style="color: blue;"&gt;if&lt;/span&gt; (dataPointNr &amp;gt; (address._toCol - address._fromCol))
                    {
                        &lt;span style="color: blue;"&gt;throw&lt;/span&gt; &lt;span style="color: blue;"&gt;new&lt;/span&gt; Exception(&lt;span style="color: rgb(163, 21, 21);"&gt;"Data Point index is higher than  amount of columns (cells?) for this series. Max possible value is: "&lt;/span&gt; + (address._toCol - address._fromCol));
                    }
                    &lt;span style="color: blue;"&gt;else&lt;/span&gt;
                    {
                        &lt;span style="color: green;"&gt;//color string&lt;/span&gt;
                        &lt;span style="color: blue;"&gt;string&lt;/span&gt; color = newColor.ToArgb().ToString(&lt;span style="color: rgb(163, 21, 21);"&gt;"X"&lt;/span&gt;).Substring(2, 6);
                        &lt;span style="color: green;"&gt;//get all Data Point nodes&lt;/span&gt;
                        XmlNodeList nodeList = _node.SelectNodes(&lt;span style="color: rgb(163, 21, 21);"&gt;"c:dPt"&lt;/span&gt;, _ns);
                        &lt;span style="color: green;"&gt;//create node because it doesn't exist&lt;/span&gt;
                        &lt;span style="color: blue;"&gt;if&lt;/span&gt; (dataPointNr + 1 &amp;gt; nodeList.Count)
                        {
                            XmlElement dpt = _node.OwnerDocument.CreateElement(&lt;span style="color: rgb(163, 21, 21);"&gt;"c"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"dPt"&lt;/span&gt;, ExcelPackage.schemaChart);
                            &lt;span style="color: green;"&gt;//index&lt;/span&gt;
                            XmlElement temp = _node.OwnerDocument.CreateElement(&lt;span style="color: rgb(163, 21, 21);"&gt;"c"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"idx"&lt;/span&gt;, ExcelPackage.schemaChart);
                            XmlAttribute tempAttr = _node.OwnerDocument.CreateAttribute(&lt;span style="color: rgb(163, 21, 21);"&gt;"val"&lt;/span&gt;);
                            &lt;span style="color: green;"&gt;//index must be incremental if previous Data Points exist&lt;/span&gt;
                            tempAttr.Value = nodeList.Count.ToString();
                            temp.Attributes.Append(tempAttr);
                            dpt.AppendChild(temp);
                            &lt;span style="color: green;"&gt;//bubble&lt;/span&gt;
                            temp = _node.OwnerDocument.CreateElement(&lt;span style="color: rgb(163, 21, 21);"&gt;"c"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"bubble3D"&lt;/span&gt;, ExcelPackage.schemaChart);
                            tempAttr = _node.OwnerDocument.CreateAttribute(&lt;span style="color: rgb(163, 21, 21);"&gt;"val"&lt;/span&gt;);
                            tempAttr.Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"0"&lt;/span&gt;;
                            temp.Attributes.Append(tempAttr);
                            dpt.AppendChild(temp);
                            temp = _node.OwnerDocument.CreateElement(&lt;span style="color: rgb(163, 21, 21);"&gt;"c"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"spPr"&lt;/span&gt;, ExcelPackage.schemaChart);
                            &lt;span style="color: blue;"&gt;string&lt;/span&gt; nameSpaceURI = NameSpaceManager.LookupNamespace(&lt;span style="color: rgb(163, 21, 21);"&gt;"a"&lt;/span&gt;);
                            XmlElement temp2 = _node.OwnerDocument.CreateElement(&lt;span style="color: rgb(163, 21, 21);"&gt;"a"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"solidFill"&lt;/span&gt;, nameSpaceURI);
                            XmlElement temp3 = _node.OwnerDocument.CreateElement(&lt;span style="color: rgb(163, 21, 21);"&gt;"a"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"srgbClr"&lt;/span&gt;, nameSpaceURI);
                            tempAttr = _node.OwnerDocument.CreateAttribute(&lt;span style="color: rgb(163, 21, 21);"&gt;"val"&lt;/span&gt;);
                            tempAttr.Value = color;
                            temp3.Attributes.Append(tempAttr);
                            temp2.AppendChild(temp3);
                            temp.AppendChild(temp2);
                            dpt.AppendChild(temp);
                            
                            &lt;span style="color: blue;"&gt;if&lt;/span&gt; (nodeList.Count &amp;gt; 0)
                            {
                                &lt;span style="color: green;"&gt;//if other Data Points exist&lt;/span&gt;
                                _node.InsertAfter(dpt, nodeList[nodeList.Count - 1]);
                            }
                            &lt;span style="color: blue;"&gt;else&lt;/span&gt;
                            {
                                XmlElement legendColor = _node.OwnerDocument.CreateElement(&lt;span style="color: rgb(163, 21, 21);"&gt;"c"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"spPr"&lt;/span&gt;, ExcelPackage.schemaChart);
                                &lt;span style="color: blue;"&gt;string&lt;/span&gt; nameSpaceURIColor = NameSpaceManager.LookupNamespace(&lt;span style="color: rgb(163, 21, 21);"&gt;"a"&lt;/span&gt;);
                                XmlElement temp2Color = _node.OwnerDocument.CreateElement(&lt;span style="color: rgb(163, 21, 21);"&gt;"a"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"solidFill"&lt;/span&gt;, nameSpaceURIColor);
                                XmlElement temp3Color = _node.OwnerDocument.CreateElement(&lt;span style="color: rgb(163, 21, 21);"&gt;"a"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"srgbClr"&lt;/span&gt;, nameSpaceURIColor);
                                XmlAttribute tempAttrColor = _node.OwnerDocument.CreateAttribute(&lt;span style="color: rgb(163, 21, 21);"&gt;"val"&lt;/span&gt;);
                                &lt;span style="color: blue;"&gt;string&lt;/span&gt; legendColorColor = newColor.ToArgb().ToString(&lt;span style="color: rgb(163, 21, 21);"&gt;"X"&lt;/span&gt;).Substring(2, 6);
                                tempAttrColor.Value = color;
                                temp3Color.Attributes.Append(tempAttrColor);
                                temp2Color.AppendChild(temp3Color);
                                legendColor.AppendChild(temp2Color);
                                InserAfter(_node, &lt;span style="color: rgb(163, 21, 21);"&gt;"c:tx"&lt;/span&gt;, legendColor);
                                &lt;span style="color: green;"&gt;//if first Data Point&lt;/span&gt;
                                InserAfter(_node, &lt;span style="color: rgb(163, 21, 21);"&gt;"c:spPr"&lt;/span&gt;, dpt);
                            }
                        }
                        &lt;span style="color: blue;"&gt;else&lt;/span&gt;
                        {
                            &lt;span style="color: green;"&gt;//node already exists, change it&lt;/span&gt;
                            SetXmlNodeString(nodeList[dataPointNr], dataPointChildrenPath, color);
                        }
                    }
                    &lt;span style="color: blue;"&gt;break&lt;/span&gt;;
                }
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;The difference is in the else when we insert the first dtp.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Flou" When="28/03/2012 11:16:57">
          <Html>
        
&lt;p&gt;oops !&lt;/p&gt;
&lt;p&gt;you can delete&amp;nbsp; &lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;string&lt;/span&gt; legendColorColor = newColor.ToArgb().ToString(&lt;span style="color: rgb(163, 21, 21);"&gt;"X"&lt;/span&gt;).Substring(2, 6);
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="save/export as csv">
      <Posts>
        <Post From="AlexSchatten" When="30/03/2011 18:40:02">
          <Html>
        
&lt;p&gt;Hi there&lt;/p&gt;
&lt;p&gt;is there a chance to open an excel file and save/export the worksheet as CSV?&lt;/p&gt;
&lt;p&gt;Best Alex&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="31/03/2011 18:26:49">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;No,&amp;nbsp;nothing build-in, but it should be a simple task to read the xlsx file and create the CSV.&lt;/p&gt;
&lt;p&gt;Use the Worksheet.Dimensions property to get the boundries of the worksheet.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="bradwood" When="27/03/2012 17:33:56">
          <Html>
        
&lt;p&gt;Code to convert posted &lt;a href="http://codejournal.blogspot.com/2012/03/using-epplus-library-to-convert-xlsx-to.html" rel="nofollow"&gt;
here&lt;/a&gt;.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Excel Error when using a sum formula on rows with numbers in adjacent cells">
      <Posts>
        <Post From="ScottyDell" When="26/03/2012 18:50:36">
          <Html>
        
&lt;p&gt;I'm generating an excel document server side that uses a formula to sum specific cells. The formula works great, returning the proper amount, however in the cell with the formula, I'm getting a green triangle that gives the error "The formula in this
 cell refers to a range that has additional numbers adjacent to it". I *know* the cells adjacent to it have numbers, but they are not to be included in the total. Is there any way around this error?&lt;/p&gt;
&lt;p&gt;For example:&lt;/p&gt;
&lt;p&gt;cells C:18 to C:23 contain: 665, 688, 44, 21, 0, 1 and the cell with the formula (C:24) contains the value 1419 (this is correct). However, all of the cells previous in the C column also contain numbers, so I believe Excel wants to include these in the formula.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="26/03/2012 19:17:58">
          <Html>
        
&lt;p&gt;At this version, EPPlus doesnt have any feature to help you. If you want to handle this, you need to do by your own.&lt;/p&gt;
&lt;p&gt;Here some tips:&lt;/p&gt;
&lt;p&gt;1) Create an excel file and reproduce all steps. Save your file.&lt;/p&gt;
&lt;p&gt;2) Click at warning button and choose to "ignore error". Save as another file.&lt;/p&gt;
&lt;p&gt;3) Rename your files .xlsx -&amp;gt; .zip and extract them&lt;/p&gt;
&lt;p&gt;4) Compare their folders with winmerge&lt;/p&gt;
&lt;p&gt;5) Search for files that are not identical&lt;/p&gt;
&lt;p&gt;6) Now, you "just" need to code that tags that are not present in your first file.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to copy a set of cells and include formatting?">
      <Posts>
        <Post From="abemiessler" When="13/05/2011 07:44:45">
          <Html>
        
&lt;p&gt;Say I have a spread sheet and I would like to copy/paste a block of 4 rows and 10 columns.&amp;nbsp; Is there a way that I can do this and include all formatting?&lt;/p&gt;
&lt;p&gt;I would like to copy &lt;span style="text-decoration: underline;"&gt;merged &lt;/span&gt;rows and columns but haven't figured out how to do it.&amp;nbsp; Can this be done using EPPlus?&amp;nbsp; If so, could someone point me in the right direction&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="16/05/2011 20:46:45">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;No, merged cells are not copied, with the range.Copy method at the moment. Merged cells are handled a little bit different than other styles, so I have to add a separate rutine for that (in the Copy method).&lt;/p&gt;
&lt;p&gt;I'll add that to my todo-list.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="abemiessler" When="26/03/2012 04:08:35">
          <Html>
        
&lt;p&gt;Hey Jankallman,&lt;/p&gt;
&lt;p&gt;Any chance you've had a moment to look at this functionality?&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Unreadable content when using template with image in the footer and insert image in the content">
      <Posts>
        <Post From="shank187" When="16/03/2011 09:27:54">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Thanks a lot for the great work.&lt;/p&gt;
&lt;p&gt;I got the error "Excel found unreadable content, Do you want to recover ......" when I click recover the work sheet is empty&lt;/p&gt;
&lt;p&gt;My case is : I had a template with a footer, the footer contain an image&lt;/p&gt;
&lt;p&gt;When I write data (JUST TEXT) to that template, it open correctl:&lt;/p&gt;
&lt;p&gt;using (ExcelPackage package = new ExcelPackage(newFile, templateFile))&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; //Open worksheet 1&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ExcelWorksheet worksheet = package.Workbook.Worksheets[1];&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; worksheet.InsertRow(5, 2);&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; worksheet.Cells["A5"].Value = "12010";&lt;/p&gt;
&lt;p&gt;&amp;nbsp;package.Save();&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; return "";&lt;/p&gt;
&lt;p&gt;}&lt;/p&gt;
&lt;p&gt;When I try to write image to that template, I got the above error&lt;/p&gt;
&lt;p&gt;&amp;nbsp;using (ExcelPackage package = new ExcelPackage(newFile, templateFile))&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; //Open worksheet 1&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ExcelWorksheet worksheet = package.Workbook.Worksheets[1];&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; worksheet.InsertRow(5, 2);&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; worksheet.Cells["A5"].Value = "12010";&lt;/p&gt;
&lt;p&gt;int currentRow = 5;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; int pictureCol = 1;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; int pictureWidth = 310;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; int pictureHeight = 120;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; //set picture column width to accommodate the picture&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; //worksheet.Column(pictureCol).Width = ExcelHelper.Pixel2ColumnWidth(worksheet, pictureWidth + 1);&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; using (System.Drawing.Image img = Image.FromFile(@"C:\Users\Moe\Downloads\c# Excel\trunk\SampleApp\1.png"))&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; if (img != null)&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; //set row height to accommodate the picture&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; //worksheet.Row(currentRow).Height = ExcelHelper.Pixel2RowHeight(pictureHeight + 1);&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; //add picture to cell&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ExcelPicture pic = worksheet.Drawings.AddPicture("PictureUniqueName", img);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; //position picture on desired column&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; pic.From.Column = pictureCol - 1;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; pic.From.Row = currentRow - 1;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; pic.From.ColumnOff = ExcelHelper.Pixel2MTU(1);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; pic.From.RowOff = ExcelHelper.Pixel2MTU(1);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; //set picture size to fit inside the cell&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; pic.SetSize(pictureWidth, pictureHeight);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; package.Save();&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; return "";&lt;/p&gt;
&lt;p&gt;}&lt;/p&gt;
&lt;p&gt;Can you help me?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="shank187" When="16/03/2011 10:04:05">
          <Html>
        
&lt;p&gt;I figure it out, the Excel file has to have the same pic in the content (I had to set width and height for the pic in the content to zero)&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="rampatter" When="23/03/2012 18:02:07">
          <Html>
        
&lt;p&gt;You can add picture in excel cell like this&lt;/p&gt;
&lt;p&gt;xlWorkSheet.Shapes.AddPicture("C:\\csharp-xl-picture.JPG", Microsoft.Office.Core.MsoTriState.msoFalse, Microsoft.Office.Core.MsoTriState.msoCTrue, 50, 50, 300, 45);
&lt;br&gt;
&lt;br&gt;
find the full source code of this C# code&lt;/p&gt;
&lt;p&gt;&lt;a href="http://csharp.net-informations.com/excel/csharp-insert-picture-excel.htm" rel="nofollow"&gt;http://csharp.net-informations.com/excel/csharp-insert-picture-excel.htm&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;patter.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Cell Text Property Incorrectly Returning Blank String">
      <Posts>
        <Post From="bradwood" When="22/03/2012 21:24:55">
          <Html>
        
&lt;p&gt;Using current version.&amp;nbsp; I'm reading in / writing out data.&amp;nbsp; My input spreadsheet is plain text data; all columns general text.&amp;nbsp; My output was blank when my input cells contained '0'.&amp;nbsp; In debugging, I found that any time I examined the
 Text property of the ExcelRangeBase object (by hovering over it and scrolling down to the Text property), it showed correct.&amp;nbsp; Once the debugger hit the object, it was populated correctly and the output contained the zeros.&amp;nbsp; If the object hadn't been
 touched by the debugger, however, the output was blank.&lt;/p&gt;
&lt;p&gt;Note that there was no timing issue.&amp;nbsp; Setting breakpoints or inserting sleep times had no effect.&amp;nbsp; Only examining the property of the individual cells with the debugger changed the output.&lt;/p&gt;
&lt;p&gt;When I switched to using value.ToString() I got the data correctly, but this sure seems like a problem (how many other values would produce this?).&amp;nbsp; How is this even possible?&amp;nbsp; You can imagine how this debug session went...&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Help to use ExcelNamedRange with Excel 2007 template with named Cells..">
      <Posts>
        <Post From="danilomgarcia" When="22/03/2012 15:06:57">
          <Html>
        
&lt;p&gt;Hi guys,&lt;/p&gt;
&lt;p&gt;I'm using a Excel template, inside this template i have some named cells that create a "table". (Table1 A1:F8)&lt;/p&gt;
&lt;p&gt;When access the WorkSheet that contains these cells the property Names is empty.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;ExcelWorksheet ws = wb.Worksheets[&lt;span style="color: rgb(163, 21, 21);"&gt;"sheetName"&lt;/span&gt;];

&lt;span style="color: blue;"&gt;using&lt;/span&gt; (ExcelNamedRange namedRange = ws.Names[&lt;span style="color: rgb(163, 21, 21);"&gt;"Table1"&lt;/span&gt;])
{

}
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Someone knows how to access the range of cells by the name?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks for the help and sorry for the bad english.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="danilomgarcia" When="22/03/2012 20:49:39">
          <Html>
        
&lt;p&gt;I've found the problem.&lt;/p&gt;
&lt;p&gt;I had Named tables not named range of cells.&lt;/p&gt;
&lt;p&gt;I've made a named range cells with the named table inside and worked.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="write to existing Excel 2003 file">
      <Posts>
        <Post From="Nayna" When="20/03/2012 05:05:20">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;My requirement is to write to an existing excel file (xls- 2003). Does EPPlus support writing to xls(2003) file?&lt;/p&gt;
&lt;p&gt;If yes, any code snippets would be helpful.&lt;/p&gt;
&lt;p&gt;Thanks.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="20/03/2012 12:37:56">
          <Html>
        
&lt;p&gt;EPPlus only can handle OOXML based files ( Excel 2007/2010 ).&lt;/p&gt;
&lt;p&gt;Take a look at NPOI project =)&lt;/p&gt;
&lt;p&gt;&lt;a href="http://npoi.codeplex.com/" rel="nofollow"&gt;http://npoi.codeplex.com/&lt;/a&gt;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Problem reading empty string in CSV">
      <Posts>
        <Post From="patrick1" When="16/03/2012 15:40:54">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I'm having trouble with the Cell.LoadFromText() function. I need to read a file with several text entries, some of which are just "". I'm setting the TextQualifier to '\"', and most of the file reads correctly. For some reason, when it gets
 to an empty string, it reads one of the quotes as the value of that cell. I tried the following code with an input file containing only:&lt;/p&gt;
&lt;p&gt;"",""&lt;/p&gt;
&lt;p&gt;"",""&lt;/p&gt;
&lt;p&gt;The code:&lt;/p&gt;
&lt;p style="padding-left: 30px;"&gt;var input = new FileInfo(@"~\..\..\..\TestData\emptystrings.csv");&lt;br&gt;
var output= new FileInfo(@"~\..\..\..\TestData\em.xlsx");&lt;br&gt;
var pack = new ExcelPackage();&lt;br&gt;
pack.Workbook.Worksheets.Add("Empty");&lt;br&gt;
pack.Workbook.Worksheets["Empty"].Cells.LoadFromText(file,new ExcelTextFormat&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
 {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
 TextQualifier = '\"'&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
 });&lt;br&gt;
pack.SaveAs(output);&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;The output looks like this :&lt;/p&gt;
&lt;p&gt;","&lt;/p&gt;
&lt;p&gt;","&lt;/p&gt;
&lt;p&gt;If I add spaces between each pair of quotes in the input file, the problem goes away.&lt;/p&gt;
&lt;p&gt;Thanks for any help in advance.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="patrick1" When="19/03/2012 13:53:45">
          <Html>
        
&lt;p&gt;I found the problem in the source. In the ExcelRangeBase class's LoadFromText method, if you comment out the statement:&lt;/p&gt;
&lt;p&gt;if (QCount &amp;gt; 1)&lt;/p&gt;
&lt;p&gt;{&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; v += new string(Format.TextQualifier, QCount / 2);&lt;br&gt;
}&lt;/p&gt;
&lt;p&gt;from lines 1753-1756 and 1782-1785, it seems to be OK.&lt;/p&gt;
&lt;p&gt;These look like they are trying to handle multiple text blocks per cell, or maybe to read nested qualifiers as text. With or without these statements, it throws an exception saying "Text delimiter is not closed..." if you put something like "one" 2 "three"
 in one cell. Excel itself doesn't handle nested qualifiers properly, so I see no point in trying here.&lt;/p&gt;
&lt;p&gt;I don't see any side effects, but it should be tested properly. I don't see a unit test for this method, so I just ran the code in my first post and messed with the csv file a bit.&lt;/p&gt;
&lt;p&gt;I hope someone finds this useful.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Selecting Multiple Ranges for Print Area">
      <Posts>
        <Post From="namit101" When="18/03/2012 00:35:55">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Is it possible to select multiple ranges in EPPlus? &amp;nbsp;I'd like to set the print area to be two disjoint areas [in VBA this can be done by doing something like Range("A1:B:30","D1:E:30")].&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="18/03/2012 22:35:02">
          <Html>
        
&lt;p&gt;Yes, just put a comma before the next range...&lt;/p&gt;
&lt;p&gt;Worksheet.Cells["A1:B30,D1:E30"]&lt;/p&gt;
&lt;p&gt;Have a look at the FAQ for some more examples&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Problem with Dates on iPhone">
      <Posts>
        <Post From="yvesmh" When="13/03/2012 16:53:08">
          <Html>
        
&lt;p&gt;Hello, first of all I would like to thank the developers for this amazing library.&lt;/p&gt;
&lt;p&gt;I'm working with templates to build a report. The report is done on a windows server 2003 machine which does't have Excel installed, the reports come out as expected when seen on Excel, LibreOffice, and Android devices. But on the iPhone, the dates are displayed
 as numbers.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;a href="http://tinypic.com?ref=tzmhk" target="_blank" rel="nofollow"&gt;&lt;img alt="Image and video hosting by TinyPic" src="http://i40.tinypic.com/tzmhk.png" border="0"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I have tried to use&amp;nbsp;worksheet.Cells[1, 1, 100, 100].Style.Numberformat.Format = "#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;";&lt;/p&gt;
&lt;p&gt;But it doesn't fix the problem, i wouldn't like to change the cell format to string because the report has filters, and the users wouldn't be able to sort by dates anymore.&lt;/p&gt;
&lt;p&gt;Is there any way to fix this problem by code or modifying the template?&lt;/p&gt;
&lt;p&gt;Thanks!&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="15/03/2012 21:27:37">
          <Html>
        
&lt;p&gt;Set the numberformat to a date format like...&lt;/p&gt;
&lt;p&gt;worksheet.Cells["B:B"].Style.Numberformat.Format="yyyy/mm/dd"&lt;/p&gt;
&lt;p&gt;Have a look at the FAQ for more info.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Hide columns">
      <Posts>
        <Post From="camirine" When="10/03/2012 06:11:31">
          <Html>
        
&lt;p&gt;Hi all,&lt;/p&gt;
&lt;p&gt;I have a requirement where i need to hide some columns in my excel (.xlsx).&lt;/p&gt;
&lt;p&gt;using (ExcelPackage pck = new ExcelPackage())&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/p&gt;
&lt;p&gt;{&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;span style="white-space: pre;"&gt;&lt;/span&gt;ExcelWorksheet ws = pck.Workbook.Worksheets.Add("Demo");&lt;/p&gt;
&lt;p&gt;&lt;span style="white-space: pre;"&gt;&lt;/span&gt;ws.Cells["A1"].LoadFromDataTable(dtExcelData, true);&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;span style="white-space: pre;"&gt;&lt;/span&gt;ws.Column(1).Hidden = true;&lt;/p&gt;
&lt;p&gt;}&lt;/p&gt;
&lt;p&gt;Using the above code i tried to hide column 1 of my excel sheet. But no luck.&lt;/p&gt;
&lt;p&gt;Can someone please suggest me how can i resolve this issue.&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div&gt;Thanks all for your effort!&lt;/div&gt;
&lt;div&gt;&amp;nbsp;&lt;/div&gt;
&lt;div&gt;Regards,&lt;/div&gt;
&lt;div&gt;Camirine&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="hakanblomgren" When="14/03/2012 09:29:38">
          <Html>
        
&lt;p&gt;I have the same problem. It seems as it is not possible to hide colums in a table. If I try outside the table the Hide works.&lt;/p&gt;
&lt;p&gt;Regards,&lt;/p&gt;
&lt;p&gt;Håkan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="GBrookman" When="15/03/2012 01:31:02">
          <Html>
        
&lt;p&gt;this works for me:&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; ws.Column(ColDiscounted).Style.Hidden = true;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="15/03/2012 21:21:44">
          <Html>
        
&lt;p&gt;Your sample works for me...&lt;/p&gt;
&lt;p&gt;ws.Column(1).Hidden = true;&lt;/p&gt;
&lt;p&gt;Make sure you don't use the column/range AutoFit methods or set the width of the column afterwards&lt;/p&gt;
&lt;p&gt;You could also set the ws.Column(1).Width=0&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Corrupt XLS documents when saving based on a template">
      <Posts>
        <Post From="littlemetal" When="14/03/2012 09:31:35">
          <Html>
        
&lt;p&gt;I have a series of XLS documents that I converted to XLSX using Mac Excel 2008. &amp;nbsp;These files serve as the templates, and open just fine in mac excel, and on windows. &amp;nbsp;&lt;/p&gt;
&lt;p&gt;When I use EPPlus to save a new excel file, using one of these as the template, the resulting files are the correct size but are reported as corrupt by win/mac excel.&lt;/p&gt;
&lt;p&gt;These files have Unicode characters in them (chinese), as well as english, if that is of any significance. &amp;nbsp;They don't have any formulas, and are basically just formatting templates.&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;var&lt;/span&gt; fileOut = &lt;span style="color: blue;"&gt;new&lt;/span&gt; FileInfo(outFileName);
&lt;span style="color: blue;"&gt;var&lt;/span&gt; fileTemplate = &lt;span style="color: blue;"&gt;new&lt;/span&gt; FileInfo(xlsxTemplatePath);

&lt;span style="color: blue;"&gt;using&lt;/span&gt; (&lt;span style="color: blue;"&gt;var&lt;/span&gt; package = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(fileOut, fileTemplate)) {
    &lt;span style="color: blue;"&gt;var&lt;/span&gt; wbk = package.Workbook;
    &lt;span style="color: blue;"&gt;var&lt;/span&gt; sheet = wbk.Worksheets[1];
    &lt;span style="color: green;"&gt;// all code that modifies the sheet has been commented out&lt;/span&gt;
    &lt;span style="color: green;"&gt;// which should result in a duplicate of the original&lt;/span&gt;
    
    package.Save();
}

&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Any ideas on how to go about this? &amp;nbsp;In the end I want to just stream the output to the browser as a download without actually saving it, but only after I get this to work :) &amp;nbsp;It doesn't seem to hard, just .GetAsByteArray() and send.&lt;/p&gt;
&lt;p&gt;Thanks for any help&lt;span style="white-space: pre;"&gt; &lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="littlemetal" When="14/03/2012 09:46:51">
          <Html>
        
&lt;p&gt;Well... I think I found the culprit. &amp;nbsp;MAC EXCEL (2008)!&lt;/p&gt;
&lt;p&gt;I had a colleague save them using Excel 2010 on Windows, and the end result from those is just fine. &amp;nbsp;Damn. &amp;nbsp;So much time wasted.&lt;/p&gt;
&lt;p&gt;If you want a sample of the docs that come out corrupt, I can send one over. &amp;nbsp;Maybe it's a bug, maybe not.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Color on Pie3D">
      <Posts>
        <Post From="FabriceSAGE" When="11/02/2010 08:21:07">
          <Html>
        
&lt;p&gt;Hello,&lt;/p&gt;
&lt;p&gt;It's possible to change the color or the quart on&amp;nbsp; "&lt;span style="font-size: x-small;"&gt;eChartType.Pie3D"&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-size: x-small;"&gt;I don't not found how make.&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="11/02/2010 08:50:43">
          <Html>
        
&lt;p&gt;Sorry no, not in this release. Try to use a template, and style the pie chart the way you wan't it. I'm not sure it will work as expected, but you can try it out.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="FabriceSAGE" When="11/02/2010 09:39:56">
          <Html>
        
&lt;p&gt;It's not possible because i don't know the number of sheet.&lt;/p&gt;
&lt;p&gt;I am going to use actual colours and to try to find a resolution&lt;/p&gt;
&lt;p&gt;Thanks for your help.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="BartlomiejSkwira" When="07/10/2011 14:24:29">
          <Html>
        
&lt;p&gt;Any update on a possibility to change the colors of quarts? If no then do You have an idea how toachieve this in a different way?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="09/10/2011 18:34:27">
          <Html>
        
&lt;p&gt;No, no update. If you can't use a template you have work with the ChartXml directly.&lt;/p&gt;
&lt;p&gt;I haven't done that, so I cant help you with it.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="BartlomiejSkwira" When="14/10/2011 09:56:48">
          <Html>
        
&lt;p&gt;1. Hm could You explain how to use a template?&lt;/p&gt;
&lt;p&gt;2. As for charts XML, I would need to modify it using the official&lt;a href="http://msdn.microsoft.com/en-us/library/bb448854.aspx" target="_blank" rel="nofollow"&gt; MS OpenXML SDK&lt;/a&gt; right?&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;BTW: great library, thanks for sharing it!&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="BartlomiejSkwira" When="19/10/2011 11:07:54">
          <Html>
        
&lt;p&gt;1. Ok I found that You can use templates for whole documents, not chart, but thanks anyway.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="BartlomiejSkwira" When="27/02/2012 15:12:46">
          <Html>
        
&lt;p&gt;Ok, I've been toying around with EPPlus and Pie3D chart's xml and found out that colors are controlled by Data Points:&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;strong&gt;&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;c&lt;/span&gt;&lt;span style="color: blue;"&gt;:&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;dPt&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;&lt;/strong&gt;
	&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;c&lt;/span&gt;&lt;span style="color: blue;"&gt;:&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;idx&lt;/span&gt; &lt;span style="color: red;"&gt;val&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;1&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;/&amp;gt;&lt;/span&gt;
	&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;c&lt;/span&gt;&lt;span style="color: blue;"&gt;:&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;bubble3D&lt;/span&gt; &lt;span style="color: red;"&gt;val&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;0&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;/&amp;gt;&lt;/span&gt;
	&lt;strong&gt;&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;c&lt;/span&gt;&lt;span style="color: blue;"&gt;:&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;spPr&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
		&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;a&lt;/span&gt;&lt;span style="color: blue;"&gt;:&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;solidFill&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
			&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;a&lt;/span&gt;&lt;span style="color: blue;"&gt;:&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;srgbClr&lt;/span&gt; &lt;span style="color: red;"&gt;val&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;FFFF00&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;/&amp;gt;&lt;/span&gt;&lt;/strong&gt;
		&lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;a&lt;/span&gt;&lt;span style="color: blue;"&gt;:&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;solidFill&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
	&lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;c&lt;/span&gt;&lt;span style="color: blue;"&gt;:&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;spPr&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
&lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;c&lt;/span&gt;&lt;span style="color: blue;"&gt;:&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;dPt&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;So I've created a method which can change the DataPoint (quart) colors. The method should:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;add Color and Data Point xml&amp;nbsp;to chart (if it wasn't added yet by our program, by default this is done when you open a .xlsx with Microsoft Office)
&lt;/li&gt;&lt;li&gt;change existing Data Point color &lt;/li&gt;&lt;li&gt;if data point index is higher than &amp;nbsp;amount of columns used by our chart -&amp;gt; throw an Exception, for example we have 2 quarts and we try to change color of third
&lt;/li&gt;&lt;li&gt;only Pie3D chart has been tested by me (and support for it is hardcoded), take a look at&amp;nbsp;supportedChartTypes List. Maybe other pie charts can also be handled by my code, dunno that.
&lt;/li&gt;&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;This is only a hack, the real solution for this should be 2&amp;nbsp;separate&amp;nbsp;classes&lt;/strong&gt;&amp;nbsp;- DataPoint (which would have ExcelDrawingFill class) and DataPoints class for collection. Feel free to copy and redistribute my code anyway you
 like. How to use it:&lt;/p&gt;
&lt;p&gt;Add this to class&amp;nbsp;ExcelChartSerie&lt;/p&gt;
&lt;pre&gt;&lt;div style="color: black; background-color: white;"&gt;&lt;pre&gt;&lt;span style="color: blue;"&gt;const&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; dataPointChildrenPath = &lt;span style="color: rgb(163, 21, 21);"&gt;"c:spPr/a:solidFill/a:srgbClr/@val"&lt;/span&gt;;
        &lt;span style="color: blue;"&gt;const&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; dataPointFullPath = &lt;span style="color: rgb(163, 21, 21);"&gt;"c:dPt/c:spPr/a:solidFill/a:srgbClr/@val"&lt;/span&gt;;
        &lt;span style="color: blue;"&gt;const&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; dataPointPath = &lt;span style="color: rgb(163, 21, 21);"&gt;"c:dPt"&lt;/span&gt;;
        &lt;span style="color: blue;"&gt;const&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; dataPointIdxPath = &lt;span style="color: rgb(163, 21, 21);"&gt;"c:dPt/c:idx/@val"&lt;/span&gt;;
        &lt;span style="color: blue;"&gt;const&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; dataPointBubble3DPath = &lt;span style="color: rgb(163, 21, 21);"&gt;"c:dPt/c:bubble3D/@val"&lt;/span&gt;;

        &lt;span style="color: gray;"&gt;///&lt;/span&gt;&lt;span style="color: green;"&gt; &lt;/span&gt;

        &lt;span style="color: gray;"&gt;///&lt;/span&gt;&lt;span style="color: green;"&gt; Change color of Pie3D chart pieces (DataPoints)&lt;/span&gt;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt;&lt;span style="color: green;"&gt; &lt;/span&gt;

        &lt;span style="color: gray;"&gt;///&lt;/span&gt;&lt;span style="color: green;"&gt; &lt;/span&gt;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt;&lt;span style="color: green;"&gt; &lt;/span&gt;
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;void&lt;/span&gt; SetDataPointColor(&lt;span style="color: blue;"&gt;int&lt;/span&gt; dataPointNr, Color newColor)
        {
            &lt;span style="color: green;"&gt;//the list might be longer as there are more pie type charts, haven't tested it on other than Pie3D&lt;/span&gt;
            List supportedChartTypes = &lt;span style="color: blue;"&gt;new&lt;/span&gt; List() {eChartType.Pie3D};
            eChartType currentChartType = _chartSeries.Chart.ChartType;

            &lt;span style="color: blue;"&gt;if&lt;/span&gt; (dataPointNr &amp;lt; 0)
            {
                &lt;span style="color: blue;"&gt;throw&lt;/span&gt; &lt;span style="color: blue;"&gt;new&lt;/span&gt; IndexOutOfRangeException(&lt;span style="color: rgb(163, 21, 21);"&gt;"Data point index can't be less than 0."&lt;/span&gt;);
            }

            &lt;span style="color: blue;"&gt;if&lt;/span&gt; (!supportedChartTypes.Contains(currentChartType)) 
            { 
                StringBuilder types = &lt;span style="color: blue;"&gt;new&lt;/span&gt; StringBuilder();
                &lt;span style="color: blue;"&gt;foreach&lt;/span&gt;(eChartType e &lt;span style="color: blue;"&gt;in&lt;/span&gt; supportedChartTypes)
                {
                    types.Append(e.ToString());
                    types.Append(&lt;span style="color: rgb(163, 21, 21);"&gt;" "&lt;/span&gt;);
                }
                &lt;span style="color: blue;"&gt;throw&lt;/span&gt; &lt;span style="color: blue;"&gt;new&lt;/span&gt; Exception(&lt;span style="color: rgb(163, 21, 21);"&gt;"Unsupported chart type. Please use one of these chart types: "&lt;/span&gt; + types.ToString());
                
            }

            &lt;span style="color: green;"&gt;//supported chart type&lt;/span&gt;
            &lt;span style="color: blue;"&gt;switch&lt;/span&gt; (currentChartType)
            {
                &lt;span style="color: blue;"&gt;case&lt;/span&gt; eChartType.Pie3D:
                    {
                        &lt;span style="color: green;"&gt;//check if index in less than amount of columns (cells?) for this series&lt;/span&gt;
                        &lt;span style="color: green;"&gt;//if chart has DataPoints in rows A1:A2 then serie.SetDataPointColor(2, Color.Red) throws an exception!&lt;/span&gt;
                        ExcelAddress address = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelAddress(XSeries);
                        &lt;span style="color: blue;"&gt;if&lt;/span&gt; (dataPointNr &amp;gt; (address._toCol - address._fromCol))
                        {
                            &lt;span style="color: blue;"&gt;throw&lt;/span&gt; &lt;span style="color: blue;"&gt;new&lt;/span&gt; Exception(&lt;span style="color: rgb(163, 21, 21);"&gt;"Data Point index is higher than  amount of columns (cells?) for this series. Max possible value is: "&lt;/span&gt; + (address._toCol - address._fromCol));
                        }
                        &lt;span style="color: blue;"&gt;else&lt;/span&gt;
                        {
                            &lt;span style="color: green;"&gt;//color string&lt;/span&gt;
                            &lt;span style="color: blue;"&gt;string&lt;/span&gt; color = newColor.ToArgb().ToString(&lt;span style="color: rgb(163, 21, 21);"&gt;"X"&lt;/span&gt;).Substring(2, 6);
                            &lt;span style="color: green;"&gt;//get all Data Point nodes&lt;/span&gt;
                            XmlNodeList nodeList = _node.SelectNodes(&lt;span style="color: rgb(163, 21, 21);"&gt;"c:dPt"&lt;/span&gt;, _ns);
                            &lt;span style="color: green;"&gt;//create node because it doesn't exist&lt;/span&gt;
                            &lt;span style="color: blue;"&gt;if&lt;/span&gt; (dataPointNr + 1 &amp;gt; nodeList.Count)
                            {
                               XmlElement dpt = _node.OwnerDocument.CreateElement(&lt;span style="color: rgb(163, 21, 21);"&gt;"c"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"dPt"&lt;/span&gt;, ExcelPackage.schemaChart);
                               &lt;span style="color: green;"&gt;//index&lt;/span&gt;
                               XmlElement temp = _node.OwnerDocument.CreateElement(&lt;span style="color: rgb(163, 21, 21);"&gt;"c"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"idx"&lt;/span&gt;, ExcelPackage.schemaChart);
                               XmlAttribute tempAttr = _node.OwnerDocument.CreateAttribute(&lt;span style="color: rgb(163, 21, 21);"&gt;"val"&lt;/span&gt;);
                               &lt;span style="color: green;"&gt;//index must be incremental if previous Data Points exist&lt;/span&gt;
                               tempAttr.Value = nodeList.Count.ToString();
                               temp.Attributes.Append(tempAttr);
                               dpt.AppendChild(temp);
                               &lt;span style="color: green;"&gt;//bubble&lt;/span&gt;
                               temp = _node.OwnerDocument.CreateElement(&lt;span style="color: rgb(163, 21, 21);"&gt;"c"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"bubble3D"&lt;/span&gt;, ExcelPackage.schemaChart);
                               tempAttr = _node.OwnerDocument.CreateAttribute(&lt;span style="color: rgb(163, 21, 21);"&gt;"val"&lt;/span&gt;);
                               tempAttr.Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"0"&lt;/span&gt;;
                               temp.Attributes.Append(tempAttr);
                               dpt.AppendChild(temp);
                               temp = _node.OwnerDocument.CreateElement(&lt;span style="color: rgb(163, 21, 21);"&gt;"c"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"spPr"&lt;/span&gt;, ExcelPackage.schemaChart);
                               &lt;span style="color: blue;"&gt;string&lt;/span&gt; nameSpaceURI = NameSpaceManager.LookupNamespace(&lt;span style="color: rgb(163, 21, 21);"&gt;"a"&lt;/span&gt;);
                               XmlElement temp2 = _node.OwnerDocument.CreateElement(&lt;span style="color: rgb(163, 21, 21);"&gt;"a"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"solidFill"&lt;/span&gt;, nameSpaceURI);
                               XmlElement temp3 = _node.OwnerDocument.CreateElement(&lt;span style="color: rgb(163, 21, 21);"&gt;"a"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"srgbClr"&lt;/span&gt;, nameSpaceURI);
                               tempAttr = _node.OwnerDocument.CreateAttribute(&lt;span style="color: rgb(163, 21, 21);"&gt;"val"&lt;/span&gt;);
                               tempAttr.Value = color;
                               temp3.Attributes.Append(tempAttr);
                               temp2.AppendChild(temp3);
                               temp.AppendChild(temp2);
                               dpt.AppendChild(temp);

                               &lt;span style="color: blue;"&gt;if&lt;/span&gt; (nodeList.Count &amp;gt; 0)
                               {
                                   &lt;span style="color: green;"&gt;//if other Data Points exist&lt;/span&gt;
                                   _node.InsertAfter(dpt, nodeList[nodeList.Count - 1]);
                               }
                               &lt;span style="color: blue;"&gt;else&lt;/span&gt;
                               {
                                   &lt;span style="color: green;"&gt;//if first Data Point&lt;/span&gt;
                                   InserAfter(_node, &lt;span style="color: rgb(163, 21, 21);"&gt;"c:tx"&lt;/span&gt;, dpt);
                               }
                            }
                            &lt;span style="color: blue;"&gt;else&lt;/span&gt; 
                            {
                                &lt;span style="color: green;"&gt;//node already exists, change it&lt;/span&gt;
                                SetXmlNodeString(nodeList[dataPointNr], dataPointChildrenPath, color);
                            }
                         }
                         &lt;span style="color: blue;"&gt;break&lt;/span&gt;;
                    }
                &lt;span style="color: blue;"&gt;default&lt;/span&gt;:
                    &lt;span style="color: blue;"&gt;throw&lt;/span&gt; &lt;span style="color: blue;"&gt;new&lt;/span&gt; Exception(&lt;span style="color: rgb(163, 21, 21);"&gt;"Ooops! Update the supported chart type list or the implementation for this chart type, something is missing!"&lt;/span&gt;);
            }
        }&lt;/pre&gt;
&lt;/div&gt;
&lt;/pre&gt;
&lt;p&gt;Also change the SchemaNodeOrder&amp;nbsp;in the same class to&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;SchemaNodeOrder = &lt;span style="color: blue;"&gt;new&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt;[] { &lt;span style="color: rgb(163, 21, 21);"&gt;"idx"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"order"&lt;/span&gt;, &lt;strong&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;"dPt"&lt;/span&gt;&lt;/strong&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"tx"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"marker"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"trendline"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"explosion"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"dLbls"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"cat"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"val"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"yVal"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"xVal"&lt;/span&gt; };&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;That's it! :D&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="BartlomiejSkwira" When="12/03/2012 13:07:51">
          <Html>
        
&lt;p&gt;&amp;lt;please moderator delete me! - wrong button pressed&amp;gt;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Hide the Column dynamically">
      <Posts>
        <Post From="gnanadesigank" When="28/02/2011 08:47:09">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;&amp;nbsp;i want hide the column when the column contains no value.How to do that,please help me to solve this issue..&lt;/p&gt;
&lt;p&gt;Example,&amp;nbsp;&amp;nbsp;&amp;nbsp; I set the Heading in 4th Row...&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Heading1&amp;nbsp;&amp;nbsp;&amp;nbsp; Heading2&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Heading3&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 1&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 2&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 3&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 4&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Here,&amp;nbsp; Heading3 column contains no values,so that i want to hide the column3... How to do that please Help me.....&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks,&lt;/p&gt;
&lt;p&gt;Gnanadesigan kannan&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="28/02/2011 14:40:55">
          <Html>
        
&lt;p&gt;You can use a linq querie in your target column or a simple "for-loop" using rows.dimension to check all cells. If exists any value, hide your column.&lt;/p&gt;
&lt;p&gt;Please, look at sample folder, you´ll find a lot of linq queries. If you want to hidden a column you can do "worksheet.Column(pos).Hidden = true;"&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="camirine" When="12/03/2012 09:05:07">
          <Html>
        
&lt;p&gt;Hi mrxrsd,&lt;/p&gt;
&lt;p&gt;Using the below code i tried to hide column 1 of my excel sheet. But no luck.&lt;/p&gt;
&lt;p&gt;using (ExcelPackage pck = new ExcelPackage())&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/p&gt;
&lt;p&gt;{&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;ExcelWorksheet ws = pck.Workbook.Worksheets.Add("Demo");&lt;/p&gt;
&lt;p&gt;ws.Cells["A1"].LoadFromDataTable(dtExcelData, true);&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/p&gt;
&lt;p&gt;ws.Column(1).Hidden = true;&lt;/p&gt;
&lt;p&gt;}&lt;/p&gt;
&lt;p&gt;Can you please suggest me how can i resolve this issue.&amp;nbsp;&lt;/p&gt;
&lt;div&gt;Thanks for your effort!&lt;/div&gt;
&lt;div&gt;&amp;nbsp;&lt;/div&gt;
&lt;div&gt;Regards,&lt;/div&gt;
&lt;div&gt;Camirine&lt;/div&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Export data(HTML FORMAT) in a web application to Excel 2007">
      <Posts>
        <Post From="camirine" When="05/03/2012 09:43:04">
          <Html>
        
&lt;p&gt;Hi all,&lt;/p&gt;
&lt;div&gt;EPPlus is working perfectly when we transform Datatable to excel sheet using 'LoadFromDataTable' method. But here i have a scenario where i need to transform a string which contains HTML data to excel sheet. I have tried with 'LoadFromText', but no luck.&lt;/div&gt;
&lt;div&gt;&lt;/div&gt;
&lt;div&gt;Please find my string variable code below:&lt;/div&gt;
&lt;div&gt;&lt;/div&gt;
&lt;div&gt;string s = "&amp;lt;html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:x='urn:schemas-microsoft-com:office:excel' xmlns='http://www.w3.org/TR/REC-&lt;span style="white-space: pre;"&gt;
&lt;/span&gt;html40'&amp;gt;";&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/div&gt;
&lt;div&gt;s += "&amp;lt;meta http-equiv=Content-Type content='text/html; charset=us-ascii'&amp;gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="white-space: pre;"&gt;&lt;/span&gt;&amp;lt;meta name=ProgId content=Excel.Sheet&amp;gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="white-space: pre;"&gt;&lt;/span&gt;&amp;lt;meta name=Generator content='Microsoft Excel 9'&amp;gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="white-space: pre;"&gt;&lt;/span&gt;&amp;lt;link rel=File-List href='./mmmm_files/filelist.xml'&amp;gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="white-space: pre;"&gt;&lt;/span&gt;&amp;lt;link rel=Edit-Time-Data href='./mmmm_files/editdata.mso'&amp;gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="white-space: pre;"&gt;&lt;/span&gt;&amp;lt;link rel=OLE-Object-Data href='./mmmm_files/oledata.mso'&amp;gt;";&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/div&gt;
&lt;div&gt;s += "&amp;lt;title&amp;gt;Html Table&amp;lt;/title&amp;gt;";&lt;/div&gt;
&lt;div&gt;s += "&amp;lt;body&amp;gt;&amp;lt;table border=1&amp;gt;";&lt;/div&gt;
&lt;div&gt;s += "&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;";&lt;/div&gt;
&lt;div&gt;&lt;/div&gt;
&lt;div&gt;-----------(and so on)----------------&lt;/div&gt;
&lt;div&gt;&lt;/div&gt;
&lt;div&gt;s += "&amp;lt;/table&amp;gt;";&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/div&gt;
&lt;div&gt;s += "&amp;lt;/body&amp;gt;&amp;lt;/html&amp;gt;";&lt;/div&gt;
&lt;div&gt;&lt;/div&gt;
&lt;div&gt;With the help of the code below i was able to transform HTML content in string 's' to .xls&lt;/div&gt;
&lt;div&gt;&lt;/div&gt;
&lt;div&gt;Response.Write(s);&lt;br&gt;
Response.ContentType = "application/msexcel";&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/div&gt;
&lt;div&gt;Response.AppendHeader("content-disposition", "attachment;filename=OfferDetails.xls");&lt;/div&gt;
&lt;div&gt;Response.End();&lt;/div&gt;
&lt;div&gt;&lt;/div&gt;
&lt;div&gt;But how can i achieve this in our EPPlus project.&lt;/div&gt;
&lt;div&gt;&amp;nbsp;&lt;/div&gt;
&lt;div&gt;Hope someone can help me! Thanks all for your effort!&lt;/div&gt;
&lt;div&gt;&amp;nbsp;&lt;/div&gt;
&lt;div&gt;Your consideration is greatly appreciated..&lt;/div&gt;
&lt;div&gt;&amp;nbsp;&lt;/div&gt;
&lt;div&gt;Regards,&lt;/div&gt;
&lt;div&gt;Camirine&lt;/div&gt;
&lt;div&gt;&amp;nbsp;&lt;/div&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="swmal" When="06/03/2012 19:45:34">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Jan is on vacation, but I'm quite sure that EPPlus cannot parse HTML. That is a feature of the Excel application.&lt;/p&gt;
&lt;p&gt;If you are creating the html string in your code, couldn't you rather just insert the data in the cells of a worksheet via EPPlus?&lt;/p&gt;
&lt;p&gt;/Mats&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="camirine" When="09/03/2012 09:55:17">
          <Html>
        
&lt;p&gt;Hi swmal,&lt;/p&gt;
&lt;p&gt;Thanks for ur reply.&lt;/p&gt;
&lt;p&gt;&lt;span&gt;I was able to transform Datatable to excel sheet using 'LoadFromDataTable' method. But i need to perform some calculations on the data available.&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Can you please suggest me how can we perform calculations (Round, Sum) on Excel cells using EPPlus software.&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div&gt;Thanks in advance for your effort!&lt;/div&gt;
&lt;div&gt;&amp;nbsp;&lt;/div&gt;
&lt;div&gt;Your consideration is greatly appreciated..&lt;/div&gt;
&lt;div&gt;&amp;nbsp;&lt;/div&gt;
&lt;div&gt;Regards,&lt;/div&gt;
&lt;div&gt;Camirine&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="NumberFormat with only one decimal">
      <Posts>
        <Post From="alexffx" When="07/03/2012 17:00:22">
          <Html>
        
&lt;p&gt;Hello everyone,&lt;/p&gt;
&lt;p&gt;I have a problem in using the numberformat property in order to round cell values to only one decimal.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Here is my approach to apply the numberformat to one cell :&lt;/strong&gt;&lt;strong&gt;&lt;br&gt;
&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;div style="color: black; background-color: white;"&gt;&lt;pre&gt;worksheet.Cells[r, c].Style.Numberformat.Format =&lt;span style="color: rgb(163, 21, 21);"&gt;"#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.0"&lt;/span&gt;;&lt;/pre&gt;
&lt;/div&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;An ArgumentOutOfRangeException is thrown where I use this function :&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="background-color: white;"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;workbook.Worksheets.Add(worksheet.Name, worksheet);&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;The problem is that if I set two decimals (like&lt;span style="color: rgb(255, 0, 0);"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21); background-color: white;"&gt;"#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00"&lt;/span&gt;) or zero (like&lt;span style="color: rgb(163, 21, 21); background-color: white;"&gt;"#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;"&lt;/span&gt;&lt;span style="color: rgb(0, 0, 0);"&gt;)&lt;/span&gt;,
 there is no exception!&lt;br&gt;
I know that 0 and 2 decimals take part from the standart list of numberformats in an Excel worksheet, so it could be the explanation... But how to allow this numberformat of only one decimal without exception ?&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(255, 0, 0);"&gt;&lt;span style="color: rgb(0, 0, 0);"&gt;Thank you for your answers ! :)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="07/03/2012 17:36:55">
          <Html>
        
&lt;p&gt;Did you try&amp;nbsp;"#,&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.0" ?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="alexffx" When="07/03/2012 17:43:25">
          <Html>
        
&lt;p&gt;Doesn't work...&lt;/p&gt;
&lt;p&gt;I try this :&lt;br&gt;
- Create a template with this special numberformat in his style, get style in code in my new workbook from this template, update the style. After that, I can see the new numbertformat (#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.0) in my workbook. But... Same error when adding the worksheet to
 the workbook...&lt;/p&gt;
&lt;p&gt;- Create a template and apply directly in Excel the numberformat in cells that I want to be round. Same error...&lt;/p&gt;
&lt;p&gt;I really don't know how to process now :/&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="07/03/2012 18:56:50">
          <Html>
        
&lt;p&gt;hum, in my code&amp;nbsp;&lt;span&gt;"#,&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.0" works fine but I am using an older version (2.9.x.x). Maybe it is an issue related with new version. I will update my project to test.&lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="alexffx" When="08/03/2012 08:31:32">
          <Html>
        
&lt;p&gt;Hello,&lt;/p&gt;
&lt;p&gt;Do you have some news about it ? I will test with another version soon, i'll take you informed. Btw, thank you for your help!&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="08/03/2012 12:42:57">
          <Html>
        
&lt;p&gt;My code still works fine in the newer version. I could post my code here but I dont think it will be helpful&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="alexffx" When="08/03/2012 15:21:23">
          <Html>
        
&lt;p&gt;Work perfectly with the version 3, thank you very much :)&lt;/p&gt;
&lt;p&gt;Just one&amp;nbsp;last question, which numberformat do you use for percent formating ? "0%" doesn't work for me :/&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="08/03/2012 15:59:10">
          <Html>
        
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;ws.Cells[r, c + 8].Style.Numberformat.Format = &lt;span style="color: rgb(163, 21, 21);"&gt;"#%"&lt;/span&gt;;
ws.Cells[r, c + 8].Value = (&lt;span style="color: blue;"&gt;double&lt;/span&gt;)subAval.peso / 100;
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="alexffx" When="08/03/2012 16:16:56">
          <Html>
        
&lt;p&gt;Thank you!&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Data Labels for Chart">
      <Posts>
        <Post From="fachris" When="07/03/2012 16:04:16">
          <Html>
        
&lt;p&gt;Is there a way to add data labels from the code. I tried using a template, but when I fill the data I lose the labels?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thank you for you help,&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Chris&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="regarding the UNREADABLE FILE error">
      <Posts>
        <Post From="cleric146" When="02/03/2012 10:17:28">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I've been having this error on and off. Sometimes the excel file is working well but sometimes excel says it's&amp;nbsp;corrupted. I've been reading a few days now on the discussion and I can't seem to find the solution. Others would say that to solve it is
 by adding Response.Clear() or something like that. But,that's not applicable for me. Since I'm developing a windows form application. So I've been studying this error and I have a hunch that this is cause of the actual data im trying to save on the excel file.
 Please see code below.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;pre&gt;&lt;div style="color: black; background-color: white;"&gt;&lt;pre&gt;&lt;span style="color: blue;"&gt;if&lt;/span&gt; (leDS.Tables[0].Rows.Count &amp;gt; 0)
{
                &lt;span style="color: blue;"&gt;if&lt;/span&gt; (curPROJ == &lt;span style="color: rgb(163, 21, 21);"&gt;"VPI"&lt;/span&gt;)
                {
                        &lt;span style="color: blue;"&gt;int&lt;/span&gt; cntr = 1;
                        &lt;span style="color: blue;"&gt;foreach&lt;/span&gt; (DataRow myRow &lt;span style="color: blue;"&gt;in&lt;/span&gt; leDS.Tables[0].Rows) 
                        {
                            &lt;span style="color: green;"&gt;// the data on colum "documentReference" can be&lt;/span&gt;
                            &lt;span style="color: green;"&gt;// like this &lt;/span&gt;
                            &lt;span style="color: green;"&gt;//I12039007774&lt;/span&gt;
                            &lt;span style="color: green;"&gt;//I12039007782&lt;/span&gt;
                            &lt;span style="color: green;"&gt;//I12039007812&lt;/span&gt;
                            ws.Cells[cntr + 1, 1].Value = myRow[&lt;span style="color: rgb(163, 21, 21);"&gt;"documentReference"&lt;/span&gt;].ToString();
                            cntr = cntr + 1;
                        }
                        
                    }
}&lt;/pre&gt;
&lt;/div&gt;
&lt;/pre&gt;
&lt;p&gt;i think excel is trying to read&amp;nbsp;I12039007772 as a column/row reference instead of string. Now I can't tamper the data im trying to insert. Can anyone suggest what could be the possible solution here? also I might be wrong. Please help.&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="02/03/2012 11:57:15">
          <Html>
        
&lt;p&gt;From FAQ&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;a href="http://epplus.codeplex.com/wikipage?title=FAQ&amp;amp;referringTitle=Documentation" rel="nofollow"&gt;http://epplus.codeplex.com/wikipage?title=FAQ&amp;amp;referringTitle=Documentation&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;I get an error that Excel has found unreadable content when I open my generated document?&lt;/strong&gt;&lt;br&gt;
Check your Formulas and Numberformats. Formulas and numberformats are not validated by the library so if you enter anything wrong the package will be corrupt. Use the English formula names. Formula parameters are separated by commas (,), string parameters use
 double quotes (").&lt;/p&gt;
&lt;div&gt;
&lt;pre&gt;worksheet.Cells["A1"].Formula="CONCATENATE(\"string1_\",\"test\")";
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Numberformats:&lt;br&gt;
Use culture independent number formats: dot (.) for decimal, comma (thousand).&amp;nbsp;&lt;br&gt;
The easiest way to check a format or a formula is to create an Excel file --&amp;gt; Do the formatting / Add the formulas --&amp;gt; Save it as XLSX ---&amp;gt; Rename the file *.zip. Extract the file and have a look at the number formats in the \xl\styles.xml file and
 formulas in \xl\worksheets\sheet#.xml.&lt;/p&gt;
&lt;p&gt;------------------------&lt;/p&gt;
&lt;p&gt;Do you do any merge in yours cells? bad merge generate this issue too...&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="cleric146" When="03/03/2012 08:18:09">
          <Html>
        
&lt;p&gt;i'm kinda confuse with the&amp;nbsp;&lt;/p&gt;
&lt;pre&gt;worksheet.Cells["A1"].Formula="CONCATENATE(\"string1_\",\"test\")";&lt;/pre&gt;
&lt;p&gt;I dont use any merge. So your saying is I should do it like this&lt;/p&gt;
&lt;pre&gt;ws.cells[cntr + 1, 1].Formula="CONCATENATE(\" + myRow["documentReference"].ToString() + "\)" ;&lt;/pre&gt;
&lt;p&gt;sorry im really not that good with excel. Thank you for your suggestion. I've been stuck here for a while now &amp;gt;.&amp;lt; and I can't really try this out since im at home and the codes are not allowed to be taken home. Do you have any suggestions?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="cleric146" When="05/03/2012 06:51:59">
          <Html>
        
&lt;p&gt;&amp;nbsp;Hi,&lt;/p&gt;
&lt;p&gt;Im kinda desperate here. Here are the possible data that cause the error.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;ol&gt;
R12037020110&lt;br&gt;
I12037024200&lt;br&gt;
C12037047570&lt;br&gt;
I12037037790&lt;br&gt;
I12037037845&lt;br&gt;
I12037037810&lt;br&gt;
QUALITY ASSURANCE TASK&lt;br&gt;
I12037056065&lt;br&gt;
I12037054535&lt;br&gt;
C12037017126&lt;br&gt;
I12037055420&lt;br&gt;
I12037055405&lt;br&gt;
I12037054505&lt;br&gt;
QUALITY ASSURANCE TASK&lt;br&gt;
I12037050310&lt;br&gt;
I12033013665&lt;br&gt;
I12037037780&lt;br&gt;
I12034035845&lt;br&gt;
I12037048460&lt;br&gt;
I12037048440&lt;br&gt;
I12037047635&lt;br&gt;
I12037016085&lt;br&gt;
C12037068820&#x1F;&lt;br&gt;
C12037068805&lt;br&gt;
QUALITY ASSURACE TASK&lt;br&gt;
R12038305840&lt;br&gt;
R12038305850&lt;br&gt;
R12038305852&lt;br&gt;
R12038305858&lt;br&gt;
R12038305682&lt;br&gt;
R12038305674&lt;br&gt;
R12038305656&lt;br&gt;
R12038305660&lt;br&gt;
R12038305668&lt;br&gt;
R12038305722&lt;br&gt;
R12038305708&lt;br&gt;
R12038305718&lt;br&gt;
R12038305702&lt;br&gt;
R12038305748&lt;br&gt;
R12038305758&lt;br&gt;
R12038305738&lt;br&gt;
R12038305728&lt;br&gt;
R12038305812&lt;br&gt;
R12038305806&lt;br&gt;
R12038305822&lt;br&gt;
R12038305774&lt;br&gt;
R12038305764&lt;br&gt;
R12038305784&lt;br&gt;
R12038305800&lt;br&gt;
I12037055595&lt;br&gt;
I12037055410&lt;br&gt;
I12037054405&lt;br&gt;
I12037055965&lt;br&gt;
I12037056110&lt;br&gt;
I12037056085&lt;br&gt;
I12037055440&lt;br&gt;
I12037057780&lt;br&gt;
C12034030905&lt;br&gt;
I12034036165&lt;br&gt;
I12034036075&lt;br&gt;
I12034035940&lt;br&gt;
C12037068835&lt;br&gt;
C12037081425&lt;br&gt;
R12037036800&lt;br&gt;
R12037024745&lt;br&gt;
I12037037805&lt;br&gt;
R12037024680&lt;br&gt;
R12037024690&lt;br&gt;
R12037024700&lt;br&gt;
R12037024735&lt;br&gt;
R12037024720&lt;br&gt;
R12037024715&lt;br&gt;
I12037037830&lt;br&gt;
I12037037855&lt;br&gt;
I12035000250&lt;/ol&gt;
&lt;p&gt;So anyone whats wrong with this data? I've used .trim() and also tried to remove insert a space between the first character so it won't look like a cell reference but still no luck. also tried doing this&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;ws.Cells[cntr + 1, 6].formula= &lt;span style="color: rgb(163, 21, 21);"&gt;"TEXT("&lt;/span&gt; + myRow[&lt;span style="color: rgb(163, 21, 21);"&gt;"xcClaimNum"&lt;/span&gt;].ToString().Trim() &lt;span style="color: rgb(163, 21, 21);"&gt;")"&lt;/span&gt;;&amp;nbsp;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;and still no luck. So anybody got any better ideas? Sorry guys i'm kinda desperate here. Been working on this for a while now.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="05/03/2012 17:50:12">
          <Html>
        
&lt;p&gt;have you had posted all code ? I didnt see any problem.&lt;/p&gt;
&lt;p&gt;If you change "ws.Cells[cntr + 1, 1].Value = myRow["documentReference"].ToString();"&amp;nbsp;to "ws.Cells[cntr + 1, 1].Value = "aaa";", everything works fine ?&lt;/p&gt;
&lt;pre&gt;&lt;pre&gt;&lt;/pre&gt;
&lt;/pre&gt;

        
    </Html>
        </Post>
        <Post From="cleric146" When="06/03/2012 01:56:58">
          <Html>
        
&lt;p&gt;here is my code.&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;private&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; CreateExcelFile(DataSet leDS,&lt;span style="color: blue;"&gt;string&lt;/span&gt; newFileName,&lt;span style="color: blue;"&gt;string&lt;/span&gt; projectName) 
        {
            &lt;span style="color: blue;"&gt;string&lt;/span&gt; outputdir = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);
            &lt;span style="color: blue;"&gt;string&lt;/span&gt; folderName = &lt;span style="color: rgb(163, 21, 21);"&gt;"Production Report_"&lt;/span&gt; + String.Format(&lt;span style="color: rgb(163, 21, 21);"&gt;"{0:yyyy-MM-dd}"&lt;/span&gt;, DateTime.Now);
            &lt;span style="color: blue;"&gt;string&lt;/span&gt; savingPATH = Path.Combine(outputdir, folderName);
            &lt;span style="color: blue;"&gt;if&lt;/span&gt; (!Directory.Exists(savingPATH))
            {
                &lt;span style="color: green;"&gt;//Directory.Delete(savingPATH,true);&lt;/span&gt;
                Directory.CreateDirectory(savingPATH);
            }
            FileInfo newFS = &lt;span style="color: blue;"&gt;new&lt;/span&gt; FileInfo(savingPATH + "\\" + newFileName);
            &lt;span style="color: blue;"&gt;if&lt;/span&gt; (newFS.Exists) 
            {
                newFS.Delete();
                newFS = &lt;span style="color: blue;"&gt;new&lt;/span&gt; FileInfo(savingPATH + "\\" + newFileName);
            }
            &lt;span style="color: blue;"&gt;using&lt;/span&gt; (ExcelPackage p = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(newFS)) 
            {
                ExcelWorksheet ws = CreateSheet(p, projectName);
                CreateHeader(ws,projectName);
                plotMainData(leDS, ws,projectName);
                &lt;span style="color: blue;"&gt;byte&lt;/span&gt;[] bin = p.GetAsByteArray();                
                File.WriteAllBytes(newFS.ToString(), bin);
                
            }

            &lt;span style="color: blue;"&gt;return&lt;/span&gt; savingPATH;
        }&lt;/pre&gt;
&lt;/div&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;private&lt;/span&gt; &lt;span style="color: blue;"&gt;static&lt;/span&gt; ExcelWorksheet CreateSheet(ExcelPackage p, &lt;span style="color: blue;"&gt;string&lt;/span&gt; sheetName)
        {
            p.Workbook.Worksheets.Add(sheetName);
            ExcelWorksheet ws = p.Workbook.Worksheets[1];
            ws.Name = sheetName; &lt;span style="color: green;"&gt;//Setting Sheet's Name            &lt;/span&gt;
            &lt;span style="color: blue;"&gt;return&lt;/span&gt; ws;
        }&lt;/pre&gt;
&lt;/div&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;private&lt;/span&gt; &lt;span style="color: blue;"&gt;static&lt;/span&gt; &lt;span style="color: blue;"&gt;void&lt;/span&gt; CreateHeader(ExcelWorksheet ws,&lt;span style="color: blue;"&gt;string&lt;/span&gt; currentProject)
        {
            &lt;span style="color: blue;"&gt;if&lt;/span&gt; (currentProject == &lt;span style="color: rgb(163, 21, 21);"&gt;"Proj1"&lt;/span&gt; || currentProject == &lt;span style="color: rgb(163, 21, 21);"&gt;"Proj2"&lt;/span&gt;)
            {
                &lt;span style="color: blue;"&gt;if&lt;/span&gt; (currentProject == &lt;span style="color: rgb(163, 21, 21);"&gt;"Proj1"&lt;/span&gt;)
                {
                    &lt;span style="color: blue;"&gt;#region&lt;/span&gt; Proj1 header
                    ws.Cells[1, 1].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"EmpPIN"&lt;/span&gt;;
                    ws.Cells[1, 2].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"KeyerID"&lt;/span&gt;;
                    ws.Cells[1, 3].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"TASK/QUEUE"&lt;/span&gt;;
                    ws.Cells[1, 4].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"POLICY"&lt;/span&gt;;
                    ws.Cells[1, 5].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"RECORDS"&lt;/span&gt;;
                    ws.Cells[1, 6].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"Time[START]"&lt;/span&gt;;
                    ws.Cells[1, 7].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"Time[END]"&lt;/span&gt;;
                    ws.Cells[1, 8].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"HoursWorked(hrs)]"&lt;/span&gt;;
                    ws.Cells[1, 9].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"ElapseTime"&lt;/span&gt;;
                    &lt;span style="color: blue;"&gt;var&lt;/span&gt; fill = ws.Row(1).Style.Fill;
                    ws.Row(1).Style.Font.Color.SetColor(Color.LightGreen);
                    fill.PatternType = ExcelFillStyle.Solid;
                    fill.BackgroundColor.SetColor(Color.Black);
                    ws.Row(1).Style.Font.Bold = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
                    &lt;span style="color: blue;"&gt;#endregion&lt;/span&gt;
                }
                &lt;span style="color: blue;"&gt;else&lt;/span&gt; &lt;span style="color: blue;"&gt;if&lt;/span&gt; (currentProject == &lt;span style="color: rgb(163, 21, 21);"&gt;"Proj2"&lt;/span&gt;)
                {
                    &lt;span style="color: blue;"&gt;#region&lt;/span&gt; Proj2 header
                    ws.Cells[1, 1].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"AssociateName"&lt;/span&gt;;
                    ws.Cells[1, 2].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"EmployeePIN"&lt;/span&gt;;
                    ws.Cells[1, 3].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"TranDate"&lt;/span&gt;;
                    ws.Cells[1, 4].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"Project"&lt;/span&gt;;
                    ws.Cells[1, 5].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"TaskType"&lt;/span&gt;;
                    ws.Cells[1, 6].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"Claim No."&lt;/span&gt;;
                    ws.Cells[1, 7].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"SCCF#"&lt;/span&gt;;
                    ws.Cells[1, 8].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"Route To"&lt;/span&gt;;
                    ws.Cells[1, 9].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"Started"&lt;/span&gt;;
                    ws.Cells[1, 10].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"Ended"&lt;/span&gt;;
                    ws.Cells[1, 11].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"HoursWorked(hrs)"&lt;/span&gt;;
                    ws.Cells[1, 12].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"Remarks "&lt;/span&gt;;
                    ws.Cells[1, 13].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"ElapseTime "&lt;/span&gt;;
                    &lt;span style="color: blue;"&gt;var&lt;/span&gt; fill = ws.Row(1).Style.Fill;
                    ws.Row(1).Style.Font.Color.SetColor(Color.LightGreen);
                    fill.PatternType = ExcelFillStyle.Solid;
                    fill.BackgroundColor.SetColor(Color.Black);
                    ws.Row(1).Style.Font.Bold = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
                    &lt;span style="color: blue;"&gt;#endregion&lt;/span&gt;
                }
            }
            &lt;span style="color: blue;"&gt;else&lt;/span&gt;
            {
                &lt;span style="color: blue;"&gt;#region&lt;/span&gt; OtherProejcts Header
                ws.Cells[1, 1].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"KeyerID"&lt;/span&gt;;
                ws.Cells[1, 2].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"TranDate"&lt;/span&gt;;
                ws.Cells[1, 3].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"Project"&lt;/span&gt;;
                ws.Cells[1, 4].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"BatchType"&lt;/span&gt;;
                ws.Cells[1, 5].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"BatchName"&lt;/span&gt;;
                ws.Cells[1, 6].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"#Records"&lt;/span&gt;;
                ws.Cells[1, 7].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"#Pulls"&lt;/span&gt;;
                ws.Cells[1, 8].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"Time[Start]"&lt;/span&gt;;
                ws.Cells[1, 9].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"Time[End]"&lt;/span&gt;;
                ws.Cells[1, 10].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"HoursWorked(hrs)"&lt;/span&gt;;
                ws.Cells[1, 11].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"EmpPIN "&lt;/span&gt;;
                ws.Cells[1, 12].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"ElapseTime "&lt;/span&gt;;
                &lt;span style="color: blue;"&gt;var&lt;/span&gt; fill = ws.Row(1).Style.Fill;
                ws.Row(1).Style.Font.Color.SetColor(Color.LightGreen);
                fill.PatternType = ExcelFillStyle.Solid;
                fill.BackgroundColor.SetColor(Color.Black);
                ws.Row(1).Style.Font.Bold = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
                &lt;span style="color: blue;"&gt;#endregion&lt;/span&gt;
            }
        }&lt;/pre&gt;
&lt;/div&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;private&lt;/span&gt;&lt;span style="background-color: white;"&gt; &lt;/span&gt;&lt;span style="color: blue;"&gt;void&lt;/span&gt;&lt;span style="background-color: white;"&gt; plotMainData(DataSet leDS, ExcelWorksheet ws, &lt;/span&gt;&lt;span style="color: blue;"&gt;string&lt;/span&gt;&lt;span style="background-color: white;"&gt; curPROJ) &lt;/span&gt;&lt;/pre&gt;
&lt;pre&gt;        {
            &lt;span style="color: blue;"&gt;if&lt;/span&gt; (leDS.Tables[0].Rows.Count &amp;gt; 0)
            {
                &lt;span style="color: blue;"&gt;if&lt;/span&gt; (curPROJ == &lt;span style="color: rgb(163, 21, 21);"&gt;"Proj1"&lt;/span&gt; || curPROJ == &lt;span style="color: rgb(163, 21, 21);"&gt;"Proj2"&lt;/span&gt;)
                {
                    &lt;span style="color: blue;"&gt;if&lt;/span&gt; (curPROJ == &lt;span style="color: rgb(163, 21, 21);"&gt;"Proj1"&lt;/span&gt;)
                    {
                        &lt;span style="color: blue;"&gt;#region&lt;/span&gt; Proj1 data
                        
                        &lt;span style="color: blue;"&gt;#endregion&lt;/span&gt;
                    }
                    &lt;span style="color: blue;"&gt;else&lt;/span&gt; &lt;span style="color: blue;"&gt;if&lt;/span&gt; (curPROJ == &lt;span style="color: rgb(163, 21, 21);"&gt;"Proj2"&lt;/span&gt;)
                    {
                        &lt;span style="color: blue;"&gt;#region&lt;/span&gt; Proj2 data
                        
                        &lt;span style="color: green;"&gt;//int rowIndex = 1;&lt;/span&gt;
                        &lt;span style="color: blue;"&gt;int&lt;/span&gt; cntr = 1;
                        &lt;span style="color: blue;"&gt;foreach&lt;/span&gt; (DataRow myRow &lt;span style="color: blue;"&gt;in&lt;/span&gt; leDS.Tables[0].Rows) 
                        {                            
                            ws.Cells[cntr + 1, 1].Value = myRow[&lt;span style="color: rgb(163, 21, 21);"&gt;"xcKeyerID"&lt;/span&gt;].ToString();
                            ws.Cells[cntr + 1, 2].Value = myRow[&lt;span style="color: rgb(163, 21, 21);"&gt;"xcEmployeePIN"&lt;/span&gt;].ToString();
                            ws.Cells[cntr + 1, 3].Value = Convert.ToDateTime(myRow[&lt;span style="color: rgb(163, 21, 21);"&gt;"xcTranDate"&lt;/span&gt;]).ToShortDateString();
                            ws.Cells[cntr + 1, 4].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"Proj2"&lt;/span&gt;;
                            ws.Cells[cntr + 1, 5].Value = myRow[&lt;span style="color: rgb(163, 21, 21);"&gt;"xcTaskType"&lt;/span&gt;].ToString();
                            &lt;span style="color: green;"&gt;//ws.Cells[cntr + 1, 6].Value = myRow["xcClaimNum"].ToString();&lt;/span&gt;

&lt;span style="color: green;"&gt;&lt;span style="white-space: pre;"&gt;			&lt;/span&gt;    //you can see here i've tried inserting A with an incremental value&lt;br&gt;&lt;/span&gt;&lt;span style="color: green;"&gt;                            //the result was ok. I was able to opened the excel file output&lt;/span&gt;
&lt;span style="color: green;"&gt;                            //im still wondering why all the data i've listed above causes the&lt;/span&gt;
&lt;span style="color: green;"&gt;                            //excel file to be unreadable.&lt;/span&gt;
                            ws.Cells[cntr + 1, 6].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"A"&lt;/span&gt; + cntr.ToString();
                            ws.Cells[cntr + 1, 7].Value = myRow[&lt;span style="color: rgb(163, 21, 21);"&gt;"xcIntakeNUM"&lt;/span&gt;];
                            ws.Cells[cntr + 1, 8].Value = myRow[&lt;span style="color: rgb(163, 21, 21);"&gt;"xcRouteTo"&lt;/span&gt;];
                            ws.Cells[cntr + 1, 9].Value = myRow[&lt;span style="color: rgb(163, 21, 21);"&gt;"xcTimeStarted"&lt;/span&gt;].ToString();
                            ws.Cells[cntr + 1, 10].Value = myRow[&lt;span style="color: rgb(163, 21, 21);"&gt;"xcTimeEnded"&lt;/span&gt;].ToString();
                            ws.Cells[cntr + 1, 11].Value = ComputeWorkHours(Convert.ToDateTime(myRow[&lt;span style="color: rgb(163, 21, 21);"&gt;"xcTimeStarted"&lt;/span&gt;]),
                                                                            Convert.ToDateTime(myRow[&lt;span style="color: rgb(163, 21, 21);"&gt;"xcTimeEnded"&lt;/span&gt;]));
                            ws.Cells[cntr + 1, 12].Value = myRow[&lt;span style="color: rgb(163, 21, 21);"&gt;"xcRemarks"&lt;/span&gt;];
                            ws.Cells[cntr + 1, 13].Value = ComputeElapseTime(Convert.ToDateTime(myRow[&lt;span style="color: rgb(163, 21, 21);"&gt;"xcTimeStarted"&lt;/span&gt;]),
                                                                             Convert.ToDateTime(myRow[&lt;span style="color: rgb(163, 21, 21);"&gt;"xcTimeEnded"&lt;/span&gt;]));
                            &lt;span style="color: blue;"&gt;int&lt;/span&gt; progRep = Convert.ToInt16(Math.Ceiling((&lt;span style="color: blue;"&gt;double&lt;/span&gt;)(cntr * 100) / leDS.Tables[0].Rows.Count));
                            bgWorker_one.ReportProgress(progRep);
                            cntr = cntr + 1;
                        }
                        &lt;span style="color: blue;"&gt;#endregion&lt;/span&gt;
                    }
                }
                &lt;span style="color: blue;"&gt;else&lt;/span&gt;
                {
                    &lt;span style="color: blue;"&gt;#region&lt;/span&gt; OtherProjects
                    &lt;span style="color: blue;"&gt;for&lt;/span&gt; (&lt;span style="color: blue;"&gt;int&lt;/span&gt; rCount = 0; rCount &amp;lt; leDS.Tables[0].Rows.Count; rCount++)
                    {
                        ws.Cells[rCount + 2, 5].Style.Numberformat.Format = &lt;span style="color: rgb(163, 21, 21);"&gt;"49"&lt;/span&gt;;
                        ws.Cells[rCount + 2, 1].Value = checkForNull(leDS.Tables[0].Rows[rCount][10]);
                        ws.Cells[rCount + 2, 2].Value = Convert.ToDateTime(leDS.Tables[0].Rows[rCount][11].ToString()).ToShortDateString();
                        ws.Cells[rCount + 2, 3].Value = checkForNull(leDS.Tables[0].Rows[rCount][3]);
                        ws.Cells[rCount + 2, 4].Value = checkForNull(leDS.Tables[0].Rows[rCount][4]);
                        ws.Cells[rCount + 2, 5].Value = checkForNull(leDS.Tables[0].Rows[rCount][5]);
                        ws.Cells[rCount + 2, 6].Value = checkForNull(leDS.Tables[0].Rows[rCount][6]);
                        ws.Cells[rCount + 2, 7].Value = checkForNull(leDS.Tables[0].Rows[rCount][7]);
                        ws.Cells[rCount + 2, 8].Value = checkForNull(leDS.Tables[0].Rows[rCount][8]);
                        ws.Cells[rCount + 2, 9].Value = checkForNull(leDS.Tables[0].Rows[rCount][9]);
                        ws.Cells[rCount + 2, 10].Value = ComputeWorkHours(Convert.ToDateTime(leDS.Tables[0].Rows[rCount][8].ToString()),
                                                                          Convert.ToDateTime(leDS.Tables[0].Rows[rCount][9].ToString()));
                        ws.Cells[rCount + 2, 11].Value = checkForNull(leDS.Tables[0].Rows[rCount][0]);
                        ws.Cells[rCount + 2, 12].Value = ComputeElapseTime(Convert.ToDateTime(leDS.Tables[0].Rows[rCount][8].ToString()),
                                                                          Convert.ToDateTime(leDS.Tables[0].Rows[rCount][9].ToString()));
                        bgWorker_one.ReportProgress(Convert.ToInt16(Math.Ceiling((&lt;span style="color: blue;"&gt;double&lt;/span&gt;)(rCount * 100) / leDS.Tables[0].Rows.Count)));
                    }
                    &lt;span style="color: blue;"&gt;#endregion&lt;/span&gt;
                }&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Thank you for taking your time reading and replying here. It is much&amp;nbsp;appreciated.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="06/03/2012 11:54:16">
          <Html>
        
&lt;p&gt;When I copied your sample data to notepad++, I´ve noticed a strange char inside your data, take a look at this screenshot&lt;/p&gt;
&lt;p&gt;&lt;a href="http://i.imgur.com/z67lh.png" rel="nofollow"&gt;http://i.imgur.com/z67lh.png&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Try to run your code and skip that registry in debug mode to test.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="cleric146" When="07/03/2012 03:10:09">
          <Html>
        
&lt;p&gt;Oh MY!. I COULD kiss your right now men! THANK YOU SO MUCH! you were right. I created a procedure to replace all the possible whitespaces. And now its working fine. Thank you. Really Thank you.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Layout Textbox">
      <Posts>
        <Post From="flownfluid" When="02/03/2012 16:36:02">
          <Html>
        
&lt;p&gt;Hi all,&lt;/p&gt;
&lt;p&gt;it's possible to create a textbox with a different font and is also possible to format the text differently?&lt;/p&gt;
&lt;p&gt;for Example (Text in my Textbox)&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;Title (Arial, size :10, bold)&lt;/p&gt;
&lt;p&gt;blablalba (Calibri, size:8)&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;thanks...&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;span style="font: 16px/normal arial, sans-serif; color: rgb(51, 51, 51); text-transform: none; text-indent: 0px; letter-spacing: normal; word-spacing: 0px; white-space: normal; orphans: 2; widows: 2; font-size-adjust: none; font-stretch: normal; background-color: rgb(245, 245, 245);"&gt;&amp;nbsp;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font: 16px/normal arial, sans-serif; color: rgb(51, 51, 51); text-transform: none; text-indent: 0px; letter-spacing: normal; word-spacing: 0px; white-space: normal; orphans: 2; widows: 2; font-size-adjust: none; font-stretch: normal; background-color: rgb(245, 245, 245);"&gt;&amp;nbsp;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font: 16px/normal arial, sans-serif; color: rgb(51, 51, 51); text-transform: none; text-indent: 0px; letter-spacing: normal; word-spacing: 0px; white-space: normal; orphans: 2; widows: 2; font-size-adjust: none; font-stretch: normal; background-color: rgb(245, 245, 245);"&gt;&amp;nbsp;&lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="06/03/2012 16:46:14">
          <Html>
        
&lt;p&gt;EPPlus doesnt support forms in this current release.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Problems Finding named worksheet created by another process">
      <Posts>
        <Post From="Mardon" When="05/03/2012 20:03:54">
          <Html>
        
&lt;p&gt;I am using SSIS to create my excel file. I can open the file even look at the unzipped excel zip file to look at the underlying xml content, but when i try and open up the work sheet by name, i can't find any data through code.&lt;/p&gt;
&lt;p&gt;ExcelPackage excelPackage = new ExcelPackage(fileInfo);&lt;/p&gt;
&lt;p&gt;ExcelWorksheet worksheet = excelPackage.Workbook.Worksheets[1];&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I then want to apply formatting and append new lines to the excel document.&lt;/p&gt;
&lt;div id="_mcePaste" style="left: -10000px; top: 0px; width: 1px; height: 1px; overflow: hidden;"&gt;
﻿&lt;/div&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;worksheet.InsertRow(1, 2);&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;worksheet.Cells[1, 1].Value = "Report TEXT";&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;worksheet.Cells[1, 1, 1, 7].Merge = true;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;worksheet.Cells[1, 1, 1, 7].Style.Font.Bold = true;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;worksheet.Cells[1, 1, 1, 7].Style.HorizontalAlignment = ExcelHorizontalAlignment.Center;&lt;/p&gt;
&lt;p&gt;When i try to look at the excel obect in the locals window i can't ever find the xml i am expecting. Anybody else ran into this issue?&lt;/p&gt;
&lt;p&gt;When i look at the value of the InnerXml the data sheet is empty.&lt;/p&gt;
&lt;p&gt;&amp;lt;worksheet xmlns="&lt;a href="http://schemas.openxmlformats.org/spreadsheetml/2006/main" rel="nofollow"&gt;http://schemas.openxmlformats.org/spreadsheetml/2006/main&lt;/a&gt;" xmlns:r="&lt;a href='http://schemas.openxmlformats.org/officeDocument/2006/relationships"&gt;&lt;dimension' rel="nofollow"&gt;http://schemas.openxmlformats.org/officeDocument/2006/relationships"&amp;gt;&amp;lt;dimension&lt;/a&gt;
 ref="A1:G137" /&amp;gt;&amp;lt;sheetViews&amp;gt;&amp;lt;sheetView tabSelected="1" workbookViewId="0" rightToLeft="false"&amp;gt;&amp;lt;selection activeCell="C5" sqref="C5" /&amp;gt;&amp;lt;/sheetView&amp;gt;&amp;lt;/sheetViews&amp;gt;&amp;lt;sheetFormatPr defaultRowHeight="15" /&amp;gt;&amp;lt;sheetData /&amp;gt;&amp;lt;pageMargins
 left="0.7" right="0.7" top="0.75" bottom="0.75" header="0.3" footer="0.3" /&amp;gt;&amp;lt;headerFooter /&amp;gt;&amp;lt;/worksheet&amp;gt;&lt;/p&gt;
&lt;p&gt;But when i dig deeper into the underlaying object i can see that it is correctly pointing to xl/worksheet/sheet1.xml. Now when i unzip the package and view the resultsing sheet1.xml in a viewer the excel xml is as i expected it to be.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mardon" When="06/03/2012 16:08:50">
          <Html>
        
&lt;p&gt;Never mind, I figured out what i was doing wrong... This is still a great library for modifying excel. :-)&lt;/p&gt;
&lt;p&gt;Must save back to the excelpackage to get the changes...&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Is there an Equivalent to ExcelApplication.Intersect method.">
      <Posts>
        <Post From="tloomis" When="01/03/2012 23:06:45">
          <Html>
        
&lt;p&gt;&lt;span style='color: black; font-family: "Segoe UI","sans-serif"; font-size: 10pt;'&gt;This is the first I am using this library so I apologize if this is obvious.&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style='color: black; font-family: "Segoe UI","sans-serif"; font-size: 10pt;'&gt;I am replacing an Excel automation solution using this library. There are several places where I used to do an Insersect method. I have named ranges in Excel that name the columns
 for a group of rows. I used to call the Intersect passing in two named ranges (column and a second range that was the row). This ould get me to the specific column for a given row. Is there anything close to that or am I left to enumerating and looping?&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style='color: black; font-family: "Segoe UI","sans-serif"; font-size: 10pt;'&gt;Thanks in advance.&lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Use a template to insert data into a chart.">
      <Posts>
        <Post From="fachris" When="01/03/2012 16:44:33">
          <Html>
        
&lt;p&gt;I know functionality exists to create a chart, but if I wanted to use a template chart that was formatted to my specifications is there a way to access the chart from the code behind and insert data to a specified range of cells. I tried using a template
 and inserting data into the range for each series on the chart, but it did not work. I am not sure if there is a way to do this?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thank you,&lt;/p&gt;
&lt;p&gt;Chris&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to setvalue by cell alias name?">
      <Posts>
        <Post From="cnbobo" When="22/02/2012 05:14:05">
          <Html>
        
&lt;p&gt;Hi,All&lt;/p&gt;
&lt;p&gt;I have a template,there have three sheet.sheet2 and sheet3 are copy from sheet1.&lt;/p&gt;
&lt;p&gt;In sheet1,there had use cell alias name(sheet1 have 7 cell alias name).So we can find those names from Excel name manager.&lt;/p&gt;
&lt;p&gt;don't forget,sheet2 and sheet3,because copy from sheet1,so they also have same cell alias name.but in excel name manager,we found,those are different.&lt;/p&gt;
&lt;p&gt;like this.different r&lt;span&gt;eference&lt;/span&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;span&gt;address，and different range(some are workbook,some are different worksheet).&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;those,just tell you,why one workbook have same cell alias name.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;So,my question is,how to setvalues,by cell alias name?&lt;/p&gt;
&lt;p&gt;for example:&lt;/p&gt;
&lt;p&gt;there have a cell in sheet1,the celladdress is "B2",and it's cell alias name is "printDate".&lt;/p&gt;
&lt;p&gt;i want to set this cell a value is "2012-02-22" by cell alias name "printDate".&lt;/p&gt;
&lt;p&gt;i had checked,worksheet.names.count is 0,and workbook.names.count is 7,i think, worksheet.nams.count should be 7,and workbook.names.count should be 21.but they are not. I don't know why? maybe,it's a bug.i am not sure.&lt;/p&gt;
&lt;p&gt;I just want to setvalues,by cell alias name.&lt;/p&gt;
&lt;p&gt;please help me and give me some suggestion.Thanks.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;﻿&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="rguy" When="28/02/2012 22:58:58">
          <Html>
        
&lt;p&gt;Just wanted to say I have this exact same problem. &amp;nbsp;In fact, if you save the excel package after loading it, indeed it erases all cell alias names that you had in the worksheet.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="cnbobo" When="29/02/2012 01:22:46">
          <Html>
        
&lt;p&gt;please see here:&lt;a href="http://epplus.codeplex.com/workitem/13628" rel="nofollow"&gt;http://epplus.codeplex.com/workitem/13628&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;I had solved this problem.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="SharePoint ContentTypes">
      <Posts>
        <Post From="Jack_thompson" When="28/02/2012 04:20:54">
          <Html>
        
&lt;p&gt;Hello,&lt;br&gt;
&lt;br&gt;
In SharePoint Excel files may be extended by ContentTypeProperties. These properties may be read by VBA macros by accessing the property ContentTypeProperties of a workbook.&lt;/p&gt;
&lt;div&gt;&amp;nbsp;&lt;/div&gt;
&lt;p&gt;How do I access those properties using EPPlus&lt;br&gt;
&lt;br&gt;
Thanks.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Excel Data Table">
      <Posts>
        <Post From="namit101" When="26/02/2012 22:55:28">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I'm trying to create an Excel Data Table (in Excel, it's normally under Data -&amp;gt; What-If Analysis -&amp;gt; Data Table). &amp;nbsp;I've searched through the current discussions and samples and didn't see anything too relevant.&lt;/p&gt;
&lt;p&gt;I can create this by hand (just iterating over all the cells and creating a formula in each cell), but this defeats the purpose of making it easier for the user to change the formula. &amp;nbsp;If it's not possible, are there any other methods I might be able
 to use?&lt;/p&gt;
&lt;p&gt;Thanks!&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Select Item in Drop Down">
      <Posts>
        <Post From="steve5877" When="22/02/2012 15:08:47">
          <Html>
        
&lt;p&gt;I'm trying to interface with a spreadsheet that I have been given from another company. I'm having two problems.&lt;/p&gt;
&lt;p&gt;First, I can load the cells, but the formulas won't calculate until I open the spreadsheet in Excel. &amp;nbsp;Then they compute automatically. &amp;nbsp;This might be related to the fact there are protections on the spreadsheet that I do not have the password for
 an there are also macros and other content that trigger the security warnings.&lt;/p&gt;
&lt;p&gt;The other problem is that while most of the inputs are simple cells, two of the fields are DropDowns. &amp;nbsp;How do I select an item in a DropDown using EPPlus? &amp;nbsp;Is it possible without the passsword.&lt;/p&gt;
&lt;p&gt;My boss is pleased that I'm able to populate all the cells and open the spreadsheet. &amp;nbsp;Now all he has to do is select the two drop downs and the sheet calculates what he needs, but I'd like to go all the way with this if its possible.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Version 3.0">
      <Posts>
        <Post From="JanKallman" When="17/01/2012 19:29:04">
          <Html>
        
&lt;p&gt;Ok, so it's time for a new version again.&lt;/p&gt;
&lt;p&gt;Not much new functionality, but a lot of bugfixes. I have focused on rewritting all code from the Excelpackage to enable a license change to LGPL.&lt;/p&gt;
&lt;p&gt;I'll have this version in beta for a week or so,&amp;nbsp;if no major bugs are found. Then I'll change the license. So please download this version and help me with the last testing. I'll also try to change the sourcecontrol to Mercurial in the coming week.&lt;/p&gt;
&lt;p&gt;If you find any bugs or&amp;nbsp;strange behavior please report the here or in the issue tracker&lt;/p&gt;
&lt;p&gt;Have fun&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="cdonges" When="20/01/2012 00:32:42">
          <Html>
        
&lt;p&gt;When I set the title of a chart it doesn't seem to get saved:&lt;/p&gt;
&lt;p&gt;chart.Title.RichText.Add(name);&lt;/p&gt;
&lt;p&gt;or&lt;/p&gt;
&lt;p&gt;chart.Title.Text = name;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="deep_desai" When="23/01/2012 08:19:59">
          <Html>
        
&lt;p&gt;Does this have Conditional Formatting?.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="23/01/2012 20:55:40">
          <Html>
        
&lt;p&gt;Can't reproduce the chart title problem. Both your&amp;nbsp;sample works for me.&amp;nbsp;Can you supply a full&amp;nbsp;sample.&lt;/p&gt;
&lt;p&gt;Conditional formatting is not included in 3.0&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="cdonges" When="20/02/2012 22:37:15">
          <Html>
        
&lt;p&gt;Sorry, this one was my mistake. I was setting the title to string.empty later in my code.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to find out the number of tabs or worksheets">
      <Posts>
        <Post From="ireneleez" When="18/02/2012 07:40:33">
          <Html>
        
&lt;p&gt;Is there any way to find out the number of tabs or worksheets in the Excel package?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="TiSch" When="18/02/2012 21:25:37">
          <Html>
        
&lt;p&gt;&lt;em&gt;ExcelPackage.WorkBook.WorkSheets&lt;/em&gt; is an&lt;em&gt; IEnumerable&amp;lt;ExcelWorksheet&amp;gt;&lt;/em&gt;, hence&lt;em&gt; pck&lt;/em&gt;&lt;em&gt;.Workbook.Worksheets.Count
&lt;/em&gt;returns the number of worksheets in an ExcelPackage.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;&lt;br&gt;
&lt;/em&gt;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to find out the last row with data">
      <Posts>
        <Post From="ireneleez" When="18/02/2012 06:45:17">
          <Html>
        
&lt;p&gt;I am trying to read the data from an excel spreadsheet. &amp;nbsp;I like to find out how I can detect the last row or empty row.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to Create Data validations to display Dynamic Chart">
      <Posts>
        <Post From="madankumar6" When="17/02/2012 10:13:45">
          <Html>
        
&lt;p&gt;Hi..&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; First of all, Very Thank You for doing a great work.. The library works great more than i expexted..&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; I have an issue to clarify with you..&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; ﻿﻿﻿My requirement is to generate Line chart for the records... My workbook will have thousands of records and showing them all will be clumsy so I decided to show only 20 points in the line chart once.. and I want
 to create like navigation options(Probably the Next and previous button) to dynamically change the data in the line chart..&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; for an example, at first the line chart must refer through "A1:A20" and If the user presses next option, the line chart must refer to "A21:A40" and should show new data...&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; Kindly tell me is it possible to create buttons and its pressing validations using EPPlus in Excel(What I wanted is, If the user presses the next button, The chart will refresh itself by referreing to the new range)&lt;/p&gt;
&lt;p&gt;Thanks in advance..&lt;/p&gt;
&lt;p&gt;regards&lt;/p&gt;
&lt;p&gt;Madankumar&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Error while reading Excel: Sequence contains no elements">
      <Posts>
        <Post From="ElsNijs" When="13/02/2012 10:45:13">
          <Html>
        
&lt;p&gt;I recently switched from vs 2008 to vs 2010. In vs2008 I used EPPlus a lot to read and write to excel from websites. In the next peace of (red) code I get the error: Sequence contains no elements&lt;/p&gt;
&lt;p&gt;&amp;nbsp;Dim myToepassing As New ExcelPackage(myFile)&lt;br&gt;
&amp;nbsp;Dim myWorkbook As ExcelWorkbook = myToepassing.Workbook&lt;br&gt;
&lt;span style="color: rgb(255, 0, 0);"&gt;&amp;nbsp;Dim werkblad As ExcelWorksheet = myWorkbook.Worksheets.First()&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;The excel has 3 worksheets. I used to do this in my vs2008 projects without a problem. Can someone tell me what I do wrong or what need to be changed? I downloaded the latest version of epplus&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="16/02/2012 20:38:09">
          <Html>
        
&lt;p&gt;You have no worksheets in the worksheets collection.&lt;/p&gt;
&lt;p&gt;I would guess the myFile path does not point at your template file. (Check the myFile.Exists property)&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="List of Worksheets in a ListBox or ComboBox">
      <Posts>
        <Post From="schwabe1111" When="13/02/2012 19:51:06">
          <Html>
        
&lt;p&gt;Hello all,&lt;/p&gt;
&lt;p&gt;I'd like to read the names of all worksheets of an existing xls-sheet into a ListBox or ComboBox.&lt;/p&gt;
&lt;p&gt;Presently, I have:&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;private&lt;/span&gt; &lt;span style="color: blue;"&gt;void&lt;/span&gt; btnOpen_Click(&lt;span style="color: blue;"&gt;object&lt;/span&gt; sender, EventArgs e)
        {
            &lt;span style="color: green;"&gt;// Displays an OpenFileDialog so the user can select an Excel File.&lt;/span&gt;
            OpenFileDialog openFileDialog1 = &lt;span style="color: blue;"&gt;new&lt;/span&gt; OpenFileDialog();
            openFileDialog1.Filter = &lt;span style="color: rgb(163, 21, 21);"&gt;"Excel Files|*.xlsx"&lt;/span&gt;;
            openFileDialog1.Title = &lt;span style="color: rgb(163, 21, 21);"&gt;"Select an Excel File"&lt;/span&gt;;

            &lt;span style="color: green;"&gt;// Show the Dialog.&lt;/span&gt;
        &lt;span style="color: blue;"&gt;if&lt;/span&gt; (openFileDialog1.ShowDialog() == DialogResult.OK)
        {
                lblFileName.Text  = openFileDialog1.FileName;
        }

        &lt;span style="color: blue;"&gt;if&lt;/span&gt; (openFileDialog1.FileName == String.Empty)
        {
            lblFileName.Text = &lt;span style="color: rgb(163, 21, 21);"&gt;""&lt;/span&gt;;
            &lt;span style="color: blue;"&gt;return&lt;/span&gt;;&lt;span style="color: green;"&gt;//user didn't select a file&lt;/span&gt;
        }

        &lt;span style="color: green;"&gt;// Open Excel File&lt;/span&gt;
        &lt;span style="color: blue;"&gt;using&lt;/span&gt; (ExcelPackage package = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(openFileDialog1.OpenFile()))

        &lt;span style="color: green;"&gt;// get the worksheets in the workbook&lt;/span&gt;
        lBoWorksheet.Items.Add(package.Workbook.Worksheets[1]);
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;}&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;However, this only give me the name for the first worksheet...&lt;/p&gt;
&lt;p&gt;Thanks,&lt;/p&gt;
&lt;p&gt;Benjamin&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="16/02/2012 20:34:08">
          <Html>
        
&lt;p&gt;Worksheets is a collection. Use a foreach or for loop to iterate the worksheets.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Writing Large Files">
      <Posts>
        <Post From="ant_t" When="08/02/2012 12:45:03">
          <Html>
        
&lt;p&gt;Hey,&lt;/p&gt;
&lt;p&gt;First off, to the creator of EPPlus, you have made a fantastic tool here. Thanks so much.&lt;/p&gt;
&lt;p&gt;I'm creating some very large files and getting your typical OutOfMemoryExceptions.&lt;/p&gt;
&lt;p&gt;As per instructed in previous posts I've monitored the memory usage of my app with task manager. The app throws an exception at around the 1.5GB mark. My machine has 16GB DDR3 (which barely ever manages 30% usgae) so I don't think I'm dealing with a hard
 memory cap.&lt;/p&gt;
&lt;p&gt;I think I am hitting the memory limit for any single object (which in .NET is 2GB). And I'm pretty sure that is happening in the collection of cells EPPlus stores (the collection of&amp;nbsp;&lt;span&gt;ExcelCell objects).&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;I've checked in my debugger and I'm 90% through writing all the information the sheet. So has anyone got any ideas on how I can hack through this?&lt;br&gt;
&lt;br&gt;
Is there a way to flush the ExcellCell collection to disk (destroying the large collection of objects as you go)? Can I write and save one sheet at a time (without prohibitive reloading times or disposing completely at all) ?&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;Thanks for any help&lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="12/02/2012 15:23:50">
          <Html>
        
&lt;p&gt;No, you have probably reached the limit on 32-bit windows (if thats&amp;nbsp;is the OS you run on).&lt;/p&gt;
&lt;p&gt;If you have the option to run it on a&amp;nbsp;64-bit Windows it should solve your problem.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="ant_t" When="13/02/2012 12:57:51">
          <Html>
        
&lt;p&gt;Thanks for the reply,&lt;/p&gt;
&lt;p&gt;I was on a 64bit system but I was building my app as 32bit.&lt;/p&gt;
&lt;p&gt;Built as 64bit and it works great!&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to determine if cell has formula applied in it.">
      <Posts>
        <Post From="htbrady" When="08/02/2012 23:35:27">
          <Html>
        
&lt;p&gt;I am reading an Excel file as a data source. &amp;nbsp;As I go through row by row, I check a certain cell for a value. &amp;nbsp;Sometimes the cell will only contain a number only. &amp;nbsp;Other times it will have a number that is a result of a formula (usually a
 sum...e.g. =SUM(F21:F22)). &amp;nbsp;&lt;/p&gt;
&lt;p&gt;Is there a way for me to determine when I am at the particular cell, that even though it contains a number, that underlying that number is a formula?? &amp;nbsp;I need to be able to do this so I can exclude these values when I come across them.&lt;/p&gt;
&lt;p&gt;Any C# syntax you can provide is certainly appreciated.&lt;/p&gt;
&lt;p&gt;Thanks!&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="htbrady" When="08/02/2012 23:43:10">
          <Html>
        
&lt;p&gt;This seems to be working!&lt;/p&gt;
&lt;pre&gt;cellCheck&amp;nbsp;=&amp;nbsp;sheet.Cells[currentRow,&amp;nbsp;currentCol].Formula.ToString();
&lt;/pre&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to copy a range and paste it as image">
      <Posts>
        <Post From="culeadragos" When="01/02/2012 19:23:57">
          <Html>
        
&lt;p&gt;Suppose there are 2 worksheets W1 and W2 in a workbook. W1 has some data that needs to be copied and pasted as an image to W2. How can this be achieved with Epplus?&lt;br&gt;
&lt;br&gt;
&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="06/02/2012 21:46:25">
          <Html>
        
&lt;p&gt;It can't. There is no rendering in EPPlus.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="NumberFormat, Danish currency and XML problems">
      <Posts>
        <Post From="SpiritInMotion" When="03/02/2012 08:59:08">
          <Html>
        
&lt;p&gt;I am trying to format the contents of a cell into Danish currency. According to the styles.xml in the xlsx file, the argument to NumberFormat should be&lt;/p&gt;
&lt;p&gt;"&amp;amp;quot;kr.&amp;amp;quot;\ #,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00"&lt;/p&gt;
&lt;p&gt;When I save my xlsx file, the corresponding value in the styles.xlsx file is&lt;/p&gt;
&lt;p&gt;"&amp;amp;amp;quot;kr.&amp;amp;amp;quot;\ #,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00"&lt;/p&gt;
&lt;p&gt;I know that the &amp;amp; is not allowed as a value in XML, but I don't think it should be escaped when already used as part of escaping the quotes.&lt;/p&gt;
&lt;p&gt;How can I format a number into Danish currency and is the escaping a bug in EPPlus?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="SpiritInMotion" When="03/02/2012 09:07:52">
          <Html>
        
&lt;p&gt;OK, I guess that I shouldn't escape the quotes my self:&lt;/p&gt;
&lt;p&gt;@"""kr.""\ #,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00"&lt;/p&gt;
&lt;p&gt;I guess I just needed to post to realize :)&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How does one iterate over all rows/columns in an ExcelNamedRange?">
      <Posts>
        <Post From="fabrikater" When="16/01/2012 15:10:09">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I have the following code, but I&amp;nbsp;receive an exception in the outer for loop on the ExcelNamedRange Start and End properties.&lt;/p&gt;
&lt;p&gt;The exception thrown is:&lt;/p&gt;
&lt;p&gt;System.ArgumentOutOfRangeException&amp;nbsp;:&amp;nbsp;Row&amp;nbsp;cannot&amp;nbsp;be&amp;nbsp;less&amp;nbsp;then&amp;nbsp;1.&lt;br&gt;
Parameter&amp;nbsp;name:&amp;nbsp;value&lt;/p&gt;
&lt;p&gt;Can somebody provide a clear overview on how to work with named ranges?&lt;/p&gt;
&lt;p&gt;Best regards,&lt;/p&gt;
&lt;p&gt;Fab&lt;/p&gt;
&lt;pre style="background: rgb(34, 40, 42); color: rgb(241, 242, 243); font-family: Consolas; font-size: 13px;"&gt;&lt;span style="color: rgb(103, 140, 177);"&gt;ExcelWorksheet&lt;/span&gt;&amp;nbsp;sheet&amp;nbsp;&lt;span style="color: rgb(232, 226, 183);"&gt;=&lt;/span&gt;&amp;nbsp;_openXmlPackage&lt;span style="color: rgb(232, 226, 183);"&gt;.&lt;/span&gt;Workbook&lt;span style="color: rgb(232, 226, 183);"&gt;.&lt;/span&gt;Worksheets["SheetName"];
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
&lt;span style="color: rgb(147, 199, 99);"&gt;using&lt;/span&gt;&amp;nbsp;(&lt;span style="color: rgb(103, 140, 177);"&gt;ExcelNamedRange&lt;/span&gt;&amp;nbsp;namedRange&amp;nbsp;&lt;span style="color: rgb(232, 226, 183);"&gt;=&lt;/span&gt;&amp;nbsp;sheet&lt;span style="color: rgb(232, 226, 183);"&gt;.&lt;/span&gt;Names["RangeName"])
{
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span style="color: rgb(147, 199, 99);"&gt;for&lt;/span&gt;&amp;nbsp;(&lt;span style="color: rgb(147, 199, 99);"&gt;int&lt;/span&gt;&amp;nbsp;rowIndex&amp;nbsp;&lt;span style="color: rgb(232, 226, 183);"&gt;=&lt;/span&gt;&amp;nbsp;namedRange&lt;span style="color: rgb(232, 226, 183);"&gt;.&lt;/span&gt;Start&lt;span style="color: rgb(232, 226, 183);"&gt;.&lt;/span&gt;Row;&amp;nbsp;rowIndex&amp;nbsp;&lt;span style="color: rgb(232, 226, 183);"&gt;&amp;lt;=&lt;/span&gt;&amp;nbsp;namedRange&lt;span style="color: rgb(232, 226, 183);"&gt;.&lt;/span&gt;End&lt;span style="color: rgb(232, 226, 183);"&gt;.&lt;/span&gt;Row;&amp;nbsp;rowIndex&lt;span style="color: rgb(232, 226, 183);"&gt;++&lt;/span&gt;)
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span style="color: rgb(147, 199, 99);"&gt;for&lt;/span&gt;&amp;nbsp;(&lt;span style="color: rgb(147, 199, 99);"&gt;int&lt;/span&gt;&amp;nbsp;columnIndex&amp;nbsp;&lt;span style="color: rgb(232, 226, 183);"&gt;=&lt;/span&gt;&amp;nbsp;namedRange&lt;span style="color: rgb(232, 226, 183);"&gt;.&lt;/span&gt;Start&lt;span style="color: rgb(232, 226, 183);"&gt;.&lt;/span&gt;Column;&amp;nbsp;columnIndex&amp;nbsp;&lt;span style="color: rgb(232, 226, 183);"&gt;&amp;lt;=&lt;/span&gt;&amp;nbsp;namedRange&lt;span style="color: rgb(232, 226, 183);"&gt;.&lt;/span&gt;End&lt;span style="color: rgb(232, 226, 183);"&gt;.&lt;/span&gt;Column;&amp;nbsp;columnIndex&lt;span style="color: rgb(232, 226, 183);"&gt;++&lt;/span&gt;)
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span style="color: rgb(147, 199, 99);"&gt;var&lt;/span&gt;&amp;nbsp;test&amp;nbsp;&lt;span style="color: rgb(232, 226, 183);"&gt;=&lt;/span&gt;&amp;nbsp;sheet&lt;span style="color: rgb(232, 226, 183);"&gt;.&lt;/span&gt;Cells[rowIndex,&amp;nbsp;columnIndex]&lt;span style="color: rgb(232, 226, 183);"&gt;.&lt;/span&gt;GetValue&lt;span style="color: rgb(232, 226, 183);"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(103, 140, 177);"&gt;String&lt;/span&gt;&lt;span style="color: rgb(232, 226, 183);"&gt;&amp;gt;&lt;/span&gt;();
 &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}
}&lt;/pre&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div id="_mcePaste" style="left: -10000px; top: 0px; width: 1px; height: 1px; overflow: hidden;"&gt;
﻿&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="31/01/2012 18:59:08">
          <Html>
        
&lt;p&gt;If the name reference an range in a worksheet, you should be able to use a foreach to access the cells.&lt;/p&gt;
&lt;p&gt;If the cell reference a value, formula or external reference this will NOT work. Is that the case here?&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="dstelow" When="03/02/2012 05:43:55">
          <Html>
        
&lt;p&gt;-deleted-&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Displyaing column/row captions in pivit table">
      <Posts>
        <Post From="skeesara" When="02/02/2012 12:35:33">
          <Html>
        
&lt;p&gt;How do we display names column lables&amp;nbsp;or row lables&amp;nbsp;when we have more than one column or row in pivot table.&lt;/p&gt;
&lt;p&gt;I see only the caption property&amp;nbsp;RowHeaderCaption&amp;nbsp;and this will work only we have one row. But what if have multiple rows/columns and we want to display all the headers/labels. This is possible when we create excel pivot tables directly using excel.&lt;/p&gt;
&lt;p&gt;Do we have any option here? Also, There is nothing ColumnHeaderCaption and it always displays "Column Lables".&lt;/p&gt;
&lt;p&gt;Thanking you in anticipation.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to disable the subtotals on pivot table">
      <Posts>
        <Post From="skeesara" When="02/02/2012 11:13:49">
          <Html>
        
&lt;p&gt;By default , the generate pivot table shows sub totals on rows and columns. How do we disable them?&lt;/p&gt;
&lt;p&gt;pivottable class has properties to enable/disable grand totals for rows and columns. I would like to disable the sub totals too.&lt;/p&gt;
&lt;p&gt;(Note : Subtotals are only displayed when when there are two or more columns or rows in pivot table)&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How does one read from a spreadsheet to a Datatable?">
      <Posts>
        <Post From="meccles" When="31/01/2012 20:26:39">
          <Html>
        
&lt;p&gt;I have a scenario where I am exporting information from a datatable to a spreadsheet. Later on, I want to import from the spreadsheet to the datatable, and eventually into a database. I couldn't find any documentation on this. Does EPPlus have an efficient
 way of doing this?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="TiSch" When="31/01/2012 20:55:20">
          <Html>
        
&lt;p&gt;No, there is yet no direct way to get a DataTable from an excel spreadsheet. What datatype you would choose for all that string values or how you would check whether it contains a header-row or not?&lt;/p&gt;
&lt;p&gt;Here is an approach that you can modify or extend for your requirement:&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;div style="color: black; background-color: white;"&gt;&lt;pre&gt;        &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; pck = &lt;span style="color: blue;"&gt;New&lt;/span&gt; OfficeOpenXml.ExcelPackage()
        pck.Load(&lt;span style="color: blue;"&gt;New&lt;/span&gt; IO.FileInfo(path).OpenRead)
        &lt;span style="color: blue;"&gt;If&lt;/span&gt; pck.Workbook.Worksheets.&lt;span style="color: blue;"&gt;Count&lt;/span&gt; &amp;lt;&amp;gt; 0 &lt;span style="color: blue;"&gt;Then&lt;/span&gt;
            &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; ws = pck.Workbook.Worksheets.First
            &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; tbl &lt;span style="color: blue;"&gt;As&lt;/span&gt; &lt;span style="color: blue;"&gt;New&lt;/span&gt; DataTable
            &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; hasHeader = &lt;span style="color: blue;"&gt;False&lt;/span&gt; ' adjust accordingly '
            &lt;span style="color: blue;"&gt;For&lt;/span&gt; &lt;span style="color: blue;"&gt;Each&lt;/span&gt; firstRowCell &lt;span style="color: blue;"&gt;In&lt;/span&gt; ws.Cells(1, 1, 1, ws.Dimension.&lt;span style="color: blue;"&gt;End&lt;/span&gt;.Column)
                tbl.Columns.Add(
                    &lt;span style="color: blue;"&gt;If&lt;/span&gt;(hasHeader,
                       firstRowCell.Text,
                       &lt;span style="color: blue;"&gt;String&lt;/span&gt;.Format(&lt;span style="color: rgb(163, 21, 21);"&gt;"Column {0}"&lt;/span&gt;, firstRowCell.Start.Column)))
            &lt;span style="color: blue;"&gt;Next&lt;/span&gt;
            &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; startRow = &lt;span style="color: blue;"&gt;If&lt;/span&gt;(hasHeader, 2, 1)
            &lt;span style="color: blue;"&gt;For&lt;/span&gt; rowNum = startRow &lt;span style="color: blue;"&gt;To&lt;/span&gt; ws.Dimension.&lt;span style="color: blue;"&gt;End&lt;/span&gt;.Row
                &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; wsRow = ws.Cells(rowNum, 1, rowNum, ws.Dimension.&lt;span style="color: blue;"&gt;End&lt;/span&gt;.Column)
                tbl.Rows.Add(wsRow.Select(Function(cell) cell.Text).ToArray)
            &lt;span style="color: blue;"&gt;Next&lt;/span&gt;&lt;br&gt;        End If &lt;br&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="meccles" When="31/01/2012 21:34:47">
          <Html>
        
&lt;p&gt;Thanks. I will let you know if it works.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Bug with worksheet2.Column(1).Style.Numberformat.Format">
      <Posts>
        <Post From="amircharania" When="12/01/2012 21:19:06">
          <Html>
        
&lt;p&gt;I am loving this library so far, but I think I have encountered a bug. I have a large spreadsheet (3 worksheets; with approx 250 columns in each sheet; 5000 rows per sheet).&lt;/p&gt;
&lt;p&gt;I am using the function&amp;nbsp;worksheet2.Column(currencycolumns[i]).Style.Numberformat.Format = "m/d/yyyy";&lt;/p&gt;
&lt;p&gt;But what I find is that even though I only format certain columns, many other columns get affected. Is this a known issue? Are there any workarounds to this, other than hard-coding the format for every single column?&lt;/p&gt;
&lt;p&gt;Here is the exact code I am using:&lt;/p&gt;
&lt;p&gt;//It's basically looping through a number of columns and setting their format to Date.&lt;/p&gt;
&lt;p&gt;int[] datecolumns = new int[] {17,19,21,23,26,28,30,77,84,93,102,110,139,140,144,185,186,187,188,220,224,226,228 &amp;nbsp;};&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; for (i = 0; i &amp;lt;= datecolumns.Length - 1; i++)&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;
 &amp;nbsp; &amp;nbsp; &amp;nbsp; {&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; worksheet3.Column(datecolumns[i]).Style.Numberformat.Format = "m/d/yyyy";&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks,&lt;/p&gt;
&lt;p&gt;Amir&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="31/01/2012 18:56:09">
          <Html>
        
&lt;p&gt;This should be fixed in version 3.0&lt;/p&gt;
&lt;p&gt;/Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Get Cell Type?">
      <Posts>
        <Post From="gg25" When="23/01/2012 14:15:08">
          <Html>
        
&lt;p&gt;Hi everybody.&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I'm using EPPlus.&lt;/p&gt;
&lt;p&gt;I wonder if there is a way to know the Excel Cell Type (Numeric, Text, DateTime), instead of doing this:&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;if&lt;/span&gt; (cell.Value &lt;span style="color: blue;"&gt;is&lt;/span&gt; Double)
..
.
&lt;span style="color: blue;"&gt;else&lt;/span&gt; &lt;span style="color: blue;"&gt;if&lt;/span&gt; (cell.Value &lt;span style="color: blue;"&gt;is&lt;/span&gt; DateTime)
..
..
&lt;span style="color: blue;"&gt;else&lt;/span&gt; &lt;span style="color: blue;"&gt;if&lt;/span&gt; (Cell.Value &lt;span style="color: blue;"&gt;is&lt;/span&gt; String)
..
.
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;If the cell is a Formula, etc.&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks in advance.&lt;/p&gt;
&lt;p&gt;Gonzalo&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="31/01/2012 18:49:00">
          <Html>
        
&lt;p&gt;No, that's the way to do it.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="sheet chart">
      <Posts>
        <Post From="dhernandez" When="24/01/2012 15:58:51">
          <Html>
        
&lt;p&gt;¿When there will be support for sheet chart?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="31/01/2012 18:46:19">
          <Html>
        
&lt;p&gt;I have not plans for it, so I cant say. But it shoulden't be to hard to implement.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="CheckBox generation">
      <Posts>
        <Post From="maxpavlov" When="26/01/2012 00:55:54">
          <Html>
        
&lt;p&gt;Hello.&lt;/p&gt;
&lt;p&gt;Is there a possibility to add a Forms check box to a generated spreadsheet in EEPlus library?&lt;/p&gt;
&lt;p&gt;Thank you.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="31/01/2012 18:45:10">
          <Html>
        
&lt;p&gt;No not in this release&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Select multiple columns within Linq">
      <Posts>
        <Post From="edomandelli" When="30/01/2012 09:36:20">
          <Html>
        
&lt;p&gt;&lt;/p&gt;
&lt;div id="gt-res-wrap"&gt;
&lt;div id="gt-res-content"&gt;
&lt;div dir="ltr"&gt;&lt;span id="result_box" lang="en"&gt;&lt;span&gt;Is it possible to&lt;/span&gt;&amp;nbsp;&lt;span&gt;extract just&lt;/span&gt;&amp;nbsp;&lt;span&gt;some columns&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&amp;nbsp;&lt;span&gt;but more than one&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&amp;nbsp;&lt;span&gt;with LINQ&lt;/span&gt;&amp;nbsp;&lt;span&gt;and create&lt;/span&gt;&amp;nbsp;&lt;span&gt;a
 custom&lt;/span&gt;&amp;nbsp;&lt;span&gt;collection&lt;/span&gt;&amp;nbsp;&lt;span&gt;class&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;br&gt;
&lt;br&gt;
&lt;span&gt;Something like&lt;/span&gt;&lt;br&gt;
&lt;/span&gt;&lt;/div&gt;
&lt;div dir="ltr"&gt;&lt;span id="result_box" lang="en"&gt;&lt;span&gt;"&lt;/span&gt;&lt;span&gt;Dim&lt;/span&gt;&amp;nbsp;&lt;span&gt;query&lt;/span&gt;&amp;nbsp;&lt;span&gt;= from&lt;/span&gt;&amp;nbsp;&lt;span&gt;cell in &amp;nbsp;myworksheet&amp;nbsp;&lt;/span&gt;&amp;nbsp;&lt;span&gt;select new {&lt;/span&gt;&lt;span&gt;colum1&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&amp;nbsp;&lt;span&gt;colum3&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;column5}&lt;/span&gt;&lt;span&gt;"&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div id="gt-res-tools"&gt;
&lt;div id="gt-res-tools-r"&gt;
&lt;div id="gt-res-rate"&gt;
&lt;div&gt;
&lt;div&gt;
&lt;div&gt;
&lt;div&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
Thanks
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="TiSch" When="30/01/2012 10:52:03">
          <Html>
        
&lt;p&gt;It could be easier(f.e. a &lt;em&gt;Rows/Colums property &lt;/em&gt;in WorkSheet which returns ExcelRanges), but that should work:&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;var&lt;/span&gt; colums = &lt;span style="color: blue;"&gt;new&lt;/span&gt; &lt;span style="color: blue;"&gt;int&lt;/span&gt;[] { 1, 3, 5 };
&lt;span style="color: blue;"&gt;var&lt;/span&gt; query = &lt;span style="color: blue;"&gt;from&lt;/span&gt; cell &lt;span style="color: blue;"&gt;in&lt;/span&gt; &lt;span id="result_box" lang="en"&gt;&lt;span&gt;myworksheet&lt;/span&gt;&lt;/span&gt;.Cells[&lt;span id="result_box" lang="en"&gt;&lt;span&gt;myworksheet&lt;/span&gt;&lt;/span&gt;.Dimension.Address]
            &lt;span style="color: blue;"&gt;join&lt;/span&gt; col  &lt;span style="color: blue;"&gt;in&lt;/span&gt; colums
            &lt;span style="color: blue;"&gt;on&lt;/span&gt; cell.Start.Column &lt;span style="color: blue;"&gt;equals&lt;/span&gt; col
            &lt;span style="color: blue;"&gt;select&lt;/span&gt; cell;
&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="31/01/2012 18:40:42">
          <Html>
        
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;Yes, Rows/Columns properties might be a good idea. &lt;/pre&gt;
&lt;pre&gt;You can do somthing like this as well to pick out the cells of column 1,3 and 4...&lt;/pre&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;var&lt;/span&gt; query = &lt;span style="color: blue;"&gt;from&lt;/span&gt; cell &lt;span style="color: blue;"&gt;in&lt;/span&gt; myworksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A:A,C:D"&lt;/span&gt;]&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to set background color based on template style">
      <Posts>
        <Post From="trhughes" When="31/01/2012 16:06:57">
          <Html>
        
&lt;p&gt;I am trying to set the &lt;strong&gt;Fill &lt;/strong&gt;property of an &lt;strong&gt;ExcelStyle
&lt;/strong&gt;based on another &lt;strong&gt;ExcelStyle &lt;/strong&gt;object I'm using as a template.&amp;nbsp; Assigning the template
&lt;strong&gt;Fill &lt;/strong&gt;property to the new &lt;strong&gt;Fill &lt;/strong&gt;property does not work&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;newStyle.Fill = templateStyle.Fill;
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;So I tried setting the individual properties of &lt;strong&gt;ExcelFill&lt;/strong&gt;, but
&lt;strong&gt;BackgroundColor &lt;/strong&gt;and &lt;strong&gt;PatternColor &lt;/strong&gt;are read-only, and there isn't a public constructor for
&lt;strong&gt;ExcelFill&lt;/strong&gt;.&amp;nbsp; So that leaves me setting the properties on &lt;strong&gt;
ExcelColor&lt;/strong&gt;, but again the properties are read-only and there isn't a public constructor.&amp;nbsp; There is a public method called
&lt;strong&gt;SetColor()&lt;/strong&gt; which takes a &lt;strong&gt;Color &lt;/strong&gt;object that I thought would work, but I am not able to produce a
&lt;strong&gt;Color &lt;/strong&gt;object.&amp;nbsp; I thought I could use the &lt;strong&gt;Color.FromArgb()&lt;/strong&gt; method(s), but I have found instances where the
&lt;strong&gt;templateStyle.Fill.BackgroundColor.Rgb&lt;/strong&gt; property is an empty string.&amp;nbsp; My question is how do I set the
&lt;strong&gt;Fill.BackgroundColor&lt;/strong&gt; property of the new style so that it matches the
&lt;strong&gt;Fill.BackgroundColor&lt;/strong&gt; property of my template style?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="31/01/2012 18:29:18">
          <Html>
        
&lt;p&gt;Set the StyleID from the cells you want to copy from to the cells you want to. This will copy the entire style from the cell, not only the fill.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to iterate all rows and clomuns .. plsss help me this is urgent">
      <Posts>
        <Post From="Plazma" When="28/01/2012 05:24:53">
          <Html>
        
&lt;p&gt;How to iterate all rows and clomuns in an excel sheet using EPPlus&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;sorry i have placed this question in Issuetracker&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Please someone reply me.&lt;/p&gt;
&lt;p&gt;In sample project it is just for specific rows and cols , I want to read all rows and cols data.&lt;/p&gt;
&lt;p&gt;how this can be done plsss reply me ..&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="edomandelli" When="30/01/2012 13:46:01">
          <Html>
        
&lt;p&gt;&lt;span&gt;Try&lt;/span&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;span&gt;to look at the&lt;/span&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;span&gt;code of&lt;/span&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;span&gt;the example of this&lt;/span&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;span&gt;link&lt;/span&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;span&gt;I think is&lt;/span&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;span&gt;what
 you need&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="http://blog.fryhard.com/archive/2010/10/28/reading-xlsx-files-using-c-and-epplus.aspx" rel="nofollow"&gt;http://blog.fryhard.com/archive/2010/10/28/reading-xlsx-files-using-c-and-epplus.aspx&lt;/a&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Plazma" When="31/01/2012 06:00:03">
          <Html>
        
&lt;blockquote style="margin: 0.25em 1em 0px; padding: 0px 0.25em; border: 0.1em solid rgb(204, 204, 204); border-image: none; font-style: italic;"&gt;
&lt;strong&gt;edomandelli wrote:&lt;/strong&gt;&lt;br&gt;
&lt;p&gt;&lt;span&gt;Try&lt;/span&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;span&gt;to look at the&lt;/span&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;span&gt;code of&lt;/span&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;span&gt;the example of this&lt;/span&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;span&gt;link&lt;/span&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;span&gt;I think is&lt;/span&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;span&gt;what
 you need&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="http://blog.fryhard.com/archive/2010/10/28/reading-xlsx-files-using-c-and-epplus.aspx" rel="nofollow"&gt;http://blog.fryhard.com/archive/2010/10/28/reading-xlsx-files-using-c-and-epplus.aspx&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Thx &amp;nbsp;edomandelli .. this will help me a lot .. thx again&lt;span style="white-space: pre;"&gt;
&lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Writing Excel file to output stream">
      <Posts>
        <Post From="ttreat31" When="03/01/2011 18:47:42">
          <Html>
        
&lt;p&gt;I would like to write a workbook as an Excel 2007 file to the HTTP output stream. Here is how I'm currently trying to do it:&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;Response.Clear();
Response.ContentType = &lt;span style="color: rgb(163, 21, 21);"&gt;"application/vnd.ms-excel"&lt;/span&gt;;
Response.AddHeader(&lt;span style="color: rgb(163, 21, 21);"&gt;"Content-Disposition"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"attachment; filename=\"MyFile.xlsx\""&lt;/span&gt;);
Response.BinaryWrite(xlPackage.GetAsByteArray());
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;However, when I try to run this, Excel prompts the following error:&lt;/p&gt;
&lt;p&gt;"Excel found unreadable content in 'MyFile.xlsx'. Do you want to recover the contents of this workbook? If you trust the source of the workbook, click Yes."&lt;/p&gt;
&lt;p&gt;If I bypass this message, the workbook displays properly, but obviously I don't want this error to occur.&lt;/p&gt;
&lt;p&gt;Any ideas?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="04/01/2011 08:45:04">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;try this first...&lt;/p&gt;
&lt;p&gt;&lt;a href="http://epplus.codeplex.com/Thread/View.aspx?ThreadId=223843" rel="nofollow"&gt;http://epplus.codeplex.com/Thread/View.aspx?ThreadId=223843&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;if you still have the same problem, make sure the workbook works if you save it to the harddrive.&lt;/p&gt;
&lt;p&gt;If it doesn't, check the FAQ, problem with numberformats and formulas.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="ttreat31" When="04/01/2011 20:24:23">
          <Html>
        
&lt;p&gt;Thanks, that solved the problem.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="dtsob75" When="02/08/2011 14:23:15">
          <Html>
        
&lt;p&gt;I am having this same problem, but applying the response.clear, did not solve the problem.&amp;nbsp; Any other ideas?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="02/08/2011 14:29:20">
          <Html>
        
&lt;p&gt;Maybe it is another problem, like bad formula format, etc. Open your .xlsx file with notepad, if you didnt see html code from your page, it isnt html trash. So, you need to check other things.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;From FAQ...&amp;nbsp;http://epplus.codeplex.com/wikipage?title=FAQ&amp;amp;referringTitle=Documentation&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;I get an error that Excel has found unreadable content when I open my generated document?&lt;/strong&gt;&lt;br&gt;
Check your Formulas and Numberformats. Formulas and numberformats are not validated by the library so if you enter anything wrong the package will be corrupt. Use the English formula names. Formula parameters are separated by commas (,), string parameters use
 double quotes (").&lt;/p&gt;
&lt;div&gt;
&lt;pre&gt;worksheet.Cells[&lt;span&gt;"A1"&lt;/span&gt;].Formula=&lt;span&gt;"CONCATENATE(\"string1_\",\"test\")"&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Numberformats:&lt;br&gt;
Use culture independent number formats: dot (.) for decimal, comma (thousand).&amp;nbsp;&lt;br&gt;
The easiest way to check a format or a formula is to create an Excel file --&amp;gt; Do the formatting / Add the formulas --&amp;gt; Save it as XLSX ---&amp;gt; Rename the file *.zip. Extract the file and have a look at the number formats in the \xl\styles.xml file and
 formulas in \xl\worksheets\sheet#.xml.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="dtsob75" When="02/08/2011 16:04:50">
          <Html>
        
&lt;p&gt;That helped. THanks so much.&amp;nbsp; I have a database table that I am converting to a spreadsheet and I was doing a db row at a time.&amp;nbsp; I was having to add 1 to the db column number, since there is no column 0 in an xls.&amp;nbsp; I missed one of the formatting
 that I didnt do the +1 to.&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="TiSch" When="02/08/2011 17:15:42">
          <Html>
        
&lt;p&gt;Furthermore the WorkSheet name mustn't exceed &lt;strong&gt;31 characters&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;a title="http://www.excelforum.com/excel-programming/501663-length-of-worksheet-name.html" href="http://www.excelforum.com/excel-programming/501663-length-of-worksheet-name.html" rel="nofollow"&gt;http://www.excelforum.com/excel-programming/501663-length-of-worksheet-name.html&lt;/a&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="popgugu" When="13/10/2011 03:53:42">
          <Html>
        
&lt;p&gt;Call response.clear before send stream back to client.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Response.Clear();&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Response.AddHeader(&lt;span style="color: rgb(163, 21, 21);"&gt;"content-disposition"&lt;/span&gt;,
&lt;span style="color: rgb(163, 21, 21);"&gt;"attachment;&amp;nbsp; filename=file&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;.xlsx"&lt;/span&gt;);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Response.ContentType =
&lt;span style="color: rgb(163, 21, 21);"&gt;"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"&lt;/span&gt;;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Response.BinaryWrite(pck.GetAsByteArray());&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Response.End();&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="razvantim" When="11/11/2011 16:55:58">
          <Html>
        
&lt;p&gt;&amp;nbsp;Response.Clear(); did the trick. Thank you very much.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jon404" When="29/01/2012 21:01:33">
          <Html>
        
&lt;p&gt;I had the same issue but I was missing the line setting the file size in the header, see my code below:&lt;/p&gt;
&lt;p&gt;response.Clear();&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/p&gt;
&lt;p&gt;memoryStream.Seek(0,SeekOrigin.Begin);&lt;br&gt;
response.ContentType = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;br&gt;
response.AddHeader("content-disposition", "attachment; &amp;nbsp;filename=" + fileName);&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;
&lt;br&gt;
response.AddHeader("Content-Length", memoryStream.Length.ToString());&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;
&lt;br&gt;
response.BinaryWrite(memoryStream.GetBuffer());&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;
&lt;br&gt;
response.End();&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="FreezePanes in row and Column">
      <Posts>
        <Post From="stfardoux" When="18/01/2012 18:02:40">
          <Html>
        
&lt;p&gt;Hello,&lt;/p&gt;
&lt;p&gt;I want to used FreezePanes with first row and the first three columns.&lt;/p&gt;
&lt;p&gt;I can Freeze the First Row OR the first three columns but I can't Freeze both.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;ws.View.FreezePanes(nb, 4); //the first three&lt;/p&gt;
&lt;p&gt;ws.View.FreezePanes(2, 1); //the First Row&lt;/p&gt;
&lt;p&gt;&lt;span id="result_box" lang="en"&gt;&lt;span&gt;Does&lt;/span&gt; &lt;span&gt;anyone has&lt;/span&gt; &lt;span&gt;
an idea?&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span lang="en"&gt;&lt;span&gt;thanks in advance&lt;br&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="18/01/2012 20:46:04">
          <Html>
        
&lt;p&gt;Try...&lt;/p&gt;
&lt;p&gt;ws.View.FreezePanes(2, 4); (the cell left and below the freeze)&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="stfardoux" When="19/01/2012 08:17:53">
          <Html>
        
&lt;p&gt;&lt;span id="result_box" lang="en"&gt;&lt;span&gt;It works!&lt;/span&gt;&lt;br&gt;
&lt;br&gt;
&lt;span&gt;Thank you very much Jan&lt;br&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Smoothed line">
      <Posts>
        <Post From="lustuyck" When="21/03/2011 21:43:57">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I'm using a line graph as follows:&lt;/p&gt;
&lt;pre&gt;&lt;span&gt;var&lt;/span&gt;&amp;nbsp;chart&amp;nbsp;=&amp;nbsp;worksheet.Drawings.AddChart(&lt;span&gt;"chart"&lt;/span&gt;,&amp;nbsp;&lt;span&gt;eChartType&lt;/span&gt;.Line)&amp;nbsp;&lt;span&gt;as&lt;/span&gt;&amp;nbsp;&lt;span&gt;ExcelLineChart&lt;/span&gt;;&lt;/pre&gt;
&lt;p&gt;This draws a graph with smooth rounded lines, because in excel the checkbox 'Smoothed line' in 'Line Style' in 'Format Data Series' dialog is checked.&lt;/p&gt;
&lt;p&gt;How can I uncheck this, so that I have straight lines?&lt;/p&gt;
&lt;p&gt;Thx!&lt;/p&gt;
&lt;p&gt;L&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="22/03/2011 16:27:13">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;This is a difference between Excel 2007&amp;nbsp; (not smooth) and Excel 2010 (Smooth). I'll add a fix for it next time&amp;nbsp;I check in.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="lustuyck" When="23/03/2011 08:29:17">
          <Html>
        
&lt;p&gt;That's great, thank you again for the work!&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="cdonges" When="18/01/2012 05:48:03">
          <Html>
        
&lt;p&gt;I am having the same problem. Using the v3 beta I am getting smooth lines. Is it something I am doing wrong?&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;var&lt;/span&gt; chart = (ExcelLineChart)totalSent.Drawings.AddChart(&lt;span style="color: rgb(163, 21, 21);"&gt;"chart1"&lt;/span&gt;, eChartType.Line);
chart.Smooth = &lt;span style="color: blue;"&gt;false&lt;/span&gt;;
chart.SetPosition(0, 630);
chart.SetSize(800, 600);
chart.Title.Text = &lt;span style="color: blue;"&gt;string&lt;/span&gt;.Empty;
&lt;span style="color: blue;"&gt;var&lt;/span&gt; series = chart.Series.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"'"&lt;/span&gt; + partnerCampaginTotals.Name + &lt;span style="color: rgb(163, 21, 21);"&gt;"'!"&lt;/span&gt; + &lt;span style="color: rgb(163, 21, 21);"&gt;"E1:E5"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"'"&lt;/span&gt; + partnerCampaginTotals.Name + &lt;span style="color: rgb(163, 21, 21);"&gt;"'!"&lt;/span&gt; + &lt;span style="color: rgb(163, 21, 21);"&gt;"C1:C5"&lt;/span&gt;);
series.Header = &lt;span style="color: rgb(163, 21, 21);"&gt;"Number of Emails"&lt;/span&gt;;

&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="18/01/2012 20:32:47">
          <Html>
        
&lt;p&gt;Yes, I missed this one. I'll add a fix in the final realease.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Samples - EPPlus.XML">
      <Posts>
        <Post From="xhanness" When="17/01/2012 22:38:31">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;after opening the `samples` project in VS 2008 (the sln was unable to open), I get erros such as
&lt;strong&gt;Could not find an implementation of the query pattern for source type 'OfficeOpenXml.ExcelRange'&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;I have figured out, that it's connected with EPPlus.XML file, where are custom queries. Could you advice me please, how can make the Visual Studio `know`
&lt;strong&gt;about &lt;/strong&gt;the EPPlus.XML??&lt;/p&gt;
&lt;p&gt;Thanks for any hint&lt;/p&gt;
&lt;p&gt;xhanness&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="18/01/2012 20:31:51">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;The sample solution is created in VS2010, so you have to recreate the project in vs2008, I guess.&lt;/p&gt;
&lt;p&gt;The EPPlus.xml is only to get help on the methods and properties in vs.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Object Reference Exception during saving package/ Writing out to a byte array.">
      <Posts>
        <Post From="ArunKumarAllu" When="12/01/2012 13:48:04">
          <Html>
        
&lt;p&gt;Hi All,&lt;/p&gt;
&lt;p&gt;Thanks for the great package developed. I am using this excel package but unfortunately I get Object reference not set to an instance exception during saving the excel package/ Writing out the package to a byte array(I tried both).&lt;/p&gt;
&lt;p&gt;My Code&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; using (ExcelPackage epkg = new ExcelPackage(new FileInfo(rptTemplateName), true))&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ExcelWorkbook wbReport = epkg.Workbook;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; this.FillReportSheetPCR(wbReport);&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; // Added Code as this is a fix for ExcelPackage module. Didn't Ckeck with EPPlus package though.&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; foreach (ExcelWorksheet aworksheet in epkg.Workbook.Worksheets)&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; aworksheet.Cells[1, 1].Value = aworksheet.Cells[1, 1].Value;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
&lt;strong&gt;&lt;span style="color: rgb(255, 0, 0);"&gt;this.SendFileToClient("My Chart.xlsx", epkg.GetAsByteArray());&lt;/span&gt;&lt;/strong&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;My Stack Trace&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp; at OfficeOpenXml.Table.PivotTable.ExcelPivotCacheDefinition..ctor(XmlNamespaceManager ns, ExcelPivotTable pivotTable)&lt;br&gt;
&amp;nbsp;&amp;nbsp; at OfficeOpenXml.Table.PivotTable.ExcelPivotTable..ctor(PackageRelationship rel, ExcelWorksheet sheet)&lt;br&gt;
&amp;nbsp;&amp;nbsp; at OfficeOpenXml.Table.PivotTable.ExcelPivotTableCollection..ctor(ExcelWorksheet ws)&lt;br&gt;
&amp;nbsp;&amp;nbsp; at OfficeOpenXml.ExcelWorksheet.get_PivotTables()&lt;br&gt;
&amp;nbsp;&amp;nbsp; at OfficeOpenXml.ExcelWorksheet.SavePivotTables()&lt;br&gt;
&amp;nbsp;&amp;nbsp; at OfficeOpenXml.ExcelWorksheet.Save()&lt;br&gt;
&amp;nbsp;&amp;nbsp; at OfficeOpenXml.ExcelWorkbook.Save()&lt;br&gt;
&amp;nbsp;&amp;nbsp; at OfficeOpenXml.ExcelPackage.GetAsByteArray(Boolean save)&lt;br&gt;
&amp;nbsp;&amp;nbsp; at OfficeOpenXml.ExcelPackage.GetAsByteArray()&lt;br&gt;
&amp;nbsp;&amp;nbsp; at MyCode.FillReport(String rptCode) in d:\Dashboard.aspx.cs:line 739&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks &amp;amp; Regards&lt;/p&gt;
&lt;p&gt;Arun Kumar Allu&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="ArunKumarAllu" When="16/01/2012 10:59:15">
          <Html>
        
&lt;p&gt;Any Ideas??&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="ArunKumarAllu" When="16/01/2012 11:28:30">
          <Html>
        
&lt;p&gt;After a lot of brainstorming and experimenting, I finally downloaded the source code, Rebuilt the solution and used the generated dll's in my project. Now the code is working.&lt;/p&gt;
&lt;p&gt;It seems there is some issues with the binaries posted for download. Plz Check and do the needful.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks &amp;amp; Regards&lt;/p&gt;
&lt;p&gt;Arun Kumar Allu&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="EPPLUS Support for VBA Macros">
      <Posts>
        <Post From="kkennedy_uk" When="26/11/2010 14:01:32">
          <Html>
        
&lt;p&gt;Hi Everybody,&lt;/p&gt;
&lt;p&gt;I am currently just started to research Excel wrapper classes and I would like to know whether EPPLUS supports macro enabled Excel files?&lt;/p&gt;
&lt;p&gt;Thanks!&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="28/11/2010 19:09:58">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;There is no support to manipulate the VBA code, but I guess you can use a .xlsm file as a template if you want to.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="kkennedy_uk" When="29/11/2010 08:06:34">
          <Html>
        
&lt;p&gt;Thanks Jan, so if I understand you correctly I can&amp;nbsp;set up a template with the macros I want to use in it and then I can use the Excel wrapper classes to then create the Excel spreadsheet around the macros that are required to execute&amp;nbsp;for this spreadsheet?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="29/11/2010 20:22:38">
          <Html>
        
&lt;p&gt;I think that should work, but I have never tried it.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="sr_codeplex" When="14/01/2012 15:53:28">
          <Html>
        
&lt;blockquote style="margin: 0.25em 1em 0px; padding: 0px 0.25em; border: 0.1em solid rgb(204, 204, 204); border-image: none; font-style: italic;"&gt;
&lt;strong&gt;kkennedy_uk wrote:&lt;/strong&gt;&lt;br&gt;
&lt;p&gt;Thanks Jan, so if I understand you correctly I can&amp;nbsp;set up a template with the macros I want to use in it and then I can use the Excel wrapper classes to then create the Excel spreadsheet around the macros that are required to execute&amp;nbsp;for this spreadsheet?&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Is it work? Have you tried it?&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Newline character returning as _x00D_ when written to Response">
      <Posts>
        <Post From="ankurkh1" When="02/06/2011 01:12:12">
          <Html>
        
&lt;div&gt;Hi All,&lt;/div&gt;
&lt;div&gt;
&lt;div id="DescriptionPanel"&gt;&lt;br&gt;
I am facing a problem with the latest version.&lt;br&gt;
I am using a template file approach, changing a few values and Writing the bytes to Response stream.&lt;br&gt;
&lt;br&gt;
The problem is if my sheet has some cells containing Newline characters (ALT + Enter) at the receiving side of the response the file contains some wierd strings as _X00D_.&lt;br&gt;
&lt;br&gt;
Please help me here.&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;Regards,&lt;/p&gt;
&lt;p&gt;Ankur&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="karlisf" When="22/06/2011 14:36:37">
          <Html>
        
&lt;p&gt;I have the same problem. When cell value contains new line characters Excel displays substitution _x00D_. By the way substitution is the same for \r and \n.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="22/06/2011 14:38:19">
          <Html>
        
&lt;p&gt;Get the lastest version from trunk.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="22/06/2011 19:46:36">
          <Html>
        
&lt;p&gt;Yes, I'll try to fix a new version next week&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JustinStolle" When="18/07/2011 21:05:01">
          <Html>
        
&lt;p&gt;Is there a workaround for this issue or when do you think it might be fixed?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="belikemike121" When="18/08/2011 19:20:30">
          <Html>
        
&lt;p&gt;I've downloaded the latest (&lt;a title="Recommended Release: EPPlus 2.9.0.1" id="ReleaseLinkStable0"&gt;EPPlus 2.9.0.1) binary from the download section and this does not appear to be fixed.&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Anyone come up with a work-around or know when this issue will be resolved?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="18/08/2011 19:50:29">
          <Html>
        
&lt;p&gt;You need to build your own dll, because Jan didnt release a new version this time, get the lastest version from trunk and open with visual studio.&lt;/p&gt;
&lt;p&gt;Today, this is the lastest changeset &amp;gt;&amp;gt;&amp;nbsp;&lt;a href="http://epplus.codeplex.com/SourceControl/changeset/changes/82093" rel="nofollow"&gt;http://epplus.codeplex.com/SourceControl/changeset/changes/82093&lt;/a&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="bassvix" When="11/01/2012 04:45:29">
          <Html>
        
&lt;p&gt;Same problem for me.&lt;/p&gt;
&lt;p&gt;More recent version (2.9.0.1).&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="bassvix" When="11/01/2012 05:21:43">
          <Html>
        
&lt;blockquote style="margin: 0.25em 1em 0px; padding: 0px 0.25em; border: 0.1em solid rgb(204, 204, 204); border-image: none; font-style: italic;"&gt;
&lt;strong&gt;mrxrsd wrote:&lt;/strong&gt;&lt;br&gt;
&lt;/blockquote&gt;
&lt;blockquote style="margin: 0.25em 1em 0px; padding: 0px 0.25em; border: 0.1em solid rgb(204, 204, 204); border-image: none; font-style: italic;"&gt;
&lt;p&gt;You need to build your own dll, because Jan didnt release a new version this time, get the lastest version from trunk and open with visual studio.&lt;/p&gt;
&lt;p&gt;Today, this is the lastest changeset &amp;gt;&amp;gt;&amp;nbsp;&lt;a href="http://epplus.codeplex.com/SourceControl/changeset/changes/82093" rel="nofollow"&gt;http://epplus.codeplex.com/SourceControl/changeset/changes/82093&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;After download and integrate in my project this error occurs:&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;h2&gt;&lt;em&gt;The 'worksheet' start tag on line 2 position 2 does not match the end tag of 'xdr:colOff'. Line 2, position 1415.&lt;/em&gt;&lt;/h2&gt;
&lt;span style="font-family: Arial,Helvetica,Geneva,SunSans-Regular,sans-serif;"&gt;&lt;strong&gt;Description:
&lt;/strong&gt;An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code.
&lt;br&gt;
&lt;br&gt;
&lt;strong&gt;Exception Details: &lt;/strong&gt;System.Xml.XmlException: The 'worksheet' start tag on line 2 position 2 does not match the end tag of 'xdr:colOff'. Line 2, position 1415.&lt;br&gt;
&lt;br&gt;
&lt;strong&gt;Source Error:&lt;/strong&gt; &lt;br&gt;
&lt;br&gt;
&lt;/span&gt;
&lt;p&gt;&lt;/p&gt;
&lt;table width="100%" bgcolor="#ffffcc"&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;
&lt;pre&gt;Line 588:                _worksheetXml.LoadXml(xml.Substring(1,xml.Length-1));
Line 589:            else
&lt;span style="color: red;"&gt;Line 590:                _worksheetXml.LoadXml(xml);
&lt;/span&gt;Line 591:
Line 592:            ClearNodes();&lt;/pre&gt;
&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;span style="font-family: Arial,Helvetica,Geneva,SunSans-Regular,sans-serif;"&gt;&lt;br&gt;
&lt;strong&gt;Source File: &lt;/strong&gt;C:\Users\Richardson\Documents\Arquivos\Projetos\Excel\epplus-82093\trunk\ExcelPackage\ExcelWorksheet.cs&lt;strong&gt; &amp;nbsp;&amp;nbsp; Line:
&lt;/strong&gt;590 &lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="11/01/2012 11:09:41">
          <Html>
        
&lt;p&gt;bassvix,&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Hi, today 86957 is the lastest changeset. Try this version.&lt;/p&gt;
&lt;p&gt;&lt;a href="http://epplus.codeplex.com/SourceControl/changeset/view/86957" rel="nofollow"&gt;http://epplus.codeplex.com/SourceControl/changeset/view/86957&lt;/a&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="bassvix" When="11/01/2012 17:41:45">
          <Html>
        
&lt;p&gt;Yeap, works fine now.&lt;/p&gt;
&lt;p&gt;Thanks.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="amircharania" When="12/01/2012 21:23:08">
          <Html>
        
&lt;p&gt;Here is my workaround for it:&lt;/p&gt;
&lt;p&gt;&amp;nbsp;if (row[j].ToString().Contains("\r\n"))&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; {&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;
 &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; worksheet2.Cells[i + 1, j + 1].Value = row[j].ToString().Replace("\r\n", String.Empty);&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;
 &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; else&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; {&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;
 &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; worksheet2.Cells[i + 1, j + 1].Value = row[j];&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;
 &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Hope it helps.&lt;/p&gt;
&lt;p&gt;Amir&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="bassvix" When="13/01/2012 02:09:12">
          <Html>
        
&lt;p&gt;&lt;a href="http://www.codeplex.com/site/users/view/amircharania" rel="nofollow"&gt;amircharania&lt;/a&gt;, after the lastest changeset (86957) all works fine, but we need download and compile, its not the oficial release (by Download in homepage).&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Auto Fit Columns">
      <Posts>
        <Post From="jsimunac" When="01/02/2010 19:45:01">
          <Html>
        
&lt;p&gt;Very impressive work.&amp;nbsp; I tried the original ExcelPackage and it was far too slow.&amp;nbsp; You have certainly improved the speed a lot.&amp;nbsp; And I like all the styles.&lt;/p&gt;
&lt;p&gt;Now for my question - is there any way to auto fit columns?&amp;nbsp; This is very important to me.&amp;nbsp; Also, is it possible to freeze the top line (for keeping headers on the page)?&lt;/p&gt;
&lt;p&gt;Thanks for your answers in advance.&amp;nbsp; And thanks for taking the time to create such a useful tool.&lt;/p&gt;
&lt;p&gt;-Joe&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="02/02/2010 08:10:14">
          <Html>
        
&lt;p&gt;Thanks,&lt;/p&gt;
&lt;p&gt;I have not implemented an Autofit method, because it would be very hard to get it to work as expected.&lt;/p&gt;
&lt;p&gt;Since you need to measure the formated text that means you have to implement ExcelNumber-formats and calculate output from formulas, and thats just to much work to do.&lt;/p&gt;
&lt;p&gt;I plan to implement panes in a future version,but for now you can use a template file where you "freezed" the top line.&lt;/p&gt;
&lt;p&gt;Hope this helps&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jsimunac" When="02/02/2010 14:35:43">
          <Html>
        
&lt;p&gt;Thanks for your reply.&amp;nbsp; I didn't realize it was so complicated - I thought it might be one of the Excel styles, since that's where it is in the Excel menus.&amp;nbsp; At least I was hoping.&amp;nbsp; I guess I can always set up a template with a macro to autofit
 columns - and with the top line frozen.&amp;nbsp; Thanks again!&lt;/p&gt;
&lt;p&gt;-Joe&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Ckiszka" When="12/01/2012 15:00:21">
          <Html>
        
&lt;p&gt;Jankallman,&lt;/p&gt;
&lt;p&gt;Do you still plan to implement&amp;nbsp;this feature in the future? I am eagar :)&lt;/p&gt;
&lt;p&gt;- Chris&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Bug? Strange character after line break for merged cells content">
      <Posts>
        <Post From="bassvix" When="11/01/2012 04:40:37">
          <Html>
        
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Two cases:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;If I read a XLSX file with merged cells and content has line break text, when I save a new XLSX a strange character is showed together (_x00D_).
&lt;/li&gt;&lt;li&gt;For new XLSX file, same case, merged cells and content has line break, using \r\n ou Environment.Newline, the same _x00D_ is showed.
&lt;/li&gt;&lt;/ol&gt;
&lt;p&gt;Ps: &amp;lt;br&amp;gt; not work for line break.&lt;/p&gt;
&lt;p&gt;Sample code: string.Format("{1}{0}{2}{0}{3}{0}{4}{0}{5}", "\r\n", "LINHA 1", "LINHA 2", "LINHA 3", "LINHA 4", "LINHA 5");&lt;/p&gt;
&lt;p&gt;Result:&lt;/p&gt;
&lt;p&gt;XXX_x00D_&lt;br&gt;
XXX_x00D_&lt;br&gt;
XXX_x00D_&lt;br&gt;
XXX_x00D_&lt;br&gt;
XXX&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="IsolatedStorage problem">
      <Posts>
        <Post From="sustem" When="08/01/2012 19:48:41">
          <Html>
        
&lt;p&gt;Hi and thank you for an excellent product!&lt;/p&gt;
&lt;p&gt;I've made a tool that is running under SqlAgent to generate excel docs. It works fine as long as the file is not to large. It also works fine it it's not started from the SqlAgent account. When the file grows larger I get the IsolatedStorage problem mentioned
 in the two links below.&lt;/p&gt;
&lt;p&gt;I've found these great articles but none of them solves my problem:&lt;/p&gt;
&lt;p&gt;&lt;a href="http://stackoverflow.com/questions/7488442/epplus-2-9-0-1-throws-system-io-isolatedstorage-isolatedstorageexception-when-tr" rel="nofollow"&gt;http://stackoverflow.com/questions/7488442/epplus-2-9-0-1-throws-system-io-isolatedstorage-isolatedstorageexception-when-tr&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="http://labs.episerver.com/en/Blogs/Svante-Seleborg/Dates/2008/10/IsolatedStorage-Access-Denied/" rel="nofollow"&gt;http://labs.episerver.com/en/Blogs/Svante-Seleborg/Dates/2008/10/IsolatedStorage-Access-Denied/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;I've found three different ways of working around my problem.&lt;/p&gt;
&lt;p&gt;1. Create the appropriate directories with appropiate permissions. I'm running Sql Server 2008 R2 and no matter where and how I&amp;nbsp;precreate the IsolatedStorage directory it does not work. I've tried in both the public profile and in the profile that SqlAgent
 is using.&lt;/p&gt;
&lt;p&gt;2. Delete the profile which SqlAgent is running under (this is not an option for me).&lt;/p&gt;
&lt;p&gt;2. Create a new app domain&lt;/p&gt;
&lt;p&gt;I've tried this option and it might still be an option but i got into problemes with the [serializable] attribute that I had to add to the classes...&lt;/p&gt;
&lt;p&gt;-&lt;/p&gt;
&lt;p&gt;My next option is to actually go through and modify the epplus source. I would really like to avoid that. Therefore I'm kindly asking this forum for help.&lt;br&gt;
I'm quite certain that the problem has to do with the permission problem that is mentioned by Svante in the link above.&lt;/p&gt;
&lt;p&gt;Does anyone have a solution&amp;nbsp;for my problem?&lt;/p&gt;
&lt;p&gt;Regards, &lt;br&gt;
Stefan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Specified part does not exist in the project">
      <Posts>
        <Post From="dcooper" When="21/12/2011 22:09:04">
          <Html>
        
&lt;p&gt;When I try to run this simple program.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;using&lt;/span&gt; (ExcelPackage package = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(existingFile))
        {
            ExcelWorksheet worksheet = package.Workbook.Worksheets[&lt;span style="color: rgb(163, 21, 21);"&gt;"Sheet1"&lt;/span&gt;];
            worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"TEST"&lt;/span&gt;;
            package.Save();
        }
&lt;/pre&gt;
&lt;pre&gt;I get the following error when the save command is called.&lt;/pre&gt;
&lt;pre&gt;&lt;pre&gt;[InvalidOperationException: Specified part does not exist in the package.]
   System.IO.Packaging.Package.GetPart(Uri partUri) +3204174
   OfficeOpenXml.Drawing.ExcelPicture..ctor(ExcelDrawings drawings, XmlNode node) +224
   OfficeOpenXml.Drawing.ExcelDrawing.GetDrawing(ExcelDrawings drawings, XmlNode node) +158
   OfficeOpenXml.Drawing.ExcelDrawings.AddDrawings() +144
   OfficeOpenXml.ExcelWorksheet.get_Drawings() +63
   OfficeOpenXml.ExcelWorksheet.Save() +209
   OfficeOpenXml.ExcelWorkbook.Save() +443
   OfficeOpenXml.ExcelPackage.Save() +139

[InvalidOperationException: Error saving file C:\inetpub\Project\output.xlsx]
   OfficeOpenXml.ExcelPackage.Save() +1090
   System.Web.UI.WebControls.Button.OnClick(EventArgs e) +115
   System.Web.UI.WebControls.Button.RaisePostBackEvent(String eventArgument) +140
   System.Web.UI.Page.RaisePostBackEvent(IPostBackEventHandler sourceControl, String&lt;/pre&gt;
&lt;pre&gt;&lt;span style="white-space: pre;"&gt;	&lt;/span&gt; eventArgument) +29
   System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint,&amp;nbsp;&lt;/pre&gt;
&lt;pre&gt;&lt;span style="white-space: pre;"&gt;	&lt;/span&gt;Boolean includeStagesAfterAsyncPoint) +2981&lt;/pre&gt;
The same error occurs when I try to use SaveAs.  I am using version 2.9.0.1 and the&amp;nbsp;&lt;/pre&gt;
&lt;pre&gt;same error also occurs using version 2.8.0.2.  Any ideas on what might be causing this problem?&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="dcooper" When="04/01/2012 16:29:28">
          <Html>
        
&lt;p&gt;I have figured out that the problem had to do with the excel file I was working with. &amp;nbsp;It contained lots of complex formulas and formatting which I believe were causing problems. &amp;nbsp;When I tried working with a simplified version of the file it worked
 as expected.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Grouping">
      <Posts>
        <Post From="amarprabhu" When="29/06/2011 08:26:51">
          <Html>
        
&lt;p&gt;Can anyone guide me on how to use grouping/ungrouping feature..?? A code snippet would be helpful....&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="30/06/2011 19:55:23">
          <Html>
        
&lt;p&gt;Have a look at sample 6&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="amarprabhu" When="05/07/2011 15:16:02">
          <Html>
        
&lt;p&gt;Thanks for the reply. But I am unable to use the code from sample6(i was not able to find any grouping functions). I just need to group a few rows together before saving the worksheet.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="rama_jolla" When="04/01/2012 15:22:23">
          <Html>
        
&lt;p&gt;Is there a solution for the above question. I want to use the subtotal function in Excel to display a group of values.&lt;/p&gt;
&lt;p&gt;Sample Scenario:&lt;/p&gt;
&lt;p&gt;State cities Counties Hospitals Gas Stations&lt;/p&gt;
&lt;p&gt;I want to group by State and City to get the Hospitals and Gas stations. Counts should be displayed at the each subsection.&lt;/p&gt;
&lt;p&gt;Many thanks.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="04/01/2012 15:47:44">
          <Html>
        
&lt;p&gt;Take a look at this thread, maybe can help you.&lt;/p&gt;
&lt;p&gt;&lt;a href="http://epplus.codeplex.com/discussions/261320" rel="nofollow"&gt;http://epplus.codeplex.com/discussions/261320&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="GetValue Returns XML">
      <Posts>
        <Post From="l33tas" When="23/12/2011 15:20:40">
          <Html>
        
&lt;p&gt;Hello,&lt;/p&gt;
&lt;p&gt;I'm having a problem using this library. Sometimes GetValue method returns XML instead of the actual value. Any ideas how to get the value without creating an xml document and parsing tags by myself?&lt;/p&gt;
&lt;p&gt;Here's what I get:&lt;/p&gt;
&lt;p&gt;&amp;lt;r xmlns="&lt;a href="http://schemas.openxmlformats.org/spreadsheetml/2006/main" rel="nofollow"&gt;http://schemas.openxmlformats.org/spreadsheetml/2006/main"&amp;gt;&amp;lt;t&lt;/a&gt; xml:space="preserve"&amp;gt;Shaker Arms &amp;lt;/t&amp;gt;&amp;lt;/r&amp;gt;&amp;lt;r xmlns="&lt;a href="http://schemas.openxmlformats.org/spreadsheetml/2006/main" rel="nofollow"&gt;http://schemas.openxmlformats.org/spreadsheetml/2006/main"&amp;gt;&amp;lt;rPr&amp;gt;&amp;lt;sz&lt;/a&gt;
 val="11" /&amp;gt;&amp;lt;color theme="1" /&amp;gt;&amp;lt;rFont val="Calibri" /&amp;gt;&amp;lt;family val="2" /&amp;gt;&amp;lt;scheme val="minor" /&amp;gt;&amp;lt;/rPr&amp;gt;&amp;lt;t&amp;gt;(6)&amp;lt;/t&amp;gt;&amp;lt;/r&amp;gt;&lt;/p&gt;
&lt;p&gt;Thanks in advance,&lt;/p&gt;
&lt;p&gt;Martynas&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Issue with sheet.GetValue(row, col)">
      <Posts>
        <Post From="htbrady" When="22/12/2011 20:27:37">
          <Html>
        
&lt;pre&gt;I am able to open a spreadsheet (which contains several other worksheets) and&amp;nbsp;reference&amp;nbsp;&lt;br&gt;most cell values.&lt;/pre&gt;
&lt;pre&gt;&lt;br&gt;However, when I access a cell that is pulling a value from another worksheet&amp;nbsp;I am having&amp;nbsp;&lt;br&gt;an issue.&lt;/pre&gt;
&lt;pre&gt;For example...I have a cell in column 3 and row 17. &amp;nbsp;If I look at the cell&amp;nbsp;when opened in &lt;br&gt;Excel, it has a value of "USD" in it. &amp;nbsp;If I click on the cell&amp;nbsp;directly I see that it is &lt;br&gt;actually being pulled from another&amp;nbsp;worksheet (=WORKSHEETxx!$G$7). &amp;nbsp;When I use the code &lt;br&gt;below to get this&amp;nbsp;cell's value, I get the following error:&amp;nbsp;&lt;br&gt;"Object reference not set to an instance of an object."&lt;/pre&gt;
&lt;pre&gt;&lt;br&gt;My question is...how do I actually get the value "USD" from the cell?&lt;/pre&gt;
&lt;pre&gt;&lt;br&gt;string cellContents = sheet.GetValue(17, 3).ToString().Trim();&lt;br&gt;&lt;/pre&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="eDateGroupBy.Days order problem">
      <Posts>
        <Post From="thangtx" When="21/12/2011 01:19:51">
          <Html>
        
&lt;p&gt;Hi all&lt;/p&gt;
&lt;p&gt;I use&amp;nbsp;eDateGroupBy.Days to group data by date but out put not in correct order. Here is out put:&lt;/p&gt;
&lt;table width="1856" border="0" cellspacing="0" cellpadding="0"&gt;
&lt;tbody&gt;
&lt;tr height="20"&gt;
&lt;td width="64" height="20"&gt;Row Labels&lt;/td&gt;
&lt;td width="64"&gt;10-Oct&lt;/td&gt;
&lt;td width="64"&gt;11-Oct&lt;/td&gt;
&lt;td width="64"&gt;12-Oct&lt;/td&gt;
&lt;td width="64"&gt;13-Oct&lt;/td&gt;
&lt;td width="64"&gt;14-Oct&lt;/td&gt;
&lt;td width="64"&gt;15-Oct&lt;/td&gt;
&lt;td width="64"&gt;17-Oct&lt;/td&gt;
&lt;td width="64"&gt;18-Oct&lt;/td&gt;
&lt;td width="64"&gt;19-Oct&lt;/td&gt;
&lt;td width="64"&gt;20-Oct&lt;/td&gt;
&lt;td width="64"&gt;21-Oct&lt;/td&gt;
&lt;td width="64"&gt;22-Oct&lt;/td&gt;
&lt;td width="64"&gt;24-Oct&lt;/td&gt;
&lt;td width="64"&gt;25-Oct&lt;/td&gt;
&lt;td width="64"&gt;26-Oct&lt;/td&gt;
&lt;td width="64"&gt;27-Oct&lt;/td&gt;
&lt;td width="64"&gt;28-Oct&lt;/td&gt;
&lt;td width="64"&gt;29-Oct&lt;/td&gt;
&lt;td width="64"&gt;31-Oct&lt;/td&gt;
&lt;td width="64"&gt;1-Oct&lt;/td&gt;
&lt;td width="64"&gt;2-Oct&lt;/td&gt;
&lt;td width="64"&gt;3-Oct&lt;/td&gt;
&lt;td width="64"&gt;4-Oct&lt;/td&gt;
&lt;td width="64"&gt;5-Oct&lt;/td&gt;
&lt;td width="64"&gt;6-Oct&lt;/td&gt;
&lt;td width="64"&gt;7-Oct&lt;/td&gt;
&lt;td width="64"&gt;8-Oct&lt;/td&gt;
&lt;td width="64"&gt;1-Nov&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Please tell me how to fix this problem.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks and regards&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Build Chart from DataTable">
      <Posts>
        <Post From="mrpkarthik" When="20/12/2011 04:34:27">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;In my project i have a DataTable , and i need to show the data in the Chart .&lt;/p&gt;
&lt;p&gt;Is it possible to build chart from Datatable instead of giving Address or Range?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks,&lt;/p&gt;
&lt;p&gt;Karthik&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Worksheet.ColumnCount">
      <Posts>
        <Post From="ddelella" When="19/12/2011 20:01:01">
          <Html>
        
&lt;p&gt;For those dealing with loading data from a worksheet that just want to quickly see how many columns are on a particular sheet you can add the following code to the ExcelWorksheet.cs file in the Public Properties region:&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;int&lt;/span&gt; ColumnCount
{
     &lt;span style="color: blue;"&gt;get&lt;/span&gt;
     {
          &lt;span style="color: blue;"&gt;return&lt;/span&gt; _columns.Count;
     }
}
&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Worksheet.RowCount">
      <Posts>
        <Post From="ddelella" When="19/12/2011 19:22:14">
          <Html>
        
&lt;p&gt;For those dealing with loading data from a worksheet that just want to quickly see how many rows are on a particular sheet you can add the following code to the ExcelWorksheet.cs file in the Public Properties region:&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;int&lt;/span&gt; RowCount
{
     &lt;span style="color: blue;"&gt;get&lt;/span&gt;
     {
          &lt;span style="color: blue;"&gt;return&lt;/span&gt; _rows.Count;
     }
}
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div id="_mcePaste" style="left: -10000px; top: 0px; width: 1px; height: 1px; overflow: hidden;"&gt;
﻿&lt;/div&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Can't open xlsx file">
      <Posts>
        <Post From="djarvis8" When="15/12/2011 21:02:45">
          <Html>
        
&lt;p&gt;I am trying to do the most simplest thing- open an existing test.xlsx file but always fail on accessing package.Workbook.&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;pre&gt;FileInfo existingFile = new FileInfo("TestSpreadsheets\\test1.xlsx");
using (ExcelPackage package = new ExcelPackage(existingFile))
{
  ExcelWorkbook workbook = package.Workbook; // throws exception
}&lt;/pre&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;"Index was out of range. Must be non-negative and less than the size of the collection.". &amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;The file does exist, I can see that under the package info, along with the size and various other things.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="ddelella" When="19/12/2011 19:10:22">
          <Html>
        
&lt;p&gt;You use the FileInfo object to check if the path is valid before attempting to load the ExcelPackage.&amp;nbsp; In my code I do not use the \\ escape character in my paths and it works just fine.&amp;nbsp; The only strange thing to keep in mind is that when referencing
 Worksheets(x) the index is not 0 based, it begins at 1.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Pivot Table basic problem">
      <Posts>
        <Post From="anou" When="19/12/2011 15:13:21">
          <Html>
        
&lt;p&gt;Hi, thanx for the nice project!&lt;/p&gt;
&lt;p&gt;I am faced with the following problem and I can't figure out why....&lt;/p&gt;
&lt;p&gt;I have a simple xlsx template file with a worksheet containing tabular data and a named range assigned to that table area. Using the library it all works fine, I can Load the file, Load the data and save it. I then open the file and its all there... nice
 and easy...&amp;nbsp;&lt;/p&gt;
&lt;p&gt;However, the problem is that when i add a PivotTable on a new sheet and define its datasource by specifying that named range the file creation fails... I get a Null Reference Exception when i do pck.GetAsByteArray();&lt;/p&gt;
&lt;p&gt;Stack Trace:&amp;nbsp;at OfficeOpenXml.Table.PivotTable.ExcelPivotCacheDefinition..ctor(XmlNamespaceManager ns, ExcelPivotTable pivotTable)&amp;nbsp; &amp;nbsp;at OfficeOpenXml.Table.PivotTable.ExcelPivotTable..ctor(PackageRelationship rel, ExcelWorksheet sheet)&amp;nbsp;
 &amp;nbsp;at OfficeOpenXml.Table.PivotTable.ExcelPivotTableCollection..ctor(ExcelWorksheet ws)&amp;nbsp; &amp;nbsp;at OfficeOpenXml.ExcelWorksheet.get_PivotTables()&amp;nbsp; &amp;nbsp;at OfficeOpenXml.ExcelWorksheet.SavePivotTables()&amp;nbsp; &amp;nbsp;at OfficeOpenXml.ExcelWorksheet.Save()&amp;nbsp;
 &amp;nbsp;at OfficeOpenXml.ExcelWorkbook.Save()&amp;nbsp; &amp;nbsp;at OfficeOpenXml.ExcelPackage.GetAsByteArray(Boolean save)&amp;nbsp; &amp;nbsp;at OfficeOpenXml.ExcelPackage.GetAsByteArray()&amp;nbsp; &amp;nbsp;at MyProject.Excel.EPPlusExcelExport.Export(ReportDefinition pReportDefintion,
 DataTable pSchemaTable, DataTable pData, String pTemplateName, String pExportFilePath, String pReportCustomizationPath,) in C:\xxx\xxx\xxx\xxx\EPPlusExcelExport.cs:line 195&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I add the pivot table to the excel template using Excel 2010 itself, I don't add it programmatically. I do nothing to the Pivot Table in the code as I expect excel to do the rest when the file opens...&lt;/p&gt;
&lt;p&gt;The other thing to mention is that if I remove the Pivot Table from the xlsx template and then use the library to create the document and then after the document opens up I add the pivot table setting its datasource to be that named range it all works fine...&lt;/p&gt;
&lt;p&gt;So what's going on? Any ideas?&lt;/p&gt;
&lt;p&gt;Thank you for any help, much appreciated!&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="anou" When="19/12/2011 15:56:35">
          <Html>
        
&lt;p&gt;Hi, you can consider this issue as solved! The whole thing worked as soon as I used the source code in my project instead of the dll! The dll I was using was version 2.9.0.1 while the source code is version the 85963 changeset.&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanx!&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Pivot table, how to draw top n chart">
      <Posts>
        <Post From="thangtx" When="19/12/2011 07:24:10">
          <Html>
        
&lt;p&gt;Hi all,&lt;/p&gt;
&lt;p&gt;Thanks for greate project.&lt;/p&gt;
&lt;p&gt;Coud you show me how to draw only top N in pivot table chart.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks and regards,&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Weird time data addition">
      <Posts>
        <Post From="AbhijitBhinge" When="19/12/2011 02:33:32">
          <Html>
        
&lt;p&gt;The data is provided as a string. The format of the incoming data is 8:30:45 which has to be interpreted as hrs:min:ss. There are 1000s of these string values. Forex:&lt;/p&gt;
&lt;table width="267" border="0" cellspacing="0" cellpadding="0"&gt;
&lt;colgroup&gt;&lt;col width="267"&gt;&lt;/colgroup&gt;
&lt;tbody&gt;
&lt;tr height="20"&gt;
&lt;td width="267" height="20"&gt;08:00:14&lt;/td&gt;
&lt;/tr&gt;
&lt;tr height="20"&gt;
&lt;td height="20"&gt;08:32:49&lt;/td&gt;
&lt;/tr&gt;
&lt;tr height="20"&gt;
&lt;td height="20"&gt;08:40:04&lt;/td&gt;
&lt;/tr&gt;
&lt;tr height="20"&gt;
&lt;td height="20"&gt;08:30:01&lt;/td&gt;
&lt;/tr&gt;
&lt;tr height="20"&gt;
&lt;td height="20"&gt;08:34:50&lt;/td&gt;
&lt;/tr&gt;
&lt;tr height="20"&gt;
&lt;td height="20"&gt;07:19:51&lt;/td&gt;
&lt;/tr&gt;
&lt;tr height="20"&gt;
&lt;td height="20"&gt;08:05:03&lt;/td&gt;
&lt;/tr&gt;
&lt;tr height="20"&gt;
&lt;td height="20"&gt;0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr height="20"&gt;
&lt;td height="20"&gt;07:32:48&lt;/td&gt;
&lt;/tr&gt;
&lt;tr height="20"&gt;
&lt;td height="20"&gt;07:20:37&lt;/td&gt;
&lt;/tr&gt;
&lt;tr height="20"&gt;
&lt;td height="20"&gt;08:30:38&lt;/td&gt;
&lt;/tr&gt;
&lt;tr height="20"&gt;
&lt;td height="20"&gt;07:42:15&lt;/td&gt;
&lt;/tr&gt;
&lt;tr height="20"&gt;
&lt;td height="20"&gt;
&lt;p&gt;07:56:54&lt;span style="white-space: pre;"&gt; &lt;/span&gt;&lt;/p&gt;
&lt;table width="267" border="0" cellspacing="0" cellpadding="0"&gt;
&lt;tbody&gt;
&lt;tr height="21"&gt;
&lt;td width="267" height="21"&gt;96:46:04&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;span style="white-space: pre;"&gt;&lt;br&gt;
&lt;/span&gt;&lt;/p&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;The requirement is that the end user should be able to sum these values and get a total figure in the final xls or xlsx file. The total should be the last value.&lt;/p&gt;
&lt;p&gt;My question is how should I do all this formatting. This is what I tried&lt;/p&gt;
&lt;p&gt;worksheet.Cells[row, col].Value = "100:12:30"; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/p&gt;
&lt;p&gt;worksheet.Cells[row, col].Style.Numberformat.Format = "[h]:mm:ss";&lt;/p&gt;
&lt;p&gt;but when I open the spreadsheet, though I see the format [h]:mm:ss I cannot add the cells. Please help&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How do I set the first cell of the first row to span all columns?">
      <Posts>
        <Post From="bucketofsquid" When="13/05/2010 21:21:41">
          <Html>
        I have a spreadsheet called Balance Sheet. I want the first row of the worksheet to say "Balance Sheet" and have it centered on the screen/page. How do I do this?
        
    </Html>
        </Post>
        <Post From="cdc5205" When="14/05/2010 01:10:36">
          <Html>
        I am not sure how to get the number of columns on the page, but if you know the number of columns you can do this:&lt;br&gt;
&lt;br&gt;
ExcelRange range = worksheet.Cells[1, 1, 1, 10]; //starting row, starting column, ending row, ending column
&lt;br&gt;
range.Merge = true;&lt;br&gt;
range.Style.HorizontalAlignment = OfficeOpenXml.Style.ExcelHorizontalAlignment.Center;&lt;br&gt;
range.Value = "Balance Sheet";&lt;br&gt;
&lt;br&gt;
This may not be what you're looking for but maybe it will help a little. 
        
    </Html>
        </Post>
        <Post From="bucketofsquid" When="14/05/2010 14:01:32">
          <Html>
        Since I already know the number of columns this is exactly what I need! Thank you!
        
    </Html>
        </Post>
        <Post From="hakhamanet" When="18/12/2011 07:20:12">
          <Html>
        
&lt;p&gt;merci&amp;nbsp;&lt;a href="http://www.codeplex.com/site/users/view/cdc5205" rel="nofollow"&gt;cdc5205&lt;/a&gt;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Merge cells">
      <Posts>
        <Post From="nicopulse" When="11/04/2011 17:24:49">
          <Html>
        
&lt;p&gt;Hi,&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="hakhamanet" When="17/12/2011 11:31:09">
          <Html>
        
&lt;p&gt;hi,&lt;/p&gt;
&lt;p&gt;are any knows that how i can menge cells A1 : AL In Line 0?&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Insert One Rows Before First Line In Excel File">
      <Posts>
        <Post From="hakhamanet" When="17/12/2011 11:02:15">
          <Html>
        
&lt;p&gt;How &amp;nbsp;i can insert one row before first line in excel file?&lt;/p&gt;
&lt;p&gt;in otherwise , i can create excel file with fild caption but i most insert one rows in first row for describe report name and condition.&lt;/p&gt;
&lt;p&gt;how i can do this?&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Open File to Add Data">
      <Posts>
        <Post From="Fantom1107" When="15/12/2011 16:14:51">
          <Html>
        
&lt;p&gt;I have created an excel file and added a header. The next step I have to do is add data. The system I am working with will continually be spitting out data in another thread. I need to be able to grab the data and log it into my data table. I can get the
 data fine, prior to this I was using a csv file. My issue is I do not know how to access my already created excel file and add the data.&lt;/p&gt;
&lt;p&gt;Is there an open/load function I need to use to access my file?&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Fantom1107" When="15/12/2011 18:09:27">
          <Html>
        
&lt;p&gt;I am currently using this code in my function and it seems to read in the correct file. p shows the correct file path, and ws shows my worksheet named "data", but setting cell [2,2] does not do anything.&lt;/p&gt;
&lt;pre&gt;&lt;span style="white-space: pre;"&gt;	&lt;/span&gt;    ExcelPackage p = new ExcelPackage(new FileInfo(data_file));
            ExcelWorksheet ws = p.Workbook.Worksheets[1];

            ws.Cells[2, 2].Value = "Worked";&lt;/pre&gt;

        
    </Html>
        </Post>
        <Post From="Fantom1107" When="15/12/2011 18:20:10">
          <Html>
        
&lt;p&gt;Figured it out, I needed to save the file after.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;            Byte[] bin = p.GetAsByteArray();
            File.WriteAllBytes(data_file, bin);
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to use EPPlus to simply display XLSX ?">
      <Posts>
        <Post From="hkbeer" When="14/12/2011 04:35:29">
          <Html>
        
&lt;p&gt;I have a XLSX sheet with data, chart and smartarts on it.&lt;/p&gt;
&lt;p&gt;The file is already on IIS server. I just want to dispaly all these on the ASP.net page and not creating XLSX.&lt;/p&gt;
&lt;p&gt;Please help to post the code or tutorial to do this. I searched around and cannot find one.&lt;/p&gt;
&lt;p&gt;Pls help, thanks&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="14/12/2011 11:38:58">
          <Html>
        
&lt;p&gt;It will be not an easy task, you can open your xlsx file with epplus but there isnt a way to plot yours charts. You will need to get data from cells and use js, canvas, svg, etc to plot them.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;If you want to open your xlsx file, &amp;nbsp;just call constructor method passing a file reference.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="LoadFromDataTable Performance">
      <Posts>
        <Post From="brixred" When="13/12/2011 20:07:32">
          <Html>
        
&lt;p&gt;First I'd like to say thank you for this great tool.&lt;/p&gt;
&lt;p&gt;I write because I'm having some performance issues with the LoadFromDataTable method.&amp;nbsp; The majority of the time I have no problems with exporting various datagrids to excel using this tool.&amp;nbsp; That is, up to the point that the data table I'm now
 binding to has 12,000 rows, and 29 columns.&amp;nbsp; I understand that this is nearly 350K individual cells (all strings mind you, as this is an address/contact export), but my solution simply stays stuck on the LoadFromDataTable method.&amp;nbsp;&lt;/p&gt;
&lt;p&gt;If I'm debugging, it never passes this method.&amp;nbsp;I've sat and watched it for 30+ mins before. &amp;nbsp;If I don't debug, the page after 5+ mins or so stops 'cranking', it acts as if you didn't make the request to export to excel, and nothing gets
 written to my exception handler I have it wrapped in.&lt;/p&gt;
&lt;p&gt;Anyone had experience loading this much data?&amp;nbsp; Anyone have this hanging up issue with the LoadFromDataTable method?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="brixred" When="13/12/2011 20:40:36">
          <Html>
        
&lt;p&gt;Well it finally worked, but it took 22 minutes from the point it hits LoadFromDataTable to the time it moves on to the next line of code.&amp;nbsp; Any suggestions?&amp;nbsp; The old classic ASP version that just responded with&amp;nbsp;the content type of vnd.ms-excel
 is able to take an HTML table and the same amount of data and export it within seconds&lt;/p&gt;
&lt;p&gt;&amp;nbsp;Any pointers to help out on performance?&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Setting minor definition properties on a PivotTable">
      <Posts>
        <Post From="cphtims1970cp" When="13/12/2011 19:23:00">
          <Html>
        
&lt;p&gt;First off, thanks for such a great tool.&amp;nbsp; It has made my assignment &lt;em&gt;significantly&lt;/em&gt; easier than it would have been otherwise.&amp;nbsp; Major coo-dos.&lt;/p&gt;
&lt;p&gt;I'm creating a PivotTable which is working fine.&amp;nbsp; The problem is that I need to set some of the minor attributes of the PivotTable, such as the ColumnName.&amp;nbsp; I don't see any properties in the EPPlus SDK that allows for this.&lt;/p&gt;
&lt;p&gt;To see the type of minor attributes I'm referring to, see this page:&lt;/p&gt;
&lt;p&gt;http://msdn.microsoft.com/en-us/library/documentformat.openxml.spreadsheet.pivottabledefinition.aspx&lt;/p&gt;
&lt;p&gt;You can set these by doing something like this:&lt;/p&gt;
&lt;p&gt;PivotTableDefinition pivotTableDefinition1 = new PivotTableDefinition() { RowGrandTotals = false ..... GridDropZones = true };&lt;/p&gt;
&lt;p&gt;How can I do this with EPPlus?&lt;/p&gt;
&lt;p&gt;Is it possible to change the InnerXML of the PivotTable to set these?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="cphtims1970cp" When="13/12/2011 19:26:12">
          <Html>
        
&lt;p&gt;Specifically, one of the attributes I need to set is CompactLayoutColumnHeader.&amp;nbsp; That's what it's called in VBA anyway.&amp;nbsp; The XML property for that attribute is &amp;lt;!-- body { margin: 0 0 0 0; padding:0 0 0 0 } td,div { font-family:Tahoma;font-size:8pt;vertical-align:top
 } body { margin: 0 0 0 0; padding:0 0 0 0; overflow:hidden; } .transcript { background-color:#d2d2d2; } .messageBlock { margin-left:4px; margin-bottom:3px } .message { margin-left:100px; word-wrap:break-word; white-space:-moz-pre-wrap; _white-space:pre; white-space:pre-wrap;}
 .messageCont { margin-left:100px; word-wrap:break-word; white-space:-moz-pre-wrap; _white-space:pre;white-space:pre-wrap;} .other { overflow:hidden;color:&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/39577"&gt;#39577&lt;/a&gt;a;vertical-align:top;font-weight:bold;font-style:normal;float:left; width:95px; } .myself { overflow:hidden;color:#da8103;font-style:normal;font-weight:bold;font-style:normal;float:left;
 width:95px; } .otherCont { font-size:8px;text-align:right; color:&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/39577"&gt;#39577&lt;/a&gt;a;font-family:Arial,Lucida Grande;font-style:normal;vertical-align:top;font-weight:bold;float:left; width:95px; } .myselfCont { font-size:8px;text-align:right; color:#da8103;font-family:Arial,Lucida
 Grande;font-style:normal;vertical-align:top;font-weight:bold;float:left; width:95px; } .system { margin-left:4px; word-wrap:break-word;color:#da8103;font-style:normal;font-weight:normal; white-space:-moz-pre-wrap; _white-space:pre;white-space:pre-wrap; } .showTimestamp
 { padding-left:8px; margin-right:3px; float:right; color:&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/999999"&gt;#999999&lt;/a&gt;;font-style:normal;font-weight:normal; } .other1 { color:#ac2000;vertical-align:top;font-weight:bold;font-style:normal;float:left; width:95px; } .otherCont1 { font-size:8px;text-align:right; color:#ac2000;font-family:Arial,Lucida
 Grande;font-style:normal;vertical-align:top;font-weight:bold;float:left; width:95px; } .other2 { color:&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/3"&gt;#3&lt;/a&gt;c9fa8;vertical-align:top;font-weight:bold;font-style:normal;float:left; width:95px; } .otherCont2 { font-size:8px;text-align:right; color:&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/3"&gt;#3&lt;/a&gt;c9fa8;font-family:Arial,Lucida
 Grande;font-style:normal;vertical-align:top;font-weight:bold;float:left; width:95px; } .other3 { color:#e25614;vertical-align:top;font-weight:bold;font-style:normal;float:left; width:95px; } .otherCont3 { font-size:8px;text-align:right; color:#e25614;font-family:Arial,Lucida
 Grande;font-style:normal;vertical-align:top;font-weight:bold;float:left; width:95px; } .other4 { color:&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;b6ac8;vertical-align:top;font-weight:bold;font-style:normal;float:left; width:95px; } .otherCont4 { font-size:8px;text-align:right; color:&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;b6ac8;font-family:Arial,Lucida
 Grande;font-style:normal;vertical-align:top;font-weight:bold;float:left; width:95px; } .other5 { color:#b23290;vertical-align:top;font-weight:bold;font-style:normal;float:left; width:95px; } .otherCont5 { font-size:8px;text-align:right; color:#b23290;font-family:Arial,Lucida
 Grande;font-style:normal;vertical-align:top;font-weight:bold;float:left; width:95px; } .other6 { color:&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/02"&gt;#02&lt;/a&gt;e7c7;vertical-align:top;font-weight:bold;font-style:normal;float:left; width:95px; } .otherCont6 { font-size:8px;text-align:right; color:&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/02"&gt;#02&lt;/a&gt;e7c7;font-family:Arial,Lucida
 Grande;font-style:normal;vertical-align:top;font-weight:bold;float:left; width:95px; } .other7 { color:&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/5"&gt;#5&lt;/a&gt;b3284;vertical-align:top;font-weight:bold;font-style:normal;float:left; width:95px; } .otherCont7 { font-size:8px;text-align:right; color:&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/5"&gt;#5&lt;/a&gt;b3284;font-family:Arial,Lucida
 Grande;font-style:normal;vertical-align:top;font-weight:bold;float:left; width:95px; } .highlight { background-color:#bed6f8; } .datestamp { cursor:default; margin-bottom:1px; background-color:#c0c0c0; width:100%; float:left; text-align:right; color:#ffffff;
 font-weight:bold; font-style:italic; } #chatAlert { float:left; border-bottom:1px solid #E8D091; padding:6px; width:100%; color:#A5754C; } #chatAlertImage { float:left; } #chatAlertText { float:left; margin-left:6px; } #chatAlertClose { float:right; margin-right:10px;
 padding-right:6px; margin-top:0px; } #chatAlertText a { color:#A5754C; } #chatAlertText a:hover { color:#A5754C; text-decoration:none; } .tsDisplay { display:block }.dsDisplay { display:none } --&amp;gt; colHeaderCaption.&lt;/p&gt;
&lt;p&gt;I don't see any way of changing that.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="fixing the first line">
      <Posts>
        <Post From="Kirua76" When="09/12/2011 09:21:27">
          <Html>
        
&lt;p&gt;&lt;span&gt;Hello,&lt;/span&gt;&lt;br&gt;
&lt;span&gt;I want&lt;/span&gt;&amp;nbsp;&lt;span&gt;the first line&lt;/span&gt;&amp;nbsp;&lt;span&gt;that contains the name&lt;/span&gt;&amp;nbsp;&lt;span&gt;of the columns&lt;/span&gt;&amp;nbsp;&lt;span&gt;is fixed,&lt;/span&gt;&amp;nbsp;&lt;span&gt;and therefore&lt;/span&gt;&amp;nbsp;&lt;span&gt;when&lt;/span&gt;&amp;nbsp;&lt;span&gt;the excel file&lt;/span&gt;&amp;nbsp;&lt;span&gt;path&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&amp;nbsp;&lt;span&gt;as&lt;/span&gt;&amp;nbsp;&lt;span&gt;this
 first line&lt;/span&gt;&amp;nbsp;&lt;span&gt;is always&lt;/span&gt;&lt;span&gt;visible.&lt;/span&gt;&amp;nbsp;&lt;span&gt;Are&lt;/span&gt;&amp;nbsp;&lt;span&gt;possible?&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;I think it's freezepane.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="12/12/2011 11:43:36">
          <Html>
        
&lt;p&gt;Yes, you should use freezepane.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="problem with datetime">
      <Posts>
        <Post From="Kirua76" When="09/12/2011 09:52:25">
          <Html>
        
&lt;p&gt;&lt;span&gt;hello,&lt;/span&gt;&lt;br&gt;
&lt;span&gt;I have a problem&lt;/span&gt;&amp;nbsp;&lt;span&gt;with a&lt;/span&gt;&amp;nbsp;&lt;span&gt;datetime&lt;/span&gt;&amp;nbsp;&lt;span&gt;field&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;span&gt;I have&lt;/span&gt;&amp;nbsp;&lt;span&gt;put&lt;/span&gt;&amp;nbsp;&lt;span&gt;the right format&lt;/span&gt;&lt;span&gt;, so&lt;/span&gt;&amp;nbsp;&lt;span&gt;the date is displayed&lt;/span&gt;&amp;nbsp;&lt;span&gt;correctly in&lt;/span&gt;&amp;nbsp;&lt;span&gt;Excel.&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;The problem&amp;nbsp;&lt;span&gt;concern is&lt;/span&gt;&amp;nbsp;&lt;span&gt;that the column&lt;/span&gt;&amp;nbsp;&lt;span&gt;that contains datetime it&lt;/span&gt;&amp;nbsp;&lt;span&gt;is now&lt;/span&gt;&amp;nbsp;&lt;span&gt;too&lt;/span&gt;&amp;nbsp;&lt;span&gt;small and therefore&lt;/span&gt;&amp;nbsp;&lt;span&gt;displays&lt;/span&gt;&lt;span&gt;:&lt;/span&gt;&amp;nbsp;&lt;span&gt;#########&lt;/span&gt;&amp;nbsp;&lt;span&gt;to&lt;/span&gt;&amp;nbsp;&lt;span&gt;instead
 of the date&lt;/span&gt;&lt;span&gt;.&lt;span&gt;Just&lt;/span&gt;&amp;nbsp;&lt;span&gt;expand&lt;/span&gt;&amp;nbsp;&lt;span&gt;the column in&lt;/span&gt;&amp;nbsp;&lt;span&gt;excel,&lt;/span&gt;&amp;nbsp;&lt;span&gt;and dates&lt;/span&gt;&amp;nbsp;&lt;span&gt;are displayed correctly.&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Kirua76" When="09/12/2011 12:02:00">
          <Html>
        
&lt;p&gt;I solve my problem.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Line chart">
      <Posts>
        <Post From="lustuyck" When="20/03/2011 19:55:48">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I'm trying to generate a line chart, by using:&amp;nbsp;&lt;span style="white-space: pre;"&gt;
&lt;/span&gt;&lt;/p&gt;
&lt;pre&gt;&lt;span&gt;var&lt;/span&gt;&amp;nbsp;chart&amp;nbsp;=&amp;nbsp;worksheet.Drawings.AddChart(&lt;span&gt;"chart"&lt;/span&gt;,&amp;nbsp;&lt;span&gt;eChartType&lt;/span&gt;.Line)&amp;nbsp;&lt;span&gt;as&lt;/span&gt;&amp;nbsp;&lt;span&gt;ExcelLineChart&lt;/span&gt;;&lt;br&gt;&lt;/pre&gt;
&lt;p&gt;&lt;span style="white-space: pre;"&gt;b&lt;/span&gt;ut the result is a line chart with markers. How can I generate a line chart, without markers?&lt;/p&gt;
&lt;p&gt;And second question: how can I add a linear trendline?&lt;/p&gt;
&lt;p&gt;Thanks,&lt;/p&gt;
&lt;p&gt;L&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="21/03/2011 08:10:37">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;This is a bug. It's fixed if you download the latest source (build it from the tag/v2.8.0.1 folder).&lt;/p&gt;
&lt;p&gt;I have'nt added any support for trendlines. You can try to use a template if that's an option for you.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="lustuyck" When="21/03/2011 09:01:20">
          <Html>
        
&lt;p&gt;Thank you for the fix!&lt;/p&gt;
&lt;p&gt;I don't know if a template can help me for the trendline - the excel is generated on the fly and the contents are not fixed (it contains 1 or more patiënts with measurements and a line chart based on those measurements for each patient)...?&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="935main" When="06/12/2011 21:06:57">
          <Html>
        
&lt;p&gt;I'd love to see support for trend lines as well!&lt;/p&gt;
&lt;p&gt;This is an amazing project, thank you!&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="08/12/2011 20:55:51">
          <Html>
        
&lt;p&gt;There is trendline support in version 2.9.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="935main" When="08/12/2011 21:14:13">
          <Html>
        
&lt;p&gt;I searched the "Documentation" portion of the codeplex site, no mention of trend lines.&amp;nbsp; I searched the "Discussions" tab, and this is the only thread.&amp;nbsp; Now that I look under chart.Series I see trend lines in the intellisense.&lt;/p&gt;
&lt;p&gt;Thanks for this amazing project!&amp;nbsp; Once again I'm amazed by what you've gotten it to do so easily!&lt;/p&gt;
&lt;p&gt;One question though - is it possible to&amp;nbsp;change the line style&amp;nbsp;/ change the thickness / change the color?&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Find a range of an existing worksheet">
      <Posts>
        <Post From="kjweber" When="22/11/2011 23:14:27">
          <Html>
        
&lt;p&gt;Sorry if this is obvious - I have searched but yet to find a solution...&lt;/p&gt;
&lt;p&gt;Other than iterating over the rows and columns to find empty cells, how do you find an existing range of data in worksheet?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="28/11/2011 06:30:56">
          <Html>
        
&lt;p&gt;Not sure what you mean. Use the Worksheet.Dimension property to find the worksheet range or use foreach on the Cells property to return cells set cells.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="kjweber" When="08/12/2011 21:12:02">
          <Html>
        
&lt;p&gt;Nice. Should have been obvious to me - thanks for the response. The Dimension property is what I was looking for...&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="SaveAs File Type">
      <Posts>
        <Post From="jjw92" When="08/12/2011 06:24:37">
          <Html>
        
&lt;p&gt;I'm successfully opening an .xlsm file, reading and manipulating&amp;nbsp;data,&amp;nbsp;and then&amp;nbsp;saving&amp;nbsp;a copy of the&amp;nbsp;file in an archive.&amp;nbsp; However, I'd like to convert the file to .xlsx when archiving.&amp;nbsp; Is there a way to convert the file
 to .xlsx when saving?&amp;nbsp; I tried just changing the extension to .xlsx with the SaveAs, hoping it would strip the macros during the save but that didn't work, I just get an invalid file format error.&lt;/p&gt;
&lt;p&gt;Not a big deal if it can't be done but would be nice.&lt;/p&gt;
&lt;p&gt;Thanks!&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="08/12/2011 21:02:46">
          <Html>
        
&lt;p&gt;Nothing build in to the library to do that. You will need to remove the VBAProject.bin from the package and the relationship to the workbook.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="SaveAs vs Stream">
      <Posts>
        <Post From="gdoron" When="07/12/2011 09:34:31">
          <Html>
        
&lt;p&gt;What are the&amp;nbsp;differences&amp;nbsp;between those two methods?&lt;/p&gt;
&lt;p&gt;When Should I use each?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="07/12/2011 11:18:00">
          <Html>
        
&lt;p&gt;What do you mean by stream? You want to know difference between "SaveAs" and "GetAsByteArray" or "SaveAs(File ...)" and "SaveAs(Stream ...)" ?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Basically, they are all the same, but "SaveAs(File ....)" is one step forward, it will get your stream and return a file instead of "bunch of bytes".&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;In a nutshell:&lt;/p&gt;
&lt;p&gt;* You want to save file in your server/local computer: SaveAs(File ...).&lt;/p&gt;
&lt;p&gt;* You want to download: SaveAs(Stream ...) or "GetAsByteArray".&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="gdoron" When="07/12/2011 15:52:50">
          <Html>
        
&lt;p&gt;I wasn't clear enough, sorry!&lt;/p&gt;
&lt;p&gt;"You want to download:" &amp;nbsp;-- yes, this is my purpose.&lt;/p&gt;
&lt;p&gt;The worksheet has a Stream property. My question is what is the differences between ws.SaveAs(Stream) and ws.Stream?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="07/12/2011 16:25:13">
          <Html>
        
&lt;p&gt;I´m not tottaly sure....&lt;/p&gt;
&lt;p&gt;Jan, pls correct me if I´m wrong....but I think Stream and SaveAs will be the same if you are not using encrypt package. You should always call SaveAs or&amp;nbsp;GetAsByteArray, so it will works even with encrypt package.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Sample code to send stream to a web client:&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; Response.Clear();&lt;/span&gt;&lt;br&gt;
&lt;span&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Response.AddHeader(&lt;/span&gt;&lt;span&gt;"content-disposition"&lt;/span&gt;&lt;span&gt;,&amp;nbsp;&lt;/span&gt;&lt;span&gt;"attachment;&amp;nbsp; filename=file&lt;/span&gt;&lt;span&gt;.xlsx"&lt;/span&gt;&lt;span&gt;);&lt;/span&gt;&lt;br&gt;
&lt;span&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Response.ContentType =&amp;nbsp;&lt;/span&gt;&lt;span&gt;"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"&lt;/span&gt;&lt;span&gt;;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;br&gt;
&lt;span&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Response.BinaryWrite(pck.GetAsByteArray());&lt;/span&gt;&lt;br&gt;
&lt;span&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Response.End();&lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="gdoron" When="07/12/2011 21:11:37">
          <Html>
        
&lt;p&gt;Thanks!&lt;/p&gt;
&lt;p&gt;BTW, do you monitor the issue tracker &amp;nbsp;or it needs to be&amp;nbsp;discussed&amp;nbsp;here, in the disscusions?&lt;/p&gt;
&lt;p&gt;http://epplus.codeplex.com/workitem/14527&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Sheet whit &amp;amp; in the name">
      <Posts>
        <Post From="fsage" When="07/12/2011 10:49:39">
          <Html>
        
&lt;p&gt;&lt;span&gt;In&lt;/span&gt; &lt;span&gt;my file&lt;/span&gt;&lt;span&gt;, I have two&lt;/span&gt;&amp;nbsp;&lt;span&gt;sheet :
&lt;/span&gt;&amp;nbsp;&lt;span&gt;"sum&lt;/span&gt;&lt;span&gt;" and "&lt;/span&gt;&lt;span&gt;C &amp;amp;&lt;/span&gt;
&lt;span&gt;A".&lt;/span&gt;&lt;br&gt;
&lt;span&gt;If I make a&lt;/span&gt; &lt;span&gt;hyperlink&lt;/span&gt; &lt;span&gt;on the tab&lt;/span&gt; &lt;span&gt;"Sum&lt;/span&gt;&lt;span&gt;"&lt;/span&gt;
&lt;span&gt;tab&lt;/span&gt; &lt;span&gt;to the&lt;/span&gt; &lt;span&gt;"C &amp;amp;&lt;/span&gt; &lt;span&gt;A"&lt;/span&gt;
&lt;span&gt;I get an error opening the file&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-size: x-small;"&gt;&lt;span style="font-size: x-small;"&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;With the code below&lt;/span&gt;&lt;span&gt;, the file opens&lt;/span&gt; &lt;span&gt;but I have&lt;/span&gt;
&lt;span&gt;an&lt;/span&gt; &lt;span&gt;invalid&lt;/span&gt; &lt;span&gt;reference&lt;/span&gt; &lt;span&gt;on the hyperlink&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-size: x-small;"&gt;&lt;span style="font-size: x-small;"&gt;&lt;span style="font-size: x-small;"&gt;&lt;span style="font-size: x-small;"&gt;&lt;span style="font-size: x-small;"&gt;&lt;font size="2"&gt;&lt;/font&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;font size="2"&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;Ws_Recap.Cells(&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;"B"&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: x-small;"&gt; + IndexClientRecap.ToString).Hyperlink =
&lt;/span&gt;&lt;span style="color: rgb(0, 0, 255); font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-size: x-small;"&gt;New&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: x-small;"&gt; ExcelHyperLink(Dt.Rows(ILigne).Item(&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;"Client"&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: x-small;"&gt;).ToString.Replace(&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;"
 "&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: x-small;"&gt;, &lt;/span&gt;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;"_"&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: x-small;"&gt;).Replace(&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;"&amp;amp;"&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: x-small;"&gt;,
&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;"&amp;amp;amp;"&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: x-small;"&gt;) +
&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;"!A1"&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: x-small;"&gt;, Dt.Rows(ILigne).Item(&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;"Client"&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: x-small;"&gt;).ToString)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;/font&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;How to have&lt;/span&gt; &lt;span&gt;a&lt;/span&gt; "&lt;span&gt;&amp;amp;"&lt;/span&gt; &lt;span&gt;in&lt;/span&gt;
&lt;span&gt;the name of a&lt;/span&gt; &lt;span&gt;tab&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;Regards,&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;Fabrice&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Autofit row height ?">
      <Posts>
        <Post From="gicio" When="01/12/2011 18:19:31">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;how to autofit the row height ?&lt;/p&gt;
&lt;p&gt;regards,&lt;/p&gt;
&lt;p&gt;gicio&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="DataValidations exception &quot;Requested value 'date' was not found.&quot;  when trying to save package">
      <Posts>
        <Post From="MichaelPaulukonis" When="28/11/2011 20:21:57">
          <Html>
        
&lt;p&gt;I'm attempting to make changes to a customer-supplied file (a C# application will fill with data from a web-form and submit to a CMS).&lt;/p&gt;
&lt;p&gt;But on package.Save(name) -- or packagae.SaveAs(name) -- an exception is thrown by the DataValidations collection:&lt;/p&gt;
&lt;p&gt;2011-11-28 14:17:51,380 [9] ERROR app.ExcelConverter - System.ArgumentException: Requested value 'date' was not found.&lt;br&gt;
&amp;nbsp;&amp;nbsp; at System.Enum.EnumResult.SetFailure(ParseFailureKind failure, String failureMessageID, Object failureMessageFormatArgument)&lt;br&gt;
&amp;nbsp;&amp;nbsp; at System.Enum.TryParseEnum(Type enumType, String value, Boolean ignoreCase, EnumResult&amp;amp; parseResult)&lt;br&gt;
&amp;nbsp;&amp;nbsp; at System.Enum.Parse(Type enumType, String value, Boolean ignoreCase)&lt;br&gt;
&amp;nbsp;&amp;nbsp; at OfficeOpenXml.DataValidation.ExcelDataValidationCollection..ctor(ExcelWorksheet worksheet)&lt;br&gt;
&amp;nbsp;&amp;nbsp; at OfficeOpenXml.ExcelWorksheet.get_DataValidations()&lt;br&gt;
&amp;nbsp;&amp;nbsp; at FItoExcelCore.ExcelConverter.RunSample(String filePath) in \path\to\class.cs:line 32&lt;/p&gt;
&lt;p&gt;Even attempting worksheet.DataValidations.Clear() throws the same exception, and&amp;nbsp; this is without any changes to the file:&lt;/p&gt;
&lt;pre style="background: white; color: black; font-family: Consolas;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span style="color: blue;"&gt;try&lt;/span&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span style="color: blue;"&gt;using&lt;/span&gt;&amp;nbsp;(&lt;span style="color: rgb(43, 145, 175);"&gt;ExcelPackage&lt;/span&gt;&amp;nbsp;package&amp;nbsp;=&amp;nbsp;&lt;span style="color: blue;"&gt;new&lt;/span&gt;&amp;nbsp;&lt;span style="color: rgb(43, 145, 175);"&gt;ExcelPackage&lt;/span&gt;(output))
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; package.SaveAs(output);
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span style="color: blue;"&gt;catch&lt;/span&gt;&amp;nbsp;(&lt;span style="color: rgb(43, 145, 175);"&gt;Exception&lt;/span&gt;&amp;nbsp;ex)
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;_log.Error(ex.ToString());
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;/pre&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I do not have this behavior in an excel file that I create from scratch, but I need to use the supplied file.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="MichaelPaulukonis" When="28/11/2011 21:07:03">
          <Html>
        
&lt;p&gt;I don't know if it's significant, but I'm working in the .Net 4 Framework, and it's an 1.01 MB .xlsm file. The file saves/saves-as fine (even with new data) from within Excel.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="MichaelPaulukonis" When="28/11/2011 21:48:54">
          <Html>
        
&lt;p&gt;I just noticed &lt;a href="https://epplus.codeplex.com/discussions/203915" rel="nofollow"&gt;another thread
&lt;/a&gt;that suggests that "there is no real support for [xlsm files] in the component."&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Is that the source of my problem?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="MichaelPaulukonis" When="30/11/2011 18:05:31">
          <Html>
        
&lt;p&gt;Can anybody confirm that xlsm files are or are not supported by EPPlus?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="swmal" When="30/11/2011 21:36:50">
          <Html>
        
&lt;p&gt;I think this is a bug related to data validations and I will have a look at it... EPPlus has no support for macros, but I dont think that opening a xlsm file should cause a crash.&lt;/p&gt;
&lt;p&gt;What kinds of data validations exists in your xlsm file before you try to open it with EPPlus?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="swmal" When="30/11/2011 21:53:11">
          <Html>
        
&lt;p&gt;This was a bug and it is now fixed in the latest source. &amp;nbsp;Until the next release you will have to download and build the EPPlus source code locally.&lt;/p&gt;
&lt;p&gt;/Mats&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="MichaelPaulukonis" When="01/12/2011 15:07:45">
          <Html>
        
&lt;p&gt;Thanks, I built the latest out of SVN this morning, but now I'm getting a different error, and sooner -- when I attempt to open a worksheet.&lt;/p&gt;
&lt;p&gt;Before, I could open sheets and read data, and the error only appeared during Save() or SaveAs() -- now I can't even read anything. :-(&lt;/p&gt;
&lt;p&gt;2011-12-01 10:01:58,038 [10] ERROR CoreTester.Program - System.UriFormatException: Invalid URI: The format of the URI could not be determined.&lt;br&gt;
&amp;nbsp;&amp;nbsp; at System.Uri.CreateThis(String uri, Boolean dontEscape, UriKind uriKind)&lt;br&gt;
&amp;nbsp;&amp;nbsp; at System.Uri..ctor(String uriString)&lt;br&gt;
&amp;nbsp;&amp;nbsp; at OfficeOpenXml.ExcelHyperLink..ctor(String uriString) in D:\dev\EPPlus-dev\trunk\ExcelPackage\ExcelHyperLink.cs:line 45&lt;br&gt;
&amp;nbsp;&amp;nbsp; at OfficeOpenXml.ExcelWorksheet.LoadHyperLinks(XmlTextReader xr) in D:\dev\EPPlus-dev\trunk\ExcelPackage\ExcelWorksheet.cs:line 819&lt;br&gt;
&amp;nbsp;&amp;nbsp; at OfficeOpenXml.ExcelWorksheet.CreateXml() in D:\dev\EPPlus-dev\trunk\ExcelPackage\ExcelWorksheet.cs:line 579&lt;br&gt;
&amp;nbsp;&amp;nbsp; at OfficeOpenXml.ExcelWorksheet..ctor(XmlNamespaceManager ns, ExcelPackage excelPackage, String relID, Uri uriWorksheet, String sheetName, Int32 sheetID, Int32 positionID, eWorkSheetHidden hide) in D:\dev\EPPlus-dev\trunk\ExcelPackage\ExcelWorksheet.cs:line
 184&lt;br&gt;
&amp;nbsp;&amp;nbsp; at OfficeOpenXml.ExcelWorksheets..ctor(ExcelPackage pck, XmlNamespaceManager nsm, XmlNode topNode) in D:\dev\EPPlus-dev\trunk\ExcelPackage\ExcelWorksheets.cs:line 93&lt;br&gt;
&amp;nbsp;&amp;nbsp; at OfficeOpenXml.ExcelWorkbook.get_Worksheets() in D:\dev\EPPlus-dev\trunk\ExcelPackage\ExcelWorkbook.cs:line 252&lt;br&gt;
&amp;nbsp;&amp;nbsp; at OfficeOpenXml.ExcelWorkbook.GetDefinedNames() in D:\dev\EPPlus-dev\trunk\ExcelPackage\ExcelWorkbook.cs:line 160&lt;br&gt;
&amp;nbsp;&amp;nbsp; at OfficeOpenXml.ExcelPackage.get_Workbook() in D:\dev\EPPlus-dev\trunk\ExcelPackage\ExcelPackage.cs:line 560&lt;br&gt;
&amp;nbsp;&amp;nbsp; at FormItConverter.EpPlusTest.RunSample(String input) in D:\projects\Axis_Financial\FormItToExcel\FItoExcelCore\EpPlusTest.cs:line 38&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="MichaelPaulukonis" When="01/12/2011 15:32:11">
          <Html>
        
&lt;pre style="background: white; color: black; font-family: Consolas;"&gt;reference to code was skipped, before:&lt;br&gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;span style="color: blue;"&gt;using&lt;/span&gt;&amp;nbsp;(&lt;span style="color: rgb(43, 145, 175);"&gt;ExcelPackage&lt;/span&gt;&amp;nbsp;package&amp;nbsp;=&amp;nbsp;&lt;span style="color: blue;"&gt;new&lt;/span&gt;&amp;nbsp;&lt;span style="color: rgb(43, 145, 175);"&gt;ExcelPackage&lt;/span&gt;(output))
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span style="color: green;"&gt;//&amp;nbsp;get&amp;nbsp;the&amp;nbsp;first&amp;nbsp;worksheet&amp;nbsp;in&amp;nbsp;the&amp;nbsp;workbook&lt;/span&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span style="color: rgb(43, 145, 175);"&gt;ExcelWorksheet&lt;/span&gt;&amp;nbsp;worksheet&amp;nbsp;=&amp;nbsp;package.Workbook.Worksheets[1];
 
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; package.Save();
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br&gt;&lt;br&gt;Reducing the code as shown in the original post (above) to just a package.Save() request results in the same error, &lt;br&gt;as save ultimately goes through GetDefinedNames and chokes on the Worksheets reference.&lt;/pre&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="LoadFromDataTable Throws ArgumentException">
      <Posts>
        <Post From="gdoron" When="29/11/2011 08:49:16">
          <Html>
        
&lt;p&gt;When I try to load my DataTable to a new Worksheet I'm getting&amp;nbsp;&amp;nbsp;ArgumentException (Negative row and Columns numbers are not allowed)&lt;/p&gt;
&lt;p&gt;I saw two question like this in the internet, with no answers: (&lt;a href="http://stackoverflow.com/questions/7953713/epplus-throwing-argument-exception-negative-row-and-column-numbers-are-not-allo" target="_blank" rel="nofollow"&gt;first&lt;/a&gt;,
&lt;a href="http://it.6-da.com/show/7953713.aspx" rel="nofollow"&gt;second&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;Why is this happening? &amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="TiSch" When="29/11/2011 10:34:42">
          <Html>
        
&lt;p&gt;I have just answered it &lt;a title="EPPlus throwing Argument Exception (Negative row and column numbers are not allowed)" href="http://stackoverflow.com/a/8309265/284240" rel="nofollow"&gt;
on Stackoverflow&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;You need to specify the range:&lt;/p&gt;
&lt;pre&gt;&lt;pre&gt;&lt;code&gt;&lt;span&gt;worksheet&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;Cells&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span class="str"&gt;"A1"&lt;/span&gt;&lt;span&gt;).&lt;/span&gt;&lt;span&gt;LoadFromDataTable&lt;/span&gt;&lt;span&gt;(yourTable&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt; &lt;/span&gt;&lt;span&gt;False&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/pre&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Refresh Pivot Tables">
      <Posts>
        <Post From="pbukowski" When="23/11/2011 13:24:01">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I clear out and then re-populate a raw data tab in my excel file. After I'm done populating that tab, I'd like to refresh all the pivot tables that are based on that source. I then stream it to the web user with this. Problem is the pivot tables do not reflect
 the new data. How could I force a refresh of the pivot tables so the user will see the updates?&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;Dim&lt;/span&gt; fileBytes &lt;span style="color: blue;"&gt;As&lt;/span&gt; [&lt;span style="color: blue;"&gt;Byte&lt;/span&gt;]() = pck.GetAsByteArray()


Thanks so much. BTW, excellent pakcage !&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="28/11/2011 06:32:27">
          <Html>
        
&lt;p&gt;I think you have a setting on the pivottable in Excel to refresh when the workbook is loaded&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="pbukowski" When="28/11/2011 12:33:34">
          <Html>
        
&lt;p&gt;Hi Jan,&lt;/p&gt;
&lt;p&gt;There is indeed a checkbox that says to refresh the pivot tables upon opening. However, the excel file is already open because I am re-populating the raw data which feeds the pivot tables. So they don't automatically refresh. Somehow I would need to force
 a refresh, but not sure how I can code it to make that happen. The only thing I could do would be to update it, save it&amp;nbsp;and then close the Excel file and then re-open it and then stream it to the browser. However I'd prefer to not to assign write permissions
 and also the process would take too long. Thoughts?&lt;/p&gt;
&lt;p&gt;Thanks,&lt;/p&gt;
&lt;p&gt;Paul&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Exception while saving .xlsx using EPPLUS">
      <Posts>
        <Post From="Madhusmk" When="24/11/2011 07:59:03">
          <Html>
        
&lt;p&gt;Hi All,&lt;/p&gt;
&lt;p&gt;&amp;nbsp;I am trying to create an excel sheet using EPPLUS 2.9.0.1.&lt;/p&gt;
&lt;p&gt;File is getting generated when I forced to save it, but before saving it is throwing an exception in this line,&lt;/p&gt;
&lt;p&gt;xlPackage.Save();&lt;/p&gt;
&lt;p&gt;sometimes&amp;nbsp; "The process cannot access the file because it is being used by another process" and&lt;/p&gt;
&lt;p&gt;sometimes&amp;nbsp; " Error while save"..path" ".&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;br&gt;
Please let me know if you want any further information.&lt;br&gt;
&lt;br&gt;
Thanks,&lt;/p&gt;
&lt;p&gt;Madhusudhan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="28/11/2011 06:59:39">
          <Html>
        
&lt;p&gt;Sounds like you have the file opened&amp;nbsp;in another process (Excel or some other program)&amp;nbsp;when you save.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Print page horizontaly and RTL support">
      <Posts>
        <Post From="gdoron" When="27/11/2011 11:25:49">
          <Html>
        
&lt;p&gt;I have two problem with this&amp;nbsp;AWESOME&amp;nbsp;library.&lt;/p&gt;
&lt;p&gt;1. I want the first column(A1) will be in the upper right corner not in the left, is it possible?&lt;/p&gt;
&lt;p&gt;2. I want to print the worksheet horizontaly so all cells data will fit the page, how can I do that?&lt;/p&gt;
&lt;p&gt;Thanks!!!&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="gdoron" When="27/11/2011 12:04:26">
          <Html>
        
&lt;p&gt;horizontaly = Landscape&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="28/11/2011 06:57:24">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I think you can find most of the stuff you want on the Worksheet.Printersettings property, but I'm&amp;nbsp;not sure about your first question...&lt;/p&gt;
&lt;p&gt;PrinterSettings.Orientation for Portrait / Landscape&lt;/p&gt;
&lt;pre style="background: white; color: black; font-family: Consolas; font-size: 13px;"&gt;PrinterSettings.FitToWidth or FitToPage to fit.&lt;/pre&gt;
&lt;pre style="background: white; color: black; font-family: Consolas; font-size: 13px;"&gt;&lt;/pre&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Apply  culture formats from CulterInfo">
      <Posts>
        <Post From="ravikadam4u" When="25/11/2011 06:57:19">
          <Html>
        
&lt;div&gt;
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I want to apply culture to my data. I am retriving data from MYSQL database and checking datatype of each column. And according to datatype apply the culture. However I tried to &amp;nbsp;do like&amp;nbsp;&lt;/p&gt;
&lt;p&gt;((ExcelRange)worksheet.Cells[6, dc.Ordinal + 1, table.Rows.Count + 6, dc.Ordinal + 1]).Style.Numberformat.Format = "mm/dd/yyyy";&amp;nbsp;&lt;/p&gt;
&lt;p&gt;But I want to apply these formats (date, currency, time) from CultureInfo. My CultureInfo is not fixed. &amp;nbsp;It may change according to user.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Code:&lt;/p&gt;
&lt;p&gt;public static CultureInfo customCulture = new CultureInfo("en-US");&lt;/p&gt;
&lt;p&gt;foreach (DataColumn dc in table.Columns) &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;{ &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;/span&gt;if (dc.DataType.Name == "DateTime") &amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; {&lt;br&gt;
&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;((ExcelRange)worksheet.Cells[6, dc.Ordinal + 1, table.Rows.Count + 6, dc.Ordinal + 1]).Style.Numberformat.Format =&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: rgb(128, 0, 0);"&gt;&lt;span style="white-space: pre;"&gt;
&lt;/span&gt;Apply Culture from customculture&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;/span&gt;}&lt;/p&gt;
&lt;p&gt;}&lt;/p&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="28/11/2011 06:48:05">
          <Html>
        
&lt;p&gt;If you use the standard datetime and numeric formats they will change according to the culture of the computer they are opened on.&lt;/p&gt;
&lt;p&gt;If you are not happy with that, I think you can specifiy the culture like...&lt;/p&gt;
&lt;p&gt;[$-1083C]dd/mm/yyyy;@" depending on your culture. Check the OOXML documentation for details...&lt;/p&gt;
&lt;p&gt;&lt;a href="http://www.ecma-international.org/publications/standards/Ecma-376.htm" rel="nofollow"&gt;http://www.ecma-international.org/publications/standards/Ecma-376.htm&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="support for 2003 xls">
      <Posts>
        <Post From="gdoron" When="24/11/2011 18:34:58">
          <Html>
        
&lt;p&gt;I'm quite confused, In the title of each page written EPPlus create excel 2007 and in many discussion threads I read the authors saying that EPPlus doesn't support 2003-xls format reading nor writing (like&amp;nbsp;&lt;a title="this" href="http://epplus.codeplex.com/discussions/257942" target="_blank" rel="nofollow"&gt;this&lt;/a&gt;,
&lt;a title="this" href="http://epplus.codeplex.com/discussions/267752" target="_blank" rel="nofollow"&gt;
this&lt;/a&gt;, and &lt;a title="this" href="http://epplus.codeplex.com/discussions/279603" target="_blank" rel="nofollow"&gt;
this&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;And in &lt;a title="this thread" href="http://epplus.codeplex.com/discussions/253371" target="_blank" rel="nofollow"&gt;
this thread&lt;/a&gt; someone post a code that will able save xls format with EPPlus, will it work? and if it's so simple, why it's not official&amp;nbsp;supported?&lt;/p&gt;
&lt;p&gt;If EPPlus doesn't support 2003, which library support 2003-2010 formats?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mjslane" When="25/11/2011 11:59:52">
          <Html>
        
&lt;p&gt;No, it doesn't support xls format. &amp;nbsp;xls completely different to xlsx. &amp;nbsp;Epplus will allow you to save with any file extension you like, so you can use xls, but it will still be in 2007 format.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="gdoron" When="26/11/2011 16:46:56">
          <Html>
        
&lt;p&gt;And If I write the code commented in the tread:&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;ExcelPackage pck = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage();
ExcelWorksheet ws = pck.Workbook.Worksheets.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"Demo"&lt;/span&gt;);
ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;].LoadFromDataTable(dataTable, &lt;span style="color: blue;"&gt;true&lt;/span&gt;);
FileStream aFile = &lt;span style="color: blue;"&gt;new&lt;/span&gt; FileStream(&lt;span style="color: rgb(163, 21, 21);"&gt;"c:\\data\\excelfile.xls"&lt;/span&gt;, FileMode.Create);
&lt;span style="color: blue;"&gt;byte&lt;/span&gt;[] byData = pck.GetAsByteArray(); 
aFile.Seek(0, SeekOrigin.Begin);
aFile.Write(byData, 0, byData.Length);
aFile.Close();
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;If I write workbook with EPPlus and save it as .xls, Excel 2003 could open and print the workseets in it?&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="copy entire row with validations to multiples rows in same excel sheet">
      <Posts>
        <Post From="srikiarya" When="21/11/2011 10:54:44">
          <Html>
        
&lt;p&gt;Hi i am srikanth trying to do copy a row with validations for several columns to other rows but it is not happening showing error. Please help us to find a way to copy the validations from one row to multiple rows.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="stefangassner" When="24/11/2011 13:28:55">
          <Html>
        
&lt;p&gt;Hello, i also have the same problem - i try to copy validations for several columns to several rows.&lt;/p&gt;
&lt;p&gt;Currentrly i am using following code:&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;ExcelRangeBase destRange = ws.Cells[3, 1, table.Rows.Count, 81];
ws.Cells[2, 1, 2, 81].Copy(destRange);
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;But the validation is not copied!&lt;/p&gt;
&lt;p&gt;Maybe there is a function like "copy" -&amp;gt; "paste formulas only" like it is available in Excel2007.&lt;/p&gt;
&lt;p&gt;Stefan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Calling GetAsByteArray and Save in the same Method">
      <Posts>
        <Post From="cyrilwallace" When="21/06/2011 13:57:54">
          <Html>
        
&lt;p&gt;I have a method that needs to save the excel file generated to the database using GetAsByteArray.&lt;/p&gt;
&lt;p&gt;I also want to save the file to a location on disk.&lt;/p&gt;
&lt;p&gt;Once I call Save on the package, I get the following error {"Package object was closed and disposed, so cannot carry out operations on this object or any stream opened on a part of this package."}&lt;/p&gt;
&lt;p&gt;Is there a way around this?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="22/06/2011 19:45:16">
          <Html>
        
&lt;p&gt;I suggest you save it to a&amp;nbsp;variable and then save the byte array to a file and your db. Something like...&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;byte&lt;/span&gt;[] doc = package.GetAsByteArray();
File.WriteAllByte(&lt;span style="color: rgb(163, 21, 21);"&gt;"c:\yourfile.xlsx"&lt;/span&gt;, doc);
&lt;span style="color: green;"&gt;//code to save to sql...&lt;/span&gt;


&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="lsadam0" When="21/11/2011 20:44:23">
          <Html>
        
&lt;p&gt;This behavior should be changed. &amp;nbsp;GetAsByteArray() should not dispose of the object. &amp;nbsp;This behavior is not implied in the name. &amp;nbsp;The function should do exactly what the name implies: return a Byte Array of the object. &amp;nbsp;If the developer
 wishes to dispose of the object they should have the option of calling the dispose method.&lt;/p&gt;
&lt;p&gt;Alternatively rename the function GetAsByteArrayAndDispose();&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to get Range value when using formulas?">
      <Posts>
        <Post From="Kvilesjo" When="17/11/2011 08:41:29">
          <Html>
        
&lt;p&gt;Hi is it possible to get the value for a formula for a range?&lt;/p&gt;
&lt;p&gt;workSheet.Cells[1,1].Value returns blank ("") when the cell has a formula i.e. a reference to another cell.&lt;/p&gt;
&lt;p&gt;Is it possible to get the value of the formula?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;Cheers&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="18/11/2011 14:09:40">
          <Html>
        
&lt;p&gt;No, there is no calculation engine in EPPlus. You have to open the workbook in Excel to get the value.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="kvilesjo" When="18/11/2011 15:45:13">
          <Html>
        
&lt;p&gt;Thanks Jan for the reply.&lt;/p&gt;
&lt;p&gt;If others have the same question:&lt;/p&gt;
&lt;p&gt;Open the workbook. Select the cells. Copy and paste values (not normal paste).&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Cheers&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="setting multiple columns text in the legend">
      <Posts>
        <Post From="giritech" When="18/11/2011 06:49:26">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I am generating a excel chart.Single column values are displayed correctly in the legend section of the chart.&lt;/p&gt;
&lt;p&gt;But i want to display mulitple column values of row&amp;nbsp; in the legend.&lt;/p&gt;
&lt;p&gt;Code for single column is&lt;/p&gt;
&lt;p&gt;&amp;nbsp;var ser2 = chart.Series.Add(range.Offset(1, 6, 1, 3), range.Offset(-1, 6, 1, 3));&lt;br&gt;
&amp;nbsp; ser2.HeaderAddress = range.Offset(1, 0, 1, 1);&lt;/p&gt;
&lt;p&gt;But i want ser2.HeaderAddress property to accept a range&lt;/p&gt;
&lt;p&gt;&amp;nbsp;var ser2 = chart.Series.Add(range.Offset(1, 6, 1, 3), range.Offset(-1, 6, 1, 3));&lt;br&gt;
&amp;nbsp; ser2.HeaderAddress = range.Offset(1, 0, 1,3); (not working)&lt;/p&gt;
&lt;p&gt;Any help is appreciated&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;
&lt;p&gt;Giridhar&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="18/11/2011 14:28:10">
          <Html>
        
&lt;p&gt;Hmm, I have restricted the HeaderAddress to only allow single cells, but Excel allows rows and columns as well. I'll see if&amp;nbsp;I can change it to the next check-in.&lt;/p&gt;
&lt;p&gt;If you need a quick fix, try to remove the check at the top of the ﻿﻿﻿﻿HeaderAddress property.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="FileNotFoundException">
      <Posts>
        <Post From="dusijun01" When="05/11/2011 15:39:49">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I download the latest DLL and&amp;nbsp;there is an exception message&amp;nbsp;on my win7 64 bits.&lt;/p&gt;
&lt;p&gt;The Exception message:&lt;/p&gt;
&lt;p&gt;&lt;em&gt;"A first chance exception of type 'System.IO.FileNotFoundException' occurred in mscorlib.dll"&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;was output to console somewhere when I save the worksheet.&lt;/p&gt;
&lt;p&gt;Tracking the source code I found it is in&amp;nbsp;&lt;strong&gt;"foreach (ExcelCell cell in _cells)" in fuction&amp;nbsp;&amp;nbsp;&amp;nbsp; UpdateRowCellData(StreamWriter sw)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Test many times the exception was thrown out 100%, but the&amp;nbsp;excel file is saved with on problem.&lt;/p&gt;
&lt;p&gt;So,is it a Bug?&lt;/p&gt;
&lt;p&gt;My code (copy form example) is listed as below, hopefully there is no&amp;nbsp;problem in my code:&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;  &lt;span style="color: blue;"&gt;public&lt;/span&gt;  &lt;span style="color: blue;"&gt;static&lt;/span&gt; &lt;span style="color: blue;"&gt;void&lt;/span&gt; WriteAllLines(&lt;span style="color: blue;"&gt;string&lt;/span&gt; filename, &lt;span style="color: blue;"&gt;string&lt;/span&gt;[] lines){
             &lt;span style="color: green;"&gt;//save CSV to xlsx&lt;/span&gt;
             ExcelPackage package = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(&lt;span style="color: blue;"&gt;new&lt;/span&gt; FileInfo(filename));
             &lt;span style="color: green;"&gt;// add a new worksheet to the empty workbook&lt;/span&gt;

             ExcelWorksheet worksheet = package.Workbook.Worksheets.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"Worksheet 1"&lt;/span&gt;);
             &lt;span style="color: blue;"&gt;var&lt;/span&gt; namedStyle = package.Workbook.Styles.CreateNamedStyle(&lt;span style="color: rgb(163, 21, 21);"&gt;"HyperLink"&lt;/span&gt;);   &lt;span style="color: green;"&gt;//This one is language dependent&lt;/span&gt;
             namedStyle.Style.Font.UnderLine = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
             namedStyle.Style.Font.Color.SetColor(Color.Blue);


             &lt;span style="color: green;"&gt;//Add the data&lt;/span&gt;
             &lt;span style="color: blue;"&gt;for&lt;/span&gt; (&lt;span style="color: blue;"&gt;int&lt;/span&gt; i = 0; i &amp;lt; lines.Length;i++ )
             {
                 &lt;span style="color: blue;"&gt;if&lt;/span&gt; (lines[i]!=&lt;span style="color: rgb(163, 21, 21);"&gt;""&lt;/span&gt;)
                 {
                    &lt;span style="color: blue;"&gt;if&lt;/span&gt; (lines[i].Contains(&lt;span style="color: rgb(163, 21, 21);"&gt;","&lt;/span&gt;))
                    {
                        &lt;span style="color: blue;"&gt;string&lt;/span&gt;[] subline = lines[i].Split(&lt;span style="color: rgb(163, 21, 21);"&gt;','&lt;/span&gt;);
                        &lt;span style="color: blue;"&gt;for&lt;/span&gt; (&lt;span style="color: blue;"&gt;int&lt;/span&gt; j = 0; j &amp;lt; subline.Length;j++ )
                        {
                          worksheet.Cells[i + 1, j + 1].Value = subline[j];
                         }

                    }   &lt;span style="color: blue;"&gt;else&lt;/span&gt;{
                        worksheet.Cells[i + 1, 1].Value = lines[i]; 
                    }
                 }
             }
           
             &lt;span style="color: green;"&gt;// set some document properties&lt;/span&gt;
             package.Workbook.Properties.Title = &lt;span style="color: rgb(163, 21, 21);"&gt;"WorkSheet"&lt;/span&gt;;
             package.Workbook.Properties.Author = &lt;span style="color: rgb(163, 21, 21);"&gt;"myname"&lt;/span&gt;;
             package.Workbook.Properties.Comments = &lt;span style="color: rgb(163, 21, 21);"&gt;"myname"&lt;/span&gt;;

             &lt;span style="color: green;"&gt;// set some extended property values&lt;/span&gt;
             package.Workbook.Properties.Company = &lt;span style="color: rgb(163, 21, 21);"&gt;"mynameInc."&lt;/span&gt;;

             &lt;span style="color: green;"&gt;// set some custom property values&lt;/span&gt;
             package.Workbook.Properties.SetCustomPropertyValue(&lt;span style="color: rgb(163, 21, 21);"&gt;"Checked by"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"myname"&lt;/span&gt;);
             package.Workbook.Properties.SetCustomPropertyValue(&lt;span style="color: rgb(163, 21, 21);"&gt;"AssemblyName"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"myname"&lt;/span&gt;);

             &lt;span style="color: green;"&gt;// save our new workbook and we are done!&lt;/span&gt;
             package.Save();
         }
&lt;/pre&gt;
&lt;pre&gt;//win7 64bits VS2008 SP1 C#&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="17/11/2011 06:28:50">
          <Html>
        
&lt;p&gt;Hard to tell what the problem is, I cant see any problem with your code. Make sure you write to a valid path and have permission to write.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Can't enter DateTime greater than 24 hours">
      <Posts>
        <Post From="BartlomiejSkwira" When="27/10/2011 13:06:28">
          <Html>
        
&lt;p&gt;I want to enter date like below :&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;DateTime date = &lt;span style="color: blue;"&gt;new&lt;/span&gt; DateTime(&lt;span style="color: blue;"&gt;new&lt;/span&gt; TimeSpan(1, 0, 49, 11).Ticks); 
worksheet.Cells[1, 1].Value = date;
worksheet.Cells[1, 1].Style.Numberformat.Format = &lt;span style="color: rgb(163, 21, 21);"&gt;"[h]:mm:ss"&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;
&lt;pre&gt;&lt;span style='font-family: "Segoe UI","Microsoft Sans Serif",Arial,Geneva,sans-serif;'&gt;&lt;span style="white-space: normal;"&gt;&lt;br&gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;
&lt;p&gt;In debugger (at runtime) the date looks ok. But when I open the file Excel makes it 00:00:00. It seems that I cannot enter date which is higher than 24 hours, for example when I enter values "0, 1, 49, 11" excel shows correct time.&amp;nbsp;Is this
 a MS Excel bug?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="28/10/2011 15:29:22">
          <Html>
        
&lt;p&gt;I'm not sure, If you can do it in Excel, unzip the document and&amp;nbsp;look at the worksheet.xml&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="BartlomiejSkwira" When="16/11/2011 09:15:43">
          <Html>
        
&lt;p&gt;I've worked around this by formatting the date as text and giving the above format. Excel is capable to compare 2 dates formatted like this and the return value is also a date.&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="EPPLUS Exception while using .xls">
      <Posts>
        <Post From="Madhusmk" When="16/11/2011 06:27:26">
          <Html>
        
&lt;p&gt;Hi All,&lt;/p&gt;
&lt;p&gt;I am not able to import excel(.xls) sheet using EPPLUS 2.9.0.1, but can able to import .xlsx smoothly.&lt;/p&gt;
&lt;p&gt;While importing .xls it is throwing exception in this line:&lt;/p&gt;
&lt;p&gt;using (var package = new ExcelPackage(existingFile)) -- exception : "Can not open the package. Package is an OLE compound document. If this is an encrypted package, please supply the password"&lt;br&gt;
{&lt;/p&gt;
&lt;p&gt;....&lt;/p&gt;
&lt;p&gt;}&lt;/p&gt;
&lt;p&gt;File name is in this formate : "b8ec0b0a-03f5-4796-b376-61a44a3a1457_1.xls"&lt;/p&gt;
&lt;p&gt;can anyone tell me that EPPLUS 2.9.0.1 will support .xls? if yes, then any simple example.&lt;/p&gt;
&lt;p&gt;Regards&lt;/p&gt;
&lt;p&gt;Madhusudhan&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="swmal" When="16/11/2011 08:48:06">
          <Html>
        
&lt;p&gt;EPPlus does not support the xls format. Checkout the NPOI project (on Codeplex) to read xls files.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Madhusmk" When="16/11/2011 09:09:43">
          <Html>
        
&lt;p&gt;Thanks for your reply swmal&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Save">
      <Posts>
        <Post From="weismat" When="28/10/2011 09:47:27">
          <Html>
        
&lt;p&gt;Is there a way to call the ExcelPackage.Save function without disposing the package or save the workbook in a different way?&lt;/p&gt;
&lt;p&gt;I would like to save the workbook, sleep for a minute and add more rows to the end of a spreadsheet, but due to memory constraints I would like to keep the current rows/worksheet and just add at the end.&lt;/p&gt;
&lt;p&gt;The users would always use the Windows FS Copy function and work on a copy to check the spreadsheet.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="04/11/2011 15:27:51">
          <Html>
        
&lt;p&gt;No, not at the moment. Save will update the xml from the lists saved in memory. And with the current design it will not work to "resave" the package, so I dispose it at the end.&lt;/p&gt;
&lt;p&gt;You can of course use the stream to load it into&amp;nbsp;new package, but I assume that's not what you want to do.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="64  Bit Version?">
      <Posts>
        <Post From="dootndo2" When="04/11/2011 00:41:53">
          <Html>
        
&lt;p&gt;Do you have a binary version that supports 64 Bit OS?&amp;nbsp; The one that I currently have in our project is 2.6.0.1 and it is compiled x86.&amp;nbsp; Obviously, I could download the source and compile it, but I need to know if there are any potential issues
 with that.&lt;/p&gt;
&lt;p&gt;Great product!&lt;/p&gt;
&lt;p&gt;Thanks!&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="04/11/2011 15:20:03">
          <Html>
        
&lt;p&gt;It should work&amp;nbsp;fine in&amp;nbsp;a 64 bit env. I'm not sure why 2.6.0.1 is compiled x86, but there is no issue that I know of that could cause any problem.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title=".clear deletes format of all column">
      <Posts>
        <Post From="dhernandez" When="02/11/2011 11:11:50">
          <Html>
        
&lt;p&gt;If i delete values using .clear it clears all format of the column.&lt;/p&gt;
&lt;p&gt;Here is my sample code for formatting cells:&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;            lHoja.Cells(&lt;span style="color: rgb(163, 21, 21);"&gt;"A:A"&lt;/span&gt;).Style.Numberformat.Format = &lt;span style="color: rgb(163, 21, 21);"&gt;"0"&lt;/span&gt;
            lHoja.Cells(&lt;span style="color: rgb(163, 21, 21);"&gt;"B:B"&lt;/span&gt;).Style.Numberformat.Format = &lt;span style="color: rgb(163, 21, 21);"&gt;"@"&lt;/span&gt;
            lHoja.Cells(&lt;span style="color: rgb(163, 21, 21);"&gt;"C:D"&lt;/span&gt;).Style.Numberformat.Format = &lt;span style="color: rgb(163, 21, 21);"&gt;"dd/MM/yyyy"&lt;/span&gt;
            lHoja.Cells(&lt;span style="color: rgb(163, 21, 21);"&gt;"E:F"&lt;/span&gt;).Style.Numberformat.Format = &lt;span style="color: rgb(163, 21, 21);"&gt;"@"&lt;/span&gt;
            lHoja.Cells(&lt;span style="color: rgb(163, 21, 21);"&gt;"G:J"&lt;/span&gt;).Style.Numberformat.Format = &lt;span style="color: rgb(163, 21, 21);"&gt;"[h]:mm"&lt;/span&gt;
            lHoja.Cells(&lt;span style="color: rgb(163, 21, 21);"&gt;"K:K"&lt;/span&gt;).Style.Numberformat.Format = &lt;span style="color: rgb(163, 21, 21);"&gt;"0.0000"&lt;/span&gt; &lt;span style="color: green;"&gt;'"0,0000"&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;Here is my sample code for deleting values:&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;lHoja.Cells(&lt;span style="color: rgb(163, 21, 21);"&gt;"a2:k"&lt;/span&gt; &amp;amp; lFila).Clear()

&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="04/11/2011 15:13:53">
          <Html>
        This discussion has been copied to a work item. Click &lt;a href="http://epplus.codeplex.com/workitem/14402" rel="nofollow"&gt;
here&lt;/a&gt; to go to the work item and continue the discussion.
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Read Data from excel(32 bit and 64 bit)">
      <Posts>
        <Post From="kbreddy3333" When="02/11/2011 09:44:43">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;how to read data from excel.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Regards,&lt;/p&gt;
&lt;p&gt;Balu&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="04/11/2011 15:12:37">
          <Html>
        
&lt;p&gt;Check out the sample project&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Encoding">
      <Posts>
        <Post From="pvinitha" When="28/10/2011 18:59:25">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I'm reading a Excel File containing French chars. Where should I apply the encoding whil reading the file. The data gets transformed as "T??l??difusion de France - TPG TDF Co-Invest LLC".&lt;/p&gt;
&lt;p&gt;cheers,&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Vinitha&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="03/11/2011 16:48:34">
          <Html>
        
&lt;p&gt;I havn't had any problems with encoding. Can you send me the xlsx file (epplusdocs.gmail.com) or create an issue and describe the problem.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="pvinitha" When="03/11/2011 17:09:38">
          <Html>
        
&lt;p&gt;&lt;span style="color: rgb(31, 73, 125); font-size: 11pt;"&gt;Hi Jan,&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(31, 73, 125); font-size: 11pt;"&gt;&amp;nbsp;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(31, 73, 125); font-size: 11pt;"&gt;Attached C#Code file and the data file I load to
&lt;/span&gt;'epplusdocs@gmail.com'&lt;span style="color: rgb(31, 73, 125); font-size: 11pt;"&gt; . Also I noticed when I ran this c# code on a diff machine, it read the French char rightly and produced in the output as desired. &amp;nbsp;So I guess it’s a Culture setting&amp;nbsp;
 which I’m not able to figure out. Appreciate if you could shed somelight on this.&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(31, 73, 125); font-size: 11pt;"&gt;&amp;nbsp;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(31, 73, 125); font-size: 11pt;"&gt;Cheers,&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(31, 73, 125); font-size: 11pt;"&gt;&amp;nbsp;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(31, 73, 125); font-size: 11pt;"&gt;&amp;nbsp;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(31, 73, 125); font-size: 11pt;"&gt;Vinitha&lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Any easy way to update sharedStrings.xml?">
      <Posts>
        <Post From="JasonSTX" When="21/10/2011 16:53:07">
          <Html>
        
&lt;p&gt;After a large dataload, the sheet.xml can become quite large with redundant data.&amp;nbsp; Is there an easy way to force the updating of the sharedstrings.xml file in the package to reduce the file size?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="28/10/2011 15:20:03">
          <Html>
        
&lt;p&gt;Hmm, the sharedstrings.xml should not contain any duplicates, so im not sure what you mean. Only string data is stored in the sharedstring so this does not apply to numbers.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jasonstx" When="28/10/2011 16:34:23">
          <Html>
        
&lt;p&gt;I really should have written that better, I apologize.&lt;/p&gt;
&lt;p&gt;When I do a copy/paste of data into excel, the resultant sheet1.xml looks like this:&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;pre&gt;&lt;div style="color: black; background-color: white;"&gt;&lt;pre&gt;&lt;span style="color: blue;"&gt;&amp;lt;?&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;xml&lt;/span&gt; &lt;span style="color: red;"&gt;version&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;1.0&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: red;"&gt;encoding&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;UTF-8&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: red;"&gt;standalone&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;yes&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;?&amp;gt;&lt;/span&gt;
&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;worksheet&lt;/span&gt; &lt;span style="color: red;"&gt;xmlns&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;http://schemas.openxmlformats.org/spreadsheetml/2006/main&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: red;"&gt;xmlns:r&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;http://schemas.openxmlformats.org/officeDocument/2006/relationships&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
	&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;dimension&lt;/span&gt; &lt;span style="color: red;"&gt;ref&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;A1&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;/&amp;gt;&lt;/span&gt;
	&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;sheetViews&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
		&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;sheetView&lt;/span&gt; &lt;span style="color: red;"&gt;tabSelected&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;1&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: red;"&gt;workbookViewId&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;0&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;/&amp;gt;&lt;/span&gt;
	&lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;sheetViews&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
	&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;sheetFormatPr&lt;/span&gt; &lt;span style="color: red;"&gt;defaultRowHeight&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;15&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;/&amp;gt;&lt;/span&gt;
	&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;sheetData&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
		&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;row&lt;/span&gt; &lt;span style="color: red;"&gt;r&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;1&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;strong&gt;&lt;span style="color: red;"&gt;spans&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;1:1&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;/strong&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
			&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;c&lt;/span&gt; &lt;span style="color: red;"&gt;r&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;A1&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: red;"&gt;t&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;s&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
				&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;v&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;0&lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;v&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
			&lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;c&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
		&lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;row&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
	&lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;sheetData&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
	&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;pageMargins&lt;/span&gt; &lt;span style="color: red;"&gt;left&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;0.7&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: red;"&gt;right&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;0.7&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: red;"&gt;top&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;0.75&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: red;"&gt;bottom&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;0.75&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: red;"&gt;header&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;0.3&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: red;"&gt;footer&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;0.3&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;/&amp;gt;&lt;/span&gt;
&lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;worksheet&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;br&gt;&lt;br&gt;vs. loading from datatable&lt;br&gt;&lt;br&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;&amp;lt;?&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;xml&lt;/span&gt; &lt;span style="color: red;"&gt;version&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;1.0&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: red;"&gt;encoding&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;UTF-8&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: red;"&gt;standalone&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;yes&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;?&amp;gt;&lt;/span&gt;
&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;worksheet&lt;/span&gt; &lt;span style="color: red;"&gt;xmlns&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;http://schemas.openxmlformats.org/spreadsheetml/2006/main&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: red;"&gt;xmlns:r&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;http://schemas.openxmlformats.org/officeDocument/2006/relationships&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
	&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;dimension&lt;/span&gt; &lt;span style="color: red;"&gt;ref&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;A1&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: blue;"&gt;/&amp;gt;&lt;/span&gt;
	&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;sheetViews&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
		&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;sheetView&lt;/span&gt; &lt;span style="color: red;"&gt;tabSelected&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;1&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: red;"&gt;workbookViewId&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;0&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: blue;"&gt;/&amp;gt;&lt;/span&gt;
	&lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;sheetViews&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
	&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;sheetFormatPr&lt;/span&gt; &lt;span style="color: red;"&gt;defaultRowHeight&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;15&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: blue;"&gt;/&amp;gt;&lt;/span&gt;
	&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;sheetData&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
		&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;row&lt;/span&gt; &lt;span style="color: red;"&gt;r&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;1&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
			&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;c&lt;/span&gt; &lt;span style="color: red;"&gt;r&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;A1&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;strong&gt;&lt;span style="color: red;"&gt;s&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;0&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;/strong&gt; &lt;span style="color: red;"&gt;t&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;s&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
				&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;v&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;0&lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;v&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
			&lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;c&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
		&lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;row&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
	&lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;sheetData&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
	&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;pageMargins&lt;/span&gt; &lt;span style="color: red;"&gt;left&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;0.7&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: red;"&gt;right&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;0.7&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: red;"&gt;top&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;0.75&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: red;"&gt;bottom&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;0.75&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: red;"&gt;header&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;0.3&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: red;"&gt;footer&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;0.3&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: blue;"&gt;/&amp;gt;&lt;/span&gt;
&lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;worksheet&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;br&gt;So loading 50K rows with 10 columns can cause the sheet1.xml to have a 80% increase in size when imported vs. copy/pasted.&lt;br&gt;&lt;br&gt;I think its the addition of the s="0" to every single cell.&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="03/11/2011 16:41:34">
          <Html>
        
&lt;p&gt;s="0" is the style ID.&lt;/p&gt;
&lt;p&gt;I guess it could be omitted if the StyleID is 0. I'll have a look at it to the next version. This "size increase" is only a problem if you havn't applied any style to your data.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jasonstx" When="03/11/2011 17:00:26">
          <Html>
        
&lt;p&gt;Absolutely.&amp;nbsp; Thanks for looking into it.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Set Worksheet as default open">
      <Posts>
        <Post From="somepolak" When="25/10/2011 20:42:38">
          <Html>
        
&lt;p&gt;Hi Guys&lt;/p&gt;
&lt;p&gt;I'm new to EPPlus, but I love it already, really useful package.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I am looking for a way to set a default worksheet to be open when you open a newly created excel document. I know excel currently opens the worksheet that the latest changes were made in, and I am trying to replicate this.&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Has anyone been successful with this? Or even attempted it before?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="somepolak" When="01/11/2011 21:01:14">
          <Html>
        
&lt;p&gt;I have found the answer, if any one else is looking.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;pre&gt;&lt;span&gt;ExcelPackage&lt;/span&gt;&amp;nbsp;package&amp;nbsp;=&amp;nbsp;&lt;span&gt;new&lt;/span&gt;&amp;nbsp;&lt;span&gt;ExcelPackage&lt;/span&gt;(&lt;span&gt;new&lt;/span&gt;&amp;nbsp;&lt;span&gt;FileInfo&lt;/span&gt;(newFileName))
&lt;/pre&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;pre&gt;package.Workbook.Worksheets[&lt;span&gt;"TABNAME"&lt;/span&gt;].View.TabSelected&amp;nbsp;=&amp;nbsp;&lt;span&gt;true&lt;/span&gt;;
&lt;/pre&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="SaveAs after Save throw an exception">
      <Posts>
        <Post From="AdriRodriguez" When="21/10/2011 10:14:28">
          <Html>
        
&lt;p&gt;When i'm trying to SaveAs after Save it throws an exception, becouse the package is disposed.&lt;/p&gt;
&lt;p&gt;I'm seeing that at source code in save method. I think is the issue.&lt;/p&gt;
&lt;p&gt;if (Stream is MemoryStream)&lt;br&gt;
{&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;strong&gt;_package.Close();&lt;/strong&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; var fi = new FileStream(File.FullName, FileMode.Create);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; //EncryptPackage&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; if (Encryption.IsEncrypted)&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp; byte[] file = ((MemoryStream)Stream).ToArray();&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp; EncryptedPackageHandler eph = new EncryptedPackageHandler();&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp; var ms = eph.EncryptPackage(file, Encryption);&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp; fi.Write(ms.GetBuffer(), 0, (int)ms.Length);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; else&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp; fi.Write(((MemoryStream)Stream).GetBuffer(), 0, (int)Stream.Length);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; fi.Close();&lt;br&gt;
}&lt;/p&gt;
&lt;p&gt;http://www.java2s.com/Open-Source/CSharp/Chart/EPPlus/OfficeOpenXml/ExcelPackage.cs.htm&lt;/p&gt;
&lt;p&gt;How can i do it?&lt;/p&gt;
&lt;p&gt;PD: that's not my release. I have the last one.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div id="_mcePaste" style="left: -10000px; top: 0px; width: 1px; height: 1px; overflow: hidden;"&gt;
&lt;pre&gt;&lt;code&gt;&lt;span style="color: rgb(127, 0, 85);"&gt;&lt;strong&gt;if&lt;/strong&gt;&lt;/span&gt; (&lt;a href="http://www.java2s.com/Open-Source/CSharp/2.6.4-mono-.net-core/System.IO/System/IO/Stream.cs.htm" rel="nofollow"&gt;&lt;strong&gt;Stream&lt;/strong&gt;&lt;/a&gt; &lt;span style="color: rgb(127, 0, 85);"&gt;&lt;strong&gt;is&lt;/strong&gt;&lt;/span&gt; &lt;a href="http://www.java2s.com/Open-Source/CSharp/2.6.4-mono-.net-core/System.IO/System/IO/MemoryStream.cs.htm" rel="nofollow"&gt;&lt;strong&gt;MemoryStream&lt;/strong&gt;&lt;/a&gt;)
                    {
                        _package.Close();
                        &lt;span style="color: rgb(127, 0, 85);"&gt;&lt;strong&gt;var&lt;/strong&gt;&lt;/span&gt; fi = &lt;span style="color: rgb(127, 0, 85);"&gt;&lt;strong&gt;new&lt;/strong&gt;&lt;/span&gt; &lt;a href="http://www.java2s.com/Open-Source/CSharp/2.6.4-mono-.net-core/System.IO/System/IO/FileStream.cs.htm" rel="nofollow"&gt;&lt;strong&gt;FileStream&lt;/strong&gt;&lt;/a&gt;(File.FullName, FileMode.Create);
                        &lt;span style="color: rgb(63, 127, 95);"&gt;//EncryptPackage
&lt;/span&gt;                        &lt;span style="color: rgb(127, 0, 85);"&gt;&lt;strong&gt;if&lt;/strong&gt;&lt;/span&gt; (Encryption.IsEncrypted)
                        {
                            &lt;span style="color: rgb(225, 27, 49);"&gt;&lt;strong&gt;byte&lt;/strong&gt;&lt;/span&gt;[] file = ((&lt;a href="http://www.java2s.com/Open-Source/CSharp/2.6.4-mono-.net-core/System.IO/System/IO/MemoryStream.cs.htm" rel="nofollow"&gt;&lt;strong&gt;MemoryStream&lt;/strong&gt;&lt;/a&gt;)&lt;a href="http://www.java2s.com/Open-Source/CSharp/2.6.4-mono-.net-core/System.IO/System/IO/Stream.cs.htm" rel="nofollow"&gt;&lt;strong&gt;Stream&lt;/strong&gt;&lt;/a&gt;).ToArray();
                            &lt;a href="http://www.java2s.com/Open-Source/CSharp/Chart/EPPlus/OfficeOpenXml/EncryptedPackageHandler.cs.htm" rel="nofollow"&gt;&lt;strong&gt;EncryptedPackageHandler&lt;/strong&gt;&lt;/a&gt; eph = &lt;span style="color: rgb(127, 0, 85);"&gt;&lt;strong&gt;new&lt;/strong&gt;&lt;/span&gt; &lt;a href="http://www.java2s.com/Open-Source/CSharp/Chart/EPPlus/OfficeOpenXml/EncryptedPackageHandler.cs.htm" rel="nofollow"&gt;&lt;strong&gt;EncryptedPackageHandler&lt;/strong&gt;&lt;/a&gt;();
                            &lt;span style="color: rgb(127, 0, 85);"&gt;&lt;strong&gt;var&lt;/strong&gt;&lt;/span&gt; ms = eph.EncryptPackage(file, Encryption);

                            fi.Write(ms.GetBuffer(), 0, (&lt;span style="color: rgb(225, 27, 49);"&gt;&lt;strong&gt;int&lt;/strong&gt;&lt;/span&gt;)ms.Length);
                        }
                        &lt;span style="color: rgb(127, 0, 85);"&gt;&lt;strong&gt;else&lt;/strong&gt;&lt;/span&gt;
                        {
                            fi.Write(((&lt;a href="http://www.java2s.com/Open-Source/CSharp/2.6.4-mono-.net-core/System.IO/System/IO/MemoryStream.cs.htm" rel="nofollow"&gt;&lt;strong&gt;MemoryStream&lt;/strong&gt;&lt;/a&gt;)&lt;a href="http://www.java2s.com/Open-Source/CSharp/2.6.4-mono-.net-core/System.IO/System/IO/Stream.cs.htm" rel="nofollow"&gt;&lt;strong&gt;Stream&lt;/strong&gt;&lt;/a&gt;).GetBuffer(), 0, (&lt;span style="color: rgb(225, 27, 49);"&gt;&lt;strong&gt;int&lt;/strong&gt;&lt;/span&gt;)Stream.Length);
                        }
                        fi.Close();
                    }&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="28/10/2011 15:16:59">
          <Html>
        
&lt;p&gt;Yes, the package is closed on save. Use a file copy, save it to a&amp;nbsp;stream&amp;nbsp;or somthing like this ...&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;byte&lt;/span&gt;[] doc = package.GetAsByteArray();
File.WriteAllByte(&lt;span style="color: rgb(163, 21, 21);"&gt;"c:\yourfile1.xlsx"&lt;/span&gt;, doc);
File.WriteAllByte(&lt;span style="color: rgb(163, 21, 21);"&gt;"c:\yourfile2.xlsx"&lt;/span&gt;, doc);

&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="how set top index">
      <Posts>
        <Post From="TomasHorvath" When="26/10/2011 12:55:43">
          <Html>
        
&lt;p&gt;Hi I´am just start using EPPlus but I can find how create top index i﻿n cell. I need to create ﻿﻿﻿﻿﻿m﻿^2 . How can I do it.&lt;/p&gt;
&lt;p&gt;thank you very much&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Gradient,Shadows in rectangle">
      <Posts>
        <Post From="betito_no1" When="19/10/2011 21:06:38">
          <Html>
        
&lt;p&gt;﻿﻿﻿How i can add gradient, shadow,effects to a rectangle&lt;/p&gt;
&lt;p&gt;thanks.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="20/10/2011 12:16:53">
          <Html>
        
&lt;p&gt;It is not possible in this current release.&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Format cell value as percent">
      <Posts>
        <Post From="BartlomiejSkwira" When="14/10/2011 10:05:08">
          <Html>
        
&lt;p&gt;I have a problem with formatting text as %. Example:&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"B6"&lt;/span&gt;].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"15"&lt;/span&gt;;
Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"B6"&lt;/span&gt;].Style.Numberformat.Format = &lt;span style="color: rgb(163, 21, 21);"&gt;"0%"&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;When I open document done by code above the text in B6 is aligned to the left, there is a message like&amp;nbsp;"The number in this cell is formatted as text or preceded by an apostrophe". A chart which uses this value draws&amp;nbsp;incorrectly. &amp;nbsp;When
 I double-click the cell (when open in Excel) the&amp;nbsp;formatting&amp;nbsp;is ok. What's interesting when the value is set by a formula, then the formatting is ok. Any clue what am I doing wrong?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="19/10/2011 06:41:22">
          <Html>
        
&lt;p&gt;You set the value as text. Set the value as a number instead...&lt;/p&gt;
&lt;pre&gt;Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"B6"&lt;/span&gt;].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;15&lt;/span&gt;;
Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"B6"&lt;/span&gt;].Style.Numberformat.Format = &lt;span style="color: rgb(163, 21, 21);"&gt;"0%"&lt;/span&gt;;
&lt;/pre&gt;

        
    </Html>
        </Post>
        <Post From="BartlomiejSkwira" When="19/10/2011 11:05:46">
          <Html>
        
&lt;p&gt;Man, I had the answer right in front of me. Thanks!&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Filter Pivot for current month">
      <Posts>
        <Post From="TiSch" When="17/10/2011 15:56:41">
          <Html>
        
&lt;p&gt;Hello,&lt;/p&gt;
&lt;p&gt;i need to filter a generated PivotTable by current month by default.&lt;/p&gt;
&lt;p&gt;So what i want to achieve is following(watch out the filter icon besides "Country" and the date-values which are only October):&lt;/p&gt;
&lt;p&gt;&lt;a href="http://www.bilder-hochladen.net/files/4709-o7-f455-jpg.html" rel="nofollow"&gt;&lt;img alt="Bilder Upload" src="http://www.bilder-hochladen.net/files/thumbs/4709-o7-f455.jpg" border="0"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;This is the code i use to generate the Pivot:&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;Private&lt;/span&gt; &lt;span style="color: blue;"&gt;Shared&lt;/span&gt; &lt;span style="color: blue;"&gt;Function&lt;/span&gt; GeneratePivotSheets(&lt;span style="color: blue;"&gt;ByVal&lt;/span&gt; log &lt;span style="color: blue;"&gt;As&lt;/span&gt; Logging.Log, &lt;span style="color: blue;"&gt;ByVal&lt;/span&gt; excel &lt;span style="color: blue;"&gt;As&lt;/span&gt; ExcelPackage, &lt;span style="color: blue;"&gt;ByVal&lt;/span&gt; workSheet &lt;span style="color: blue;"&gt;As&lt;/span&gt; ExcelObject) &lt;span style="color: blue;"&gt;As&lt;/span&gt; List(Of ExcelWorksheet)
        &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; sheets &lt;span style="color: blue;"&gt;As&lt;/span&gt; &lt;span style="color: blue;"&gt;New&lt;/span&gt; List(Of ExcelWorksheet)
        &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; wsPivot = excel.Workbook.Worksheets.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"Pivot"&lt;/span&gt;)
        &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; wsData = excel.Workbook.Worksheets.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"Data"&lt;/span&gt;)
        &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; source = workSheet.GetDataSource
        wsData.Cells(&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;).LoadFromDataTable(source, &lt;span style="color: blue;"&gt;True&lt;/span&gt;, OfficeOpenXml.Table.TableStyles.Medium6)
        &lt;span style="color: blue;"&gt;For&lt;/span&gt; &lt;span style="color: blue;"&gt;Each&lt;/span&gt; col &lt;span style="color: blue;"&gt;As&lt;/span&gt; DataColumn &lt;span style="color: blue;"&gt;In&lt;/span&gt; source.Columns
            &lt;span style="color: blue;"&gt;If&lt;/span&gt; col.DataType = &lt;span style="color: blue;"&gt;GetType&lt;/span&gt;(&lt;span style="color: blue;"&gt;Date&lt;/span&gt;) &lt;span style="color: blue;"&gt;Then&lt;/span&gt;
                &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; colNumber = col.Ordinal + 1
                &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; range = wsData.Cells(2, colNumber, source.Rows.&lt;span style="color: blue;"&gt;Count&lt;/span&gt; + 1, colNumber)
                range.Style.Numberformat.Format = &lt;span style="color: rgb(163, 21, 21);"&gt;"dd.MM.yyyy"&lt;/span&gt;
            &lt;span style="color: blue;"&gt;End&lt;/span&gt; &lt;span style="color: blue;"&gt;If&lt;/span&gt;
        &lt;span style="color: blue;"&gt;Next&lt;/span&gt;

        &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; dataRange = wsData.Cells(wsData.Dimension.Address.ToString())
        dataRange.AutoFitColumns()
        &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; pivotTable = wsPivot.PivotTables.Add(wsPivot.Cells(&lt;span style="color: rgb(163, 21, 21);"&gt;"A3"&lt;/span&gt;), dataRange, workSheet.ReportRow.Description)
        pivotTable.MultipleFieldFilters = &lt;span style="color: blue;"&gt;True&lt;/span&gt;
        pivotTable.RowGrandTotals = &lt;span style="color: blue;"&gt;True&lt;/span&gt;
        pivotTable.ColumGrandTotals = &lt;span style="color: blue;"&gt;True&lt;/span&gt;
        
        pivotTable.PageFields.Add(pivotTable.Fields(0))
        pivotTable.RowFields.Add(pivotTable.Fields(4))
        
        pivotTable.RowHeaderCaption = pivotTable.RowFields(0).Name
        pivotTable.Fields(0).Sort = eSortType.&lt;span style="color: blue;"&gt;Ascending&lt;/span&gt;

        &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; weekField = pivotTable.Fields(2)
        pivotTable.PageFields.Add(weekField)
        weekField.Sort = eSortType.&lt;span style="color: blue;"&gt;Ascending&lt;/span&gt;

        &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; countField = pivotTable.Fields(&lt;span style="color: rgb(163, 21, 21);"&gt;"Count"&lt;/span&gt;)
        pivotTable.DataFields.Add(countField)

        &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; statusField = pivotTable.Fields(&lt;span style="color: rgb(163, 21, 21);"&gt;"Status"&lt;/span&gt;)
        pivotTable.ColumnFields.Add(statusField)

        &lt;span style="color: green;"&gt;' i want to filter this field for current month by default: '&lt;/span&gt;
        &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; timeField = pivotTable.Fields(pivotTable.Fields.&lt;span style="color: blue;"&gt;Count&lt;/span&gt; - 1)
        pivotTable.RowFields.Add(timeField)
        timeField.AddDateGrouping(eDateGroupBy.Months &lt;span style="color: blue;"&gt;Or&lt;/span&gt; eDateGroupBy.Days)

        &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; monthGroupField = pivotTable.Fields.GetDateGroupField(eDateGroupBy.Months)
        monthGroupField.ShowAll = &lt;span style="color: blue;"&gt;False&lt;/span&gt;
        monthGroupField.

        &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; dayGroupField = pivotTable.Fields.GetDateGroupField(eDateGroupBy.Days)
        dayGroupField.ShowAll = &lt;span style="color: blue;"&gt;False&lt;/span&gt;

        sheets.Add(wsPivot)
        sheets.Add(wsData)
        &lt;span style="color: blue;"&gt;Return&lt;/span&gt; sheets
    &lt;span style="color: blue;"&gt;End&lt;/span&gt; &lt;span style="color: blue;"&gt;Function&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="19/10/2011 07:07:19">
          <Html>
        
&lt;p&gt;Sorry, you cant set filters in the current version.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="CreateNamedStyle template issue">
      <Posts>
        <Post From="disman" When="17/10/2011 22:07:51">
          <Html>
        
&lt;p&gt;I tried to use the « Template »&amp;nbsp;parameter in the CreateNamedStyle function and I always get this error : « ArgumentOutOfRangeException was unhandled. »&lt;/p&gt;
&lt;p&gt;Here is a code sample :&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;span style="color: rgb(0, 0, 255);"&gt;&amp;nbsp;&lt;/span&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;Dim&lt;/span&gt; fiFile &lt;span style="color: blue;"&gt;As&lt;/span&gt; IO.FileInfo
&lt;span style="color: blue;"&gt;Dim&lt;/span&gt; excelFile &lt;span style="color: blue;"&gt;As&lt;/span&gt; ExcelPackage
&lt;span style="color: blue;"&gt;Dim&lt;/span&gt; wsSheet &lt;span style="color: blue;"&gt;As&lt;/span&gt; ExcelWorksheet

&lt;span style="color: blue;"&gt;Try&lt;/span&gt;

	&lt;span style="color: blue;"&gt;If&lt;/span&gt; IO.File.Exists(&lt;span style="color: rgb(163, 21, 21);"&gt;"testExcel.xlsx"&lt;/span&gt;) &lt;span style="color: blue;"&gt;Then&lt;/span&gt;
		IO.File.Delete(&lt;span style="color: rgb(163, 21, 21);"&gt;"testExcel.xlsx"&lt;/span&gt;)
	&lt;span style="color: blue;"&gt;End&lt;/span&gt; &lt;span style="color: blue;"&gt;If&lt;/span&gt;
	fiFile = &lt;span style="color: blue;"&gt;New&lt;/span&gt; IO.FileInfo(&lt;span style="color: rgb(163, 21, 21);"&gt;"testExcel.xlsx"&lt;/span&gt;)

	excelFile = &lt;span style="color: blue;"&gt;New&lt;/span&gt; ExcelPackage(fiFile)
	wsSheet = excelFile.Workbook.Worksheets.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"test1"&lt;/span&gt;)

	&lt;span style="color: blue;"&gt;Dim&lt;/span&gt; firstNamedStyle &lt;span style="color: blue;"&gt;As&lt;/span&gt; Style.XmlAccess.ExcelNamedStyleXml = _
		excelFile.Workbook.Styles.CreateNamedStyle(&lt;span style="color: rgb(163, 21, 21);"&gt;"tempFirst"&lt;/span&gt;)
	&lt;span style="color: blue;"&gt;With&lt;/span&gt; firstNamedStyle.Style
		.HorizontalAlignment = Style.ExcelHorizontalAlignment.CenterContinuous
		.VerticalAlignment = Style.ExcelVerticalAlignment.Center
	&lt;span style="color: blue;"&gt;End&lt;/span&gt; &lt;span style="color: blue;"&gt;With&lt;/span&gt;
	Console.WriteLine(firstNamedStyle.Name)

	&lt;span style="color: blue;"&gt;With&lt;/span&gt; excelFile.Workbook.Styles.CreateNamedStyle(&lt;span style="color: rgb(163, 21, 21);"&gt;"first"&lt;/span&gt;, _
			firstNamedStyle.Style).Style
		.Font.Bold = &lt;span style="color: blue;"&gt;True&lt;/span&gt;
		.Font.SetFromFont(&lt;span style="color: blue;"&gt;New&lt;/span&gt; Font(&lt;span style="color: rgb(163, 21, 21);"&gt;"Arial Black"&lt;/span&gt;, 8))
		.Border.Bottom.Style = Style.ExcelBorderStyle.Medium
		.Border.Left.Style = Style.ExcelBorderStyle.Medium
	&lt;span style="color: blue;"&gt;End&lt;/span&gt; &lt;span style="color: blue;"&gt;With&lt;/span&gt;

	wsSheet.Cells(&lt;span style="color: rgb(163, 21, 21);"&gt;"B2"&lt;/span&gt;).Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"Center"&lt;/span&gt;
	wsSheet.Cells(&lt;span style="color: rgb(163, 21, 21);"&gt;"B2"&lt;/span&gt;).StyleName = &lt;span style="color: rgb(163, 21, 21);"&gt;"first"&lt;/span&gt;

	excelFile.Save()

&lt;span style="color: blue;"&gt;Catch&lt;/span&gt; ex &lt;span style="color: blue;"&gt;As&lt;/span&gt; Exception
	Console.WriteLine(ex.Message)

	Console.Read()
&lt;span style="color: blue;"&gt;Finally&lt;/span&gt;
&lt;span style="color: blue;"&gt;End&lt;/span&gt; &lt;span style="color: blue;"&gt;Try&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;What am I doing wrong ?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="19/10/2011 07:05:18">
          <Html>
        
&lt;p&gt;I think this is a bug. Try the lates source and see if it works for you. Otherwise report it as an issue&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Any chance to get it work with compact framework?">
      <Posts>
        <Post From="jinge" When="10/10/2011 20:53:45">
          <Html>
        
&lt;p&gt;Everything in the title: Is there any chance to get it working using compact framework?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;I would like to be able to create or modify excel files on a windows mobile system.&lt;/p&gt;
&lt;p&gt;If somebody knows if it is possible :)&lt;/p&gt;
&lt;p&gt;Thanks in advance!&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="19/10/2011 06:39:08">
          <Html>
        
&lt;p&gt;I have not tried. If compact framework supports System.IO.Packaging it should be easy to fix. Otherwise it will be a hard time to fix.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Error reading a range after delete a row">
      <Posts>
        <Post From="jorgeolimpia" When="13/10/2011 15:35:51">
          <Html>
        
&lt;p&gt;Hello guys.&lt;/p&gt;
&lt;p&gt;I'm having a unusual problem with EPPlus and I'd like to share it with you, just to know if anybody has seen something like that.&lt;/p&gt;
&lt;p&gt;I'm trying to read a range in a spreadsheet, collecting all data in a DataTable. Everything was working fine until I deleted a row in a sheet. I just deleted the row but the range is still valid, because there are more rows in that sheet. The error is "Index
 was outside the bounds of the array."&lt;/p&gt;
&lt;p&gt;Do I need to rearrange the index in that spreadsheet? How can I do this?&lt;/p&gt;
&lt;p&gt;Regards,&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Jorge Olimpia&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="19/10/2011 06:32:39">
          <Html>
        
&lt;p&gt;Sounds like a bug. Create an issue and upload your template and some code to&amp;nbsp;reproduce the error,&amp;nbsp;so I can have a look at it.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Excel preview and Print">
      <Posts>
        <Post From="niban013" When="13/10/2011 14:13:02">
          <Html>
        
&lt;p&gt;HI ,ALL&lt;/p&gt;
&lt;p&gt;anyone knows how to preview and Print XLS when excel file has produced ,i had found all discussions in EPPlus.codeplex,&lt;/p&gt;
&lt;p&gt;if any gus knows, tell me how to do it , thank you very much&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="19/10/2011 06:28:11">
          <Html>
        
&lt;p&gt;This library only generates the xlsx files. To print or preview you have to use Excel or some other tool&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Load excel data to datatable">
      <Posts>
        <Post From="AdriRodriguez" When="13/10/2011 10:52:08">
          <Html>
        
&lt;p&gt;There's a way to load to datatable the excel data? I wanna show it on a datagridview.&lt;/p&gt;
&lt;p&gt;For example, this method should get an array data, but i can only gets an object from property call "value"&lt;/p&gt;
&lt;pre style="background: white; color: black; font-family: Consolas;"&gt;&lt;span style="color: blue;"&gt;int&lt;/span&gt;&amp;nbsp;maxRow=&amp;nbsp;package.Workbook.Worksheets[1].Dimension.End.Row;
&lt;span style="color: blue;"&gt;int&lt;/span&gt;&amp;nbsp;maxCol=&amp;nbsp;package.Workbook.Worksheets[1].Dimension.End.Column;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
&lt;span style="color: blue;"&gt;new&lt;/span&gt;&amp;nbsp;&lt;span style="color: rgb(43, 145, 175);"&gt;ExcelPackage&lt;/span&gt;(ExistingFile).Workbook.Worksheets[1].Cells[1,&amp;nbsp;1,&amp;nbsp;maxRow,&amp;nbsp;maxCol].Value
&lt;br&gt;&lt;br&gt;&lt;/pre&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="19/10/2011 06:25:07">
          <Html>
        
&lt;p&gt;You have to populate it cell by cell, or use Linq like in the samples.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Getting a range of columns for background color">
      <Posts>
        <Post From="msnetdev" When="17/10/2011 21:49:29">
          <Html>
        
&lt;p&gt;I would like to know how can I go about getting a range of columns inorder to modify the background color.&lt;/p&gt;
&lt;p&gt;My current code is:&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;            &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; excelPackage = &lt;span style="color: blue;"&gt;New&lt;/span&gt; OfficeOpenXml.ExcelPackage
            &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; excelWorksheet = excelPackage.Workbook.Worksheets.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"Employee-Record-"&lt;/span&gt; &amp;amp; DateTime.Now.Year &amp;amp; DateTime.Now.Month &amp;amp; DateTime.Now.Day)

            &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; colIndex &lt;span style="color: blue;"&gt;As&lt;/span&gt; &lt;span style="color: blue;"&gt;Integer&lt;/span&gt; = 1
            &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; rowIndex &lt;span style="color: blue;"&gt;As&lt;/span&gt; &lt;span style="color: blue;"&gt;Integer&lt;/span&gt; = 1

            &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; xlRow = excelWorksheet.Row(rowIndex)
            &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; xlCell = excelWorksheet.Cells(rowIndex, colIndex)

            &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; CellFill = xlCell.Style.Fill
            &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; RowFill = xlRow.Style.Fill

            CellFill.PatternType = ExcelFillStyle.Solid
            RowFill.PatternType = ExcelFillStyle.Solid
            RowFill.BackgroundColor.SetColor(Drawing.Color.DarkGray)
&lt;/pre&gt;
&lt;pre&gt;The above code is for one cell only.&lt;/pre&gt;
&lt;pre&gt;If I want to do (example) Row 2, Column A to Column E, how would I accomplish that?&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="TiSch" When="17/10/2011 22:32:34">
          <Html>
        
&lt;p&gt;I assume that i answered your question recently on &lt;a title="Stackoverflow: Logic to display excel background shade using asp.net &amp;amp; EPPlus" href="http://stackoverflow.com/questions/7798605/logic-to-display-excel-background-shade-using-asp-net-epplus/7799176&lt;a class=" workitemlink"=""&gt;#7799176&lt;/a&gt;" rel="nofollow"&amp;gt;
SO.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;So for the sake of completeness:&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;For&lt;/span&gt; row = workSheet.Dimension.Start.Row &lt;span style="color: blue;"&gt;To&lt;/span&gt; workSheet.Dimension.&lt;span style="color: blue;"&gt;End&lt;/span&gt;.Row
    &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; pos = row &lt;span style="color: blue;"&gt;Mod&lt;/span&gt; 3
    &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; rowRange = workSheet.Row(row)
    &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; RowFill = rowRange.Style.Fill
    RowFill.PatternType = ExcelFillStyle.Solid
    &lt;span style="color: blue;"&gt;Select&lt;/span&gt; &lt;span style="color: blue;"&gt;Case&lt;/span&gt; pos
        &lt;span style="color: blue;"&gt;Case&lt;/span&gt; 0
            RowFill.BackgroundColor.SetColor(Drawing.Color.LightGray)
        &lt;span style="color: blue;"&gt;Case&lt;/span&gt; 1
            RowFill.BackgroundColor.SetColor(Drawing.Color.DarkGray)
        &lt;span style="color: blue;"&gt;Case&lt;/span&gt; 2
            RowFill.BackgroundColor.SetColor(Drawing.Color.White)
    &lt;span style="color: blue;"&gt;End&lt;/span&gt; &lt;span style="color: blue;"&gt;Select&lt;/span&gt;
&lt;span style="color: blue;"&gt;Next&lt;/span&gt;

&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Add colorscale to a range">
      <Posts>
        <Post From="Stefanvds" When="04/10/2011 09:52:40">
          <Html>
        
&lt;p&gt;Does anyone know how to add a color scale to a range of columns? I've been searching around but cant find anything on this subject. is it even possible?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="04/10/2011 21:36:57">
          <Html>
        
&lt;p&gt;If you mean a gradiant fill it's not supported in the current version. I'll try to add it to the next version&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="stefanvds" When="04/10/2011 22:05:30">
          <Html>
        
&lt;p&gt;i'm not sure it is a gradient fill which i mean. what i mean is a range of numbers get each different background colors for example numbers ranging from 1 to 5 where 1 will be red, 2 will be lighter red, 3 orange, 4green, 5 dark green.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="09/10/2011 18:25:57">
          <Html>
        
&lt;p&gt;Ahh, you mean conditional&amp;nbsp;formatting. No, sorry, it's not implemented in the currnent version.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to have cell value act as a link">
      <Posts>
        <Post From="ntulip" When="30/09/2011 15:24:56">
          <Html>
        
&lt;p&gt;I build an excel file from &amp;nbsp;a datatable and need to convert all the links in a column to be clickable links. How can I achieve this?&lt;/p&gt;
&lt;p&gt;thank you&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="09/10/2011 18:24:05">
          <Html>
        
&lt;p&gt;Use the Range.Hyperlink property. Look at sample 3 and 6.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Populate Excel Template using Named Range">
      <Posts>
        <Post From="skocheta" When="30/09/2011 11:25:41">
          <Html>
        
&lt;p&gt;Hello,&lt;/p&gt;
&lt;p&gt;First of all , kudos to the wonderful library, great efforts :)&lt;/p&gt;
&lt;p&gt;I am working on an Office automation project which requires us to populate an existing Excel Template (XLSM) file using asp.net , generate graphs and Pull these graphs into a powerpoint presentation.&lt;/p&gt;
&lt;p&gt;We had earlier thought (and designed) working on this using interop DLL components, however though it gives a convenient development experience, we had to chuck the code since Server permissions for DCOM would (will) be an issue.&lt;/p&gt;
&lt;p&gt;We also explored &lt;strong&gt;Sharepoint Excel Services&lt;/strong&gt;, but even that gives the error:&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div id="imcontent"&gt;&lt;strong&gt;The workbook cannot be opened because it contains the following features that are not supported by Excel in the browser:&lt;br&gt;
&lt;br&gt;
• Data validation&lt;br&gt;
• Sheet protection&lt;/strong&gt;&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Issues with OpenXML (EPPlus):&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;1. We are trying to use named range to populate fields in excel, but the code fails on certain named range saying "&lt;strong&gt;The given key was not present in the dictionary."&lt;/strong&gt;. When I look at the&amp;nbsp;pck.Workbook.Names (where Pck is my Package),
 it has just 1857 values for definedNames, whereas the workbook.xml has approx 2012 Nodes.&lt;/p&gt;
&lt;p&gt;Please suggest what could be done in this regards.&lt;/p&gt;
&lt;p&gt;2. I downloaded the latest Source Code, added project reference to my existing application (trying to debug through the named range), but this throws exception:&lt;/p&gt;
&lt;p&gt;PackageRelationship with specified ID does not exist for the source part. &amp;nbsp; &amp;nbsp;at System.IO.Packaging.PackagePart.GetRelationship(String id)&amp;nbsp; &amp;nbsp;at OfficeOpenXml.ExcelWorksheet.LoadHyperLinks(XmlTextReader xr) in C:\ROI EPP\ExcelPackage\ExcelWorksheet.cs:line
 819&amp;nbsp; &amp;nbsp;at OfficeOpenXml.ExcelWorksheet.CreateXml() in C:\ROI EPP\ExcelPackage\ExcelWorksheet.cs:line 579&amp;nbsp; &amp;nbsp;at OfficeOpenXml.ExcelWorksheet..ctor(XmlNamespaceManager ns, ExcelPackage excelPackage, String relID, Uri uriWorksheet, String sheetName,
 Int32 sheetID, Int32 positionID, eWorkSheetHidden hide) in C:\ROI EPP\ExcelPackage\ExcelWorksheet.cs:line 184&amp;nbsp; &amp;nbsp;at OfficeOpenXml.ExcelWorksheets..ctor(ExcelPackage xlPackage) in C:\ROI EPP\ExcelPackage\ExcelWorksheets.cs:line 107&amp;nbsp; &amp;nbsp;at OfficeOpenXml.ExcelWorkbook.get_Worksheets()
 in C:\ROI EPP\ExcelPackage\ExcelWorkbook.cs:line 246&amp;nbsp; &amp;nbsp;at OfficeOpenXml.ExcelWorkbook.GetDefinedNames() in C:\ROI EPP\ExcelPackage\ExcelWorkbook.cs:line 227&amp;nbsp; &amp;nbsp;at OfficeOpenXml.ExcelPackage.get_Workbook() in C:\ROI EPP\ExcelPackage\ExcelPackage.cs:line
 493&amp;nbsp; &amp;nbsp;at TCOHelper.XMLToExcel(String UID, String SelectedSheet, String SelectedModule) in c:\ROI EPP\App_Code\TCOHelper_EPP.cs:line 333&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;AND&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;The 'worksheet' start tag on line 2 position 2 does not match the end tag of 'hyperlinks'. Line 2, position 1326. &amp;nbsp; &amp;nbsp;at System.Xml.XmlTextReaderImpl.Throw(Exception e)&amp;nbsp; &amp;nbsp;at System.Xml.XmlTextReaderImpl.Throw(String res, String[] args)&amp;nbsp;
 &amp;nbsp;at System.Xml.XmlTextReaderImpl.ThrowTagMismatch(NodeData startTag)&amp;nbsp; &amp;nbsp;at System.Xml.XmlTextReaderImpl.ParseEndElement()&amp;nbsp; &amp;nbsp;at System.Xml.XmlTextReaderImpl.ParseElementContent()&amp;nbsp; &amp;nbsp;at System.Xml.XmlTextReaderImpl.Read()&amp;nbsp;
 &amp;nbsp;at System.Xml.XmlLoader.LoadNode(Boolean skipOverWhitespace)&amp;nbsp; &amp;nbsp;at System.Xml.XmlLoader.LoadDocSequence(XmlDocument parentDoc)&amp;nbsp; &amp;nbsp;at System.Xml.XmlLoader.Load(XmlDocument doc, XmlReader reader, Boolean preserveWhitespace)&amp;nbsp; &amp;nbsp;at
 System.Xml.XmlDocument.Load(XmlReader reader)&amp;nbsp; &amp;nbsp;at System.Xml.XmlDocument.LoadXml(String xml)&amp;nbsp; &amp;nbsp;at OfficeOpenXml.ExcelWorksheet.CreateXml() in C:\ROI EPP\ExcelPackage\ExcelWorksheet.cs:line 590&amp;nbsp; &amp;nbsp;at OfficeOpenXml.ExcelWorksheet..ctor(XmlNamespaceManager
 ns, ExcelPackage excelPackage, String relID, Uri uriWorksheet, String sheetName, Int32 sheetID, Int32 positionID, eWorkSheetHidden hide) in C:\ROI EPP\ExcelPackage\ExcelWorksheet.cs:line 184&amp;nbsp; &amp;nbsp;at OfficeOpenXml.ExcelWorksheets..ctor(ExcelPackage xlPackage)
 in C:\ROI EPP\ExcelPackage\ExcelWorksheets.cs:line 107&amp;nbsp; &amp;nbsp;at OfficeOpenXml.ExcelWorkbook.get_Worksheets() in C:\ROI EPP\ExcelPackage\ExcelWorkbook.cs:line 246&amp;nbsp; &amp;nbsp;at OfficeOpenXml.ExcelWorkbook.GetDefinedNames() in C:\ROI EPP\ExcelPackage\ExcelWorkbook.cs:line
 227&amp;nbsp; &amp;nbsp;at OfficeOpenXml.ExcelPackage.get_Workbook() in C:\ROI EPP\ExcelPackage\ExcelPackage.cs:line 493&amp;nbsp; &amp;nbsp;at TCOHelper.XMLToExcel(String UID, String SelectedSheet, String SelectedModule) in c:\ROI EPP\App_Code\TCOHelper_EPP.cs:line 333&lt;strong&gt;&lt;br&gt;
&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;3. I need a way via which I can export My Excel Chart to&amp;nbsp;PowerPoint&amp;nbsp;(can't use Copy Paste on Server programatically).&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Any guidance and help would be greatly appreciated.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="04/10/2011 21:32:31">
          <Html>
        
&lt;p&gt;I cant say what the problem is unless I have your template. You mail the file to
&lt;a href="mailto:epplusdocs@gmail.com" rel="nofollow"&gt;epplusdocs@gmail.com&lt;/a&gt;&amp;nbsp;or create an issue and upload it.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Access data in an ExcelNamedRange">
      <Posts>
        <Post From="princecharles23" When="02/03/2011 10:56:44">
          <Html>
        
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre style="color: black;"&gt;&lt;span style="color: blue;"&gt;hi!&lt;/span&gt;&lt;/pre&gt;
&lt;pre style="color: black;"&gt;&lt;span style="color: blue;"&gt;&lt;br&gt;&lt;/span&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;span style="color: rgb(0, 0, 255);"&gt;I just wanted to perform a (imho) very trivial task:&lt;/span&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;span style="color: rgb(0, 0, 255);"&gt;I have data in an named range that I dont know the dimensions of (kinda the reason for a named range) and i just want to access this data in a table formed (i.e. rows/columns) way.&lt;/span&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;span style="color: rgb(0, 0, 255);"&gt;any hints?&lt;/span&gt;&lt;/pre&gt;
&lt;pre style="color: black;"&gt;&lt;span style="color: blue;"&gt;&lt;br&gt;&lt;/span&gt;&lt;/pre&gt;
&lt;pre style="color: black;"&gt;&lt;span style="color: blue;"&gt;using&lt;/span&gt; (ExcelPackage xlPackage = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(&lt;span style="color: blue;"&gt;new&lt;/span&gt; FileInfo(ExcelFilePath)))
{
	ExcelNamedRange er = xlPackage.Workbook.Names[&lt;span style="color: rgb(163, 21, 21);"&gt;"Data"&lt;/span&gt;];
	&lt;span style="color: green;"&gt;// how to access data in a table formed way?&lt;/span&gt;

	&lt;span style="color: green;"&gt;// throws randomly System.AccessViolationException when debugging and there is no information when a new "row" has begun&lt;/span&gt;
	&lt;span style="color: blue;"&gt;foreach&lt;/span&gt; (&lt;span style="color: blue;"&gt;var&lt;/span&gt; x &lt;span style="color: blue;"&gt;in&lt;/span&gt; er)
	{
		Console.WriteLine(x);
	}
}

&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="03/03/2011 15:42:17">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Not sure why this is not working for you.&lt;/p&gt;
&lt;p&gt;Check that your name reference an address in the workbook (names referencing&amp;nbsp;external workbooks, containg&amp;nbsp;formulas or a values are not supported in version 2.8.0.2).&lt;/p&gt;
&lt;p&gt;To get the Address/row/column&amp;nbsp;use the Address, Start.Row/Start.Column and ﻿End.Row/End.Column properties.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="princecharles23" When="08/03/2011 11:20:48">
          <Html>
        
&lt;p&gt;the following code (thx to the hint) works like i want it to - even though i have to loop over the NamedRange and use the Address to get the value out of the worksheet.Cells collection&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;ExcelNamedRange namedRange = xlPackage.Workbook.Names[&lt;span style="color: rgb(163, 21, 21);"&gt;"Data"&lt;/span&gt;];
&lt;span style="color: blue;"&gt;for&lt;/span&gt; (rowIndex = namedRange.Start.Row + 1; rowIndex &amp;lt;= namedRange.End.Row; rowIndex++)
{
	&lt;span style="color: blue;"&gt;for&lt;/span&gt; (columnIndex = namedRange.Start.Column + 1; columnIndex &amp;lt;= namedRange.End.Column; columnIndex++)
	{
		cellValue = worksheet.Cells[rowIndex, columnIndex].Value;
	}
}
&lt;/pre&gt;
&lt;pre&gt;&lt;br&gt;&lt;/pre&gt;
&lt;pre&gt;thx!&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="skocheta" When="30/09/2011 12:09:00">
          <Html>
        
&lt;p&gt;Hi Jan,&lt;/p&gt;
&lt;p&gt;Please let me know when you get a fix for this issue, I have made a separate post on the same issue at :&amp;nbsp;&lt;a title="http://epplus.codeplex.com/discussions/274360" href="http://epplus.codeplex.com/discussions/274360" target="_blank" rel="nofollow"&gt;http://epplus.codeplex.com/discussions/274360&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;I am using the latest build, and the Named Range are randomly stripped off values (eg. I have 2012 Naed range, but only 1876 are populated in Names in alphabetical order).&lt;/p&gt;
&lt;p&gt;Some of the fields that go missing are of type dropdown (using DataValidation List). and some have default value set (example Company Name field reads (Enter Company Name))&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Please Suggest.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Error when reading worksheet from template">
      <Posts>
        <Post From="blackmask" When="17/02/2011 09:19:23">
          <Html>
        
&lt;p&gt;Hi All,&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; I am trying to read a xlsx template in a loop for some data processing. I am able to load the the template some times and process data and save the new excel(xlsx)
 with a file name. How ever some times the statement below throws up a &lt;strong&gt;object reference not set to an instance&amp;nbsp;error
&lt;/strong&gt;as shown below :&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Statement throwing the error:&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Dim ExcelWSSummary As ExcelWorksheet = pckTemplate.Workbook.Worksheets(1)&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Error Description:&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Object reference not set to an instance&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Stack Trace Information :&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;at OfficeOpenXml.ExcelRangeBase..ctor(ExcelWorksheet xlWorksheet, String address)&lt;br&gt;
&amp;nbsp;&amp;nbsp; at OfficeOpenXml.ExcelWorkbook.GetDefinedNames()&lt;br&gt;
&amp;nbsp;&amp;nbsp; at OfficeOpenXml.ExcelPackage.get_Workbook()&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;HResult - -2147467261&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;_______________________________________________________________________________________________________________&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Code snippet:&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;For i= 5 To 10&lt;/p&gt;
&lt;p&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Dim objNewFile As New FileInfo("c:\test" &amp;amp; i.ToString() &amp;amp; ".xlsx")&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Dim objTemplate As New FileInfo("c:\Template.xlsx")&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Dim pckTemplate As New ExcelPackage(objNewFile, objTemplate)&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Dim ExcelWSSummary As ExcelWorksheet = pckTemplate.Workbook.Worksheets(1)&amp;nbsp;&amp;nbsp; -&amp;nbsp;&amp;nbsp;&lt;strong&gt;(This is where the error occurs&amp;nbsp;)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 'Do some processing here&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 'Save the file through pckTemplate.Save()&lt;/p&gt;
&lt;p&gt;Next i&lt;/p&gt;
&lt;p&gt;&amp;nbsp;Appreciate any inputs on the same.&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="17/02/2011 19:30:46">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Version 2.8 can't read templates with Defined names that reference a Value, formula or an external cell address.&lt;/p&gt;
&lt;p&gt;I have added a fix for this in the latest source --&amp;gt; tags/v2.8.0.1 (it will remove names it can't handle).&lt;/p&gt;
&lt;p&gt;Next version will be able to handle this kind of names.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="skocheta" When="30/09/2011 12:05:45">
          <Html>
        
&lt;p&gt;Hi Jan,&lt;/p&gt;
&lt;p&gt;Please let me know when you get a fix for this issue, I have made a separate post on the same issue at :&amp;nbsp;&lt;a title="http://epplus.codeplex.com/discussions/274360" href="http://epplus.codeplex.com/discussions/274360" target="_blank" rel="nofollow"&gt;http://epplus.codeplex.com/discussions/274360&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;I am using the latest build, and the Named Range are randomly stripped off values (eg. I have 2012 Naed range, but only 1876 are populated in Names).&lt;/p&gt;
&lt;p&gt;Some of the fields that go missing are of type dropdown (using DataValidation List). and some have default value set (example Company Name field reads (Enter Company Name))&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Please Suggest.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="how to quickly read a xlsx using epplus?">
      <Posts>
        <Post From="hekucn" When="22/09/2011 09:42:54">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I want to read a .xlsx file to a dataset , but i don`t find any way but cell by cell .&lt;/p&gt;
&lt;p&gt;Is there a method to do it quickly?&lt;/p&gt;
&lt;p&gt;thanks!&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="hekucn" When="27/09/2011 02:31:35">
          <Html>
        
&lt;p&gt;Can nobody help me?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="27/09/2011 15:40:48">
          <Html>
        
&lt;p&gt;No, that's the way to do it&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="hekucn" When="28/09/2011 01:44:28">
          <Html>
        
&lt;blockquote style="margin: 0.25em 1em 0px; padding: 0px 0.25em; border: 0.1em solid rgb(204, 204, 204); border-image: none; font-style: italic;"&gt;
&lt;strong&gt;JanKallman wrote:&lt;/strong&gt;&lt;br&gt;
&lt;p&gt;No, that's the way to do it&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Thanks!&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Need help in Subtotals">
      <Posts>
        <Post From="kartookforyou" When="20/09/2011 23:28:52">
          <Html>
        
&lt;p&gt;I am very new to EPPlus. Just i want to know how to do the Subtotals function in EPPlus.&lt;/p&gt;
&lt;p&gt;Date&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Name&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Earnings&lt;/p&gt;
&lt;p&gt;9/19/2011&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; A&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 10&lt;/p&gt;
&lt;p&gt;9/20/2011&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; A&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 20&lt;/p&gt;
&lt;p&gt;9/21/2011&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; A&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 30&lt;/p&gt;
&lt;p&gt;9/19/2011&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; B&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 25&lt;/p&gt;
&lt;p&gt;9/21/2011&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; B&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 50&lt;/p&gt;
&lt;p&gt;I want results like&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Date&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Name&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Earnings&lt;/p&gt;
&lt;p&gt;9/19/2011&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; A&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 10&lt;/p&gt;
&lt;p&gt;9/20/2011&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; A&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 20&lt;/p&gt;
&lt;p&gt;9/21/2011&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; A&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 30&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; A Total&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 60&lt;/p&gt;
&lt;p&gt;9/19/2011&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; B&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 25&lt;/p&gt;
&lt;p&gt;9/21/2011&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; B&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 50&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; B&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 75&lt;/p&gt;
&lt;p&gt;and if possible i need Grand Total for all Earnings.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks,&lt;/p&gt;
&lt;p&gt;Kartook&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="27/09/2011 15:42:12">
          <Html>
        
&lt;p&gt;Have a look at sample 6.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Speed up printing to DataGridView">
      <Posts>
        <Post From="leeharrison1984" When="13/09/2011 21:20:56">
          <Html>
        
&lt;p&gt;I am importing a spreadsheet that is roughly 30co x 1500ro. It around 15 seconds to import the entire thing into the actual datagrid, which seems glacial to me.&amp;nbsp; Is this type of performance typical, or can it be optimized through code?&lt;/p&gt;
&lt;p&gt;here's how i am doing it:&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;void&lt;/span&gt; PopulatePreviewWindow()
        {
            FileInfo existingFile = &lt;span style="color: blue;"&gt;new&lt;/span&gt; FileInfo(txtExcelLoc.Text);
            &lt;span style="color: blue;"&gt;using&lt;/span&gt; (ExcelPackage package = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(existingFile))
            {
                ExcelWorksheet worksheet = package.Workbook.Worksheets[1];
                &lt;span style="color: blue;"&gt;int&lt;/span&gt; TotalColumns = worksheet.Dimension.End.Column;
                &lt;span style="color: blue;"&gt;int&lt;/span&gt; TotalRows = worksheet.Dimension.End.Row;
                &lt;span style="color: blue;"&gt;for&lt;/span&gt; (&lt;span style="color: blue;"&gt;int&lt;/span&gt; col = 0; col &amp;lt; TotalColumns; col++)
                {
                    dgvPreview.Columns.Add(worksheet.Cells[1, (col+1)].Value.ToString(), worksheet.Cells[1, (col+1)].Value.ToString());
                }
                dgvPreview.RowCount = TotalRows;
                &lt;span style="color: blue;"&gt;for&lt;/span&gt; (&lt;span style="color: blue;"&gt;int&lt;/span&gt; row = 1; row &amp;lt; TotalRows; row++)
                {
                    &lt;span style="color: blue;"&gt;for&lt;/span&gt; (&lt;span style="color: blue;"&gt;int&lt;/span&gt; col = 0; col &amp;lt; TotalColumns; col++)
                    {
                        &lt;span style="color: blue;"&gt;try&lt;/span&gt;
                        {
                            dgvPreview[col, row].Value = worksheet.Cells[(row + 1), (col + 1)].Value.ToString();
                        }
                        &lt;span style="color: blue;"&gt;catch&lt;/span&gt;
                        {
                            dgvPreview[col, row].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;" "&lt;/span&gt;;
                        }
                    }
                }
	}
}
&lt;/pre&gt;
&lt;pre&gt;I am still new to C# coding, so this probably isn't the best implementation, but if it can be made to work more quickly, please explain how(and why). &lt;/pre&gt;
&lt;pre&gt;Also, the try/catch is in place because there are some images in these spreadsheets, and they were causing crashes.&lt;/pre&gt;
&lt;pre&gt;*edit* Nevermind, i figured it out. The try/catch was slowing it down.  Changed it to an if statement and now the sheet loads in less than a second.&lt;/pre&gt;
&lt;pre&gt;lee&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div id="_mcePaste" style="left: -10000px; top: 0px; width: 1px; height: 1px; overflow: hidden;"&gt;
﻿&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="kartookforyou" When="21/09/2011 17:38:37">
          <Html>
        
&lt;p&gt;Try to export your Excel data to a DataTable and Bind the DataTable to DataGrid&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="how to quickly copy columns using epplus?">
      <Posts>
        <Post From="gl321" When="02/09/2011 03:43:09">
          <Html>
        
&lt;p&gt;Hi,&lt;br&gt;
I want to move columns (eg. from column H --&amp;gt; column B) and each column has many cells.
&lt;br&gt;
my current method is to copy cell by cell:&lt;br&gt;
new_sheet.cells[i,new_col].value=old_sheet.cells[i,old_col];&lt;br&gt;
or .copy method&lt;/p&gt;
&lt;p&gt;&lt;br&gt;
But it acts far too slow&lt;br&gt;
Is there any solution much quicker? like copy an entire column to another sheet?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="20/09/2011 20:48:27">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;You can use the Range.Copy method, but it will still be slow.&lt;/p&gt;
&lt;p&gt;The problem is that when you copy cells by column the internal index will have to sort for every cell with the current desigen. So the best approch is to load a cell from Left to right, up to down.&lt;/p&gt;
&lt;p&gt;A workaround, if you know the number of columns to be created is to make sure the cells are created before you start to copying.&lt;/p&gt;
&lt;p&gt;You can do something like this (the address is just an example)...&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;Worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A1:Q1000"&lt;/span&gt;].Value=&lt;span style="color: blue;"&gt;null&lt;/span&gt;;
&lt;/pre&gt;
&lt;pre&gt;Not very pretty, but should make the copy faster.&lt;/pre&gt;
&lt;pre&gt;Jan&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Exception thrown while executing Worksheet.InsertRow">
      <Posts>
        <Post From="icareo" When="05/09/2011 12:06:33">
          <Html>
        
&lt;p&gt;I am using a templated xlsx with a formula like =SUM(A12:A15)&lt;/p&gt;
&lt;p&gt;While trying to insert a row between 13th &amp;amp; 14th row, Worksheet.InsertRow is throwing the exception :&lt;/p&gt;
&lt;p&gt;System.ArgumentOutOfRangeException : Start cell Address must be less or equal to End cell address&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp; à OfficeOpenXml.ExcelAddressBase.Validate()&lt;br&gt;
&amp;nbsp;&amp;nbsp; à OfficeOpenXml.ExcelAddressBase.SetAddress(String address)&lt;br&gt;
&amp;nbsp;&amp;nbsp; à OfficeOpenXml.ExcelAddress.set_Address(String value)&lt;br&gt;
&amp;nbsp;&amp;nbsp; à OfficeOpenXml.ExcelRange.get_Item(String Address)&lt;br&gt;
&amp;nbsp;&amp;nbsp; à OfficeOpenXml.ExcelWorksheet.AddFormulas(List`1 added, Int32 position, Int32 rows)&lt;br&gt;
&amp;nbsp;&amp;nbsp; à OfficeOpenXml.ExcelWorksheet.FixSharedFormulasRows(Int32 position, Int32 rows)&lt;br&gt;
&amp;nbsp;&amp;nbsp; à OfficeOpenXml.ExcelWorksheet.InsertRow(Int32 rowFrom, Int32 rows, Int32 copyStylesFromRow)&lt;br&gt;
&amp;nbsp;&amp;nbsp; à OfficeOpenXml.ExcelWorksheet.InsertRow(Int32 rowFrom, Int32 rows)&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Could I avoid this annoying error ?&lt;/p&gt;
&lt;p&gt;Thanks for all !&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;EDIT : &lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;I cannot reproduce this error on a simple example. See&lt;a href="http://icareo.free.fr/error_insertrow.html" target="_blank" rel="nofollow"&gt;
&lt;/a&gt;&lt;/strong&gt;&lt;a href="http://icareo.free.fr/error_insertrow.html" target="_blank" rel="nofollow"&gt;&lt;strong&gt;this link&lt;/strong&gt;&lt;/a&gt;
&lt;strong&gt;to reproduce this error&lt;/strong&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="icareo" When="08/09/2011 08:21:56">
          <Html>
        
&lt;p&gt;Solved my problem creating my own formula shifting algorithm.&lt;/p&gt;
&lt;p&gt;- Copy formulas&lt;/p&gt;
&lt;p&gt;- Clear formulas from the sheet&lt;/p&gt;
&lt;p&gt;- Insert rows doing ExcelRange.Copy then ExcelRange.Clear&lt;/p&gt;
&lt;p&gt;- Parse and shift formulas (the tricky part)&lt;/p&gt;
&lt;p&gt;- Paste formulas&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;For your information : There where also some issues with shared formulas.&lt;br&gt;
i.e. : If you have a formula in a cell (lets call it A) referencing another formula which is a B cell, then if you clear B cell, the A cell formula will be transformed to match the old B's one...&lt;br&gt;
This was a pretty unexpected behavior which has barely turned me mad !&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mjslane" When="08/09/2011 14:47:19">
          <Html>
        
&lt;p&gt;I'm having a lot of problems with formulas too. &amp;nbsp;The code for handling inserts in EPPlus is pretty buggy when updating formulas.&amp;nbsp; Would you be willing to post the code to your solution? &amp;nbsp;I did take a look at the code with the intention of
 fixing it, but it was too much work for the time I had. &amp;nbsp;This is going to be a major problem for me soon, currently I'm ignoring it while I work on other areas of my project...&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="icareo" When="08/09/2011 15:24:03">
          <Html>
        
&lt;p&gt;Of course...&lt;/p&gt;
&lt;p&gt;Its a simple and dirty solution which may involve many problems for complex cases such as graphs, very big workbooks and others...&lt;/p&gt;
&lt;p&gt;But it works great for me.&lt;/p&gt;
&lt;p&gt;Usage :&lt;/p&gt;
&lt;p&gt;first, you should add a "using Reports.Extend;"&lt;br&gt;
Then , use : "myExcelWorksheet.InsertRowsAfter(rowNumber,rowCount)"&lt;/p&gt;
&lt;p&gt;Formulas are quickly parsed to find references to moved cells, deleted then recreated with updated formulas (after row insertion)&lt;/p&gt;
&lt;p&gt;here are the sources : &lt;a href="http://icareo.free.fr/Extend.zip" rel="nofollow"&gt;http://icareo.free.fr/Extend.zip&lt;/a&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="icareo" When="08/09/2011 18:44:47">
          <Html>
        
&lt;p&gt;btw ... there was also an issue related to cell merging : I could achieve to unmerge cells, but merging (via ws.Cells[string].Merged = true)&amp;nbsp; throws an exception (sth like "cells already merged" ... i dont remember)&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="20/09/2011 20:40:03">
          <Html>
        
&lt;p&gt;Thanks for reporting it. I'll have a look.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="EPPlus to accept richtext format">
      <Posts>
        <Post From="stjom" When="19/09/2011 09:01:09">
          <Html>
        
&lt;p&gt;Hello everyone!&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;what i'm trying to achieve is to print to excel an html source, but since html tags aren't supported by EPPlus, the nearest thing i could do is to parse the html into RTF format. Can anybody give me an idea as to how I can achieve this?&lt;/p&gt;
&lt;p&gt;thanks!&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;is there something like:&lt;/p&gt;
&lt;p&gt;Dim file As System.IO.FileInfo = New System.IO.FileInfo(location + "\myXL.xlsx")&lt;br&gt;
Using xlPackage As OfficeOpenXml.ExcelPackage = New OfficeOpenXml.ExcelPackage(file)&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;span style="white-space: pre;"&gt;&amp;nbsp;&lt;/span&gt;Dim wSheet As OfficeOpenXml.ExcelWorksheet = xlPackage.Workbook.Worksheets("sheet1")&lt;/p&gt;
&lt;p&gt;&lt;span style="white-space: pre;"&gt;&amp;nbsp;&lt;/span&gt;wSheet.Cells(11, 11).RTFValue = "{\field{*\fldinst{HYPERLINK ""http://www.google.com""}}{\fldrslt{http://www.google.com}}"&lt;/p&gt;
&lt;p&gt;&lt;span style="white-space: pre;"&gt;xlPackage.Save()&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;end using&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;thanks!&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="20/09/2011 20:08:43">
          <Html>
        
&lt;p&gt;No support for that. If you must do it you have to translate the html tags to each style/hyperlink in EPPlus.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="What  IsRichText Property does?">
      <Posts>
        <Post From="pankajlohani" When="30/03/2010 14:54:07">
          <Html>
        
&lt;p&gt;What&amp;nbsp; IsRichText property does?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="30/03/2010 15:47:25">
          <Html>
        
&lt;p&gt;:-) ok you really want to do this...&lt;/p&gt;
&lt;p&gt;I really don't recommend this at all but, you can try...&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;            ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;].IsRichText = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
            ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"&amp;lt;r&amp;gt;&amp;lt;rPr&amp;gt;&amp;lt;sz val=\"11\" /&amp;gt;&amp;lt;color rgb=\"FFFF0000\" /&amp;gt;&amp;lt;rFont val=\"Calibri\" /&amp;gt;&amp;lt;family val=\"2\" /&amp;gt;&amp;lt;scheme val=\"minor\" /&amp;gt;&amp;lt;/rPr&amp;gt;&amp;lt;t&amp;gt;te&amp;lt;/t&amp;gt;&amp;lt;/r&amp;gt;&amp;lt;r&amp;gt;&amp;lt;rPr&amp;gt;&amp;lt;b /&amp;gt;&amp;lt;sz val=\"11\" /&amp;gt; &amp;lt;color theme=\"1\" /&amp;gt;&amp;lt;rFont val=\"Calibri\" /&amp;gt;&amp;lt;family val=\"2\" /&amp;gt; &amp;lt;scheme val=\"minor\" /&amp;gt; &amp;lt;/rPr&amp;gt;&amp;lt;t&amp;gt;st&amp;lt;/t&amp;gt; &amp;lt;/r&amp;gt;"&lt;/span&gt;;

You have to be really carefull here. This is the raw format. If you get it wrong the sheet will be corruppted. &lt;/pre&gt;
&lt;pre&gt;I will proberbly do something to support rich text in the future, so this behavior will change.&lt;/pre&gt;
&lt;pre&gt;I cant give you any more that that, the rest you have to figure out yourself&lt;/pre&gt;
&lt;pre&gt;Jan&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="juxtaposed" When="29/09/2010 22:39:38">
          <Html>
        
&lt;p&gt;Thanks for the info, Jan. I was looking for this functionality specifically. I need format text in a single cell where some of the text is italic, while other text is bold. I look forward to any updates for rich text support.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="30/09/2010 07:16:45">
          <Html>
        
&lt;p&gt;From 2.7.0.1, use the RichText property instead, like in Sample 6...&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;            &lt;span style="color: green;"&gt;//Use the RichText property to change the font for the directory part of the cell&lt;/span&gt;
            &lt;span style="color: blue;"&gt;var&lt;/span&gt; rtDir = ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;].RichText.Add(dir);
            rtDir.FontName = &lt;span style="color: rgb(163, 21, 21);"&gt;"Consolas"&lt;/span&gt;;
            rtDir.Size=18;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="rwilkin" When="02/04/2011 08:52:53">
          <Html>
        
&lt;p&gt;I know this is old, but it looks similar to what I'm after.&lt;/p&gt;
&lt;p&gt;I want to have 2 or 3 different colours of text in the same cell.&lt;/p&gt;
&lt;p&gt;I'm using it in a for loop that checks the value of a variable and puts it into a cell.&lt;/p&gt;
&lt;p&gt;So the value might be 'Red' so It add's that to cell A12 with a red colour. The next loop might be blue, so it will add 'Blue' to the cell A12 in a blue colour.&lt;/p&gt;
&lt;p&gt;The Cell A12 would now say "Red Blue" with red being red and blue being blue.&lt;/p&gt;
&lt;p&gt;Would using the RichText property allow me to do this&lt;br&gt;
? and if it will, can you please provide me with an example?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="03/04/2011 19:20:55">
          <Html>
        
&lt;p&gt;Have a look at sample 6.&lt;/p&gt;
&lt;p&gt;This is for a comment but it works very similar for cells...&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt; &lt;span style="color: green;"&gt;//Format the code using the RichText Collection&lt;/span&gt;
            &lt;span style="color: blue;"&gt;var&lt;/span&gt; rc = comment.RichText.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"//Format the Size and Count column\r\n"&lt;/span&gt;);
            rc.FontName = &lt;span style="color: rgb(163, 21, 21);"&gt;"Courier New"&lt;/span&gt;;
            rc.Color = Color.FromArgb(0, 128, 0);
            rc = comment.RichText.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"ws.Cells["&lt;/span&gt;);
            rc.Color = Color.Black;
            rc = comment.RichText.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"\"B3:B42\""&lt;/span&gt;);
            rc.Color = Color.FromArgb(123, 21, 21);
            rc = comment.RichText.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"].Style.Numberformat.Format = "&lt;/span&gt;);
            rc.Color = Color.Black;
            rc = comment.RichText.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"\"#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;\""&lt;/span&gt;);
            rc.Color = Color.FromArgb(123, 21, 21);
            rc = comment.RichText.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;";"&lt;/span&gt;);
            rc.Color = Color.Black;

&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="rwilkin" When="07/04/2011 06:52:32">
          <Html>
        
&lt;p&gt;Thank you for that Jankallman. I will try it as soon as I can and let you know how I go :)&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="stjom" When="14/09/2011 10:26:15">
          <Html>
        
&lt;blockquote style="margin: 0.25em 1em 0px; padding: 0px 0.25em; border: 0.1em solid rgb(204, 204, 204); border-image: none; font-style: italic;"&gt;
&lt;strong&gt;jankallman wrote:&lt;/strong&gt;&lt;br&gt;
&lt;p&gt;:-) ok you really want to do this...&lt;/p&gt;
&lt;p&gt;I really don't recommend this at all but, you can try...&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;            ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;].IsRichText = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
            ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"&amp;lt;r&amp;gt;&amp;lt;rPr&amp;gt;&amp;lt;sz val=\"11\" /&amp;gt;&amp;lt;color rgb=\"FFFF0000\" /&amp;gt;&amp;lt;rFont val=\"Calibri\" /&amp;gt;&amp;lt;family val=\"2\" /&amp;gt;&amp;lt;scheme val=\"minor\" /&amp;gt;&amp;lt;/rPr&amp;gt;&amp;lt;t&amp;gt;te&amp;lt;/t&amp;gt;&amp;lt;/r&amp;gt;&amp;lt;r&amp;gt;&amp;lt;rPr&amp;gt;&amp;lt;b /&amp;gt;&amp;lt;sz val=\"11\" /&amp;gt; &amp;lt;color theme=\"1\" /&amp;gt;&amp;lt;rFont val=\"Calibri\" /&amp;gt;&amp;lt;family val=\"2\" /&amp;gt; &amp;lt;scheme val=\"minor\" /&amp;gt; &amp;lt;/rPr&amp;gt;&amp;lt;t&amp;gt;st&amp;lt;/t&amp;gt; &amp;lt;/r&amp;gt;"&lt;/span&gt;;

You have to be really carefull here. This is the raw format. If you get it wrong the sheet will be corruppted. &lt;/pre&gt;
&lt;pre&gt;I will proberbly do something to support rich text in the future, so this behavior will change.&lt;/pre&gt;
&lt;pre&gt;I cant give you any more that that, the rest you have to figure out yourself&lt;/pre&gt;
&lt;pre&gt;Jan&lt;/pre&gt;
&lt;/div&gt;
&lt;/blockquote&gt;
&lt;p&gt;Hello, I would like to make this work but i cant. The resulting file displays the tags. Can anybody point me to the right direction? Below is my code:&lt;/p&gt;
&lt;p&gt;Protected Sub btnImport_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles btnImport.Click&lt;/p&gt;
&lt;p&gt;&lt;span style="white-space: pre;"&gt;&lt;/span&gt;Dim location = Server.MapPath("Temp")&lt;/p&gt;
&lt;p&gt;&lt;span style="white-space: pre;"&gt;&lt;/span&gt;Dim file As System.IO.FileInfo = New System.IO.FileInfo(location + "\Import.xlsm")&lt;br&gt;
&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; Using xlPackage As OfficeOpenXml.ExcelPackage = New OfficeOpenXml.ExcelPackage(file)&lt;/p&gt;
&lt;p&gt;&lt;span style="white-space: pre;"&gt;Dim wSheet As OfficeOpenXml.ExcelWorksheet = xlPackage.Workbook.Worksheets("Scorecard")&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="white-space: pre;"&gt;wSheet.Cells(11, 11).IsRichText = True&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;
&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="white-space: pre;"&gt;wSheet.Cells(11, 11).Value = Nothing&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;
&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="white-space: pre;"&gt;wSheet.Cells(11, 11).Value = "&amp;lt;r&amp;gt;&amp;lt;rPr&amp;gt;&amp;lt;sz val=""11"" /&amp;gt;&amp;lt;color rgb=""FFFF0000"" /&amp;gt;&amp;lt;rFont val=""Calibri"" /&amp;gt;&amp;lt;family val=""2"" /&amp;gt;&amp;lt;scheme val=""minor"" /&amp;gt;&amp;lt;/rPr&amp;gt;&amp;lt;t&amp;gt;te&amp;lt;/t&amp;gt;&amp;lt;/r&amp;gt;&amp;lt;r&amp;gt;&amp;lt;rPr&amp;gt;&amp;lt;b
 /&amp;gt;&amp;lt;sz val=""11"" /&amp;gt; &amp;lt;color theme=""1"" /&amp;gt;&amp;lt;rFont val=""Calibri"" /&amp;gt;&amp;lt;family val=""2"" /&amp;gt; &amp;lt;scheme val=""minor"" /&amp;gt; &amp;lt;/rPr&amp;gt;&amp;lt;t&amp;gt;st&amp;lt;/t&amp;gt; &amp;lt;/r&amp;gt;"&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="white-space: pre;"&gt;xlPackage.Save()&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;
&lt;/p&gt;
&lt;p&gt;&lt;span style="white-space: pre;"&gt;End Using&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="white-space: pre;"&gt;E&lt;/span&gt;nd Sub&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="stjom" When="14/09/2011 10:28:26">
          <Html>
        
&lt;p&gt;what i'm trying to achieve is to print to excel an html source, but since html tags aren't supported by EPPlus, the nearest thing i could do is to parse the html into RTF format. Can anybody give me an idea as to how I can achieve this? thanks!&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="creating merged cells to display hierarchical data">
      <Posts>
        <Post From="kiranb" When="09/09/2011 14:01:56">
          <Html>
        
&lt;p&gt;I've followig classes&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;class&lt;/span&gt; Person
    {
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; Name { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;int&lt;/span&gt; Age { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; } 

        &lt;span style="color: blue;"&gt;private&lt;/span&gt; IList&amp;lt;Child&amp;gt; _children;
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; IList&amp;lt;Child&amp;gt; Children
        {
            &lt;span style="color: blue;"&gt;get&lt;/span&gt;;
            &lt;span style="color: blue;"&gt;set&lt;/span&gt;;
        }
    }
    &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;class&lt;/span&gt; Child {
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; Name { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; }
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;int&lt;/span&gt; Age { &lt;span style="color: blue;"&gt;get&lt;/span&gt;; &lt;span style="color: blue;"&gt;set&lt;/span&gt;; } 
    }
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;How can I generate a excel file looks like below?&amp;nbsp;&lt;/p&gt;
&lt;table style="border: 1px solid black; border-image: none;" border="1" rules="all" cellspacing="1" cellpadding="1"&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style="border: 1px solid black; border-image: none;"&gt;&lt;strong&gt;Parent&lt;/strong&gt;&lt;/td&gt;
&lt;td style="border: 1px solid black; border-image: none;"&gt;&lt;strong&gt;Age&lt;/strong&gt;&lt;/td&gt;
&lt;td style="border: 1px solid black; border-image: none;"&gt;&lt;strong&gt;Child Name&lt;/strong&gt;&lt;/td&gt;
&lt;td style="border: 1px solid black; border-image: none;"&gt;&lt;strong&gt;Child Age&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="border: 1px solid black; border-image: none;" rowspan="2"&gt;parent 1&lt;/td&gt;
&lt;td style="border: 1px solid black; border-image: none;" rowspan="2"&gt;60&lt;/td&gt;
&lt;td style="border: 1px solid black; border-image: none;"&gt;Child 1&lt;/td&gt;
&lt;td style="border: 1px solid black; border-image: none;"&gt;20&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="border: 1px solid black; border-image: none;"&gt;Child 2&lt;/td&gt;
&lt;td style="border: 1px solid black; border-image: none;"&gt;18&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="border: 1px solid black; border-image: none;" rowspan="2"&gt;Parent 2&lt;/td&gt;
&lt;td style="border: 1px solid black; border-image: none;" rowspan="2"&gt;58&lt;/td&gt;
&lt;td style="border: 1px solid black; border-image: none;"&gt;Child 21&lt;/td&gt;
&lt;td style="border: 1px solid black; border-image: none;"&gt;15&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="border: 1px solid black; border-image: none;"&gt;Child 22&lt;/td&gt;
&lt;td style="border: 1px solid black; border-image: none;"&gt;12&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;i tried following method, but it fails:&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;div style="color: black; background-color: white;"&gt;&lt;pre&gt;List&amp;lt;Person&amp;gt; pp = &lt;span style="color: blue;"&gt;new&lt;/span&gt; List&amp;lt;Person&amp;gt;(); &lt;/pre&gt;
&lt;pre&gt;&lt;span style="color: green;"&gt;//add some persons data in pp here &lt;/span&gt; &lt;/pre&gt;
&lt;pre&gt;excelWorksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;].LoadFromCollection&amp;lt;Person&amp;gt;(pp, &lt;span style="color: blue;"&gt;true&lt;/span&gt;);&lt;/pre&gt;
&lt;/div&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="09/09/2011 14:09:07">
          <Html>
        
&lt;p&gt;You will need to do two for-loop and write each cell manually, it´s very easy. Look at sample´s folder.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Specifying field as numbers instead of text">
      <Posts>
        <Post From="AaronLS" When="07/09/2011 23:50:48">
          <Html>
        
&lt;p&gt;The Excel files I create don't support the auto Sum/Avg in the status bar.&amp;nbsp; I first have to hit the "Data-&amp;gt;Text to Columns" button in Excel to get them to be treated as numbers and support the auto Sum/Avg in the status bar.&lt;/p&gt;
&lt;p&gt;Either through the EPPlus API, or by editing the template file, how do I indicate fields should be treated as numbers.&amp;nbsp; The number formatting doesn't seem to affect this.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="icareo" When="09/09/2011 08:40:22">
          <Html>
        
&lt;p&gt;I think you're filling cells values with strings instead of numbers, (or your templates file cells are formatted as text)... arent you ?&lt;/p&gt;
&lt;p&gt;ws.Cells["A1"].Value = 12;&lt;/p&gt;
&lt;p&gt;ws.Cells["A2"].Value = "12";&lt;/p&gt;
&lt;p&gt;does not produce the same result.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Problem with title in chart">
      <Posts>
        <Post From="KSzyhu" When="30/08/2011 15:13:17">
          <Html>
        
&lt;p&gt;Hi!&lt;/p&gt;
&lt;p&gt;Ive been using Epplus for some time, and I dont know what happend :o in my other project everything was doing great, but now...&lt;/p&gt;
&lt;p&gt;So! I want to change title (im loading template, where are infinity number of charts and in title I have written what column should be X and Y -&amp;gt; {Xseries = C2:E10; Yseries = C3:E10; title = "chartTitle"}). After loading that title:&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;&lt;/span&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;div style="color: black; background-color: white;"&gt;&lt;pre&gt;&lt;span style="color: blue;"&gt;if&lt;/span&gt; ((currentWorksheet.Drawings.Count) != 0)
{
     &lt;span style="color: blue;"&gt;for&lt;/span&gt; (&lt;span style="color: blue;"&gt;int&lt;/span&gt; i = 0; i &amp;lt; currentWorksheet.Drawings.Count; i++)
     {
           chart = ((ExcelChart)currentWorksheet.Drawings[i]);
           &lt;span style="color: blue;"&gt;string&lt;/span&gt; title = chart.Title.Text;
           &lt;span style="color: blue;"&gt;string&lt;/span&gt;[] titleAttributes = title.Split(&lt;span style="color: rgb(163, 21, 21);"&gt;';'&lt;/span&gt;);
           &lt;span style="color: green;"&gt;//Building up title&lt;/span&gt;
           &lt;span style="color: blue;"&gt;string&lt;/span&gt; titleToBuild = TitleAttributes[2].Substring(titleAttributes[0].IndexOf(&lt;span style="color: rgb(163, 21, 21);"&gt;'\"'&lt;/span&gt;) + 1);
     }
}
&lt;/pre&gt;
&lt;/div&gt;
&lt;/pre&gt;
&lt;pre&gt;so now in titleToBuild I have "chartTitle" and I want to set title -&amp;gt; chart.Title.Text = chartTitle; (of course in for loop, so I havent lost my variable) but... i have exception: "The node to be removed is not a child of this node.". And Im asking why?&lt;/pre&gt;
&lt;pre&gt;I have never had something like that :o I can't change title in template? Or have I did something wrong?&lt;/pre&gt;
&lt;pre&gt;&lt;br&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="01/09/2011 19:25:17">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;This is a bug. When reading the chart title&amp;nbsp;and then writing it back you get an exception. I think it occures when you have two or more different styles in the richtext.&lt;/p&gt;
&lt;p&gt;I'll supply a fix next time&amp;nbsp;I check in.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Possible to copy relative formulas when copying a cell range?">
      <Posts>
        <Post From="abemiessler" When="01/09/2011 05:18:23">
          <Html>
        
&lt;p&gt;I have a chunk of code that I am using to copy a range of cells from one location to another:&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;pre&gt;templateWorksheet.Cells["A" + templateRow + ":X" + (templateRow + 4)].Copy(new ExcelRangeBase(templateWorksheet, "A" + (templateRow + 4) + ":X" + (templateRow + 8)));&lt;/pre&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;My issue is that when these cells copy they copy the absolute formula rather than the relative one.&amp;nbsp; For example if I have a row that has the formula
&lt;/p&gt;
&lt;pre&gt;=A1+E1&lt;/pre&gt;
And I copy that to the next line it does not change to:
&lt;pre&gt;=A2+E2&lt;/pre&gt;
If I open the excel spread sheet and do the copy manually the rows adjust as they should.&amp;nbsp; Is there anyway to have formulas copy this way?
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="01/09/2011 13:05:37">
          <Html>
        
&lt;p&gt;No, you need to do&amp;nbsp;programmatically. After copy yours cell, you need to recaculate theirs formula.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="IsolatedStorageException: Unable to create the store directory.">
      <Posts>
        <Post From="mvanhees" When="28/04/2011 11:46:39">
          <Html>
        
&lt;p&gt;Hello,&lt;/p&gt;
&lt;p&gt;I am using EPPLus to generate an Excel file that represent a lot of information that comes from a datagrid.&lt;br&gt;
If the file become too big I got the YSOD with this message:&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div&gt;&lt;span&gt;&amp;nbsp; &lt;/span&gt;&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;h1&gt;Server Error in '/' Application.
&lt;hr size="1"&gt;
&lt;/h1&gt;
&lt;h2&gt;&lt;em&gt;Unable to create the store directory. (Exception from HRESULT: 0x80131468)&lt;/em&gt;&lt;/h2&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div&gt;&lt;span style="font-family: Arial,Helvetica,Geneva,SunSans-Regular,sans-serif;"&gt;&lt;strong&gt;Description:
&lt;/strong&gt;An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code.
&lt;br&gt;
&lt;br&gt;
&lt;strong&gt;Exception Details: &lt;/strong&gt;System.IO.IsolatedStorage.IsolatedStorageException: Unable to create the store directory. (Exception from HRESULT: 0x80131468)&lt;br&gt;
&lt;br&gt;
&lt;strong&gt;Source Error:&lt;/strong&gt; &lt;br&gt;
&lt;br&gt;
&lt;/span&gt;&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;span style="font-family: Arial,Helvetica,Geneva,SunSans-Regular,sans-serif;"&gt;
&lt;table width="100%" bgcolor="#ffffcc"&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;An unhandled exception was generated during the execution of the current web request. Information regarding the origin and location of the exception can be identified using the exception stack trace below.&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;br&gt;
&lt;strong&gt;Stack Trace:&lt;/strong&gt; &lt;br&gt;
&lt;br&gt;
&lt;/p&gt;
&lt;table width="100%" bgcolor="#ffffcc"&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;
&lt;pre&gt;[IsolatedStorageException: Unable to create the store directory. (Exception from HRESULT: 0x80131468)]
   OfficeOpenXml.ExcelPackage.Save() +586
   OfficeOpenXml.ExcelPackage.SaveAs(Stream OutputStream) +49
   Fast.DexiaWebService.Historical.OnClickbtnExport(Object sender, EventArgs e) in file.cs:558
   System.Web.UI.WebControls.Button.OnClick(EventArgs e) +118
   System.Web.UI.WebControls.Button.RaisePostBackEvent(String eventArgument) +112
   System.Web.UI.WebControls.Button.System.Web.UI.IPostBackEventHandler.RaisePostBackEvent(String eventArgument) +10
   System.Web.UI.Page.RaisePostBackEvent(IPostBackEventHandler sourceControl, String eventArgument) +13
   System.Web.UI.Page.RaisePostBackEvent(NameValueCollection postData) +36
   System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +5563
&lt;/pre&gt;
&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;the method I use is :&lt;/p&gt;
&lt;/span&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;excelFile.SaveAs(Response.OutputStream);&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: Arial,Helvetica,Geneva,SunSans-Regular,sans-serif;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;/span&gt;&lt;/span&gt;I try the excelFile.GetAsByteArray() method but I have the same issue.&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: Arial,Helvetica,Geneva,SunSans-Regular,sans-serif;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;﻿&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: Arial,Helvetica,Geneva,SunSans-Regular,sans-serif;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;Can someone help me?&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: Arial,Helvetica,Geneva,SunSans-Regular,sans-serif;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Arial,Helvetica,Geneva,SunSans-Regular,sans-serif;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;﻿&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: Arial,Helvetica,Geneva,SunSans-Regular,sans-serif;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;﻿&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;Thanks.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="emendezrivas" When="28/04/2011 20:12:40">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I think you are having the same problem that I had when I was using EPPlus on a Script Task in SSIS.&lt;/p&gt;
&lt;p&gt;You can read the blog post that I wrote about the issue (and the solution to it): http://emendezrivas.wordpress.com/2011/03/19/45/. On the article, there is the code snippet that was the one that solved my problem.&lt;/p&gt;
&lt;p&gt;Hope this helps.&lt;/p&gt;
&lt;p&gt;If you have any questions about the article, don't hesitate to ask me.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="superhoang" When="24/08/2011 13:29:09">
          <Html>
        
&lt;p&gt;If you're running your application pool as "Network Service" granting at least Modify permissions for the Network Service account to "C:\Documents and Settings\Default User\Local Settings\Application Data\IsolatedStorage" will get you going.&lt;/p&gt;
&lt;p&gt;I had to create the IsolatedStorage directory on our server as it didn't exist.&lt;/p&gt;
&lt;p&gt;Credit goes to&amp;nbsp;Brent Keller :&amp;nbsp;&lt;a href="http://stackoverflow.com/questions/3242102/a-cause-for-hresult-0x80131468-when-accessing-isolatedstoragebackingstore" rel="nofollow"&gt;http://stackoverflow.com/questions/3242102/a-cause-for-hresult-0x80131468-when-accessing-isolatedstoragebackingstore&lt;/a&gt;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Draft Property">
      <Posts>
        <Post From="mina_kemo" When="18/08/2011 13:17:59">
          <Html>
        
&lt;p&gt;hi&lt;/p&gt;
&lt;p&gt;what&amp;nbsp;does the property Draft in &lt;span style="font-family: Consolas; font-size: x-small;"&gt;
&lt;span style="font-family: Consolas; font-size: x-small;"&gt;PrinterSettings do?&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="23/08/2011 19:53:00">
          <Html>
        
&lt;p&gt;It's for draft quality&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Office Open XML File Structure">
      <Posts>
        <Post From="devbhagat2003" When="18/08/2011 10:52:08">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;When you create a new .xlsx file in 2007. and open as Zipped [with WinZip or WinRAR] it creates the following File structure&lt;br&gt;
&lt;span style="color: rgb(255, 0, 0);"&gt;_Rels&lt;/span&gt;&lt;br&gt;
&lt;span style="color: rgb(255, 0, 0);"&gt;&lt;strong&gt;docProps&lt;/strong&gt;&lt;/span&gt;&lt;br&gt;
&lt;span style="color: rgb(255, 0, 0);"&gt;xl&lt;/span&gt;&lt;br&gt;
&lt;span style="color: rgb(255, 0, 0);"&gt;[Content_Types].xml&lt;/span&gt;&lt;br&gt;
&lt;br&gt;
&lt;/li&gt;&lt;li&gt;However when you dynamically create an .xlsx file, and see its Zipped structure, it missed out docProps folder. The structure is&lt;br&gt;
&lt;span style="color: rgb(255, 0, 0);"&gt;_Rels&lt;/span&gt;&lt;br&gt;
&lt;span style="color: rgb(255, 0, 0);"&gt;xl&lt;/span&gt;&lt;br&gt;
&lt;span style="color: rgb(255, 0, 0);"&gt;[Content_Types].xml&lt;/span&gt; &lt;/li&gt;&lt;/ol&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Can I create the same file structure while creating the file dynamically? Any thoughts on this? What needs to done to get the exact file structure?&lt;/p&gt;
&lt;p&gt;I need this @ urgent. Thank you.&lt;/p&gt;
&lt;p&gt;Sincerely,&lt;/p&gt;
&lt;p&gt;Dev&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="23/08/2011 19:52:25">
          <Html>
        
&lt;p&gt;Yes, use Workbook.Properties to set docProps&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="how to simulate file - new (before first save) via c# epplus">
      <Posts>
        <Post From="up_60188" When="16/08/2011 14:19:11">
          <Html>
        
&lt;p&gt;&amp;nbsp;I am using epplus to generate a report that the user will be viewing in excel. If he needs to save it he then wants to do a file save in excel. Otherwise he wants to close excel and discard. Is there someway I can start excel in file new mode and update
 the cells of the in memory shown new file (not yet saved). Otherwise only approach is to create random files in some temp folder and show these files. Is there any eppplus call to open Excel and show generated file or must I use process.start().. thank you&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="18/08/2011 06:49:36">
          <Html>
        
&lt;p&gt;EPPlus only generates the ooxml files for you. Use Process.Start or the Excel API to start Excel.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="up_60188" When="19/08/2011 14:11:27">
          <Html>
        
&lt;p&gt;ok thx&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Group/Ungroup Rows">
      <Posts>
        <Post From="mina_kemo" When="17/08/2011 22:12:39">
          <Html>
        
&lt;p&gt;hi ,&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;is that a way to make group / ungroup for a collection of rows ?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="18/08/2011 06:50:32">
          <Html>
        
&lt;p&gt;Have a look at sample 6&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mina_kemo" When="18/08/2011 10:18:43">
          <Html>
        
&lt;p&gt;thnx alot,&lt;/p&gt;
&lt;p&gt;i got it after i sent the question :)&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="eholub" When="18/08/2011 18:25:20">
          <Html>
        
&lt;p&gt;so, I guess I'm overlooking something, but I haven't been able to find it in Sample 6, and I need to know how to Group badly. Will you please add some sample code on how to do this?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="18/08/2011 20:14:37">
          <Html>
        
&lt;p&gt;Take a look at this thread, maybe can help you.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;a href="http://epplus.codeplex.com/discussions/261320" rel="nofollow"&gt;http://epplus.codeplex.com/discussions/261320&lt;/a&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="eholub" When="18/08/2011 20:17:28">
          <Html>
        
&lt;p&gt;you are my hero! Thank you very much!&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Creating a chart without a Title">
      <Posts>
        <Post From="Ariazlol" When="11/08/2011 15:10:55">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I have been using this awesome&amp;nbsp;library for a couple of days now, but i have run into a problem.&lt;/p&gt;
&lt;p&gt;I need to create a chart, and this chart should not have a title.&lt;/p&gt;
&lt;p&gt;I have looked around in the source code and in the samples without any luck.&lt;/p&gt;
&lt;p&gt;So my question is: Is there a way to either create the chart without a title, or to remove it after creation ?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks,&lt;/p&gt;
&lt;p&gt;Christian&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="whitefin" When="11/08/2011 17:41:06">
          <Html>
        
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;How about just setting the text to empty and setting it the overlay to false? There might be a better way but&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;chart2.Title.Text = "";&lt;/p&gt;
&lt;p&gt;chart2.Title.Overlay = false;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Ariazlol" When="12/08/2011 07:37:24">
          <Html>
        
&lt;blockquote style="margin: 0.25em 1em 0px; padding: 0px 0.25em; border: 0.1em solid rgb(204, 204, 204); border-image: none; font-style: italic;"&gt;
&lt;strong&gt;whitefin wrote:&lt;/strong&gt;&lt;br&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;How about just setting the text to empty and setting it the overlay to false? There might be a better way but&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;chart2.Title.Text = "";&lt;/p&gt;
&lt;p&gt;chart2.Title.Overlay = false;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;I have already tried this method.&lt;/p&gt;
&lt;p&gt;While it does "hide" the title, the title still takes up space preventing the chart from using the blank space.&lt;/p&gt;
&lt;p&gt;http://img716.imageshack.us/img716/9095/81910517.png&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="18/08/2011 06:42:19">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;If you don't access the Title property the title is not created.&lt;/p&gt;
&lt;p&gt;There is no&amp;nbsp;build-in method to remove it&amp;nbsp;once&amp;nbsp;it&amp;nbsp;has been created. The only way is to delete the c:title element directly in the ChartXml-document.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="XLSX to HTML">
      <Posts>
        <Post From="avagarwal" When="10/08/2011 18:34:23">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;This is out of the context, but after creating an XLSX using EPPlus, what would be the best method to convert the same into a html for emailing.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Anurag&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="12/08/2011 14:07:35">
          <Html>
        
&lt;p&gt;There is no easy way to do that. You have to read the values and styles and create the html from there.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Collapse Pivot Table Row Labels">
      <Posts>
        <Post From="cyrilwallace" When="11/08/2011 12:44:57">
          <Html>
        
&lt;p&gt;Hi Jan,&lt;/p&gt;
&lt;p&gt;I have a number of Row Labels that I would like to collapse by default once I generate my pivot table.&lt;br&gt;
Is this possible?&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Great work on this byw.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="EPPlus &amp;amp; Scale to Fit">
      <Posts>
        <Post From="comaunite" When="08/08/2011 12:51:14">
          <Html>
        
&lt;p&gt;Hi,&lt;br&gt;
&lt;br&gt;
I'm having this trouble, when I generate a long report, save it to the excel file and then try to print it out - the whole thing is trying to fit itself in one page vertically.&lt;br&gt;
I found that to resolve the problem I need to set Scale To Fit -&amp;gt; Height property to "Automatic".&lt;/p&gt;
&lt;p&gt;That's that, but is there a way of setting that one automatically through EPPlus? Didn't find a way, any suggestions?&lt;br&gt;
If not, can this feature be requested?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="09/08/2011 13:53:54">
          <Html>
        
&lt;p&gt;Hi&lt;/p&gt;
&lt;p&gt;Set the &lt;strong&gt;Worksheet.PrinterSettings.FitToHeight = 0&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="comaunite" When="11/08/2011 07:36:35">
          <Html>
        
&lt;p&gt;Many thanks to you :)&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Digital Signatures">
      <Posts>
        <Post From="CatchExAs" When="10/08/2011 11:02:58">
          <Html>
        
&lt;p&gt;Hi Dev team,&lt;/p&gt;
&lt;p&gt;Using EPP, is it possible to easily add digital signatures given that I have a valid ceritifcate isntalled to my machine?&lt;/p&gt;
&lt;p&gt;Best Regards&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="10/08/2011 14:09:13">
          <Html>
        
&lt;p&gt;No, sorry, there is built-in not functionallity to do that.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Background Image">
      <Posts>
        <Post From="mina_kemo" When="09/08/2011 13:42:50">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;is that a way to add background image to the excel sheet using&amp;nbsp;the library ?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="09/08/2011 13:55:09">
          <Html>
        
&lt;p&gt;No, not in this version, unless you use a template to start with.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mina_kemo" When="09/08/2011 14:00:39">
          <Html>
        
&lt;p&gt;even by using ﻿worksheetXML ?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="10/08/2011 14:07:26">
          <Html>
        
&lt;p&gt;I havn't looked at it, but you will also have to create a relationship between the worksheet xml file and the image file inside the packaged to get it to work.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Help!">
      <Posts>
        <Post From="carlozsilva" When="19/07/2011 23:36:46">
          <Html>
        
&lt;p&gt;Hello, can you tell me please as adding a filter in one of the fields in a PivotTable (&lt;strong&gt;Report / Filter&lt;/strong&gt;)&lt;/p&gt;
&lt;p&gt;This line of code is Sample12.cs:&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(0, 128, 0);"&gt;//Add a page field &amp;nbsp; &amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(0, 0, 255);"&gt;var &lt;/span&gt;&lt;span style="color: rgb(0, 0, 0);"&gt;pageField = pivotTable2.PageFields.Add(pivotTable2.Fields["&lt;/span&gt;&lt;span style="color: rgb(128, 0, 0);"&gt;Title&lt;/span&gt;"&lt;span style="color: rgb(0, 0, 0);"&gt;]);&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;I would like to add a filter on that field so that when I generated the excel display the selected (show the one selected and not (ALL) in the excel)&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="carlozsilva" When="22/07/2011 17:20:53">
          <Html>
        
&lt;p&gt;Hello can you help me with this please I would greatly appreciate thanks .&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="carlozsilva" When="02/08/2011 23:46:40">
          <Html>
        
&lt;p&gt;Select Multiple one or Items in filter PivotTable&lt;/p&gt;
&lt;p&gt;Help please.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="whitefin" When="07/08/2011 18:58:50">
          <Html>
        
&lt;p&gt;I would like help with this too.&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Is it possible? If so can someone please point to an example or just a code snippet?&lt;/p&gt;
&lt;p&gt;If not, is there a work around?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thank you.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Edit: BTW great tool so far. I'm new to C# coding and excel too but this has helped me learn a lot.&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="09/08/2011 13:51:44">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;There is no way to do that in the current version. EPPlus relays on Excel to create all the data in the pivottable, so at creation time there are no "items" in the the pivottable.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Pivot table subtotals">
      <Posts>
        <Post From="mr_miles" When="05/08/2011 16:35:56">
          <Html>
        
&lt;p&gt;Hi Jan,&lt;/p&gt;
&lt;p&gt;Great work on EPPlus! &amp;nbsp;I had to make a pivot table for a report and it was so easy. &amp;nbsp;One thing that came up was that there is no way at the moment to control the subtotals that appear when you have more than one field selected on an axis of the
 table - by default, excel shows the total.&lt;/p&gt;
&lt;p&gt;I've submitted a patch that allows the subtotal method to be controlled for a field.&lt;/p&gt;
&lt;p&gt;Thanks for the great work,&lt;/p&gt;
&lt;p&gt;Miles&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="09/08/2011 13:45:24">
          <Html>
        
&lt;p&gt;Ok, thanks, I'll have a look at it&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Is it easy to do a direct swap for ExcelPackage?">
      <Posts>
        <Post From="JamesBirch" When="05/08/2011 15:48:43">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;We've just hit the performance issues in ExcelPackage. Does EPPlus have some of the same basic interfaces as ExcelPackage? i.e. can we just swap the dlls? Do you still have to load cell by cell or is there any capacity for rows or table inserts?&lt;/p&gt;
&lt;p&gt;If loading cell by cell, how much faster is EPPlus over 2000 rows (20 columns)?&lt;/p&gt;
&lt;p&gt;Cheers,&lt;/p&gt;
&lt;p&gt;James&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="09/08/2011 13:42:30">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;The interface is similar, but not the same. Have a look at the sample project and the FAQ to answer your questions&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Can I read / open Excel 2003 file which has extension .xls">
      <Posts>
        <Post From="jpratik" When="04/08/2011 16:05:54">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Can I read / open Excel 2003 file which has extension .xls&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;If so then please let me know how ?&lt;/p&gt;
&lt;p&gt;Because as of now I am getting an error while opening .xls files&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I am looking for any ideas or any alternatives on the same.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="04/08/2011 16:36:35">
          <Html>
        
&lt;p&gt;No, EPPlus only works with OOXML ( .xlsx ). If you want to read older excel files, you can try NPOI project.&lt;/p&gt;
&lt;p&gt;&lt;a href="http://npoi.codeplex.com/" rel="nofollow"&gt;http://npoi.codeplex.com/&lt;/a&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mjslane" When="04/08/2011 17:34:28">
          <Html>
        
&lt;p&gt;There's a microsoft tool called ofc that can convert xls to xlsx. &amp;nbsp;I use this quite a lot as the BI tools my company use still can't output xlsx format.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jpratik" When="04/08/2011 18:52:22">
          <Html>
        
&lt;blockquote style="margin: 0.25em 1em 0px; padding: 0px 0.25em; border: 0.1em solid rgb(204, 204, 204); border-image: none; font-style: italic;"&gt;
&lt;strong&gt;mjslane wrote:&lt;/strong&gt;&lt;br&gt;
&lt;p&gt;There's a microsoft tool called ofc that can convert xls to xlsx. &amp;nbsp;I use this quite a lot as the BI tools my company use still can't output xlsx format.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Can this conversion be pro-grammatically achieved ?&lt;/p&gt;
&lt;p&gt;If so, then can please suggest me a link of such example or so, it can be quite helpful for me.&lt;/p&gt;
&lt;p&gt;Thanks a lot!!&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jpratik" When="04/08/2011 18:55:12">
          <Html>
        
&lt;blockquote style="margin: 0.25em 1em 0px; padding: 0px 0.25em; border: 0.1em solid rgb(204, 204, 204); border-image: none; font-style: italic;"&gt;
&lt;strong&gt;mrxrsd wrote:&lt;/strong&gt;&lt;br&gt;
&lt;p&gt;No, EPPlus only works with OOXML ( .xlsx ). If you want to read older excel files, you can try NPOI project.&lt;/p&gt;
&lt;p&gt;&lt;a href="http://npoi.codeplex.com/" rel="nofollow"&gt;http://npoi.codeplex.com/&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;In my case users can upload Excel 2003 or 2007 files, &amp;amp; EPPlus very well handles 2007 files. What do you suggest for handling Excel 2003 .xls files ??&lt;/p&gt;
&lt;p&gt;Do I need add NPOI project as well ( its like adding another third party )&lt;/p&gt;
&lt;p&gt;Or can you suggest me only I tool that takes care of both .&lt;/p&gt;
&lt;p&gt;Looking forward for your advice.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks !&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mjslane" When="05/08/2011 12:49:50">
          <Html>
        
&lt;p&gt;It depends on what you are trying to do. &amp;nbsp;If it's a simple data load, the Excel Jet drivers would probably be your best bet.&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Information on OFC here. &amp;nbsp;You have to build an ini file and then run ofc against it using the Process classes. &amp;nbsp;It has a habit of return success when it has actually failed. so check the output file is there afterwards. &amp;nbsp;It usually works on
 the next try or two.&lt;/p&gt;
&lt;p&gt;&lt;a href="http://technet.microsoft.com/en-us/library/cc179019(office.12).aspx" rel="nofollow"&gt;http://technet.microsoft.com/en-us/library/cc179019(office.12).aspx&lt;/a&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jpratik" When="05/08/2011 19:35:14">
          <Html>
        
&lt;blockquote style="margin: 0.25em 1em 0px; padding: 0px 0.25em; border: 0.1em solid rgb(204, 204, 204); border-image: none; font-style: italic;"&gt;
&lt;strong&gt;mjslane wrote:&lt;/strong&gt;&lt;br&gt;
&lt;p&gt;It depends on what you are trying to do. &amp;nbsp;If it's a simple data load, the Excel Jet drivers would probably be your best bet.&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Information on OFC here. &amp;nbsp;You have to build an ini file and then run ofc against it using the Process classes. &amp;nbsp;It has a habit of return success when it has actually failed. so check the output file is there afterwards. &amp;nbsp;It usually works on
 the next try or two.&lt;/p&gt;
&lt;p&gt;&lt;a href="http://technet.microsoft.com/en-us/library/cc179019(office.12).aspx" rel="nofollow"&gt;http://technet.microsoft.com/en-us/library/cc179019(office.12).aspx&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;br&gt;
No My application has to read &amp;amp; update Excel Files based on some logic &amp;amp; also may carry out some other processes like database,etc.&lt;/p&gt;
&lt;p&gt;This is a simple web Application in which user can upload Excel 2003 - 2010 files &amp;amp; would be read / updated based on some logic.&lt;/p&gt;
&lt;p&gt;I am able to handle 2007 - 2010 files with&amp;nbsp; EPPlus, problem comes for 2003 / 2005 excel files.&lt;/p&gt;
&lt;p&gt;Any ideas ??&lt;/p&gt;
&lt;p&gt;Thanks !!&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Saveas causing errors">
      <Posts>
        <Post From="whitefin" When="03/08/2011 15:58:42">
          <Html>
        
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;                &lt;span style="color: blue;"&gt;if&lt;/span&gt; (!File.Exists(&lt;span style="color: blue;"&gt;this&lt;/span&gt;.savePath + stripped + &lt;span style="color: rgb(163, 21, 21);"&gt;".xlsx"&lt;/span&gt;))
                {

                    &lt;span style="color: blue;"&gt;using&lt;/span&gt; (ExcelPackage ex = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(pather))
                    {
                        FileInfo saver = &lt;span style="color: blue;"&gt;new&lt;/span&gt; FileInfo(&lt;span style="color: blue;"&gt;this&lt;/span&gt;.savePath.FullName + &lt;span style="color: rgb(163, 21, 21);"&gt;@"\New.xlsx"&lt;/span&gt;);
                        ExcelWorksheet workSheet = ex.Workbook.Worksheets[timing];
                        workSheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;].LoadFromDataTable(dt, &lt;span style="color: blue;"&gt;true&lt;/span&gt;);
                        ex.SaveAs(saver);

                    }
                }
                &lt;span style="color: blue;"&gt;else&lt;/span&gt; 
                {
                    
                    &lt;span style="color: blue;"&gt;using&lt;/span&gt; (ExcelPackage ex = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(existing))
                    {
                        FileInfo saver = &lt;span style="color: blue;"&gt;new&lt;/span&gt; FileInfo(&lt;span style="color: blue;"&gt;this&lt;/span&gt;.savePath.FullName + &lt;span style="color: rgb(163, 21, 21);"&gt;@"\something.xlsx"&lt;/span&gt;);
                        ExcelWorksheet workSheet = ex.Workbook.Worksheets[timing];
                        workSheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;].LoadFromDataTable(dt, &lt;span style="color: blue;"&gt;true&lt;/span&gt;);
                        ex.SaveAs(saver);
                    }
 
                }
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;This is what I'm using to saveas, but I keep getting a "Error saving file C:\Documents and Settings\xxxx\Desktop\Txxxx\New.xlsx" with an invalidoperationexception error thrown.&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I'm sorry I'm still pretty new to this stuff so i'm sure it's a very stupid question. If you can help me I'd really appreciate it.&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I ran the sample code for EPP with the same "destination directory" and it worked just fine.&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="whitefin" When="04/08/2011 17:46:24">
          <Html>
        
&lt;p&gt;Hi I figured out this iuse, it wasn't accepting the string as a variable.&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;However I'm having a different issue, is there something I need to do to overwrite an existing file?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks,&lt;/p&gt;
&lt;p&gt;Pradeep&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;[EDIT]&lt;/p&gt;
&lt;p&gt;Hi Guys,&lt;/p&gt;
&lt;p&gt;In the process of learning more and more about the code, I figured out what I was doing wrong. This issue has been solved. If you can delete this discussion that's great if not please ignore it.&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;
&lt;p&gt;[Edit]&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="CSS Styles">
      <Posts>
        <Post From="godone" When="24/07/2011 06:14:40">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Is there any way or possibility to add a CSS Formatted Style or even better a stylesheet file.&lt;/p&gt;
&lt;p&gt;Does any body did something like a parser to automatically add a css form style to epplus?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks,&lt;/p&gt;
&lt;p&gt;Guillermo.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="02/08/2011 16:31:27">
          <Html>
        
&lt;p&gt;No, but you can create a template file with all class you might use and when you create your xlsx file do a parser "template class &amp;lt;&amp;gt; css class".&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Scatter Chart Creation.">
      <Posts>
        <Post From="PGPProtector" When="28/07/2011 21:08:17">
          <Html>
        
&lt;p&gt;I'm trying to create a scatter chart with the Data in Cells "C2:D62" using this code&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;var&lt;/span&gt; chart = (ThisWorkSheet.Drawings.AddChart(&lt;span style="color: rgb(163, 21, 21);"&gt;"ScatterPlot"&lt;/span&gt;, eChartType.XYScatter) &lt;span style="color: blue;"&gt;as&lt;/span&gt; ExcelScatterChart);
chart.Title.Text = &lt;span style="color: rgb(163, 21, 21);"&gt;"Total"&lt;/span&gt;;           
chart.SetPosition(0, 0, 5, 5);            
chart.SetSize(600, 600);
&lt;span style="color: blue;"&gt;var&lt;/span&gt; ser = (chart.Series.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"C2:D62"&lt;/span&gt;,&lt;span style="color: rgb(163, 21, 21);"&gt;"C1:D1"&lt;/span&gt;) &lt;span style="color: blue;"&gt;as&lt;/span&gt; ExcelScatterChartSerie);            
ThisWorkSheet.View.PageLayoutView = &lt;span style="color: blue;"&gt;false&lt;/span&gt;;

&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;The File Is created, (And the data is in the cells I expect) but The Chart isn't working, I'm getting an error&lt;/p&gt;
&lt;p&gt;The Reference Is not valid. references for titles, values, or sizes must be a single cell, row, or column.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;So how do you select the two rows/columns for a xy scatter plot?&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Copy Formula and Format">
      <Posts>
        <Post From="phandel" When="28/07/2011 18:06:03">
          <Html>
        
&lt;p&gt;Is there a way to copy an existing formula in a template down a column? Also, is there a similar way to copy the format of a cell down?&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Simple Help">
      <Posts>
        <Post From="stevestraley" When="24/07/2011 02:14:21">
          <Html>
        
&lt;p&gt;Hi... I just tried to create a simple worksheet in a windows app in C#, VS2010... I step through the debugger and nothing throws an error BUT the spreadsheet doesn't get written.&amp;nbsp;&amp;nbsp; Without posting the code, is there something obvious that I may
 be missing?&amp;nbsp;&amp;nbsp; I used the EPPlusSample.Sample1.cs as a guide.&lt;/p&gt;
&lt;p&gt;Thanks,&lt;/p&gt;
&lt;p&gt;Steve&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="24/07/2011 02:16:24">
          <Html>
        
&lt;p&gt;Maybe you forgot to call Save method ?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="stevestraley" When="24/07/2011 02:40:22">
          <Html>
        
&lt;p&gt;I got that ... when I don't create a worksheet I do get an error saying there must be at least 1 worksheet so I think that the Save() is working.&amp;nbsp;&amp;nbsp; I've stripped the code down to almost nothing:&lt;/p&gt;
&lt;p&gt;Here is the calling code&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; RenewalWorksheet o = new RenewalWorksheet();&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; o.Generate();&lt;/p&gt;
&lt;p&gt;And here is the class:&lt;br&gt;
&lt;br&gt;
&amp;nbsp; public class RenewalWorksheet&lt;br&gt;
&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; protected FileInfo xlsFile;&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; public RenewalWorksheet() { }&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; public void CreateFile()&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; FileInfo xlsFile = new FileInfo(@"C:\temp\AAAA.xlsx");
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; if (xlsFile.Exists)&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; xlsFile.Delete();&amp;nbsp; // ensures we create a new workbook&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; xlsFile = new FileInfo(@"C:\temp\AAAA.xlsx");&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; protected void CreateSummaryPage(ExcelPackage e)&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ExcelWorksheet work = e.Workbook.Worksheets.Add("Summary");&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; work.Cells[1,1].Value = "region";&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; work.Cells[1,2].Value = "applicationstatus";&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; work.Cells[1,3].Value = "Tot_Leagues";&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; public void Generate()&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; this.CreateFile();&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; try&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; using (ExcelPackage package = new ExcelPackage(this.xlsFile))&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; this.CreateSummaryPage(package);&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; package.Save();&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; catch (Exception e)&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; InfoBox.Show(e.Message);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="stevestraley" When="24/07/2011 02:55:13">
          <Html>
        
&lt;p&gt;Never mind... stupid me... brain fart... had local instance of the file not going to the property... it's working now... thanks...&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="PivotTable Source (Use LoadFromDataTable instead of LoadFromCollection)">
      <Posts>
        <Post From="mrnakiadyoung" When="18/07/2011 21:09:25">
          <Html>
        
&lt;p&gt;I've recently upgraded from 2.8.0.2 to 2.9.0.1 and am experimenting with the newly added PivotTable functionality.&lt;/p&gt;
&lt;p&gt;I'm following Sample12 of the SampleApp as a reference.&amp;nbsp; Instead of utilizing LoadFromCollection to populate the source data for my PivotTable, I'm need to utilize LoadFromDataTable.&amp;nbsp; I notice that this method (LoadFromDataTable) returns void whereas
 LoadFromCollection, LoadFromArrays, and LoadFromText all return ExcelRangeBase which is utilized as a argument within the PivotTables.Add function.&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Since LoadFromDataTable does not return anything, what would be the best way to pass this as a source to the PivotTable?&amp;nbsp; I've tried Worksheet.Cells is the ExcelRange of the data added but have had no luck.&lt;/p&gt;
&lt;p&gt;Any suggestions would be appreciated.&lt;/p&gt;
&lt;p&gt;Thanks,&lt;/p&gt;
&lt;p&gt;Mr. Nakia D. Young&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="carlozsilva" When="19/07/2011 23:46:41">
          <Html>
        
&lt;p&gt;Hi, well I'm also new to this and is very good, but I think you need the range of cells if you do it with a datatable, of course it will not devuleve but you have the range you can do so, I guess which shall include :&lt;/p&gt;
&lt;p&gt;var wsData = excel.Workbook.Worksheets.Add("Data");&lt;/p&gt;
&lt;p&gt;wsData.Cells["A1"].LoadFromDataTable(tbl, true, OfficeOpenXml.Table.TableStyles.Medium6);&lt;/p&gt;
&lt;p&gt;ExcelRangeBase dataRange = wsData.Cells["A1:AG" + (tbl.Rows.Count + 1)];&lt;/p&gt;
&lt;p&gt;tbl is the Datatable&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrnakiadyoung" When="20/07/2011 16:41:40">
          <Html>
        
&lt;pre&gt;Thanks @carlozsilva &lt;/pre&gt;
&lt;pre&gt;I was able to get the range utilizing the Dimensions of the Worksheet that was created as a result of loading from the datatable. &lt;/pre&gt;
&lt;pre&gt;var wsData = excel.Workbook.Worksheets.Add("Data"); &lt;/pre&gt;
&lt;pre&gt;wsData.Cells["A1"].LoadFromDataTable(tbl, true, OfficeOpenXml.Table.TableStyles.Medium6); &lt;/pre&gt;
&lt;pre&gt;&lt;strong&gt;var dataRange = wsData.Cells[wsData.Dimension.Address.ToString()]; &lt;/strong&gt;&lt;/pre&gt;
&lt;pre&gt;var wsPivot = excel.Workbook.Worksheets.Add("Pivot"); &lt;/pre&gt;
&lt;pre&gt;var pivotTable = wsPivot.PivotTables.Add(wsPivot.Cells["A1"], &lt;strong&gt;dataRange&lt;/strong&gt;, "pName");&lt;/pre&gt;

        
    </Html>
        </Post>
        <Post From="carlozsilva" When="22/07/2011 22:53:05">
          <Html>
        
&lt;p&gt;Good,&amp;nbsp;can you help me with my problem I have please? &amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;a href="http://epplus.codeplex.com/discussions/265802" rel="nofollow"&gt;http://epplus.codeplex.com/discussions/265802&lt;/a&gt;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="ExcelRow Outline Settings">
      <Posts>
        <Post From="pcotgrove" When="14/06/2011 14:33:31">
          <Html>
        
&lt;p&gt;I have created a spreadsheet with outlines around groups of rows. The problem I have is that I can't find a property or setting to set the "Summary rows below detail" option&lt;/p&gt;
&lt;p&gt;This will allow the expand (+) button of a collapsed group to appear level with the first row (the header) of that data instead of below&lt;/p&gt;
&lt;p&gt;Has this functionality been implemented?&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="16/06/2011 07:44:57">
          <Html>
        
&lt;p&gt;Use the Worksheet.&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;OutLineSummaryBelow property, as in sample 6.&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="pcotgrove" When="16/06/2011 08:28:34">
          <Html>
        
&lt;p&gt;Hi thanks jankallman - I couldn't find this when I was looking in the CHM help file - is there any supporting documentation taht describes what functionality has been included and where it can be found?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="16/06/2011 16:37:10">
          <Html>
        
&lt;p&gt;Its is in the 2.9 chm file (ExcelWorksheet class) and used in sample 6.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="johnyung88" When="20/07/2011 23:11:17">
          <Html>
        
&lt;p&gt;Does EPPlus support multiple levels outline? I saw the example in Sample 6, it only supports one level. Here is what I am trying to do&lt;/p&gt;
&lt;p&gt;Line # |Category A&lt;span style="white-space: pre;"&gt;&amp;nbsp;&lt;/span&gt;| Sub-Category | Value|&lt;/p&gt;
&lt;p&gt;1&lt;span style="white-space: pre;"&gt; &lt;/span&gt;| CS &amp;nbsp;| Basic|&amp;nbsp;1&lt;span style="white-space: pre;"&gt;
&lt;/span&gt;|&lt;/p&gt;
&lt;p&gt;2&lt;span style="white-space: pre;"&gt; &lt;/span&gt;| CS&lt;span style="white-space: pre;"&gt; &lt;/span&gt;
| Basic&lt;span style="white-space: pre;"&gt; &lt;/span&gt;| 2&lt;span style="white-space: pre;"&gt; &lt;/span&gt;
|&lt;/p&gt;
&lt;p&gt;3&lt;span style="white-space: pre;"&gt; &lt;/span&gt;|&lt;span style="white-space: pre;"&gt; &lt;/span&gt;
&lt;span style="white-space: pre;"&gt;&lt;/span&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;| Basic Total&lt;span style="white-space: pre;"&gt;
&lt;/span&gt;| 3|&lt;/p&gt;
&lt;p&gt;4&lt;span style="white-space: pre;"&gt; &lt;/span&gt;| CS&lt;span style="white-space: pre;"&gt; &lt;/span&gt;
| Liq&lt;span style="white-space: pre;"&gt; &lt;/span&gt;| 5&lt;span style="white-space: pre;"&gt; &lt;/span&gt;
|&lt;/p&gt;
&lt;p&gt;5&lt;span style="white-space: pre;"&gt; &lt;/span&gt;| CS&lt;span style="white-space: pre;"&gt; &lt;/span&gt;
| Liq&lt;span style="white-space: pre;"&gt; &lt;/span&gt;| 6&lt;span style="white-space: pre;"&gt; &lt;/span&gt;
|&lt;/p&gt;
&lt;p&gt;6&lt;span style="white-space: pre;"&gt; &lt;/span&gt;|&lt;span style="white-space: pre;"&gt; &lt;/span&gt;
&lt;span style="white-space: pre;"&gt;&lt;/span&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;| Liq Total&lt;span style="white-space: pre;"&gt;
&lt;/span&gt;| 11&lt;/p&gt;
&lt;p&gt;7&lt;span style="white-space: pre;"&gt; &lt;/span&gt;| CS Total&amp;nbsp;|&lt;span style="white-space: pre;"&gt;
&lt;/span&gt;| 14&lt;span style="white-space: pre;"&gt; &lt;/span&gt;|&lt;/p&gt;
&lt;p&gt;I want to create level one that groups line 1 to 6, will collapse line 7.&lt;/p&gt;
&lt;p&gt;Level two that that groups line 1 to 2, will collapse to line 3; groups line 4 to 5, will collapse to line 6&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="21/07/2011 12:37:03">
          <Html>
        
&lt;p&gt;Something like that:&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;            FileInfo tmpl = &lt;span style="color: blue;"&gt;new&lt;/span&gt; FileInfo(&lt;span style="color: rgb(163, 21, 21);"&gt;@"c:\"&lt;/span&gt; + DateTime.Now.Ticks + &lt;span style="color: rgb(163, 21, 21);"&gt;".xlsx"&lt;/span&gt;);

            &lt;span style="color: blue;"&gt;using&lt;/span&gt; (ExcelPackage pck = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(tmpl))
            {
                &lt;span style="color: blue;"&gt;var&lt;/span&gt; ws = pck.Workbook.Worksheets.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"1"&lt;/span&gt;);

      
                
                ws.Cells[2, 1].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"Drinks"&lt;/span&gt;;
                ws.Row(2).OutlineLevel = 0;

                ws.Cells[3, 2].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"Juice"&lt;/span&gt;;
                ws.Row(3).OutlineLevel = 1;

                ws.Cells[4, 3].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"Orange"&lt;/span&gt;;
                ws.Row(4).OutlineLevel = 2;
                ws.Cells[5, 3].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"Melon"&lt;/span&gt;;
                ws.Row(5).OutlineLevel = 2;
                ws.Cells[6, 3].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"Watermelon"&lt;/span&gt;;
                ws.Row(6).OutlineLevel = 2;

                ws.Cells[7, 2].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"Softdrinks"&lt;/span&gt;;
                ws.Row(7).OutlineLevel = 1;

                ws.Cells[8, 3].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"Coke"&lt;/span&gt;;
                ws.Row(8).OutlineLevel = 2;
                ws.Cells[9, 3].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"Pepsi"&lt;/span&gt;;
                ws.Row(9).OutlineLevel = 2;
                ws.Cells[9, 3].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"Sprite"&lt;/span&gt;;
                ws.Row(9).OutlineLevel = 2;

                ws.Cells[10, 1].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"Food"&lt;/span&gt;;
                ws.Row(10).OutlineLevel = 0;

                ws.Cells[11, 2].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"Junkfood"&lt;/span&gt;;
                ws.Row(11).OutlineLevel = 1;

                ws.Cells[12, 3].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"Pizza"&lt;/span&gt;;
                ws.Row(12).OutlineLevel = 2;
                ws.Cells[13, 3].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"Hamburguer"&lt;/span&gt;;
                ws.Row(13).OutlineLevel = 2;
                ws.Cells[14, 3].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"Hotdog"&lt;/span&gt;;
                ws.Row(14).OutlineLevel = 2;

                ws.Cells[15, 2].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"Salads"&lt;/span&gt;;
                ws.Row(15).OutlineLevel = 1;

                ws.Cells[16, 3].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"Ceasar"&lt;/span&gt;;
                ws.Row(16).OutlineLevel = 2;
                ws.Cells[17, 3].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"Tomato"&lt;/span&gt;;
                ws.Row(17).OutlineLevel = 2;
                ws.Cells[18, 3].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"Potato"&lt;/span&gt;;
                ws.Row(18).OutlineLevel = 2;




                pck.Save();
            }
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="johnyung88" When="21/07/2011 17:04:13">
          <Html>
        
&lt;p&gt;Yes, that works. Thanks&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Push Stream to Browser via Web Service">
      <Posts>
        <Post From="gomerpylevw" When="15/07/2011 19:35:44">
          <Html>
        
&lt;p&gt;I am currently using a web service to create the output file (.xlsx) and it is automatically opening in Excel. &amp;nbsp;Only problem I have with this is the cleanup. &amp;nbsp;I don't want to leave a ton of temporary files out on my web server. &amp;nbsp;So, I want
 to use a stream to push the file to the browser (Save-As). &amp;nbsp;I have tried multiple methods and cannot get this to work. &amp;nbsp;Can anyone please help? &amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks,&lt;br&gt;
gomer&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="15/07/2011 19:58:13">
          <Html>
        
&lt;p&gt;I dont know if I understand you well...but you can stream your package using GetAsByteArray method.&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;Response.Clear();
Response.AddHeader(&lt;span style="color: rgb(163, 21, 21);"&gt;"content-disposition"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"attachment; filename=file.xlsx"&lt;/span&gt;);
Response.AddHeader(&lt;span style="color: rgb(163, 21, 21);"&gt;"Content-Length"&lt;/span&gt;, output.Length.ToString();
Response.ContentType = &lt;span style="color: rgb(163, 21, 21);"&gt;"application/octet-stream"&lt;/span&gt;;
Response.BinaryWrite(pck.GetAsByteArray());
Response.End();
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="gomerpylevw" When="15/07/2011 20:34:54">
          <Html>
        
&lt;p&gt;I have attempted to use that code and it does nothing. &amp;nbsp;It's like the Response object in Context doesn't communicate with the browser. &amp;nbsp;I'm using a Web Service for this. &amp;nbsp;There's something that I'm missing to be able to cause this Response
 to be pushed to the browser.&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="problem creating a chart">
      <Posts>
        <Post From="shizora" When="15/07/2011 12:17:17">
          <Html>
        
&lt;p&gt;Hi, I'm realy not sure with Excel so in dont know how to create a chart or better how excel creates a chart if I choose all the cells in excel and click create chart.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;This is what i've done:&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;pre&gt;&lt;div style="color: black; background-color: white;"&gt;&lt;pre&gt;ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A3"&lt;/span&gt;].LoadFromDataTable(dt2, &lt;span style="color: blue;"&gt;true&lt;/span&gt;);

            pck.Workbook.Worksheets.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"Diagramm"&lt;/span&gt;);         
            &lt;span style="color: blue;"&gt;var&lt;/span&gt; chart = ws.Drawings.AddChart(&lt;span style="color: rgb(163, 21, 21);"&gt;"Balkendiagramm"&lt;/span&gt;, OfficeOpenXml.Drawing.Chart.eChartType.ColumnClustered); 
            chart.SetPosition(40, 600);

            &lt;span style="color: blue;"&gt;var&lt;/span&gt; serie1 = chart.Series.Add(ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"D4:D7"&lt;/span&gt;], ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A4:A7"&lt;/span&gt;]);
            &lt;span style="color: blue;"&gt;var&lt;/span&gt; serie2 = chart.Series.Add(ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"F4:F7"&lt;/span&gt;], ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A4:A7"&lt;/span&gt;]);           

            ws.Column(3).Style.Numberformat.Format = &lt;span style="color: rgb(163, 21, 21);"&gt;@"[hh]:mm:ss"&lt;/span&gt;;
            ws.Column(4).Style.Numberformat.Format = &lt;span style="color: rgb(163, 21, 21);"&gt;@"[hh]:mm:ss"&lt;/span&gt;;
            ws.Column(5).Style.Numberformat.Format = &lt;span style="color: rgb(163, 21, 21);"&gt;@"[hh]:mm:ss"&lt;/span&gt;;
            ws.Column(6).Style.Numberformat.Format = &lt;span style="color: rgb(163, 21, 21);"&gt;@"[hh]:mm:ss"&lt;/span&gt;;
            ws.Column(7).Style.Numberformat.Format = &lt;span style="color: rgb(163, 21, 21);"&gt;@"[hh]:mm:ss"&lt;/span&gt;;&lt;br&gt;&lt;br&gt;and it looks like this (left chart is the dynamic generated chart from my code, the right chart is how i want to have it):&lt;br&gt;http://sv1.imagefire.net/image/c6ad7edeba5e.jpg&lt;br&gt;&lt;br&gt;thank you!&lt;br&gt;&amp;nbsp;&lt;br&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;br&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Can't copy a Worksheet">
      <Posts>
        <Post From="hybrisCole" When="07/07/2011 22:40:42">
          <Html>
        
&lt;p&gt;Hello!&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I'm trying to copy a worksheet that contains a chart, but when I try to do it, my code fires a "package relationship with specified id does not exist for the source part" exception, what are possible reasons for this?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Here's my code:&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;pre style="background: white; color: black; font-family: Consolas;"&gt;&lt;span style="color: blue;"&gt;      public&lt;/span&gt;&amp;nbsp;&lt;span style="color: blue;"&gt;void&lt;/span&gt;&amp;nbsp;GenerateFromTemplate(&lt;span style="color: rgb(43, 145, 175);"&gt;DirectoryInfo&lt;/span&gt;&amp;nbsp;outputPath,&amp;nbsp;&lt;span style="color: rgb(43, 145, 175);"&gt;FileInfo&lt;/span&gt;&amp;nbsp;templateFile,
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span style="color: blue;"&gt;string&lt;/span&gt;&amp;nbsp;newFileName,&amp;nbsp;&lt;span style="color: rgb(43, 145, 175);"&gt;List&lt;/span&gt;&amp;lt;&lt;span style="color: rgb(43, 145, 175);"&gt;Dictionary&lt;/span&gt;&amp;lt;&lt;span style="color: blue;"&gt;string&lt;/span&gt;,&amp;nbsp;&lt;span style="color: blue;"&gt;string&lt;/span&gt;&amp;gt;&amp;gt;&amp;nbsp;cellDataList)
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span style="color: blue;"&gt;try&lt;/span&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span style="color: blue;"&gt;using&lt;/span&gt;&amp;nbsp;(&lt;span style="color: rgb(43, 145, 175);"&gt;ExcelPackage&lt;/span&gt;&amp;nbsp;p&amp;nbsp;=&amp;nbsp;&lt;span style="color: blue;"&gt;new&lt;/span&gt;&amp;nbsp;&lt;span style="color: rgb(43, 145, 175);"&gt;ExcelPackage&lt;/span&gt;(templateFile,&amp;nbsp;&lt;span style="color: blue;"&gt;true&lt;/span&gt;))
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span style="color: blue;"&gt;bool&lt;/span&gt;&amp;nbsp;first&amp;nbsp;=&amp;nbsp;&lt;span style="color: blue;"&gt;true&lt;/span&gt;;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span style="color: blue;"&gt;foreach&lt;/span&gt;&amp;nbsp;(&lt;span style="color: rgb(43, 145, 175);"&gt;Dictionary&lt;/span&gt;&amp;lt;&lt;span style="color: blue;"&gt;string&lt;/span&gt;,&amp;nbsp;&lt;span style="color: blue;"&gt;string&lt;/span&gt;&amp;gt;&amp;nbsp;cellData&amp;nbsp;&lt;span style="color: blue;"&gt;in&lt;/span&gt;&amp;nbsp;cellDataList)&amp;nbsp;{
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Logger.LogInfo(&lt;span style="color: rgb(163, 21, 21);"&gt;"Adding&amp;nbsp;new&amp;nbsp;Sheet..."&lt;/span&gt;);
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span style="color: rgb(43, 145, 175);"&gt;ExcelWorksheet&lt;/span&gt;&amp;nbsp;currentWorkSheet;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span style="color: blue;"&gt;if&lt;/span&gt;&amp;nbsp;(first)
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;currentWorkSheet&amp;nbsp;=&amp;nbsp;p.Workbook.Worksheets[1];
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;first&amp;nbsp;=&amp;nbsp;&lt;span style="color: blue;"&gt;false&lt;/span&gt;;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span style="color: blue;"&gt;else&lt;/span&gt;&amp;nbsp;{
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;currentWorkSheet&amp;nbsp;=&amp;nbsp;p.Workbook.Worksheets.Copy(&lt;span style="color: rgb(163, 21, 21);"&gt;"Ticker"&lt;/span&gt;,&amp;nbsp;&lt;span style="color: rgb(163, 21, 21);"&gt;"Ticker"&lt;/span&gt;&amp;nbsp;+&amp;nbsp;p.Workbook.Worksheets.Count);
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span style="color: blue;"&gt;foreach&lt;/span&gt;&amp;nbsp;(&lt;span style="color: rgb(43, 145, 175);"&gt;KeyValuePair&lt;/span&gt;&amp;lt;&lt;span style="color: blue;"&gt;string&lt;/span&gt;,&amp;nbsp;&lt;span style="color: blue;"&gt;string&lt;/span&gt;&amp;gt;&amp;nbsp;cell&amp;nbsp;&lt;span style="color: blue;"&gt;in&lt;/span&gt;&amp;nbsp;cellData)
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Logger.LogInfo(cell.Key&amp;nbsp;+&amp;nbsp;&lt;span style="color: rgb(163, 21, 21);"&gt;"cell&amp;nbsp;value&amp;nbsp;set&amp;nbsp;to"&lt;/span&gt;&amp;nbsp;+&amp;nbsp;cell.Value);
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;currentWorkSheet.Cells[cell.Key].Value&amp;nbsp;=&amp;nbsp;cell.Value;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span style="color: rgb(43, 145, 175);"&gt;Byte&lt;/span&gt;[]&amp;nbsp;bin&amp;nbsp;=&amp;nbsp;p.GetAsByteArray();
 
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span style="color: blue;"&gt;string&lt;/span&gt;&amp;nbsp;file&amp;nbsp;=&amp;nbsp;outputPath&amp;nbsp;+&amp;nbsp;newFileName;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Logger.LogInfo(&lt;span style="color: rgb(163, 21, 21);"&gt;"Writing&amp;nbsp;Excel&amp;nbsp;File&amp;nbsp;to&amp;nbsp;"&lt;/span&gt;&amp;nbsp;+&amp;nbsp;file);
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span style="color: rgb(43, 145, 175);"&gt;File&lt;/span&gt;.WriteAllBytes(file,&amp;nbsp;bin);
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Logger.LogInfo(&lt;span style="color: rgb(163, 21, 21);"&gt;"Writing&amp;nbsp;Done"&lt;/span&gt;);
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span style="color: blue;"&gt;catch&lt;/span&gt;&amp;nbsp;(&lt;span style="color: rgb(43, 145, 175);"&gt;Exception&lt;/span&gt;&amp;nbsp;ex)
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Logger.LogError(ex);
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br&gt;&lt;br&gt;Thanks in advance! :D &lt;/pre&gt;

        
    </Html>
        </Post>
        <Post From="hybrisCole" When="07/07/2011 22:50:36">
          <Html>
        
&lt;p&gt;This is pretty weird since if I remove the chart, everything works just fine,&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Regards,&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Cell's stylename">
      <Posts>
        <Post From="gbenrais" When="28/06/2011 16:23:23">
          <Html>
        
&lt;p&gt;Hello,&lt;/p&gt;
&lt;p&gt;I read an xlsm file using EPPlus. I am positively-sure-and-certain that a particular cell has style which is named "Base". Hence, I don't understand why the StyleName's property is "Normal".&lt;/p&gt;
&lt;p&gt;Thank's for your help,&lt;/p&gt;
&lt;p&gt;Ghislain&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="gbenrais" When="29/06/2011 18:49:16">
          <Html>
        
&lt;p&gt;Ok, I have the feeling nobody believes me. If so, try this :&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Open a new excel document &lt;/li&gt;&lt;li&gt;Select cell "A1" &lt;/li&gt;&lt;li&gt;Set style "Title 1" &lt;/li&gt;&lt;li&gt;Save and quit Excel &lt;/li&gt;&lt;li&gt;Run the following program : &lt;/li&gt;&lt;/ul&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;class&lt;/span&gt; MyTest
{
	&lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;static&lt;/span&gt; &lt;span style="color: blue;"&gt;void&lt;/span&gt; Run(&lt;span style="color: blue;"&gt;string&lt;/span&gt; FilePath)
	{
		FileInfo existingFile = &lt;span style="color: blue;"&gt;new&lt;/span&gt; FileInfo(FilePath);
		ExcelPackage package = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(existingFile);
		ExcelWorksheet worksheet = package.Workbook.Worksheets[1];
		ExcelRange cell = worksheet.Cells[1, 1];
            	Console.WriteLine(cell.StyleName);
	}
}
&lt;/pre&gt;
&lt;pre&gt;You will get "Normal" as the unwanted result.&lt;/pre&gt;
&lt;pre&gt;Any help will be geatly appreciated,&lt;/pre&gt;
&lt;pre&gt;Ghislain&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="30/06/2011 18:52:11">
          <Html>
        
&lt;p&gt;Humm, I think it is a bug too, but StyleId property looks fine...you can do a workaround, if you want to get stylename, do this:&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;        &lt;span style="color: blue;"&gt;static&lt;/span&gt; &lt;span style="color: blue;"&gt;void&lt;/span&gt; Main(&lt;span style="color: blue;"&gt;string&lt;/span&gt;[] args)
        {
            
            FileStream ff = &lt;span style="color: blue;"&gt;new&lt;/span&gt; FileStream(&lt;span style="color: rgb(163, 21, 21);"&gt;"a.xlsx"&lt;/span&gt;, FileMode.Open);
            ExcelPackage p = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(ff);

            &lt;span style="color: blue;"&gt;var&lt;/span&gt; ws = p.Workbook.Worksheets[1];
            &lt;span style="color: blue;"&gt;var&lt;/span&gt; cell = ws.Cells[1,1];

            Console.Write(cell.Value);
            Console.Write(p.Workbook.Styles.NamedStyles[cell.StyleID].Name);
                        
        }
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="30/06/2011 20:02:39">
          <Html>
        
&lt;p&gt;Hehe, I believe you, this is a bug.&amp;nbsp;The style name is not reed from the template.&amp;nbsp;I'll check in a fix tomorrow&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="gbenrais" When="01/07/2011 17:47:22">
          <Html>
        
&lt;p&gt;Hello all,&lt;/p&gt;
&lt;p&gt;I tried the workarount but nnfotunately cell.StyleID is not "always" the namedStyle's index. Thanks anyway,&lt;/p&gt;
&lt;p&gt;Ghislain&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="02/07/2011 03:22:39">
          <Html>
        
&lt;p&gt;Get the lastest version from trunk. Jan have already fixed this.&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="gbenrais" When="04/07/2011 13:38:53">
          <Html>
        
&lt;p&gt;Thanks a lot, I'm dying to use it but can't open the trunk with my Visual Studio 2008 nor with Visual Studio 2010 Express. Can I get the dll ?&lt;/p&gt;
&lt;p&gt;Ghislain&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="gbenrais" When="05/07/2011 10:02:21">
          <Html>
        
&lt;p&gt;Sorry for the previous post, I eventually understood that everything happens in 'ExcelPackage' project, which I compiled and it works fine with the sample workbook but not the workbook provided by the user. Actually, EPPLUS can't read worksheets, package.Workbook.worksheets.count
 = 0.&lt;/p&gt;
&lt;p&gt;If you're intersted I can provide the workbook.&lt;/p&gt;
&lt;p&gt;Thanks,&lt;/p&gt;
&lt;p&gt;Ghislain&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="gbenrais" When="07/07/2011 18:38:05">
          <Html>
        
&lt;p&gt;Sorry, a thousand apologies for being dummy, I didn't read no file...&lt;/p&gt;
&lt;p&gt;Anyway, cell.StyleName still returns "Normal" although it has a named style.&lt;/p&gt;
&lt;p&gt;I tried UpdateXml (I read about in the source comments).&lt;/p&gt;
&lt;p&gt;Thanks,&lt;/p&gt;
&lt;p&gt;Ghislain&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;FileInfo existingFile = &lt;span style="color: blue;"&gt;new&lt;/span&gt; FileInfo(FilePath); &lt;/pre&gt;
&lt;pre&gt;ExcelPackage package = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(existingFile); &lt;/pre&gt;
&lt;pre&gt;package.Workbook.Styles.UpdateXml(); &lt;/pre&gt;
&lt;pre&gt;ExcelWorksheet worksheet = package.Workbook.Worksheets[3]; &lt;/pre&gt;
&lt;pre&gt;ExcelRange cell = worksheet.Cells[4, 6]; &lt;/pre&gt;
&lt;pre&gt;Console.WriteLine(cell.StyleName);&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="how to remove a page field from a pivot table">
      <Posts>
        <Post From="chandrasiriguppa" When="07/07/2011 11:33:45">
          <Html>
        
&lt;p&gt;Hi&lt;/p&gt;
&lt;p&gt;Can someone help me out with code to remove a page field from a pivot table. I need to add same field as a row field.&lt;/p&gt;
&lt;p&gt;have tried 'pivottable.pagefields.remove(fld)' but it didnt work. field is still remains as page field and when i try to add the same field as row field system throws the below error.&lt;/p&gt;
&lt;p&gt;"The field is already a page or column field.can's add as a row field."&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;your help is really appreciated.&lt;/p&gt;
&lt;p&gt;Thanks,&lt;/p&gt;
&lt;p&gt;Chandrasekhar.S&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Axis Option">
      <Posts>
        <Post From="rajeevraina" When="05/07/2011 07:14:08">
          <Html>
        
&lt;p&gt;I need to change the axis options through code at the run time.&lt;/p&gt;
&lt;p&gt;The following is possible if I open the worksheet in Excel.&lt;/p&gt;
&lt;p&gt;E.g.&amp;nbsp; In case of a Bar Chart, right click on Y-Axis, Click Axis option and I have to click the check box (Categories in reverse Order).&lt;/p&gt;
&lt;p&gt;Is this possible through code during run-time? If yes then how?&lt;/p&gt;
&lt;p&gt;Please help.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="06/07/2011 13:58:18">
          <Html>
        
&lt;p&gt;I dont understand your problem. What do you mean about "run-time" ? When you are generating excel file or when you are using excel?!&lt;/p&gt;
&lt;p&gt;You can generate your excel file as you like, after user change any option in your aspx form and press a "Ok" button for example, you get all form values and do as you want.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="rajeevraina" When="06/07/2011 14:19:30">
          <Html>
        
&lt;p&gt;Thanks for the reply.&lt;/p&gt;
&lt;p&gt;You may have noticed that when ever you generate a Bar chart (nothing to do with EPPLUS at this stage) in EXCEL the data (bars) plotted is from highest row bar coming at the top of the chart and the first row bar coming at the bottom.&lt;/p&gt;
&lt;p&gt;E.g If the data range is A1:A15, the A15 bar shall be plotted at the top and A1 at the bottom.&lt;/p&gt;
&lt;p&gt;In orde to change this, excel provides a feature which I have mentioned in my previous post (right click on Y-Axis, Click Axis option and&amp;nbsp; click the check box "Categories in reverse Order") which reverses the order and First row bar comes to top&amp;nbsp;and
 last row bar goes to bottom in the chart.&lt;/p&gt;
&lt;p&gt;I was wondering if there is an option in EPPLUS, which I can use after generating the EXCEL and before saving it in my code (c#).&lt;/p&gt;
&lt;p&gt;I hope it is now clear.&lt;/p&gt;
&lt;p&gt;Regards&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="facing issues while trying to add a row field from a page field - Pivot table">
      <Posts>
        <Post From="chandrasiriguppa" When="06/07/2011 11:57:28">
          <Html>
        
&lt;p&gt;i have few page fields in my pivot table and i am adding this page field as a row field. i am getting an error while trying to do this. Sample code below&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;pivotTable.PageFields.Add(pivotTable.Fields["XYZ"]);&lt;/p&gt;
&lt;p&gt;pivotTable.DataOnRows = true;&lt;/p&gt;
&lt;p&gt;pivotTable.RowFields.Add(pivotTable.Fields["XYZ"]);&lt;span style="white-space: pre;"&gt;
&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;span style="white-space: pre;"&gt;w&lt;/span&gt;hen ever we add a row field which is available in page fields, this same field will be removed from page field and it adds up in the row field and the pivot table gets refreshes. Let me know how to handle this scenario
 in EPPlus. In excel dll it can be handled and as epplus is binary data i am not able to find the code for this scenario. Also there is no option for refreshing the data in pivot table with EPPlus dll.&lt;/p&gt;
&lt;p&gt;Your help will be appreciated.&lt;/p&gt;
&lt;p&gt;Thanks in advance.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Not able to provide 'DataFields' header">
      <Posts>
        <Post From="chandrasiriguppa" When="04/07/2011 13:13:39">
          <Html>
        
&lt;p&gt;Hi Jan,&lt;/p&gt;
&lt;p&gt;Hope you are doing good.. I have an issue while working on the pivot table. I have few Pagefields,rowfields and datafields added to the pivot table. &amp;nbsp;every thing works fine but there is a issue with the data field. Data field header is getting displayed
 above the rowfield and data field is headed as 'total'. i have set the grand totals to 'off'. Still i see the data field column header on top of the row field. Let me know how to handle this.&lt;/p&gt;
&lt;p&gt;Thanks,&lt;/p&gt;
&lt;p&gt;Chandrasekhar.S&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Medium Trust?">
      <Posts>
        <Post From="ckincincy" When="03/07/2011 00:48:48">
          <Html>
        
&lt;p&gt;I saw some older post regarding medium trust.&lt;/p&gt;
&lt;p&gt;What is the current status of Medium trust support?&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="chart export">
      <Posts>
        <Post From="mtagliaf" When="01/07/2011 15:03:35">
          <Html>
        
&lt;p&gt;Does the library support the export of Excel charts to image files?&amp;nbsp; Some other libraries like SpreadsheetGear, etc, support this, I would rather use your library if possible.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;thank you.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="01/07/2011 15:07:39">
          <Html>
        
&lt;p&gt;No, not yet...&lt;/p&gt;
&lt;p&gt;http://epplus.codeplex.com/discussions/233148&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mtagliaf" When="01/07/2011 15:23:44">
          <Html>
        
&lt;p&gt;The word "yet" is encouraging.&amp;nbsp; Is it on the future development roadmap?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="01/07/2011 15:32:21">
          <Html>
        
&lt;p&gt;I don´t know, I´m only being nice hehehe, only Jan can answer this.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Convert Excel 2003 XML structure to xlsx using EEPlus">
      <Posts>
        <Post From="aceinc" When="18/02/2011 22:53:20">
          <Html>
        
&lt;p&gt;I have a generalized routine written AS3 (Adobe Flex) that creates Excel 2003 xml style workbooks from datagrids. It works swimmingly.&lt;/p&gt;
&lt;p&gt;Once created it sends the xml to an aspx file on the server which then bounces (streams)&amp;nbsp;it back to the client.&amp;nbsp;It has an issue where Excel 2007, due to ﻿﻿﻿﻿Extension Hardening, gives a nasty error message about the
 file being potentially corrupt, and I do not see a way around it.&lt;/p&gt;
&lt;p&gt;After finding this project, I thought that if there was an existing method that would take the older xml file and convert it to the "new and improved" 2007 xlsx structure, it would resolve that issue. So the question is, does that capability exist?
 In this project?&lt;/p&gt;
&lt;p&gt;Paul&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="19/02/2011 00:25:55">
          <Html>
        
&lt;p&gt;No...and I think that will be more difficult than create a new one from scratch. If I were you, I will create another method to do a new parser from xml to xlsx.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="aceinc" When="19/02/2011 01:38:44">
          <Html>
        
&lt;p&gt;Since my Flex frontend actually creates the XML, I suppose I could create my own version of an xml structure and write a translator that reads that simplified xml and creates xlsx using EPPlus.&lt;/p&gt;
&lt;p&gt;Has anyone developed any standard interface to EPPlus, that I can create a data stream for&amp;nbsp;which would then be converted to an xlsx format?&lt;/p&gt;
&lt;p&gt;What I believe EPPlus is, is&amp;nbsp;an API available from .net that allows me to create workbooks. It effectively requires custom programming for each workbook I want to create.&lt;/p&gt;
&lt;p&gt;What I am looking for is something that I can shove data at that will understand the structure I shove at it, be it XML or something else, and would convert it to xlsx.&lt;/p&gt;
&lt;p&gt;Paul&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="21/02/2011 15:48:12">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;No,there is nothing build-in the component that converts from older formats.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="aceinc" When="21/02/2011 16:58:32">
          <Html>
        
&lt;p&gt;Would a simplistic implementation of importing excel 2003 xml structure be considered useful?&lt;/p&gt;
&lt;p&gt;By simplistic I mean something would migrate columns and rows, with no calculations, or other bells &amp;amp; whistles.&lt;/p&gt;
&lt;p&gt;Paul&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="22/02/2011 18:08:50">
          <Html>
        
&lt;p&gt;I guess it could be useful. If you plan to do&amp;nbsp;an implementation,&amp;nbsp;you are welcome to share it.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="scheelings" When="29/06/2011 10:11:06">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Is this functionalit already part of EPPlus? I think this is a great way to simply import a Excel 2003 file saved as Excel 2003 XML Worksheet!&lt;/p&gt;
&lt;p&gt;Danny&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="30/06/2011 19:58:25">
          <Html>
        
&lt;p&gt;No, there is no such functionality in version 2.9&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Image with delete row">
      <Posts>
        <Post From="fsage" When="27/06/2011 08:37:46">
          <Html>
        
&lt;p&gt;&lt;span lang="EN-US" style="color: rgb(48, 51, 45); font-size: 10pt;"&gt;Hello,&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span lang="EN-US" style="color: rgb(48, 51, 45); font-size: 10pt;"&gt;I'm sorry for my english.&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span lang="EN-US" style="color: rgb(48, 51, 45); font-size: 10pt;"&gt;In french at end.&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span lang="EN" style="color: rgb(48, 51, 45); font-size: 10pt;"&gt;I created&lt;/span&gt; an Excel file and I put pictures on some cells with the statement :&lt;/p&gt;
&lt;p&gt;&lt;span lang="EN-US" style="color: red; font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; Dim&amp;nbsp;F as&amp;nbsp;FileInfo = New FileInfo(NomImage)
&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span lang="EN-US" style="color: rgb(48, 51, 45); font-size: 10pt;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span lang="EN-US" style="color: red; font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Dim Pic As OfficeOpenXml.Drawing.ExcelPicture = ws.Drawings.AddPicture("Legende" + &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Ligne.ToString
 + "_"+ Colonne.ToString, f)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span lang="EN-US" style="color: red; font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Pic.From.Column = Colonne - 1&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span lang="EN-US" style="color: red; font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Pic.From.Row = Ligne - 1&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span lang="EN-US" style="color: red; font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Pic.SetSize(100)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span lang="EN" style="color: rgb(48, 51, 45); font-size: 10pt;"&gt;In Excel 2007,&lt;/span&gt; when I delete rows with images, images of the deleted row are placed on the line below.&lt;/p&gt;
&lt;p&gt;&lt;span lang="EN-US" style="color: rgb(48, 51, 45); font-size: 10pt;"&gt;It's a bug ?&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span lang="EN-US" style="color: rgb(48, 51, 45); font-size: 10pt;"&gt;Bests regards,&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(48, 51, 45); font-size: 10pt;"&gt;Fabrice.&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(48, 51, 45); font-size: 10pt;"&gt;---------------------&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(48, 51, 45); font-size: 10pt;"&gt;In french&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(48, 51, 45); font-size: 10pt;"&gt;J'ai créé un fichier Excel et je place des images sur certains cellules avec l'instruction :&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: red; font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;/span&gt;&lt;span lang="EN-US" style="color: red; font-size: 10pt;"&gt;Dim&amp;nbsp;F as&amp;nbsp;FileInfo = New FileInfo(NomImage)
&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span lang="EN-US" style="color: rgb(48, 51, 45); font-size: 10pt;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span lang="EN-US" style="color: red; font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Dim Pic As OfficeOpenXml.Drawing.ExcelPicture = ws.Drawings.AddPicture("Legende" + Ligne.ToString + "_"+ Colonne.ToString,
 f)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span lang="EN-US" style="color: red; font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Pic.From.Column = Colonne - 1&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span lang="EN-US" style="color: red; font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Pic.From.Row = Ligne - 1&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span lang="EN-US" style="color: red; font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Pic.SetSize(100)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(48, 51, 45); font-size: 10pt;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: black; font-size: 10pt;"&gt;Dans Excel 2007, lorsque je supprime les lignes avec images, les images se placent sur la ligne dessous.&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(48, 51, 45); font-size: 10pt;"&gt;Est-ce normal ?&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(48, 51, 45); font-size: 10pt;"&gt;Cordialement,&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(48, 51, 45); font-size: 10pt;"&gt;Fabrice&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(48, 51, 45); font-size: 10pt;"&gt;&amp;nbsp;&lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="27/06/2011 13:57:46">
          <Html>
        
&lt;p&gt;I think it is an expect behavior from excel, you´ve added a picture to a coordinate, not inside row/column.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="fsage" When="27/06/2011 16:09:47">
          <Html>
        
&lt;p&gt;Hello,&lt;/p&gt;
&lt;p&gt;If i use this code&lt;/p&gt;
&lt;p&gt;&lt;span style="font-size: x-small;"&gt;&amp;nbsp;&amp;nbsp; &amp;nbsp;Pic.SetPosition(100, 100)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-size: x-small;"&gt;I have the same problem.&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-size: x-small;"&gt;&amp;nbsp;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-size: x-small;"&gt;They are others méthod ?&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-size: x-small;"&gt;&amp;nbsp;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-size: x-small;"&gt;&amp;nbsp;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-size: x-small;"&gt;Best regard.&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-size: x-small;"&gt;Fabrice&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-size: x-small;"&gt;&amp;nbsp;&lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="30/06/2011 19:53:13">
          <Html>
        
&lt;p&gt;The InsertRow and DeleteRow only shift cells and update formulas in this version.&lt;/p&gt;
&lt;p&gt;Pictures, Drawings, charts, comments, tabels and pivottables&amp;nbsp;&amp;nbsp;are not effected by the InsertRow or DeleteRow methods.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Data Validation Issue">
      <Posts>
        <Post From="pcotgrove" When="23/06/2011 11:09:44">
          <Html>
        
&lt;p&gt;If I add a new sheet to a workbook and add in a Data Validation List my code works.&lt;/p&gt;
&lt;p&gt;If however I open an existing sheet or copy a sheet the Data Validation causes the workbook to become corrupt and excel will open it correctly!&lt;/p&gt;
&lt;p&gt;Is there a workaround for this as I need to copy a sheet which contains some VBA and conditional formatting&lt;/p&gt;
&lt;p&gt;Also, is there way to rename a sheet other than copy and then delete the original?&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="30/06/2011 19:46:02">
          <Html>
        
&lt;p&gt;Conditional formatting is not supported in the current version, so if you&amp;nbsp;use that in your template you can get unexpected errors. I'll have a look at your issue (13721) later.&lt;/p&gt;
&lt;p&gt;To rename a sheet just set the Worksheet.name property.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Subscript and Superscript part of a value">
      <Posts>
        <Post From="richyrich" When="30/06/2011 11:14:57">
          <Html>
        
&lt;p&gt;I am attempting to use EPPlus to create a .xlsx file from database data. It is all working apart from values that contain subscripted and superscripted text.&lt;/p&gt;
&lt;p&gt;The data is stored like so "Some Normal Text&amp;lt;sub&amp;gt;Subscripted&amp;lt;/sub&amp;gt; Some other text &amp;lt;sup&amp;gt;superscripted&amp;lt;/sup&amp;gt; some other text". So it stores the html tags.&lt;/p&gt;
&lt;p&gt;If I allocate the Value property of a cell to this:-&lt;/p&gt;
&lt;pre style="padding-left: 30px;"&gt;worksheet.Cells[index, 3].Value = p.name;&lt;/pre&gt;
&lt;p&gt;then I just get the exact text in the cell including the &amp;lt;sub&amp;gt; and &amp;lt;sup&amp;gt; as text.&lt;/p&gt;
&lt;p&gt;Using the Style attribute of a cell, I can set it to be superscript or subscript&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre style="padding-left: 30px;"&gt;worksheet.Cells[index, 3].Style.Font.VerticalAlign = OfficeOpenXml.Style.ExcelVerticalAlignmentFont.Subscript;
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;but that changes the whole cell. I only want to change certain parts of the cell value.&lt;/p&gt;
&lt;p&gt;Any ideas how I can do this?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="30/06/2011 12:18:59">
          <Html>
        
&lt;p&gt;If you want to mix styles in one cell you need to use RichText property.&lt;/p&gt;
&lt;p&gt;If RichText Class doesnt have what you want, you need to do by your own.. like in older versions. http://epplus.codeplex.com/discussions/207785&lt;/p&gt;
&lt;p&gt;Based on Jan´s example here....http://epplus.codeplex.com/discussions/236637&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;        &lt;span style="color: blue;"&gt;static&lt;/span&gt; &lt;span style="color: blue;"&gt;void&lt;/span&gt; Main(&lt;span style="color: blue;"&gt;string&lt;/span&gt;[] args)
        {

            FileInfo f = &lt;span style="color: blue;"&gt;new&lt;/span&gt; FileInfo(DateTime.Now.Ticks + &lt;span style="color: rgb(163, 21, 21);"&gt;".xlsx"&lt;/span&gt;);
            ExcelPackage p = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(f);

            &lt;span style="color: blue;"&gt;var&lt;/span&gt; ws =  p.Workbook.Worksheets.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"f"&lt;/span&gt;);
            ws.Cells[1, 1].IsRichText = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
 
            &lt;span style="color: blue;"&gt;var&lt;/span&gt; rs = ws.Cells[1,1].RichText;
            &lt;span style="color: blue;"&gt;var&lt;/span&gt; r1 = rs.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"Blue "&lt;/span&gt;);
            r1.Color = Color.Blue;
            r1.Bold = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
            r1.VerticalAlign = OfficeOpenXml.Style.ExcelVerticalAlignmentFont.Subscript;
            
            &lt;span style="color: blue;"&gt;var&lt;/span&gt; r2 = rs.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"Red"&lt;/span&gt;);
            r2.Color = Color.Red;
            r2.VerticalAlign = OfficeOpenXml.Style.ExcelVerticalAlignmentFont.Superscript;

            p.Save();
        }



&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="richyrich" When="30/06/2011 13:13:00">
          <Html>
        
&lt;p&gt;&amp;lt;edit&amp;gt;Just seen the code example you posted. So, you have to create an instance of the RichText collection to then add subscript to it, I guess?&amp;lt;/edit&amp;gt;&lt;/p&gt;
&lt;p&gt;Thanks for the reply. I was just reading up about it.&lt;/p&gt;
&lt;p&gt;What I think I need to do is iterate through the string property and then subscript and superscript the text between the HTML tags. Am just struggling with the syntax at the moment.&lt;/p&gt;
&lt;p&gt;Can you just keep calling RichText.Add within a loop and it appends the text to the value in the cell already? This is basically what I have at the moment:-&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;                    &lt;span style="color: blue;"&gt;if&lt;/span&gt; (oName.IndexOf(&lt;span style="color: rgb(163, 21, 21);"&gt;"&amp;lt;sup&amp;gt;"&lt;/span&gt;) != -1)
                    {
                        cName = cName.Substring(cIndex, cName.IndexOf(&lt;span style="color: rgb(163, 21, 21);"&gt;"&amp;lt;sup&amp;gt;"&lt;/span&gt;));
                        cIndex = oName.IndexOf(&lt;span style="color: rgb(163, 21, 21);"&gt;"&amp;lt;sup&amp;gt;"&lt;/span&gt;, cIndex);
                        &lt;span style="color: blue;"&gt;if&lt;/span&gt; (cName.Length != 0) worksheet.Cells[index, 3].RichText.Add(cName);
                        rName = oName.Substring(cIndex, ((oName.Length - 1) - cIndex));
                        &lt;span style="color: blue;"&gt;while&lt;/span&gt; (rName.IndexOf(&lt;span style="color: rgb(163, 21, 21);"&gt;"&amp;lt;sup&amp;gt;"&lt;/span&gt;) != -1)
                        {
                            cName = oName.Substring((cIndex + 5), (oName.IndexOf(&lt;span style="color: rgb(163, 21, 21);"&gt;"&amp;lt;/sup&amp;gt;"&lt;/span&gt;, cIndex) - (cIndex + 5)));
                            cIndex = oName.IndexOf(&lt;span style="color: rgb(163, 21, 21);"&gt;"&amp;lt;sup&amp;gt;"&lt;/span&gt;, cIndex);
                            &lt;span style="color: blue;"&gt;if&lt;/span&gt; (cName.Length != 0) worksheet.Cells[index, 3].RichText.Add(cName).VerticalAlign = OfficeOpenXml.Style.ExcelVerticalAlignmentFont.Superscript;
                            rName = oName.Substring((cIndex + 5), ((oName.Length - 1) - (cIndex + 5)));
                        }
                        &lt;span style="color: blue;"&gt;if&lt;/span&gt; (rName.Length != 0) worksheet.Cells[index, 3].RichText.Add(rName);
                    }
&lt;br&gt;I'm unsure if my logic is right at the moment, but do these lines look right?&lt;br&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;pre&gt;worksheet.Cells[index, 3].RichText.Add(cName);&lt;br&gt;worksheet.Cells[index, 3].RichText.Add(cName).VerticalAlign = OfficeOpenXml.Style.ExcelVerticalAlignmentFont.Superscript;&lt;/pre&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Copy worksheet from workbook 1 to new worksheet in workbook2">
      <Posts>
        <Post From="tsjoe" When="29/06/2011 15:21:41">
          <Html>
        
&lt;p&gt;Hello, i'm amazed by the work of EPP and i want to thank all contributors to this project.&lt;/p&gt;
&lt;p&gt;Now, i'm posting a new discussion because i'm facing a problem of copying worksheet from workbook1 to workbook 2.&lt;/p&gt;
&lt;p&gt;Here is my Code below:&amp;nbsp;&lt;/p&gt;
&lt;p&gt;---------------------------------------------------------------------------------------------&lt;/p&gt;
&lt;p&gt;&lt;span style="white-space: pre;"&gt;&lt;/span&gt;DirectoryInfo cheminDossierEnfant = new DirectoryInfo(subDirectory);&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;span style="white-space: pre;"&gt;&lt;/span&gt;string[] excelFiles = Directory.GetFiles(subDirectory, "*.xlsx");&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; string dossierNom = cheminDossierEnfant.Name;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;span style="white-space: pre;"&gt;&lt;/span&gt;int intLastSlash = subDirectory.LastIndexOf("\\");&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;span style="white-space: pre;"&gt;&lt;/span&gt;string stringCheminFolderFinal = subDirectory.Remove(intLastSlash);&lt;/p&gt;
&lt;p&gt;&lt;span style="white-space: pre;"&gt;&lt;/span&gt;&amp;nbsp;FileInfo fichierFinal = new FileInfo(stringCheminFolderFinal + @"\" + dossierNom + ".xlsx");&lt;br&gt;
&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;FileInfo template = new FileInfo(@"C:\Template.xlsx");&lt;br&gt;
&lt;span style="white-space: pre;"&gt;&lt;/span&gt;&amp;nbsp; &amp;nbsp; ExcelPackage xlpackage = new ExcelPackage(fichierFinal, template);&amp;nbsp; &amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ExcelWorkbook destiBook = xlpackage.Workbook;&amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; ExcelWorksheet sheetFeuilUn = destiBook.Worksheets["Feuil1"];&amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; foreach (string item in excelFiles)&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &amp;nbsp; {&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;span style="white-space: pre;"&gt;&lt;/span&gt;FileInfo fichierExcelEnCours = null;&lt;br&gt;
&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ExcelPackage packageFichierSource = null;&lt;/p&gt;
&lt;p&gt;&lt;span style="white-space: pre;"&gt;&lt;/span&gt;&amp;nbsp;ExcelWorkbook sourceBook = null;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;span style="white-space: pre;"&gt;&lt;/span&gt;ExcelWorksheet sourceSheet = null;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;span style="white-space: pre;"&gt;&lt;/span&gt;ExcelWorksheet fichierFinalWorksheet = null;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;span style="white-space: pre;"&gt;&lt;/span&gt;fichierExcelEnCours = new FileInfo(item.ToString());&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; packageFichierSource = new ExcelPackage(fichierExcelEnCours);&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; sourceBook = packageFichierSource.Workbook;&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; sourceSheet = sourceBook.Worksheets["Fiche projet"];&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; fichierFinalWorksheet = destiBook.Worksheets.Add(fichierExcelEnCours.Name);&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; destiBook.StylesXml.InnerXml = sourceBook.StylesXml.InnerXml;&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; for (int i = 1; i &amp;lt; 60; i++)&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;span style="white-space: pre;"&gt;&lt;/span&gt;{&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; for (int y = 1; y &amp;lt; 19; y++)&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;span style="white-space: pre;"&gt;&lt;/span&gt;{&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; if (sourceSheet.Cells[i, y].Value != null)&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;span style="white-space: pre;"&gt;&lt;/span&gt;{&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; fichierFinalWorksheet.Cells[i, y].Value = sourceSheet.Cells[i, y].Value;&amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;span style="white-space: pre;"&gt;
&lt;/span&gt;&amp;nbsp; &amp;nbsp; fichierFinalWorksheet.Cells[i, y].Formula = sourceSheet.Cells[i, y].Formula;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;span style="white-space: pre;"&gt;
&lt;/span&gt;&amp;nbsp; fichierFinalWorksheet.Cells[i, y].Style.Border = sourceSheet.Cells[i, y].Style.Border;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="white-space: pre;"&gt;
&lt;/span&gt;&amp;nbsp; fichierFinalWorksheet.Cells[i, y].Style.Font.Family = sourceSheet.Cells[i, y].Style.Font.Family;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;span style="white-space: pre;"&gt;
&lt;/span&gt;&amp;nbsp; &amp;nbsp; fichierFinalWorksheet.Cells[i, y].Style.Font.Bold = sourceSheet.Cells[i, y].Style.Font.Bold;&amp;nbsp; &amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="white-space: pre;"&gt;
&lt;/span&gt;fichierFinalWorksheet.Cells[i, y].Style.Numberformat = sourceSheet.Cells[i, y].Style.Numberformat;&amp;nbsp; &amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="white-space: pre;"&gt;
&lt;/span&gt;fichierFinalWorksheet.Cells[i, y].StyleID = sourceSheet.Cells[i, y].StyleID;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &amp;nbsp;&lt;span style="white-space: pre;"&gt; &lt;/span&gt;&amp;nbsp; &amp;nbsp; }&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &amp;nbsp;&lt;span style="white-space: pre;"&gt; &lt;/span&gt;else&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;span style="white-space: pre;"&gt;&lt;/span&gt;&amp;nbsp; {&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;span style="white-space: pre;"&gt;&lt;/span&gt;fichierFinalWorksheet.Cells[i, y].StyleID = sourceSheet.Cells[i, y].StyleID;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;span style="white-space: pre;"&gt;&lt;/span&gt;&amp;nbsp; }&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &lt;span style="white-space: pre;"&gt;&lt;/span&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &lt;span style="white-space: pre;"&gt;&lt;/span&gt;&amp;nbsp; }&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &amp;nbsp; packageFichierSource.Dispose();&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; xlpackage.Workbook.Worksheets.MoveBefore(fichierFinalWorksheet.Name, sheetFeuilUn.Name);&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp; }&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp; xlpackage.Save();&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp; xlpackage.Dispose();&lt;/p&gt;
&lt;p&gt;-------------------------------------------------------------------------------------------------------------&lt;/p&gt;
&lt;p&gt;Let me explain my goal :&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I've got a directory where his subdirectories contains a lot of Excel files (.xlsx).&lt;/p&gt;
&lt;p&gt;I need to copy every worksheets named "Fiche Projet" in a final Excel File with the name of my subdirectory.&lt;/p&gt;
&lt;p&gt;The problem is "style" and some "value" and "formula" are well copied. But from every "Fiche projet" worksheet, there aren't rows 35 to 39&lt;/p&gt;
&lt;p&gt;and i don't understand why my condition doesn't work when i open my final Excel file.&amp;nbsp;&lt;/p&gt;
&lt;p&gt;By the way, merged cells doesn't work very well, cause all the value are staying in the specified cell and it isn't extended like my "Fiche projet" worksheet. (I verify with Excel 2007).&lt;/p&gt;
&lt;p&gt;I hope i can get some answer from every user of EPP.&lt;/p&gt;
&lt;p&gt;Thank you for reading my discussion.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Refresh Pivot Chart">
      <Posts>
        <Post From="kidproquo" When="29/07/2010 20:08:29">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;First of all - great work! This is a very useful tool and I appreciate the effort.&lt;/p&gt;
&lt;p&gt;I have used EPPlus to generate xlsx files based &amp;nbsp;on a template containing pivot charts. I populate a Sheet1 with dynamic data which is supposed to be used to display pivot charts in separate tabs. The data gets populated but the pivot charts do not
 reflect the new data - I have to manually right-click on any one of the charts and select "Refresh" which refreshes all of the charts. Any way to do this refresh from code?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Regards,&lt;/p&gt;
&lt;p&gt;Kid.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="01/08/2010 11:04:19">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;There is no support for Pivot charts/tables in the current version, so&amp;nbsp;I have not tried it.&lt;/p&gt;
&lt;p&gt;I plan to add support for&amp;nbsp;it&amp;nbsp;in a future version, if it's not too complicated, but i'm not sure when that will happend.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="kidproquo" When="02/08/2010 15:40:31">
          <Html>
        Jan, I found a fix for this. Right click on the pivot table and click PivotTable Options. Select the Data tab and check the option to refresh on opening the workbook. Save the template. Regards, Kid
        
    </Html>
        </Post>
        <Post From="chandrasiriguppa" When="06/05/2011 13:33:59">
          <Html>
        
&lt;p&gt;Hi Jan,&lt;/p&gt;
&lt;p&gt;i am looking for a support to create a pivot chart using EPPlus. Could you help me out with a sample project or so... &amp;nbsp;Few topics that are available in excel object i am not able to see in EPPlus. I guess i am not lookin in right way.. Your help is
 appreciated.&lt;/p&gt;
&lt;p&gt;need what object to be used as replacement for 'pivotcaches' in excel.&lt;/p&gt;
&lt;p&gt;Thanks in advance..&lt;/p&gt;
&lt;p&gt;Chandrasekhar.S&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="09/05/2011 18:23:51">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Version 2.8 don't support pivottable, but the next version will. Download the latest source (trunk)&amp;nbsp;and check out sample 12 how to work with pivottables.&lt;/p&gt;
&lt;p&gt;Next version is only a few weeks away, so please report any problem you find.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="chandrasiriguppa" When="11/05/2011 11:56:57">
          <Html>
        
&lt;p&gt;Hi Jan,&lt;/p&gt;
&lt;p&gt;Thanks for your reply... I have seen the code in sample 12 and i am eagerly waiting for the new dll version to be released. With the current dll i am not able to use the below namespaces&lt;/p&gt;
&lt;pre&gt;OfficeOpenXml.Table.PivotTable
OfficeOpenXml.Drawing.Chart&lt;/pre&gt;
&lt;pre&gt;&lt;br&gt;&lt;/pre&gt;
&lt;pre&gt;How can i subscribe for the latest version release?&lt;/pre&gt;
&lt;pre&gt;&lt;br&gt;&lt;/pre&gt;
&lt;pre&gt;Thanks,&lt;/pre&gt;
&lt;pre&gt;Chandrasekhar S&lt;/pre&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="12/05/2011 18:52:28">
          <Html>
        
&lt;p&gt;If everything&amp;nbsp;goes well with the testing version 2.9 will be released next week or the week after that.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="chandrasiriguppa" When="23/06/2011 12:09:23">
          <Html>
        
&lt;p&gt;Hi Jan,&lt;/p&gt;
&lt;p&gt;Congrats for the release of new version. I have tried working on this dll and was not able to find few details. Help me out how to solve this. I need to create a pivot table from a set of data that is available in another work sheet from same xlsx file which
 i am working. Could you help me with any sample code if you have any. 'Loadfromtext' is not working fine for me.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Chandrasekhar.S&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="reading rich text">
      <Posts>
        <Post From="fschwiet" When="20/06/2011 23:43:40">
          <Html>
        
&lt;p&gt;&amp;nbsp; I"d like to read a cell value that has bold and italicized text.&amp;nbsp; I'd presume this is RichText :).&amp;nbsp; I've been having problems- I can read the text but I haven't been able to get the Bold/Italic boundaries.&lt;/p&gt;
&lt;p&gt;&amp;nbsp; I'm using the below code to output richtext with some formatting as HTML.&amp;nbsp; What I'm seeing though is that the Cell.RichText only has one part which contains the entire text (part.Bold and part.Italic is false).&amp;nbsp; Cell.Text is an empty string.&amp;nbsp;
 Is there another way to do this?&lt;/p&gt;
&lt;p&gt;(btw, nice library.&amp;nbsp; Day &lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/1"&gt;#1&lt;/a&gt; I was importing/exporting with good results)&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; string GetRichTextAsHtml(ExcelRangeBase cell)&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; StringBuilder sb = new StringBuilder();&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; foreach(var part in cell.RichText)&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; if (part.Bold)&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; sb.Append("&amp;lt;b&amp;gt;");&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; if (part.Italic)&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; sb.Append("&amp;lt;i&amp;gt;");&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; sb.Append(part.Text);&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; if (part.Italic)&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; sb.Append("&amp;lt;/i&amp;gt;");&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; if (part.Bold)&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; sb.Append("&amp;lt;/b&amp;gt;");&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; return sb.ToString();&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="22/06/2011 19:37:45">
          <Html>
        
&lt;p&gt;No, this should be the way to do it. I'll have a look at it.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="fschwiet" When="22/06/2011 21:56:14">
          <Html>
        
&lt;p&gt;Thanks, let me know if there are any questions.&amp;nbsp; The xlsx file was created in EPPlus, then manually edited to add bold.&amp;nbsp; I just hit ctrl+B or ctrl+I while highlighting some text in a field.&amp;nbsp; Thats all I tried though, so I don't know the repro
 steps need to be so specific.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Date Format in Worksheet Cell from DataTable">
      <Posts>
        <Post From="harrisonm" When="16/06/2011 11:07:03">
          <Html>
        
&lt;p&gt;Hi When using the epplus library like this:&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;].LoadFromDataTable(dt, &lt;span style="color: blue;"&gt;true&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;If the Datatable contains a date e.g. 05/05/2011 it converts it to a numeric value of 40668.&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Looking in the worksheet xml, this renders (as an example):&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;c&lt;/span&gt; &lt;span style="color: red;"&gt;r&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;J14&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: red;"&gt;s&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;0&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
    &lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;v&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;40668&lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;v&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
&lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;c&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;When I open the worksheet in Excel and Modify the cell to Date, it changes the above XML to&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;c&lt;/span&gt; &lt;span style="color: red;"&gt;r&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;J14&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: red;"&gt;s&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;1&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
    &lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;v&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;40668&lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;v&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
&lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;c&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;I was just wondering if I can set this flag to 1 based on the datatype from the datatable, and if so - what the syntax would be, as I cant find it in the documentation&lt;/p&gt;
&lt;p&gt;Thanks, Mark&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="harrisonm" When="16/06/2011 11:10:37">
          <Html>
        
&lt;p&gt;Apologies, I have just searched and found your other discussion:&amp;nbsp;&lt;a href="http://epplus.codeplex.com/discussions/259085" rel="nofollow"&gt;http://epplus.codeplex.com/discussions/259085&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Thanks, mark&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="harrisonm" When="16/06/2011 12:08:03">
          <Html>
        
&lt;p&gt;I still cant work out how to get it to apply the style to a set of cells (only for certain columns) so any code advice would be greatly received :-)&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="16/06/2011 16:43:00">
          <Html>
        
&lt;p&gt;Have a look at the sample project, you have several samples of how to do it there. Heres a simple example...&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;worksheet.Cells[1,1,15,2].Style.NumberFormat.Format=&lt;span style="color: rgb(163, 21, 21);"&gt;"#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;"&lt;/span&gt;;
&lt;span style="color: green;"&gt;//or&lt;/span&gt;
worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A1:B15"&lt;/span&gt;].Style.NumberFormat.Format=&lt;span style="color: rgb(163, 21, 21);"&gt;"#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;"&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="harrisonm" When="16/06/2011 16:56:07">
          <Html>
        
&lt;p&gt;Hi Jan&lt;/p&gt;
&lt;p&gt;Thanks I have written some additional code in order to do it in a generic fashion for any column in the DataTable (without putting smelly patches in the ExcelRangeBase class I downloaded:&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;var&lt;/span&gt; rowCount = dt.Rows.Count;
&lt;span style="color: blue;"&gt;var&lt;/span&gt; worksheet = package.Workbook.Worksheets.Add(repName + &lt;span style="color: rgb(163, 21, 21);"&gt;"_"&lt;/span&gt; + (i + 1));
worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;].LoadFromDataTable(dt, &lt;span style="color: blue;"&gt;true&lt;/span&gt;);
&lt;span style="color: blue;"&gt;var&lt;/span&gt; dateColumns = &lt;span style="color: blue;"&gt;from&lt;/span&gt; DataColumn d &lt;span style="color: blue;"&gt;in&lt;/span&gt; dt.Columns
				  &lt;span style="color: blue;"&gt;where&lt;/span&gt; d.DataType == &lt;span style="color: blue;"&gt;typeof&lt;/span&gt;(DateTime) || d.ColumnName.Contains(&lt;span style="color: rgb(163, 21, 21);"&gt;"Date"&lt;/span&gt;)
				  &lt;span style="color: blue;"&gt;select&lt;/span&gt; d.Ordinal + 1;

&lt;span style="color: blue;"&gt;foreach&lt;/span&gt; (&lt;span style="color: blue;"&gt;var&lt;/span&gt; dc &lt;span style="color: blue;"&gt;in&lt;/span&gt; dateColumns)
{
	worksheet.Cells[2, dc, rowCount + 1, dc].Style.Numberformat.Format = &lt;span style="color: rgb(163, 21, 21);"&gt;"dd/mm/yyyy"&lt;/span&gt;;
}
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;Thanks for your help, Mark&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Workbook protection">
      <Posts>
        <Post From="lvorburger" When="15/06/2011 15:39:13">
          <Html>
        
&lt;p&gt;Hi&lt;/p&gt;
&lt;p&gt;When enabling structure protection on a given workbook, windows protection is activated at the same time (ie&amp;nbsp;I can't minimize/maximize a workbook inside the excel main windows any more)&lt;/p&gt;
&lt;p&gt;Is that the expected behavior ?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Ludovic&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="16/06/2011 16:29:48">
          <Html>
        This discussion has been copied to a work item. Click &lt;a href="http://epplus.codeplex.com/workitem/13685" rel="nofollow"&gt;
here&lt;/a&gt; to go to the work item and continue the discussion.
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Having problems making linechart">
      <Posts>
        <Post From="davidmwilliams" When="15/06/2011 15:18:40">
          <Html>
        
&lt;p&gt;Hi all,&lt;/p&gt;
&lt;p&gt;First, thanks for making this terrific library.&lt;/p&gt;
&lt;p&gt;Now, my problem is that I'm trying to make a line chart but I'm not really clear on what I need to be doing. I can make a chart appear but it certainly isn't plotting my data.&lt;/p&gt;
&lt;p&gt;Any hints appreciated !!&lt;/p&gt;
&lt;p&gt;This is my code -&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;                    worksheet.Cells[RowNumber++, 3].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"Historical"&lt;/span&gt;;
                    &lt;span style="color: blue;"&gt;int&lt;/span&gt; GraphRow = RowNumber;

                    &lt;span style="color: blue;"&gt;for&lt;/span&gt; (&lt;span style="color: blue;"&gt;int&lt;/span&gt; i = Month - 6; i &amp;lt;= Month; i++)
                    {
                        &lt;span style="color: blue;"&gt;int&lt;/span&gt; AdjustedYear = Year;
                        &lt;span style="color: blue;"&gt;int&lt;/span&gt; AdjustedMonth = i;

                        &lt;span style="color: blue;"&gt;if&lt;/span&gt; (i &amp;lt; 1)
                        {
                            AdjustedYear--;
                            AdjustedMonth = 12 + i;
                        }

                        worksheet.Cells[GraphRow, 3 + i].Value = AdjustedMonth.ToString() + "/" + AdjustedYear.ToString();
                        worksheet.Cells[GraphRow + 1, 3 + i].Value = &lt;em&gt;&lt;span style="color: rgb(0, 0, 255);"&gt;SQL query here to return a value .....&lt;/span&gt;&lt;/em&gt;;
                    }
                    RowNumber++;
                    RowNumber++;

                    &lt;span style="color: green;"&gt;// Insert graph&lt;/span&gt;
                    &lt;span style="color: green;"&gt;// TODO: Fix graph - it is crap&lt;/span&gt;
                    &lt;span style="color: blue;"&gt;var&lt;/span&gt; absenceChart = worksheet.Drawings.AddChart(&lt;span style="color: rgb(163, 21, 21);"&gt;"Absences"&lt;/span&gt;+RosterID, eChartType.Line3D);
                    absenceChart.From.Row = RowNumber;
                    absenceChart.From.Column = 1;
                    absenceChart.To.Row = RowNumber + 4;
                    absenceChart.To.Column = 7;
                    &lt;span style="color: blue;"&gt;string&lt;/span&gt; LabelRange = &lt;span style="color: rgb(163, 21, 21);"&gt;"D"&lt;/span&gt; + GraphRow.ToString() + &lt;span style="color: rgb(163, 21, 21);"&gt;":I"&lt;/span&gt; + GraphRow.ToString();
                    &lt;span style="color: blue;"&gt;string&lt;/span&gt; DataRange = &lt;span style="color: rgb(163, 21, 21);"&gt;"D"&lt;/span&gt; + (GraphRow + 1).ToString() + &lt;span style="color: rgb(163, 21, 21);"&gt;":I"&lt;/span&gt; + (GraphRow + 1).ToString();
                    absenceChart.Series.Add(worksheet.Cells[LabelRange], worksheet.Cells[DataRange]);

                    RowNumber += 6;
&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="16/06/2011 08:10:11">
          <Html>
        
&lt;p&gt;Can't see anything obviously wrong. Look at the series in Excel and see if the point to the correct range.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Create a Summary line">
      <Posts>
        <Post From="cyrilwallace" When="14/06/2011 15:44:07">
          <Html>
        
&lt;p&gt;All,&lt;/p&gt;
&lt;p&gt;I want to create a summary line that will total a number of columns after I have called LoadFromCollection. Is this possible for the "Total Row" to have the same style as the range that was just loaded?&lt;/p&gt;
&lt;p&gt;I will not know how many rows my range will contain. I want to move to the next row after the range and create my summary row that will Sum a number of columns from beginning at row 9 as this is where my range starts at.&lt;/p&gt;
&lt;p&gt;e.g.&lt;/p&gt;
&lt;p&gt;var dataRange = ws.Cells["A8"].LoadFromCollection(&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; from r in reportEntity.SettlementReportDetails&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; group r by r.PriceCurrency&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; into p&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; select new&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; PriceCurrency = p.Key,&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ExchangeRate = p.Sum(i =&amp;gt;
 i.ExchangeRate),&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; NoOfTransactions = p.Sum(i=&amp;gt;i.NoOfTransactions),&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; UnitTotal = p.Sum(i =&amp;gt; i.UnitValue),&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; PriceTotal = p.Sum(i =&amp;gt; i.PriceValue),&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; SettlementTotal = p.Sum(i =&amp;gt;
 i.SettlementValue),&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }, true, TableStyles.Light10);&lt;/p&gt;
&lt;p&gt;Result:&lt;/p&gt;
&lt;table width="695" height="193" border="0" cellspacing="0" cellpadding="0"&gt;
&lt;colgroup&gt;&lt;col width="136" style="width: 102pt;"&gt;&lt;col width="109" style="width: 82pt;"&gt;&lt;col width="133" style="width: 100pt;"&gt;&lt;col width="79" style="width: 59pt;"&gt;&lt;col width="84" style="width: 63pt;"&gt;&lt;col width="122" style="width: 92pt;"&gt;&lt;/colgroup&gt;
&lt;tbody&gt;
&lt;tr height="20" style="height: 15pt;"&gt;
&lt;td width="136" height="20" style="width: 102pt; height: 15pt;"&gt;PriceCurrency&lt;/td&gt;
&lt;td width="109" style="width: 82pt;"&gt;ExchangeRate&lt;/td&gt;
&lt;td width="133" style="width: 100pt;"&gt;NoOfTransactions&lt;/td&gt;
&lt;td width="79" style="width: 59pt;"&gt;UnitTotal&lt;/td&gt;
&lt;td width="84" style="width: 63pt;"&gt;PriceTotal&lt;/td&gt;
&lt;td width="122" style="width: 92pt;"&gt;SettlementTotal&lt;/td&gt;
&lt;/tr&gt;
&lt;tr height="20" style="height: 15pt;"&gt;
&lt;td height="20" style="height: 15pt;"&gt;EUR&lt;/td&gt;
&lt;td align="right"&gt;1.46505&lt;/td&gt;
&lt;td align="right"&gt;3&lt;/td&gt;
&lt;td align="right"&gt;897.48&lt;/td&gt;
&lt;td align="right"&gt;168.64&lt;/td&gt;
&lt;td align="right"&gt;247.07&lt;/td&gt;
&lt;/tr&gt;
&lt;tr height="20" style="height: 15pt;"&gt;
&lt;td height="20" style="height: 15pt;"&gt;GBP&lt;/td&gt;
&lt;td align="right"&gt;1.6445&lt;/td&gt;
&lt;td align="right"&gt;2&lt;/td&gt;
&lt;td align="right"&gt;909.64&lt;/td&gt;
&lt;td align="right"&gt;152.6&lt;/td&gt;
&lt;td align="right"&gt;250.95&lt;/td&gt;
&lt;/tr&gt;
&lt;tr height="20" style="height: 15pt;"&gt;
&lt;td height="20" style="height: 15pt;"&gt;AUD&lt;/td&gt;
&lt;td align="right"&gt;1.07103&lt;/td&gt;
&lt;td align="right"&gt;1&lt;/td&gt;
&lt;td align="right"&gt;200.5&lt;/td&gt;
&lt;td align="right"&gt;51.83&lt;/td&gt;
&lt;td align="right"&gt;55.51&lt;/td&gt;
&lt;/tr&gt;
&lt;tr height="20" style="height: 15pt;"&gt;
&lt;td height="20" style="height: 15pt;"&gt;CAD&lt;/td&gt;
&lt;td align="right"&gt;1.02571&lt;/td&gt;
&lt;td align="right"&gt;1&lt;/td&gt;
&lt;td align="right"&gt;123.56&lt;/td&gt;
&lt;td align="right"&gt;33.18&lt;/td&gt;
&lt;td align="right"&gt;34.03&lt;/td&gt;
&lt;/tr&gt;
&lt;tr height="20" style="height: 15pt;"&gt;
&lt;td height="20" style="height: 15pt;"&gt;INR&lt;/td&gt;
&lt;td align="right"&gt;0.02238&lt;/td&gt;
&lt;td align="right"&gt;1&lt;/td&gt;
&lt;td align="right"&gt;75.55&lt;/td&gt;
&lt;td align="right"&gt;926.83&lt;/td&gt;
&lt;td align="right"&gt;20.74&lt;/td&gt;
&lt;/tr&gt;
&lt;tr height="20" style="height: 15pt;"&gt;
&lt;td height="20" style="height: 15pt;"&gt;ZAR&lt;/td&gt;
&lt;td align="right"&gt;0.14852&lt;/td&gt;
&lt;td align="right"&gt;1&lt;/td&gt;
&lt;td align="right"&gt;99.99&lt;/td&gt;
&lt;td align="right"&gt;185.35&lt;/td&gt;
&lt;td align="right"&gt;27.53&lt;/td&gt;
&lt;/tr&gt;
&lt;tr height="20" style="height: 15pt;"&gt;
&lt;td height="20" style="height: 15pt;"&gt;KWD&lt;/td&gt;
&lt;td align="right"&gt;3.64724&lt;/td&gt;
&lt;td align="right"&gt;1&lt;/td&gt;
&lt;td align="right"&gt;895.32&lt;/td&gt;
&lt;td align="right"&gt;67.41&lt;/td&gt;
&lt;td align="right"&gt;245.86&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;div id="_mcePaste" style="left: -10000px; top: 262px; width: 1px; height: 1px; overflow: hidden;"&gt;
&lt;table width="663" border="0" cellspacing="0" cellpadding="0"&gt;
&lt;colgroup&gt;&lt;col width="136" style="width: 102pt;"&gt;&lt;col width="109" style="width: 82pt;"&gt;&lt;col width="133" style="width: 100pt;"&gt;&lt;col width="79" style="width: 59pt;"&gt;&lt;col width="84" style="width: 63pt;"&gt;&lt;col width="122" style="width: 92pt;"&gt;&lt;/colgroup&gt;
&lt;tbody&gt;
&lt;tr height="20" style="height: 15pt;"&gt;
&lt;td width="136" height="20" style="background: rgb(79, 129, 189); border-width: medium 0.5pt 1.5pt medium; border-style: none solid solid none; border-color: currentColor white white currentColor; width: 102pt; height: 15pt; color: white; font-family: Calibri; font-size: 11pt; font-weight: bold; text-decoration: none;"&gt;
PriceCurrency&lt;/td&gt;
&lt;td width="109" style="background: rgb(79, 129, 189); border-width: medium 0.5pt 1.5pt; border-style: none solid solid; border-color: currentColor white white; width: 82pt; color: white; font-family: Calibri; font-size: 11pt; font-weight: bold; text-decoration: none;"&gt;
ExchangeRate&lt;/td&gt;
&lt;td width="133" style="background: rgb(79, 129, 189); border-width: medium 0.5pt 1.5pt; border-style: none solid solid; border-color: currentColor white white; width: 100pt; color: white; font-family: Calibri; font-size: 11pt; font-weight: bold; text-decoration: none;"&gt;
NoOfTransactions&lt;/td&gt;
&lt;td width="79" style="background: rgb(79, 129, 189); border-width: medium 0.5pt 1.5pt; border-style: none solid solid; border-color: currentColor white white; width: 59pt; color: white; font-family: Calibri; font-size: 11pt; font-weight: bold; text-decoration: none;"&gt;
UnitTotal&lt;/td&gt;
&lt;td width="84" style="background: rgb(79, 129, 189); border-width: medium 0.5pt 1.5pt; border-style: none solid solid; border-color: currentColor white white; width: 63pt; color: white; font-family: Calibri; font-size: 11pt; font-weight: bold; text-decoration: none;"&gt;
PriceTotal&lt;/td&gt;
&lt;td width="122" style="background: rgb(79, 129, 189); border-width: medium medium 1.5pt 0.5pt; border-style: none none solid solid; border-color: currentColor currentColor white white; width: 92pt; color: white; font-family: Calibri; font-size: 11pt; font-weight: bold; text-decoration: none;"&gt;
SettlementTotal&lt;/td&gt;
&lt;/tr&gt;
&lt;tr height="20" style="height: 15pt;"&gt;
&lt;td height="20" style="background: rgb(184, 204, 228); border-width: 0.5pt 0.5pt 0.5pt medium; border-style: solid solid solid none; border-color: white white white currentColor; height: 15pt; color: black; font-family: Calibri; font-size: 11pt; font-weight: 400; text-decoration: none;"&gt;
EUR&lt;/td&gt;
&lt;td align="right" style="background: rgb(184, 204, 228); border: 0.5pt solid white; border-image: none; color: black; font-family: Calibri; font-size: 11pt; font-weight: 400; text-decoration: none;"&gt;
1.46505&lt;/td&gt;
&lt;td align="right" style="background: rgb(184, 204, 228); border: 0.5pt solid white; border-image: none; color: black; font-family: Calibri; font-size: 11pt; font-weight: 400; text-decoration: none;"&gt;
3&lt;/td&gt;
&lt;td align="right" style="background: rgb(184, 204, 228); border: 0.5pt solid white; border-image: none; color: black; font-family: Calibri; font-size: 11pt; font-weight: 400; text-decoration: none;"&gt;
897.48&lt;/td&gt;
&lt;td align="right" style="background: rgb(184, 204, 228); border: 0.5pt solid white; border-image: none; color: black; font-family: Calibri; font-size: 11pt; font-weight: 400; text-decoration: none;"&gt;
168.64&lt;/td&gt;
&lt;td align="right" style="background: rgb(184, 204, 228); border-width: 0.5pt medium 0.5pt 0.5pt; border-style: solid none solid solid; border-color: white currentColor white white; color: black; font-family: Calibri; font-size: 11pt; font-weight: 400; text-decoration: none;"&gt;
247.07&lt;/td&gt;
&lt;/tr&gt;
&lt;tr height="20" style="height: 15pt;"&gt;
&lt;td height="20" style="background: rgb(220, 230, 241); border-width: 0.5pt 0.5pt 0.5pt medium; border-style: solid solid solid none; border-color: white white white currentColor; height: 15pt; color: black; font-family: Calibri; font-size: 11pt; font-weight: 400; text-decoration: none;"&gt;
GBP&lt;/td&gt;
&lt;td align="right" style="background: rgb(220, 230, 241); border: 0.5pt solid white; border-image: none; color: black; font-family: Calibri; font-size: 11pt; font-weight: 400; text-decoration: none;"&gt;
1.6445&lt;/td&gt;
&lt;td align="right" style="background: rgb(220, 230, 241); border: 0.5pt solid white; border-image: none; color: black; font-family: Calibri; font-size: 11pt; font-weight: 400; text-decoration: none;"&gt;
2&lt;/td&gt;
&lt;td align="right" style="background: rgb(220, 230, 241); border: 0.5pt solid white; border-image: none; color: black; font-family: Calibri; font-size: 11pt; font-weight: 400; text-decoration: none;"&gt;
909.64&lt;/td&gt;
&lt;td align="right" style="background: rgb(220, 230, 241); border: 0.5pt solid white; border-image: none; color: black; font-family: Calibri; font-size: 11pt; font-weight: 400; text-decoration: none;"&gt;
152.6&lt;/td&gt;
&lt;td align="right" style="background: rgb(220, 230, 241); border-width: 0.5pt medium 0.5pt 0.5pt; border-style: solid none solid solid; border-color: white currentColor white white; color: black; font-family: Calibri; font-size: 11pt; font-weight: 400; text-decoration: none;"&gt;
250.95&lt;/td&gt;
&lt;/tr&gt;
&lt;tr height="20" style="height: 15pt;"&gt;
&lt;td height="20" style="background: rgb(184, 204, 228); border-width: 0.5pt 0.5pt 0.5pt medium; border-style: solid solid solid none; border-color: white white white currentColor; height: 15pt; color: black; font-family: Calibri; font-size: 11pt; font-weight: 400; text-decoration: none;"&gt;
AUD&lt;/td&gt;
&lt;td align="right" style="background: rgb(184, 204, 228); border: 0.5pt solid white; border-image: none; color: black; font-family: Calibri; font-size: 11pt; font-weight: 400; text-decoration: none;"&gt;
1.07103&lt;/td&gt;
&lt;td align="right" style="background: rgb(184, 204, 228); border: 0.5pt solid white; border-image: none; color: black; font-family: Calibri; font-size: 11pt; font-weight: 400; text-decoration: none;"&gt;
1&lt;/td&gt;
&lt;td align="right" style="background: rgb(184, 204, 228); border: 0.5pt solid white; border-image: none; color: black; font-family: Calibri; font-size: 11pt; font-weight: 400; text-decoration: none;"&gt;
200.5&lt;/td&gt;
&lt;td align="right" style="background: rgb(184, 204, 228); border: 0.5pt solid white; border-image: none; color: black; font-family: Calibri; font-size: 11pt; font-weight: 400; text-decoration: none;"&gt;
51.83&lt;/td&gt;
&lt;td align="right" style="background: rgb(184, 204, 228); border-width: 0.5pt medium 0.5pt 0.5pt; border-style: solid none solid solid; border-color: white currentColor white white; color: black; font-family: Calibri; font-size: 11pt; font-weight: 400; text-decoration: none;"&gt;
55.51&lt;/td&gt;
&lt;/tr&gt;
&lt;tr height="20" style="height: 15pt;"&gt;
&lt;td height="20" style="background: rgb(220, 230, 241); border-width: 0.5pt 0.5pt 0.5pt medium; border-style: solid solid solid none; border-color: white white white currentColor; height: 15pt; color: black; font-family: Calibri; font-size: 11pt; font-weight: 400; text-decoration: none;"&gt;
CAD&lt;/td&gt;
&lt;td align="right" style="background: rgb(220, 230, 241); border: 0.5pt solid white; border-image: none; color: black; font-family: Calibri; font-size: 11pt; font-weight: 400; text-decoration: none;"&gt;
1.02571&lt;/td&gt;
&lt;td align="right" style="background: rgb(220, 230, 241); border: 0.5pt solid white; border-image: none; color: black; font-family: Calibri; font-size: 11pt; font-weight: 400; text-decoration: none;"&gt;
1&lt;/td&gt;
&lt;td align="right" style="background: rgb(220, 230, 241); border: 0.5pt solid white; border-image: none; color: black; font-family: Calibri; font-size: 11pt; font-weight: 400; text-decoration: none;"&gt;
123.56&lt;/td&gt;
&lt;td align="right" style="background: rgb(220, 230, 241); border: 0.5pt solid white; border-image: none; color: black; font-family: Calibri; font-size: 11pt; font-weight: 400; text-decoration: none;"&gt;
33.18&lt;/td&gt;
&lt;td align="right" style="background: rgb(220, 230, 241); border-width: 0.5pt medium 0.5pt 0.5pt; border-style: solid none solid solid; border-color: white currentColor white white; color: black; font-family: Calibri; font-size: 11pt; font-weight: 400; text-decoration: none;"&gt;
34.03&lt;/td&gt;
&lt;/tr&gt;
&lt;tr height="20" style="height: 15pt;"&gt;
&lt;td height="20" style="background: rgb(184, 204, 228); border-width: 0.5pt 0.5pt 0.5pt medium; border-style: solid solid solid none; border-color: white white white currentColor; height: 15pt; color: black; font-family: Calibri; font-size: 11pt; font-weight: 400; text-decoration: none;"&gt;
INR&lt;/td&gt;
&lt;td align="right" style="background: rgb(184, 204, 228); border: 0.5pt solid white; border-image: none; color: black; font-family: Calibri; font-size: 11pt; font-weight: 400; text-decoration: none;"&gt;
0.02238&lt;/td&gt;
&lt;td align="right" style="background: rgb(184, 204, 228); border: 0.5pt solid white; border-image: none; color: black; font-family: Calibri; font-size: 11pt; font-weight: 400; text-decoration: none;"&gt;
1&lt;/td&gt;
&lt;td align="right" style="background: rgb(184, 204, 228); border: 0.5pt solid white; border-image: none; color: black; font-family: Calibri; font-size: 11pt; font-weight: 400; text-decoration: none;"&gt;
75.55&lt;/td&gt;
&lt;td align="right" style="background: rgb(184, 204, 228); border: 0.5pt solid white; border-image: none; color: black; font-family: Calibri; font-size: 11pt; font-weight: 400; text-decoration: none;"&gt;
926.83&lt;/td&gt;
&lt;td align="right" style="background: rgb(184, 204, 228); border-width: 0.5pt medium 0.5pt 0.5pt; border-style: solid none solid solid; border-color: white currentColor white white; color: black; font-family: Calibri; font-size: 11pt; font-weight: 400; text-decoration: none;"&gt;
20.74&lt;/td&gt;
&lt;/tr&gt;
&lt;tr height="20" style="height: 15pt;"&gt;
&lt;td height="20" style="background: rgb(220, 230, 241); border-width: 0.5pt 0.5pt 0.5pt medium; border-style: solid solid solid none; border-color: white white white currentColor; height: 15pt; color: black; font-family: Calibri; font-size: 11pt; font-weight: 400; text-decoration: none;"&gt;
ZAR&lt;/td&gt;
&lt;td align="right" style="background: rgb(220, 230, 241); border: 0.5pt solid white; border-image: none; color: black; font-family: Calibri; font-size: 11pt; font-weight: 400; text-decoration: none;"&gt;
0.14852&lt;/td&gt;
&lt;td align="right" style="background: rgb(220, 230, 241); border: 0.5pt solid white; border-image: none; color: black; font-family: Calibri; font-size: 11pt; font-weight: 400; text-decoration: none;"&gt;
1&lt;/td&gt;
&lt;td align="right" style="background: rgb(220, 230, 241); border: 0.5pt solid white; border-image: none; color: black; font-family: Calibri; font-size: 11pt; font-weight: 400; text-decoration: none;"&gt;
99.99&lt;/td&gt;
&lt;td align="right" style="background: rgb(220, 230, 241); border: 0.5pt solid white; border-image: none; color: black; font-family: Calibri; font-size: 11pt; font-weight: 400; text-decoration: none;"&gt;
185.35&lt;/td&gt;
&lt;td align="right" style="background: rgb(220, 230, 241); border-width: 0.5pt medium 0.5pt 0.5pt; border-style: solid none solid solid; border-color: white currentColor white white; color: black; font-family: Calibri; font-size: 11pt; font-weight: 400; text-decoration: none;"&gt;
27.53&lt;/td&gt;
&lt;/tr&gt;
&lt;tr height="20" style="height: 15pt;"&gt;
&lt;td height="20" style="background: rgb(184, 204, 228); border-width: 0.5pt 0.5pt medium medium; border-style: solid solid none none; border-color: white white currentColor currentColor; height: 15pt; color: black; font-family: Calibri; font-size: 11pt; font-weight: 400; text-decoration: none;"&gt;
KWD&lt;/td&gt;
&lt;td align="right" style="background: rgb(184, 204, 228); border-width: 0.5pt 0.5pt medium; border-style: solid solid none; border-color: white white currentColor; color: black; font-family: Calibri; font-size: 11pt; font-weight: 400; text-decoration: none;"&gt;
3.64724&lt;/td&gt;
&lt;td align="right" style="background: rgb(184, 204, 228); border-width: 0.5pt 0.5pt medium; border-style: solid solid none; border-color: white white currentColor; color: black; font-family: Calibri; font-size: 11pt; font-weight: 400; text-decoration: none;"&gt;
1&lt;/td&gt;
&lt;td align="right" style="background: rgb(184, 204, 228); border-width: 0.5pt 0.5pt medium; border-style: solid solid none; border-color: white white currentColor; color: black; font-family: Calibri; font-size: 11pt; font-weight: 400; text-decoration: none;"&gt;
895.32&lt;/td&gt;
&lt;td align="right" style="background: rgb(184, 204, 228); border-width: 0.5pt 0.5pt medium; border-style: solid solid none; border-color: white white currentColor; color: black; font-family: Calibri; font-size: 11pt; font-weight: 400; text-decoration: none;"&gt;
67.41&lt;/td&gt;
&lt;td align="right" style="background: rgb(184, 204, 228); border-width: 0.5pt medium medium 0.5pt; border-style: solid none none solid; border-color: white currentColor currentColor white; color: black; font-family: Calibri; font-size: 11pt; font-weight: 400; text-decoration: none;"&gt;
245.86&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="16/06/2011 07:55:42">
          <Html>
        
&lt;p&gt;Yes, you need to access the table created when loading...&lt;/p&gt;
&lt;p&gt;Use the&amp;nbsp;﻿﻿worksheet.Tables.GetFromRange(dataRange) method (Look at sample 13).&lt;/p&gt;
&lt;p&gt;Then add a totals row to the table, like in sample 9.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Worksheet being overwritten">
      <Posts>
        <Post From="cwfas" When="15/06/2011 06:13:23">
          <Html>
        
&lt;p&gt;Hi - I am calling passing in a datatable and a string parameter - which will populate and name a worksheet, respectively.&amp;nbsp; This method will be called multiple times and should create a new spreadsheet everytime it is called.&amp;nbsp; The method is working,
 but it is overwriting an existing spreadsheet instead of adding a new spreadhseet each time.&amp;nbsp; What am I misssing?&amp;nbsp; Is it the string?&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;public&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;static&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;void&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;
 ExportExcel(&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Consolas; font-size: x-small;"&gt;DataTable&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;
 dt, &lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;string
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;s)
&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;{&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;
&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;if&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&amp;nbsp;&lt;/span&gt;
&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;(dt.Rows.Count &amp;gt; 0)&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;using&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;
 (&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Consolas; font-size: x-small;"&gt;ExcelPackage&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;
 p = &lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;new&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Consolas; font-size: x-small;"&gt;ExcelPackage&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;())&lt;span style="font-family: Consolas; font-size: x-small;"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;/p&gt;
&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;font face="Consolas" size="2"&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;p.Workbook.Properties.Title =
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(163, 21, 21); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(163, 21, 21); font-family: Consolas; font-size: x-small;"&gt;"Office Open XML xlsx Processor"&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;/font&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;;&lt;font face="Consolas" size="2"&gt;
&lt;/font&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;
&lt;p&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(0, 128, 0); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(0, 128, 0); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(0, 128, 0); font-family: Consolas; font-size: x-small;"&gt;//Create a sheet&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&amp;nbsp;&lt;br&gt;
//&lt;span style="color: rgb(0, 128, 0);"&gt;tried both of these&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(0, 128, 0);"&gt;&amp;nbsp;&lt;/span&gt;&lt;br&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(0, 128, 0); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(0, 128, 0); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(0, 128, 0); font-family: Consolas; font-size: x-small;"&gt;//p.Workbook.Worksheets.Add(s);&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;font face="Consolas" size="2"&gt;&amp;nbsp;&lt;/font&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;font face="Consolas" size="2"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;font face="Consolas" size="2"&gt;
&lt;/font&gt;&lt;/span&gt;&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;font face="Consolas" size="2"&gt;&lt;font face="Consolas" size="2"&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;/font&gt;&lt;/font&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;/span&gt;&lt;/span&gt;
&lt;p&gt;&lt;/p&gt;

&lt;p&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;var
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;sheet = p.Workbook.Worksheets[s];&lt;br&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;if&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;
 (sheet == &lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;null&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;)
&lt;br&gt;
{&lt;br&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(0, 128, 0); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(0, 128, 0); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(0, 128, 0); font-family: Consolas; font-size: x-small;"&gt;//Add a new sheet...&lt;br&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;div&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;sheet = p.Workbook.Worksheets.Add(s);&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="cwfas" When="15/06/2011 15:07:13">
          <Html>
        
&lt;p&gt;ALso tried:&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Consolas; font-size: x-small;"&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;ExcelWorksheet&amp;nbsp;&lt;span style="color: rgb(0, 0, 0); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;ws = p.Workbook.Worksheets.Add(s);
&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;span style="color: rgb(43, 145, 175); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Consolas; font-size: x-small;"&gt;&lt;font color="#0ac000" workitemlink"="" href="https://epplus.codeplex.com/workitem/2"&gt;#2b91af" face="Consolas" size="2"&amp;gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;/font&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(0, 0, 0); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;span style="font-family: Consolas; font-size: x-small;"&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="cwfas" When="15/06/2011 19:44:13">
          <Html>
        
&lt;p&gt;nevermind, got it!&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Save Excel file to database">
      <Posts>
        <Post From="cyrilwallace" When="13/06/2011 09:10:34">
          <Html>
        
&lt;p&gt;Is there anyway that I can save the excel file I have generated to a database?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="13/06/2011 16:20:33">
          <Html>
        
&lt;p&gt;There is no build in functionallity for that, but if you want to save the entire package/workbook to the database use the package.GetAsByteArray method and save the byte array to a binary column.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="cyrilwallace" When="14/06/2011 14:22:23">
          <Html>
        
&lt;p&gt;Thanks jankallman, It was only after I posted that I saw the method on the package object to return a byte array.&lt;/p&gt;
&lt;p&gt;Mind you, an overloaded constructor on the excelpackage that takes a database connection would be cool too ;-)&lt;/p&gt;
&lt;p&gt;Cheers&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Formatting a cell as text">
      <Posts>
        <Post From="praetorian65" When="13/06/2011 11:06:55">
          <Html>
        
&lt;p&gt;Hi, I am trying to set certain cells in a spreadsheet as text but I can't work out how. Currently if certain value are entered (like "true" or "false") they are set to be a different data type which is not what I want. The text value
 must remain as the user enters it. How can I do this?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="13/06/2011 16:25:41">
          <Html>
        
&lt;p&gt;Make sure it is a string. If you have an numeric value use the ToString method to convert it...&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;int&lt;/span&gt; number=1;
worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;].Value=number.ToString()
&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="praetorian65" When="13/06/2011 17:22:31">
          <Html>
        
&lt;p&gt;No, I mean when a person edits a spreadsheet created using this library I want their input to be treated as text, not as a number or a date etc. You can do this within excel using "format cells" and setting it as text. If someone inputs the word "true" excel
 changes the data type to boolean and the value when read is "1.0". &amp;nbsp;The values that the user inputs must remain as they type them.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="praetorian65" When="13/06/2011 17:23:29">
          <Html>
        
&lt;p&gt;I forgot to mention, I am setting the value of the cells as string.Empty when creating the spreadsheet.&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="14/06/2011 13:08:09">
          <Html>
        
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;Set the numberformat to @, like...&lt;/pre&gt;
&lt;pre&gt;worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;].Style.NumberFormat.Format=&lt;span style="color: rgb(163, 21, 21);"&gt;"@"&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Writing directly to disk?">
      <Posts>
        <Post From="ikisfikis" When="06/06/2011 10:26:56">
          <Html>
        
&lt;p&gt;I was wondering if there is a way to stream data directly to disk while populating the excel file.&lt;/p&gt;
&lt;p&gt;I &amp;nbsp;have tried invoking the Flush method over the output stream but with no luck, I had to call Save on the ExcelPackage in order to get some output.&lt;/p&gt;
&lt;p&gt;Should I surrender? :)&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks, keep up the very good work.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="07/06/2011 22:10:23">
          <Html>
        
&lt;p&gt;You can't stream directly to disk since cells, rows and columns are stored in memory. The xml is created and saved to the stream when you call the save method.&lt;/p&gt;
&lt;p&gt;I guess you have to surrender this :)&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="ikisfikis" When="08/06/2011 10:45:28">
          <Html>
        
&lt;p&gt;Thanks for the quick reply.&lt;/p&gt;
&lt;p&gt;So the Stream property is a memory stream, but then I don't understand what's the difference between creating a package using a destination FileStream instead of a FileInfo...&amp;nbsp;buffered writing to disk only?&lt;/p&gt;
&lt;p&gt;Just curious...&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Bye!&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="09/06/2011 20:08:25">
          <Html>
        
&lt;p&gt;It's pretty much the same thing. When working with the cells using the Cells&amp;nbsp;property the data is stored internally in a collection class (the RangeCollection class) for faster access and to keep it sorted.&lt;/p&gt;
&lt;p&gt;When calling the Save (or SaveAs) method, the data is saved back to the stream. Choose the way you think is the easiest&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Empty Cells are ignored when reading data">
      <Posts>
        <Post From="buckley" When="07/06/2011 13:50:10">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I am using the following code to get the contents of a table (I think this is the best way to do it with EPPlus)&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;var&lt;/span&gt; cells = (&lt;span style="color: blue;"&gt;from&lt;/span&gt; cell &lt;span style="color: blue;"&gt;in&lt;/span&gt; sheet.Cells[sheet.Tables[tableName].Address.Address] &lt;span style="color: blue;"&gt;select&lt;/span&gt; cell).ToArray();

&lt;span style="color: blue;"&gt;for&lt;/span&gt; (&lt;span style="color: blue;"&gt;int&lt;/span&gt; i = nrOfColumns; i &amp;lt; cells.Count(); i = i + nrOfColumns)
{
 ....
&amp;nbsp;&lt;/pre&gt;
&lt;pre&gt;&amp;nbsp;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;However, the sheet.Cells collection discards the cells in the table that don't have a value.&lt;/p&gt;
&lt;p&gt;This means that the loop that follows does not read the rows of the table.&lt;/p&gt;
&lt;p&gt;Is this by design? I think its a bug right?&lt;/p&gt;
&lt;p&gt;If it's by design I can take a look and propose a fix. Thanks for confirming :)&lt;/p&gt;
&lt;p&gt;Kind Regards, Tom Pester&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="07/06/2011 13:58:57">
          <Html>
        
&lt;p&gt;I think it is by design and I dont see why need a fix. If you change this, all empty cells will have entries in our cells collection and it will be not good for perfomance. Better waiting for Jan ;D&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="buckley" When="07/06/2011 14:22:58">
          <Html>
        
&lt;p&gt;Hello mrxrs,&lt;/p&gt;
&lt;p&gt;Thats a good argument but I&amp;nbsp;think the performance optimasation isn't worth the&amp;nbsp;divergence from the expected behaviour.&lt;/p&gt;
&lt;p&gt;But if this is by design mrxrs, how do you read all the data from a table then ?&lt;/p&gt;
&lt;p&gt;Kind Regards, Tom&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="07/06/2011 14:42:14">
          <Html>
        
&lt;p&gt;If you want to go through all cells, instead of using linq why dont you do a for-loop with worksheet dimensions ?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="buckley" When="08/06/2011 10:02:18">
          <Html>
        
&lt;p&gt;Thanks for the workaround mrxrsd.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div&gt;&lt;span style="color: rgb(0, 0, 0); text-transform: none; text-indent: 0px; letter-spacing: normal; word-spacing: 0px; white-space: normal; border-collapse: separate; orphans: 2; widows: 2; font-size-adjust: none; font-stretch: normal;"&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;using&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;System;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;using&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;System.IO;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;using&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;OfficeOpenXml;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&lt;br&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;namespace&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;ConsoleApplication1&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;{&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;class&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;Program&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;static&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;void&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;Main(&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;string&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;[]
 args)&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&lt;br&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;FileInfo&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;existingFile
 =&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;new&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;FileInfo&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;(&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;@"c:\temp\Book1.xlsx"&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;);&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(0, 128, 0); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;//col1&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
 col2&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(0, 128, 0); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;//1&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
 &amp;lt;empty cell&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(0, 128, 0); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;//&amp;lt;empty
 cell&amp;gt;&amp;nbsp;&amp;nbsp; 2&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(0, 128, 0); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&lt;br&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;int&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;nrrow
 = 3;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;int&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;nrcol
 = 2;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&lt;br&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;using&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;(&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;ExcelPackage&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;package
 =&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;new&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;ExcelPackage&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;(existingFile))&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;ExcelWorksheet&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;sheet
 = package.Workbook.Worksheets[1];&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&lt;br&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;var&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;cells
 = sheet.Cells[1, 1, nrrow, nrcol];&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&lt;br&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(0, 128, 0); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;//========================================================&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;Console&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;.WriteLine(&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;"using
 Range"&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;);&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;foreach&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;(&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;var&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;cell&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;in&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;cells)&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;Console&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;.WriteLine(cell.Value);&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&lt;br&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(0, 128, 0); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;//output:&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(0, 128, 0); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;//col1&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(0, 128, 0); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;//col2&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(0, 128, 0); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;//1&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(0, 128, 0); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;//2&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(0, 128, 0); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;//
 =&amp;gt; Empty Cells are ignored&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(0, 128, 0); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&lt;br&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(0, 128, 0); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;//========================================================&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;Console&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;.WriteLine(&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;"using
 Individual Cell"&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;);&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;for&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;(&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;int&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;rowtel
 = 1; rowtel &amp;lt;= nrrow; rowtel++)&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;for&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;(&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;int&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;coltel
 = 1; coltel &amp;lt;= nrcol; coltel++)&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;var&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;c
 = sheet.Cells[rowtel,coltel];&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&lt;br&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;Console&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;.WriteLine(c.Value);&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&lt;br&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(0, 128, 0); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;//output:&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(0, 128, 0); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;//col1&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(0, 128, 0); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;//col2&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(0, 128, 0); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;//1&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(0, 128, 0); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;//&amp;lt;empty
 cell&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(0, 128, 0); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;//&amp;lt;empty
 cell&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(0, 128, 0); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;//2&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(0, 128, 0); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;//
 =&amp;gt; Empty Cells are taken into account&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(0, 128, 0); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&lt;br&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&lt;br&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style="color: rgb(1, 1, 1); font-family: Courier New; font-size: x-small;"&gt;&lt;span style="font-size: 10pt;"&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="08/06/2011 11:53:50">
          <Html>
        
&lt;p&gt;No problem, I dont know if you know or not, but you can use worksheet dimension property to get your code more "dynamic", take a look at this thread&amp;nbsp;&lt;/p&gt;
&lt;p&gt;http://epplus.codeplex.com/discussions/257072&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Patch 78707">
      <Posts>
        <Post From="maysjw" When="07/06/2011 19:23:18">
          <Html>
        
&lt;p&gt;Probably a bad place to put this message, but the latest patch for the 2.9 tag shows DLL version 2.8.0.1 instead of a continuation of 2.9.0.x.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="07/06/2011 22:15:02">
          <Html>
        
&lt;p&gt;Thanks, I'll change it the next time I check in&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Unreadable content, even though no content is made">
      <Posts>
        <Post From="Nicoolai" When="06/06/2011 14:38:49">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I'm trying to export an excel sheet, from my asp.net website.&lt;/p&gt;
&lt;p&gt;I copied the example function, but I keep getting unreadable content. If I tell it to open anyway, it opens fine.&lt;/p&gt;
&lt;p&gt;I have tried to comment out EVERYTHING, but I still get the message, when opening with Excel 2007.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;This is my crippled function:&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;    &lt;span style="color: blue;"&gt;private&lt;/span&gt; &lt;span style="color: blue;"&gt;void&lt;/span&gt; DumpExcel(DataTable tbl)
    {
        &lt;span style="color: blue;"&gt;using&lt;/span&gt; (ExcelPackage pck = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage())
        {
            &lt;span style="color: green;"&gt;//Create the worksheet&lt;/span&gt;
            ExcelWorksheet ws = pck.Workbook.Worksheets.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"Answers"&lt;/span&gt;);

            &lt;span style="color: green;"&gt;//Load the datatable into the sheet, starting from cell A1. Print the column names on row 1&lt;/span&gt;
            &lt;span style="color: green;"&gt;//ws.Cells["A1"].LoadFromDataTable(tbl, true);&lt;/span&gt;

            &lt;span style="color: green;"&gt;//Format the header for column 1-3&lt;/span&gt;
            &lt;span style="color: green;"&gt;//using (ExcelRange rng = ws.Cells["A1:B1"])&lt;/span&gt;
            &lt;span style="color: green;"&gt;//{&lt;/span&gt;
            &lt;span style="color: green;"&gt;//    rng.Style.Font.Bold = true;&lt;/span&gt;
            &lt;span style="color: green;"&gt;//    rng.Style.Fill.PatternType = ExcelFillStyle.Solid;                      //Set Pattern for the background to Solid&lt;/span&gt;
            &lt;span style="color: green;"&gt;//    rng.Style.Fill.BackgroundColor.SetColor(Color.FromArgb(79, 129, 189));  //Set color to dark blue&lt;/span&gt;
            &lt;span style="color: green;"&gt;//    rng.Style.Font.Color.SetColor(Color.White);&lt;/span&gt;
            &lt;span style="color: green;"&gt;//}&lt;/span&gt;

            &lt;span style="color: green;"&gt;//Example how to Format Column 1 as numeric &lt;/span&gt;
            &lt;span style="color: green;"&gt;//using (ExcelRange col = ws.Cells[2, 1, 2 + tbl.Rows.Count, 1])&lt;/span&gt;
            &lt;span style="color: green;"&gt;//{&lt;/span&gt;
            &lt;span style="color: green;"&gt;//    col.Style.Numberformat.Format = "#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00";&lt;/span&gt;
            &lt;span style="color: green;"&gt;//    col.Style.HorizontalAlignment = ExcelHorizontalAlignment.Right;&lt;/span&gt;
            &lt;span style="color: green;"&gt;//}&lt;/span&gt;

            &lt;span style="color: green;"&gt;//Write it back to the client&lt;/span&gt;
            Response.ContentType = &lt;span style="color: rgb(163, 21, 21);"&gt;"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"&lt;/span&gt;;
            Response.AddHeader(&lt;span style="color: rgb(163, 21, 21);"&gt;"content-disposition"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"attachment;  filename=Answers.xlsx"&lt;/span&gt;);
            Response.BinaryWrite(pck.GetAsByteArray());
        }
    }
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="06/06/2011 14:42:42">
          <Html>
        
&lt;p&gt;Look at this thread,&amp;nbsp;http://epplus.codeplex.com/discussions/223843&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Nicoolai" When="06/06/2011 14:45:12">
          <Html>
        
&lt;blockquote style="margin: 0.25em 1em 0px; padding: 0px 0.25em; border: 0.1em solid rgb(204, 204, 204); border-image: none; font-style: italic;"&gt;
&lt;strong&gt;mrxrsd wrote:&lt;/strong&gt;&lt;br&gt;
&lt;p&gt;Look at this thread,&amp;nbsp;http://epplus.codeplex.com/discussions/223843&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Thank you sir, you are amazing.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Updated nuget package">
      <Posts>
        <Post From="carlescs" When="01/06/2011 07:57:31">
          <Html>
        
&lt;p&gt;Hello,&lt;/p&gt;
&lt;p&gt;will we be getting an updated nuget package for 2.9.0.1?&lt;/p&gt;
&lt;p&gt;Thanks.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="swmal" When="02/06/2011 05:53:37">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;the new version has been added to the nuget feed now.&lt;/p&gt;
&lt;p&gt;/Mats&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="carlescs" When="02/06/2011 06:56:07">
          <Html>
        
&lt;p&gt;Great! Fantastic work to all developers, this new release is great.&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to copy a Sheet in to another Workbook, include Header Image.">
      <Posts>
        <Post From="nguyenphuong0808" When="01/06/2011 04:17:02">
          <Html>
        
&lt;p&gt;I have decided convert all COM functions to EPPluss library for my project, but I have a problem, I want to merge multi sheets on separate workbook to multi sheets on one workbook,&lt;/p&gt;
&lt;p&gt;the content on sheet is copied fine, but the header (include a Image barcode) does not copy success. Have any solution for here?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="01/06/2011 15:55:18">
          <Html>
        
&lt;p&gt;No, not at the moment. Support for header images is not implemented in version 2.9, but it's on the todo-list.&lt;/p&gt;
&lt;p&gt;Have a look at this issuer for more info...&lt;/p&gt;
&lt;p&gt;&lt;a href="http://epplus.codeplex.com/workitem/12784" rel="nofollow"&gt;http://epplus.codeplex.com/workitem/12784&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Number of rows in a worksheet">
      <Posts>
        <Post From="silic0re" When="29/05/2011 17:23:55">
          <Html>
        
&lt;p&gt;I need to be able to iterate through a worksheet and determine the number of rows used. Since some of the rows can be blank, I can't just look for the first unused row. I don't see any kind of property about the number of rows (like a Rows.Count or RowCount
 in the Worksheet object). What is the best way without iterating to infinity?&lt;/p&gt;
&lt;p&gt;Thanks in advance,&lt;/p&gt;
&lt;p&gt;-Ron B.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="29/05/2011 17:29:14">
          <Html>
        
&lt;p&gt;look at this thread&amp;nbsp;&lt;a href="http://epplus.codeplex.com/discussions/257072" rel="nofollow"&gt;http://epplus.codeplex.com/discussions/257072&lt;/a&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="silic0re" When="29/05/2011 17:30:06">
          <Html>
        
&lt;p&gt;Thanks.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Is it possible embed OLEDB Object to Excel with EPPlus?">
      <Posts>
        <Post From="kma1975" When="02/02/2011 02:14:03">
          <Html>
        
&lt;p&gt;Is it possible embed OLEDB Object to Excel with EPPlus?&lt;/p&gt;
&lt;p&gt;I have to implement to insert Image, Word Document and PDF to Excel.&lt;/p&gt;
&lt;p&gt;Excel itself and Interop can do that.&lt;/p&gt;
&lt;p&gt;I know EPPlus can insert Image, Chart and Shapes to Excel. But I don't find insertion of OLEDB Object in EPPlus.&lt;/p&gt;
&lt;p&gt;Any help would be appreciated.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="03/02/2011 15:12:20">
          <Html>
        
&lt;p&gt;Hi&lt;/p&gt;
&lt;p&gt;Sorry, there is no support for OLE objects in the current version.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="kma1975" When="07/02/2011 01:53:49">
          <Html>
        Hi Jan,&lt;br&gt;
&lt;br&gt;
Noted with thanks.&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;hr id="stopSpelling"&gt;
From: [email removed]&lt;br&gt;
To: [email removed]&lt;br&gt;
Date: Thu, 3 Feb 2011 07:12:29 -0800&lt;br&gt;
Subject: Re: Is it possible embed OLEDB Object to Excel with EPPlus? [EPPlus:244229]&lt;br&gt;
&lt;br&gt;
From: jankallman&lt;br&gt;
&lt;div id="ecxThreadNotificationPostBody"&gt;Hi&lt;br&gt;
Sorry, there is no support for OLE objects in the current version.&lt;br&gt;
Jan&lt;br&gt;
&lt;/div&gt;
&lt;div id="ecxThreadNotificationFooter"&gt;Read the &lt;a target="_blank"&gt;full discussion online&lt;/a&gt;.&lt;br&gt;
To add a post to this discussion, reply to this email (&lt;a target="_blank"&gt;EPPlus@discussions.codeplex.com&lt;/a&gt;)&lt;br&gt;
To start a new discussion for this project, email &lt;a target="_blank"&gt;EPPlus@discussions.codeplex.com&lt;/a&gt;&lt;br&gt;
You are receiving this email because you subscribed to this discussion on CodePlex. You can
&lt;a target="_blank"&gt;unsubscribe&lt;/a&gt; on CodePlex.com.&lt;br&gt;
Please note: Images and attachments will be removed from emails. Any posts to this discussion will also be available online at CodePlex.com&lt;br&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="kma1975" When="09/02/2011 02:41:32">
          <Html>
        
&lt;p&gt;Hi Jan,&lt;/p&gt;
&lt;p&gt;Attempt&amp;nbsp;1)&lt;/p&gt;
&lt;p&gt;I made a template excel file as I cannot insert Header/Footer image by package.&lt;/p&gt;
&lt;p&gt;Inside template, I create a sample sheet&amp;nbsp;which has&amp;nbsp;Header/Footer with images.&lt;/p&gt;
&lt;p&gt;When I write to Excel file with package,&amp;nbsp;I tried to copy that sample sheet to every new sheet.&lt;/p&gt;
&lt;p&gt;I can add the new sheet and can write to cells, no error. But after I save the Excel file and open the file with MS Excel, it says file is corrupted.&lt;/p&gt;
&lt;p&gt;It seems copy from existing sheet to new sheet is not working.&lt;/p&gt;
&lt;p&gt;Even I just copy the workseet to new sheet and didn't write anything is&amp;nbsp;corrupted.
&lt;br&gt;
&lt;span style="color: rgb(255, 0, 0);"&gt;ExcelPackage excel = new ExcelPackage(excelTemplate);&lt;/span&gt;&lt;br&gt;
&lt;span style="color: rgb(255, 0, 0);"&gt;ExcelWorksheet sampleSheet = excel.Workbook.Worksheets["Sample"];&lt;/span&gt;&lt;br&gt;
&lt;span style="color: rgb(255, 0, 0);"&gt;ExcelWorksheet ws = excel.Workbook.Worksheets.Add("Sheet1", sampleSheet);&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Attempt 2)&lt;/p&gt;
&lt;p&gt;Then I tried to write to that sample sheet. It is OK and I can read back with Excel with existing Header and Footer images.&lt;/p&gt;
&lt;p&gt;Then I tried to insert an Image to that sample sheet. It is corrupted again.&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(255, 0, 0);"&gt;FileInfo f = new FileInfo("D:\\Picture.png");&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(255, 0, 0);"&gt;workSheet.Drawings.AddPicture("Picture", f);&lt;span style="font-size: x-small;"&gt;&lt;span style="font-size: x-small;"&gt;&lt;span style="font-size: x-small;"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-size: x-small;"&gt;&amp;nbsp;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;
&lt;p&gt;Any help would be appreciated.&lt;/p&gt;
&lt;p&gt;Thanks for the good job.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="11/02/2011 10:44:17">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Header footer images are not supported in the current version.&lt;/p&gt;
&lt;p&gt;Images in the header and footer uses a VML drawing file, so if you copy the worksheet, the relation to the vml file will not be created for the new sheet and the&amp;nbsp;package will be corrupt.&lt;/p&gt;
&lt;p&gt;Attempt 2, im not sure what could be wrong here, create an issue and upload your template and&amp;nbsp;picture with a&amp;nbsp;sample,&amp;nbsp;so i can have a look at it.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="bornetjulien" When="25/05/2011 09:30:52">
          <Html>
        
&lt;p&gt;Hi,&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I am trying to do the same thing (Copy a sheet who has a image in the header), I've seen that the "sheet1.xml.rels" in folder&amp;nbsp;xl\worksheets\_rels\ is not created for the sheet who are copied.&lt;/p&gt;
&lt;p&gt;Is there a solution to create it manualy? Do you plan to fix that bug? When did you plan to do the next relaease?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thx for your great job&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Julien&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="bornetjulien" When="27/05/2011 09:00:31">
          <Html>
        
&lt;p&gt;OK i found this solution, who is not he best one but do the job (Please notice taht it doesn't work, if amn image is in the sheet)&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;        &lt;span style="color: blue;"&gt;private&lt;/span&gt; &lt;span style="color: blue;"&gt;void&lt;/span&gt; CopySheetRelations(ExcelWorksheet Copy, ExcelWorksheet workSheet)
        {
            &lt;span style="color: blue;"&gt;var&lt;/span&gt; uriTemplateHeaderFooter = &lt;span style="color: blue;"&gt;new&lt;/span&gt; Uri(&lt;span style="color: blue;"&gt;string&lt;/span&gt;.Format(&lt;span style="color: rgb(163, 21, 21);"&gt;"/xl/worksheets/_rels/{0}.rels"&lt;/span&gt;, Copy.WorksheetUri.OriginalString.Split(&lt;span style="color: blue;"&gt;new&lt;/span&gt; &lt;span style="color: blue;"&gt;char&lt;/span&gt;[] { &lt;span style="color: rgb(163, 21, 21);"&gt;'/'&lt;/span&gt; })[3]), UriKind.Relative);
            &lt;span style="color: blue;"&gt;var&lt;/span&gt; uriNewHeaderFooter = &lt;span style="color: blue;"&gt;new&lt;/span&gt; Uri(&lt;span style="color: blue;"&gt;string&lt;/span&gt;.Format(&lt;span style="color: rgb(163, 21, 21);"&gt;"/xl/worksheets/_rels/{0}.rels"&lt;/span&gt;, workSheet.WorksheetUri.OriginalString.Split(&lt;span style="color: blue;"&gt;new&lt;/span&gt; &lt;span style="color: blue;"&gt;char&lt;/span&gt;[] { &lt;span style="color: rgb(163, 21, 21);"&gt;'/'&lt;/span&gt; })[3]), UriKind.Relative);
            &lt;span style="color: blue;"&gt;if&lt;/span&gt; (_xlPackage.Package.PartExists(uriTemplateHeaderFooter))
            {
                PackagePart packagePartTemplateHeaderFooter = _xlPackage.Package.GetPart(uriTemplateHeaderFooter);
                PackagePart packagePartNewHeaderFooter;
                &lt;span style="color: blue;"&gt;if&lt;/span&gt; (!_xlPackage.Package.PartExists(uriNewHeaderFooter))
                    packagePartNewHeaderFooter = _xlPackage.Package.CreatePart(uriNewHeaderFooter, packagePartTemplateHeaderFooter.ContentType, packagePartTemplateHeaderFooter.CompressionOption);
                &lt;span style="color: blue;"&gt;else&lt;/span&gt;
                    packagePartNewHeaderFooter = _xlPackage.Package.GetPart(uriNewHeaderFooter);

                &lt;span style="color: blue;"&gt;using&lt;/span&gt; (StreamReader streamReader = &lt;span style="color: blue;"&gt;new&lt;/span&gt; StreamReader(packagePartTemplateHeaderFooter.GetStream()))
                {
                    &lt;span style="color: blue;"&gt;using&lt;/span&gt; (StreamWriter streamWriter = &lt;span style="color: blue;"&gt;new&lt;/span&gt; StreamWriter(packagePartNewHeaderFooter.GetStream(FileMode.OpenOrCreate)))
                    {
                        streamWriter.Write(streamReader.ReadToEnd());
                    }
                }
            }
        }
&lt;/pre&gt;
&lt;/div&gt;
And I call this function in&amp;nbsp;public ExcelWorksheet Add(string Name, ExcelWorksheet Copy), jsute before&amp;nbsp;//Copy comments
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Copying between sheets.">
      <Posts>
        <Post From="boabawhales" When="19/05/2011 21:38:40">
          <Html>
        
&lt;p&gt;The following executes fine:&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: rgb(128, 128, 128);"&gt;ExcelNamedRange template = book.Names["Template";&lt;/span&gt;

&lt;span style="color: green;"&gt;//ExcelRangeBase cursor = sheet.Cells[1, 1];&lt;/span&gt;
&lt;span style="color: rgb(255, 0, 0);"&gt;ExcelRangeBase cursor = template.Offset(0, 10);&lt;/span&gt;

&lt;span style="color: rgb(128, 128, 128);"&gt;template.Copy(cursor);&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
However, the following clears the content and format of the template:
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: rgb(128, 128, 128);"&gt;ExcelNamedRange template = book.Names["Template"];&lt;/span&gt;

&lt;span style="color: rgb(255, 0, 0);"&gt;ExcelRangeBase cursor = sheet.Cells[1, 1];&lt;/span&gt;
&lt;span style="color: green;"&gt;//ExcelRangeBase cursor = template.Offset(0, 10);&lt;/span&gt;

&lt;span style="color: rgb(128, 128, 128);"&gt;template.Copy(cursor);&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;Note that "sheet" is a different worksheet from where "template" is on.&lt;/p&gt;
&lt;p&gt;I am clueless as how this occurs, but it looks like a bug to me.&lt;br&gt;
Is there a work-around?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="26/05/2011 17:53:58">
          <Html>
        
&lt;p&gt;Yes, it's a bug. It should be fixed in the latest source.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="boabawhales" When="26/05/2011 18:09:18">
          <Html>
        
&lt;p&gt;Thanks! EPPlus is my favorite C# library out there.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to tell if a cell is part of a range? (and work around)">
      <Posts>
        <Post From="mjslane" When="25/05/2011 11:13:26">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I have a situation where I need to test if the results of a linq query are merged ranges. &amp;nbsp;I had a quick look through the source code and couldn't find a way to do this. &amp;nbsp;The merged property returns true even if the result is a single cell (shouldn't
 this be false for single cell ExcelRange?). &amp;nbsp;Also if the result is a merged range, the start and end properties are both the same. &amp;nbsp;Have I missed something or is this ability missing from EPP?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;I don't know the EPP source code at all and need to get something out quick, so I used an extension method.&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;static&lt;/span&gt; ExcelRangeBase GetMergedCells(&lt;span style="color: blue;"&gt;this&lt;/span&gt; ExcelWorksheet worksheet, ExcelRangeBase toCheck)
        {
            &lt;span style="color: blue;"&gt;if&lt;/span&gt; (worksheet != toCheck.Worksheet)
                &lt;span style="color: blue;"&gt;throw&lt;/span&gt; &lt;span style="color: blue;"&gt;new&lt;/span&gt; ArgumentException(&lt;span style="color: rgb(163, 21, 21);"&gt;"Worksheets do not match"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"toCheck"&lt;/span&gt;);

            ExcelAddress toCheckAddress = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelAddress(toCheck.Address);

            &lt;span style="color: blue;"&gt;foreach&lt;/span&gt; (&lt;span style="color: blue;"&gt;string&lt;/span&gt; mergedCells &lt;span style="color: blue;"&gt;in&lt;/span&gt; worksheet.MergedCells)
            {
                ExcelAddress mergedAddress = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelAddress(mergedCells);
                &lt;span style="color: blue;"&gt;if&lt;/span&gt; (toCheckAddress.Start.Row &amp;gt;= mergedAddress.Start.Row
                    &amp;amp;&amp;amp; toCheckAddress.End.Row &amp;lt;= mergedAddress.End.Row
                    &amp;amp;&amp;amp; toCheckAddress.Start.Column &amp;gt;= mergedAddress.Start.Column
                    &amp;amp;&amp;amp; toCheckAddress.End.Column &amp;lt;= mergedAddress.End.Column)
                {
                    &lt;span style="color: blue;"&gt;return&lt;/span&gt; worksheet.Cells[mergedCells];
                }
            }

            &lt;span style="color: blue;"&gt;return&lt;/span&gt; toCheck;
        }&lt;/pre&gt;
&lt;pre&gt;&lt;br&gt;&lt;/pre&gt;
&lt;pre&gt;Matt&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="25/05/2011 14:05:40">
          <Html>
        
&lt;p&gt;I dont know if I understand your problem, I tried to reproduce your problem but I am not successful. If a cell is part of a merge range, all cells will have merge=true and the same value. If you want to find your range you need to "move left" and "move right"
 from your cell to find the head and tail.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mjslane" When="25/05/2011 16:33:36">
          <Html>
        
&lt;p&gt;I was wrong about merge returning true for non merged cells.&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I'm looking for the same&amp;nbsp;functionality&amp;nbsp;as MergeArea, if it exists in EPP. &amp;nbsp; If you look at the extension method above, you'll see that is pretty much what it does, if the cell is a member of a set of merged cells, it returns the range. &amp;nbsp;Looking
 at it now, it should really be an extension method on ExcelRangeBase instead of ExcelWorksheet and renamed to MergeArea to keep consistency with the Excel API.&lt;/p&gt;
&lt;p&gt;If I was to move (up, left,right, down) until the value changes, I'd run into the risk of two different merged areas next to each other with the same value being treated as one. &amp;nbsp;Using the MergedCells property as a look up of the parent Worksheet removes
 that risk.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="25/05/2011 17:50:37">
          <Html>
        
&lt;p&gt;Yes, for sure. When I said about all cell have same value it isnt for you use this in your method, I was only listing some behaviours there are identical in two merge cells for same range ( or not ). heheh =)&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;If you do this a lot, you can change the code for use an auxiliar structure to store all cell´s address merged in a range. So, &amp;nbsp;will be O(1).&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mjslane" When="26/05/2011 15:49:49">
          <Html>
        
&lt;p&gt;I do this a lot for this application and I don't have control over the workbook! The customer isn't fussed about performance for the first few releases so when I do get round to optimising I'm sure there's a lot I can do :) &amp;nbsp;Hopefully a patch to add
 MergeArea to ExcelRangeBase will result from this (unless someone gets there first.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Problem creating Excel file">
      <Posts>
        <Post From="prince17" When="25/05/2011 10:11:56">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I'm using EPPlus to export DataSet to Excel. Developing with C#.NET MVC. Here's a code snippet:&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;            &lt;span style="color: blue;"&gt;using&lt;/span&gt; (ExcelPackage pck = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage())
            {
                &lt;span style="color: blue;"&gt;foreach&lt;/span&gt; (DataTable tbl &lt;span style="color: blue;"&gt;in&lt;/span&gt; dataSet.Tables)
                {
                    ExcelWorksheet ws = pck.Workbook.Worksheets.Add(tbl.TableName);
                    ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;].LoadFromDataTable(tbl, &lt;span style="color: blue;"&gt;true&lt;/span&gt;);
                }

                HttpResponse Response = System.Web.HttpContext.Current.Response;
                pck.SaveAs(Response.OutputStream);
                Response.ContentType = &lt;span style="color: rgb(163, 21, 21);"&gt;"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"&lt;/span&gt;;
                Response.AddHeader(&lt;span style="color: rgb(163, 21, 21);"&gt;"content-disposition"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"attachment;  filename=Sample1.xlsx"&lt;/span&gt;);
            }
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;This launches an alert box with garbled text.&lt;/p&gt;
&lt;p&gt;Have anyone encounter the same scenario?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Prince&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="25/05/2011 12:25:39">
          <Html>
        
&lt;p&gt;When do you see an alert box with garbled text? If it was when you tried to open your excel file, try this:&amp;nbsp;http://epplus.codeplex.com/discussions/223843&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Medium Trust Web">
      <Posts>
        <Post From="Ivano" When="16/03/2011 16:37:05">
          <Html>
        
&lt;p&gt;Hi,&lt;br&gt;
&lt;br&gt;
I wish to use EPPLUS on a web hosted site, but there is a medium trust level and I receive the error: That assembly does not allow partially trusted callers&lt;br&gt;
&lt;br&gt;
There is any workaround ?&lt;br&gt;
&lt;br&gt;
Thank you.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="ivano" When="17/03/2011 12:46:51">
          <Html>
        
&lt;p&gt;Ok some update on this issue.&lt;/p&gt;
&lt;p&gt;I've compiled the entire library with [assembly: AllowPartiallyTrustedCallers] and modified the web.config with&amp;nbsp; &amp;lt;add assembly="EPPlus, Version=2.8.0.1, Culture=Neutral, PublicKeyToken=ea159fdaa78159a1"&amp;nbsp; /&amp;gt; but the result is always
&lt;span id="dnn_ctr375_LogViewer_dlLog_ctl10_lblException"&gt;System.Security.Permissions.SecurityPermission on Area MyComputer.&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;I've done the same thing with other library (NPOI) and the trick works.&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;Is really EPPLUS only be used in full trust ?&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;Some guru can help me ?&lt;br&gt;
&lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="17/03/2011 20:01:49">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I have not tried to run the component in medium trust level, so I actually don't know.&lt;/p&gt;
&lt;p&gt;I had a quick look at the classes that were not allowed and could not see anyone that I use.&lt;/p&gt;
&lt;p&gt;When do you get the exception? When the library is loaded?&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="ivano" When="17/03/2011 22:17:24">
          <Html>
        
&lt;p&gt;Hi Jan,&lt;/p&gt;
&lt;p&gt;the exception is raised as soon as I call&lt;/p&gt;
&lt;p&gt;using (ExcelPackage pck = new ExcelPackage)&lt;/p&gt;
&lt;p&gt;The full log detail is:&lt;/p&gt;
&lt;p&gt;&lt;span id="dnn_ctr375_LogViewer_dlLog_ctl10_lblException"&gt;System.Security.Permissions.SecurityPermission ---&amp;gt; System.Security.SecurityException: System.Security.Permissions.SecurityPermission in OfficeOpenXml.ExcelPackage.ConstructNewFile(String password)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;The type of the first permission that failed was: &lt;span id="dnn_ctr375_LogViewer_dlLog_ctl10_lblException"&gt;
System.Security.Permissions.SecurityPermission&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;Set &lt;/span&gt;&amp;lt;trust level="Medium" originUrl=".*" /&amp;gt; in web.config to reproduce the issue.&lt;/p&gt;
&lt;p&gt;Ivano.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="18/03/2011 15:32:18">
          <Html>
        
&lt;p&gt;Ok, I found the problem (or at least two of them).&lt;/p&gt;
&lt;p&gt;I use some API function in the catch block to verifiy if the package is encrypted. In the ExcelWorksheet.ConstructNewFile...&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;if&lt;/span&gt; (password == &lt;span style="color: blue;"&gt;null&lt;/span&gt; &amp;amp;&amp;amp; EncryptedPackageHandler.&lt;span style="color: rgb(255, 0, 0);"&gt;StgIsStorageFile&lt;/span&gt;(File.FullName) == 0)

&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&amp;nbsp;and in the ExcelWorksheet.Load method....&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;if&lt;/span&gt; (Password == &lt;span style="color: blue;"&gt;null&lt;/span&gt; &amp;amp;&amp;amp; EncryptedPackageHandler.&lt;span style="color: rgb(255, 0, 0);"&gt;StgIsStorageILockBytes&lt;/span&gt;(eph.GetLockbyte((MemoryStream)_stream)) == 0)

&lt;/pre&gt;
&lt;pre&gt;You can comment these checks out or wrap them in a new method and it will work.&lt;/pre&gt;
&lt;pre&gt;I'll add a fix for this in the next version.&lt;/pre&gt;
&lt;pre&gt;Jan&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="ivano" When="18/03/2011 17:15:37">
          <Html>
        
&lt;p&gt;Hi Jan,&lt;/p&gt;
&lt;p&gt;I've tried your fix and It works like a charm&amp;nbsp; !!&lt;/p&gt;
&lt;p&gt;Thank you for the great great job !!&lt;/p&gt;
&lt;p&gt;Ivano&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="ivano" When="23/05/2011 10:29:07">
          <Html>
        
&lt;p&gt;I think I've found an other issue on medium trust when the ExcelPackage is created from a memoryStream.&lt;/p&gt;
&lt;p&gt;Look at this code:&lt;/p&gt;
&lt;p&gt;byte[] buf = new byte[this.uplUsers.PostedFile.InputStream.Length + 1];&lt;br&gt;
//Read file from control to buffer&lt;br&gt;
this.uplUsers.PostedFile.InputStream.Read(buf, 0, buf.Length);&lt;br&gt;
//Create memory stream&lt;br&gt;
MemoryStream memStream = new MemoryStream();&lt;br&gt;
//Write buffer to memory stream&lt;br&gt;
memStream.Write(buf, 0, buf.Length);memStream.Position = 0;&lt;/p&gt;
&lt;p&gt;ExcelPackage pck = new ExcelPackage(memStream); &amp;nbsp;&amp;lt;--- This line raise an exception:&amp;nbsp;System.Security.Permissions.SecurityPermission&lt;/p&gt;
&lt;p&gt;Can be solved ?&lt;/p&gt;
&lt;p&gt;Thanks, Ivano&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="After saving stuff is missing from workbook">
      <Posts>
        <Post From="dustintownsend" When="19/05/2011 15:27:27">
          <Html>
        
&lt;p&gt;I am using EPPlus to read information from an existing excel sheet and update some select data. This seems to work great, but I noticed when I open the workbook after it has been saved none of my data validation works.&lt;/p&gt;
&lt;p&gt;My data validation is tied to a List which is defined in the Name Manager.&lt;/p&gt;
&lt;p&gt;What it seems to be doing is deleting out the saved ranges in the Name Manager.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="swmal" When="20/05/2011 09:10:40">
          <Html>
        
&lt;p&gt;The current version of EPPlus does not support data validation -&amp;nbsp;but next version will...&lt;/p&gt;
&lt;p&gt;If you need a quick fix, you can download and build the latest source.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Deleting work sheet if it already exists in the workbook">
      <Posts>
        <Post From="klvnnsrikanth" When="05/01/2011 22:23:43">
          <Html>
        
&lt;p&gt;How do I delete an existing worksheet if it already exists in the workbook?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I have found that workbook.Delete(int index) ....&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;What if I don't know at what place my sheet is there in the workbook (in my case...)? :)&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;
&lt;p&gt;Srikanth Kambhampati&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="09/01/2011 18:46:54">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Something like&amp;nbsp;this ...&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;Workbook.Worksheets.Delete(worksheet.PositionID)
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&amp;nbsp;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="klvnnsrikanth" When="10/01/2011 23:05:51">
          <Html>
        
&lt;p&gt;It says "'OfficeOpenXml.ExcelWorksheet.PositionID' is inaccessible due to its protection level&lt;span&gt;"&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;Is there any way to fix this??&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="11/01/2011 07:01:53">
          <Html>
        
&lt;p&gt;hmm, I see what you mean. I should have&amp;nbsp;verified that a little bit better :(&lt;/p&gt;
&lt;p&gt;I'll add a fix for it next time I check in.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="boabawhales" When="19/05/2011 22:17:43">
          <Html>
        
&lt;p&gt;Can you do a quick check-in for this paper-cut?&lt;/p&gt;
&lt;p&gt;Your visual studio is newer than mine so I am having trouble opening your .sln file and compiling my own version.&lt;/p&gt;
&lt;p&gt;&lt;br&gt;
Greatly appreciated.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;EDIT: Sorry about the post, I've figured out how to compile with "msbuild.exe". Thanks for this great library!&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Setting Tab color">
      <Posts>
        <Post From="NitinKale" When="17/05/2011 09:02:44">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Is there any way to set the tab color for each individual worksheet in a workbook?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks,&lt;/p&gt;
&lt;p&gt;Nitin&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="19/05/2011 05:58:58">
          <Html>
        
&lt;p&gt;No, not in version 2.8, but its a simple&amp;nbsp;feature to add, so I'll add it to the coming version.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Excel 2003">
      <Posts>
        <Post From="harag" When="17/05/2011 16:11:03">
          <Html>
        
&lt;p&gt;Hi&lt;/p&gt;
&lt;p&gt;I know the title of the EPPlus is 2007/2010, but does it save 2003 format files?&lt;/p&gt;
&lt;p&gt;If I simply sepecify that the extension is "xls" rather than "xlsx" will this work? I personally have 2007 on my machine, so can't test if 2003 will open a file created by this library.&lt;/p&gt;
&lt;p&gt;If not, does anyone know of a good alternative that will save 2003 and 2007 version files?&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="17/05/2011 16:17:58">
          <Html>
        
&lt;p&gt;No, you cant.&lt;/p&gt;
&lt;p&gt;http://epplus.codeplex.com/discussions/253371&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Auto Fit columns">
      <Posts>
        <Post From="NitinKale" When="13/05/2011 12:01:26">
          <Html>
        
&lt;p&gt;Great Work !!!!!!&lt;/p&gt;
&lt;p&gt;Can u pls suggest me how to provide auto fit to cell.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Regards,&lt;/p&gt;
&lt;p&gt;Nitin&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="13/05/2011 12:04:02">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Look at this thread.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;http://epplus.codeplex.com/discussions/218294&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="NitinKale" When="13/05/2011 12:11:25">
          <Html>
        
&lt;p&gt;Thank u!!!&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Read ExcelData in toa DataTable">
      <Posts>
        <Post From="pvinitha" When="11/05/2011 16:27:04">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I'm&amp;nbsp; a new bee to this product. Was wondering how do I convert the excelsheet to load into a Datatable.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;cheers,&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;vi&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="12/05/2011 18:57:48">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;There is no build-in way to do that, so you have to create the datatable yourself and populate it from the worksheet.&lt;/p&gt;
&lt;p&gt;Have a look at the sample project&amp;nbsp;for how to read a workbook.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="EPPlus.dll">
      <Posts>
        <Post From="sasi_4785" When="11/05/2011 10:29:05">
          <Html>
        
&lt;p&gt;﻿How to prepare a pivot table using EPPlus dll for Excel 2007 format?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="12/05/2011 18:54:27">
          <Html>
        
&lt;p&gt;Not sure what you mean but, but have a look at sample 12 in the latest source (trunk) for some pivot table samples&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Read very large xlsx">
      <Posts>
        <Post From="enricoee" When="10/05/2011 18:18:33">
          <Html>
        
&lt;p&gt;Hello,&lt;/p&gt;
&lt;p&gt;I need to read large xlsx, something like 50 columns per 60.000 rows and the operation it's very slow and memory consuming.&lt;/p&gt;
&lt;p&gt;I simply loop rows and columns and I read a cell value at time :&lt;/p&gt;
&lt;p&gt;object valore = currentWorksheet.Cells[i, col].Value;&lt;/p&gt;
&lt;p&gt;There are a faster way to read&amp;nbsp; the entire row or direct way to read a range in a array ?&lt;/p&gt;
&lt;p&gt;Thank you.&lt;/p&gt;
&lt;p&gt;PS: my xlsx are simple tables&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="10/05/2011 19:34:58">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;No, a worksheet in that size will consume a lot of memory. If you get out of memory things will go really slow, so have a look at the taskmanager when you read the package and make sure you still have physical memory left.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Copying Cell Range Fails">
      <Posts>
        <Post From="lehket" When="09/05/2011 21:01:25">
          <Html>
        
&lt;p&gt;I'm running into an odd error when trying to copy a cell range. I have a workbook in which I've created a worksheet and added data to it. I then create another worksheet and want to copy the headers from the first one into it. When I use a statement such
 as:&lt;/p&gt;
&lt;p&gt;sheetA.Cells["1:1"].Copy(sheetB.Cells["1:1"]);&lt;/p&gt;
&lt;p&gt;I get an out of range error indicating that the cell index is out of bounds. The odd thing is, the above call works so long as all the references are in column A. The following, for example, works fine:&lt;/p&gt;
&lt;p&gt;sheetA.Cells["A1:A20"].Copy(sheetB.Cells["A1:A20"]);&lt;/p&gt;
&lt;p&gt;This copies the data from the indicated cells in sheetA to sheetB. But if I include any other columns, for example:&lt;/p&gt;
&lt;p&gt;sheetA.Cells["A1:B1"].Copy(sheetB.Cells["A1:B1"]);&lt;/p&gt;
&lt;p&gt;I get the error again. I suspect this is a bug, but I may be doing something wrong, too. Any help you can offer would be appreciated.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="10/05/2011 19:21:54">
          <Html>
        This discussion has been copied to a work item. Click &lt;a href="http://epplus.codeplex.com/workitem/13487" rel="nofollow"&gt;
here&lt;/a&gt; to go to the work item and continue the discussion.
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Sheet protection and openoffice">
      <Posts>
        <Post From="Bjaerre" When="03/05/2011 11:36:21">
          <Html>
        
&lt;p&gt;Hi&lt;/p&gt;
&lt;p&gt;I am in the progress of making a program which needs to generate excel files and have found EPPlus very useful.&lt;/p&gt;
&lt;p&gt;I have run into a problem, as I need to protect the sheet, or better yet the entire workbook from changes, but still readable, so I'm not looking for encryption with password so you can't read the workbook, just to lock every cell and sheet from changes.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I have tried with the following code:&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;                &lt;span style="color: green;"&gt;//Lock workbook&lt;/span&gt;

                package.Workbook.Protection.LockRevision = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
                package.Workbook.Protection.LockStructure = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
                package.Workbook.Protection.SetPassword(&lt;span style="color: rgb(163, 21, 21);"&gt;"pswd"&lt;/span&gt;);
                package.Encryption.IsEncrypted = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;

                &lt;span style="color: blue;"&gt;foreach&lt;/span&gt; (ExcelWorksheet ws &lt;span style="color: blue;"&gt;in&lt;/span&gt; package.Workbook.Worksheets)
                {
                    ws.Protection.AllowDeleteColumns = &lt;span style="color: blue;"&gt;false&lt;/span&gt;;
                    ws.Protection.AllowDeleteRows = &lt;span style="color: blue;"&gt;false&lt;/span&gt;;
                    ws.Protection.AllowFormatCells = &lt;span style="color: blue;"&gt;false&lt;/span&gt;;
                    ws.Protection.AllowFormatColumns = &lt;span style="color: blue;"&gt;false&lt;/span&gt;;
                    ws.Protection.AllowFormatRows = &lt;span style="color: blue;"&gt;false&lt;/span&gt;;
                    ws.Protection.AllowInsertColumns = &lt;span style="color: blue;"&gt;false&lt;/span&gt;;
                    ws.Protection.AllowInsertHyperlinks = &lt;span style="color: blue;"&gt;false&lt;/span&gt;;
                    ws.Protection.AllowInsertRows = &lt;span style="color: blue;"&gt;false&lt;/span&gt;;
                    ws.Protection.AllowSelectLockedCells = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
                    ws.Protection.AllowSort = &lt;span style="color: blue;"&gt;false&lt;/span&gt;;
                    ws.Protection.IsProtected = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
                    ws.Protection.SetPassword(&lt;span style="color: rgb(163, 21, 21);"&gt;"pswd"&lt;/span&gt;);
                    ws.Cells[1, 1, 1000, 50].Style.Locked = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
                }
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;with mixed success.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;It appears to be protected when using e.g. MS Excel 2000, (haven't tried 2007, but would figure it works as well) but when opening the workbook with Open Office 3.2.1 I can change everything and save the workbook again.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Am I missing something?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="03/05/2011 22:06:57">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I have done all testing in Excel 2007 and 2010. I haven't looked at protection in Open office, but I know there are a few problems with workbooks generated in EPPlus (graphs, drawings etc)&lt;/p&gt;
&lt;p&gt;I'm not sure how hard it will be to fix full open office support (and all other non Excel programs), but that will be something for the future.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to read a web based file">
      <Posts>
        <Post From="vaerge" When="02/05/2011 22:54:14">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;This might be simple...but not to me, apparently ;-)&lt;/p&gt;
&lt;p&gt;I have an xlsx file on the web server and I would like to read from it. Something tells me I need to create a Stream from it somehow. How do I get to that? I tried using Stream, but without much luck.&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Input will be greatly appreciated!&lt;/p&gt;
&lt;p&gt;Thanks,&lt;/p&gt;
&lt;p&gt;Anders&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="02/05/2011 23:37:42">
          <Html>
        
&lt;p&gt;Open your file as a MemoryStream and pass to ExcelPackage constructor. I did with fileupload and works like a charm.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="vaerge" When="03/05/2011 00:15:25">
          <Html>
        
&lt;p&gt;Great. But (out of forum, I know) - how do you 'serve' the file to the MemoryStream - as byte[]?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="03/05/2011 21:51:29">
          <Html>
        
&lt;p&gt;Use a filestream or a memorystream like this...&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;var&lt;/span&gt; file = File.ReadAllBytes(yourFileName)
MemoryStream ms = &lt;span style="color: blue;"&gt;new&lt;/span&gt; MemoryStream(file);
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="FileStream instead of FileInfo">
      <Posts>
        <Post From="jcl5fa" When="28/04/2011 21:40:09">
          <Html>
        
&lt;p&gt;Hi guys,&lt;/p&gt;
&lt;p&gt;I'm trying to create an Excel file using a FileStream object instead of a FileInfo object. I noticed the OfficeOpenXml.ExcelPackage constructor can take a FileStream object, but I'm not having luck with implementing it. I want to use a FileStream instead
 of FileInfo because I'm using a formatter class that's currenting creating and sharing a FileStream.&lt;/p&gt;
&lt;p&gt;Here's an example I've created.&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;void&lt;/span&gt; makeStream()
        {
            System.IO.Stream myStream;

            &lt;span style="color: blue;"&gt;try&lt;/span&gt;
            {
                &lt;span style="color: green;"&gt;//create a file stream (write only)&lt;/span&gt;
                myStream = &lt;span style="color: blue;"&gt;new&lt;/span&gt; System.IO.FileStream(&lt;span style="color: rgb(163, 21, 21);"&gt;"c:\\stream_writeOnly.xlsx"&lt;/span&gt;, System.IO.FileMode.Create, System.IO.FileAccess.Write, System.IO.FileShare.None);

                &lt;span style="color: green;"&gt;//make a sample file&lt;/span&gt;
                makeExcel(myStream);

            }
            &lt;span style="color: blue;"&gt;catch&lt;/span&gt; (Exception ex)
            {
                System.Diagnostics.Debug.WriteLine(ex.Message);
                &lt;span style="color: green;"&gt;//Message=Can not read from inputstream&lt;/span&gt;
                &lt;span style="color: green;"&gt;//Source=EPPlus&lt;/span&gt;
                                
            }

            &lt;span style="color: blue;"&gt;try&lt;/span&gt;
            {
                &lt;span style="color: green;"&gt;//create a file stream read/write&lt;/span&gt;
                myStream = &lt;span style="color: blue;"&gt;new&lt;/span&gt; System.IO.FileStream(&lt;span style="color: rgb(163, 21, 21);"&gt;"c:\\stream_readWrite.xlsx"&lt;/span&gt;, System.IO.FileMode.Create, System.IO.FileAccess.ReadWrite, System.IO.FileShare.None);

                &lt;span style="color: green;"&gt;//make a sample file&lt;/span&gt;
                makeExcel(myStream);

            }
            &lt;span style="color: blue;"&gt;catch&lt;/span&gt; (Exception ex)
            {
                System.Diagnostics.Debug.WriteLine(ex.Message);
                &lt;span style="color: green;"&gt;//Message=A disk error occurred during a write operation. (Exception from HRESULT: 0x8003001D (STG_E_WRITEFAULT))&lt;/span&gt;
                &lt;span style="color: green;"&gt;//Source=EPPlus&lt;/span&gt;
            }

            &lt;span style="color: blue;"&gt;try&lt;/span&gt;
            {
                &lt;span style="color: green;"&gt;//create a file info object&lt;/span&gt;
                System.IO.FileInfo myFileInfo = &lt;span style="color: blue;"&gt;new&lt;/span&gt; System.IO.FileInfo(&lt;span style="color: rgb(163, 21, 21);"&gt;"c:\\stream_from_fileInfo.xlsx"&lt;/span&gt;);
                
                &lt;span style="color: green;"&gt;//create a package&lt;/span&gt;
                OfficeOpenXml.ExcelPackage jinx = &lt;span style="color: blue;"&gt;new&lt;/span&gt; OfficeOpenXml.ExcelPackage(myFileInfo);
                
                &lt;span style="color: green;"&gt;//create a worksheet&lt;/span&gt;
                jinx.Workbook.Worksheets.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"Jinx"&lt;/span&gt;);

                &lt;span style="color: green;"&gt;//save the file&lt;/span&gt;
                jinx.Save();

                &lt;span style="color: green;"&gt;//make a sample file&lt;/span&gt;
                makeExcel(jinx.Stream);                
                &lt;span style="color: green;"&gt;//no error, but doesn't work as expected :(&lt;/span&gt;

            }
            &lt;span style="color: blue;"&gt;catch&lt;/span&gt; (Exception ex)
            {
                System.Diagnostics.Debug.WriteLine(ex.Message);
                &lt;span style="color: green;"&gt;//Message=&lt;/span&gt;
                &lt;span style="color: green;"&gt;//Source=&lt;/span&gt;
            }

        }

        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;void&lt;/span&gt; makeExcel(System.IO.Stream myStream)
        {
            OfficeOpenXml.ExcelPackage myPackage;
            OfficeOpenXml.ExcelWorksheet myWs;

            &lt;span style="color: green;"&gt;//create a package.&lt;/span&gt;
            myPackage = &lt;span style="color: blue;"&gt;new&lt;/span&gt; OfficeOpenXml.ExcelPackage(myStream);

            &lt;span style="color: green;"&gt;//set the package title&lt;/span&gt;
            myPackage.Workbook.Properties.Title = &lt;span style="color: rgb(163, 21, 21);"&gt;"Stream Sample"&lt;/span&gt;;
            
            &lt;span style="color: green;"&gt;//add a worksheet&lt;/span&gt;
            myWs = myPackage.Workbook.Worksheets.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"Stream Test"&lt;/span&gt;);
            myWs.Cells[1, 1].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"Testing"&lt;/span&gt;;

            &lt;span style="color: green;"&gt;//save the file&lt;/span&gt;
            myPackage.Save();            
            
        }

&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Lastly let me just say that EPPlus is an excellent utility and I love using it. Up until now the DLL has worked flawlessly for me :)&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="29/04/2011 14:58:54">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I suggest you try the ExcelPackage.SaveAs-method to save to your File-stream, something like in web sample 1...&lt;/p&gt;
&lt;p&gt;ExcelPackage pck = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage();&lt;br&gt;
...&lt;br&gt;
pck.SaveAs(yourStream);&lt;/p&gt;
&lt;p&gt;Your first sample uses an write only stream. That is not supported in the constructor. It must be read/write.&lt;/p&gt;
&lt;p&gt;The&amp;nbsp;second sample should work, but the component crashes when you add an empty stream. I'll add a fix for that.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jcl5fa" When="02/05/2011 15:25:49">
          <Html>
        
&lt;p&gt;Thank you for the reply Jan. Your suggestion will work :)&lt;/p&gt;
&lt;p&gt;I never thought about simply creating a Package object and&amp;nbsp;saving it to a stream as the last step.&lt;/p&gt;
&lt;p&gt;BTW, I've noticed the "SaveAs" method also works on WRITE only streams.&lt;/p&gt;
&lt;p&gt;Have a great week.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to add the documentation XML file in Visual Studio IntelliSense ?">
      <Posts>
        <Post From="nicopulse" When="11/04/2011 16:32:59">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;In the zip dll folder, there is a documentation file (EPPlusXmlDocumentationFile.xml), how to add it in Visual Studio&amp;nbsp;IntelliSense ?&lt;/p&gt;
&lt;p&gt;I use Visual Studio 2010.&lt;/p&gt;
&lt;p&gt;Thanks for your help.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="12/04/2011 18:08:14">
          <Html>
        
&lt;p&gt;Yes, this is wrong. It should be named EPPlus.xml. I'll change that in the zip-package. You can just rename it and it should work as expected.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="nicopulse" When="13/04/2011 09:22:15">
          <Html>
        
&lt;p&gt;Thanks !!!!!!!!!&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jimbrain" When="29/04/2011 08:51:37">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I have the same problem as nicopulse. I tried renaming the documentation file to EPPlus.xml but still, Visual studio&lt;/p&gt;
&lt;p&gt;will not show any documentation . I tried removing the EPPlus library from the project's references and adding it again&lt;/p&gt;
&lt;p&gt;but nothing happened. Am i doing something wrong?&lt;/p&gt;
&lt;p&gt;Thank you in advance.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Jim&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="swmal" When="29/04/2011 13:24:03">
          <Html>
        
&lt;p&gt;Hi Jim,&lt;/p&gt;
&lt;p&gt;EPPlus, not EPPPlus.&lt;/p&gt;
&lt;p&gt;/Mats&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jimbrain" When="29/04/2011 13:31:57">
          <Html>
        
&lt;p&gt;Correction done..&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Not Saving">
      <Posts>
        <Post From="roysoliver" When="08/04/2011 17:29:57">
          <Html>
        
&lt;p&gt;In the previous version, the Save() method worked just fine after setting values in&amp;nbsp;a worksheet.&amp;nbsp; With the latest version, the save does not save the file.&amp;nbsp; After calling ExcelPackage.Save(), I null the worksheet, dispose the package, and
 close the file stream.&amp;nbsp; I had to rollback to the previous version to verify and it does work with the previous version.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="10/04/2011 20:40:54">
          <Html>
        
&lt;p&gt;Version 2.8.0.2?&lt;/p&gt;
&lt;p&gt;Can you provide an example?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="roysoliver" When="20/04/2011 19:37:32">
          <Html>
        
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;FileStream fs = &lt;span style="color: blue;"&gt;null&lt;/span&gt;;

ExcelPackage pck = &lt;span style="color: blue;"&gt;null&lt;/span&gt;;
ExcelWorksheet ws = &lt;span style="color: blue;"&gt;null&lt;/span&gt;;
                    
fs = &lt;span style="color: blue;"&gt;new&lt;/span&gt; FileStream(&lt;span style="color: rgb(163, 21, 21);"&gt;"FILE_PATH"&lt;/span&gt;, FileMode.Open, FileAccess.ReadWrite);

pck = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(fs);

&lt;span style="color: green;"&gt;//ExcelWorksheet indexes are not zero based&lt;/span&gt;
ws = pck.Workbook.Worksheets[1];

ws.Cells["A1"].Value = Value;
                        
&lt;span style="color: green;"&gt;//Save&lt;/span&gt;
pck.Save();
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;﻿&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="26/04/2011 07:57:09">
          <Html>
        This discussion has been copied to a work item. Click &lt;a href="http://epplus.codeplex.com/workitem/13411" rel="nofollow"&gt;
here&lt;/a&gt; to go to the work item and continue the discussion.
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Run in Medium Trust">
      <Posts>
        <Post From="avagarwal" When="17/04/2011 14:20:25">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;How can I run the dll, in an medium trust environment. My hosting provider supports only medium trust.&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;
&lt;p&gt;Anurag&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="18/04/2011 07:06:21">
          <Html>
        
&lt;p&gt;Have a look at this thread...&lt;/p&gt;
&lt;p&gt;&lt;a href="http://epplus.codeplex.com/discussions/249961" rel="nofollow"&gt;http://epplus.codeplex.com/discussions/249961&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="avagarwal" When="19/04/2011 05:10:08">
          <Html>
        
&lt;p&gt;Hi Jan,&lt;/p&gt;
&lt;p&gt;I have reviewed the same, but seem to be missing something. I have opened "EPPlus.csproj" in VS2008, made the changes. I have then added a new web project to the solution, added a reference to EPPlus project, but cannot use the same i.e. "OpenOfficeXml.ExcelPackage"
 is not found.&lt;/p&gt;
&lt;p&gt;Help in this regard would be appreciated.&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;
&lt;p&gt;Anurag&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="ivano" When="19/04/2011 09:47:39">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;&lt;span id="result_box" lang="en"&gt;&lt;span title="Fai clic per visualizzare le traduzioni alternative"&gt;These&lt;/span&gt;
&lt;span title="Fai clic per visualizzare le traduzioni alternative"&gt;are the steps required&lt;/span&gt;
&lt;span title="Fai clic per visualizzare le traduzioni alternative"&gt;to&lt;/span&gt; &lt;span title="Fai clic per visualizzare le traduzioni alternative"&gt;
run&lt;/span&gt; &lt;span title="Fai clic per visualizzare le traduzioni alternative"&gt;in&lt;/span&gt;
&lt;span title="Fai clic per visualizzare le traduzioni alternative"&gt;EPPLus in medium trust (tested with EPPlus 2.8.0.1)&lt;br&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span lang="en"&gt;&lt;span title="Fai clic per visualizzare le traduzioni alternative"&gt;1) Download the sourcecode and open in visual studio 2008 the solutions. Locate and open the file
&lt;/span&gt;&lt;/span&gt;ExcelPackage.cs in EPPlus project&lt;/p&gt;
&lt;p&gt;2) At line 300 and at line 339 comment all the catch expression&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; //if (password == null &amp;amp;&amp;amp; EncryptedPackageHandler.StgIsStorageFile(template.FullName)==0)&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; //{&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; //&amp;nbsp;&amp;nbsp;&amp;nbsp; throw new Exception("Can not open the package. Package is an OLE compound document. If this is an encrypted package, please
 supply the password", ex);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; //}&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; //else&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; //{&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; //&amp;nbsp;&amp;nbsp;&amp;nbsp; throw (ex);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; //}&lt;/p&gt;
&lt;p&gt;3) Open the file AssemblyInfo.cs located in EPPlus/Properties&amp;nbsp; and add the following line after [assembly: ComVisible(false)]&lt;/p&gt;
&lt;p&gt;[assembly: AllowPartiallyTrustedCallers]&lt;/p&gt;
&lt;p&gt;4) Compile the solution and take the builded EPPLus.dll&lt;/p&gt;
&lt;p&gt;5) On the web.config add the following line in the&amp;nbsp; &amp;lt;assemblies&amp;gt; section:&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;lt;add assembly="EPPlus, Version=2.8.0.1, Culture=Neutral, PublicKeyToken=ea159fdaa78159a1"&amp;nbsp; /&amp;gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;That's all.&lt;/p&gt;
&lt;p&gt;Good work, Ivano&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="avagarwal" When="19/04/2011 18:12:23">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Thanks for the detailed instructions. Everything worked.&lt;/p&gt;
&lt;p&gt;Anurag&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Silverlight support">
      <Posts>
        <Post From="ryanlin" When="16/04/2011 17:30:54">
          <Html>
        
&lt;p&gt;Are you planning to support it?&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thx.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="18/04/2011 07:05:24">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I have not plans for&amp;nbsp;Silverlight and I don't think&amp;nbsp;it supports the &lt;span style="font-family: Consolas; font-size: x-small;"&gt;
&lt;span style="font-family: Consolas; font-size: x-small;"&gt;System.IO.Packaging-namespace (correct me if i'm wrong).&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;/span&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Cell value added via EPPlus is not detected by formula">
      <Posts>
        <Post From="jrgalang" When="11/04/2011 04:16:23">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I have this line of code to add a formula on a given range:&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;using&lt;/span&gt; (&lt;span style="color: blue;"&gt;var&lt;/span&gt; range = EnvSheet.Cells[49, 4, 86, 4])
                    {
                        range.Formula = &lt;span style="color: rgb(163, 21, 21);"&gt;"=AVERAGEIF(E49:P49,\"&amp;gt;0\")*(1+C$47)"&lt;/span&gt;;
                        range.Style.Fill.PatternType = ExcelFillStyle.Solid;
                        range.Style.Fill.BackgroundColor.SetColor(Color.Yellow);
                    }
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;Now I want to add a value to a target cell as shown:&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;FillCurrentSheet.Cells[49, 5].Value = "00:00:25";
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;When I open Excel to view the result, the value 00:00:25 is there, but the formula is still #DIV/0 (Divide Zero Error).&lt;/p&gt;
&lt;p&gt;What I've noticed though is when I manually set the value, or just retype "00:00:25" via the Excel UI, the formatting remains the same in the cell, but looking up at the Formula Bar, it changes to 12:00:25 AM and the AVERAGEIF formula now actually
 recognizes the cell instead of displaying #DIV/0.&lt;/p&gt;
&lt;p&gt;I've already tried setting the Numberformat before and after setting the value using this code:&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;FillCurrentSheet.Cells[49, 5].Style.Numberformat.Format = &lt;span style="color: rgb(163, 21, 21);"&gt;"h:mm:ss"&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;Still unlucky though. Will try ExcelCalcMode.Automatic.Equals(true) and see how it goes.&lt;/p&gt;
&lt;p&gt;Just want to make sure if there's any other way to mimic the behavior that Excel does using EPPlus? It's relatively strange as the formula bar does not follow the formatting of the actual cell.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jrgalang" When="11/04/2011 04:37:07">
          <Html>
        
&lt;p&gt;ExcelCalcMode didn't cut it as well.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="11/04/2011 11:16:07">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;If you add it as a string, it will be a string in Excel.&lt;/p&gt;
&lt;p&gt;Add it as a date instead...&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;FillCurrentSheet.Cells[49, 5].Value = &lt;span style="color: blue;"&gt;new&lt;/span&gt; DateTime(&lt;span style="color: blue;"&gt;new&lt;/span&gt; TimeSpan(0, 0, 25).Ticks)
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jrgalang" When="13/04/2011 00:36:55">
          <Html>
        
&lt;p&gt;Thanks Jan, highly helpful. Will review the source as this intrigued me.&lt;/p&gt;
&lt;p&gt;Cheers.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title=".Count / .ToList() =&amp;gt; NullReference Exception">
      <Posts>
        <Post From="MaxMelcher" When="08/04/2011 10:06:24">
          <Html>
        
&lt;p&gt;Hi guys,&lt;/p&gt;
&lt;p&gt;first of all thanks for this awesome library - saved me a lot of time (used excelpackage before and epplus is way faster and easier to use).&lt;/p&gt;
&lt;p&gt;I created a little tool to copy value from source workbooks to a targetworkbook but when I try to enumerate all the sheets in a workbook i get a NullReference:&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;using&lt;/span&gt; (ExcelPackage excelWorkbook = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(fileExcel))
{ 
    lstTargetSheets.DataSource = excelWorkbook .Workbook.Worksheets.ToList();
}

&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;The same happens when I try to loop over the Sheets with upper bound .Count of the worksheets. It maybe that the workbook is corrupt but Excel opens it without warning.&lt;/p&gt;
&lt;p&gt;Any suggestions?&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Cheers&lt;/p&gt;
&lt;p&gt;Max&lt;/p&gt;
&lt;p&gt;p.s. the dirty workarround is by now :&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt; &lt;span style="color: blue;"&gt;using&lt;/span&gt; (ExcelPackage excelWorkbook = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(&lt;span style="color: blue;"&gt;new&lt;/span&gt; FileInfo(dir.FullName + "\\" + selectedFile)))
            {
                List&amp;lt;ExcelWorksheet&amp;gt; sheets = &lt;span style="color: blue;"&gt;new&lt;/span&gt; List&amp;lt;ExcelWorksheet&amp;gt;();
          
                &lt;span style="color: blue;"&gt;for&lt;/span&gt; (&lt;span style="color: blue;"&gt;int&lt;/span&gt; i = 0; i &amp;lt; 100; i++)
                {
                    &lt;span style="color: blue;"&gt;try&lt;/span&gt;
                    {
                        sheets.Add(excelWorkbook.Workbook.Worksheets[i]);
                    }
                    &lt;span style="color: blue;"&gt;catch&lt;/span&gt;
                    {
                    }
                }

                lstSourceSheets.DataSource = sheets;
                lstSourceSheets.DisplayMember = &lt;span style="color: rgb(163, 21, 21);"&gt;"Name"&lt;/span&gt;;
                lstSourceSheets.ValueMember = &lt;span style="color: rgb(163, 21, 21);"&gt;"Name"&lt;/span&gt;;
            }
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="swmal" When="08/04/2011 12:01:36">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;pls create an issue and attach the workbook file&amp;nbsp;to it.&lt;/p&gt;
&lt;p&gt;/Mats&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="MaxMelcher" When="08/04/2011 13:20:14">
          <Html>
        
&lt;p&gt;Hey Mats,&lt;/p&gt;
&lt;p&gt;thanks for the fast response. I apparently cant attach the workbook - it contains financial data.&lt;/p&gt;
&lt;p&gt;Any hint how I can start ?&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;
&lt;p&gt;Max&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="swmal" When="08/04/2011 22:20:03">
          <Html>
        
&lt;p&gt;Ok. I have tried to reproduce this error, but it works for me.&lt;/p&gt;
&lt;p&gt;If you have any possibility to download the EPPlus source, compile it in debug mode and set a reference to it.&lt;/p&gt;
&lt;p&gt;Maybe you could try to change your code to this:&lt;/p&gt;
&lt;p&gt;&lt;span style="color: blue;"&gt;&lt;span style="color: rgb(0, 128, 128);"&gt;// Worksheet index is 1-based, change 0 to 1&lt;/span&gt;&lt;br&gt;
for&lt;/span&gt; (&lt;span style="color: blue;"&gt;int&lt;/span&gt; i = 1; i &amp;lt; 100; i++)&lt;br&gt;
{&lt;br&gt;
&lt;span style="color: blue;"&gt;try&lt;/span&gt;&lt;br&gt;
{&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; sheets.Add(excelWorkbook.Workbook.Worksheets[i]);&lt;br&gt;
}&lt;br&gt;
&lt;span style="color: blue;"&gt;catch&lt;span style="color: rgb(0, 0, 0);"&gt;(Exception e)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;
{&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; throw new Exception("Exception occurred at index " + i, e);&lt;br&gt;
}&lt;/p&gt;
&lt;p&gt;Then hopefully the index of the first exception might give you a hint. The stacktrace of the inner exception might also be interesting.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Color Individual Data Point">
      <Posts>
        <Post From="FoolishRaymond" When="07/10/2010 16:08:39">
          <Html>
        
&lt;p&gt;Hello&lt;/p&gt;
&lt;p&gt;Can I change the fill color of individual data point in a Bar Chart?&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="11/10/2010 06:44:59">
          <Html>
        
&lt;p&gt;No, you have to use the ChartXml manually or use a template if that is an option for you.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="rimfo" When="07/04/2011 06:27:20">
          <Html>
        
&lt;p&gt;How do you use a template? I have created a template and saved it as an .crtx file, but how do I use it?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="07/04/2011 14:58:51">
          <Html>
        
&lt;p&gt;Sorry about my unclear answer here.&lt;/p&gt;
&lt;p&gt;With template I mean a xlsx file to start from. There is no support for .crtx templates in the libray at this point.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Cannot use styles from Ribbon bar">
      <Posts>
        <Post From="x97mdr" When="04/04/2011 15:36:57">
          <Html>
        
&lt;p&gt;Hey folks,&lt;/p&gt;
&lt;p&gt;I'm trying to use the style "Accent2" from the Ribbon Bar in Excel 2007 in my worksheet but I notice that it isn't in the list of Named Styles available to the Workbook, only "Normal" seems to be there. &amp;nbsp;Am I missing something? &amp;nbsp;Is
 there a way to address these or should I just create my own style in the program to emulate the style from the workbook? &amp;nbsp;Here's the code snippet I am using:&lt;/p&gt;
&lt;p&gt;worksheet.Cells["A1:R1"].StyleName = "Accent2";&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="swmal" When="04/04/2011 21:45:28">
          <Html>
        
&lt;p&gt;There are no predefined named styles in EPPlus. "Normal" is the default value of the StyleName property. Have a look at Sample6 under the comment "//Add a HyperLink to the statistics sheet." to get a hint of how you can create your own named styles.&lt;span style="color: rgb(0, 128, 0); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(0, 128, 0); font-family: Consolas; font-size: x-small;"&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="x97mdr" When="04/04/2011 23:51:48">
          <Html>
        
&lt;p&gt;Gotcha thanks. &amp;nbsp;I found my way around it by defining a table and using the TableStyles as in one of the examples.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Column Letter / Column Address">
      <Posts>
        <Post From="rohanar" When="28/03/2011 15:31:14">
          <Html>
        
&lt;p&gt;Anyone know how to get the full address of an entire column given only a column index?&amp;nbsp;Eg. ColumnIndex = 1, so&amp;nbsp;looking for the full address of that column which is&amp;nbsp;"A:A".&amp;nbsp; According to the documentation, there is a private GetColumnLetter
 method, but obviously that's inaccessible.&amp;nbsp; Is there another method that would do this?&lt;/p&gt;
&lt;p&gt;Thanks!&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="28/03/2011 19:27:43">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;You can use the MaxRows constant of the ExcelPackage class...&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;        &lt;span style="color: gray;"&gt;///&lt;/span&gt; &lt;span style="color: gray;"&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt;&lt;span style="color: green;"&gt; Maximum number of columns in a worksheet (16384). &lt;/span&gt;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt; &lt;span style="color: gray;"&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;const&lt;/span&gt; &lt;span style="color: blue;"&gt;int&lt;/span&gt; MaxColumns = 16384;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt; &lt;span style="color: gray;"&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt;&lt;span style="color: green;"&gt; Maximum number of rows in a worksheet (1048576). &lt;/span&gt;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt; &lt;span style="color: gray;"&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;const&lt;/span&gt; &lt;span style="color: blue;"&gt;int&lt;/span&gt; MaxRows = 1048576;


Something like...&lt;/pre&gt;
&lt;pre&gt;&lt;div style="color: black; background-color: white;"&gt;&lt;pre&gt;ws.Cells[1,1,ExcelPackage.MaxRows,1]
&lt;/pre&gt;
&lt;pre&gt;&amp;nbsp;&lt;/pre&gt;
&lt;/div&gt;
&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Dynamically add drop down list">
      <Posts>
        <Post From="gmhamm0" When="17/03/2011 14:54:58">
          <Html>
        
&lt;p&gt;I need to be able to dynamically add drop down lists to a column in a spreadsheet that I am creating.&amp;nbsp; It only needs to be a simple drop down with a few values in it.&amp;nbsp; In a previous post you said this is not supported and to use templates.&amp;nbsp;
 I need to find a way to do this without using templates.&amp;nbsp; Can you at least point me in right direction on how to add support for the drop down myself?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="17/03/2011 20:03:37">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;You can't do that i version 2.8, but you can download the latest source and have a look at the datavalidation (sample 11). It's not 100% done yet, so be aware that the interface&amp;nbsp;might change.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="kangarolf" When="28/03/2011 11:38:37">
          <Html>
        
&lt;p&gt;Hi there,&lt;/p&gt;
&lt;p&gt;If I use a drop down from a template I am assuming that I will not be able to edit the values in the dropdown..? Any ideas when the ability to create a dropdown programmatically will be available..?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Cheers&lt;/p&gt;
&lt;p&gt;Rolf&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="swmal" When="28/03/2011 13:56:52">
          <Html>
        
&lt;blockquote style="margin: 0.25em 1em 0px; padding: 0px 0.25em; border: 0.1em solid rgb(204, 204, 204); border-image: none; font-style: italic;"&gt;
&lt;strong&gt;gmhamm0 wrote:&lt;/strong&gt;&lt;br&gt;
&lt;p&gt;I need to be able to dynamically add drop down lists to a column in a spreadsheet that I am creating.&amp;nbsp; It only needs to be a simple drop down with a few values in it.&amp;nbsp; In a previous post you said this is not supported and to use templates.&amp;nbsp;
 I need to find a way to do this without using templates.&amp;nbsp; Can you at least point me in right direction on how to add support for the drop down myself?&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;br&gt;
As Jan wrote, you will hopefully be able to do this with the latest source code. Have a look at sample 11 and the method ﻿AddListValidationValues.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="swmal" When="28/03/2011 14:01:50">
          <Html>
        
&lt;blockquote style="margin: 0.25em 1em 0px; padding: 0px 0.25em; border: 0.1em solid rgb(204, 204, 204); border-image: none; font-style: italic;"&gt;
&lt;strong&gt;kangarolf wrote:&lt;/strong&gt;&lt;br&gt;
&lt;p&gt;Hi there,&lt;/p&gt;
&lt;p&gt;If I use a drop down from a template I am assuming that I will not be able to edit the values in the dropdown..? Any ideas when the ability to create a dropdown programmatically will be available..?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Cheers&lt;/p&gt;
&lt;p&gt;Rolf&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;You will be able to create dropdowlists programmatically in the next version, when datavalidations has been released. I dont know exactly when that is going to be, but probably during the spring.&lt;/p&gt;
&lt;p&gt;DataValidations are available if you download the latest source and compile it yourself, but we are not done with testing yet.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Can I create styles and use them in different workbooks (or packages)?">
      <Posts>
        <Post From="norbertuco" When="24/03/2011 12:30:02">
          <Html>
        
&lt;p&gt;Hi!&lt;/p&gt;
&lt;p&gt;The EPPlus library you are creating is very useful! Thanks for the effort!&lt;/p&gt;
&lt;p&gt;I was using a similar library called XmlExcel written by a guy named Yogesh Jagota (http://www.codeproject.com/KB/office/excelxmllibrary.aspx) and, although I found it simple to use, I ended up ditching it because its bugs and quirks made it quite frustrating
 and the author had stopped developing it any further.&lt;/p&gt;
&lt;p&gt;I have been able to migrate most of my code to the EPPlus library and I love how everything just works as it should. However, there is a thing I haven't been able to replicate which is the creation of workbook-independent (or package-independent) styles
 that I can then use in different workbooks (or packages). In the XmlExcel library I could write something along the lines of XmlStyle MyStyle = new XmlStyle() and then set all the MyStyle style properties to whatever I wanted (similar to what you can do in
 the EPPlus library with named styles). Since MyStyle was defined outside of the scope of a workbook, I could then use it in any of the workbooks that I created.&lt;/p&gt;
&lt;p&gt;Right now I need to re-define all the named styles in every workbook (or a package) and I wish I could just share the same styles through my code. I have noticed that the OfficeOpenXml.ExcelStyles.CreateNamedStyle(string) can also be called with an extra
 parameter OfficeOpenXml.ExcelStyles.CreateNamedStyle(string, OfficeOpenXml.Style.ExcelStyle) that I imagine is some sort of template. How can I create this template? Can it be shared accross workbooks (or packages)? Can I apply the template directly to a cell
 (or cells) without using named styles?&lt;/p&gt;
&lt;p&gt;Thanks!&lt;/p&gt;
&lt;p&gt;Norbert.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="25/03/2011 15:49:50">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;No, there is not simple way to share styles between workbooks at the moment, but it shouldn't be to hard to add (it's done inside the worksheet.Copy method).&lt;/p&gt;
&lt;p&gt;You can copy styles inside a package by setting the StyleID for a range.&lt;/p&gt;
&lt;p&gt;If it turns out to be simple, I'll try to add some style copy functionallity to the next version.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="norbertuco" When="28/03/2011 11:57:32">
          <Html>
        
&lt;p&gt;Thanks for the answer! I will check future versions to see if the functionality is implemented. Congratulations on the good work!&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Adding text to footer">
      <Posts>
        <Post From="cdc5205" When="04/05/2010 20:14:10">
          <Html>
        I am using a template that has a right aligned Image in the footer and I want to add text to the left aligned footer. When trying to add the left side text it rewrites the entire footer,is there a way to retain the image within the template? The code i'm
 using is: ExcelHeaderFooterText footer= worksheet.HeaderFooter.oddFooter; footer.LeftAlignedText = "Test Value"; Thanks
        
    </Html>
        </Post>
        <Post From="jankallman" When="05/05/2010 07:37:27">
          <Html>
        
&lt;p&gt;No support for that in the current version. You can use the WorksheetXml if you want to be advanced. Extract the package (rename the template .zip and extract it) and have a look at the sheet-xml file to see the xpath and format.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="cdc5205" When="07/05/2010 19:38:38">
          <Html>
        I will have a look at that. I appreciate all your work on this library, it's been real helpful for my project. Thanks!
        
    </Html>
        </Post>
        <Post From="cdc5205" When="10/05/2010 14:02:41">
          <Html>
        Just for reference to others who may need this, I accomplished what I needed by doing the following:&lt;br&gt;
&lt;br&gt;
XmlNodeList nodeList = worksheet.WorksheetXml.GetElementsByTagName("oddFooter");&lt;br&gt;
nodeList[0].InnerText += "&amp;amp;L" + footerText; //add footerText to the left (&amp;amp;L)&lt;br&gt;
&lt;br&gt;
footerText is a string variable and worksheet is an ExcelWorksheet object&lt;br&gt;
This looked to be the easiest way to add text without overwriting the image that was already in the footer.

        
    </Html>
        </Post>
        <Post From="akronite" When="28/03/2011 09:47:09">
          <Html>
        
&lt;p&gt;Thanks cdc5205&lt;/p&gt;
&lt;p&gt;we'll seriously consider adding functionality to this.&lt;/p&gt;
&lt;p&gt;extract note to add here:&lt;/p&gt;
&lt;p&gt;nodeList[0].InnerText += "&amp;amp;L"&amp;nbsp;+ footerText; //add footerText to the left
&lt;strong&gt;(&amp;amp;L)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&amp;amp;L&lt;/strong&gt; = left&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&amp;amp;C = &lt;/strong&gt;center&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&amp;amp;R&lt;/strong&gt; = Right&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&amp;amp;P&lt;/strong&gt; = current page number&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&amp;amp;N&lt;/strong&gt; = "of" page number eg. Page &amp;amp;P of &amp;amp;N = Page 1 of 1&lt;/p&gt;
&lt;p&gt;whereas &lt;em&gt;&amp;amp;[Page]&lt;/em&gt; and &lt;em&gt;&amp;amp;[Pages]&lt;/em&gt; would require a "compile" by excel&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Tab Color">
      <Posts>
        <Post From="jomtois" When="26/03/2011 13:34:28">
          <Html>
        
&lt;p&gt;Is there any way to set the tab color for each individual worksheet in a workbook?&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;
&lt;p&gt;Jon&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Error sending the command to the program (Excel 2007)">
      <Posts>
        <Post From="paulo3011" When="24/03/2011 19:22:49">
          <Html>
        
&lt;p&gt;Hi, I was using the lib EPPlus 2.7.0.1 and after getting some updates from the Windows 7 and office 2007, the files generated by lib not opened more and shows the error message "Erro ao enviar o camando para o programa" (Error sending the command
 to the program).&lt;br&gt;
&lt;br&gt;
I updated the library version to 2.8.0.2 and the error continues EPPlus.&lt;br&gt;
The latest update of the office I received was: Security Update for Microsoft Office 2007 System (KB2288931)&lt;br&gt;
&lt;br&gt;
"Update type: Important&lt;br&gt;
&lt;br&gt;
The 2007 Microsoft Office system has a security vulnerability that could allow arbitrary code execution when files modified to open a maliciously. This update resolves that vulnerability.&lt;br&gt;
&lt;br&gt;
More information:&lt;br&gt;
http://support.microsoft.com/kb/2288931 "&lt;/p&gt;
&lt;p&gt;Try opening the files generated by samples of "2.7.0.1 EPPlus sample" and they also do not open. I made a sample code and also generates the same error when trying to open the file. Follow this code:&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;public Form1()&lt;br&gt;
{&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; InitializeComponent();&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; ExportarDataGridViewToExcel(@"C:\Temp\fileTeste.xlsx", "Plan test", getGridTeste());&lt;br&gt;
}&lt;br&gt;
/// &amp;lt;summary&amp;gt;&lt;br&gt;
/// Export DataGridView to Excel.&lt;br&gt;
/// &amp;lt;/summary&amp;gt;&lt;br&gt;
/// &amp;lt;param name="destino"&amp;gt;Full path to save file&amp;lt;/param&amp;gt;&lt;br&gt;
/// &amp;lt;param name="nomePlanilha"&amp;gt;Name of plan&amp;lt;/param&amp;gt;&lt;br&gt;
/// &amp;lt;param name="grid"&amp;gt;DataGridView to export&amp;lt;/param&amp;gt;&lt;br&gt;
public static void ExportarDataGridViewToExcel(string destino, string nomePlanilha, DataGridView grid)&lt;br&gt;
{&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; #region Verifica pré-requisitos&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; if (String.IsNullOrEmpty(destino) == true)&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; return;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; #endregion&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; #region Recupera o arquivo&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; FileInfo arquivo = null;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; if (File.Exists(destino) == true)&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; File.Delete(destino);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; arquivo = new FileInfo(destino);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; else&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; arquivo = new FileInfo(destino);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; #endregion&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; if (String.IsNullOrEmpty(nomePlanilha) == true)&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; nomePlanilha = "Plan 1";&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; #region Exporta os dados&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; using (OfficeOpenXml.ExcelPackage excelApp = new OfficeOpenXml.ExcelPackage(arquivo))&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; #region cria planilha&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; OfficeOpenXml.ExcelWorksheet planilha = excelApp.Workbook.Worksheets.Add(nomePlanilha);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; #endregion&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; #region Recupera colunas (get cols)&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; int indexCol = 1;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; foreach (DataGridViewColumn col in grid.Columns)&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; if (col.Visible == true &amp;amp;&amp;amp; col.CellType == typeof(DataGridViewTextBoxCell))&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; planilha.Cells[1, indexCol].Value = col.HeaderText;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; indexCol++;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; #endregion&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; #region Adiciona linhas (add lines)&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; int linhaCorrente = 2;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; foreach (DataGridViewRow row in grid.Rows)&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; indexCol = 1;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; foreach (DataGridViewColumn col in grid.Columns)&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; if (col.Visible == true &amp;amp;&amp;amp; col.CellType == typeof(DataGridViewTextBoxCell))&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; planilha.Cells[linhaCorrente, indexCol].Value = row.Cells[col.Name].FormattedValue.ToString();&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; indexCol++;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; linhaCorrente++;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; #endregion&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; #region salva&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; // set some document properties&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; excelApp.Workbook.Properties.Title = "Relatório";&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; excelApp.Workbook.Properties.Author = "Paulo";&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; excelApp.Workbook.Properties.Comments = "Planilha gerada pelo sistema";&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; // set some extended property values&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; excelApp.Workbook.Properties.Company = "Moreira";&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; // save our new workbook and we are done!&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; excelApp.Save();&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; planilha = null;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; #endregion&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; GC.Collect();&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; #endregion&lt;br&gt;
}&lt;br&gt;
/// &amp;lt;summary&amp;gt;&lt;br&gt;
/// Create DataGridView test to export to excel.&lt;br&gt;
/// &amp;lt;/summary&amp;gt;&lt;br&gt;
/// &amp;lt;returns&amp;gt;&amp;lt;/returns&amp;gt;&lt;br&gt;
private DataGridView getGridTeste()&lt;br&gt;
{&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; DataGridView grid = new DataGridView();&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; grid.Columns.Add("Nome", "Nome");&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; grid.Rows.Add(new object[2] { "Paulo", "Alessandra" });&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; return grid;&lt;br&gt;
}&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="paulo3011" When="24/03/2011 19:48:16">
          <Html>
        
&lt;p&gt;If I open it under Excel -&amp;gt; Open, it works fine.&lt;br&gt;
If I click on the file Icon, I get the error...&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="paulo3011" When="24/03/2011 20:04:56">
          <Html>
        
&lt;p&gt;Hi, i solved the problem make:&lt;/p&gt;
&lt;p&gt;If you are &lt;a id="KonaLink1" style="font-family: inherit !important; font-size: inherit !important; font-weight: inherit !important; text-decoration: underline !important; position: static;" href="http://excel.tips.net/Pages/T003046_Ignoring_Other_Applications.html#" rel="nofollow"&gt;
&lt;span style="color: blue;"&gt;&lt;span style="color: blue !important; font-family: inherit !important; font-size: inherit !important; font-weight: inherit !important; border-bottom-color: blue; border-bottom-width: 1px; border-bottom-style: solid; background-color: transparent;"&gt;using
&lt;/span&gt;&lt;span style="color: blue !important; font-family: inherit !important; font-size: inherit !important; font-weight: inherit !important; border-bottom-color: blue; border-bottom-width: 1px; border-bottom-style: solid; background-color: transparent;"&gt;Excel&lt;/span&gt;&lt;/span&gt;&lt;/a&gt; 2007, then you must follow these steps:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Click the Office button and then click &lt;a href="http://spreadsheets.about.com/od/exceltips/qt/excel07_options.htm" target="_blank" rel="nofollow"&gt;
Excel Options&lt;/a&gt;. Excel displays the Excel Options dialog box. &lt;/li&gt;&lt;li&gt;Click Advanced at the left side of the dialog box. &lt;/li&gt;&lt;li&gt;Scroll through the options until you can see the General group. (&lt;a href="http://excel.tips.net/FigFiles/T3046F2.html" target="_blank" rel="nofollow"&gt;Click here&lt;/a&gt; to see a related figure.)
&lt;/li&gt;&lt;li&gt;Make sure the Ignore Other Applications That Use Dynamic &lt;a id="KonaLink2" style="font-family: inherit !important; font-size: inherit !important; font-weight: inherit !important; text-decoration: underline !important; position: static;" href="http://excel.tips.net/Pages/T003046_Ignoring_Other_Applications.html#" rel="nofollow"&gt;
&lt;span style="color: blue;"&gt;&lt;span style="color: blue !important; font-family: inherit !important; font-size: inherit !important; font-weight: inherit !important;"&gt;Data&lt;/span&gt;&lt;/span&gt;&lt;/a&gt; Exchange (DDE) check box is not selected.
&lt;/li&gt;&lt;li&gt;Click OK. &lt;/li&gt;&lt;/ol&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How do I copy rows">
      <Posts>
        <Post From="johnsgw" When="22/03/2011 16:17:39">
          <Html>
        
&lt;p&gt;I need to copy two rows from the&amp;nbsp;top of my worksheet (5 &amp;amp; 6)&amp;nbsp; and insert them into rows (10 &amp;amp; 11).&amp;nbsp; I looked at the ExcelRange Copy but I cant get the syntax correct.&lt;/p&gt;
&lt;p&gt;Thanks,&lt;/p&gt;
&lt;p&gt;Glenn&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="22/03/2011 16:55:03">
          <Html>
        
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;Try something like this...&lt;/pre&gt;
&lt;pre&gt;ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"5:6"&lt;/span&gt;].Copy(ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"10:11"&lt;/span&gt;]);
&lt;/pre&gt;
&lt;pre&gt;It will overwrite row 10 &amp;amp; 11 so use the InsertRow before you do this if you want to keep any data below&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="johnsgw" When="23/03/2011 18:58:36">
          <Html>
        
&lt;p&gt;&lt;span style="color: rgb(31, 73, 125); font-size: 11pt;"&gt;Thanks that worked.&amp;nbsp; Sometimes it hard to see the simple things&amp;nbsp; went you’re looking to deep.&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(31, 73, 125); font-size: 11pt;"&gt;Glenn&lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Reading an existing excel file">
      <Posts>
        <Post From="lustuyck" When="23/03/2011 14:05:12">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;it seems that you can pass a template excel file name, when constructing&lt;/p&gt;
&lt;pre style="font-family: consolas;"&gt;&lt;span style="color: blue;"&gt;using&lt;/span&gt;&amp;nbsp;(&lt;span style="color: blue;"&gt;var&lt;/span&gt;&amp;nbsp;package&amp;nbsp;=&amp;nbsp;&lt;span style="color: blue;"&gt;new&lt;/span&gt;&amp;nbsp;&lt;span style="color: rgb(43, 145, 175);"&gt;ExcelPackage&lt;/span&gt;(newFile, templateFile)) {}&lt;br&gt;&lt;/pre&gt;
&lt;p&gt;I was just wondering why it's not possible to read in an excel file directly, and manipulate the original file itself?&lt;/p&gt;
&lt;p&gt;Kind regards,&lt;/p&gt;
&lt;p&gt;L&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="23/03/2011 14:21:16">
          <Html>
        
&lt;p&gt;You can, just open your file as a MemoryStream and pass to ExcelPackage constructor.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="lustuyck" When="23/03/2011 14:38:30">
          <Html>
        
&lt;p&gt;cool, I wll try that!&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Add formula to cell">
      <Posts>
        <Post From="gmhamm0" When="22/03/2011 15:45:51">
          <Html>
        
&lt;p&gt;I'm trying to add the following formula to a cell:&lt;/p&gt;
&lt;p&gt;ws.Cells["D5"].Formula = "COUNTIF(A1:A100,\"Miss\")";&lt;/p&gt;
&lt;p&gt;This formula works great in excel when I add it manually.&amp;nbsp; However, when i try to add it using the above line of code, the cell in the output file is always empty.&amp;nbsp; Is it possible to add this type of function to an excel sheet?&amp;nbsp; If so, how?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="22/03/2011 16:29:22">
          <Html>
        
&lt;p&gt;This works fine when I try it with the latest source and Excel 2007.&lt;/p&gt;
&lt;p&gt;What version are you using?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="gmhamm0" When="22/03/2011 16:32:51">
          <Html>
        
&lt;div&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 11pt;"&gt;I’m using the trunk from epplus-74444 and excel 2010. However, I did some more research on the discussions and using CreateArrayFormula works.&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 11pt;"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 11pt;"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;div&gt;
&lt;div style="border-width: 1pt medium medium; border-style: solid none none; border-color: rgb(181, 196, 223) currentColor currentColor; padding: 3pt 0in 0in; border-image: none;"&gt;
&lt;p&gt;&lt;b&gt;&lt;span style="font-family:; font-size: 10pt;"&gt;From:&lt;/span&gt;&lt;/b&gt;&lt;span style="font-family:; font-size: 10pt;"&gt; jankallman [email removed]
&lt;br&gt;
&lt;b&gt;Sent:&lt;/b&gt; Tuesday, March 22, 2011 11:30 AM&lt;br&gt;
&lt;b&gt;To:&lt;/b&gt; Hammond, Greg&lt;br&gt;
&lt;b&gt;Subject:&lt;/b&gt; Re: Add formula to cell [EPPlus:250690]&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 9pt;"&gt;From: jankallman&lt;/span&gt;&lt;/p&gt;
&lt;div id="ThreadNotificationPostBody" style="margin-bottom: 24pt;"&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 9pt;"&gt;This works fine when I try it with the latest source and Excel 2007.&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 9pt;"&gt;What version are you using?&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Object Refernce not set to an instance of an object">
      <Posts>
        <Post From="MBOUCHAALA" When="18/03/2011 18:50:31">
          <Html>
        
&lt;p&gt;Hi all,&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I developed a custom ASP.NET froms to integrate them in a sharepoint application, to update an Excel file from these Forms.&lt;/p&gt;
&lt;p&gt;I am getting a problem with the file wich is located in a shared folder. When i get the ExcelPackage, i don't have a problem but wehn accessing to a specific Range of cells, i don't get anything.&lt;/p&gt;
&lt;p&gt;Here is My code&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; FileInfo info = new FileInfo(filePath);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; using (ExcelPackage exPckg = new ExcelPackage(info))&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; int delay = int.Parse(ICUtilities.GetConfigValue(SPContext.Current.Web, "Delay"));&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; //Here i'm obliged to wait some time to get the instance of the worksheets, else it catch an exception &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; WaitUntilExcelOK(exPckg, delay);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; var exWshts = exPckg.Workbook.Worksheets[workSheet];&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; //Here i am getting the issue exWshts.Celss : Object Refrence not set to an instance of an object.&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; var exRange = exWshts.Cells[rowBegin, columnCode, rowEnd, columnCode];&lt;/p&gt;
&lt;p&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; var enumRange = exRange.GetEnumerator();&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
&lt;br&gt;
&lt;/p&gt;
&lt;p&gt;Is there something wrong in my code. Why i am able to get the excel file, the worksheet but not the Cells?&lt;/p&gt;
&lt;p&gt;Could you help me it's very urgent !!!&lt;/p&gt;
&lt;p&gt;Thank you!&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="21/03/2011 08:08:13">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;First make sure you use the latest version 2.8.0.2 (there has been a few issues related to defined names previously). Make sure you dont use any unsupported features in your template (have a look at the FAQ).&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="WorkSheet.Dimension giving null reference Exception">
      <Posts>
        <Post From="klvnnsrikanth" When="17/03/2011 21:33:16">
          <Html>
        
&lt;p&gt;Hi&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I get a null reference exception when I am using Dimension on ExcelWorkSheet object&lt;/p&gt;
&lt;p&gt;Is there a way to fix this??&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;
&lt;p&gt;Sri&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="18/03/2011 15:19:23">
          <Html>
        
&lt;p&gt;If the worksheet has no cells the Dimension property returns null.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="klvnnsrikanth" When="18/03/2011 15:34:58">
          <Html>
        
&lt;p&gt;No I have cells in the excelsheet but it is still giving me a null value.&lt;/p&gt;
&lt;p&gt;The sheet has 170 rows and 6 columns of cells with data&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I am trying to clear all the cells and write new data&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I have used the Dimension to get the number of modified rows and columns in the excel sheet and it gives me a null reference exception&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="18/03/2011 15:58:04">
          <Html>
        
&lt;p&gt;Ok, that's strange.&lt;/p&gt;
&lt;p&gt;The&amp;nbsp;Dimesion property&amp;nbsp;looks likte this...&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;                &lt;span style="color: blue;"&gt;if&lt;/span&gt; (_cells.Count &amp;gt; 0)
                {
                    &lt;span style="color: blue;"&gt;return&lt;/span&gt; &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelAddressBase((_cells[0] &lt;span style="color: blue;"&gt;as&lt;/span&gt; ExcelCell).Row, _minCol, (_cells[_cells.Count - 1] &lt;span style="color: blue;"&gt;as&lt;/span&gt; ExcelCell).Row, _maxCol);
                }
                &lt;span style="color: blue;"&gt;else&lt;/span&gt;
                {
                    &lt;span style="color: blue;"&gt;return&lt;/span&gt; &lt;span style="color: blue;"&gt;null&lt;/span&gt;;
                }

&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;_cells are all the cells in the worksheet, so you don't have any loaded.&lt;/p&gt;
&lt;p&gt;Please provide me with some code to replicate this.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Excel files generated don't work with LibreOffice">
      <Posts>
        <Post From="StephaneS" When="08/03/2011 09:36:48">
          <Html>
        
&lt;p&gt;When I try to open Excel files generated with EPPlus in LibreOffice, it doesn't work at all. &amp;nbsp;What can be the problem?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thank's.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="10/03/2011 07:32:31">
          <Html>
        
&lt;p&gt;I have not idea. I have done all the testing in Excel 2007 / 2010.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="11/03/2011 08:00:50">
          <Html>
        
&lt;p&gt;I had a look at this yesterday and it turned out that LibreOffice did not like absolute uri's in the relationships between parts in the package.&lt;/p&gt;
&lt;p&gt;If you are interested you can download the latest source&amp;nbsp;and try it (It is fixed in the trunk).&lt;/p&gt;
&lt;p&gt;The files will open, but graphs, shapes and a lot of other stuff will not show up as expected.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Text orientation in a cell">
      <Posts>
        <Post From="nclaire" When="09/03/2011 08:53:25">
          <Html>
        
&lt;p&gt;Is there possible to change the text orientation in a cell ?&lt;/p&gt;
&lt;p&gt;I would like to put the "Vertical Text" option.&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="10/03/2011 07:33:10">
          <Html>
        
&lt;p&gt;Yes, use the Range.Style.TextRotation property&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Trim Spaces on save">
      <Posts>
        <Post From="tempbasura" When="05/01/2011 10:18:22">
          <Html>
        
&lt;p&gt;Hi, i try to find a discussion about this subject but i cant find a solution and i hope people on forum can help me.&lt;/p&gt;
&lt;p&gt;I have a trouble when i save the excel file generated, i have some cells that contains text that begins with some spaces like " &amp;nbsp; Hi excel."., when i debug the application and "see" the cell value, it seems correct but after save
 the cell contains only the text without start spaces ie. "Hi excel.".&lt;/p&gt;
&lt;p&gt;Could anybody help me with that?.&lt;/p&gt;
&lt;p&gt;Thanks in advance.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;P.D.:Please excuse my poor english level ;) &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; .&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="09/01/2011 19:11:22">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;No, that should be fixed. Heading and Trailing spaces are truncated in the xml (if you don't add the preserve whitespaces attribute to the shared string internally, something like this...&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;t&lt;/span&gt;
&lt;span style="color: red;"&gt;xml:space&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;preserve&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;t&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
 ).&lt;/p&gt;
&lt;p&gt;I'll&amp;nbsp;try to add fix for it.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Rummskull" When="08/03/2011 16:09:31">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;you have to add a secured space with ALT+0160 instead of your normal spaces.&lt;/p&gt;
&lt;p&gt;It worked for me :).&lt;/p&gt;
&lt;p&gt;Rumms.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Problem with empty cells when chart displaying">
      <Posts>
        <Post From="StephaneS" When="01/03/2011 15:29:23">
          <Html>
        
&lt;p&gt;Hi all,&lt;/p&gt;
&lt;p&gt;I have a problem with empty cells. I load data from a csv file. My data table in my first worksheet is loaded correctly with empty cell. But my chart which are linking to my table display empty value in replacing by zero. Correct behavior is to not display
 empty value, just a intervall with no value. When i click into empty cell, my chart is reloading and empty value are well displaying.&lt;/p&gt;
&lt;p&gt;Thanks for reply.&lt;br&gt;
Stéphane.&lt;/p&gt;
&lt;p&gt;(Sorry for my english..)&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="01/03/2011 19:18:35">
          <Html>
        
&lt;p&gt;This might help...&lt;/p&gt;
&lt;p&gt;&lt;a href="http://epplus.codeplex.com/discussions/236723" rel="nofollow"&gt;http://epplus.codeplex.com/discussions/236723&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="StephaneS" When="08/03/2011 09:37:37">
          <Html>
        
&lt;p&gt;Thanks I test this code.&lt;/p&gt;
&lt;p&gt;Stéphane.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Nuget enable?">
      <Posts>
        <Post From="akronite" When="17/12/2010 00:57:07">
          <Html>
        
&lt;p&gt;Should we consider exposing our library on nuget and openwrap?&lt;/p&gt;
&lt;p&gt;This would get more people into using the already great project.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="17/12/2010 08:22:22">
          <Html>
        
&lt;p&gt;Yes, I have looked at nuget, but I have not had the time to do anything about it. Feel free look&amp;nbsp;into&amp;nbsp;it if you want to.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="akronite" When="17/12/2010 12:17:13">
          <Html>
        Yes, sure i'll take a look at it during my Christmas holiday break... &lt;br&gt;
&lt;br&gt;
&lt;div&gt;On Fri, Dec 17, 2010 at 4:22 PM, jankallman &lt;span dir="ltr"&gt;&amp;lt;&lt;a href="mailto:notifications@codeplex.com" rel="nofollow"&gt;notifications@codeplex.com&lt;/a&gt;&amp;gt;&lt;/span&gt; wrote:&lt;br&gt;
&lt;blockquote style="margin: 0px 0px 0px 0.8ex; padding-left: 1ex; border-left-color: rgb(204, 204, 204); border-left-width: 1px; border-left-style: solid;"&gt;
&lt;div&gt;
&lt;p&gt;From: jankallman&lt;/p&gt;
&lt;div&gt;
&lt;p&gt;Yes, I have looked at nuget, but I have not had the time to do anything about it. Feel free look into it if you want to.&lt;/p&gt;
&lt;/div&gt;
&lt;div&gt;
&lt;p&gt;Read the &lt;a href="http://epplus.codeplex.com/Thread/View.aspx?ThreadId=238690&amp;amp;ANCHOR#Post537161" target="_blank" rel="nofollow"&gt;
full discussion online&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;To add a post to this discussion, reply to this email (&lt;a href="mailto:EPPlus@discussions.codeplex.com?subject=[EPPlus:238690]" target="_blank" rel="nofollow"&gt;EPPlus@discussions.codeplex.com&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;To start a new discussion for this project, email &lt;a href="mailto:EPPlus@discussions.codeplex.com" target="_blank" rel="nofollow"&gt;
EPPlus@discussions.codeplex.com&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;You are receiving this email because you subscribed to this discussion on CodePlex. You can
&lt;a href="https://epplus.codeplex.com/discussions/238690/unsubscribe/" target="_blank" rel="nofollow"&gt;
unsubscribe&lt;/a&gt; on CodePlex.com.&lt;/p&gt;
&lt;p&gt;Please note: Images and attachments will be removed from emails. Any posts to this discussion will also be available online at CodePlex.com&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/blockquote&gt;
&lt;/div&gt;
&lt;br&gt;

        
    </Html>
        </Post>
        <Post From="carlescs" When="07/03/2011 09:46:59">
          <Html>
        
&lt;p&gt;Is there any update to this? I can help making the Nuget package if you want me to...&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="carlescs" When="07/03/2011 09:55:56">
          <Html>
        
&lt;p&gt;I made the package. Should I create an issue and add the package as an attachment?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="carlescs" When="07/03/2011 11:23:29">
          <Html>
        
&lt;p&gt;I've seen it is now in Nuget. Thanks.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="07/03/2011 18:10:19">
          <Html>
        
&lt;p&gt;Yes, just got some help adding it the other dag, but thanks anyway&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Is EPPlus supports Excel's Goal seek feature?">
      <Posts>
        <Post From="vispqr" When="03/03/2011 05:33:56">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I have a requirement to use Excel's Goal seek method in my C#.net Web application. I want to call this method from my .aspx.cs page. I have doubt is this possible or not? If it is possible can any one tell me how to use Goal seek method in C#.net application.
 I am using technologies Visual Studio 2005, C#.Net, ASP.Net ,Microsoft Office 2003 and Operating system Windows Xp.&lt;/p&gt;
&lt;p&gt;Thank you &amp;amp; Regards,&lt;/p&gt;
&lt;p&gt;Viswanath.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="03/03/2011 15:44:00">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;No, there is no implementation for goal seek.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="EPPlus c# landscape orientation">
      <Posts>
        <Post From="rd42rd42" When="28/02/2011 14:36:19">
          <Html>
        
&lt;p&gt;How do I specify, or are there examples to look at for coding my spreadsheet to be landscape instead of portrait?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thank you,&lt;/p&gt;
&lt;p&gt;rd42&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="01/03/2011 19:14:15">
          <Html>
        
&lt;p&gt;Use the Worksheet.Printersettings.Orientation property&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="rd42rd42" When="01/03/2011 20:13:17">
          <Html>
        
&lt;p&gt;Thanks!&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Alternatives to Format32bbArgb">
      <Posts>
        <Post From="jrgalang" When="28/02/2011 00:15:45">
          <Html>
        
&lt;p&gt;Hi, I have an app that creates an Excel with several images in them. Based from the examples I use the following code:&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;Bitmap bmpScreenshot = &lt;span style="color: blue;"&gt;new&lt;/span&gt; Bitmap(Screen.PrimaryScreen.Bounds.Width, Screen.PrimaryScreen.Bounds.Height, PixelFormat.Format32bppArgb);
Graphics gfxScreenshot = Graphics.FromImage(bmpScreenshot);
ExcelPicture ScreenshotSave = getWorksheet.Drawings.AddPicture(&lt;span style="color: rgb(163, 21, 21);"&gt;"Screenshot "&lt;/span&gt; + x + DateTime.Now, bmpScreenshot);
ScreenshotSave.SetSize(2);
ScreenshotSave.SetPosition(x, 1, 3, 1);
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;The screenshots are real clear and can be resized without loss in details, however, it consumes so much space that the Excel file that will be appended can reach 20MB in no time, around which I get to experience frequent System.OutofMemory exceptions already.&lt;/p&gt;
&lt;p&gt;Tried changing the format from Format32bppArgb to others (such as Grayscale or 8 bit) just to compensate, but it appears the OutofMemory exception becomes worse.&lt;/p&gt;
&lt;p&gt;I was wondering if there are other ways of adding screenshots onto the Excel file without using a bitmap format? Or alternatively bitmap format but significantly lesser in terms of file size consumption. Loss of detail and colors wouldn't matter, the priority
 is to keep the file size of the Excel small and portable.&lt;/p&gt;
&lt;p&gt;Any thoughts? :)&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="28/02/2011 06:54:51">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;The image is saved as a jpg internally, so&amp;nbsp;it should not take that much space.&amp;nbsp;I suggest&amp;nbsp;you shrink&amp;nbsp;it before you add add it.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jrgalang" When="28/02/2011 07:08:41">
          <Html>
        
&lt;p&gt;Hi Jan,&lt;/p&gt;
&lt;p&gt;Thanks for your response. However that doesn't seem to be the case... if I take seven screenshots manually and save it as JPEG via Paint, I only get about ~500KB. However, if I run the code above for the same seven screenshots, the file size ramps up to
 ~3MB.&lt;/p&gt;
&lt;p&gt;When you say shrink, do you mean SetSize? Or something else? I tried altering the PixelFormat property from the instantiated bitmap but I get issues as well as posted.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jrgalang" When="28/02/2011 23:22:07">
          <Html>
        
&lt;p&gt;Just to add, the images saved are screenshots taken at a particular execution of a code. I changed the resolution of my screen to 800x600 in hope of lessening the file size consumption but the decrease in file size is not substantial enough to lessen the
 overall size of the Excel file..&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="C# EPPlus OpenXML count rows">
      <Posts>
        <Post From="rd42rd42" When="23/01/2011 23:00:45">
          <Html>
        
&lt;p&gt;With EPPlus and OpenXML does anyone know the syntax on how to count the rows?&lt;/p&gt;
&lt;p&gt;Say my worksheet is called "worksheet"&lt;/p&gt;
&lt;p&gt;int numberRows = worksheet.rows.count()? or worksheet.rows.dimension&lt;/p&gt;
&lt;p&gt;I'm cetainly interested in the answer, but how to find the answer would be cool to, like "Go to definition" and look for this or that, etc.&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="akronite" When="23/01/2011 23:53:34">
          <Html>
        
&lt;p&gt;Hi, and welcome to codeplex.&lt;/p&gt;
&lt;p&gt;Please use &lt;strong&gt;rows.dimension&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;As for documentation, please check out:&lt;/p&gt;
&lt;p&gt;http://epplus.codeplex.com/wikipage?title=ExtensionMethods&lt;/p&gt;
&lt;p&gt;http://epplus.codeplex.com/wikipage?title=ContentSheetExample&lt;/p&gt;
&lt;p&gt;http://epplus.codeplex.com/wikipage?title=StatisticsSheetExample&lt;/p&gt;
&lt;p&gt;http://epplus.codeplex.com/wikipage?title=LinqExample&lt;/p&gt;
&lt;p&gt;http://epplus.codeplex.com/wikipage?title=WebapplicationExample&lt;/p&gt;
&lt;p&gt;Working example are also available in our downloads.&lt;/p&gt;
&lt;p&gt;- Michael T.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="rd42rd42" When="28/02/2011 14:37:49">
          <Html>
        
&lt;p&gt;Thanks for all the links!&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to set Y-Axis title for ColumnClustered chart">
      <Posts>
        <Post From="SweeHockChoo" When="23/02/2011 21:27:39">
          <Html>
        
&lt;p&gt;Is there a way to set the title for Y-Axis of a ColumnClustered chart?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="25/02/2011 08:42:13">
          <Html>
        
&lt;p&gt;No, you can set the title for the series, if that is what you mean.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="sweehockchoo" When="28/02/2011 14:35:29">
          <Html>
        
&lt;p&gt;Jan,&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp; thanks for the reply. What I meants was how to label the axis of the chart. I need to label the Y-Axis as Hour and the X-Axis as Order Number.&amp;nbsp; Thanks.&lt;/p&gt;
&lt;p&gt;SweeHock.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="GPL is holding you back...">
      <Posts>
        <Post From="taras_b" When="28/02/2011 06:16:33">
          <Html>
        
&lt;p&gt;This is a fantastic product. Love it. But GPL!? Seriously!?&lt;br&gt;
&lt;br&gt;
We would like to use you product in the comercial (propriatry) software. We wouldn't even mind paying for it. But your licensing is forsing us to go with anothe inferior solution.&lt;/p&gt;
&lt;p&gt;I know you stated about a year ago that you have no objections to the commercial use of EPPlus.&amp;nbsp;&lt;/p&gt;
&lt;p style="padding-left: 30px;"&gt;&lt;em&gt;&lt;a href="http://epplus.codeplex.com/discussions/208363" rel="nofollow"&gt;http://epplus.codeplex.com/discussions/208363&lt;/a&gt;&lt;/em&gt;&lt;br&gt;
&lt;em&gt;Anyway, if you want to use the component commercial, I dont have any problem with that, but if you do any changes to the component that could benefit the project, please contribute them.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Great but your resonse on some forum&amp;nbsp;is not a substitution for license. I cannot put it to the project documentation folder.
&lt;br&gt;
&lt;br&gt;
If you are serious about allowing people to use yor product commercially please consider adjusting the license or issuing custom license if it is more appropriate for you.&lt;/p&gt;
&lt;p&gt;Best regards&lt;br&gt;
&lt;br&gt;
&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="28/02/2011 07:33:43">
          <Html>
        
&lt;p&gt;Yes, the GPL license has it's drawbacks, but&amp;nbsp;the problem here is that the project EPPlus origins from (ExcelPackage) is licensed GPL.&lt;/p&gt;
&lt;p&gt;So my options if I want to change the licens is to get a permission from the ExcelPackage project owner (I have tried that, with no answer) or rewrite everything.&lt;/p&gt;
&lt;p&gt;It is not that much left from the original Excelpackage, apart from the interface and some fragments here and there, but I'm not really sure where you draw the line here.&lt;/p&gt;
&lt;p&gt;So, if&amp;nbsp;I deside to change the&amp;nbsp;licens I&amp;nbsp;guess I will be&amp;nbsp;personally responsible&amp;nbsp;for it and I'm not really comfortable with that yet.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="taras_b" When="28/02/2011 10:08:02">
          <Html>
        
&lt;p&gt;Thank you Jan,&lt;/p&gt;
&lt;p&gt;I understand your difficulties. The GPL does indeed limit your target audience. But well, you can only do what you can do.&lt;/p&gt;
&lt;p&gt;Best regards,&lt;br&gt;
Taras&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="MaxRow and MinRow ...">
      <Posts>
        <Post From="green_soft_group" When="19/02/2011 09:11:16">
          <Html>
        
&lt;p&gt;Hello, in change set 69409, epplus has MaxRow and MinRow property in ExcelWorksheet, but in change set 73311 these properties removed. Is it replacement methods or properties for these? And why removed?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="21/02/2011 15:55:52">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I'm not sure what you mean?&amp;nbsp;There is no MaxRow or MinRow property in ExcelWorksheet in change set 69409.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="green_soft_group" When="22/02/2011 09:30:45">
          <Html>
        
&lt;p&gt;ok, excuse me. You are right&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to figure out how many rows &amp;amp; columns per row">
      <Posts>
        <Post From="chobo2" When="21/02/2011 19:47:32">
          <Html>
        
&lt;p&gt;Hi&lt;/p&gt;
&lt;p&gt;I want a user to upload a file and I want to go row by row and extract the data. I am wondering how can I do this. I don't see any row.Count() so I don't know how many times to make&lt;/p&gt;
&lt;p&gt;my loop.&lt;/p&gt;
&lt;p&gt;What should I be using?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="21/02/2011 19:52:27">
          <Html>
        
&lt;p&gt;Use rows.dimension or try with linq. Look at sample´s project.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="chobo2" When="21/02/2011 20:05:04">
          <Html>
        
&lt;blockquote style="margin: 0.25em 1em 0pt; padding: 0pt 0.25em; border: 0.1em solid rgb(204, 204, 204); border-image: none; font-style: italic;"&gt;
&lt;strong&gt;mrxrsd wrote:&lt;/strong&gt;&lt;br&gt;
&lt;p&gt;Use rows.dimension or try with linq. Look at sample´s project.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;I have been but what I been looking has seemed to be a hardcoded times it goes through the rows. Nothing on the fly. What example should I be looking at?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="21/02/2011 20:18:20">
          <Html>
        
&lt;p&gt;&lt;a href="http://epplus.codeplex.com/SourceControl/changeset/view/73449&lt;a class=" workitemlink"=""&gt;#1434206&lt;/a&gt;" rel="nofollow"&amp;gt;http://epplus.codeplex.com/SourceControl/changeset/view/73449&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/1434206"&gt;#1434206&lt;/a&gt;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Generating a Chart as a new sheet">
      <Posts>
        <Post From="x97mdr" When="16/02/2011 11:10:50">
          <Html>
        
&lt;p&gt;Hey all,&lt;/p&gt;
&lt;p&gt;When I create a chart using Excel you can "move" the chart into a new sheet. &amp;nbsp;I can see plenty of examples for creating charts as objects within a sheet, but how do I create a chart as a new sheet all by itself?&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="17/02/2011 19:25:31">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Sorry, there's not support for worksheet charts at the moment.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="x97mdr" When="21/02/2011 14:42:16">
          <Html>
        
&lt;p&gt;Thanks Jan!&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Single cell Start and End properties">
      <Posts>
        <Post From="MichaelCsikos" When="15/02/2011 23:56:54">
          <Html>
        
&lt;p&gt;Hi Jan&lt;/p&gt;
&lt;p&gt;var cell = worksheet.Cells[2, 3];&lt;/p&gt;
&lt;p&gt;The cell's Start and End properties are both A1, i.e. wrong. A single cell is still an ExcelRange object, and the Start and End properties should still be correct. In this case they would be the same: B3.&lt;/p&gt;
&lt;p&gt;Given a single cell, how do you retrieve the row and column indexes as integers without the Start and End properties?&lt;/p&gt;
&lt;p&gt;Kind regards&lt;br&gt;
Michael&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="17/02/2011 19:23:15">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;It's fixed in the source. Build it from the &amp;nbsp;tags\2.8.0.1 folder.&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I'll see if i can do a minor release with some bug fixes soon.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Charts look odd when be opened by Microsoft Excel 2010.">
      <Posts>
        <Post From="chichow" When="15/02/2011 15:28:30">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I opened the sample excel file that contains chart such as sample5.xlsx or sample9.xlsx from EPPlus 2.8.0.1 sample by using Microsoft Excel 2010. The charts look odd. There is no value and line in x and y axis, the legend stays at the middle of the chart
 (NOT beside the chart). But it looks good when I open excel file by using Microsoft Excel 2007. Does this library support Microsoft Excel 2010?&lt;/p&gt;
&lt;p&gt;Thank you,&lt;br&gt;
chichow&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="15/02/2011 15:54:52">
          <Html>
        
&lt;p&gt;This is fixed if you download the latest source and build it from the tag/2.8.0.1 folder (I have not had the time to do a proper releast yet).&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="ExcelDrawing.SetPosition(int Row, int RowOffsetPixels, int Column, int ColumnOffsetPixels)">
      <Posts>
        <Post From="MichaelCsikos" When="15/02/2011 00:37:58">
          <Html>
        
&lt;p&gt;Hi Jan and others&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(0, 128, 192);"&gt;ExcelDrawing&lt;/span&gt;.SetPosition(&lt;span style="color: rgb(64, 128, 255);"&gt;int&lt;/span&gt;&amp;nbsp;Row,&amp;nbsp;&lt;span style="color: rgb(64, 128, 255);"&gt;int&lt;/span&gt;&amp;nbsp;RowOffsetPixels,&amp;nbsp;&lt;span style="color: rgb(64, 128, 255);"&gt;int&lt;/span&gt;&amp;nbsp;Column,&amp;nbsp;&lt;span style="color: rgb(64, 128, 255);"&gt;int&lt;/span&gt;&amp;nbsp;ColumnOffsetPixels)
 seems to use zero-based indexes for row and column, whereas everything else in EPPlus uses one-based indexes. Is this a bug?&lt;/p&gt;
&lt;p&gt;Kind regards&lt;br&gt;
Michael&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="15/02/2011 15:52:24">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;The file format use&amp;nbsp;a zero-based row index, so thats why. I have tried not to&amp;nbsp;recalculate the values in the format, but in this case it would have been better. But I can't change it now, since a lot of people use it in production.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Question about XYScatterSmoothNoMarkers and ColumnClustered3D charts">
      <Posts>
        <Post From="chichow" When="13/02/2011 03:53:21">
          <Html>
        
&lt;div&gt;Hello,&lt;/div&gt;
&lt;div&gt;&lt;/div&gt;
&lt;div&gt;I would like to ask you some questions about creating chart as the following:&lt;/div&gt;
&lt;ol&gt;
&lt;li&gt;XYScatterSmoothNoMarkers chart and in the x - axis, they will be date time value such as 2011/02/13 10:30:20 AM after it's saved I opened this xlsx file, date time value in x - axis were&amp;nbsp;overlapped&amp;nbsp;each other. How can I set alignment to be horizontal
 for text direction and -45 degree for custom angle? If it cannot be done, there are some possibility of sub-heading to show date time value for the first and last axis data?
&lt;/li&gt;&lt;li&gt;ColumnClustered3D chart, after saving excel for this chart, I found that the chart was rotated by default. I checked it in MS Excel 2007 by right click to the chart and select 3-D Rotation menu, I found that the perspective value was 15 degree and the "Right
 Angle Axes" checkbox in chart scale section was not checked. I tried to check this checkbox, the chart then was not rotated as that I need. How can I set these in my code?
&lt;/li&gt;&lt;/ol&gt;
&lt;p&gt;Thank you,&lt;/p&gt;
&lt;p&gt;chichow&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="15/02/2011 15:42:39">
          <Html>
        
&lt;p&gt;No, it's not supported in version 2.8 unless you use a template.&lt;/p&gt;
&lt;p&gt;But you can&amp;nbsp;also work directly with the ChartXml property. Like in this sample&lt;/p&gt;
&lt;p&gt;&lt;a href="http://epplus.codeplex.com/discussions/236723" rel="nofollow"&gt;http://epplus.codeplex.com/discussions/236723&lt;/a&gt;&lt;a href="http://epplus.codeplex.com/discussions" rel="nofollow"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;...or&amp;nbsp;add the new property to the library. Heres a little walkthrough how to add the RightAngleAxes (I'll add this to the&amp;nbsp;FAQ later on)...&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;First we need to find the&amp;nbsp;XML&amp;nbsp;node we want to set, so we&amp;nbsp;open an Excelworkbook, add the&amp;nbsp;graph and set the property.&amp;nbsp;
&lt;/li&gt;&lt;li&gt;Save the workbook, Extract it and find the&amp;nbsp;xmlNode in the&amp;nbsp;xl\charts\chart1.xml file.
&lt;/li&gt;&lt;li&gt;The node we want is c:chart/c:chartSpace/c:view3D/c:rAngAx/@val &lt;/li&gt;&lt;li&gt;Now we need to find the appropriate class (if it exists), in this case we can use the ExcelView3D-class.
&lt;/li&gt;&lt;li&gt;Lets add the property... &lt;/li&gt;&lt;/ul&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;const&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; rAngAxPath = &lt;span style="color: rgb(163, 21, 21);"&gt;"c:rAngAx/@val"&lt;/span&gt;;
&lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;bool&lt;/span&gt; RightAngleAxes
{
    &lt;span style="color: blue;"&gt;get&lt;/span&gt;
    {
        &lt;span style="color: blue;"&gt;return&lt;/span&gt; GetXmlNodeBool(rAngAxPath);
    }
    &lt;span style="color: blue;"&gt;set&lt;/span&gt;
    {
        SetXmlNodeBool(rAngAxPath, value);
    }
}

&lt;/pre&gt;
&lt;/div&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;ul&gt;
&lt;li&gt;The ExcelView3D has the c:chart/c:chartSpace/c:view3D as topnode, so we start the XPath from&amp;nbsp;there. The Get and Set methods comes from the XMLHelper base class.
&lt;/li&gt;&lt;/ul&gt;
&lt;/div&gt;
&lt;p&gt;Lets add two more properties, just for the sample...&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;       &lt;span style="color: blue;"&gt;const&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; depthPercentPath = &lt;span style="color: rgb(163, 21, 21);"&gt;"c:depthPercent/@val"&lt;/span&gt;;
       &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;int&lt;/span&gt; DepthPercent
       {
           &lt;span style="color: blue;"&gt;get&lt;/span&gt;
           {
               &lt;span style="color: blue;"&gt;return&lt;/span&gt; GetXmlNodeInt(depthPercentPath);
           }
           &lt;span style="color: blue;"&gt;set&lt;/span&gt;
           {
               &lt;span style="color: blue;"&gt;if&lt;/span&gt; (value &amp;lt; 0 || value &amp;gt; 2000)
               {
                   &lt;span style="color: blue;"&gt;throw&lt;/span&gt;(&lt;span style="color: blue;"&gt;new&lt;/span&gt; ArgumentOutOfRangeException(&lt;span style="color: rgb(163, 21, 21);"&gt;"Value must be between 0 and 2000"&lt;/span&gt;));
               }
               SetXmlNodeString(depthPercentPath, value.ToString());
           }
       }
       &lt;span style="color: blue;"&gt;const&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; heightPercentPath = &lt;span style="color: rgb(163, 21, 21);"&gt;"c:hPercent/@val"&lt;/span&gt;;
       &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;int&lt;/span&gt; HeightPercent
       {
           &lt;span style="color: blue;"&gt;get&lt;/span&gt;
           {
               &lt;span style="color: blue;"&gt;return&lt;/span&gt; GetXmlNodeInt(heightPercentPath);
           }
           &lt;span style="color: blue;"&gt;set&lt;/span&gt;
           {
               &lt;span style="color: blue;"&gt;if&lt;/span&gt; (value &amp;lt; 5 || value &amp;gt; 500)
               {
                   &lt;span style="color: blue;"&gt;throw&lt;/span&gt; (&lt;span style="color: blue;"&gt;new&lt;/span&gt; ArgumentOutOfRangeException(&lt;span style="color: rgb(163, 21, 21);"&gt;"Value must be between 5 and 500"&lt;/span&gt;));
               }
               SetXmlNodeString(heightPercentPath, value.ToString());
           }
       }

&lt;/pre&gt;
&lt;/div&gt;
&lt;/li&gt;&lt;li&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;One thing left to do. Its important the the xml-elements comes in the correct order according to the schema, so we must ensure that. As help we use the SchemaNodeOrder property to ensure the elements are created at the correct place...&lt;/pre&gt;
&lt;/div&gt;
&lt;/li&gt;&lt;li&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;div style="color: black; background-color: white;"&gt;&lt;pre&gt;&lt;span style="color: blue;"&gt;public&lt;/span&gt; ExcelView3D(XmlNamespaceManager ns, XmlNode node)
           : &lt;span style="color: blue;"&gt;base&lt;/span&gt;(ns,node)
{
           &lt;span style="color: green;"&gt;//SchemaNodeOrder = new string[] { "rotX", "rotY", "perspective" };&lt;/span&gt;
           SchemaNodeOrder = &lt;span style="color: blue;"&gt;new&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt;[] { &lt;span style="color: rgb(163, 21, 21);"&gt;"rotX"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"hPercent"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"rotY"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"depthPercent"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"perspective"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"rAngAx"&lt;/span&gt;};
}

&lt;/pre&gt;
&lt;/div&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;/li&gt;&lt;li&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;So we change the property in the constructor. And we are done.&lt;/pre&gt;
&lt;/div&gt;
&lt;/li&gt;&lt;/ul&gt;
&lt;p style="color: black; background-color: white;"&gt;&lt;/p&gt;
&lt;pre&gt;I'll add this to the library next time i check in.&lt;/pre&gt;
&lt;pre&gt;Jan&lt;/pre&gt;
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to lock cells">
      <Posts>
        <Post From="heti" When="11/02/2011 16:43:18">
          <Html>
        
&lt;p&gt;Hi Everyone,&lt;/p&gt;
&lt;p&gt;Can somebody please guide me as to how to lock the cells in an excel sheet so that nobody can edit it when. I dont want the sheet to be password protected thoough. I just want all cells to be read only.&lt;/p&gt;
&lt;p&gt;Thanks and Regards,&lt;/p&gt;
&lt;p&gt;Heti&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="15/02/2011 15:08:33">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Set...&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;worksheet.Protection.IsProtected=&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas; font-size: x-small;"&gt;true&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&amp;nbsp;&lt;/span&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;Also, check out sample 7 and 10&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Error saving file using Epplus">
      <Posts>
        <Post From="heti" When="11/02/2011 16:21:46">
          <Html>
        
&lt;p&gt;Hi Everyone,&lt;/p&gt;
&lt;p&gt;I have a web application running on windows 7 64 bit on iis 7, When i create an excel package an try to save it with excelpackage.save method it throws the above exception with the path name specified. The folder in the path has full permissions for Network
 Service, IUSR, IIS_IUSR.Following is my code. I think it is a permissions issue.&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;strFileName = &lt;span style="color: rgb(163, 21, 21);"&gt;"c:\"&lt;/span&gt; &amp;amp; strFileName
&lt;span style="color: blue;"&gt;Dim&lt;/span&gt; medFile &lt;span style="color: blue;"&gt;As&lt;/span&gt; &lt;span style="color: blue;"&gt;New&lt;/span&gt; FileInfo(strFileName)
&lt;span style="color: blue;"&gt;If&lt;/span&gt; medFile.Exists &lt;span style="color: blue;"&gt;Then&lt;/span&gt;
   medFile.Delete()
   medFile = &lt;span style="color: blue;"&gt;New&lt;/span&gt; FileInfo(strFileName)
&lt;span style="color: blue;"&gt;End&lt;/span&gt; &lt;span style="color: blue;"&gt;If&lt;/span&gt;
&lt;span style="color: blue;"&gt;Dim&lt;/span&gt; medPackage &lt;span style="color: blue;"&gt;As&lt;/span&gt; &lt;span style="color: blue;"&gt;New&lt;/span&gt; ExcelPackage(medFile)
&lt;span style="color: blue;"&gt;Dim&lt;/span&gt; medWorkSheet &lt;span style="color: blue;"&gt;As&lt;/span&gt; ExcelWorksheet = .Workbook.Worksheets.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"Medicion"&lt;/span&gt; &amp;amp; ViewState(&lt;span style="color: rgb(163, 21, 21);"&gt;"MEDICIONID"&lt;/span&gt;))
medWorkSheet.Cells(crtRow, crtCol).Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"Medicion ID"&lt;/span&gt; &lt;span style="color: green;"&gt;'Heading of the excel file&lt;/span&gt;
medPackage.save()
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;Thanks and Regards&lt;/p&gt;
&lt;p&gt;Heti&lt;/p&gt;
&lt;div id="_mcePaste" style="left: -10000px; top: 0px; width: 1px; height: 1px; overflow: hidden;"&gt;
&lt;pre&gt;strFileName = "c:\" &amp;amp; strFileName&lt;br&gt;Dim medFile As New FileInfo(strFileName)&lt;br&gt;If medFile.Exists Then&lt;br&gt;   medFile.Delete()&lt;br&gt;   medFile = New FileInfo(strFileName)&lt;br&gt;End If&lt;br&gt;Dim medPackage As New ExcelPackage(medFile)&lt;br&gt;Dim medWorkSheet As ExcelWorksheet = .Workbook.Worksheets.Add("Medicion" &amp;amp; ViewState("MEDICIONID"))&lt;br&gt;medWorkSheet.Cells(crtRow, crtCol).Value = "Medicion ID" 'Heading of the excel file&lt;div style="color: black; background-color: white;"&gt;&lt;pre&gt;strFileName = &lt;span style="color: rgb(163, 21, 21);"&gt;"c:\"&lt;/span&gt; &amp;amp; strFileName
&lt;span style="color: blue;"&gt;Dim&lt;/span&gt; medFile &lt;span style="color: blue;"&gt;As&lt;/span&gt; &lt;span style="color: blue;"&gt;New&lt;/span&gt; FileInfo(strFileName)
&lt;span style="color: blue;"&gt;If&lt;/span&gt; medFile.Exists &lt;span style="color: blue;"&gt;Then&lt;/span&gt;
   medFile.Delete()
   medFile = &lt;span style="color: blue;"&gt;New&lt;/span&gt; FileInfo(strFileName)
&lt;span style="color: blue;"&gt;End&lt;/span&gt; &lt;span style="color: blue;"&gt;If&lt;/span&gt;
&lt;span style="color: blue;"&gt;Dim&lt;/span&gt; medPackage &lt;span style="color: blue;"&gt;As&lt;/span&gt; &lt;span style="color: blue;"&gt;New&lt;/span&gt; ExcelPackage(medFile)
&lt;span style="color: blue;"&gt;Dim&lt;/span&gt; medWorkSheet &lt;span style="color: blue;"&gt;As&lt;/span&gt; ExcelWorksheet = .Workbook.Worksheets.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"Medicion"&lt;/span&gt; &amp;amp; ViewState(&lt;span style="color: rgb(163, 21, 21);"&gt;"MEDICIONID"&lt;/span&gt;))
medWorkSheet.Cells(crtRow, crtCol).Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"Medicion ID"&lt;/span&gt; &lt;span style="color: green;"&gt;'Heading of the excel file&lt;/span&gt;
medPackage.save()
&lt;/pre&gt;
&lt;/div&gt;
&lt;br&gt;medPackage.save()&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="heti" When="11/02/2011 16:40:50">
          <Html>
        
&lt;p&gt;I forgot to give modify permissions. Got it working now&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="hyperlink not updated when excel file changed location">
      <Posts>
        <Post From="juna" When="06/02/2011 03:25:03">
          <Html>
        
&lt;p&gt;I have written data into the excel. There are hyperlinks which link to some external files. However, when I switch the excel file and its external filepath, the hyperlink in the excel doesn't update to reflect its current location.&lt;/p&gt;
&lt;p&gt;I've tried opening the excel application itself to enter hyperlink and switching the filepath, the hyperlinks will get updated when i change path.&lt;/p&gt;
&lt;p&gt;can someone help me.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="07/02/2011 18:52:11">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Im not sure I understand what you do, but I guess you should use relative paths.&lt;/p&gt;
&lt;p&gt;Check out how Excel saves the Uri's (save your workbook in Excel, extract it as&amp;nbsp;descibed&amp;nbsp;in the FAQ, under formulas, &amp;nbsp;and look at the hyperlink URI's)&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="juna" When="10/02/2011 02:26:26">
          <Html>
        
&lt;p&gt;thanks for the response. I've figured it out myself.&lt;/p&gt;
&lt;p&gt;I used the following:&lt;/p&gt;
&lt;p&gt;ws.Cells[rowIterator, columnIterator].Formula ="=HYPERLINK("fileRelativePath","fileName")";&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to Set print Area">
      <Posts>
        <Post From="gnanadesigank" When="03/02/2011 07:01:05">
          <Html>
        
&lt;p&gt;Hello Sir,&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Im Using EPPlus for creating Excel in c#..i created the Excel file Successfully,But i dnt know how to set the Print Area in that excel, can Any one help me to solve this problem.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="03/02/2011 15:20:03">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Use the Worksheet.PrinterSettings.PrintArea property. Something like..&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;ws.PrinterSettings.PrintArea=ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A1:B2"&lt;/span&gt;];

Jan&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="gnanadesigank" When="06/02/2011 12:53:24">
          <Html>
        
&lt;p&gt;Thanks for ur Kind Help..&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; In that Excel file how to set the Row header in all pages .I tried many things but i dnt get the correct format.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Im using this statement..&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ws.PrinterSettings.RepeatRows.Address = "6:6";&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; im getting this error&amp;nbsp; "Object reference not to set an instance of an object"...&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="07/02/2011 18:53:52">
          <Html>
        
&lt;p&gt;Hi again,&lt;/p&gt;
&lt;p&gt;Try...&lt;/p&gt;
&lt;p&gt;&amp;nbsp;ws.PrinterSettings.RepeatRows=ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"6:6"&lt;/span&gt;];&lt;br&gt;
&lt;br&gt;
Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Formula with error">
      <Posts>
        <Post From="Green_Soft_Group" When="01/02/2011 08:06:59">
          <Html>
        
&lt;p&gt;Hello.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;When I set CellFormula to "!Rec", the EPPlus does not create exception. But when open excel file with MS Excel, not set anything and cell is blank.&lt;/p&gt;
&lt;p&gt;When set the cell formula in MS Excel to !Rec (=!Rec), Excel raise error.&lt;/p&gt;
&lt;p&gt;How can I get error in EPPlus when set a formula with error?&lt;/p&gt;
&lt;p&gt;Thanks a lot.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="01/02/2011 17:59:15">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Do you mean #&lt;strong&gt;REF!&lt;/strong&gt; ?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Green_Soft_Group" When="03/02/2011 05:18:39">
          <Html>
        
&lt;p&gt;No, any expression that start with "!" (=!MyExpression). There is same problem if set formula to a datetime value (=2011/05/07 12:01:05).&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="03/02/2011 15:06:26">
          <Html>
        
&lt;p&gt;Ok, I see what you mean.&lt;/p&gt;
&lt;p&gt;There is no validation in EPPlus when the formula property is set, so you have to be carefull.&lt;/p&gt;
&lt;p&gt;I think it's quite complicated to add, so that&amp;nbsp;will be something&amp;nbsp;for the future.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to set Checkbox checked to true?">
      <Posts>
        <Post From="DanRiches" When="27/01/2011 13:15:26">
          <Html>
        
&lt;p&gt;Hi all,&lt;/p&gt;
&lt;p&gt;I have an .xlsm template which contains some check boxes. I've tried all sorts of ways to set them to checked but I'm not having any luck.&lt;/p&gt;
&lt;p&gt;Does anyone have a preferred method of doing this is, if it can be done??&lt;/p&gt;
&lt;p&gt;Many Thanks, Dan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="30/01/2011 18:14:38">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;No, there is not support to set the value of a checkbox in the library in the current version, but I guess you can do it from a VBA-macro.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="DanRiches" When="31/01/2011 10:30:17">
          <Html>
        
&lt;p&gt;Ok, thanks Jan.&lt;/p&gt;
&lt;p&gt;I managed to get away with linking the Check boxes to a cell outside of the print region and just set those to 1 / 0 or TRUE / FALSE. Works great so far!!!&lt;/p&gt;
&lt;p&gt;Many thanks to all who contributed to this project, it's helped me out more than I have time to work out!!!!&lt;/p&gt;
&lt;p&gt;Dan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How can I lock worksheet?">
      <Posts>
        <Post From="michaltresnak" When="28/01/2011 13:21:24">
          <Html>
        
&lt;p&gt;Hi.&lt;/p&gt;
&lt;p&gt;I have a trouble with EPPlus. I need to lock a worksheet. When I tried it this way&lt;/p&gt;
&lt;p&gt;workSheet.Protection.SetPassword(password);&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Segoe UI; font-size: x-small;"&gt;where password is a string variable, result was corrupted excel package, which can not be opened.
 Am I missing something? What is the "best practice" for locking worksheet.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Segoe UI; font-size: x-small;"&gt;I have got a czech version of Office, could it be the trouble?&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Segoe UI; font-size: x-small;"&gt;Thank you in advance.&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="28/01/2011 17:10:33">
          <Html>
        
&lt;p&gt;No problem here in Brazilian and English versions of Office. I did the same way as you do.&lt;/p&gt;
&lt;p&gt;Did you try without password ? works fine ?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="30/01/2011 18:31:22">
          <Html>
        
&lt;p&gt;Can you provide a sample?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="michaltresnak" When="31/01/2011 09:14:33">
          <Html>
        
&lt;p&gt;Here is sample of my code:&lt;/p&gt;
&lt;p&gt;using (ExcelPackage package = new ExcelPackage(template, true))&lt;br&gt;
{&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ExcelWorksheet workSheet = package.Workbook.Worksheets.First();&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;// filling workSheet with data&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;workSheet.Protection.SetPassword(password);&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; return package.GetAsByteArray();&lt;br&gt;
}&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;When I try to open the result I get the message like "Excel found unreadable content in&lt;br&gt;
file..... do you want to recover it..." in czech of course...&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Error in open file with name">
      <Posts>
        <Post From="green_soft_group" When="29/01/2011 12:05:32">
          <Html>
        
&lt;p&gt;Hi&lt;/p&gt;
&lt;p&gt;If an EXCEL file contains name, when open with EPPlus encountered with error.&lt;/p&gt;
&lt;p&gt;In an excel file, insert a name and set "Refers to: " to a number (for example Refers to = 1). Now if open this file with epplus the "Object reference not set to an instance of an object." error is generated.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; var fi = new FileInfo(iFileName);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ExcelApp = new ExcelPackage(fi);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ObjBook = ExcelApp.Workbook;&amp;nbsp;&amp;nbsp;&amp;nbsp; ----&amp;gt; exception raised in this line&lt;/p&gt;
&lt;p&gt;Thanks a lot.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="30/01/2011 18:51:34">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Yes, I realized the library has some problemes with certain types of defined names...&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;If you have a name that has a #REF! (on worksheet level) &lt;/li&gt;&lt;li&gt;If you have a name that reference a value or a formula &lt;/li&gt;&lt;li&gt;If you have a name that reference an external worksheet. &lt;/li&gt;&lt;/ul&gt;
&lt;p&gt;If you have one of these type of defined names the library will throw an exception when loading the file.&lt;/p&gt;
&lt;p&gt;Since this will cause the library to crash, I will try to add a fix for it as soon as possible.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="XLSX files created by SSIS">
      <Posts>
        <Post From="varredor" When="28/01/2011 23:00:25">
          <Html>
        
&lt;p&gt;Hi.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I can't seem to get EPPLUS to recognize any data on xlsx files produced by a SSIS2008 package.&lt;/p&gt;
&lt;p&gt;However, it is always able to read the first line (header).&lt;/p&gt;
&lt;p&gt;But if i open those files on Excel, save them, and then load them again with EPPLUS, it works fine.&lt;/p&gt;
&lt;p&gt;My package has a simple dataflow task inserting data into an empty file, with only a 1st line being it's header.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="30/01/2011 18:33:56">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I have never tried to open SSIS generated files, but create an issue and upload a generated file so&amp;nbsp;I can have a look.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Slow load time">
      <Posts>
        <Post From="newnauk" When="28/01/2011 01:52:38">
          <Html>
        
&lt;p&gt;I have the following code (in brief) that had been working fine until now.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;using System;&lt;/p&gt;
&lt;p&gt;using System.IO;&lt;/p&gt;
&lt;p&gt;using System.Collections.Generic;&lt;/p&gt;
&lt;p&gt;using System.Text;using System.Xml;using System.Net;&lt;/p&gt;
&lt;p&gt;using System.Drawing;using System.Text.RegularExpressions;&lt;/p&gt;
&lt;p&gt;using HtmlAgilityPack;&lt;/p&gt;
&lt;p&gt;using OfficeOpenXml;&lt;/p&gt;
&lt;p&gt;using OfficeOpenXml.Style;&lt;/p&gt;
&lt;p&gt;using OfficeOpenXml.Style.XmlAccess;&lt;/p&gt;
&lt;p&gt;&lt;br&gt;
namespace XTFReportGenerator&lt;/p&gt;
&lt;p&gt;{&amp;nbsp;&amp;nbsp; &amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;span style="white-space: pre;"&gt;&lt;/span&gt;class Program&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp; &amp;nbsp;&lt;span style="white-space: pre;"&gt; &lt;/span&gt;{&lt;/p&gt;
&lt;p&gt;&lt;span style="white-space: pre;"&gt;&lt;/span&gt;&amp;nbsp;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;static void Main(string[] args)&amp;nbsp;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;span style="white-space: pre;"&gt;&lt;/span&gt;{&lt;/p&gt;
&lt;p&gt;&lt;span style="white-space: pre;"&gt;&lt;/span&gt;&amp;nbsp;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="white-space: pre;"&gt;
&lt;/span&gt;string root = "C:\\temp\";&lt;/p&gt;
&lt;p&gt;&lt;span style="white-space: pre;"&gt;&lt;/span&gt;string htmlVersion = "1.0.0.0.html";&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;span style="white-space: pre;"&gt;&lt;/span&gt;// create root directory&lt;/p&gt;
&lt;p&gt;&lt;span style="white-space: pre;"&gt;&lt;/span&gt;root = Path.Combine(root, version);&lt;/p&gt;
&lt;p&gt;&lt;span style="white-space: pre;"&gt;&lt;/span&gt;if (!Directory.Exists(root)) &amp;nbsp;&lt;span style="white-space: pre;"&gt;
&lt;/span&gt;{ ... }&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;span style="white-space: pre;"&gt;&lt;/span&gt;// create the root workbook&lt;/p&gt;
&lt;p&gt;&lt;span style="white-space: pre;"&gt;&lt;/span&gt;FileInfo xlsxFile = new FileInfo(root + "\\test.xlsx");&amp;nbsp;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;span style="white-space: pre;"&gt;&lt;/span&gt;if (xlsxFile.Exists) &amp;nbsp;&amp;nbsp;{ ...&lt;span style="white-space: pre;"&gt;
&lt;/span&gt;}&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;span style="white-space: pre;"&gt;&lt;/span&gt;using (ExcelPackage package = new ExcelPackage(xlsxFile)) &amp;nbsp;{ ...&amp;nbsp;}&lt;/p&gt;
&lt;p&gt;&lt;span style="white-space: pre;"&gt;&lt;/span&gt;}&amp;nbsp;&amp;nbsp; &amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;span style="white-space: pre;"&gt;&lt;/span&gt;}&lt;/p&gt;
&lt;p&gt;}&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;The statement&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;span style="white-space: pre;"&gt;&lt;/span&gt;using (ExcelPackage package = new ExcelPackage(xlsxFile)) &amp;nbsp;&lt;/p&gt;
&lt;p&gt;is causing the program to take an awfully long time to load, has anyone experienced similar issue before?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks,&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Andrew&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="30/01/2011 18:20:31">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Creating the package should be a very fast operation. The sheet data is not loaded until you access the worksheets collection the first time.&lt;/p&gt;
&lt;p&gt;I have no real good advice to you, but check that the file is'nt locked or that you aren't out of memory&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Add an array of values">
      <Posts>
        <Post From="AlexF1980" When="18/01/2011 12:04:51">
          <Html>
        
&lt;p&gt;Hi All, I am having difficulty understanding how to add an array of values to an existing template file.&lt;/p&gt;
&lt;p&gt;I have downloaded the EPPlusSamples solution but couldn't see an example of how to do this.&lt;/p&gt;
&lt;p&gt;Is it even possible?&lt;/p&gt;
&lt;p&gt;Below is what I've got so far, that doesn't work:&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;interal &lt;span style="color: blue;"&gt;static&lt;/span&gt; &lt;span style="color: blue;"&gt;void&lt;/span&gt; WriteToExcel(FileInfo template, DirectoryInfo outputDir, &lt;span style="color: blue;"&gt;object&lt;/span&gt;[] header, Array arr3)
{
&lt;span style="color: blue;"&gt;using&lt;/span&gt; (&lt;span style="color: blue;"&gt;var&lt;/span&gt; p = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(template))
{
&lt;span style="color: blue;"&gt;var&lt;/span&gt; ws = p.Workbook.Worksheets[&lt;span style="color: rgb(163, 21, 21);"&gt;"BoM"&lt;/span&gt;];
ExcelRange range = ws.Cells[0,0,arr3.GetLength(0), header.Length];
range.Value = &lt;span style="color: blue;"&gt;new&lt;/span&gt; &lt;span style="color: blue;"&gt;object&lt;/span&gt;[] {arr3};
}
}
&lt;/pre&gt;
&lt;/div&gt;
Can anyone offer assistance?
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="akronite" When="18/01/2011 15:16:39">
          <Html>
        
&lt;div&gt;&lt;span&gt;
&lt;blockquote type="cite"&gt;
&lt;div&gt;
&lt;div&gt;Hi Alex,&lt;/div&gt;
&lt;div&gt;Check out my work in progress extension method. &lt;/div&gt;
&lt;div&gt;The grey out text are what's being develop.&lt;/div&gt;
&lt;div&gt;As for the rest they are in the latest release and are ready to try out.&lt;/div&gt;
&lt;div&gt;Let me know if it is any help.&lt;/div&gt;
&lt;/div&gt;
&lt;/blockquote&gt;
&lt;blockquote type="cite"&gt;
&lt;div&gt;
&lt;div&gt;&lt;a href="http://epplus.codeplex.com/wikipage?title=ExtensionMethods" rel="nofollow"&gt;&lt;/a&gt;&lt;a href="http://epplus.codeplex.com/wikipage?title=ExtensionMethods" rel="nofollow"&gt;http://epplus.codeplex.com/wikipage?title=ExtensionMethods&lt;/a&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/blockquote&gt;
&lt;/span&gt;&lt;br&gt;
&lt;div&gt;Kind regards,&lt;/div&gt;
&lt;div&gt;&lt;br&gt;
&lt;/div&gt;
&lt;div&gt;Michael Tran&lt;/div&gt;
&lt;div&gt;about.me/MichaelTran&lt;/div&gt;
&lt;/div&gt;
&lt;div&gt;&lt;br&gt;
On 18/01/2011, at 8:05 PM, AlexF1980 &amp;lt;&lt;a href="mailto:notifications@codeplex.com" rel="nofollow"&gt;notifications@codeplex.com&lt;/a&gt;&amp;gt; wrote:&lt;br&gt;
&lt;br&gt;
&lt;/div&gt;
&lt;div&gt;&lt;/div&gt;
&lt;blockquote type="cite"&gt;
&lt;div&gt;
&lt;p&gt;From: AlexF1980&lt;/p&gt;
&lt;div id="ThreadNotificationPostBody"&gt;
&lt;p&gt;Hi All, I am having difficulty understanding how to add an array of values to an existing template file.&lt;/p&gt;
&lt;p&gt;I have downloaded the EPPlusSamples solution but couldn't see an example of how to do this.&lt;/p&gt;
&lt;p&gt;Is it even possible?&lt;/p&gt;
&lt;p&gt;Below is what I've got so far, that doesn't work:&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;interal &lt;span style="color: blue;"&gt;static&lt;/span&gt; &lt;span style="color: blue;"&gt;void&lt;/span&gt; WriteToExcel(FileInfo template, DirectoryInfo outputDir, &lt;span style="color: blue;"&gt;object&lt;/span&gt;[] header, Array arr3)
{
&lt;span style="color: blue;"&gt;using&lt;/span&gt; (&lt;span style="color: blue;"&gt;var&lt;/span&gt; p = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(template))
{
&lt;span style="color: blue;"&gt;var&lt;/span&gt; ws = p.Workbook.Worksheets[&lt;span style="color: rgb(163, 21, 21);"&gt;"BoM"&lt;/span&gt;];
ExcelRange range = ws.Cells[0,0,arr3.GetLength(0), header.Length];
range.Value = &lt;span style="color: blue;"&gt;new&lt;/span&gt; &lt;span style="color: blue;"&gt;object&lt;/span&gt;[] {arr3};
}
}
&lt;/pre&gt;
&lt;/div&gt;
Can anyone offer assistance?
&lt;p&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/blockquote&gt;

        
    </Html>
        </Post>
        <Post From="AlexF1980" When="18/01/2011 16:52:47">
          <Html>
        
&lt;p&gt;Thanks Michael, that does go some way to help out.&lt;/p&gt;
&lt;p&gt;I'm a bit puzzled though with the output I now see in my Excel file:&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="http://bit.ly/hz43ln"&gt;&lt;/p&gt;
&lt;p&gt;I guess I need to pass in the values stored in my Array rather than just the Array itself (as I'm doing now):&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;    &lt;span style="color: blue;"&gt;internal&lt;/span&gt; &lt;span style="color: blue;"&gt;static&lt;/span&gt; &lt;span style="color: blue;"&gt;void&lt;/span&gt; WriteToExcel(FileInfo template, DirectoryInfo outputDir, &lt;span style="color: blue;"&gt;object&lt;/span&gt;[] header, Array arr3)
    {
        &lt;span style="color: green;"&gt;// for debugging only we make a new file:&lt;/span&gt;
        FileInfo newFile = &lt;span style="color: blue;"&gt;new&lt;/span&gt; FileInfo(outputDir.FullName + &lt;span style="color: rgb(163, 21, 21);"&gt;@"\test1.xlsx"&lt;/span&gt;);
        &lt;span style="color: blue;"&gt;if&lt;/span&gt; (FileInfo.Exists)
        {
            newFile.Delete();
            newFile = &lt;span style="color: blue;"&gt;new&lt;/span&gt; FileInfo(outputDir.FullName + &lt;span style="color: rgb(163, 21, 21);"&gt;@"\test1.xlsx"&lt;/span&gt;);
        }
        &lt;span style="color: blue;"&gt;using&lt;/span&gt; (&lt;span style="color: blue;"&gt;var&lt;/span&gt; p = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(newFile))
        {
            &lt;span style="color: blue;"&gt;var&lt;/span&gt; ws = p.Workbook.Worksheets.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"Test1"&lt;/span&gt;);
            ExcelRange range = ws.Cells[0, 0, arr3.GetLength(0), header.Length];
            range.SetValue(&lt;span style="color: blue;"&gt;new&lt;/span&gt; &lt;span style="color: blue;"&gt;object&lt;/span&gt;[] { arr3 });
            p.Save();
        }
    }
&lt;/pre&gt;
&lt;/div&gt;
Thoughts?
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="18/01/2011 19:39:10">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;All non value types will be converted to strings (calling the ToString-method). Same&amp;nbsp;thing with&amp;nbsp;arrays in this release. In the future the Value property&amp;nbsp;should rewritten to handle arrays&amp;nbsp;the&amp;nbsp;same way VBA does.&lt;/p&gt;
&lt;p&gt;For now, set the values for each value in the array.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="AlexF1980" When="25/01/2011 12:31:15">
          <Html>
        
&lt;blockquote style="margin: 0.25em 1em 0px; padding: 0px 0.25em; border: 0.1em solid rgb(204, 204, 204); border-image: none; font-style: italic;"&gt;
&lt;strong&gt;jankallman wrote:&lt;/strong&gt;&lt;br&gt;
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;All non value types will be converted to strings (calling the ToString-method). Same&amp;nbsp;thing with&amp;nbsp;arrays in this release. In the future the Value property&amp;nbsp;should rewritten to handle arrays&amp;nbsp;the&amp;nbsp;same way VBA does.&lt;/p&gt;
&lt;p&gt;For now, set the values for each value in the array.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Hi Jan,&lt;/p&gt;
&lt;p&gt;I'm a bit puzzled as to what you mean by: "Set the values for each value in the array"? Can you elaborate on this?&lt;/p&gt;
&lt;p&gt;Thanks,&lt;/p&gt;
&lt;p&gt;Alex.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="30/01/2011 18:11:00">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Iterate the array in a for-loop and set&amp;nbsp;the values per cell.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Date Formatting (No Time)">
      <Posts>
        <Post From="dihaws" When="27/01/2011 03:30:37">
          <Html>
        
&lt;p&gt;I want a date without a time, just like you can manually format a cell in Excell.&lt;/p&gt;
&lt;p&gt;I have read the FAQ about styles.&lt;/p&gt;
&lt;p&gt;If I pass in a DateTime value, I always get a date and time in the completed spread sheet.&lt;/p&gt;
&lt;p&gt;If I put it into a string in the format I want, it still adds the 12:00:00 AM time element.&lt;/p&gt;
&lt;p&gt;Here are&amp;nbsp;two of the various combinations that I have tried:&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Consolas; font-size: x-small;"&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;DateTime&amp;nbsp;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;mydate = (&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Consolas; font-size: x-small;"&gt;DateTime)datagridview[col,
 row].Value;&lt;br&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;worksheet.Cells[row + 2, col + 1].Style.Numberformat.Format =
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(163, 21, 21); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(163, 21, 21); font-family: Consolas; font-size: x-small;"&gt;"mm/dd/yy"&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;;&lt;br&gt;
&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;worksheet.Cells[row + 2, col + 1].Value = mydate;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;And&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;﻿&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;string
 mydate = string.Format("{0:MM/dd/yy}"), datagridview[col, row].value);&lt;br&gt;
&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;worksheet.Cells[row + 2, col + 1].Value = mydate;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&amp;nbsp;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;If my DateTime value is 1/26/2011 2:31:25 PM and I test my string and it is "1/26/11" I still get 1/26/2011 12:00:00 AM in the cell.&amp;nbsp; If I use the DateTime method, I get the same thing that was in the source grid.&lt;/p&gt;
&lt;p&gt;I would appreciate any ideas.&lt;/p&gt;
&lt;p&gt;Don&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="akronite" When="28/01/2011 00:12:03">
          <Html>
        
&lt;p&gt;Hi Dihaws,&lt;/p&gt;
&lt;p&gt;Firstly, welcome to CodePlex.&lt;/p&gt;
&lt;p&gt;Second, thank you for choosing EPPlus and posting your questions with us.&lt;/p&gt;
&lt;p&gt;In hope to answer your question, please refer to this previous discussion.&lt;/p&gt;
&lt;p&gt;&lt;a href="http://epplus.codeplex.com/Thread/View.aspx?ThreadId=241270" rel="nofollow"&gt;http://epplus.codeplex.com/Thread/View.aspx?ThreadId=241270&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Let me know if it is helpful.&lt;/p&gt;
&lt;p&gt;&lt;a href="http://www.about.me/MichaelTran" rel="nofollow"&gt;MichaelTran&lt;/a&gt;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Locked file">
      <Posts>
        <Post From="ewinstanley" When="26/11/2010 01:03:52">
          <Html>
        
&lt;p&gt;I am having a problem with EPPlus not releasing it's lock on my file.&amp;nbsp; I am not sure how to force it to close, any suggestions?&lt;/p&gt;
&lt;p style="padding-left: 30px;"&gt;&lt;span style="color: blue;"&gt;var&lt;/span&gt; newFile&amp;nbsp;=&amp;nbsp;&lt;span style="color: blue;"&gt;new&lt;/span&gt;&amp;nbsp;&lt;span style="color: rgb(43, 145, 175);"&gt;FileInfo&lt;/span&gt;(&lt;span style="color: rgb(163, 21, 21);"&gt;@".\temp.xlsx"&lt;/span&gt;);&lt;span style="color: blue;"&gt;&lt;br&gt;
var&lt;/span&gt;&amp;nbsp;package&amp;nbsp;=&amp;nbsp;&lt;span style="color: blue;"&gt;new&lt;/span&gt;&amp;nbsp;&lt;span style="color: rgb(43, 145, 175);"&gt;ExcelPackage&lt;/span&gt;(newFile);&lt;span style="color: green;"&gt;&lt;br&gt;
//&amp;nbsp;Do&amp;nbsp;some&amp;nbsp;work&lt;/span&gt;&lt;br&gt;
&lt;span style="color: green;"&gt;// Several attempts to force the file to close&lt;/span&gt;&lt;br&gt;
package.Save();&lt;br&gt;
package.Stream.Close();&lt;br&gt;
package.Dispose();&lt;br&gt;
&lt;span style="color: blue;"&gt;string&lt;/span&gt;&amp;nbsp;path&amp;nbsp;=&amp;nbsp;newFile.FullName;&lt;br&gt;
newFile&amp;nbsp;=&amp;nbsp;&lt;span style="color: blue;"&gt;null&lt;/span&gt;;&lt;br&gt;
package&amp;nbsp;=&amp;nbsp;&lt;span style="color: blue;"&gt;null&lt;/span&gt;;&lt;span style="color: blue;"&gt;&lt;br&gt;
var&lt;/span&gt;&amp;nbsp;fileToDelete =&amp;nbsp;&lt;span style="color: blue;"&gt;new&lt;/span&gt;&amp;nbsp;&lt;span style="color: rgb(43, 145, 175);"&gt;FileInfo&lt;/span&gt;(path);&lt;br&gt;
fileToDelete.Delete(); &lt;span style="color: green;"&gt;// Cannot access due to another process locking the file&lt;br&gt;
&lt;/span&gt;&lt;/p&gt;
&lt;p style="padding-left: 30px;"&gt;&lt;br&gt;
&lt;br&gt;
&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="28/11/2010 19:07:24">
          <Html>
        
&lt;p&gt;I tried your code and the delete works fine.&lt;/p&gt;
&lt;p&gt;Are you sure you don't have it open in Excel or from some where else?&lt;/p&gt;
&lt;p&gt;If not, supply a full sample that fails so I can reproduce the error.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="DanRiches" When="25/01/2011 16:07:51">
          <Html>
        
&lt;p&gt;I'm experiencing this issue myself. I've tried many ways of trying to kill off the object and failed. I'm using V2.8.0.1, .Net 4&amp;nbsp;C# with no other&amp;nbsp;libraries other than the .Net ones.&lt;/p&gt;
&lt;p&gt;I first open my&amp;nbsp;"InquirySheet.xlsm", change the values in certain cells and then fire a SaveAs using a different filename.&lt;/p&gt;
&lt;p&gt;This all works perfectly until, I decided to run the process again with out closing the application down despite using this:
&lt;span style="color: rgb(0, 128, 0);"&gt;"using (ExcelPackage pck = new ExcelPackage(FInfo))"
&lt;/span&gt;wrapped around my code to change the values then finally save as. When I re run this I get
&lt;span style="color: rgb(0, 128, 0);"&gt;"The process cannot access the file 'C:\Dev\MarelConfigurator\Configurator\Configurator\ProductFiles\InquirySheet.xlsm' because it is being used by another process."&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(0, 0, 0);"&gt;The only way I can reopen this file is to close the application fully and then re open it. It's nothing to do with the classic Visual Studio keeping locks on files either, I've checked this as a deployed package on a&amp;nbsp;clean
 Windows XP SP3 machine and the same exception occurs.&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(0, 0, 0);"&gt;Please can someone point me in the right direction? Otherwise it's back to the old Office PIA's and they're nasty, really nasty. Other than that everything else is great and works as it says on the tin!&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(0, 0, 0);"&gt;Kind Regards, Dan R&lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="DanRiches" When="26/01/2011 14:28:48">
          <Html>
        
&lt;p&gt;Ok, I tried all sorts on this but managed to fix it in the end.&lt;/p&gt;
&lt;p&gt;Basically I created another thread from my form and passed it my template parameters. Whilst this was running I just looped until the thread terminates of it's own accord (ie finished) and that works perfectly. The file is no longer locked!!! :)&lt;/p&gt;
&lt;p&gt;I would like to add that this library is absolutely brilliant and has meant my app is 1.5Mb in size, no crappy PIA's or Com objects etc!!!&lt;/p&gt;
&lt;p&gt;Many Thanks,&lt;/p&gt;
&lt;p&gt;Dan R&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="error reading .xslm files">
      <Posts>
        <Post From="klvnnsrikanth" When="17/01/2011 14:42:15">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I have some .xslm files which have visible, hidden, very hidden sheets in them.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I don't care about very hidden sheets and my program can just ignore them. But I should be able to read the visible sheets, but EPPlus just does not work.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Is there a way to read these kind of files?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;
&lt;p&gt;Srikanth Kambhampati&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="17/01/2011 21:13:23">
          <Html>
        
&lt;p&gt;This is a bug, I'll add a fix for it.&lt;/p&gt;
&lt;p&gt;If you need a fix now,try this to replace the Hidden-Get ...&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;get&lt;/span&gt; 
{
  XmlElement sheetNode = xlPackage.Workbook.WorkbookXml.SelectSingleNode(&lt;span style="color: blue;"&gt;string&lt;/span&gt;.Format(&lt;span style="color: rgb(163, 21, 21);"&gt;"//d:sheet[@sheetId={0}]"&lt;/span&gt;, _sheetID), NameSpaceManager) &lt;span style="color: blue;"&gt;as&lt;/span&gt; XmlElement;
  &lt;span style="color: blue;"&gt;if&lt;/span&gt; (sheetNode != &lt;span style="color: blue;"&gt;null&lt;/span&gt;)
  {
     &lt;span style="color: blue;"&gt;string&lt;/span&gt; state=sheetNode.GetAttribute(&lt;span style="color: rgb(163, 21, 21);"&gt;"state"&lt;/span&gt;);
     &lt;span style="color: blue;"&gt;if&lt;/span&gt; (state == &lt;span style="color: rgb(163, 21, 21);"&gt;"hidden"&lt;/span&gt;)
     {
       &lt;span style="color: blue;"&gt;return&lt;/span&gt; eWorkSheetHidden.Hidden;
     }
     &lt;span style="color: blue;"&gt;else&lt;/span&gt; &lt;span style="color: blue;"&gt;if&lt;/span&gt; (state == &lt;span style="color: rgb(163, 21, 21);"&gt;"veryHidden"&lt;/span&gt;)
     {
       &lt;span style="color: blue;"&gt;return&lt;/span&gt; eWorkSheetHidden.VeryHidden;
     }
   }
   &lt;span style="color: blue;"&gt;return&lt;/span&gt; eWorkSheetHidden.Visible;
}

&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="klvnnsrikanth" When="21/01/2011 17:22:23">
          <Html>
        
&lt;p&gt;Hi Jan,&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I tried to add this code and it actually worked reading the sheets.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;But there was another issue with the &lt;strong&gt;relId&lt;/strong&gt; because the very hidden sheets have this value set to empty string and EPPlus breaks at other points.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Can you look into that issue, and fix it?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;
&lt;p&gt;Srikanth Kambhampati&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Workbook define a name without named range">
      <Posts>
        <Post From="Mackindel01" When="20/01/2011 16:42:35">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I am trying to add a name like this &amp;nbsp;:&lt;/p&gt;
&lt;p&gt;Workbook.Names.Add("UserPrice", "112,5");&lt;/p&gt;
&lt;p&gt;But this feature doesn't seem to exist, &amp;nbsp;is there another way ?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="20/01/2011 19:18:07">
          <Html>
        
&lt;p&gt;No, names only work on ranges at the moment. We still have some work to do on defined names, but I hope we can fix this until the next version.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="BestFit Column widths.">
      <Posts>
        <Post From="benbun" When="20/01/2011 08:54:41">
          <Html>
        
&lt;p&gt;I am creating a worksheet that has a column with some wide strings in it. I would like the column width tp be set so that all of the data within the column is shown.&amp;nbsp;(i.e. The same as double clicking on the column separator within Excel ).&lt;/p&gt;
&lt;p&gt;I assumed that I could use code like :&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;worksheet.Column(1).BestFit = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;but this does not seem to work, the column is not resized.&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I tried adding this code before I populate the worksheet, and then again afterwards - but neither seem to work.&lt;/p&gt;
&lt;p&gt;Can anyone point out where I am going wrong.&lt;/p&gt;
&lt;p&gt;thanks&lt;/p&gt;
&lt;p&gt;Richard&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="20/01/2011 19:14:59">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;The bestfit property don't autosize the column (when set to true, it expands the width of&amp;nbsp;the column when a user writes in a cell).&lt;/p&gt;
&lt;p&gt;There is no autosize of columns in the library at the moment, but this thread might be helpful...&lt;/p&gt;
&lt;p&gt;&lt;a title="http://epplus.codeplex.com/Thread/View.aspx?ThreadId=218294" href="http://epplus.codeplex.com/Thread/View.aspx?ThreadId=218294" rel="nofollow"&gt;﻿﻿﻿http://epplus.codeplex.com/Thread/View.aspx?ThreadId=218294&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Copy Style">
      <Posts>
        <Post From="harabulan" When="11/01/2011 15:25:09">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Is there any way to copy row/cell style from template excel to new row/cell ?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;best regards,&lt;/p&gt;
&lt;p&gt;Harun#?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="11/01/2011 17:49:03">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Set the StyleID property from the cells you want to copy from.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="harabulan" When="17/01/2011 21:12:36">
          <Html>
        
&lt;p&gt;Hi again,&lt;/p&gt;
&lt;p&gt;&amp;nbsp; Thanks. When I first tried to set StyleID property I was forget to create styles in new Workbook and got an exception ofcourse.&lt;/p&gt;
&lt;p&gt;I just look for how to copy styles from template workbook to new workbook I have found something just want to ask you is that correct way to do it.&lt;/p&gt;
&lt;p&gt;I'm just copying Workbook.StylesXml.InnerXml to newly created workbook and than setting StyleID of cells from Template to new cells.&lt;/p&gt;
&lt;p&gt;regards,&lt;/p&gt;
&lt;p&gt;Harun#?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="19/01/2011 07:35:12">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;You can use the Workbook.Styles.UpdateXml() method to update the Styles Xml before you copy.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Create Hyperlink to local directory path">
      <Posts>
        <Post From="newnauk" When="17/01/2011 20:56:35">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I'm new to programming c# with Excel and this is my first time learning how to use EPPlus. &amp;nbsp;I want to add a hyper link to a cell that points to a local file (i.e. "C:\temp\text1.txt") can someone show me an example?&lt;/p&gt;
&lt;p&gt;I've tried the followings:&lt;/p&gt;
&lt;p&gt;*************&lt;/p&gt;
&lt;p&gt;var uri = new Uri(filepath);&lt;/p&gt;
&lt;p&gt;worksheet.Cells[i. j].Hyperlink = new ExcelHyperLink(uri.AbsoluteUri);&lt;/p&gt;
&lt;p&gt;And it returns a failure when I try to save the worksheet, with message saying "Error saving file C:\temp\temp.xlsx". &amp;nbsp;It appears there is a null reference in the inner exception.&lt;/p&gt;
&lt;p&gt;*************&lt;/p&gt;
&lt;p&gt;To solve the problem of saving the file the only work around is if I do&lt;/p&gt;
&lt;p&gt;worksheet.Cells[i. j].Hyperlink = new ExcelHyperLink(uri.AbsoluteUri, "text1.txt");&amp;nbsp;&lt;/p&gt;
&lt;p&gt;which uses reference address instead of URI (I don't know what the difference is).&lt;/p&gt;
&lt;p&gt;But when you open the worksheet and go to "Edit Hyperlink" it shows that it is referencing to a cell and not to an existing file or web page.&amp;nbsp;&lt;/p&gt;
&lt;p&gt;*************&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks,&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="17/01/2011 21:20:55">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;The ExcelHyperlink&amp;nbsp;class is for internal hyperlinks (reference an worksheet cell).&lt;/p&gt;
&lt;p&gt;use worksheet.Cells[i. j].Hyperlink = new Uri(filepath); for an external link&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="newnauk" When="17/01/2011 21:32:38">
          <Html>
        
&lt;p&gt;Thanks I appreciate the help, that solve the link problem! &amp;nbsp;&lt;/p&gt;
&lt;p&gt;But just out of curiosity, if ExcelHyperLink is meant for internal reference to another worksheet cell why does it contain the URI parameter?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="18/01/2011 19:26:17">
          <Html>
        
&lt;p&gt;For backward compatibility reason. In the first versions (and in ExcelPackage)&amp;nbsp;the Hyperlink property was just an URI, and did not support interal links in an easy way. That's the main reason the ExcelHyperlink had to&amp;nbsp;inherit the URI class.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to Verify if a Worksheet already exists?">
      <Posts>
        <Post From="jrgalang" When="10/01/2011 02:30:47">
          <Html>
        
&lt;p&gt;Currently I'm using the following validation:&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;if&lt;/span&gt; (updatePopulationPackage.Workbook.Worksheets.Count != 9)
                {
                    ExcelWorksheet saveSheet = updatePopulationPackage.Workbook.Worksheets.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"Export Certification Report"&lt;/span&gt;);
}
&lt;br&gt;&lt;div style="color: black; background-color: white;"&gt;&lt;pre&gt;&lt;span style="color: blue;"&gt;else&lt;/span&gt;
                {
                    &lt;span style="color: green;"&gt;//Use existing file and update its list&lt;/span&gt;
                    ExcelWorksheet saveSheet = updatePopulationPackage.Workbook.Worksheets[&lt;span style="color: rgb(163, 21, 21);"&gt;"Export Certification Report"&lt;/span&gt;];
&lt;/pre&gt;
&lt;/div&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;I'd like to replace my if condition from the current .Count-dependent code to something like:&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;updatePopulationPackage.Workbook.Worksheets["the worksheet name is here"].Exists == false&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;However this does not work. I've ran a search and found the following:&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: green;"&gt;// get worksheet&lt;/span&gt;
&lt;span style="color: blue;"&gt;var&lt;/span&gt; sheet = package.Workbook.Worksheets[&lt;span style="color: rgb(163, 21, 21);"&gt;"Sheet1"&lt;/span&gt;];

&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;I tried implementing this such that:&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;var&lt;/span&gt; sheet = package.Workbook.Worksheets[&lt;span style="color: rgb(163, 21, 21);"&gt;"Sheet1"&lt;/span&gt;];
&lt;span style="color: blue;"&gt;if&lt;/span&gt; (sheet.ToString != &amp;lt;condition here&amp;gt;)
{
&lt;span style="color: green;"&gt;//insert code here to create new worksheet&lt;/span&gt;
}
&lt;span style="color: blue;"&gt;else&lt;/span&gt;
{
&lt;span style="color: green;"&gt;//insert code here to update existing worksheet&lt;/span&gt;
}
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;But run-time fails. Is there any way I could check if a specific worksheet already exists in the file? Thanks!&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="10/01/2011 18:30:33">
          <Html>
        
&lt;p&gt;Try this...&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;var&lt;/span&gt; sheet=package.Workbook.Worksheets[&lt;span style="color: rgb(163, 21, 21);"&gt;"Sheet1"&lt;/span&gt;];
&lt;span style="color: blue;"&gt;if&lt;/span&gt;(sheet==&lt;span style="color: blue;"&gt;null&lt;/span&gt;)
{
  &lt;span style="color: green;"&gt;//Add a new sheet...&lt;/span&gt;
  sheet=package.Workbook.Worksheets.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"Sheet1"&lt;/span&gt;);
}

&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="klvnnsrikanth" When="11/01/2011 18:38:15">
          <Html>
        
&lt;p&gt;using package.Workbook.WorkSheets["nameofthesheet"] is giving me an argument null exception&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;What can be the reason for it?&lt;/p&gt;
&lt;p&gt;Description says:&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;'package.Workbook.Worksheets' threw an exception of type 'System.ArgumentNullException'&lt;span&gt;
&lt;/span&gt;OfficeOpenXml.ExcelWorksheet {System.ArgumentNullException}&lt;/p&gt;
&lt;p&gt;Let me know how to fix this?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;
&lt;p&gt;Srikanth Kambhampati&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="11/01/2011 21:28:12">
          <Html>
        
&lt;p&gt;I'm not sure what you are doing, but If the worksheet don't exist the indexer will return null.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jrgalang" When="11/01/2011 22:49:21">
          <Html>
        
&lt;blockquote style="margin: 0.25em 1em 0px; padding: 0px 0.25em; border: 0.1em solid rgb(204, 204, 204); border-image: none; font-style: italic;"&gt;
&lt;strong&gt;jankallman wrote:&lt;/strong&gt;&lt;br&gt;
&lt;p&gt;Try this...&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;var&lt;/span&gt; sheet=package.Workbook.Worksheets[&lt;span style="color: rgb(163, 21, 21);"&gt;"Sheet1"&lt;/span&gt;];
&lt;span style="color: blue;"&gt;if&lt;/span&gt;(sheet==&lt;span style="color: blue;"&gt;null&lt;/span&gt;)
{
  &lt;span style="color: green;"&gt;//Add a new sheet...&lt;/span&gt;
  sheet=package.Workbook.Worksheets.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"Sheet1"&lt;/span&gt;);
}

&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Jan&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&amp;nbsp;Thanks Jan, verified working and pretty helpful. Cheers!&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="klvnnsrikanth" When="14/01/2011 00:50:39">
          <Html>
        
&lt;p&gt;Jan&lt;/p&gt;
&lt;p&gt;The problem was I tried to open a sheet that was sent by email directly, then it would give me this error.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I tried opening and saving it and then executing the program and that worked. Not sure what the problem was.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;
&lt;p&gt;Srikanth Kambhampati&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Is there a way to clear all the cell values in the sheet?">
      <Posts>
        <Post From="klvnnsrikanth" When="13/01/2011 22:31:21">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I want to clear all the cells before I write values to the excel sheet.&lt;/p&gt;
&lt;p&gt;Can someone help me ?&lt;/p&gt;
&lt;p&gt;I tried&amp;nbsp;&lt;/p&gt;
&lt;p&gt;workSheet.Cells[workSheet.Dimension.Start.Row, workSheet.Dimension.End.Column].Clear();&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;But that did not help. :(&lt;/p&gt;
&lt;p&gt;If someone has a better idea, please let me know&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;
&lt;p&gt;Srikanth Kambhampati&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="klvnnsrikanth" When="13/01/2011 22:42:34">
          <Html>
        
&lt;p&gt;Got that with some help from documentation&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;workSheet.Cells[workSheet.Dimension.Start.Row, workSheet.Dimension.Start.Column, workSheet.Dimension.End.Row, workSheet.Dimension.End.Column].Clear();&amp;nbsp;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Wonderful library...&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;
&lt;p&gt;Srikanth Kambhampati&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Dates according to locale format">
      <Posts>
        <Post From="zone51" When="11/01/2011 10:47:53">
          <Html>
        
&lt;p&gt;Hey.&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I'm having problem figuring out how to set the cell date to be displayed according to user locale&amp;nbsp;.&lt;br&gt;
I&amp;nbsp;set&amp;nbsp;the cell value to a DateTime,&amp;nbsp;&amp;nbsp;and uses format to display it as date.&lt;/p&gt;
&lt;div&gt;&lt;span style="font-family: Consolas;"&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Consolas;"&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Consolas;"&gt;DateTime&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas;"&gt; dt =
&lt;/span&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Consolas;"&gt;&lt;span style="color: rgb(43, 145, 175); font-family: Consolas;"&gt;DateTime&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas;"&gt;.Now;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas;"&gt;&lt;span style="font-family: Consolas;"&gt;&amp;nbsp;&lt;br&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas;"&gt;currWS.Cells[1, 1].Value = dt;&lt;br&gt;
currWS.Cells[1, 1].Style.Numberformat.Format = "dd/mm/yyyy hh:mm";&lt;/span&gt;&lt;/div&gt;
&lt;p&gt;When I&amp;nbsp;open&amp;nbsp;the file in Excel&amp;nbsp;it shows a&amp;nbsp;date in the above format: "29/11/2010 12:49"&lt;br&gt;
My current locale is English (United Kingdom)&lt;br&gt;
When I change the locale to English (United States) it styays the same.&lt;br&gt;
I would like it to change to "11/29/2010 12:49"&lt;br&gt;
&lt;br&gt;
I tried to put * but it doesn't work.&lt;br&gt;
How do I set the format to take locale format?&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="11/01/2011 17:45:24">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Read the section in the FAQ about numberformats...&lt;/p&gt;
&lt;p&gt;Numberformats:&lt;br&gt;
Use culture independent number formats: dot (.) for decimal, comma (thousand). &lt;br&gt;
The easiest way to check a format or a formula is to create an Excel file --&amp;gt; Do the formatting / Add the formulas --&amp;gt; Save it as XLSX ---&amp;gt; Rename the file *.zip. Extract the file and have a look at the number formats in the \xl\styles.xml file and
 formulas in \xl\worksheets\sheet#.xml.&lt;br&gt;
&lt;br&gt;
Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="zone51" When="11/01/2011 19:33:10">
          <Html>
        
&lt;p&gt;Hi Jan,&lt;br&gt;
&lt;br&gt;
Did what you suggested with the Excel file.&lt;br&gt;
The only thing that is related to the cell date value is in the styles.xml&lt;br&gt;
&lt;br&gt;
&lt;strong&gt;&lt;span style="font-size: x-small;"&gt;&lt;strong&gt;&lt;span style="font-size: x-small;"&gt;&lt;span lang="HE"&gt;numFmtId="22"&lt;/span&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;span style="font-size: x-small;"&gt;&lt;strong&gt;&lt;span style="font-size: x-small;"&gt;&lt;span lang="HE"&gt;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Is there a way to set the formatId to 22, I ask this because I see this property is readonly in
&lt;span id="nsrTitle"&gt;Style.Numberformat.NumFmtID &lt;br&gt;
&lt;br&gt;
Thanks&lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="11/01/2011 21:16:05">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;aha, you picked one of the build in formats. To set the&amp;nbsp;format use the following table...&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;        &lt;span style="color: gray;"&gt;///&lt;/span&gt; &lt;span style="color: gray;"&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt;&lt;span style="color: green;"&gt; Id for number format&lt;/span&gt;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt;&lt;span style="color: green;"&gt; &lt;/span&gt;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt;&lt;span style="color: green;"&gt; Build in ID's&lt;/span&gt;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt;&lt;span style="color: green;"&gt; &lt;/span&gt;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt;&lt;span style="color: green;"&gt; 0   General &lt;/span&gt;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt;&lt;span style="color: green;"&gt; 1   0 &lt;/span&gt;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt;&lt;span style="color: green;"&gt; 2   0.00 &lt;/span&gt;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt;&lt;span style="color: green;"&gt; 3   #,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt; &lt;/span&gt;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt;&lt;span style="color: green;"&gt; 4   #,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00 &lt;/span&gt;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt;&lt;span style="color: green;"&gt; 9   0% &lt;/span&gt;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt;&lt;span style="color: green;"&gt; 10  0.00% &lt;/span&gt;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt;&lt;span style="color: green;"&gt; 11  0.00E+00 &lt;/span&gt;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt;&lt;span style="color: green;"&gt; 12  # ?/? &lt;/span&gt;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt;&lt;span style="color: green;"&gt; 13  # ??/?? &lt;/span&gt;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt;&lt;span style="color: green;"&gt; 14  mm-dd-yy &lt;/span&gt;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt;&lt;span style="color: green;"&gt; 15  d-mmm-yy &lt;/span&gt;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt;&lt;span style="color: green;"&gt; 16  d-mmm &lt;/span&gt;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt;&lt;span style="color: green;"&gt; 17  mmm-yy &lt;/span&gt;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt;&lt;span style="color: green;"&gt; 18  h:mm AM/PM &lt;/span&gt;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt;&lt;span style="color: green;"&gt; 19  h:mm:ss AM/PM &lt;/span&gt;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt;&lt;span style="color: green;"&gt; 20  h:mm &lt;/span&gt;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt;&lt;span style="color: green;"&gt; 21  h:mm:ss &lt;/span&gt;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt;&lt;span style="color: green;"&gt; 22  m/d/yy h:mm &lt;/span&gt;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt;&lt;span style="color: green;"&gt; 37  #,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt; ;(#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;) &lt;/span&gt;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt;&lt;span style="color: green;"&gt; 38  #,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt; ;[Red](#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;) &lt;/span&gt;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt;&lt;span style="color: green;"&gt; 39  #,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00;(#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00) &lt;/span&gt;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt;&lt;span style="color: green;"&gt; 40  #,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00;[Red](#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00) &lt;/span&gt;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt;&lt;span style="color: green;"&gt; 45  mm:ss &lt;/span&gt;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt;&lt;span style="color: green;"&gt; 46  [h]:mm:ss &lt;/span&gt;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt;&lt;span style="color: green;"&gt; 47  mmss.0 &lt;/span&gt;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt;&lt;span style="color: green;"&gt; 48  #&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.0E+0 &lt;/span&gt;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt;&lt;span style="color: green;"&gt; 49  @&lt;/span&gt;
        &lt;span style="color: gray;"&gt;///&lt;/span&gt; &lt;span style="color: gray;"&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;&lt;span style="color: green;"&gt;            &lt;/span&gt;

&lt;/pre&gt;
&lt;/div&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;In&amp;nbsp;this case set the format to m/d/yy h:mm&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="zone51" When="11/01/2011 21:29:50">
          <Html>
        
&lt;p&gt;If I do it this way:&lt;br&gt;
currWS.Cells[1, 1].Style.Numberformat.Format = "m/d/yy h:mm";&lt;br&gt;
It doesn't solve my problem since this fix the date&amp;nbsp;format no matter what is the locale.&lt;br&gt;
&lt;br&gt;
Is there a way to set the Id ?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="12/01/2011 07:04:18">
          <Html>
        
&lt;p&gt;No, it's internal, use the formats in the table if you what to use them.&lt;/p&gt;
&lt;p&gt;If I try your format I get this in the style.xml ...&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;numFmt&lt;/span&gt; &lt;span style="color: red;"&gt;numFmtId&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;168&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: red;"&gt;formatCode&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;dd\/mm\/yyyy\ hh:mm&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt; &lt;span style="color: blue;"&gt;/&amp;gt;&lt;/span&gt; &lt;/pre&gt;
&lt;pre&gt;This worked for me...&lt;/pre&gt;
&lt;pre&gt;&lt;div style="color: black; background-color: white;"&gt;&lt;pre&gt;ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;].Style.Numberformat.Format=&lt;span style="color: rgb(163, 21, 21);"&gt;@"dd\/mm\/yyyy\ hh:mm"&lt;/span&gt;;
&lt;/pre&gt;
&lt;pre&gt;Jan&lt;/pre&gt;
&lt;/div&gt;
&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="zone51" When="12/01/2011 09:27:04">
          <Html>
        
&lt;p&gt;Sorry , dosen't work for me.&lt;br&gt;
It stays 12/01/2011 instead of 01/12/2011 even my locale is US&lt;br&gt;
Btw, this is&amp;nbsp;wrong for the cell display, on the upper textbox where the FX located, it is in the right format&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="zone51" When="12/01/2011 13:14:44">
          <Html>
        
&lt;p&gt;With a close help from Jan , it works with this format:&lt;br&gt;
ws.Cells["A1"].Style.Numberformat.Format = @"m/d/yy h:mm";&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="error opening package">
      <Posts>
        <Post From="trickymonk" When="11/01/2011 21:40:04">
          <Html>
        
&lt;p&gt;I receive the following error when trying to open an existing .xls file:&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp; Error: Can not open the package. Package is an OLE compound document. If this is an encrypted package, please supply the password Line: EPPlus&lt;/p&gt;
&lt;p&gt;The file is not encrypted, but does have multiple worksheets. Here is my code:&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; FileInfo xlsFile = new FileInfo(@fileString);&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; ExcelPackage excelApp = new ExcelPackage(xlsFile);&amp;nbsp; --&amp;gt; fails on this line&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I've tried using a FileStream, but that fails with the same error. What am I doing wrong?&lt;/p&gt;
&lt;p&gt;Thanks!&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="12/01/2011 07:07:58">
          <Html>
        
&lt;p&gt;Make sure you use a XLSX file as a template. XLS will not work.&lt;/p&gt;
&lt;p&gt;Also, make sure you&amp;nbsp;don't have&amp;nbsp;a digital&amp;nbsp;signature in the template.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to know the number of rows to read from the excel?">
      <Posts>
        <Post From="klvnnsrikanth" When="11/01/2011 15:43:46">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Is there a way to know how many excel rows have been modified to read from the excel? (same with the columns)?&lt;/p&gt;
&lt;p&gt;How to iterate through the rows in the excel work sheet? (same with columns)&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;
&lt;p&gt;Srikanth Kambhampati&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="11/01/2011 17:52:06">
          <Html>
        
&lt;p&gt;Hi&lt;/p&gt;
&lt;p&gt;Use the Worksheet.Dimensions property to get the First and Last cell.&lt;/p&gt;
&lt;p&gt;If you have a lot of blank cells check out the Linq sample (sample8) to get only created cells,&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Linking a cell with a worksheet?">
      <Posts>
        <Post From="ttreat31" When="04/01/2011 20:41:57">
          <Html>
        
&lt;p&gt;I did some searching on this and didn't turn up anything. What I would like to do is link a cell with a spreadsheet in the same workbook. This is easy to achieve in Interop with something like this:&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;ws.Hyperlinks.Add(ws.Cells[1, 1], &lt;span style="color: rgb(163, 21, 21);"&gt;""&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"someworksheet!A1"&lt;/span&gt;, Type.Missing, dataToDisplay);

&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;I see that ExcelRange has a Hyperlink property, but I don't see how to use it to link between worksheets. Maybe it's just something I'm overlooking?&lt;/p&gt;
&lt;p&gt;Thanks!&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="05/01/2011 07:41:57">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Look at sample 6 or on the&amp;nbsp;home page, content sheet link.&lt;/p&gt;
&lt;p&gt;Looks like this...&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt; &lt;span style="color: green;"&gt;//Add a HyperLink to the statistics sheet. &lt;/span&gt;
&lt;span style="color: blue;"&gt;var&lt;/span&gt; namedStyle = pck.Workbook.Styles.CreateNamedStyle(&lt;span style="color: rgb(163, 21, 21);"&gt;"HyperLink"&lt;/span&gt;);   &lt;span style="color: green;"&gt;//This one is language dependent&lt;/span&gt;
namedStyle.Style.Font.UnderLine = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
namedStyle.Style.Font.Color.SetColor(Color.Blue);
ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"K12"&lt;/span&gt;].Hyperlink = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelHyperLink(&lt;span style="color: rgb(163, 21, 21);"&gt;"Statistics!A1"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"Statistics"&lt;/span&gt;);
ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"K12"&lt;/span&gt;].StyleName = &lt;span style="color: rgb(163, 21, 21);"&gt;"HyperLink"&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="ttreat31" When="05/01/2011 19:14:06">
          <Html>
        
&lt;p&gt;Perfect, just what I was looking for! Thanks, and thanks again for this fantastic framework, Jan!&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Calling LoadFromDataTable gives System.OutOfMemoryException">
      <Posts>
        <Post From="bpoojary" When="03/01/2011 13:33:24">
          <Html>
        
&lt;p&gt;Hi&lt;/p&gt;
&lt;p&gt;I am using following code to export dataTable to excel.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;using (ExcelPackage pck = new ExcelPackage(newFile))&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; //Create the worksheet&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ExcelWorksheet ws = pck.Workbook.Worksheets.Add("Accounts");&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; //Load the datatable into the sheet, starting from cell A1. Print the column names on row 1&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ws.Cells["A1"].LoadFromDataTable(dataTable, true);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;pck.Save();&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&amp;nbsp;&lt;/p&gt;
&lt;div id="_mcePaste" style="left: -10000px; top: 0px; width: 1px; height: 1px; overflow: hidden;"&gt;
﻿&lt;/div&gt;
&lt;p&gt;I have around 45000 Rows and 71 Columns in the table. When it is excecuting LoadFromDataTable i get System.OutOfMemory exception.I have 4 GB Ram installed in my machine.&lt;/p&gt;
&lt;p&gt;Please help.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="03/01/2011 16:07:45">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I have loaded about 25,000,000 cells on my 8GB RAM dev machine. Then the taskmanager shows 0GB physical memory and everything starts to go really slow. Of course the memory usage depends on many things, like the what kind of data you load, how much memory
 other process use and a lot of other things as well.&lt;/p&gt;
&lt;p&gt;I suggest you you try to load the datatable manually, setting the values yourself (something like ...&amp;nbsp;ws.Cells[row,col].value). Have a look at the taskmanager. If it goes down to 0 than you are obviously out of memory. Report back how many cells you
 are able to load and the amount of memory the process takes.&lt;/p&gt;
&lt;p&gt;If you have the hardware, try it on a machine with more memory.&lt;/p&gt;
&lt;p&gt;I should try to memory optimize the ExcelCell class some time in the future.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="bpoojary" When="04/01/2011 07:20:06">
          <Html>
        
&lt;p&gt;Hi&lt;/p&gt;
&lt;p&gt;I tried to iterate through datatable as you suggested but still i am facing same problem.&lt;/p&gt;
&lt;p&gt;I tried to export 1 million records with 14 columns , I got system.outofmemory exception around 44K rows. Even after operation is completed memory is not released.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Heare is the code snippet i am using&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; using (ExcelPackage pck = new ExcelPackage(newFile))&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; //Create the worksheet&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ExcelWorksheet ws = pck.Workbook.Worksheets.Add("Accounts");&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;for (int row = 1; row &amp;lt;= exportStateData.ExportDataTable.Rows.Count; row++)&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; for (int column = 1; column &amp;lt;= exportStateData.ExportDataTable.Columns.Count; column++)&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ws.Cells[row, column].Value = exportStateData.ExportDataTable.Rows[row - 1][column - 1];&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; pck.Save();&lt;/p&gt;
&lt;p&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="04/01/2011 08:46:32">
          <Html>
        
&lt;p&gt;Just to make sure, are you using version 2.8?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="bpoojary" When="04/01/2011 11:09:28">
          <Html>
        
&lt;p&gt;Yes..I am using version 2.8.1&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="04/01/2011 12:15:24">
          <Html>
        
&lt;p&gt;OK&lt;/p&gt;
&lt;p&gt;How much avalible physical memory do you have when you start to generate the sheet?&lt;/p&gt;
&lt;p&gt;I'm not sure what the problem can be, but make sure you dont run any other memory consuming process on the same computer at the same time (like sql server)&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Charts axes in MSO 2010">
      <Posts>
        <Post From="Watcher01" When="21/12/2010 14:24:05">
          <Html>
        
&lt;p&gt;Hi&lt;/p&gt;
&lt;p&gt;I`ve got strange excel files behaviour in 2010:&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre style="padding-left: 30px;"&gt;&lt;span style="color: blue;"&gt;var&lt;/span&gt; chart = tws.Drawings.AddChart(&lt;span style="color: rgb(163, 21, 21);"&gt;"Chart"&lt;/span&gt;, eChartType.ColumnStacked);
chart.SetPosition(row, 0,  column, 0);
chart.SetSize(ch.XDimension, ch.YDimension);

&lt;span style="color: blue;"&gt;var&lt;/span&gt; serie1 = chart.Series.Add(&lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelAddress(rowfromchart, item.Key, rowtochart, item.Key).Address, ExcelCellBase.GetAddress(rowfromchart, colXchart, rowtochart, colXchart));
serie1.Header = Tools.LibraText(item.Value);
title = title1

&lt;span style="color: blue;"&gt;var&lt;/span&gt; chartType2 = chart.PlotArea.ChartTypes.Add(eChartType.LineStacked);
chartType2.UseSecondaryAxis = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
&lt;span style="color: blue;"&gt;var&lt;/span&gt; serie2 = chartType2.Series.Add(&lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelAddress(rowfromchart, item.Key, rowtochart, item.Key).Address, ExcelCellBase.GetAddress(rowfromchart, colXchart, rowtochart, colXchart));
serie2.Header = title2;
chartType2.XAxis.Deleted = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;

title = dt.DateMin.ToShortDateString() + &lt;span style="color: rgb(163, 21, 21);"&gt;" - "&lt;/span&gt; + dt.DateMax.ToShortDateString();
chart.Title.Text = title;
chart.Title.Font.Size = 8;
chart.PlotArea.Fill.Color = Color.LightGray;
chart.Style = eChartStyle.Style5;
&lt;/pre&gt;
&lt;pre style="padding-left: 30px;"&gt;&lt;br&gt;&lt;/pre&gt;
&lt;pre style="padding-left: 30px;"&gt;&lt;br&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;span style='font-family: "Segoe UI","Microsoft Sans Serif",Arial,Geneva,sans-serif; white-space: normal;'&gt;This is newely added to EPPlus chart with two y axes.&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;In 2003 and 2007 Y axes and X axis are fully visible - I mean there are values on axes, for example 10%, 20%, 30%, ...&lt;/p&gt;
&lt;p&gt;In 2010 what I can see is only plotarea with chart - there is no&amp;nbsp;surrounding&amp;nbsp;space with axes values.&lt;/p&gt;
&lt;p&gt;Have anyone of you&amp;nbsp;similar&amp;nbsp;problem?&lt;/p&gt;
&lt;p&gt;BR&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="akronite" When="21/12/2010 15:13:50">
          <Html>
        Hi, are you able to zip and attach that example? I would like to test&lt;br&gt;
and debug it to see for myself.&lt;br&gt;
Thanks&lt;br&gt;
- Michael T.&lt;br&gt;
&lt;br&gt;
On 12/21/10, Watcher01 &amp;lt;notifications@codeplex.com&amp;gt; wrote:&lt;br&gt;
&amp;gt; From: Watcher01&lt;br&gt;
&amp;gt;&lt;br&gt;
&amp;gt; HiI`ve got strange excel files behaviour in 2010: var chart =&lt;br&gt;
&amp;gt; tws.Drawings.AddChart("Chart",&lt;br&gt;
&amp;gt; eChartType.ColumnStacked);chart.SetPosition(row, 0, column,&lt;br&gt;
&amp;gt; 0);chart.SetSize(ch.XDimension, ch.YDimension);var serie1 =&lt;br&gt;
&amp;gt; chart.Series.Add(new ExcelAddress(rowfromchart, item.Key, rowtochart,&lt;br&gt;
&amp;gt; item.Key).Address, ExcelCellBase.GetAddress(rowfromchart, colXchart,&lt;br&gt;
&amp;gt; rowtochart, colXchart));serie1.Header = Tools.LibraText(item.Value);title =&lt;br&gt;
&amp;gt; title1var chartType2 =&lt;br&gt;
&amp;gt; chart.PlotArea.ChartTypes.Add(eChartType.LineStacked);chartType2.UseSecondaryAxis&lt;br&gt;
&amp;gt; = true;var serie2 = chartType2.Series.Add(new ExcelAddress(rowfromchart,&lt;br&gt;
&amp;gt; item.Key, rowtochart, item.Key).Address,&lt;br&gt;
&amp;gt; ExcelCellBase.GetAddress(rowfromchart, colXchart, rowtochart,&lt;br&gt;
&amp;gt; colXchart));serie2.Header = title2;chartType2.XAxis.Deleted = true;title =&lt;br&gt;
&amp;gt; dt.DateMin.ToShortDateString() + " - " +&lt;br&gt;
&amp;gt; dt.DateMax.ToShortDateString();chart.Title.Text =&lt;br&gt;
&amp;gt; title;chart.Title.Font.Size = 8;chart.PlotArea.Fill.Color =&lt;br&gt;
&amp;gt; Color.LightGray;chart.Style = eChartStyle.Style5;&lt;br&gt;
&amp;gt;&lt;br&gt;
&amp;gt; This is newely added to EPPlus chart with two y axes.In 2003 and 2007 Y axes&lt;br&gt;
&amp;gt; and X axis are fully visible - I mean there are values on axes, for example&lt;br&gt;
&amp;gt; 10%, 20%, 30%, ...In 2010 what I can see is only plotarea with chart - there&lt;br&gt;
&amp;gt; is no surrounding space with axes values.Have anyone of you similar&lt;br&gt;
&amp;gt; problem?BR&lt;br&gt;
&amp;gt;&lt;br&gt;
&amp;gt; &lt;br&gt;
&lt;br&gt;
-- &lt;br&gt;
Sent from my mobile device
        
    </Html>
        </Post>
        <Post From="jankallman" When="22/12/2010 08:14:24">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Apparently graphs are rendered a little bit&amp;nbsp;different in Excel 2010. I'll look in to it after the weekends.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Watcher01" When="23/12/2010 13:53:05">
          <Html>
        
&lt;blockquote style="margin: 0.25em 1em 0px; padding: 0px 0.25em; border: 0.1em solid rgb(204, 204, 204); border-image: none; font-style: italic;"&gt;
&lt;strong&gt;akronite wrote:&lt;/strong&gt;&lt;br&gt;
Hi, are you able to zip and attach that example? I would like to test&lt;br&gt;
and debug it to see for myself.&lt;br&gt;
Thanks&lt;br&gt;
- Michael T.&lt;br&gt;
&lt;/blockquote&gt;
&lt;blockquote style="margin: 0.25em 1em 0px; padding: 0px 0.25em; border: 0.1em solid rgb(204, 204, 204); border-image: none; font-style: italic;"&gt;
Hi Michael&lt;/blockquote&gt;
&lt;blockquote style="margin: 0.25em 1em 0px; padding: 0px 0.25em; border: 0.1em solid rgb(204, 204, 204); border-image: none; font-style: italic;"&gt;
&lt;br&gt;
&lt;/blockquote&gt;
&lt;blockquote style="margin: 0.25em 1em 0px; padding: 0px 0.25em; border: 0.1em solid rgb(204, 204, 204); border-image: none; font-style: italic;"&gt;
You can use EPPlus sample. Good example is sample9.&lt;/blockquote&gt;
&lt;blockquote style="margin: 0.25em 1em 0px; padding: 0px 0.25em; border: 0.1em solid rgb(204, 204, 204); border-image: none; font-style: italic;"&gt;
&lt;br&gt;
&lt;/blockquote&gt;
&lt;blockquote style="margin: 0.25em 1em 0px; padding: 0px 0.25em; border: 0.1em solid rgb(204, 204, 204); border-image: none; font-style: italic;"&gt;
BR&lt;/blockquote&gt;

        
    </Html>
        </Post>
        <Post From="Watcher01" When="23/12/2010 14:01:54">
          <Html>
        
&lt;p&gt;Hi Jan,&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Is there some kind of workaround which might enable&amp;nbsp;proper&amp;nbsp;chart rendering in 2010?&lt;/p&gt;
&lt;p&gt;I mean for example property which enforces 2010 to open file in 2007 compatibility level?&lt;/p&gt;
&lt;p&gt;Any help are the most welcome.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;BR&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="27/12/2010 15:41:41">
          <Html>
        
&lt;p&gt;Hi again,&lt;/p&gt;
&lt;p&gt;Ok, I had a look at the samples and tests in 2010 and it was not very fun.&lt;/p&gt;
&lt;p&gt;It turns out MS has changed the behavior when you leave out certain elements in charts.&lt;/p&gt;
&lt;p&gt;Heres what i found out so far ...&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Deleted element in axis (your problem). In 2007 the axis shows. in 2010 it does not.
&lt;/li&gt;&lt;li&gt;Legend and charttitle overlay. In 2007 checked, in 2010 unchecked. &lt;/li&gt;&lt;li&gt;Datalabel properties,most of them . In 2007 unchecked . In 2010 checked. &lt;/li&gt;&lt;li&gt;3D RotY. 2007, defaults to 20. In 2010 to 0 &lt;/li&gt;&lt;li&gt;VaryColor for some charttypes. 2007 off. 2010 on. &lt;/li&gt;&lt;/ul&gt;
&lt;p&gt;I have no idea why this has been changed, but i'll need to do some more testing before I check in a fix for it. I hope I can do it before the end of this week.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="29/12/2010 18:55:51">
          <Html>
        
&lt;p&gt;Hi again,&lt;/p&gt;
&lt;p&gt;I have checked in a fix for this problem. Build the library&amp;nbsp;from the tags/2.8.0.1 folder.&amp;nbsp;Try it and give me some feedback if it works as expected for you.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Watcher01" When="30/12/2010 01:25:51">
          <Html>
        
&lt;p&gt;Hi Jan,&lt;/p&gt;
&lt;p&gt;It seems that now everything is working :)&lt;/p&gt;
&lt;p&gt;Thanks Jan once again for your efforts.&lt;/p&gt;
&lt;p&gt;BR&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Column( ).Width">
      <Posts>
        <Post From="Tehon" When="27/12/2010 13:27:16">
          <Html>
        
&lt;p&gt;In VC#:&lt;/p&gt;
&lt;p&gt;Column(1).Width = 2;&lt;/p&gt;
&lt;p&gt;In excel width column "A" = 1,29 (!?)&lt;/p&gt;
&lt;p&gt;How to set the column width is equal to 2?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="27/12/2010 15:17:07">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;The column width in the file is not the same as the width in Excel. Excel recalculates it.&amp;nbsp;Easiest way to check the width if you want to have it exact is to save your excel file--&amp;gt;rename *.zip and extract it.&lt;/p&gt;
&lt;p&gt;Now you can see the width of the columns in the xl\worksheets\sheet#.xml. in your case
&lt;strong&gt;2 = 2.7109375&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;If you want to deep dive into it, you can find the calculations in&amp;nbsp;the ECMA-376 documentation.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: Calibri; font-size: small;"&gt;&lt;span style="font-family: Calibri; font-size: small;"&gt;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How can i insert Combobox/DropDownList to Excel Sheet using &quot;EPPlus&quot;">
      <Posts>
        <Post From="AhmedMido" When="26/12/2010 16:17:52">
          <Html>
        
&lt;p&gt;In my Application I&amp;nbsp;creat File (.xlsx) using EPPlus (C# code)&amp;nbsp;, i need to know how to add Combobox/DropDownList to certian&amp;nbsp;Cells.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="akronite" When="27/12/2010 00:29:27">
          <Html>
        &lt;span style="font-family: arial,sans-serif; border-collapse: collapse;"&gt;
&lt;div&gt;Hi Ahmed, &lt;/div&gt;
&lt;div&gt;currently EPPlus do not support drop down/combo box. Try using a template instead.&lt;/div&gt;
&lt;div&gt;Have a template setup the way you want it, then use EPPlus to write the data in the data field where you have setup to used for the combo box.
&lt;/div&gt;
&lt;div&gt;Let me know if you need an example of this.&lt;/div&gt;
&lt;div&gt;&lt;br&gt;
&lt;/div&gt;
&lt;div&gt;Happy coding. &lt;/div&gt;
&lt;/span&gt;&lt;br&gt;
&lt;div&gt;On Mon, Dec 27, 2010 at 12:17 AM, AhmedMido &lt;span dir="ltr"&gt;&amp;lt;&lt;a href="mailto:notifications@codeplex.com" rel="nofollow"&gt;notifications@codeplex.com&lt;/a&gt;&amp;gt;&lt;/span&gt; wrote:&lt;br&gt;
&lt;blockquote style="margin: 0px 0px 0px 0.8ex; padding-left: 1ex; border-left-color: rgb(204, 204, 204); border-left-width: 1px; border-left-style: solid;"&gt;
&lt;div&gt;
&lt;p&gt;From: AhmedMido&lt;/p&gt;
&lt;div&gt;
&lt;p&gt;In my Application I creat File (.xlsx) using EPPlus (C# code) , i need to know how to add Combobox/DropDownList to certian Cells.&lt;/p&gt;
&lt;/div&gt;
&lt;div&gt;
&lt;p&gt;Read the &lt;a href="http://epplus.codeplex.com/Thread/View.aspx?ThreadId=239587&amp;amp;ANCHOR#Post540560" target="_blank" rel="nofollow"&gt;
full discussion online&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;To add a post to this discussion, reply to this email (&lt;a href="mailto:EPPlus@discussions.codeplex.com?subject=[EPPlus:239587]" target="_blank" rel="nofollow"&gt;EPPlus@discussions.codeplex.com&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;To start a new discussion for this project, email &lt;a href="mailto:EPPlus@discussions.codeplex.com" target="_blank" rel="nofollow"&gt;
EPPlus@discussions.codeplex.com&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;You are receiving this email because you subscribed to this discussion on CodePlex. You can
&lt;a href="https://epplus.codeplex.com/subscriptions/thread/project/edit" target="_blank" rel="nofollow"&gt;
unsubscribe or change your settings&lt;/a&gt; on codePlex.com.&lt;/p&gt;
&lt;p&gt;Please note: Images and attachments will be removed from emails. Any posts to this discussion will also be available online at
&lt;a href="http://codeplex.com" target="_blank" rel="nofollow"&gt;codeplex.com&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/blockquote&gt;
&lt;/div&gt;
&lt;br&gt;

        
    </Html>
        </Post>
        <Post From="AhmedMido" When="27/12/2010 09:40:17">
          <Html>
        
&lt;p&gt;Thanks ﻿﻿﻿Akronite&amp;nbsp;for your Reply&amp;nbsp;,&lt;/p&gt;
&lt;p&gt;but i need to bulid&amp;nbsp;Excel sheet with column [J] which have ﻿﻿ComboBox/DropDownList in each cell of it&amp;nbsp;, and having Values (Yes , No).&lt;/p&gt;
&lt;p&gt;if you have any idea or ﻿examples please Help me .&lt;/p&gt;
&lt;p&gt;Thnaks a lot for your co-operation.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="akronite" When="27/12/2010 09:55:37">
          <Html>
        Hi Ahmed,
&lt;div&gt;Are you able to attach the excel you are working on so i can plug it in for you?&lt;/div&gt;
&lt;div&gt;If not, please take a look of the simple excel file i've made.&lt;/div&gt;
&lt;div&gt;&lt;br&gt;
&lt;br&gt;
&lt;div&gt;On Mon, Dec 27, 2010 at 5:40 PM, AhmedMido &lt;span dir="ltr"&gt;&amp;lt;&lt;a href="mailto:notifications@codeplex.com" rel="nofollow"&gt;notifications@codeplex.com&lt;/a&gt;&amp;gt;&lt;/span&gt; wrote:&lt;br&gt;
&lt;blockquote style="margin: 0px 0px 0px 0.8ex; padding-left: 1ex; border-left-color: rgb(204, 204, 204); border-left-width: 1px; border-left-style: solid;"&gt;
&lt;div&gt;
&lt;p&gt;From: AhmedMido&lt;/p&gt;
&lt;div&gt;
&lt;p&gt;Thanks ﻿﻿﻿Akronite for your Reply ,&lt;/p&gt;
&lt;p&gt;but i need to bulid Excel sheet with column [J] which have ﻿﻿ComboBox/DropDownList in each cell of it , and having Values (Yes , No).&lt;/p&gt;
&lt;p&gt;if you have any idea or ﻿examples please Help me .&lt;/p&gt;
&lt;p&gt;Thnaks a lot for your co-operation.&lt;/p&gt;
&lt;/div&gt;
&lt;div&gt;
&lt;div&gt;
&lt;p&gt;Read the &lt;a href="http://epplus.codeplex.com/Thread/View.aspx?ThreadId=239587&amp;amp;ANCHOR#Post540732" target="_blank" rel="nofollow"&gt;
full discussion online&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;To add a post to this discussion, reply to this email (&lt;a href="mailto:EPPlus@discussions.codeplex.com?subject=[EPPlus:239587]" target="_blank" rel="nofollow"&gt;EPPlus@discussions.codeplex.com&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;To start a new discussion for this project, email &lt;a href="mailto:EPPlus@discussions.codeplex.com" target="_blank" rel="nofollow"&gt;
EPPlus@discussions.codeplex.com&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;You are receiving this email because you subscribed to this discussion on CodePlex. You can
&lt;a href="https://epplus.codeplex.com/subscriptions/thread/project/edit" target="_blank" rel="nofollow"&gt;
unsubscribe or change your settings&lt;/a&gt; on codePlex.com.&lt;/p&gt;
&lt;p&gt;Please note: Images and attachments will be removed from emails. Any posts to this discussion will also be available online at
&lt;a href="http://codeplex.com" target="_blank" rel="nofollow"&gt;codeplex.com&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/blockquote&gt;
&lt;/div&gt;
&lt;br&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="AhmedMido" When="27/12/2010 11:22:25">
          <Html>
        
&lt;p&gt;Hi Akronite ,&lt;/p&gt;
&lt;p&gt;I have took a&amp;nbsp;look of the simple excel file you have made . but i did'nt find what i need&amp;nbsp; , so I&amp;nbsp;sent you an Email on (&lt;a href="mailto:EPPlus@discussions.codeplex.com?subject=[EPPlus:239587]" target="_blank" rel="nofollow"&gt;EPPlus@discussions.codeplex.com&lt;/a&gt;)&amp;nbsp;with:&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;strong&gt;Subject&lt;/strong&gt;: { EPPlus&amp;nbsp; "Combobox/DropDownList" issue&amp;nbsp;}&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;and Sender&lt;/strong&gt; : { &lt;a href="mailto:ahmed85_1212@hotmail.com" rel="nofollow"&gt;ahmed85_1212@hotmail.com&lt;/a&gt;}&lt;/p&gt;
&lt;p&gt;and Attached my Excel&amp;nbsp;file (Excel Test.xlsx)&amp;nbsp;&amp;nbsp; , &lt;span style="font-size: small;"&gt;
this is an Excel sheet which i creat it by "EPplus" , i need to add Combobox/DropDownList in each cell in column (C)&amp;nbsp; . Can you help me.&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-size: small;"&gt;Thanks in Advance&lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="EPPlus  &quot;Combobox/DropDownList&quot; issue">
      <Posts>
        <Post From="AhmedMido" When="27/12/2010 11:22:17">
          <Html>
        &lt;font size="3"&gt;Dear Akronite ,&lt;/font&gt;&lt;br&gt;
&lt;font size="3"&gt;this is an Excel sheet which i creat it by "EPplus" , i need to add Combobox/DropDownList in each cell in column (C) . Can you help me.&lt;/font&gt;&lt;br&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Entity object to Excel Support">
      <Posts>
        <Post From="akronite" When="21/12/2010 08:09:47">
          <Html>
        
&lt;p&gt;During my holiday, i'll be looking into enabling Entity object to excel support.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;What's going to happen:&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;There'll be methods that would take a TEntity type object &lt;/li&gt;&lt;li&gt;Use the entity object property as header &lt;/li&gt;&lt;li&gt;Write data recursively &lt;/li&gt;&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Examle:&lt;/strong&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;div style="color: black; background-color: white;"&gt;&lt;pre&gt;&lt;span style="color: green;"&gt;// example class&lt;/span&gt;
&lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;class&lt;/span&gt; Orders
{
  &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;int&lt;/span&gt; ID {&lt;span style="color: blue;"&gt;get&lt;/span&gt;;&lt;span style="color: blue;"&gt;set&lt;/span&gt;;}
  &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; Name {&lt;span style="color: blue;"&gt;get&lt;/span&gt;;&lt;span style="color: blue;"&gt;set&lt;/span&gt;;}
  &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt; Description {&lt;span style="color: blue;"&gt;get&lt;/span&gt;;&lt;span style="color: blue;"&gt;set&lt;/span&gt;;}
  &lt;span style="color: blue;"&gt;public&lt;/span&gt; List&amp;lt;Item&amp;gt; Items {&lt;span style="color: blue;"&gt;get&lt;/span&gt;;&lt;span style="color: blue;"&gt;set&lt;/span&gt;;}
}

&lt;span style="color: green;"&gt;// example methods&lt;/span&gt;
&lt;span style="color: blue;"&gt;var&lt;/span&gt; sheet = package.Workbook.Worksheets[&lt;span style="color: rgb(163, 21, 21);"&gt;"Sheet1"&lt;/span&gt;];
&lt;span style="color: blue;"&gt;var&lt;/span&gt; orders = &lt;span style="color: blue;"&gt;new&lt;/span&gt; List&amp;lt;Orders&amp;gt;
{
 ID=1,
 Name=&lt;span style="color: rgb(163, 21, 21);"&gt;"Fruits"&lt;/span&gt;,
 Description=&lt;span style="color: rgb(163, 21, 21);"&gt;"All sort of fruits"&lt;/span&gt;, 
 &lt;span style="color: blue;"&gt;new&lt;/span&gt; List&amp;lt;Item&amp;gt;
 {
  {ID=53, Name=&lt;span style="color: rgb(163, 21, 21);"&gt;"Apple"&lt;/span&gt;, Price=1.99m},
  {ID=54, Name=&lt;span style="color: rgb(163, 21, 21);"&gt;"Banana"&lt;/span&gt;, Price=2.99m}
 }
},
{
 ID=2,
 Name=&lt;span style="color: rgb(163, 21, 21);"&gt;"Vegetables"&lt;/span&gt;,
 Description=&lt;span style="color: rgb(163, 21, 21);"&gt;"All sort of vegetables"&lt;/span&gt;, 
 &lt;span style="color: blue;"&gt;new&lt;/span&gt; List&amp;lt;Item&amp;gt;
 {
  {ID=84, Name=&lt;span style="color: rgb(163, 21, 21);"&gt;"Lettuce"&lt;/span&gt;, Price=1.99m},
  {ID=84, Name=&lt;span style="color: rgb(163, 21, 21);"&gt;"Broccoli"&lt;/span&gt;, Price=3.99m}
 }
}&lt;/pre&gt;
&lt;pre&gt;sheet.Add(orders);&lt;/pre&gt;
&lt;/div&gt;
&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Formula to reference a cell in another worksheet">
      <Posts>
        <Post From="arthurdent510" When="17/12/2010 23:28:04">
          <Html>
        
&lt;p&gt;I am trying to add in a formula to display the contents of a cell from another worksheet. &amp;nbsp;I have a worksheet called Accounts, and I'm trying to reference it. &amp;nbsp;However, whenever I try to open my excel doc, it gives the error that there was an error
 in doc, and it tries to repair it. &amp;nbsp;It ends up removing the formula. &amp;nbsp;This is how I'm trying to set it:&lt;/p&gt;
&lt;p&gt;summaryWS.Cells[iRowT, 8].FormulaR1C1 = &lt;span&gt;"Account!r8c8"&lt;/span&gt;;&lt;/p&gt;
&lt;p&gt;I've tried both using FormulaR1C1 and Formula. &amp;nbsp;I'm guessing that I'm just doing something wrong here.... &amp;nbsp;thanks!&lt;/p&gt;
&lt;p&gt;- Dave&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="20/12/2010 07:54:13">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;This i a bug in the r1c1 parsing. I'll add a fix for that.&lt;/p&gt;
&lt;p&gt;Use this as an alternative.&lt;/p&gt;
&lt;p&gt;summaryWS.Cells[iRowT, 8].Formula = string.Format(&lt;span&gt;"Account!{0}", ExcelCellBase.GetAddress(8,8))&lt;/span&gt;;&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Exposing RangeCollection Class">
      <Posts>
        <Post From="akronite" When="15/12/2010 07:46:37">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I was just wondering what's the reason for not exposing the RangeCollection Class?&lt;/p&gt;
&lt;p&gt;and ExcelCell class??&lt;/p&gt;
&lt;p&gt;Also, how would you go about getting the number of record rows in the worksheet if the RangeCollection class isn't exposed?&lt;/p&gt;
&lt;p&gt;Thanks.&lt;/p&gt;
&lt;p&gt;Michael T.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="15/12/2010 15:19:49">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;The Rangecollection is the store for all Rows, Columns and cells and is indexed by the internal RangeID.&amp;nbsp;The range ID is a long looking like this ...&lt;/p&gt;
&lt;pre&gt;((&lt;span style="color: blue;"&gt;ulong&lt;/span&gt;)SheetID) + (((&lt;span style="color: blue;"&gt;ulong&lt;/span&gt;)col) &amp;lt;&amp;lt; 15) + (((&lt;span style="color: blue;"&gt;ulong&lt;/span&gt;)row) &amp;lt;&amp;lt; 29);&lt;/pre&gt;
&lt;p&gt;That&amp;nbsp;not&amp;nbsp;very user friendly, so I keep it internal.&lt;/p&gt;
&lt;p&gt;The ExcelCell class is&amp;nbsp; the internal representation for a cell and it could be public, but i did not want to have two interfaces for cells when I added the ExcelRange class so I set it internal as well as the Cell method of the ExcelWorksheet class.&lt;/p&gt;
&lt;p&gt;To get the number of cells in the RangeCollection (I guess you mean the _cells variable), you would have to count the cells in the worksheet using a Linq query. Not very efficient, but if you have the need for it, it would be easy to add a CellsCount property
 to the worksheet.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="akronite" When="16/12/2010 05:54:32">
          <Html>
        
&lt;p&gt;Yes I see what you mean now, after having looked at it again.&lt;/p&gt;
&lt;p&gt;The main reason why i asked was because, i wanted to know how many data row available.&lt;/p&gt;
&lt;p&gt;I've got around this by only exposing a property within the ExcelWorksheet.&lt;/p&gt;
&lt;p&gt;public int RowCount { get { return _rows.Count; } }&lt;/p&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;p&gt;public int ColumnCount&lt;span&gt; &lt;/span&gt;{&lt;span&gt; &lt;/span&gt;get { return _columns.Count; }&lt;span&gt;
&lt;/span&gt;}&lt;/p&gt;
&lt;p&gt;However, sometime in the future, i feel that there will be a need to expose the worksheet rows and columns.&lt;/p&gt;
&lt;p&gt;Thanks again.&lt;/p&gt;
&lt;p&gt;Michael T.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="16/12/2010 19:19:08">
          <Html>
        
&lt;p&gt;You can also use the Worksheet.Dimensions property to get the size of the worksheet, if you dont need the the physical number of rows /&amp;nbsp;columns or cells.&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="null reference exception when trying to open a worksheet?">
      <Posts>
        <Post From="arthurdent510" When="14/12/2010 23:50:51">
          <Html>
        
&lt;p&gt;I have .xlsm file that I'm using as a template to build out a series of excel files. &amp;nbsp;I want to open the file and then copy the worksheet for each account I have. &amp;nbsp;However, whenever I try to open the work sheet I get a null reference exception.
 &amp;nbsp;There are a series of macros, but I've tried taking them out... not sure what could be causing this? &amp;nbsp;If I try this with a blank .xlsm file it works fine. &amp;nbsp;Any thoughts? &amp;nbsp;My code is pretty basic, I'm just doing &amp;nbsp;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;var&lt;/span&gt; ws = pck.Workbook.Worksheets[1];&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks!&lt;/p&gt;
&lt;p&gt;- Dave&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="15/12/2010 15:05:33">
          <Html>
        
&lt;p&gt;There is properbly something in your template that is not supported by the library. Create an issue and upload the template so I can have a look at it.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="arthurdent510" When="15/12/2010 18:47:24">
          <Html>
        
&lt;p&gt;Is there a list anywhere of things that are not supported? &amp;nbsp;I'll see about uploading my template in a bit. &amp;nbsp;Thanks!&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;- Dave&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="RichText Bugs?">
      <Posts>
        <Post From="patricker" When="15/12/2010 15:08:35">
          <Html>
        
&lt;p&gt;﻿﻿﻿﻿﻿I've been running into some issues with RichText in 2.7.0.1.&amp;nbsp; 2.8 isn't an option for me based on the issue I submitted under issue tracker.&lt;/p&gt;
&lt;p&gt;If I have a string in "Value" on a cell and then try to remvoe it&amp;nbsp;and insert&amp;nbsp;RichText I have to set "IsRichText=true" otherwise it shows the markup.&amp;nbsp; This happens even if I set "Value=nothing" first.&lt;/p&gt;
&lt;p&gt;If I insert "abc" usign RichText into "C2" and then insert "hij" into "C3" I end up with "abchij" in "C3".&amp;nbsp; This also happens across columns and seems to be a running concantenation.&amp;nbsp;
 So if I insert into "A4", "B5", "C2", "D4" in that order "D4" will end up as a giant concantenation of them all, and the previous entries will be concantenations of the values that came before.&amp;nbsp; Calling
 RichText.Clear before I start working with each cell fixed the issue for me.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="15/12/2010 15:21:35">
          <Html>
        
&lt;p&gt;OK, i'll have a look at that.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="patricker" When="15/12/2010 16:00:31">
          <Html>
        
&lt;p&gt;I'll try and make an example for these as well.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="patricker" When="15/12/2010 17:17:22">
          <Html>
        
&lt;p&gt;I tried making a simple example to show this... but I can't get it to happenin my simple examples on either version (2.7/2.8).&amp;nbsp; But sicne I found the work around it's not a big deal for me at the moment.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Different RichText&amp;nbsp;issue &lt;/strong&gt;that I can reproduce and have a sample for.&amp;nbsp; If I add rich text to a cell, then add another one and bold it, and finally add a third one everything from the bold one on get's bolded even though I didn't
 say too.&amp;nbsp; Is this by design or a bug?&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;Imports&lt;/span&gt; OfficeOpenXml
&lt;span style="color: blue;"&gt;Imports&lt;/span&gt; System.IO

&lt;span style="color: blue;"&gt;Module&lt;/span&gt; Module1
    &lt;span style="color: blue;"&gt;Sub&lt;/span&gt; Main()
        &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; savepath &lt;span style="color: blue;"&gt;As&lt;/span&gt; &lt;span style="color: blue;"&gt;String&lt;/span&gt; = Path.Combine(Path.GetTempPath(), Path.GetRandomFileName() + &lt;span style="color: rgb(163, 21, 21);"&gt;".xlsx"&lt;/span&gt;)

        &lt;span style="color: blue;"&gt;Using&lt;/span&gt; xlPackage &lt;span style="color: blue;"&gt;As&lt;/span&gt; &lt;span style="color: blue;"&gt;New&lt;/span&gt; ExcelPackage()
            &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; xlWorkSheet = xlPackage.Workbook.Worksheets.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"Test Sheet"&lt;/span&gt;)


            &lt;span style="color: blue;"&gt;For&lt;/span&gt; i &lt;span style="color: blue;"&gt;As&lt;/span&gt; &lt;span style="color: blue;"&gt;Integer&lt;/span&gt; = 1 &lt;span style="color: blue;"&gt;To&lt;/span&gt; 10
                &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; cell2 &lt;span style="color: blue;"&gt;As&lt;/span&gt; ExcelRange = xlWorkSheet.Cells(i, 1)
                cell2.RichText.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"non bold "&lt;/span&gt;)
                cell2.RichText.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;" bold text "&lt;/span&gt;).Bold = &lt;span style="color: blue;"&gt;True&lt;/span&gt;
                cell2.RichText.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;" shouldn't be bold but is "&lt;/span&gt;)
            &lt;span style="color: blue;"&gt;Next&lt;/span&gt;

            xlPackage.SaveAs(&lt;span style="color: blue;"&gt;New&lt;/span&gt; FileInfo(savepath))
        &lt;span style="color: blue;"&gt;End&lt;/span&gt; &lt;span style="color: blue;"&gt;Using&lt;/span&gt;

        Console.WriteLine(&lt;span style="color: rgb(163, 21, 21);"&gt;"Saved to "&lt;/span&gt; + savepath)
        Console.ReadLine()
    &lt;span style="color: blue;"&gt;End&lt;/span&gt; &lt;span style="color: blue;"&gt;Sub&lt;/span&gt;
&lt;span style="color: blue;"&gt;End&lt;/span&gt; &lt;span style="color: blue;"&gt;Module&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="RichText Excel Interop Style">
      <Posts>
        <Post From="patricker" When="15/12/2010 14:08:03">
          <Html>
        
&lt;p&gt;It would be nice if you could specify RichText the way Excel Interop does it.&amp;nbsp; With Excel Interop you specify the substring to change the style on out of a larger string.&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;cell.Characters(m.Index + 1, m.Length).Font.FontStyle = &lt;span style="color: rgb(163, 21, 21);"&gt;"Bold"&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="enumeration for Indexed -&amp;gt; System.Drawing.Colors?">
      <Posts>
        <Post From="neaves" When="19/10/2010 23:10:54">
          <Html>
        
&lt;p&gt;Hello!&lt;/p&gt;
&lt;p&gt;Nifty library, excellent work!&lt;/p&gt;
&lt;p&gt;A spreadsheet I'm trying to read/parse stores the foreground &amp;amp; background colors as Indexes.&amp;nbsp; They seem to align with the Office Open XML Documentation (ECMA-376), Part 4, "Markup Language Reference".&amp;nbsp; Specifically, section 3.8.26
 on indexedColors (Color Indexes) on page 2122.&amp;nbsp; It's referred to as "A deprecated indexing scheme for colours that is still required for some records, and for backwards compatibility with legacy formats".&amp;nbsp; This was a real pain to cross
 reference.&lt;/p&gt;
&lt;p&gt;Anyway...&amp;nbsp; I have to work with these Index now (via Style.Fill parameters), but I'd much rather use System.Drawing.Color enumerations, either via a lookup table or built-in functions.&amp;nbsp; Is this already in place, or on the TO DO list?&amp;nbsp; I'll
 probably begin work on a lookup mapping while I wait for a reply :)&lt;/p&gt;
&lt;p&gt;source: http://www.ecma-international.org/publications/standards/Ecma-376.htm&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="neaves" When="20/10/2010 00:22:14">
          <Html>
        
&lt;p&gt;Bah,&lt;/p&gt;
&lt;p&gt;Not all the colors have an analogous Known Color;&amp;nbsp; looks like at least the first 16 are usable at least.&amp;nbsp; Here's what I'm using to convert the 1-63 indice to an HTML color code.&amp;nbsp; Hope others find this useful, even if it is pulled directly
 from "freely available sources":&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;        &lt;span style="color: green;"&gt;// reference extracted from ECMA-376, Part 4, Section 3.8.26&lt;/span&gt;
        &lt;span style="color: blue;"&gt;private&lt;/span&gt; &lt;span style="color: blue;"&gt;string&lt;/span&gt;[] rgbLookup = 
        {
            &lt;span style="color: rgb(163, 21, 21);"&gt;"&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/000000"&gt;#000000&lt;/a&gt;"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"#FFFFFF"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"#FF0000"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/00"&gt;#00&lt;/a&gt;FF00"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0000"&gt;#0000&lt;/a&gt;FF"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"#FFFF00"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"#FF00FF"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/00"&gt;#00&lt;/a&gt;FFFF"&lt;/span&gt;,

            &lt;span style="color: rgb(163, 21, 21);"&gt;"&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/000000"&gt;#000000&lt;/a&gt;"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"#FFFFFF"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"#FF0000"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/00"&gt;#00&lt;/a&gt;FF00"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0000"&gt;#0000&lt;/a&gt;FF"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"#FFFF00"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"#FF00FF"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/00"&gt;#00&lt;/a&gt;FFFF"&lt;/span&gt;,

            &lt;span style="color: rgb(163, 21, 21);"&gt;"&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/800000"&gt;#800000&lt;/a&gt;"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/008000"&gt;#008000&lt;/a&gt;"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/000080"&gt;#000080&lt;/a&gt;"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/808000"&gt;#808000&lt;/a&gt;"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/800080"&gt;#800080&lt;/a&gt;"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/008080"&gt;#008080&lt;/a&gt;"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"#C0C0C0"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/808080"&gt;#808080&lt;/a&gt;"&lt;/span&gt;,
            
            &lt;span style="color: rgb(163, 21, 21);"&gt;"&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/9999"&gt;#9999&lt;/a&gt;FF"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/993366"&gt;#993366&lt;/a&gt;"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"#FFFFCC"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"#CCFFFF"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/660066"&gt;#660066&lt;/a&gt;"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"#FF8080"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0066"&gt;#0066&lt;/a&gt;CC"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"#CCCCFF"&lt;/span&gt;,
            
            &lt;span style="color: rgb(163, 21, 21);"&gt;"&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/000080"&gt;#000080&lt;/a&gt;"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"#FF00FF"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"#FFFF00"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/00"&gt;#00&lt;/a&gt;FFFF"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/800080"&gt;#800080&lt;/a&gt;"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/800000"&gt;#800000&lt;/a&gt;"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/008080"&gt;#008080&lt;/a&gt;"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0000"&gt;#0000&lt;/a&gt;FF"&lt;/span&gt;,
            
            &lt;span style="color: rgb(163, 21, 21);"&gt;"&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/00"&gt;#00&lt;/a&gt;CCFF"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"#CCFFFF"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"#CCFFCC"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"#FFFF99"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/99"&gt;#99&lt;/a&gt;CCFF"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"#FF99CC"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"#CC99FF"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"#FFCC99"&lt;/span&gt;,
            
            &lt;span style="color: rgb(163, 21, 21);"&gt;"&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/3366"&gt;#3366&lt;/a&gt;FF"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/33"&gt;#33&lt;/a&gt;CCCC"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/99"&gt;#99&lt;/a&gt;CC00"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"#FFCC00"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"#FF9900"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"#FF6600"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/666699"&gt;#666699&lt;/a&gt;"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/969696"&gt;#969696&lt;/a&gt;"&lt;/span&gt;,
            
            &lt;span style="color: rgb(163, 21, 21);"&gt;"&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/003366"&gt;#003366&lt;/a&gt;"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/339966"&gt;#339966&lt;/a&gt;"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/003300"&gt;#003300&lt;/a&gt;"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/333300"&gt;#333300&lt;/a&gt;"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/993300"&gt;#993300&lt;/a&gt;"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/993366"&gt;#993366&lt;/a&gt;"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/333399"&gt;#333399&lt;/a&gt;"&lt;/span&gt;,
            &lt;span style="color: rgb(163, 21, 21);"&gt;"&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/333333"&gt;#333333&lt;/a&gt;"&lt;/span&gt;,
        };

&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="20/10/2010 16:35:42">
          <Html>
        
&lt;p&gt;Thanks&lt;/p&gt;
&lt;p&gt;I guess&amp;nbsp;I should make the Index property writable&amp;nbsp;(or create a new one as as enum-type) some time in the future. I'll add that to my TODO list.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="neaves" When="14/12/2010 00:00:19">
          <Html>
        
&lt;p&gt;Jan,&lt;/p&gt;
&lt;p&gt;The ExcelColor contents seem to change, based on wich version of Excel saves the file.&amp;nbsp; .Indexed is used often if saving from Excel 2003;&amp;nbsp; .RGB is used for colors, if saving from Excel 2007;&amp;nbsp; .Tint is used for shades of grey, if saving from
 Excel 2007.&amp;nbsp; I've been using a translation function to ensure a consistent result across my available spreadsheets.&amp;nbsp; Feel free to include it in a future version.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;        &lt;span style="color: blue;"&gt;string&lt;/span&gt; LookupColor(OfficeOpenXml.Style.ExcelColor theColor)
        {
            &lt;span style="color: blue;"&gt;int&lt;/span&gt; iTint = 0;
            &lt;span style="color: blue;"&gt;string&lt;/span&gt; translatedRGB = &lt;span style="color: rgb(163, 21, 21);"&gt;""&lt;/span&gt;;

            &lt;span style="color: green;"&gt;// reference extracted from ECMA-376, Part 4, Section 3.8.26&lt;/span&gt;
            &lt;span style="color: blue;"&gt;string&lt;/span&gt;[] rgbLookup =
            {
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FF000000"&lt;/span&gt;, &lt;span style="color: green;"&gt;// 0&lt;/span&gt;
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FFFFFFFF"&lt;/span&gt;,
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FFFF0000"&lt;/span&gt;,
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FF00FF00"&lt;/span&gt;,
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FF0000FF"&lt;/span&gt;,
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FFFFFF00"&lt;/span&gt;,
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FFFF00FF"&lt;/span&gt;,
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FF00FFFF"&lt;/span&gt;,
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FF000000"&lt;/span&gt;, &lt;span style="color: green;"&gt;// 8&lt;/span&gt;
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FFFFFFFF"&lt;/span&gt;,
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FFFF0000"&lt;/span&gt;,
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FF00FF00"&lt;/span&gt;,
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FF0000FF"&lt;/span&gt;,
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FFFFFF00"&lt;/span&gt;,
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FFFF00FF"&lt;/span&gt;,
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FF00FFFF"&lt;/span&gt;,
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FF800000"&lt;/span&gt;,
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FF008000"&lt;/span&gt;,
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FF000080"&lt;/span&gt;,
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FF808000"&lt;/span&gt;,
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FF800080"&lt;/span&gt;,
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FF008080"&lt;/span&gt;,
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FFC0C0C0"&lt;/span&gt;,
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FF808080"&lt;/span&gt;,
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FF9999FF"&lt;/span&gt;,
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FF993366"&lt;/span&gt;,
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FFFFFFCC"&lt;/span&gt;,
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FFCCFFFF"&lt;/span&gt;,
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FF660066"&lt;/span&gt;,
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FFFF8080"&lt;/span&gt;,
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FF0066CC"&lt;/span&gt;,
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FFCCCCFF"&lt;/span&gt;,
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FF000080"&lt;/span&gt;,
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FFFF00FF"&lt;/span&gt;,
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FFFFFF00"&lt;/span&gt;,
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FF00FFFF"&lt;/span&gt;,
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FF800080"&lt;/span&gt;,
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FF800000"&lt;/span&gt;,
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FF008080"&lt;/span&gt;,
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FF0000FF"&lt;/span&gt;,
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FF00CCFF"&lt;/span&gt;,
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FFCCFFFF"&lt;/span&gt;,
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FFCCFFCC"&lt;/span&gt;,
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FFFFFF99"&lt;/span&gt;,
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FF99CCFF"&lt;/span&gt;,
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FFFF99CC"&lt;/span&gt;,
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FFCC99FF"&lt;/span&gt;,
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FFFFCC99"&lt;/span&gt;,
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FF3366FF"&lt;/span&gt;,
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FF33CCCC"&lt;/span&gt;,
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FF99CC00"&lt;/span&gt;,
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FFFFCC00"&lt;/span&gt;,
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FFFF9900"&lt;/span&gt;,
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FFFF6600"&lt;/span&gt;,
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FF666699"&lt;/span&gt;,
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FF969696"&lt;/span&gt;,
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FF003366"&lt;/span&gt;,
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FF339966"&lt;/span&gt;,
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FF003300"&lt;/span&gt;,
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FF333300"&lt;/span&gt;,
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FF993300"&lt;/span&gt;,
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FF993366"&lt;/span&gt;,
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FF333399"&lt;/span&gt;,
                &lt;span style="color: rgb(163, 21, 21);"&gt;"#FF333333"&lt;/span&gt;, &lt;span style="color: green;"&gt;// 63&lt;/span&gt;
            };

            &lt;span style="color: blue;"&gt;if&lt;/span&gt; ((0 &amp;lt;= theColor.Indexed) &amp;amp;&amp;amp; (rgbLookup.Count() &amp;gt; theColor.Indexed))
            {
                &lt;span style="color: green;"&gt;// coloring by pre-set color codes&lt;/span&gt;
                translatedRGB = rgbLookup[theColor.Indexed];
            }
            &lt;span style="color: blue;"&gt;else&lt;/span&gt; &lt;span style="color: blue;"&gt;if&lt;/span&gt; (&lt;span style="color: blue;"&gt;null&lt;/span&gt; != theColor.Rgb &amp;amp;&amp;amp; 0 &amp;lt; theColor.Rgb.Length)
            {
                &lt;span style="color: green;"&gt;// coloring by RGB value ("FFRRGGBB")&lt;/span&gt;
                translatedRGB = &lt;span style="color: rgb(163, 21, 21);"&gt;"#"&lt;/span&gt; + theColor.Rgb;
            }
            &lt;span style="color: blue;"&gt;else&lt;/span&gt;
            {
                &lt;span style="color: green;"&gt;// coloring by shades of grey (-1 -&amp;gt; 0)&lt;/span&gt;
                iTint = ((&lt;span style="color: blue;"&gt;int&lt;/span&gt;)(theColor.Tint * 160) + 0x80);
                translatedRGB = ((&lt;span style="color: blue;"&gt;int&lt;/span&gt;)(&lt;span style="color: blue;"&gt;decimal&lt;/span&gt;.Round(theColor.Tint * -512))).ToString(&lt;span style="color: rgb(163, 21, 21);"&gt;"X"&lt;/span&gt;);
                translatedRGB = &lt;span style="color: rgb(163, 21, 21);"&gt;"#FF"&lt;/span&gt; + translatedRGB + translatedRGB + translatedRGB;
            }

            &lt;span style="color: blue;"&gt;return&lt;/span&gt; translatedRGB;
        }
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;I'm a little sketchy on Excel's RGB value; specifically, the leading 2 FF characters.&amp;nbsp; If those are Intensity, then the "tint" logic could be simplified to be #NNFFFFFF, where NN is the hex-normalized tint value.&amp;nbsp; Alternatively, the leading
 2 characters could be trimmed from the excel format, leaving a standard 6-digit html hex code (with leading #).&lt;/p&gt;
&lt;p&gt;Amazing library, thanks for the latest release!&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="14/12/2010 18:36:07">
          <Html>
        
&lt;p&gt;Great!&lt;/p&gt;
&lt;p&gt;I'll try to include it in the next release.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Displaying Excel as GridView">
      <Posts>
        <Post From="maxxx123" When="09/12/2010 10:36:52">
          <Html>
        
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Hi all!&lt;/p&gt;
&lt;p&gt;I would like to display Excel as GridView and would like to know how this could be accomplished.&lt;/p&gt;
&lt;p&gt;I tried reading Excel file and creating html table to display it, but performance wasn't very good :(&lt;/p&gt;
&lt;p&gt;Took too much time to display a couple of thousands of rows :(&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Hope someone can help me! Thanks all for your effort!&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Regards, Max&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="10/12/2010 14:35:31">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Reading a couple of thousand rows should not take more than a couple of seconds, of course depending on the number of columns and the size of the workbook.&lt;/p&gt;
&lt;p&gt;Check out sample 8, it loads 65000 rows 5 columns (in about 5 seconds on my dev machine).&lt;/p&gt;
&lt;p&gt;How long time does it take to write your HTML to disc?&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="10/12/2010 15:06:26">
          <Html>
        
&lt;p&gt;I agree with Jan, I think your problem is rendering html table....you can try some tweaks like: remove white spaces and&amp;nbsp;disable viewstate&amp;nbsp;( reduce page size ), use li/lu instead table, etc.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Problem with formula">
      <Posts>
        <Post From="jonhed" When="10/12/2010 13:30:03">
          <Html>
        
&lt;p&gt;Hi!&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I'm trying to use the VLOOKUP formula in a cell but when I generate the file, I get an error saying that "Excel found content that can't be read..." and when I click to open the file anyway, the formula in the cell is removed. My code looks like
 this:&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt; ws.Cells[27, 3].Formula = &lt;span style="color: rgb(163, 21, 21);"&gt;"VLOOKUP(C26;F3:H7;3)"&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;Other simple formulas (like "B6*C2") works fine. Since I'm using the Swedish version of Excel I have also tried to use "LETARAD" instead of "VLOOKUP", but no success. If I have the formula in the template file, everything works,
 but the lookup fields might be of different size from time to time, so I want to add it in the code-behind so I can set correct cells base on the size. Am I doing something wrong or is it EPPlus that can't handle this formula?&lt;/p&gt;
&lt;p&gt;Regards&lt;/p&gt;
&lt;p&gt;Jonas&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="10/12/2010 14:43:22">
          <Html>
        
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;Hi,&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;You have to use commas(,) as separator for the parameters like this...&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;ws.Cells[27, 3].Formula = &lt;span style="color: rgb(163, 21, 21);"&gt;"VLOOKUP(C26,F3:H7,3)"&lt;/span&gt;;&lt;/pre&gt;
&lt;pre&gt;; is a swedish region setting.&lt;/pre&gt;
&lt;pre&gt;Check out the section about formulas and styling in the FAQ.&lt;/pre&gt;
&lt;pre&gt;Trevlig helg&lt;/pre&gt;
&lt;pre&gt;Jan&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Insert Objects onto a specific row/column in EPPlus">
      <Posts>
        <Post From="jrgalang" When="09/12/2010 03:08:03">
          <Html>
        
&lt;p&gt;Hi, is there a way for inserting objects as an icon in Excel using EPPlus?&lt;/p&gt;
&lt;p&gt;I currently have the following code for inserting screenshots onto a specific row/column already:&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;ExcelPicture ScreenshotSave = saveSheet.Drawings.AddPicture(&lt;span style="color: rgb(163, 21, 21);"&gt;"Screenshot "&lt;/span&gt; + (row - 1) + Controls.Analytics.glbDate, bmpScreenshot);
                    ScreenshotSave.SetSize(2);
                    ScreenshotSave.SetPosition((row - 1), 1, 4, 1);

&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;Manually, you can do it by clicking Insert&amp;gt;Object, select Create from File, and checking Display as an Icon. Assuming you've clicked on the row/column where you'd like it to be beforehand, it should be placed there as expected and will have the =EMBED("Worksheet","")
 function as its code.&lt;/p&gt;
&lt;p&gt;Is there a way in EPPlus that it will retrieve the location of the file and do the embedding similar to what I'm doing with the screenshots?&lt;/p&gt;
&lt;p&gt;Thanks!&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;br&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="09/12/2010 09:04:51">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;No, there is no way to insert embedded objects yet. That is still on the TODO list.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Export excel to image">
      <Posts>
        <Post From="happydragon" When="06/12/2010 17:29:56">
          <Html>
        
&lt;p&gt;Helo jan ,can I export excel to image?&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="06/12/2010 18:10:37">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;No, EPPlus has no support to render a worksheet to an Image.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Add Comment">
      <Posts>
        <Post From="Green_soft_group" When="04/12/2010 12:35:42">
          <Html>
        
&lt;p&gt;Hi all&lt;/p&gt;
&lt;p&gt;I am using this package for reading and writing excel files. I can not add comment to a cell with this package. AddComment method work without error but when open excel file, MS Excel return an error and do not show comment.&lt;/p&gt;
&lt;p&gt;This is my code :&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: Consolas;"&gt;&lt;span style="font-family: Consolas;"&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

&lt;p&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas;"&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas;"&gt;if&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas;"&gt; (xlPackage&lt;/span&gt;&lt;span style="color: rgb(0, 128, 128); font-family: Consolas;"&gt;&lt;span style="color: rgb(0, 128, 128); font-family: Consolas;"&gt;.&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas;"&gt;Workbook&lt;/span&gt;&lt;span style="color: rgb(0, 128, 128); font-family: Consolas;"&gt;&lt;span style="color: rgb(0, 128, 128); font-family: Consolas;"&gt;.&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas;"&gt;Worksheets[SheetIndex]&lt;/span&gt;&lt;span style="color: rgb(0, 128, 128); font-family: Consolas;"&gt;&lt;span style="color: rgb(0, 128, 128); font-family: Consolas;"&gt;.&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas;"&gt;Cells[Row,
 Col]&lt;/span&gt;&lt;span style="color: rgb(0, 128, 128); font-family: Consolas;"&gt;&lt;span style="color: rgb(0, 128, 128); font-family: Consolas;"&gt;.&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas;"&gt;Comment
&lt;/span&gt;&lt;span style="color: rgb(0, 128, 128); font-family: Consolas;"&gt;&lt;span style="color: rgb(0, 128, 128); font-family: Consolas;"&gt;==&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas;"&gt;
&lt;/span&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas;"&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas;"&gt;null&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas;"&gt;)&lt;span style="font-family: Consolas;"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;xlPackage&lt;span style="color: rgb(0, 128, 128); font-family: Consolas;"&gt;&lt;span style="color: rgb(0, 128, 128); font-family: Consolas;"&gt;.&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas;"&gt;Workbook&lt;/span&gt;&lt;span style="color: rgb(0, 128, 128); font-family: Consolas;"&gt;&lt;span style="color: rgb(0, 128, 128); font-family: Consolas;"&gt;.&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas;"&gt;Worksheets[SheetIndex]&lt;/span&gt;&lt;span style="color: rgb(0, 128, 128); font-family: Consolas;"&gt;&lt;span style="color: rgb(0, 128, 128); font-family: Consolas;"&gt;.&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas;"&gt;Comments&lt;/span&gt;&lt;span style="color: rgb(0, 128, 128); font-family: Consolas;"&gt;&lt;span style="color: rgb(0, 128, 128); font-family: Consolas;"&gt;.&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas;"&gt;Add(xlPackage&lt;/span&gt;&lt;span style="color: rgb(0, 128, 128); font-family: Consolas;"&gt;&lt;span style="color: rgb(0, 128, 128); font-family: Consolas;"&gt;.&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas;"&gt;Workbook&lt;/span&gt;&lt;span style="color: rgb(0, 128, 128); font-family: Consolas;"&gt;&lt;span style="color: rgb(0, 128, 128); font-family: Consolas;"&gt;.&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas;"&gt;Worksheets[SheetIndex]&lt;/span&gt;&lt;span style="color: rgb(0, 128, 128); font-family: Consolas;"&gt;&lt;span style="color: rgb(0, 128, 128); font-family: Consolas;"&gt;.&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas;"&gt;Cells[Row,
 Col], value, &lt;/span&gt;&lt;span style="color: rgb(163, 21, 21); font-family: Consolas;"&gt;&lt;span style="color: rgb(163, 21, 21); font-family: Consolas;"&gt;""&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas;"&gt;);&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas;"&gt;&lt;span style="color: rgb(0, 0, 255); font-family: Consolas;"&gt;else&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas;"&gt;&lt;span style="font-family: Consolas;"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;﻿xlPackage&lt;span style="color: rgb(0, 128, 128); font-family: Consolas;"&gt;&lt;span style="color: rgb(0, 128, 128); font-family: Consolas;"&gt;.&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas;"&gt;Workbook&lt;/span&gt;&lt;span style="color: rgb(0, 128, 128); font-family: Consolas;"&gt;&lt;span style="color: rgb(0, 128, 128); font-family: Consolas;"&gt;.&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas;"&gt;Worksheets[SheetIndex]&lt;/span&gt;&lt;span style="color: rgb(0, 128, 128); font-family: Consolas;"&gt;&lt;span style="color: rgb(0, 128, 128); font-family: Consolas;"&gt;.&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas;"&gt;Cells[Row,
 Col]&lt;/span&gt;&lt;span style="color: rgb(0, 128, 128); font-family: Consolas;"&gt;&lt;span style="color: rgb(0, 128, 128); font-family: Consolas;"&gt;.&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas;"&gt;Comment&lt;/span&gt;&lt;span style="color: rgb(0, 128, 128); font-family: Consolas;"&gt;&lt;span style="color: rgb(0, 128, 128); font-family: Consolas;"&gt;.&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas;"&gt;Text
&lt;/span&gt;&lt;span style="color: rgb(0, 128, 128); font-family: Consolas;"&gt;&lt;span style="color: rgb(0, 128, 128); font-family: Consolas;"&gt;=&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas;"&gt; value;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="04/12/2010 13:56:31">
          <Html>
        
&lt;p&gt;I dont know why....maybe Jan can tell us but author name cannot be null or blank. Change "" for any value.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="green_soft_group" When="05/12/2010 05:47:31">
          <Html>
        
&lt;p&gt;Thanks mrxrsd. It is work with change author from "" to a value.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="05/12/2010 11:03:13">
          <Html>
        
&lt;p&gt;The author is a required value in the XML-schema. Obviously I should&amp;nbsp;throw an exception if the&amp;nbsp;value is empty. I'll add&amp;nbsp;fix for that next time&amp;nbsp;I&amp;nbsp;check in some code.&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Hidden cells in graph">
      <Posts>
        <Post From="FSA" When="01/12/2010 15:49:16">
          <Html>
        
&lt;p&gt;Hello,&lt;/p&gt;
&lt;p&gt;I'm sorry for my poor english, but i'm French.&lt;/p&gt;
&lt;p&gt;It's possible to have hidden cells in graph ?&lt;/p&gt;
&lt;p&gt;In French :&lt;/p&gt;
&lt;p&gt;Est-il possible d'avoir des cellus cachées dans un graphe ?&lt;/p&gt;
&lt;p&gt;Si oui, comment ?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Best Regards.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="02/12/2010 15:55:26">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;T﻿here is no&amp;nbsp;property for changing "the show data in hidden..." checkbox by code, but I'll add that to my TODO list.&lt;/p&gt;
&lt;p&gt;The easiest way to do this is to use a template with a graph that has the appropriate settings.﻿&lt;/p&gt;
&lt;p&gt;I had a quick look at it and if you&amp;nbsp;dont want to use a template, here is a "hack" to remove the plotVisOnly tag from the ChartXml to "flip" the checkbox...&amp;nbsp;﻿&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;XmlNamespaceManager ns=&lt;span style="color: blue;"&gt;new&lt;/span&gt; XmlNamespaceManager(&lt;span style="color: blue;"&gt;new&lt;/span&gt; NameTable());
ns.AddNamespace(&lt;span style="color: rgb(163, 21, 21);"&gt;"c"&lt;/span&gt;,&lt;span style="color: rgb(163, 21, 21);"&gt;"http://schemas.openxmlformats.org/drawingml/2006/chart"&lt;/span&gt;);
&lt;span style="color: blue;"&gt;var&lt;/span&gt; element = chart.ChartXml.SelectSingleNode(&lt;span style="color: rgb(163, 21, 21);"&gt;"//c:plotVisOnly"&lt;/span&gt;, ns);
&lt;span style="color: blue;"&gt;if&lt;/span&gt; (element!=&lt;span style="color: blue;"&gt;null&lt;/span&gt;) element.ParentNode.RemoveChild(element);

Replace the chart variable with your chart.&lt;/pre&gt;
&lt;pre&gt;Jan&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="FSA" When="03/12/2010 10:52:57">
          <Html>
        
&lt;p&gt;Thanks.&lt;/p&gt;
&lt;p&gt;I test this code.&lt;/p&gt;
&lt;p&gt;Fabrice.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="FSA" When="03/12/2010 11:14:39">
          <Html>
        
&lt;p&gt;It's OK&lt;/p&gt;
&lt;p&gt;Thanks.&lt;/p&gt;
&lt;p&gt;Fabrice.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Problem sending a command to the program">
      <Posts>
        <Post From="dtsob75" When="29/11/2010 20:23:55">
          <Html>
        
&lt;p&gt;I have a relatively simple process where I am building a workbook that contains a column that is incremented from a starting number.&amp;nbsp; For some reason, I get the the titled error and then get "The converted failed to save the file."&amp;nbsp; Not
 sure what is going on.&amp;nbsp; I had this working on another pc, but have not been able to get this to work here.&amp;nbsp; Any ideas?&lt;/p&gt;
&lt;p&gt;Code:&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;			ExcelPackage pck = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage();
			&lt;span style="color: blue;"&gt;var&lt;/span&gt; ws = pck.Workbook.Worksheets.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"Manual Receipts"&lt;/span&gt;);
			
			ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;" SpaceNeedle Manual Receipt Form"&lt;/span&gt;;

			&lt;span style="color: blue;"&gt;using&lt;/span&gt; (ExcelRange r = ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A1:F1"&lt;/span&gt;])
				{
				r.Merge = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
				r.Style.Font.SetFromFont(&lt;span style="color: blue;"&gt;new&lt;/span&gt; Font(&lt;span style="color: rgb(163, 21, 21);"&gt;"Arial"&lt;/span&gt;, 18, FontStyle.Italic));
				r.Style.Font.Color.SetColor(Color.DarkRed);
				r.Style.HorizontalAlignment = OfficeOpenXml.Style.ExcelHorizontalAlignment.CenterContinuous;
				&lt;span style="color: green;"&gt;//r.Style.Fill.PatternType = OfficeOpenXml.Style.ExcelFillStyle.Solid;&lt;/span&gt;
				&lt;span style="color: green;"&gt;//r.Style.Fill.BackgroundColor.SetColor(Color.FromArgb(23, 55, 93));&lt;/span&gt;
				}
&lt;span style="color: green;"&gt;//			ws.Column(1).BestFit = true;&lt;/span&gt;
			ws.Column(1).Width = 17; 
			ws.Column(5).Width = 20;


		ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A2"&lt;/span&gt;].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"Date Produced"&lt;/span&gt;;

			ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A2"&lt;/span&gt;].Style.Font.Bold = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
			ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"B2"&lt;/span&gt;].Value = DateTime.Now.ToShortDateString();
			ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"D2"&lt;/span&gt;].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"Quantity"&lt;/span&gt;;
			ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"D2"&lt;/span&gt;].Style.Font.Bold = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
			ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"E2"&lt;/span&gt;].Value = txtReceiptQty.Text;

			ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"C4"&lt;/span&gt;].Value = &lt;span style="color: rgb(163, 21, 21);"&gt;"Receipt Number"&lt;/span&gt;;
			ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"C4"&lt;/span&gt;].Style.WrapText = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
			ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"C4"&lt;/span&gt;].Style.Font.Bold = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;

			&lt;span style="color: blue;"&gt;int&lt;/span&gt; rowNbr = 5;
			&lt;span style="color: blue;"&gt;for&lt;/span&gt; (&lt;span style="color: blue;"&gt;int&lt;/span&gt; entryNbr = 1; entryNbr &amp;lt;= qtyReceipts; entryNbr += 1)
			{
			ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"B"&lt;/span&gt; + rowNbr].Value = entryNbr;
			ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"C"&lt;/span&gt; + rowNbr].Value = begNbr + entryNbr - 1;
				rowNbr += 1;
			}

		Response.BinaryWrite(pck.GetAsByteArray());
		Response.ContentType = &lt;span style="color: rgb(163, 21, 21);"&gt;"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"&lt;/span&gt;;
		Response.AddHeader(&lt;span style="color: rgb(163, 21, 21);"&gt;"content-disposition"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"attachment;  filename=ReceiptOrderForm.xlsx"&lt;/span&gt;);

&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="30/11/2010 07:40:39">
          <Html>
        
&lt;p&gt;Your code seems to work fine (in 2.8). Try a Response.Clear() before you do the Response.BinaryWrite and see if that helps.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="dtsob75" When="30/11/2010 22:34:24">
          <Html>
        
&lt;p&gt;Thanks for the feedback.&lt;/p&gt;
&lt;p&gt;I tried the Respone.Clear&amp;nbsp;and I get an error box that says:&lt;/p&gt;
&lt;p&gt;Excel found unreadable content in 'ReceiptOrderForm[3].xlsx'.&amp;nbsp; Do you want to recover&amp;nbsp; the contents of the workbook.&amp;nbsp; If you trust the source of this workbook, click yes.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;I said yes and it opened it up correctly.&amp;nbsp; &lt;/strong&gt;&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;I also ran it and did save instead of open and I got the above message, and when I opened it, Excel repaired the file, but did not give me any information on what it reparied.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I am using Excel 2010, it that makes any difference.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="01/12/2010 07:50:36">
          <Html>
        
&lt;p&gt;I don't think Excel 2010 will make any difference. Try to add a Response.End() at the end like in this discussion...&lt;/p&gt;
&lt;p&gt;&lt;a href="http://epplus.codeplex.com/Thread/View.aspx?ThreadId=223843" rel="nofollow"&gt;http://epplus.codeplex.com/Thread/View.aspx?ThreadId=223843&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="dtsob75" When="01/12/2010 14:14:16">
          <Html>
        
&lt;p&gt;Progress!!&amp;nbsp; I am still getting the dialog box with "There was a p&lt;span&gt;roblem sending a command to the program&amp;nbsp;&lt;/span&gt;&amp;nbsp;", but it will go ahead and start excel and create the workbook and sheet.&amp;nbsp; The popup will be troublesome.&lt;/p&gt;
&lt;p&gt;Is there a way to use this to create a spreadsheet without having excel loaded on the local pc?&lt;/p&gt;
&lt;p&gt;Joel WZ&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="02/12/2010 15:45:12">
          <Html>
        
&lt;p&gt;I think you have to have Excel on the local PC.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="HTML in cell">
      <Posts>
        <Post From="phuclong2885" When="01/12/2010 04:57:15">
          <Html>
        
&lt;p&gt;Hello Jan , I need your help&lt;/p&gt;
&lt;p&gt;I want to display html in excel like that&lt;/p&gt;
&lt;p&gt;sheet..Cell["A1"].value="&amp;lt;font color="blue"&amp;gt;&amp;lt;strong&amp;gt;test html in excel&amp;lt;/strong&amp;gt;&amp;lt;/font&amp;gt;" and it will display like
&lt;span style="color: rgb(0, 0, 255);"&gt;&lt;strong&gt;test html in excel&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(0, 0, 255);"&gt;&lt;span style="color: rgb(0, 0, 0);"&gt;Thanks&lt;/span&gt;&lt;strong&gt;&lt;br&gt;
&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="01/12/2010 08:02:34">
          <Html>
        
&lt;p&gt;There is no support for parsing HTML, so you will have to do that yourself,&amp;nbsp;but if you want to format a cell text in more that one style, use the RichText property...&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;var&lt;/span&gt; rs = ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;].RichText;
&lt;span style="color: blue;"&gt;var&lt;/span&gt; r1 = rs.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"Blue "&lt;/span&gt;);
r1.Color = Color.Blue;&lt;/pre&gt;
&lt;pre&gt;r1.Bold=true

&lt;span style="color: blue;"&gt;var&lt;/span&gt; r2 = rs.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"Red"&lt;/span&gt;);
r2.Color = Color.Red;

Jan&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Creating a drop down/combo box">
      <Posts>
        <Post From="bioluminescence" When="10/11/2010 11:33:13">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I am using C# and ASP.NET and I need to export data to an Excel spreadsheet.&lt;/p&gt;
&lt;p&gt;I have a list of applications that contains Application objects.&amp;nbsp; Each&amp;nbsp;Application object has a status ID.&amp;nbsp; When I export these applications&amp;nbsp;to Excel then I need a column with a drop down/combo box&amp;nbsp;in it.&amp;nbsp; In this drop down/combo
 box&amp;nbsp;should be&amp;nbsp;a list of all the statuses.&amp;nbsp; And then I need the status to be selected to that of the application's status ID.&lt;/p&gt;
&lt;p&gt;Another question is also with regards to the above scenario.&amp;nbsp; When the user downloads the Excel document then the user can change the status of each application by selecting a different value in the drop down.&amp;nbsp; I will need to upload this spreadsheet
 and loop through the rows and get the values of the columns and the value of the selected item in the drop down/combo box.&amp;nbsp; How would you do this?&lt;/p&gt;
&lt;p&gt;Is this possible?&amp;nbsp; If so, can someone please help provide some sample code for me?&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;
&lt;p&gt;Brendan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="10/11/2010 15:45:16">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;There is no support to create comboboxes or handle data validation in the library at this point.&lt;/p&gt;
&lt;p&gt;I guess you can always use a predefined template and update it, but you can't read the value of a combobox-object to get the value. You could try to use datavalidation in the template. I'm not sure if it will work (since it is not supported&amp;nbsp;by the library&amp;nbsp;yet),
 but give it a try.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="bioluminescence" When="11/11/2010 05:30:39">
          <Html>
        
&lt;p&gt;Ok, but can you atleast tell me how to create a dropdown item populated with values from another sheet?&amp;nbsp; And then if my application object has a status of declined then I want Declined to be selected from the dropdown.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="11/11/2010 19:30:03">
          <Html>
        
&lt;p&gt;As i said, the library don't support combo boxes or datavalidation, so you can't do that. You can add the data validation from Excel and open a the document,but you can't alter the datavalidation in any way.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Danthar" When="30/11/2010 13:45:43">
          <Html>
        
&lt;p&gt;I could really use this as well..&lt;/p&gt;
&lt;p&gt;Is this feature on the roadmap to be implemented ?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="01/12/2010 07:45:17">
          <Html>
        
&lt;p&gt;Datavalidation will be added in the next version (I have no date for it yet). If you want the Form control combobox, I have no plans&amp;nbsp;to&amp;nbsp;add&amp;nbsp;to&amp;nbsp;it at this point.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Chart with series">
      <Posts>
        <Post From="phuclong2885" When="25/11/2010 14:28:08">
          <Html>
        
&lt;p&gt;Hello ,I am using EEPplus to report an excel&amp;nbsp; which have a chart with two series (linechart and barchart) like this
&lt;a title="http://sprial.co.cc/chart-with-two-series.PNG" href="http://sprial.co.cc/chart-with-two-series.PNG" target="_blank" rel="nofollow"&gt;
&lt;span style="text-decoration: underline;"&gt;http://sprial.co.cc/chart-with-two-series.PNG
&lt;/span&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;I have tried but not working&lt;/p&gt;
&lt;p&gt;&amp;nbsp;var chart = (worksheet.Drawings.AddChart("Chart", eChartType.Line) as ExcelLineChart);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ExcelAddress valueAddress = new ExcelAddress(2, 5, 6, 5);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; chart.Series.Add(valueAddress.Address, "B2:B6");&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; chart.DataLabel.ShowCategory = true;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; chart.DataLabel.ShowPercent = true;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ExcelAddress valueAddress1&amp;nbsp;&amp;nbsp; = new ExcelAddress(2,6,6,6);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; var ser = chart.Series.Add(valueAddress1.Address, "B2:B6");&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ser.Chart.ChartType= eChartType.ColumnStacked;&lt;/p&gt;
&lt;p&gt;Can you post sample code ?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="25/11/2010 18:08:25">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Check out sample 9, in the LoadFile2 method, it shows how to do it.&lt;/p&gt;
&lt;p&gt;In your case something like this...&lt;/p&gt;
&lt;pre&gt;&lt;pre style="color: black; background-color: white;"&gt;&lt;pre&gt;&lt;span style="color: blue;"&gt;&lt;div style="color: black; background-color: white;"&gt;&lt;pre&gt;&lt;span style="color: blue;"&gt;&lt;div style="color: black; background-color: white;"&gt;&lt;pre&gt;&lt;span style="color: blue;"&gt;var&lt;/span&gt; chart = sheet.Drawings.AddChart(&lt;span style="color: rgb(163, 21, 21);"&gt;"chart2"&lt;/span&gt;, eChartType.Line);
        
ExcelAddress valueAddress = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelAddress(2, 5, 6, 5);
&lt;span style="color: blue;"&gt;var&lt;/span&gt; ser1=chart.Series.Add(valueAddress.Address, &lt;span style="color: rgb(163, 21, 21);"&gt;"B2:B6"&lt;/span&gt;);

&lt;span style="color: green;"&gt;//Add a new charttype&lt;/span&gt;
&lt;span style="color: blue;"&gt;var&lt;/span&gt; chartType2 = chart.PlotArea.ChartTypes.Add(eChartType.ColumnStacked);
&lt;span style="color: blue;"&gt;var&lt;/span&gt; ser2 = chartType2.Series.Add(valueAddress1.Address, &lt;span style="color: rgb(163, 21, 21);"&gt;"B2:B6"&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;
&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/span&gt;&lt;/pre&gt;
&lt;/pre&gt;
&lt;/pre&gt;
&lt;p&gt;(The Chart.Chartype shows the first charttype when the chart is added. It's supposed to be readonly, so it's a bugg. I'll add a fix&amp;nbsp;for that&amp;nbsp; later)&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;
&lt;ul&gt;
&lt;/ul&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Data Validation">
      <Posts>
        <Post From="mrxrsd" When="23/11/2010 19:15:47">
          <Html>
        
&lt;p&gt;I want do add data validation and contidional colors to a cell.&lt;/p&gt;
&lt;p&gt;Anyone know if is possible to add data validation? &amp;nbsp;&lt;/p&gt;
&lt;p&gt;Maybe with template...Has anyone ever tried?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="25/11/2010 06:38:31">
          <Html>
        
&lt;p&gt;Data validation&amp;nbsp;is planned&amp;nbsp;for&amp;nbsp;the next version (I'm not sure when that will be). I have not looked into conditional formatting so im not sure when that will be added.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Sys.WebForms.PageManagerParserErrorException received when attempting to create xlsx file">
      <Posts>
        <Post From="valkyrie" When="22/11/2010 18:09:02">
          <Html>
        
&lt;p&gt;I have a .Net web app that is .aspx pages that load .ascx user controls.&amp;nbsp; The user controls have updatepanels on them, and I've a sneaking suspicion that's what's causing the problem but I'm just not sure.&lt;/p&gt;
&lt;p&gt;I'm trying to have the page generate a .xlsx file on a button click; no errors are caught in the click method itself, but when that method is complete I get the following error:&amp;nbsp; Sys.WebForms.PageRequestManagerParserErrorException: The message received
 from the server could not be parsed&lt;/p&gt;
&lt;p&gt;Here's the pertinent button click method code:&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;pre&gt;                using (tapconn)
                {
                    string filename = "TapAppReport" + DateTime.Now.ToString("yymmdd") + ".xlsx";
                    FileInfo newfile = new FileInfo(filename);
                    using (ExcelPackage pkg = new ExcelPackage(newfile))
                    {
                        var wksht = pkg.Workbook.Worksheets.Add("TapApplicationReport");
                        wksht.Cells[1, 1].Value = "Premise Number";
                        wksht.Cells[2, 1].Value = "Customer Number";

                        wksht.Cells["A1:B1"].Style.Font.Bold = true;
                        wksht.Cells["A1:B1"].Style.HorizontalAlignment = ExcelHorizontalAlignment.Center;
                        wksht.Cells["A1:B1"].Style.Border.Bottom.Style = ExcelBorderStyle.Thin;
                        wksht.Cells["A1:B1"].Style.Border.Top.Style = ExcelBorderStyle.Thin;
                        wksht.Cells["A1:B1"].Style.Border.Left.Style = ExcelBorderStyle.Thin;
                        wksht.Cells["A1:B1"].Style.Border.Right.Style = ExcelBorderStyle.Thin;
                        wksht.Cells["A1:B1"].Style.Fill.PatternType = ExcelFillStyle.LightUp;
                        wksht.Cells["A1:B1"].Style.Fill.BackgroundColor.SetColor(System.Drawing.Color.LightGray);
&lt;br&gt;                        SqlCommand tapCmd = new SqlCommand(reportQuery, tapconn);
                        SqlDataAdapter tapDA = new SqlDataAdapter(tapCmd);
                        DataSet tapDS = new DataSet();
                        tapDA.Fill(tapDS);
                        DataTable tapDT = tapDS.Tables[0];
                        int i = 2;

                        foreach (DataRow drow in tapDT.Rows)
                        {
                            wksht.Cells[i, 1].Value = drow[0].ToString();
                            wksht.Cells[i, 2].Value = drow[1].ToString();

                            i++;
                        }
                        pkg.Save();
                    }

                    Response.Clear();
                    Response.ContentType = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";
                    Response.AddHeader("content-disposition", "attachment;  filename=" + filename);
                    Response.Write(filename);
                    Response.End();
                }&lt;/pre&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;The .ascx design-side code looks like this:&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;pre&gt;&amp;lt;%@ Control Language="C#" AutoEventWireup="true" CodeBehind="Index.ascx.cs" Inherits="Pipeline.TapApplication.Index" %&amp;gt;&lt;br&gt;&amp;lt;%@ Register Assembly="eWorld.UI, Version=2.0.6.2393, Culture=neutral, PublicKeyToken=24d65337282035f2" Namespace="eWorld.UI" TagPrefix="ew" %&amp;gt;&lt;br&gt;&lt;br&gt;&amp;lt;asp:ScriptManager ID="smTap" runat="server" EnablePageMethods="false" EnablePartialRendering="true" EnableScriptGlobalization="true" EnableScriptLocalization="true" /&amp;gt;&lt;br&gt;&amp;lt;asp:UpdatePanel ID="upTap" runat="server" ChildrenAsTriggers="false" UpdateMode="Conditional"&amp;gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;lt;ContentTemplate&amp;gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;lt;asp:Table ID="tblSearch" runat="server" BorderStyle="None" Font-Names="Verdana" Font-Size="10px" Width="100%" Visible="true"&amp;gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;lt;asp:TableRow&amp;gt;&lt;br&gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;lt;asp:TableCell ColumnSpan="2" HorizontalAlign="Center"&amp;gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;lt;asp:Button ID="btnShowReport" runat="server" Text="Show report with my search details" OnClick="btnShowReport_Click" Font-Size="10px" Font-Names="Verdana" /&amp;gt; &amp;lt;br /&amp;gt;&amp;lt;asp:Button ID="btnExcelReport" runat="server" Text="Download report to Excel with my search details" OnClick="btnExcelReport_Click" Font-Size="10px" Font-Names="Verdana" /&amp;gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;lt;/asp:TableCell&amp;gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;lt;/asp:TableRow&amp;gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;lt;/asp:Table&amp;gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;lt;br /&amp;gt;&lt;br&gt;    &lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;lt;/ContentTemplate&amp;gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;lt;Triggers&amp;gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;lt;asp:AsyncPostBackTrigger ControlID="btnShowReport" EventName="Click" /&amp;gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;lt;asp:AsyncPostBackTrigger ControlID="gvTap" EventName="RowCommand" /&amp;gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;lt;asp:AsyncPostBackTrigger ControlID="btnUpdateTap" EventName="Click" /&amp;gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;lt;/Triggers&amp;gt;&lt;br&gt;&amp;lt;/asp:UpdatePanel&amp;gt;        &lt;/pre&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="valkyrie" When="22/11/2010 18:20:11">
          <Html>
        
&lt;p&gt;As usual, spending the time typing it out gave me an idea.&amp;nbsp; I added the btnExcelReport control as a PostBackTrigger, and now it'll open the file without throwing a fit.&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I posted this so everyone else can learn from my fail (the trigger one, not the 'write it out and then answer your own question' one.)&lt;/p&gt;
&lt;p&gt;Valkyrie :)&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Powershell; WorkSheet Cell Address">
      <Posts>
        <Post From="foureight84" When="19/11/2010 08:00:26">
          <Html>
        
&lt;p&gt;I'm trying to incorporate this assembly with my Powershell Script and I'm having problems setting value for a provided cell address.&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: gray;"&gt;[&lt;/span&gt;&lt;span style="color: teal;"&gt;Reflection.Assembly&lt;/span&gt;&lt;span style="color: gray;"&gt;]&lt;/span&gt;&lt;span style="color: gray;"&gt;::&lt;/span&gt;LoadFrom(&lt;span style="color: rgb(163, 21, 21);"&gt;"$ScriptDir\EPPlus.dll"&lt;/span&gt;)

&lt;span style="color: orangered;"&gt;$ExcelPackage&lt;/span&gt; &lt;span style="color: gray;"&gt;=&lt;/span&gt; New&lt;span style="color: gray;"&gt;-&lt;/span&gt;Object OfficeOpenXml.ExcelPackage $(&lt;span style="color: gray;"&gt;[&lt;/span&gt;&lt;span style="color: teal;"&gt;System.IO.FileInfo&lt;/span&gt;&lt;span style="color: gray;"&gt;]&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;"C:\test1.xlsx"&lt;/span&gt;)
&lt;span style="color: orangered;"&gt;$WorkSheet&lt;/span&gt; &lt;span style="color: gray;"&gt;=&lt;/span&gt; &lt;span style="color: orangered;"&gt;$ExcelPackage&lt;/span&gt;.Workbook.Worksheets.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"Sample Sheet 1"&lt;/span&gt;)
&lt;span style="color: orangered;"&gt;$WorkSheet&lt;/span&gt;.Cells&lt;span style="color: gray;"&gt;[&lt;/span&gt;&lt;span style="color: teal;"&gt;1, 1&lt;/span&gt;&lt;span style="color: gray;"&gt;]&lt;/span&gt;.Value &lt;span style="color: gray;"&gt;=&lt;/span&gt; &lt;span style="color: rgb(163, 21, 21);"&gt;"Cell 1"&lt;/span&gt;
&lt;span style="color: orangered;"&gt;$ExcelPackage&lt;/span&gt;.Save()
&lt;span style="color: orangered;"&gt;$ExcelPackage&lt;/span&gt;.Dispose()
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;I receive this error regarding the specified cell address:&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;Property &lt;span style="color: rgb(163, 21, 21);"&gt;'Value'&lt;/span&gt; cannot be found on this object; make sure it exists and is settable.
At line:1 char:24
&lt;span style="color: gray;"&gt;+&lt;/span&gt; &lt;span style="color: orangered;"&gt;$WorkSheet&lt;/span&gt;.Cells&lt;span style="color: gray;"&gt;[&lt;/span&gt;&lt;span style="color: teal;"&gt;1, 1&lt;/span&gt;&lt;span style="color: gray;"&gt;]&lt;/span&gt;. &amp;lt;&amp;lt;&amp;lt;&amp;lt; Value&lt;span style="color: gray;"&gt;=&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;"Cell 1"&lt;/span&gt;
    &lt;span style="color: gray;"&gt;+&lt;/span&gt; CategoryInfo          : InvalidOperation: (:) [], RuntimeException
    &lt;span style="color: gray;"&gt;+&lt;/span&gt; FullyQualifiedErrorId : PropertyAssignmentException&lt;/pre&gt;
&lt;pre&gt;&lt;br&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Is there an alternate way of specifying a cell address? I know that $WorkSheet.Cells["A1"].Value = "Cell 1" works, but I want to avoid doing this as it is harder to enumerate through columns.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="20/11/2010 10:34:31">
          <Html>
        
&lt;p&gt;I have never used Powershell, so I dont know how it works with .net.&lt;/p&gt;
&lt;p&gt;The Cell property is an indexer, so check how that works with powershell.&lt;/p&gt;
&lt;p&gt;A wild guess is that it uses the item&amp;nbsp;property. Something like this..&lt;/p&gt;
&lt;p&gt;﻿&lt;span style="color: orangered;"&gt;$WorkSheet&lt;/span&gt;.Cells.Item(1, 1).Value
&lt;span style="color: gray;"&gt;=&lt;/span&gt; &lt;span style="color: rgb(163, 21, 21);"&gt;"Cell 1"&lt;/span&gt;&lt;br&gt;
or&lt;br&gt;
&lt;span style="color: orangered;"&gt;$WorkSheet&lt;/span&gt;.Cells.Item(1, 1, 1, 2).Value &lt;span style="color: gray;"&gt;
=&lt;/span&gt; &lt;span style="color: rgb(163, 21, 21);"&gt;"Cell A1B1"&lt;/span&gt; &lt;span style="color: gray;"&gt;
/&lt;/span&gt;&lt;span style="color: gray;"&gt;/&lt;/span&gt; A1:B1&lt;br&gt;
or &lt;br&gt;
&lt;span style="color: orangered;"&gt;$WorkSheet&lt;/span&gt;.Cells.Item(&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;).Value
&lt;span style="color: gray;"&gt;=&lt;/span&gt; &lt;span style="color: rgb(163, 21, 21);"&gt;"Cell 1"&lt;/span&gt;&lt;br&gt;
&lt;br&gt;
&lt;/p&gt;
&lt;p&gt;...but this is just a guess. Check out how powershell handles indexers.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="foureight84" When="21/11/2010 09:52:56">
          <Html>
        
&lt;p&gt;That is PERFECT! Thank you!!!&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="foureight84" When="22/11/2010 08:52:42">
          <Html>
        
&lt;p&gt;I should have said this earlier, but this an amazing project! Thank you!&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Strange error">
      <Posts>
        <Post From="tzinser" When="18/11/2010 14:32:28">
          <Html>
        
&lt;p&gt;I am using an .xlsm&amp;nbsp;template with a sort button.&amp;nbsp; I can open the .xlsm file but when i try to&amp;nbsp;utilize&amp;nbsp;it, the package Workbook object returns a null value exception.&amp;nbsp; However, if i step the code and add a watch or mouse over the
 excelpackage object to expose its methods and properties the code will run fine.&amp;nbsp; Its very strange.&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I added the save line below to see if saving the template and opening it again would solve the issue,&amp;nbsp; it didn't.&amp;nbsp; For some reason the Workbook throws the null exception.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Any insight would be appreciated.&amp;nbsp; Thanks,&amp;nbsp; Code is as follows:&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; string _template = "C:\\Source\\SortTemplate.xlsm";
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; FileInfo tempFile = new FileInfo(_template);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; tempFile.IsReadOnly = false;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; //****************Loop through Area List&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; if (dsArea.Tables.Count != 0)&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; foreach (DataRow dr in dsArea.Tables[0].Rows)&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; string _Area = dr["SalesAreaCode"].ToString();&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; _destFileFullName = "C:\\Source\\ASM" + _Area + "SummaryYTD.xlsm";&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; //****************Build An Area Package&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; FileInfo newFile = new FileInfo(_destFileFullName);&lt;/p&gt;
&lt;p&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; if (newFile.Exists)&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; newFile.Delete();&amp;nbsp; // ensures we create a new workbook&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;/p&gt;
&lt;p&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; using (ExcelPackage packagetemplate = new ExcelPackage(tempFile))&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
&lt;strong&gt;packagetemplate.Save(); --Workbook returns a null value exception. if i add a watch or step the code and mouse over to expose methods and properties it runs correctly&lt;/strong&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="19/11/2010 07:47:13">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Hard to tell what the problem can be,but check that you don't have any defined names referensing external workbooks. That will not work.&lt;/p&gt;
&lt;p&gt;If that not the case, create an issue and upload the template or provide me with the stack trace.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Centering a Worksheet Horizontally and Vertically on print">
      <Posts>
        <Post From="tzinser" When="12/11/2010 17:41:46">
          <Html>
        
&lt;p&gt;I can't seem to find the settings to center a Worksheet on the page Horizontally and Vertically when you print.&amp;nbsp; Any help would be appreciated.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks,&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="15/11/2010 20:02:28">
          <Html>
        
&lt;p&gt;Added to the Printersettings in version 2.8&lt;/p&gt;
&lt;p&gt;/Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="tzinser" When="15/11/2010 20:05:40">
          <Html>
        
&lt;div&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 11pt;"&gt;You are awesome. Thanks.&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 11pt;"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;div&gt;
&lt;div style="border-width: 1pt medium medium; border-style: solid none none; border-color: rgb(181, 196, 223) currentColor currentColor; padding: 3pt 0in 0in; border-image: none;"&gt;
&lt;p&gt;&lt;b&gt;&lt;span style="font-family:; font-size: 10pt;"&gt;From:&lt;/span&gt;&lt;/b&gt;&lt;span style="font-family:; font-size: 10pt;"&gt; jankallman [mailto:notifications@codeplex.com]
&lt;br&gt;
&lt;b&gt;Sent:&lt;/b&gt; Monday, November 15, 2010 3:03 PM&lt;br&gt;
&lt;b&gt;To:&lt;/b&gt; Zinser, Terry&lt;br&gt;
&lt;b&gt;Subject:&lt;/b&gt; Re: Centering a Worksheet Horizontally and Vertically on print [EPPlus:234495]&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 9pt;"&gt;From: jankallman&lt;/span&gt;&lt;/p&gt;
&lt;div id="ThreadNotificationPostBody" style="margin-bottom: 24pt;"&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 9pt;"&gt;Added to the Printersettings in version 2.8&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 9pt;"&gt;/Jan&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id="ThreadNotificationFooter" style="border-width: 1pt medium medium; border-style: solid none none; border-color: rgb(204, 204, 204) currentColor currentColor; padding: 0in; border-image: none;"&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 9pt;"&gt;Read the &lt;a href="http://epplus.codeplex.com/Thread/View.aspx?ThreadId=234495&amp;amp;ANCHOR#Post522299" rel="nofollow"&gt;
full discussion online&lt;/a&gt;.&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 9pt;"&gt;To add a post to this discussion, reply to this email (&lt;a href="mailto:EPPlus@discussions.codeplex.com?subject=[EPPlus:234495]" rel="nofollow"&gt;EPPlus@discussions.codeplex.com&lt;/a&gt;)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 9pt;"&gt;To start a new discussion for this project, email
&lt;a href="mailto:EPPlus@discussions.codeplex.com" rel="nofollow"&gt;EPPlus@discussions.codeplex.com&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 9pt;"&gt;You are receiving this email because you subscribed to this discussion on CodePlex. You can
&lt;a href="http://www.codeplex.com/site/discussions/thread/unsubscribe/234495" rel="nofollow"&gt;unsubscribe&lt;/a&gt; on CodePlex.com.&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 9pt;"&gt;Please note: Images and attachments will be removed from emails. Any posts to this discussion will also be available online at CodePlex.com&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Generating Xlsx file without writing to file system">
      <Posts>
        <Post From="phoxware" When="11/11/2010 09:31:26">
          <Html>
        
&lt;p&gt;hi guyz,&lt;/p&gt;
&lt;p&gt;i have a working sample for writting into an xlsx file using epplus, but how can i also do this without writting to file system?&lt;/p&gt;
&lt;p&gt;am currently using this code segment&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-size: x-small;"&gt;&lt;span style="font-size: x-small;"&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;span style="color: rgb(0, 0, 255); font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-size: x-small;"&gt;Dim&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: x-small;"&gt; oFile
&lt;/span&gt;&lt;span style="color: rgb(0, 0, 255); font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-size: x-small;"&gt;As&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: x-small;"&gt;
&lt;/span&gt;&lt;span style="color: rgb(0, 0, 255); font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-size: x-small;"&gt;New&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: x-small;"&gt; IO.FileInfo("new of an xlsx file")&lt;/span&gt;&lt;span style="font-size: x-small;"&gt;&lt;span style="font-size: x-small;"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;

&lt;div&gt;&lt;span style="font-size: x-small;"&gt;&lt;span style="font-size: x-small;"&gt;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-size: x-small;"&gt;&lt;span style="font-size: x-small;"&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;span style="color: rgb(0, 0, 255); font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-size: x-small;"&gt;Dim&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: x-small;"&gt; pck
&lt;/span&gt;&lt;span style="color: rgb(0, 0, 255); font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-size: x-small;"&gt;As&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: x-small;"&gt;
&lt;/span&gt;&lt;span style="color: rgb(0, 0, 255); font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-size: x-small;"&gt;New&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: x-small;"&gt; ExcelPackage(oFile)&lt;/span&gt;&lt;span style="font-size: x-small;"&gt;
&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-size: x-small;"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;.........&lt;/p&gt;
&lt;p&gt;pck.Save()&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;i want to bypass the xlsx file creation on disk&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="11/11/2010 19:36:57">
          <Html>
        
&lt;p&gt;Check out the web samples. Something like ...&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;ExcelPackage pck = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage();
&lt;span style="color: green;"&gt;//...&lt;/span&gt;
&lt;pre&gt;p﻿ck.SaveAs(Response.OutputStream);
Response.ContentType = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";
Response.AddHeader("content-disposition", "attachment;  filename=Sample1.xlsx");
&lt;/pre&gt;
&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="phoxware" When="12/11/2010 06:26:52">
          <Html>
        
&lt;p&gt;perfect...thanx&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Date OleAut invalid">
      <Posts>
        <Post From="paulo3011" When="09/11/2010 22:51:18">
          <Html>
        
&lt;p&gt;&lt;span id="result_box" lang="en"&gt;&lt;span&gt;Hello, I'm trying to use an Excel spreadsheet template and when I try to retrieve the worksheet appears the error: "Date OLEAUT invalid".
&lt;/span&gt;&lt;span&gt;The code used is:&lt;br&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span id="result_box" lang="en"&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;bool&lt;/span&gt; exportou = &lt;span style="color: blue;"&gt;false&lt;/span&gt;;
&lt;span style="color: blue;"&gt;string&lt;/span&gt; path = Constante.PathArquivosTemplateRelatorios + &lt;span style="color: rgb(163, 21, 21);"&gt;"template.xlsx"&lt;/span&gt;;
FileInfo template = &lt;span style="color: blue;"&gt;new&lt;/span&gt; FileInfo(path);

&lt;span style="color: blue;"&gt;if&lt;/span&gt; (template.Exists == &lt;span style="color: blue;"&gt;true&lt;/span&gt;)
{
    &lt;span style="color: blue;"&gt;using&lt;/span&gt; (ExcelPackage p = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(template, &lt;span style="color: blue;"&gt;true&lt;/span&gt;))
    {
        &lt;span style="color: blue;"&gt;int&lt;/span&gt; startRow = 2;

        ExcelWorksheet ws = p.Workbook.Worksheets[1];
        &lt;span style="color: blue;"&gt;int&lt;/span&gt; row = startRow;

&lt;span style="color: green;"&gt;//Population data...&lt;/span&gt;

        &lt;span style="color: green;"&gt;//Get the documet as a byte array from the stream and save it to disk.&lt;/span&gt;
        Byte[] bin = p.GetAsByteArray();

        &lt;span style="color: blue;"&gt;string&lt;/span&gt; file = Constante.PathArquivosTemplateRelatorios + &lt;span style="color: rgb(163, 21, 21);"&gt;"\\sample4.xlsx"&lt;/span&gt;;
        File.WriteAllBytes(file, bin);
        exportou = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;
    }
}
&lt;/pre&gt;
&lt;/div&gt;
&lt;br&gt;
&lt;span&gt;Does anyone know what happens?&lt;/span&gt;
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="10/11/2010 15:48:05">
          <Html>
        
&lt;p&gt;I have to look at your file to see whats wrong. Create an issue and upload it or send me notification if you want to send it by mail.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="paulo3011" When="10/11/2010 21:41:28">
          <Html>
        
&lt;p&gt;&lt;span id="result_box" lang="en"&gt;&lt;span style="color: rgb(0, 0, 0);"&gt;Hi, ok I do not know what is wrong with the file.
&lt;/span&gt;&lt;span&gt;An important is that the template file was generated on another machine.
&lt;/span&gt;&lt;span&gt;To solve my problem I generated a new file template from scratch and give the error no longer appeared.&lt;br&gt;
&lt;br&gt;
&lt;/span&gt;&lt;span&gt;thanks&lt;br&gt;
&lt;/span&gt;&lt;span&gt;Paulo Moreira&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="More trouble with PageBreak">
      <Posts>
        <Post From="Duardo" When="09/11/2010 21:19:41">
          <Html>
        
&lt;p&gt;Jan,&lt;/p&gt;
&lt;p&gt;I can't seem to get pagebreak to work.&amp;nbsp; I look at your comment in another post "trouble with pagebreak" and tried that solution.&lt;/p&gt;
&lt;p&gt;here's what I have tried:&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp; oR = worksheet.Cells["A26"];&lt;br&gt;
&amp;nbsp;&amp;nbsp; oR.Value = "X";&lt;br&gt;
&amp;nbsp;&amp;nbsp; oR.Worksheet.Row(26).PageBreak = true;&lt;br&gt;
&amp;nbsp;&amp;nbsp; //worksheet.Cells[26, 1].Value = "X";&lt;br&gt;
&amp;nbsp;&amp;nbsp; //worksheet.Row(26).PageBreak = true;&lt;/p&gt;
&lt;p&gt;I don't see a pagebreak in the worksheet.&lt;/p&gt;
&lt;p&gt;Thanks,&lt;/p&gt;
&lt;p&gt;Duardo&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="10/11/2010 15:36:04">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I tried&amp;nbsp;this code&amp;nbsp;and it worked fine (I used the latest source). Not sure what your problem can be.&lt;/p&gt;
&lt;p&gt;Anyway I will do a&amp;nbsp;fix in the new version so pagebreaks on empty rows will appear.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Duardo" When="10/11/2010 15:53:51">
          <Html>
        
&lt;p&gt;I am using 2.7.0.1 version.&amp;nbsp; Is there another planned release?&lt;/p&gt;
&lt;p&gt;Duardo&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="10/11/2010 16:02:18">
          <Html>
        
&lt;p&gt;2.8.0.1 in a week or two.&lt;/p&gt;
&lt;p&gt;It should work in 2.7.0.1. Can you provide me with a full sample that fails?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Duardo" When="10/11/2010 16:19:49">
          <Html>
        
&lt;p&gt;Thank you Jan for your time.&lt;/p&gt;
&lt;p&gt;private void Sample3() {&lt;br&gt;
&amp;nbsp;&amp;nbsp; //string filename = UniqueFileName(Server.MapPath("~/Reports/"), "GoalReport.xlsx");&lt;br&gt;
&amp;nbsp;&amp;nbsp; //string justFile = filename;&lt;br&gt;
&amp;nbsp;&amp;nbsp; //filename = Server.MapPath("~/Reports/") + filename;&lt;br&gt;
&amp;nbsp;&amp;nbsp; //FileInfo newFile = new FileInfo(filename);&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp; using (ExcelPackage package = new ExcelPackage()) {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; // add a new worksheet to the empty workbook&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ExcelWorksheet worksheet = package.Workbook.Worksheets.Add("Performance Report");&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; //FileInfo fi = new FileInfo(Server.MapPath("~/SMSlogo.jpg"));&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; //ExcelPicture pic = worksheet.Drawings.AddPicture("Logo", fi);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; //pic.SetSize(67, 41);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; //pic.SetPosition(0, 0);&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; //Add the headers&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; worksheet.Cells["A3:B3"].Merge = true;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; worksheet.Cells["A3"].Value = "Performance";&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; worksheet.Cells["A3"].Style.Fill.PatternType = ExcelFillStyle.Solid;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; worksheet.Cells["A3"].Style.Fill.BackgroundColor.SetColor(Color.Navy);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; worksheet.Cells["A3"].Style.Font.Color.SetColor(Color.White);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; worksheet.Cells["A3"].Style.Font.Bold = true;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; worksheet.Cells["A3"].Style.HorizontalAlignment = ExcelHorizontalAlignment.Center;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; worksheet.Cells[4, 1].Value = "Month";&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; worksheet.Cells[4, 2].Value = "Number";&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; worksheet.Cells["A4:B4"].Style.Fill.PatternType = ExcelFillStyle.Solid;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; worksheet.Cells["A4:B4"].Style.Fill.BackgroundColor.SetColor(Color.LightGray);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; worksheet.Cells["A4:B4"].Style.Font.Color.SetColor(Color.Black);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; worksheet.Cells["A4:B4"].Style.Font.Bold = true;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; worksheet.Cells["A4:B4"].Style.HorizontalAlignment = ExcelHorizontalAlignment.Center;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; worksheet.Cells["A5"].Value = "Sep-07";&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; worksheet.Cells["B5"].Value = 9;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; worksheet.Cells["A6"].Value = "Oct-07";&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; worksheet.Cells["B6"].Value = 1;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; worksheet.Cells["A7"].Value = "Nov-07";&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; worksheet.Cells["B7"].Value = 3;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; worksheet.Cells["A8"].Value = "Dec-07";&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; worksheet.Cells["B8"].Value = 3;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; worksheet.Cells["A9"].Value = "Jan-08";&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; worksheet.Cells["B9"].Value = 3;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; worksheet.Cells["A10"].Value = "Feb-08";&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; worksheet.Cells["B10"].Value = 5;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; worksheet.Cells["A11"].Value = "Mar-08";&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; worksheet.Cells["B11"].Value = 5;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; worksheet.Cells["A12"].Value = "Apr-08";&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; worksheet.Cells["B12"].Value = 10;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; worksheet.Cells["A13"].Value = "May-08";&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; worksheet.Cells["B13"].Value = 3;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ExcelRange oR = worksheet.Cells["A4:B13"];&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; oR.Style.Border.Left.Style = ExcelBorderStyle.Thin;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; oR.Style.Border.Right.Style = ExcelBorderStyle.Thin;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; oR.Style.Border.Top.Style = ExcelBorderStyle.Thin;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; oR.Style.Border.Bottom.Style = ExcelBorderStyle.Thin;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; var lineChart = worksheet.Drawings.AddChart("Performance", eChartType.Line) as ExcelLineChart;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; lineChart.SetPosition(4, 0, 2, 0);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; lineChart.SetSize(400, 400);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; lineChart.Series.Add(ExcelRange.GetAddress(5, 2, 13,2), ExcelRange.GetAddress(5, 1, 13, 1));&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; lineChart.Title.Text = "Performance";&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; lineChart.Series[0].Header = "Number";&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; oR = worksheet.Cells["A26"];&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; oR.Value = "X";&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; oR.Worksheet.Row(26).PageBreak = true;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; //worksheet.Cells[26, 1].Value = "X";&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; //worksheet.Row(26).PageBreak = true;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Response.Clear();&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; package.SaveAs(Response.OutputStream);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Response.ContentType = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Response.AddHeader("content-disposition", "attachment;&amp;nbsp; filename=GoalReport.xlsx");&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Response.End();&lt;br&gt;
&amp;nbsp;&amp;nbsp; }&lt;/p&gt;
&lt;p&gt;}&lt;/p&gt;
&lt;p&gt;&amp;nbsp;Duardo&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Does ExcelRange.Value support an object array?">
      <Posts>
        <Post From="Duardo" When="08/11/2010 17:06:06">
          <Html>
        
&lt;p&gt;Thank you for your excellent library.&lt;/p&gt;
&lt;p&gt;I am converting a web report in EPPlus that was originally written and working using Interop.&lt;br&gt;
When I try the following code, I don't get the results I expected.&lt;br&gt;
Am I using EPPlus correctly?&lt;/p&gt;
&lt;p&gt;object[,] oData = new object[2, 3];&lt;br&gt;
for (int j = 0; j &amp;lt; oData.GetUpperBound(0) + 1; j++) {&lt;br&gt;
&amp;nbsp;&amp;nbsp; for (int i = 0; i &amp;lt; oData.GetUpperBound(1) + 1; i++) {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; oData[j, i] = "";&lt;br&gt;
&amp;nbsp;&amp;nbsp; }&lt;br&gt;
}&lt;/p&gt;
&lt;p&gt;ExcelRange rg = worksheet.Cells["A27"];&lt;br&gt;
oData[0, 1] = "Data in Object Array";&lt;br&gt;
rg = worksheet.Cells["A27"];&lt;br&gt;
rg.Value = oData;&amp;nbsp; // Result in spreadsheet: System.Object[,]&lt;br&gt;
worksheet.Cells["A28"].Value = oData;&amp;nbsp; // Result in spreadsheet: System.Object[,]&lt;br&gt;
worksheet.Cells["A29"].Value = "Data in Object Array";&amp;nbsp;// Result is as expected.&lt;/p&gt;
&lt;p&gt;Thank you.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="09/11/2010 07:40:35">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I have no support for setting multiple values using an array, but that is actully a good idea.&lt;/p&gt;
&lt;p&gt;I'll add it to my TODO list&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Duardo" When="09/11/2010 13:44:40">
          <Html>
        
&lt;div&gt;
&lt;p&gt;Thank you Jan.&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="trouble setting pagebreak">
      <Posts>
        <Post From="tzinser" When="04/11/2010 17:42:58">
          <Html>
        
&lt;p&gt;What is the proper way to set a pagebreak?&amp;nbsp; I've tried this:&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(0, 128, 0); font-size: x-small;"&gt;&lt;span style="color: rgb(0, 128, 0); font-size: x-small;"&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;ws.Row(row + 1).PageBreak = true;&lt;/p&gt;
&lt;font color="#0ac000" workitemlink"="" href="https://epplus.codeplex.com/workitem/008000"&gt;#008000" size="2"&amp;gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;/font&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&amp;nbsp;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div id="_mcePaste" style="left: -10000px; top: 0px; width: 1px; height: 1px; overflow: hidden;"&gt;
﻿&lt;/div&gt;
&lt;p&gt;And the break is not set.&amp;nbsp; Any input would be appreciated.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="05/11/2010 07:55:07">
          <Html>
        
&lt;p&gt;That is supposed to work, but I notised that you need to have at least one cell with a value on the row&amp;nbsp;you want to set the break on.&lt;/p&gt;
&lt;p&gt;I'll see if i can add a fix for this to the next version. For now, try to set one cell to a blank value, like ws.Cells[row+1,1].Value=null;&lt;/p&gt;
&lt;p&gt;If you still cant get it to work, post me your code.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="tzinser" When="05/11/2010 10:53:33">
          <Html>
        
&lt;div&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 11pt;"&gt;Thank you for your reply. That is exactly what I did and it is working.&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 11pt;"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 11pt;"&gt;Cheers,&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 11pt;"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;div&gt;
&lt;div style="border-width: 1pt medium medium; border-style: solid none none; border-color: rgb(181, 196, 223) currentColor currentColor; padding: 3pt 0in 0in; border-image: none;"&gt;
&lt;p&gt;&lt;b&gt;&lt;span style="font-family:; font-size: 10pt;"&gt;From:&lt;/span&gt;&lt;/b&gt;&lt;span style="font-family:; font-size: 10pt;"&gt; jankallman [mailto:notifications@codeplex.com]
&lt;br&gt;
&lt;b&gt;Sent:&lt;/b&gt; Friday, November 05, 2010 2:55 AM&lt;br&gt;
&lt;b&gt;To:&lt;/b&gt; Zinser, Terry&lt;br&gt;
&lt;b&gt;Subject:&lt;/b&gt; Re: trouble setting pagebreak [EPPlus:233506]&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 9pt;"&gt;From: jankallman&lt;/span&gt;&lt;/p&gt;
&lt;div id="ThreadNotificationPostBody" style="margin-bottom: 24pt;"&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 9pt;"&gt;That is supposed to work, but I notised that you need to have at least one cell with a value on the row you want to set the break on.&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 9pt;"&gt;I'll see if i can add a fix for this to the next version. For now, try to set one cell to a blank value, like ws.Cells[row+1,1].Value=null;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 9pt;"&gt;If you still cant get it to work, post me your code.&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 9pt;"&gt;Jan&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 9pt;"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id="ThreadNotificationFooter" style="border-width: 1pt medium medium; border-style: solid none none; border-color: rgb(204, 204, 204) currentColor currentColor; padding: 0in; border-image: none;"&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 9pt;"&gt;Read the &lt;a href="http://epplus.codeplex.com/Thread/View.aspx?ThreadId=233506&amp;amp;ANCHOR#Post517510" rel="nofollow"&gt;
full discussion online&lt;/a&gt;.&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 9pt;"&gt;To add a post to this discussion, reply to this email (&lt;a href="mailto:EPPlus@discussions.codeplex.com?subject=[EPPlus:233506]" rel="nofollow"&gt;EPPlus@discussions.codeplex.com&lt;/a&gt;)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 9pt;"&gt;To start a new discussion for this project, email
&lt;a href="mailto:EPPlus@discussions.codeplex.com" rel="nofollow"&gt;EPPlus@discussions.codeplex.com&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 9pt;"&gt;You are receiving this email because you subscribed to this discussion on CodePlex. You can
&lt;a href="http://www.codeplex.com/site/discussions/thread/unsubscribe/233506" rel="nofollow"&gt;unsubscribe&lt;/a&gt; on CodePlex.com.&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family:; font-size: 9pt;"&gt;Please note: Images and attachments will be removed from emails. Any posts to this discussion will also be available online at CodePlex.com&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Help to test the new version">
      <Posts>
        <Post From="jankallman" When="05/11/2010 08:32:01">
          <Html>
        
&lt;p&gt;Hi all!&lt;/p&gt;
&lt;p&gt;So, it's time for a new version again and I would really appreciate if I could get some help to test it all.&lt;/p&gt;
&lt;p&gt;Here's what is new...&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Charts now support multiple chart type series. You can add a new chart type serie by using the Chart.PlotArea.ChartTypes.Add method. This also enables the use of a secondary axis. Something like this...
&lt;/li&gt;&lt;/ul&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;            &lt;span style="color: blue;"&gt;var&lt;/span&gt; chartType2 = chart.PlotArea.ChartTypes.Add(eChartType.LineStacked);
            chartType2.UseSecondaryAxis = &lt;span style="color: blue;"&gt;true&lt;/span&gt;;&lt;/pre&gt;
&lt;/div&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;	Check out Sample9 to see how it's used. This required a lot of changes to the chart classes so please test it with your project to that it works as expected.&lt;/pre&gt;
&lt;/div&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span style="font-family: Consolas;"&gt;Encryption.&lt;/span&gt; Constructors and Save-methods now take a password as a parameter to read and write encrypted packages. Support for AES128 (default), ﻿﻿AES192 and AES256. Check out sample 10. If anyone
 uses Mono it would be intresting to hear if it works (I had to use a few API-functions to read and write the OLE-Compound document).
&lt;/li&gt;&lt;li&gt;Enumation of Cells collection to support Linq. Check out sample8 &lt;/li&gt;&lt;li&gt;Support for Array formulas. Range.﻿﻿﻿CreateArrayFormula.
&lt;/li&gt;&lt;li&gt;Tables. Sample 6 and 9 shows a little bit how it works. Do not support custom table styles yet.
&lt;/li&gt;&lt;li&gt;LoadFromText added to ExcelRange to read textfiles (only different csv formats at this point). Sample 9&amp;nbsp; shows how it works.
&lt;/li&gt;&lt;li&gt;LoadFromArrays &lt;/li&gt;&lt;/ul&gt;
&lt;/div&gt;
&lt;p&gt;All issues should also be fixed.&lt;/p&gt;
&lt;p&gt;If you find any bug, misspelling or other strange behavior report them here or send them directly to me.&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Chart Object">
      <Posts>
        <Post From="rajeevraina" When="02/11/2010 13:00:26">
          <Html>
        
&lt;p&gt;In case of Excel , I can export all the chartobjects as images (e.g. gif) to the local server directory using worksheet.chartobjects(i).chart.export(name,"GIF")&lt;/p&gt;
&lt;p&gt;Is there a similar facility available in EPPlus.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Regards&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="02/11/2010 18:30:38">
          <Html>
        
&lt;p&gt;No, there is no rendering of chart images&amp;nbsp;in EPPlus&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="rajeevraina" When="03/11/2010 11:07:21">
          <Html>
        Hi&lt;br&gt;
&lt;br&gt;
Thanks for your reply.&lt;br&gt;
&lt;br&gt;
Can you please suggest something by which I can generate an EXCEL as well save all my graph objects as images say "gif" on the server.&lt;br&gt;
&lt;br&gt;
I am able to do this using Excel Interop, but my client is not ready to install Excel on his servers.&lt;br&gt;
&lt;br&gt;
I am helpless.&lt;br&gt;
&lt;br&gt;
Regards&lt;br&gt;
&lt;br&gt;
Rajeev&lt;br&gt;
&lt;hr id="stopSpelling"&gt;
&lt;br&gt;
From: [email removed]&lt;br&gt;
To: [email removed]&lt;br&gt;
Date: Tue, 2 Nov 2010 10:30:41 -0700&lt;br&gt;
Subject: Re: Chart Object [EPPlus:233148]&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
From: jankallman&lt;br&gt;
&lt;div id="ecxThreadNotificationPostBody"&gt;No, there is no rendering of chart images in EPPlus&lt;br&gt;
Jan&lt;br&gt;
&lt;/div&gt;
&lt;div id="ecxThreadNotificationFooter"&gt;Read the &lt;a target="_blank"&gt;full discussion online&lt;/a&gt;.&lt;br&gt;
To add a post to this discussion, reply to this email (&lt;a target="_blank"&gt;EPPlus@discussions.codeplex.com&lt;/a&gt;)&lt;br&gt;
To start a new discussion for this project, email &lt;a target="_blank"&gt;EPPlus@discussions.codeplex.com&lt;/a&gt;&lt;br&gt;
You are receiving this email because you subscribed to this discussion on CodePlex. You can
&lt;a target="_blank"&gt;unsubscribe&lt;/a&gt; on CodePlex.com.&lt;br&gt;
Please note: Images and attachments will be removed from emails. Any posts to this discussion will also be available online at CodePlex.com&lt;br&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="03/11/2010 21:20:39">
          <Html>
        
&lt;p&gt;No, dont know any component that can do that.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="rajeevraina" When="04/11/2010 05:55:13">
          <Html>
        Hi&lt;br&gt;
&lt;br&gt;
Thanks for reply&lt;br&gt;
&lt;br&gt;
Regards&lt;br&gt;
&lt;br&gt;
Rajeev&lt;br&gt;
&lt;br&gt;
&lt;hr id="stopSpelling"&gt;
From: [email removed]&lt;br&gt;
To: [email removed]&lt;br&gt;
Date: Wed, 3 Nov 2010 13:52:33 -0700&lt;br&gt;
Subject: Re: Chart Object [EPPlus:233148]&lt;br&gt;
&lt;br&gt;
From: jankallman&lt;br&gt;
&lt;div id="ecxThreadNotificationPostBody"&gt;No, dont know any component that can do that.&lt;br&gt;
&lt;/div&gt;
&lt;div id="ecxThreadNotificationFooter"&gt;Read the &lt;a target="_blank"&gt;full discussion online&lt;/a&gt;.&lt;br&gt;
To add a post to this discussion, reply to this email (&lt;a target="_blank"&gt;EPPlus@discussions.codeplex.com&lt;/a&gt;)&lt;br&gt;
To start a new discussion for this project, email &lt;a target="_blank"&gt;EPPlus@discussions.codeplex.com&lt;/a&gt;&lt;br&gt;
You are receiving this email because you subscribed to this discussion on CodePlex. You can
&lt;a target="_blank"&gt;unsubscribe&lt;/a&gt; on CodePlex.com.&lt;br&gt;
Please note: Images and attachments will be removed from emails. Any posts to this discussion will also be available online at CodePlex.com&lt;br&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="New to this all.">
      <Posts>
        <Post From="Draconis_KOHF" When="29/10/2010 21:20:51">
          <Html>
        
&lt;p&gt;Hello, I am new to this stuff and I am using Visual Web Developer and coding in VB.&amp;nbsp; Are there any vb examples?&amp;nbsp; All i seem to find are C#.&lt;/p&gt;
&lt;p&gt;Does anyone have any vb code I can use? or help getting started. I think i can figure out the middle stuff from the c# examples, just need help getting started. like importing the dll file and starting the object.&amp;nbsp;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;For example, in C# it says "&lt;span style="color: rgb(0, 0, 255); font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-size: x-small;"&gt;using
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: x-small;"&gt;OfficeOpenXml;&lt;/span&gt;", well i tried to use "Import OfficeOpenXml" but it does not seem right.&amp;nbsp;&amp;nbsp; I have the dll file in my bin folder, but I am missing something else.&lt;/p&gt;
&lt;p&gt;So any vb examples would be helpful.&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="31/10/2010 16:34:36">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;No, sorry, I have no&amp;nbsp;VB samples, but here's some advice...&lt;/p&gt;
&lt;p&gt;Make sure you add a reference to the dll, using the Project / Add Reference menu (or what ever its called in VWD). Then you can add the Imports ﻿OfficeOpenXml.&lt;/p&gt;
&lt;p&gt;Now you are ready to use the component.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Save Output Formats">
      <Posts>
        <Post From="johnsgw" When="29/10/2010 21:02:33">
          <Html>
        
&lt;p&gt;Is it possible to save to other formats besides XLSX?&amp;nbsp; I am looking to save the output as a MHT (Web Archive or Single Web) file format.&lt;/p&gt;
&lt;p&gt;Thanks,&lt;/p&gt;
&lt;p&gt;Glenn&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="31/10/2010 16:23:33">
          <Html>
        
&lt;p&gt;No, XLSX only&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How can I format a cell as a percentage value ?">
      <Posts>
        <Post From="mrxrsd" When="26/10/2010 17:40:39">
          <Html>
        
&lt;p&gt;I've tried to open a xls file to discover how to do that but I only found a&amp;nbsp;builtinId="5" in my cell format. So, I try this:&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;ws.Cells[1,4].Style.Numberformat.BuildIn = &lt;span style="color: blue;"&gt;true&lt;/span&gt;; 

ws.Cells[1,4].Style.Numberformat.NumFmtID = 5;
&lt;/pre&gt;
&lt;pre&gt;&lt;br&gt;&lt;/pre&gt;
&lt;pre&gt;but BuildIn and NumFmtId are readonly. =/&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="26/10/2010 17:56:27">
          <Html>
        
&lt;p&gt;I found out, it was very simple...&lt;/p&gt;
&lt;p&gt;ws.Cells[1, 4].Style.Numberformat.Format = "#%";&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Shape Within a Chart">
      <Posts>
        <Post From="FoolishRaymond" When="25/10/2010 06:57:10">
          <Html>
        
&lt;p&gt;Hello,&lt;/p&gt;
&lt;p&gt;Thanks for the wonderful toolkit. I am having a problem with getting the shape bounded by a Chart. &amp;nbsp;How to manipulate such an object? It is not directly under Drawings in Worksheet.&lt;/p&gt;
&lt;p&gt;Thanks.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="26/10/2010 08:09:54">
          <Html>
        
&lt;p&gt;Sorry, no support for adding shapes inside a&amp;nbsp;chart in the current version.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title=".UsedRange .Find .FindNext">
      <Posts>
        <Post From="user168" When="14/10/2010 23:14:23">
          <Html>
        
&lt;p&gt;I didn't find any functions that look like Excel's UsedRange, Find, FindNext functions. Are these in the plan?&lt;/p&gt;
&lt;p&gt;T&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="15/10/2010 07:46:26">
          <Html>
        
&lt;p&gt;No there is no support for that, but the next version will have Linq support to make it easier to search a sheet.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="user168" When="21/10/2010 10:52:56">
          <Html>
        
&lt;p&gt;That's great, when would the Linq support be available?&lt;/p&gt;
&lt;p&gt;In addition, how about Excel's Range.Validation function?&lt;/p&gt;
&lt;p&gt;T&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="21/10/2010 22:06:14">
          <Html>
        
&lt;p&gt;Its available if you download the source, but If you want it in a real version I hope within a month.&lt;/p&gt;
&lt;p&gt;Theres no support for datavalidation yet.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Embedded Excel object">
      <Posts>
        <Post From="jamarpa" When="15/10/2010 23:45:15">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Has anyone tried using epplus with an embedded excel object in word?&lt;/p&gt;
&lt;p&gt;Ta&lt;/p&gt;
&lt;p&gt;James&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="20/10/2010 16:21:11">
          <Html>
        
&lt;p&gt;I have not tried if it works. Did you have a problem with it?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jamarpa" When="20/10/2010 21:28:03">
          <Html>
        
&lt;p&gt;not yet, just planning ahead. Trying to convince my manager that we need to upgrade the excel2002 vba report compilers to 2007/10&lt;/p&gt;
&lt;p&gt;Will be having a play with this probably on the weekend.&lt;/p&gt;
&lt;p&gt;Shall update when I have some findings.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Default font or style for a sheet.">
      <Posts>
        <Post From="ericoldre" When="19/10/2010 22:49:10">
          <Html>
        
&lt;p&gt;How would one set a default font for an entire sheet or workbook? Setting a style for a range of cells is easy enough, but then once the user scrolls past the range that you entered the font information for and begins typing they are back to using the default
 font (which on my setup seems to be calibrini 11 pt.&lt;/p&gt;
&lt;p&gt;Thanks,&lt;/p&gt;
&lt;p&gt;Eric&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="20/10/2010 16:28:29">
          <Html>
        
&lt;p&gt;Something like...&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A:XFD"&lt;/span&gt;].Style.Font.Name = &lt;span style="color: rgb(163, 21, 21);"&gt;"Arial"&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;I think there is some code like this in the&amp;nbsp;Sample 7&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Line - Column chart on 2 axes">
      <Posts>
        <Post From="Watcher01" When="13/10/2010 13:17:55">
          <Html>
        
&lt;p&gt;Hi All,&lt;/p&gt;
&lt;p&gt;Firts of all, I want to thank you Jan for wonderfull job.&lt;/p&gt;
&lt;p&gt;I`ve got a question: Is there any way to create column-line chart with two data series and two separate Y axes?&lt;/p&gt;
&lt;p&gt;Someting like native excel Line - Column on 2 Axes.&lt;/p&gt;
&lt;p&gt;Column -line type is not necessary, it could be&amp;nbsp;line - line,&amp;nbsp;etc.&lt;/p&gt;
&lt;p&gt;This feature is a must for me.&lt;/p&gt;
&lt;p&gt;BR&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="13/10/2010 18:12:14">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;You can't create&amp;nbsp;two Y axis from code, but you can create a template with a chart that has two Y-axis (if that is an option for you).&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="watcher01" When="13/10/2010 20:20:03">
          <Html>
        
&lt;p&gt;Thanks for a quick reply, Jan.&lt;br&gt;
Let`s say that I have dynamically created worksheet - I don`t know exactly how many tables or charts application will have to generate .&lt;br&gt;
Or where will they be placed on the worksheet. It`s all depends on user.&lt;br&gt;
Could I still use template to generate two axes in such a case?&lt;/p&gt;
&lt;p&gt;I`m asking cause I don`t know if template determines position of chart, starting rows for data, etc.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="15/10/2010 07:44:47">
          <Html>
        
&lt;p&gt;I guess you could create a template and copy the worksheet containing the chart and the position it (if you dont have multiple charts per sheet).&lt;/p&gt;
&lt;p&gt;It not a good solution and I'm not sure if it will work.&lt;/p&gt;
&lt;p&gt;I'm not sure how hard it&amp;nbsp;would be to add multi&amp;nbsp;Y-axis support to the&amp;nbsp;library, but that is&amp;nbsp;the&amp;nbsp;best solution. I'm currently working on the charts, so I can have a look. If it's easy i'll add it.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="watcher01" When="15/10/2010 19:05:53">
          <Html>
        
&lt;p&gt;Thanks Jan. This type of chart is a basic for analytic work.&lt;/p&gt;
&lt;p&gt;My temporary solution for this is pasting in worksheet pics coming from flash chart web control,&lt;/p&gt;
&lt;p&gt;tables are still generating from epplus.&lt;/p&gt;
&lt;p&gt;Client also decided to use bubble charts, but I`ve managed to change &lt;span id="result_box" lang="en"&gt;
&lt;span&gt;requirements to scatter ;)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span lang="en"&gt;&lt;span&gt;I just want to use your awesome library. &lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span lang="en"&gt;&lt;span&gt;Thanks again for your work.&lt;br&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jamarpa" When="15/10/2010 23:43:33">
          <Html>
        
&lt;blockquote style="margin: 0.25em 1em 0px; padding: 0px 0.25em; border: 0.1em solid rgb(204, 204, 204); border-image: none; font-style: italic;"&gt;
&lt;strong&gt;watcher01 wrote:&lt;/strong&gt;&lt;br&gt;
&lt;p&gt;Thanks Jan. This type of chart is a basic for analytic work.&lt;/p&gt;
&lt;p&gt;My temporary solution for this is pasting in worksheet pics coming from flash chart web control,&lt;/p&gt;
&lt;p&gt;tables are still generating from epplus.&lt;/p&gt;
&lt;p&gt;Client also decided to use bubble charts, but I`ve managed to change &lt;span id="result_box" lang="en"&gt;
&lt;span&gt;requirements to scatter ;)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span lang="en"&gt;&lt;span&gt;I just want to use your awesome library.&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span lang="en"&gt;&lt;span&gt;Thanks again for your work.&lt;br&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Interesting regarding the flash chart web control. Which web control are you using and could you post a small code sample?&lt;/p&gt;
&lt;p&gt;Ta&lt;/p&gt;
&lt;p&gt;James&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Hard to read empty cells -- suggest new Text property">
      <Posts>
        <Post From="eugene55" When="13/10/2010 06:08:54">
          <Html>
        
&lt;p&gt;I am reading a spreadsheet where many of the cells can be empty.&amp;nbsp; Cells[x,x].Value returns null and I would have to add code to handle this case when I don't really care.&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I would like to suggest adding&amp;nbsp;the "Text" property to excelRangeBase.cs as follows&lt;/p&gt;
&lt;p&gt;&lt;span style="font-size: x-small;"&gt;&lt;span style="font-size: x-small;"&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;span style="color: gray;"&gt;///&lt;/span&gt;
&lt;span style="color: gray;"&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;span style="color: gray;"&gt;///&lt;/span&gt;&lt;span style="color: green;"&gt; Get/set the text value of a Cell.&amp;nbsp; Return "" instead of null for empty cells&lt;/span&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;span style="color: gray;"&gt;///&lt;/span&gt; &lt;span style="color: gray;"&gt;
&amp;lt;/summary&amp;gt;&lt;/span&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;span style="color: blue;"&gt;public&lt;/span&gt;
&lt;span style="color: blue;"&gt;string&lt;/span&gt; Text {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;span style="color: blue;"&gt;
get&lt;/span&gt; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
&lt;span style="color: blue;"&gt;object&lt;/span&gt; o = _worksheet.Cell(_fromRow, _fromCol).Value;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
&lt;span style="color: blue;"&gt;if&lt;/span&gt; (o == &lt;span style="color: blue;"&gt;null&lt;/span&gt;) {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
&lt;span style="color: blue;"&gt;return&lt;/span&gt; &lt;span style="color: rgb(163, 21, 21);"&gt;""&lt;/span&gt;;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
&lt;span style="color: blue;"&gt;return&lt;/span&gt; o.ToString();&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;span style="color: blue;"&gt;
set&lt;/span&gt; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Value = value;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;/p&gt;
&lt;p&gt;&lt;span style="font-size: x-small;"&gt;&lt;/span&gt;..Eugene..&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="13/10/2010 18:05:53">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;The next version will add an enumerator to the ExcelRange class. You can then use a foreach-loop or Linq to iterate only created cells.&lt;/p&gt;
&lt;p&gt;Something like this to get all created cells from column A...&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;foreach&lt;/span&gt;(&lt;span style="color: blue;"&gt;var&lt;/span&gt; cell &lt;span style="color: blue;"&gt;in&lt;/span&gt; worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A:A"&lt;/span&gt;])

...&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Check out the the new Linq sample in the source.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="eugene55" When="13/10/2010 18:46:43">
          <Html>
        
&lt;p&gt;I am looking forward to the new version.&amp;nbsp; You have done a fantastic job with this.&lt;/p&gt;
&lt;p&gt;If possible, I would like you to add "Text" to your main-line code.&amp;nbsp; I suspect it will be handy for a lot of other users as well.&lt;/p&gt;
&lt;p&gt;I am using an Excel spreadsheet as the backing store for a small highly structured database.&amp;nbsp; There are a lot of reasons for doing this.&amp;nbsp; First and formost it's easy for the user.&amp;nbsp; Nothing more to install (SQL, Access, Jet, etc...)&amp;nbsp; The
 biggest benefit is&amp;nbsp;that&amp;nbsp;the user can update their data using Excel instead of the more limited (one record at a time) GUI of the application -- things like "search &amp;amp; replace" are possible.&amp;nbsp; The user can also use complex formulas
 to transform the data if needed.&amp;nbsp; BUT, manual editing&amp;nbsp;results in blank cells.&amp;nbsp; The "Text" technique is perfect for quickly reading the data in a predictable way.&lt;/p&gt;
&lt;p&gt;In the past, using Microsoft's tools, I have to either wrap&amp;nbsp;their code&amp;nbsp;in a new class, or call a method to handle the null or other problems with the cell data.&amp;nbsp; With access to the source code, it's nice to just add a property that does exactly
 what I need -- much as one does with their own code.&lt;/p&gt;
&lt;p&gt;..Eugene..&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="15/10/2010 07:49:58">
          <Html>
        
&lt;p&gt;OK, I'll see what&amp;nbsp;I can do&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Excel displays 'save changes' dialogue when closing a generated file.">
      <Posts>
        <Post From="Kentari" When="07/10/2010 17:08:25">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;First of all I'd like to thank you for this splendid library. The users of my app and I greatly appreciate the speed and independence of MS Office when using it.&lt;/p&gt;
&lt;p&gt;There is one issue that can be bothersome. When a user uses Excel to read a generated file and closes it again, Excel will display a 'Save Changes' dialogue even when no changes were made. Some of my users generate hundreds of files on a day which all have
 to be verified. These are test reports and have to be verified manually. I also see the same dialogue when opening and closing files generated by the sample code. When I inspect the extracted XML files I see that Excel added files (docprops and theme) and
 changed the worksheets.&lt;/p&gt;
&lt;p&gt;Is it possible to avoid the 'Save Changes' dialogue and/or these changes?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Best regards,&lt;/p&gt;
&lt;p&gt;Koen&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="11/10/2010 06:54:39">
          <Html>
        
&lt;p&gt;&lt;span lang="EN-US" style="color: black; font-size: 10pt;"&gt;No, I don't think so. EPPlus rely on Excel to calculate all formulas, so Excel will recreate all calculations chains when the document is loaded the first time.
&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span lang="EN-US" style="color: black; font-size: 10pt;"&gt;Also, as you say, Excel creates themes and doc-properties&amp;nbsp;and properly some other stuff. The only way I can think of avoiding it is to use a signed template with a macro that saves on startup (I
 have not tried it myself), but that is not the most pretty solution :)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span lang="EN-US" style="color: black; font-size: 10pt;"&gt;Jan&lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Kentari" When="12/10/2010 17:18:34">
          <Html>
        
&lt;p&gt;Thanks for your response. I guess we will have to live with it! The advantages of EPPlus far outweigh this inconvenience.&lt;/p&gt;
&lt;p&gt;Koen&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Delete cell range?">
      <Posts>
        <Post From="juxtaposed" When="08/10/2010 22:23:29">
          <Html>
        
&lt;p&gt;I saw the worksheet.DeleteRow() method, but I couldn't find anything that allowed the user to delete a certain range of cells. Like I9:J15. Is that possible, or planned for a future release?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jamarpa" When="09/10/2010 05:29:41">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Range("I9:J15").Delete equals Cells["I9:J15"].Value = null;&lt;/p&gt;
&lt;p&gt;but&lt;/p&gt;
&lt;p&gt;Range("I9:J15").Delete xlShiftup&lt;/p&gt;
&lt;p&gt;would require a bit of work. Not certain of &lt;a href="http://www.codeplex.com/site/users/view/jankallman" rel="nofollow"&gt;
jankallman&lt;/a&gt;'s plans for this.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;James&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="11/10/2010 18:47:15">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I have added a Clear method to the ExcelRange class. It deletes the cells but do not shift any cells.&lt;/p&gt;
&lt;p&gt;I hope I can add that to a future version, but it will not be in&amp;nbsp;the the next one.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Chart Axis Scaling">
      <Posts>
        <Post From="FoolishRaymond" When="07/10/2010 16:07:24">
          <Html>
        
&lt;div&gt;
&lt;p style="font-size: 11pt;"&gt;&lt;span style="font-size: 10pt;"&gt;Hello&lt;/span&gt;&lt;/p&gt;
&lt;p style="font-size: 11pt;"&gt;&lt;span style="font-size: medium;"&gt;&lt;span style="font-size: 15px;"&gt;I was trying to code up a chart with the max/min scaling on the axis specified. The following code was something I came up, but it didn't work. It corrupted the spreadsheet.
 Did I miss something?&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style="font-size: 11pt;"&gt;&lt;span style="font-size: medium;"&gt;&lt;span style="font-size: 15px;"&gt;Thanks&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style="font-size: 11pt;"&gt;&lt;span style="font-size: medium;"&gt;&lt;span style="font-size: 15px;"&gt;&lt;br&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style="font-size: 11pt;"&gt;&lt;span style="font-size: 10pt;"&gt;&lt;span style="color: blue;"&gt;const&lt;/span&gt;&amp;nbsp;&lt;span style="color: blue;"&gt;string&lt;/span&gt;&amp;nbsp;_scalingPos =&amp;nbsp;&lt;span style="color: rgb(163, 21, 21);"&gt;"c:scaling/c:min/@val"&lt;/span&gt;;&lt;/span&gt;&lt;/p&gt;
&lt;p style="font-size: 11pt;"&gt;&lt;span style="font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span style="color: blue;"&gt;public&lt;/span&gt;&amp;nbsp;&lt;span style="color: blue;"&gt;int&lt;/span&gt;&amp;nbsp;Scaling&lt;/span&gt;&lt;/p&gt;
&lt;p style="font-size: 11pt;"&gt;&lt;span style="font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;/span&gt;&lt;/p&gt;
&lt;p style="font-size: 11pt;"&gt;&lt;span style="font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span style="color: blue;"&gt;get&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style="font-size: 11pt;"&gt;&lt;span style="font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;/span&gt;&lt;/p&gt;
&lt;p style="font-size: 11pt;"&gt;&lt;span style="font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span style="color: blue;"&gt;return&lt;/span&gt;&amp;nbsp;GetXmlNodeInt(_scalingPos);&lt;/span&gt;&lt;/p&gt;
&lt;p style="font-size: 11pt;"&gt;&lt;span style="font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;/span&gt;&lt;/p&gt;
&lt;p style="font-size: 11pt;"&gt;&lt;span style="font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span style="color: blue;"&gt;set&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style="font-size: 11pt;"&gt;&lt;span style="font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;/span&gt;&lt;/p&gt;
&lt;p style="font-size: 11pt;"&gt;&lt;span style="font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; SetXmlNodeString(_scalingPos,&amp;nbsp;&lt;span style="color: blue;"&gt;value&lt;/span&gt;.ToString());&lt;/span&gt;&lt;/p&gt;
&lt;p style="font-size: 11pt;"&gt;&lt;span style="font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;/span&gt;&lt;/p&gt;
&lt;p style="font-size: 11pt;"&gt;&lt;span style="font-size: 10pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;/span&gt;&lt;/p&gt;
&lt;div&gt;&lt;span style="font-size: 10pt;"&gt;&lt;br&gt;
&lt;/span&gt;&lt;/div&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="jamarpa" When="10/10/2010 03:43:15">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Have a look at&amp;nbsp;the patch that is in "&lt;span&gt;&lt;a title='"converter failed to save the file xlsx' href="http://epplus.codeplex.com/Thread/View.aspx?ThreadId=228536" rel="nofollow"&gt;converter failed to save the file xlsx&lt;/a&gt;" and change Scaling to float.&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;James&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;&lt;/div&gt;

&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="foolishraymond" When="10/10/2010 12:04:47">
          <Html>
        
&lt;p&gt;Hi James,&lt;/p&gt;
&lt;p&gt;Thanks for the reply.&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I am afraid that the data type change doesn't help. When I tried to diff the raw Chart1.xml, I found that problem was due to an extra node added under&amp;nbsp;&amp;lt;c:catAx&amp;gt;:&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;lt;c:txPr&amp;gt;&lt;span&gt; &lt;/span&gt;&amp;lt;a:bodyPr/&amp;gt;&lt;span&gt; &lt;/span&gt;&amp;lt;a:lstStyle/&amp;gt;&lt;span&gt;
&lt;/span&gt;&amp;lt;/c:txPr&amp;gt;.&lt;/p&gt;
&lt;p&gt;This catAx has nothing to do with the scaling I was working on. That is located under valAx.&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;The whole node:
			&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;c&lt;/span&gt;&lt;span style="color: blue;"&gt;:&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;catAx&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
				&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;c&lt;/span&gt;&lt;span style="color: blue;"&gt;:&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;axId&lt;/span&gt; &lt;span style="color: red;"&gt;val&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;267621504&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;/&amp;gt;&lt;/span&gt;
				&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;c&lt;/span&gt;&lt;span style="color: blue;"&gt;:&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;scaling&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
					&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;c&lt;/span&gt;&lt;span style="color: blue;"&gt;:&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;orientation&lt;/span&gt; &lt;span style="color: red;"&gt;val&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;minMax&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;/&amp;gt;&lt;/span&gt;
				&lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;c&lt;/span&gt;&lt;span style="color: blue;"&gt;:&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;scaling&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
				&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;c&lt;/span&gt;&lt;span style="color: blue;"&gt;:&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;delete&lt;/span&gt; &lt;span style="color: red;"&gt;val&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;1&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;/&amp;gt;&lt;/span&gt;
				&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;c&lt;/span&gt;&lt;span style="color: blue;"&gt;:&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;axPos&lt;/span&gt; &lt;span style="color: red;"&gt;val&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;b&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;/&amp;gt;&lt;/span&gt;
				&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;c&lt;/span&gt;&lt;span style="color: blue;"&gt;:&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;tickLblPos&lt;/span&gt; &lt;span style="color: red;"&gt;val&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;none&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;/&amp;gt;&lt;/span&gt;
				&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;c&lt;/span&gt;&lt;span style="color: blue;"&gt;:&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;crossAx&lt;/span&gt; &lt;span style="color: red;"&gt;val&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;267619712&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;/&amp;gt;&lt;/span&gt;
				&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;c&lt;/span&gt;&lt;span style="color: blue;"&gt;:&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;crosses&lt;/span&gt; &lt;span style="color: red;"&gt;val&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;autoZero&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;/&amp;gt;&lt;/span&gt;
				&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;c&lt;/span&gt;&lt;span style="color: blue;"&gt;:&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;auto&lt;/span&gt; &lt;span style="color: red;"&gt;val&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;1&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;/&amp;gt;&lt;/span&gt;
				&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;c&lt;/span&gt;&lt;span style="color: blue;"&gt;:&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;lblAlgn&lt;/span&gt; &lt;span style="color: red;"&gt;val&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;ctr&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;/&amp;gt;&lt;/span&gt;
				&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;c&lt;/span&gt;&lt;span style="color: blue;"&gt;:&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;lblOffset&lt;/span&gt; &lt;span style="color: red;"&gt;val&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;100&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;/&amp;gt;&lt;/span&gt;
&lt;span style="color: rgb(0, 255, 0);"&gt;&lt;strong&gt;&lt;em&gt;				&amp;lt;c:txPr&amp;gt;
					&amp;lt;a:bodyPr/&amp;gt;
					&amp;lt;a:lstStyle/&amp;gt;
				&amp;lt;/c:txPr&amp;gt;&lt;/em&gt;&lt;/strong&gt;&lt;/span&gt;
			&lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;c&lt;/span&gt;&lt;span style="color: blue;"&gt;:&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;catAx&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
After I removed the green part and packed it back to the xlsx file, it worked and the scaling was changed.&amp;nbsp;
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="&quot;converter failed to save the file xlsx&quot;">
      <Posts>
        <Post From="jamarpa" When="25/09/2010 03:48:35">
          <Html>
        
&lt;p&gt;Hi James here,&lt;/p&gt;
&lt;p&gt;Not certain if this is known about, I couldn't find anything refering to it in the discussions.&lt;/p&gt;
&lt;p&gt;Thought I would try out epplus on a C# app to create a report based on a xlsx template. Worked for a while then just as I was about to deliver (of course) the error reared its ugly head when reading report into 2003.&lt;/p&gt;
&lt;p&gt;The error report pointed to 'Repaired Records: Font from /xl/styles.xml part (Styles)'&lt;/p&gt;
&lt;p&gt;After a bit of comparing between the original template, the erronous file and a fixed file I found the following xml.&lt;/p&gt;
&lt;p&gt;Original --------------------8&amp;lt;----------------------------&lt;/p&gt;
&lt;p&gt;&amp;lt;font&amp;gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;lt;b /&amp;gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;lt;sz val="&lt;strong&gt;8.5&lt;/strong&gt;" /&amp;gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;lt;color indexed="30" /&amp;gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;lt;name val="MS Sans Serif" /&amp;gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;lt;family val="2" /&amp;gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;lt;/font&amp;gt;&lt;/p&gt;
&lt;p&gt;Erronous --------------------8&amp;lt;----------------------------&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;lt;font&amp;gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;lt;d:b xmlns:d="http://schemas.openxmlformats.org/spreadsheetml/2006/main" /&amp;gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;lt;d:sz val="&lt;strong&gt;-2.147484E+09&lt;/strong&gt;" xmlns:d="http://schemas.openxmlformats.org/spreadsheetml/2006/main" /&amp;gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;lt;d:color indexed="30" xmlns:d="http://schemas.openxmlformats.org/spreadsheetml/2006/main" /&amp;gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;lt;d:name val="MS Sans Serif" xmlns:d="http://schemas.openxmlformats.org/spreadsheetml/2006/main" /&amp;gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;lt;d:family val="2" xmlns:d="http://schemas.openxmlformats.org/spreadsheetml/2006/main" /&amp;gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;lt;/font&amp;gt;&lt;/p&gt;
&lt;p&gt;Fixed --------------------8&amp;lt;----------------------------&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;lt;font&amp;gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;lt;b /&amp;gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;lt;sz val="&lt;strong&gt;1&lt;/strong&gt;" /&amp;gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;lt;color indexed="30" /&amp;gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;lt;name val="MS Sans Serif" /&amp;gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;lt;family val="2" /&amp;gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;lt;/font&amp;gt;&lt;/p&gt;
&lt;p&gt;--------------------8&amp;lt;----------------------------&lt;/p&gt;
&lt;p&gt;Changed any .5 fonts to whole and no more problems.&lt;/p&gt;
&lt;p&gt;Ta, keep up the good work,&lt;/p&gt;
&lt;p&gt;James&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;ps I would look further into the code to see why but I just got in trouble for working when on holidays :)&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="27/09/2010 07:16:17">
          <Html>
        
&lt;p&gt;OK, thanx, i'll have a look at it&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jamarpa" When="10/10/2010 03:15:50">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Had another look at this one and just incase you have not been able to look at it, here is my patch. Although I am sure you could see the problem from the data above.&lt;/p&gt;
&lt;p&gt;I added to XMLHelper.cs&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;        &lt;span style="color: blue;"&gt;internal&lt;/span&gt; &lt;span style="color: blue;"&gt;float&lt;/span&gt; GetXmlNodeFloat(&lt;span style="color: blue;"&gt;string&lt;/span&gt; path)
        {
            &lt;span style="color: blue;"&gt;float&lt;/span&gt; d;
            &lt;span style="color: blue;"&gt;if&lt;/span&gt; (&lt;span style="color: blue;"&gt;float&lt;/span&gt;.TryParse(GetXmlNodeString(path), &lt;span style="color: blue;"&gt;out&lt;/span&gt; d))
            {
                &lt;span style="color: blue;"&gt;return&lt;/span&gt; d;
            }
            &lt;span style="color: blue;"&gt;else&lt;/span&gt;
            {
                &lt;span style="color: blue;"&gt;return&lt;/span&gt; 0;
            }
        }
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;and replaced&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;_size = GetXmlNodeInt(sizePath);
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;with&lt;/p&gt;
&lt;p&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt; _size = GetXmlNodeFloat(sizePath);
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;don't know if that would break anything else?&lt;/p&gt;
&lt;p&gt;ta&lt;/p&gt;
&lt;p&gt;James&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jamarpa" When="10/10/2010 03:55:51">
          <Html>
        
&lt;p&gt;oops, fixed in &lt;a title="View change set 67074" id="ChangeSetLink0" style="font-weight: bold;" href="http://epplus.codeplex.com/SourceControl/changeset/changes/67074" rel="nofollow"&gt;
67074&lt;/a&gt;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Get Access to Textbox (Drawing)">
      <Posts>
        <Post From="Seraphim" When="08/10/2010 14:15:10">
          <Html>
        
&lt;p&gt;Hello,&lt;/p&gt;
&lt;p&gt;My Problem is - i use a Template File. In this template is a Textbox (Product), wich is need to be filled.&lt;/p&gt;
&lt;p&gt;So The Problem is, what way is there to get Access to is.&lt;/p&gt;
&lt;p&gt;// My Worksheet&lt;/p&gt;
&lt;p&gt;ExcelWorksheet ws = p.Workbook.Worksheets[1];&lt;/p&gt;
&lt;p&gt;&amp;nbsp;ws.Drawings. ..... Or&amp;nbsp;ws.Drawings.DrawingXml...&lt;/p&gt;
&lt;p&gt;I Don't know.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Maybe u can Help me.&lt;/p&gt;
&lt;p&gt;Greetings&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jamarpa" When="09/10/2010 04:20:54">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Somehow felt this was a upcoming problem for me also so had a quick look.&lt;/p&gt;
&lt;p&gt;Found Drawings.ExcelDrawings.AddDrawings() only checked the //xdr:twoCellAnchor nodes.&lt;/p&gt;
&lt;p&gt;Not certain if this is the correct way to handle textboxs but by changing to&lt;/p&gt;
&lt;p&gt;-------------8&amp;lt;-----------------------------------&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; private void AddDrawings()&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; string[] _selectNodes = { "//xdr:oneCellAnchor", "//xdr:twoCellAnchor" };&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; foreach (string sn in _selectNodes)&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; XmlNodeList list = _drawingsXml.SelectNodes(sn, NameSpaceManager);&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; foreach (XmlNode node in list)&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ExcelDrawing dr = ExcelDrawing.GetDrawing(this, node);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; _drawings.Add(dr);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; if (!_drawingNames.ContainsKey(dr.Name.ToLower()))&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; _drawingNames.Add(dr.Name.ToLower(), _drawings.Count - 1);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; list = null;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;/p&gt;
&lt;p&gt;-------------8&amp;lt;-----------------------------------&lt;/p&gt;
&lt;p&gt;I can access a textbox with&lt;/p&gt;
&lt;p&gt;-------------8&amp;lt;-----------------------------------&lt;/p&gt;
&lt;p&gt;&amp;nbsp;using (ExcelPackage package = new ExcelPackage(newFile, templateFile))&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; foreach (ExcelWorksheet ws in package.Workbook.Worksheets)&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; listBox1.Items.Add("Worksheet.Name: "+ ws.Name);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; foreach (ExcelDrawing dw in ws.Drawings)&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; string dwType = dw.GetType().ToString();&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; string dwName = dw.Name.ToString();&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; listBox1.Items.Add("&amp;nbsp;&amp;nbsp;&amp;nbsp; Drawing.Name: " + dw.Name);&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; var rt = (ws.Drawings[dw.Name] as ExcelShape);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; if (rt != null) // not a ExcelShape&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; listBox1.Items.Add("&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
 Drawing.Text: " + rt.Text);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; // save our new workbook and we are done!&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; package.Save();&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; templateFile = null;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;/p&gt;
&lt;p&gt;-------------8&amp;lt;-----------------------------------&lt;/p&gt;
&lt;p&gt;My apologies for not using 'Insert Snippet'. Wouldn't work in my firefox? noscript blocking XSS I think.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;James&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Creating a table">
      <Posts>
        <Post From="mr_miles" When="06/10/2010 17:29:40">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I was trying to define tables in a spreadsheet using EPPlus, but I've come up against a few bugs.&amp;nbsp; I am going to send you a patch for them, but just wanted to check whether you'd already addressed any of them:&lt;/p&gt;
&lt;p&gt;&amp;nbsp;+ When using the LoadFromDataTable method to add a Table, the&amp;nbsp;range that epplus selects&amp;nbsp;has 1 more column than&amp;nbsp;it should have&lt;/p&gt;
&lt;p&gt;&amp;nbsp;+ Setting the rowstripe to hidden causes an error at save time&lt;/p&gt;
&lt;p&gt;&amp;nbsp;+ Excel complains about the display name if it contains non alphanumberic characters&lt;/p&gt;
&lt;p&gt;&amp;nbsp;+ Excel complains if you don't set a style because EPPlus leaves the attribute blank&lt;/p&gt;
&lt;p&gt;&amp;nbsp;+ When adding a table, there is no common store of TableID is not incremented, so if a spreadsheet contains more than one table there is an error at save time.&amp;nbsp; Excel appears to scope tables to the workbook, so the table Ids have to be unique
 across the whole thing. EPPlus assumes they are unique in the worksheet.&lt;/p&gt;
&lt;p&gt;As I say, I'm happy to sort out patches for all of these if it's no trouble/not duplicating anything else.&lt;/p&gt;
&lt;p&gt;Thanks for a great library!&lt;/p&gt;
&lt;p&gt;Miles&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="07/10/2010 06:29:35">
          <Html>
        
&lt;p&gt;Great!, thanks&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Relative Uri's in Cell Hyperlinks">
      <Posts>
        <Post From="oazevedo" When="30/09/2010 12:22:55">
          <Html>
        
&lt;p&gt;Hi Jan,&lt;/p&gt;
&lt;p&gt;I had a requirement to add hyperlinks pointing to files/folders located on the same folder as the excel file I have was creating.&lt;/p&gt;
&lt;p&gt;By the latest source of EPPlus (66455) this is not possible because Hyperlink property is expecting an absolute Uri.&lt;/p&gt;
&lt;p&gt;I've made the required modifications on source code to acomplish my requirement and want to share it with you, so you can replicate it to EPPlus.&lt;/p&gt;
&lt;p&gt;Modifications on&amp;nbsp;file ExcelCell.cs:&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;public&lt;/span&gt; Uri Hyperlink
{
	&lt;span style="color: blue;"&gt;get&lt;/span&gt;
	{				
		&lt;span style="color: blue;"&gt;return&lt;/span&gt; (_hyperlink);
	}
	&lt;span style="color: blue;"&gt;set&lt;/span&gt;
	{
		_hyperlink = value;
		&lt;span style="color: blue;"&gt;if&lt;/span&gt; ((Value == &lt;span style="color: blue;"&gt;null&lt;/span&gt; || Value.ToString() == &lt;span style="color: rgb(163, 21, 21);"&gt;""&lt;/span&gt;))
		{
			&lt;span style="color: blue;"&gt;if&lt;/span&gt; (value &lt;span style="color: blue;"&gt;is&lt;/span&gt; ExcelHyperLink)
			{
				Value = (value &lt;span style="color: blue;"&gt;as&lt;/span&gt; ExcelHyperLink).Display;
			}
			&lt;span style="color: blue;"&gt;else&lt;/span&gt;
			{
				&lt;span style="color: green;"&gt;//test for absolute or relative URL&lt;/span&gt;
				&lt;span style="color: blue;"&gt;if&lt;/span&gt; (_hyperlink.IsAbsoluteUri)
					Value = _hyperlink.AbsoluteUri;
				&lt;span style="color: blue;"&gt;else&lt;/span&gt;
					Value = _hyperlink.OriginalString;
			}
		}
	}
}

&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Modifications on file ExcelWorksheet.cs:&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;private&lt;/span&gt; &lt;span style="color: blue;"&gt;void&lt;/span&gt; UpdateHyperLinks(StreamWriter sw)
{
		sw.Write(&lt;span style="color: rgb(163, 21, 21);"&gt;"&amp;lt;hyperlinks&amp;gt;"&lt;/span&gt;);
		Dictionary&amp;lt;&lt;span style="color: blue;"&gt;string&lt;/span&gt;, &lt;span style="color: blue;"&gt;string&lt;/span&gt;&amp;gt; hyps = &lt;span style="color: blue;"&gt;new&lt;/span&gt; Dictionary&amp;lt;&lt;span style="color: blue;"&gt;string&lt;/span&gt;, &lt;span style="color: blue;"&gt;string&lt;/span&gt;&amp;gt;();
		&lt;span style="color: blue;"&gt;foreach&lt;/span&gt; (&lt;span style="color: blue;"&gt;ulong&lt;/span&gt; cellId &lt;span style="color: blue;"&gt;in&lt;/span&gt; _hyperLinkCells)
		{
			ExcelCell cell = _cells[cellId] &lt;span style="color: blue;"&gt;as&lt;/span&gt; ExcelCell;
			&lt;span style="color: blue;"&gt;if&lt;/span&gt; (cell.Hyperlink &lt;span style="color: blue;"&gt;is&lt;/span&gt; ExcelHyperLink &amp;amp;&amp;amp; (cell.Hyperlink &lt;span style="color: blue;"&gt;as&lt;/span&gt; ExcelHyperLink).ReferenceAddress != &lt;span style="color: rgb(163, 21, 21);"&gt;""&lt;/span&gt;)
			{
				ExcelHyperLink hl = cell.Hyperlink &lt;span style="color: blue;"&gt;as&lt;/span&gt; ExcelHyperLink;
				sw.Write(&lt;span style="color: rgb(163, 21, 21);"&gt;"&amp;lt;hyperlink ref=\"{0}\" location=\"{1}\" display=\"{2}\" /&amp;gt;"&lt;/span&gt;, 
						Cells[cell.Row, cell.Column, cell.Row+hl.RowSpann, cell.Column+hl.ColSpann].Address, 
						ExcelCell.GetFullAddress(Name, hl.ReferenceAddress),
						SecurityElement.Escape(hl.Display));

			}
			&lt;span style="color: blue;"&gt;else&lt;/span&gt;
			{
				&lt;span style="color: blue;"&gt;string&lt;/span&gt; id;
				&lt;span style="color: green;"&gt;//test for absolute or relative URL&lt;/span&gt;
				&lt;span style="color: blue;"&gt;if&lt;/span&gt; (cell.Hyperlink.IsAbsoluteUri &amp;amp;&amp;amp; hyps.ContainsKey(cell.Hyperlink.AbsolutePath))
				{
					id = hyps[cell.Hyperlink.AbsolutePath];
				}
				&lt;span style="color: blue;"&gt;else&lt;/span&gt; &lt;span style="color: blue;"&gt;if&lt;/span&gt; (!cell.Hyperlink.IsAbsoluteUri &amp;amp;&amp;amp; hyps.ContainsKey(cell.Hyperlink.OriginalString))
				{
					id = hyps[cell.Hyperlink.OriginalString];
				}
				&lt;span style="color: blue;"&gt;else&lt;/span&gt;
				{
					PackageRelationship relationship = Part.CreateRelationship(cell.Hyperlink, TargetMode.External, ExcelPackage.schemaHyperlink);
					sw.Write(&lt;span style="color: rgb(163, 21, 21);"&gt;"&amp;lt;hyperlink ref=\"{0}\" r:id=\"{1}\" /&amp;gt;"&lt;/span&gt;,cell.CellAddress, relationship.Id);

					id = relationship.Id;
				}
				cell.HyperLinkRId = id;
			}
		}
		sw.Write(&lt;span style="color: rgb(163, 21, 21);"&gt;"&amp;lt;/hyperlinks&amp;gt;"&lt;/span&gt;);
}
&lt;/pre&gt;
&lt;pre&gt;I haven't tested it thoroughly, but it accomplishes my goals: adding relative hyperlinks.&lt;/pre&gt;
&lt;pre&gt;Keep with the amazing work you've been doing.&lt;/pre&gt;
&lt;pre&gt;Regards.&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="30/09/2010 20:56:30">
          <Html>
        
&lt;p&gt;Thanx, I'll add this next time I'll check in.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Conditional Formatting">
      <Posts>
        <Post From="oomjan" When="28/09/2010 11:10:34">
          <Html>
        
&lt;p&gt;Is it possible to do conditional formatting in EPPlus?&lt;/p&gt;
&lt;p&gt;I can't do this at runtime, since the user needs to update certain columns, which will then need to be highlighted based on certain conditions&lt;/p&gt;
&lt;p&gt;thanks&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="28/09/2010 19:58:48">
          <Html>
        
&lt;p&gt;No, there is no support for conditional formating in the library.&lt;/p&gt;
&lt;p&gt;If you&amp;nbsp;need it, use a template and update the WorksheetXML yourself. (You can check the format by renaming your template.xlsx *.zip and extract it.)&amp;nbsp;&lt;/p&gt;
&lt;p&gt;The ordinary numberformat property supports a simple way of conditional format changing colors depending on Positive, negative and zero values.&lt;/p&gt;
&lt;p&gt;Something like this,,,&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ws.Cells["A1].Style.NumberFormat.Format="[Blue]#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00;[Red]\-#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00;[Black]#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00&lt;/strong&gt;&lt;span&gt;";&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;... but if that's not what you want you have to use the WorksheetXml&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;Jan&lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Merging Cells corrupts workbook">
      <Posts>
        <Post From="johnsgw" When="23/09/2010 13:59:24">
          <Html>
        
&lt;p&gt;I have created a spreadsheet using EPPlus and it works great.&amp;nbsp; I tried to add code to set a range of cells to merge as true but the gets spreadsheet corrupt.&amp;nbsp; If commecnt out the code that does the merge the spreadsheet is fine.&amp;nbsp; Meger subroutine
 code is below (I have tried using ExceRange and it also did not work).&amp;nbsp; I am am using version 2.7.0.1.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; Sub MergeCells(ByVal sStartCellAddress As String, ByVal sEndCellAddress As String, ByVal iRowOffset As Integer, ByVal iColOffset As Integer)&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Dim sNewStartAddress, sNewEndAddress As String&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; sNewStartAddress = CalcCellAddress(sStartCellAddress, iRow, iCol)&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; sNewEndAddress = CalcCellAddress(sEndCellAddress, iRow, iCol)&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Dim sRange As String = sNewStartAddress &amp;amp; ":" &amp;amp; sNewEndAddress&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; xlWorksheet.Cells(sRange).Merge = True&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; xlWorksheet.Cells(sRange).Style.HorizontalAlignment = OfficeOpenXml.Style.ExcelHorizontalAlignment.Left&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; xlWorksheet.Cells(sRange).Style.VerticalAlignment = OfficeOpenXml.Style.ExcelVerticalAlignment.Top&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; xlWorksheet.Cells(sRange).Style.WrapText = True&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; End Sub&lt;/p&gt;
&lt;p&gt;Thanks,&lt;/p&gt;
&lt;p&gt;Glenn&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="23/09/2010 14:54:30">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;That's supposed to work.&lt;/p&gt;
&lt;p&gt;Some questions...&lt;/p&gt;
&lt;p&gt;What is the value of sRange when you set the Merge propery?&lt;/p&gt;
&lt;p&gt;What is the content of this range?&lt;/p&gt;
&lt;p&gt;iRow and iCol&amp;nbsp;are not declared in the method? Do you intend to use iRowOffset and iColOffset?&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="johnsgw" When="23/09/2010 15:10:14">
          <Html>
        
&lt;p&gt;The value of the range is "D12:I12".&amp;nbsp; As far as the value is concerned I have tried both setting it to "" and a string value.&lt;/p&gt;
&lt;p&gt;I see your point about the iRow and iCol are not defined and should be iRowOffset and iColOffset.&amp;nbsp; The fuction does return the correct values.&amp;nbsp; I am olny testing&amp;nbsp;this routine ones with&amp;nbsp;offset values of 0.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;I have also hard coded the the range and have tried using the range (12, 4, 12, 9)&lt;/p&gt;
&lt;p&gt;Here is the corrected code and it&amp;nbsp;still fails.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; Sub MergeCells(ByVal sStartCellAddress As String, ByVal sEndCellAddress As String, ByVal iRowOffset As Integer, ByVal iColOffset As Integer)&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Dim sNewStartAddress, sNewEndAddress As String&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; sNewStartAddress = CalcCellAddress(sStartCellAddress, iRowOffset, iColOffset)&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; sNewEndAddress = CalcCellAddress(sEndCellAddress, iRowOffset, iColOffset)&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Dim sRange As String = sNewStartAddress &amp;amp; ":" &amp;amp; sNewEndAddress&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; xlWorksheet.Cells(sRange).Merge = True&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; xlWorksheet.Cells(sRange).Style.HorizontalAlignment = OfficeOpenXml.Style.ExcelHorizontalAlignment.Left&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; xlWorksheet.Cells(sRange).Style.VerticalAlignment = OfficeOpenXml.Style.ExcelVerticalAlignment.Top&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; xlWorksheet.Cells(sRange).Style.WrapText = True&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; End Sub&lt;/p&gt;
&lt;p&gt;The error when I open the workbook is:&lt;/p&gt;
&lt;p&gt;"Excel found unreadable content in 'spreadsheetname.xlsx'.&amp;nbsp; Do you want to recover the contents of this workbook?&amp;nbsp; If you trust the source of this workbook, click Yes."&lt;/p&gt;
&lt;p&gt;Glenn&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Intermittent unable to create store directory, IsolatedStorage">
      <Posts>
        <Post From="etl" When="17/09/2010 12:54:50">
          <Html>
        
&lt;p&gt;Hi&lt;/p&gt;
&lt;p&gt;We have a problem with generating saving our xcel data. This only happens with some queries, but not with others. And it works perfectly in VS2010, but not when published.&lt;/p&gt;
&lt;p&gt;this is the situation:&lt;/p&gt;
&lt;p&gt;We have a webserverice that puts data into an exceltemplate and then saves it in a folder on the server, the access rights are correct since&amp;nbsp;files&amp;nbsp;can be save with the same data for another entity. The service is run under iis 6 and the project
 is compiled in dotnet 3.5.&lt;/p&gt;
&lt;p&gt;Doesn anyone have any idea what we can do to get around this?&lt;/p&gt;
&lt;p&gt;stacktrace:&lt;/p&gt;
&lt;p&gt;&lt;span style="color: black; font-size: 10pt;"&gt;00000076&amp;nbsp;13:24:05&amp;nbsp;[3168] Error in DoTemplateBasedReportSystem.IO.IsolatedStorage.IsolatedStorageException: Unable to create the store directory. (Exception from HRESULT: 0x80131468) &amp;nbsp;&lt;br&gt;
00000077&amp;nbsp;13:24:05&amp;nbsp;[3168]&amp;nbsp;&amp;nbsp;&amp;nbsp; at System.IO.IsolatedStorage.IsolatedStorageFile.GetRootDir(IsolatedStorageScope scope, StringHandleOnStack retRootDir) &amp;nbsp;&lt;br&gt;
00000078&amp;nbsp;13:24:05&amp;nbsp;[3168]&amp;nbsp;&amp;nbsp;&amp;nbsp; at System.IO.IsolatedStorage.IsolatedStorageFile.InitGlobalsNonRoamingUser(IsolatedStorageScope scope) &amp;nbsp;&lt;br&gt;
00000079&amp;nbsp;13:24:05&amp;nbsp;[3168]&amp;nbsp;&amp;nbsp;&amp;nbsp; at System.IO.IsolatedStorage.IsolatedStorageFile.GetRootDir(IsolatedStorageScope scope) &amp;nbsp;&lt;br&gt;
00000080&amp;nbsp;13:24:05&amp;nbsp;[3168]&amp;nbsp;&amp;nbsp;&amp;nbsp; at System.IO.IsolatedStorage.IsolatedStorageFile.GetGlobalFileIOPerm(IsolatedStorageScope scope) &amp;nbsp;&lt;br&gt;
00000081&amp;nbsp;13:24:05&amp;nbsp;[3168]&amp;nbsp;&amp;nbsp;&amp;nbsp; at System.IO.IsolatedStorage.IsolatedStorageFile.Init(IsolatedStorageScope scope) &amp;nbsp;&lt;br&gt;
00000082&amp;nbsp;13:24:05&amp;nbsp;[3168]&amp;nbsp;&amp;nbsp;&amp;nbsp; at System.IO.IsolatedStorage.IsolatedStorageFile.GetStore(IsolatedStorageScope scope, Type domainEvidenceType, Type assemblyEvidenceType) &amp;nbsp;&lt;br&gt;
00000083&amp;nbsp;13:24:05&amp;nbsp;[3168]&amp;nbsp;&amp;nbsp;&amp;nbsp; at MS.Internal.IO.Packaging.PackagingUtilities.ReliableIsolatedStorageFileFolder.GetCurrentStore() &amp;nbsp;&lt;br&gt;
00000084&amp;nbsp;13:24:05&amp;nbsp;[3168]&amp;nbsp;&amp;nbsp;&amp;nbsp; at MS.Internal.IO.Packaging.PackagingUtilities.ReliableIsolatedStorageFileFolder..ctor() &amp;nbsp;&lt;br&gt;
00000085&amp;nbsp;13:24:05&amp;nbsp;[3168]&amp;nbsp;&amp;nbsp;&amp;nbsp; at MS.Internal.IO.Packaging.PackagingUtilities.GetDefaultIsolatedStorageFile() &amp;nbsp;&lt;br&gt;
00000086&amp;nbsp;13:24:05&amp;nbsp;[3168]&amp;nbsp;&amp;nbsp;&amp;nbsp; at MS.Internal.IO.Packaging.PackagingUtilities.CreateUserScopedIsolatedStorageFileStreamWithRandomName(Int32 retryCount, String&amp;amp; fileName) &amp;nbsp;&lt;br&gt;
00000087&amp;nbsp;13:24:05&amp;nbsp;[3168]&amp;nbsp;&amp;nbsp;&amp;nbsp; at MS.Internal.IO.Packaging.SparseMemoryStream.SwitchModeIfNecessary() &amp;nbsp;&lt;br&gt;
00000088&amp;nbsp;13:24:05&amp;nbsp;[3168]&amp;nbsp;&amp;nbsp;&amp;nbsp; at MS.Internal.IO.Packaging.SparseMemoryStream.Write(Byte[] buffer, Int32 offset, Int32 count) &amp;nbsp;&lt;br&gt;
00000089&amp;nbsp;13:24:05&amp;nbsp;[3168]&amp;nbsp;&amp;nbsp;&amp;nbsp; at MS.Internal.IO.Packaging.CompressEmulationStream.Write(Byte[] buffer, Int32 offset, Int32 count) &amp;nbsp;&lt;br&gt;
00000090&amp;nbsp;13:24:05&amp;nbsp;[3168]&amp;nbsp;&amp;nbsp;&amp;nbsp; at MS.Internal.IO.Packaging.CompressStream.Write(Byte[] buffer, Int32 offset, Int32 count) &amp;nbsp;&lt;br&gt;
00000091&amp;nbsp;13:24:05&amp;nbsp;[3168]&amp;nbsp;&amp;nbsp;&amp;nbsp; at MS.Internal.IO.Zip.ProgressiveCrcCalculatingStream.Write(Byte[] buffer, Int32 offset, Int32 count) &amp;nbsp;&lt;br&gt;
00000092&amp;nbsp;13:24:05&amp;nbsp;[3168]&amp;nbsp;&amp;nbsp;&amp;nbsp; at MS.Internal.IO.Zip.ZipIOModeEnforcingStream.Write(Byte[] buffer, Int32 offset, Int32 count) &amp;nbsp;&lt;br&gt;
00000093&amp;nbsp;13:24:05&amp;nbsp;[3168]&amp;nbsp;&amp;nbsp;&amp;nbsp; at System.IO.StreamWriter.Flush(Boolean flushStream, Boolean flushEncoder) &amp;nbsp;&lt;br&gt;
00000094&amp;nbsp;13:24:05&amp;nbsp;[3168]&amp;nbsp;&amp;nbsp;&amp;nbsp; at System.IO.StreamWriter.Write(String value) &amp;nbsp;&lt;br&gt;
00000095&amp;nbsp;13:24:05&amp;nbsp;[3168]&amp;nbsp;&amp;nbsp;&amp;nbsp; at System.IO.TextWriter.Write(String format, Object arg0, Object arg1) &amp;nbsp;&lt;br&gt;
00000096&amp;nbsp;13:24:05&amp;nbsp;[3168]&amp;nbsp;&amp;nbsp;&amp;nbsp; at OfficeOpenXml.ExcelWorksheet.UpdateRowCellData(StreamWriter sw, List`1&amp;amp; rowBreaks) &amp;nbsp;&lt;br&gt;
00000097&amp;nbsp;13:24:05&amp;nbsp;[3168]&amp;nbsp;&amp;nbsp;&amp;nbsp; at OfficeOpenXml.ExcelWorksheet.SaveXml() &amp;nbsp;&lt;br&gt;
00000098&amp;nbsp;13:24:05&amp;nbsp;[3168]&amp;nbsp;&amp;nbsp;&amp;nbsp; at OfficeOpenXml.ExcelWorksheet.Save() &amp;nbsp;&lt;br&gt;
00000099&amp;nbsp;13:24:05&amp;nbsp;[3168]&amp;nbsp;&amp;nbsp;&amp;nbsp; at OfficeOpenXml.ExcelWorkbook.Save() &amp;nbsp;&lt;br&gt;
00000100&amp;nbsp;13:24:05&amp;nbsp;[3168]&amp;nbsp;&amp;nbsp;&amp;nbsp; at OfficeOpenXml.ExcelPackage.Save() &amp;nbsp;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="17/09/2010 12:59:11">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I think you have the same problem as in this thread...&lt;/p&gt;
&lt;p&gt;&lt;a href="http://epplus.codeplex.com/Thread/View.aspx?ThreadId=215730" rel="nofollow"&gt;http://epplus.codeplex.com/Thread/View.aspx?ThreadId=215730&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="etl" When="17/09/2010 14:19:59">
          <Html>
        
&lt;p&gt;I don't think so. We can create files under 1mb but over that it can't.&lt;/p&gt;
&lt;p&gt;I don't udnerstand why it uses IsolatedStorage, when we create the file. We create the folder serverside, and save the file there in an ouput folder, returning the link only to the browser. Problem is I find no refrences to IsolatedStorage anywhere, so why
 is it usning this?&lt;/p&gt;
&lt;p&gt;Oh, and we can use the InccreaseQuotaTo because it is serverside...or that's what I think is the problem with changing quota.&lt;/p&gt;
&lt;p&gt;/Erik&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="17/09/2010 14:44:34">
          <Html>
        
&lt;p&gt;The package-API uses Isolated Storage internally in some way.&lt;/p&gt;
&lt;p&gt;Just to verify, did you add the folder and set the permission as described in the article?&lt;/p&gt;
&lt;p&gt;&lt;a href="http://labs.episerver.com/en/Blogs/Svante-Seleborg/Dates/2008/10/IsolatedStorage-Access-Denied/" rel="nofollow"&gt;http://labs.episerver.com/en/Blogs/Svante-Seleborg/Dates/2008/10/IsolatedStorage-Access-Denied/&lt;/a&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="etl" When="17/09/2010 14:52:22">
          <Html>
        
&lt;p&gt;Yes we did make sure the article steps were made, though the difference is that this folder is defined under inetpub/wwwroot/STTReportHost/Output where we generate one folder per webuser. In essence everyuser that generates a file has his own folder named
 by his GUID from the database.&lt;/p&gt;
&lt;p&gt;Is there any way to get around Isolatedstorage?&lt;/p&gt;
&lt;p&gt;The users are not Domain users! So the IIS is the server user here.&lt;/p&gt;
&lt;p&gt;/Erik&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="20/09/2010 07:30:56">
          <Html>
        
&lt;p&gt;I'm no expert when if comes to IIS, but I guess you have to make sure that the user running under the IIS user context has the appropriate permissions.&lt;/p&gt;
&lt;p&gt;The isolated storage is used by the .net framework internal Zip classes,so it's out of my control.&lt;/p&gt;
&lt;p&gt;/Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="etl" When="20/09/2010 08:34:43">
          <Html>
        
&lt;p&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;Tried to use the stream, but ended up with a corrupted file.&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;/Erik&amp;nbsp;&lt;/span&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="etl" When="20/09/2010 09:43:23">
          <Html>
        
&lt;p&gt;Question: Are we allowed to make the WorkBook.Save() public or an extra public method that calls it?&lt;/p&gt;
&lt;p&gt;/Erik&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="20/09/2010 10:06:12">
          <Html>
        
&lt;p&gt;if you create the package with no parameters like ...&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;pck = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage();
&lt;/pre&gt;
&lt;pre&gt;or with a template...
pck = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(&lt;span style="color: blue;"&gt;new&lt;/span&gt; FileInfo(&lt;span style="color: rgb(163, 21, 21);"&gt;"Tempalte.xlsx"&lt;/span&gt;),&lt;span style="color: blue;"&gt;true&lt;/span&gt;);

Will be the same thing (the package will be closed after the save though). Try to use the SaveAs and GetAsByteArray and see if it helps you.&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="etl" When="20/09/2010 13:39:55">
          <Html>
        
&lt;p&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Segoe UI; font-size: x-small;"&gt;Well, now it is solved.&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Segoe UI; font-size: x-small;"&gt;Well, we can say that we misinterpreted the info in the link about the default user local settings/application data or appropriate folder folder and
 rights to mean that selected folder was actually the one used. Well, sorry for being a bit thick :)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Segoe UI; font-size: x-small;"&gt;/erik&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="21/09/2010 07:31:18">
          <Html>
        
&lt;p&gt;ok, great :)&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="XMLException when reading the Excel file">
      <Posts>
        <Post From="manuelkuok" When="20/04/2010 05:03:12">
          <Html>
        
&lt;p&gt;&amp;nbsp;&lt;span lang="EN-US" style="color: black;"&gt;My&amp;nbsp;application will&amp;nbsp; create two worksheets.&amp;nbsp;&amp;nbsp;and then &amp;nbsp;my&amp;nbsp;application &amp;nbsp;read the worksheets.&amp;nbsp; When reading the worksheets, EPPLUS will throw the XMLException.
&lt;/span&gt;&lt;strong&gt;&lt;span lang="EN-US" style="color: red;"&gt;Not &lt;/span&gt;&lt;/strong&gt;&lt;span lang="EN-US" style="color: black;"&gt;all the&amp;nbsp;Excel files &amp;nbsp;created by&amp;nbsp;EPPLUS&amp;nbsp;will have the exception.&amp;nbsp;&amp;nbsp;The exception just&amp;nbsp;&lt;/span&gt;&lt;strong&gt;&lt;span lang="EN-US" style="color: red;"&gt;occasionally&lt;/span&gt;&lt;/strong&gt;&lt;span lang="EN-US" style="color: black;"&gt;
 happened.&amp;nbsp;How can I&amp;nbsp; fix it? THX!!!&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="text-decoration: underline;"&gt;&lt;span lang="EN-US" style="color: black;"&gt;The following are the details:
&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span lang="EN-US" style="color: black;"&gt;When&amp;nbsp;the application&amp;nbsp; reads the file using EPPLUS.(&lt;/span&gt;&lt;span lang="EN-US" style="color: gray;"&gt;ExcelWorksheet ExcelWorksheet_ClassInfo = xlPackage.Workbook.Worksheets["ClassInfo"];&lt;/span&gt;&lt;span lang="EN-US" style="color: black;"&gt;)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span lang="EN-US" style="color: black;"&gt;EPPLUS&amp;nbsp;will throw the &lt;/span&gt;&lt;span lang="EN-US" style="color: red;"&gt;XMLException error:&amp;nbsp;&amp;nbsp; Unexpected end of file has occurred. The following elements are not closed: worksheet. Line 1, position 572.&lt;/span&gt;&lt;span lang="EN-US" style="color: black;"&gt;&lt;br&gt;
The StackTrace:&lt;br&gt;
&amp;nbsp; at System.Xml.XmlTextReaderImpl.Throw(Exception e)&lt;br&gt;
&amp;nbsp;&amp;nbsp; at System.Xml.XmlTextReaderImpl.Throw(String res, String arg)&lt;br&gt;
&amp;nbsp;&amp;nbsp; at System.Xml.XmlTextReaderImpl.Throw(Int32 pos, String res, String arg)&lt;br&gt;
&amp;nbsp;&amp;nbsp; at System.Xml.XmlTextReaderImpl.ThrowUnclosedElements()&lt;br&gt;
&amp;nbsp;&amp;nbsp; at System.Xml.XmlTextReaderImpl.ParseElementContent()&lt;br&gt;
&amp;nbsp;&amp;nbsp; at System.Xml.XmlTextReaderImpl.Read()&lt;br&gt;
&amp;nbsp;&amp;nbsp; at System.Xml.XmlLoader.LoadNode(Boolean skipOverWhitespace)&lt;br&gt;
&amp;nbsp;&amp;nbsp; at System.Xml.XmlLoader.LoadDocSequence(XmlDocument parentDoc)&lt;br&gt;
&amp;nbsp;&amp;nbsp; at System.Xml.XmlLoader.Load(XmlDocument doc, XmlReader reader, Boolean preserveWhitespace)&lt;br&gt;
&amp;nbsp;&amp;nbsp; at System.Xml.XmlDocument.Load(XmlReader reader)&lt;br&gt;
&amp;nbsp;&amp;nbsp; at System.Xml.XmlDocument.LoadXml(String xml)&lt;br&gt;
&amp;nbsp;&amp;nbsp; at OfficeOpenXml.ExcelWorksheet.CreateXml()&lt;br&gt;
&amp;nbsp;&amp;nbsp; at OfficeOpenXml.ExcelWorksheet..ctor(XmlNamespaceManager ns, ExcelPackage excelPackage, String relID, Uri uriWorksheet, String sheetName, Int32 sheetID, Int32 positionID, Boolean hide)&lt;br&gt;
&amp;nbsp;&amp;nbsp; at OfficeOpenXml.ExcelWorksheets..ctor(ExcelPackage xlPackage)&lt;br&gt;
&amp;nbsp;&amp;nbsp; at OfficeOpenXml.ExcelWorkbook.get_Worksheets()&lt;br&gt;
&amp;nbsp;&amp;nbsp; at Upload.UpdateWebwithExcel.Page_Load(Object sender, EventArgs e) in C:\Documents and Settings\manuelkwok\My Documents\Visual Studio 2008\Projects\Upload\Upload\UpdateWebwithExcel.aspx.cs:line 69&lt;br&gt;
&amp;nbsp;&amp;nbsp; at System.Web.Util.CalliHelper.EventArgFunctionCaller(IntPtr fp, Object o, Object t, EventArgs e)&lt;br&gt;
&amp;nbsp;&amp;nbsp; at System.Web.Util.CalliEventHandlerDelegateProxy.Callback(Object sender, EventArgs e)&lt;br&gt;
&amp;nbsp;&amp;nbsp; at System.Web.UI.Control.OnLoad(EventArgs e)&lt;br&gt;
&amp;nbsp;&amp;nbsp; at System.Web.UI.Control.LoadRecursive()&lt;br&gt;
&amp;nbsp;&amp;nbsp; at System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;span lang="EN-US" style="color: red;"&gt;Not &lt;/span&gt;&lt;/strong&gt;&lt;span lang="EN-US" style="color: black;"&gt;all the&amp;nbsp;Excel files created by&amp;nbsp;EPPLUS&amp;nbsp;will have the exception.&amp;nbsp;&amp;nbsp;The exception just&amp;nbsp;&lt;/span&gt;&lt;strong&gt;&lt;span lang="EN-US" style="color: red;"&gt;occasionally&lt;/span&gt;&lt;/strong&gt;&lt;span lang="EN-US" style="color: black;"&gt;
 happened.&lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="20/04/2010 07:36:51">
          <Html>
        
&lt;p&gt;Can you send me the sheet that fails and the code that creates it. Create an issue and upload it&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="cguardia" When="15/09/2010 01:05:04">
          <Html>
        
&lt;p&gt;I´m having the same problem.&lt;/p&gt;
&lt;p&gt;I don´t know if it could help, but this is my stack trace:&lt;/p&gt;
&lt;ul id="UsrValidador1_spaErrores"&gt;
&lt;span id="UsrValidador1_lblErrores"&gt;
&lt;li&gt;Unexpected end of file has occurred. The following elements are not closed: worksheet. Line 2, position 857.
&lt;/li&gt;&lt;li&gt;System.Xml.XmlException: Unexpected end of file has occurred. The following elements are not closed: worksheet. Line 2, position 857. at System.Xml.XmlTextReaderImpl.Throw(Exception e) at System.Xml.XmlTextReaderImpl.Throw(String res, String arg) at System.Xml.XmlTextReaderImpl.Throw(Int32
 pos, String res, String arg) at System.Xml.XmlTextReaderImpl.ThrowUnclosedElements() at System.Xml.XmlTextReaderImpl.ParseElementContent() at System.Xml.XmlTextReaderImpl.Read() at System.Xml.XmlLoader.LoadNode(Boolean skipOverWhitespace) at System.Xml.XmlLoader.LoadDocSequence(XmlDocument
 parentDoc) at System.Xml.XmlLoader.Load(XmlDocument doc, XmlReader reader, Boolean preserveWhitespace) at System.Xml.XmlDocument.Load(XmlReader reader) at System.Xml.XmlDocument.LoadXml(String xml) at OfficeOpenXml.ExcelWorksheet.CreateXml() at OfficeOpenXml.ExcelWorksheet..ctor(XmlNamespaceManager
 ns, ExcelPackage excelPackage, String relID, Uri uriWorksheet, String sheetName, Int32 sheetID, Int32 positionID, Boolean hide) at OfficeOpenXml.ExcelWorksheets..ctor(ExcelPackage xlPackage) at OfficeOpenXml.ExcelWorkbook.get_Worksheets()
&lt;/li&gt;&lt;/span&gt;&lt;/ul&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="15/09/2010 18:49:46">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;This problem&amp;nbsp;was supposed to be&amp;nbsp;fixed in version 2.7, so make sure you use this version.&lt;/p&gt;
&lt;p&gt;If you do and it still fails, create an issue and upload the template so&amp;nbsp;I can have a look at it.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="cguardia" When="15/09/2010 19:00:33">
          <Html>
        
&lt;p&gt;Ok! I was using a previous version (2.6).&lt;/p&gt;
&lt;p&gt;This component is great!&lt;/p&gt;
&lt;p&gt;Thanx!&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Legend Population">
      <Posts>
        <Post From="mardon" When="12/09/2010 19:55:49">
          <Html>
        
&lt;p&gt;I was wondering is there a way i can populate the values of the legend with the values i want displayed?&lt;/p&gt;
&lt;p&gt;I think this has been the issue i was fighting before not understanding what i wanted displayed.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="13/09/2010 20:51:41">
          <Html>
        
&lt;p&gt;You can only set the legend values from the X-series values in the current release (like the pie chart i sample 6).&lt;/p&gt;
&lt;p&gt;&amp;nbsp;I guess you want to add a list of string values? The only way to add that is to write to the ChartXml yourself. You can check the syntax by editing the sheet in Excel the way you want it, save it as a .xlsx document --&amp;gt; rename *.zip&amp;nbsp;and extract.
 Look at the chart.xml files in \xl\charts.&lt;/p&gt;
&lt;p&gt;My test looked like this&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;c&lt;/span&gt;&lt;span style="color: blue;"&gt;:&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;cat&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
- &lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;c&lt;/span&gt;&lt;span style="color: blue;"&gt;:&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;strLit&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
  &lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;c&lt;/span&gt;&lt;span style="color: blue;"&gt;:&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;ptCount&lt;/span&gt; &lt;span style="color: red;"&gt;val&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: blue;"&gt;"4"&lt;/span&gt; &lt;span style="color: blue;"&gt;/&amp;gt;&lt;/span&gt; 
 &lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;c&lt;/span&gt;&lt;span style="color: blue;"&gt;:&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;pt&lt;/span&gt; &lt;span style="color: red;"&gt;idx&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: blue;"&gt;"0"&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
  &lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;c&lt;/span&gt;&lt;span style="color: blue;"&gt;:&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;v&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;svn-base&lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;c&lt;/span&gt;&lt;span style="color: blue;"&gt;:&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;v&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt; 
  &lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;c&lt;/span&gt;&lt;span style="color: blue;"&gt;:&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;pt&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
 &lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;c&lt;/span&gt;&lt;span style="color: blue;"&gt;:&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;pt&lt;/span&gt; &lt;span style="color: red;"&gt;idx&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: blue;"&gt;"1"&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
  &lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;c&lt;/span&gt;&lt;span style="color: blue;"&gt;:&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;v&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;cs&lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;c&lt;/span&gt;&lt;span style="color: blue;"&gt;:&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;v&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt; 
  &lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;c&lt;/span&gt;&lt;span style="color: blue;"&gt;:&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;pt&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
 &lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;c&lt;/span&gt;&lt;span style="color: blue;"&gt;:&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;pt&lt;/span&gt; &lt;span style="color: red;"&gt;idx&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: blue;"&gt;"3"&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
  &lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;c&lt;/span&gt;&lt;span style="color: blue;"&gt;:&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;v&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;config&lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;c&lt;/span&gt;&lt;span style="color: blue;"&gt;:&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;v&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt; 
  &lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;c&lt;/span&gt;&lt;span style="color: blue;"&gt;:&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;pt&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
  &lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;c&lt;/span&gt;&lt;span style="color: blue;"&gt;:&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;strLit&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;
&lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;c&lt;/span&gt;&lt;span style="color: blue;"&gt;:&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;cat&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;

&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Not that easy, so if its an option for you use a range instead. I hope I can add something better in the future.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Streaming the output directly to the browser">
      <Posts>
        <Post From="mo9a7i" When="19/07/2010 06:39:34">
          <Html>
        
&lt;p&gt;Hello everybody,&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Hope that one of you have done this already and can share it with me.&lt;/p&gt;
&lt;p&gt;I'm using this package to use an excel template file to generate monthly reports.&lt;/p&gt;
&lt;p&gt;these reports should be exported by a click of a button in the browser.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;current procedure is :&lt;/p&gt;
&lt;p&gt;1- user clicks the button&lt;/p&gt;
&lt;p&gt;2- template file is being filled with numbers&lt;/p&gt;
&lt;p&gt;3- saved on the server (on a folder)&lt;/p&gt;
&lt;p&gt;4- then, this file from the server is sent to the users browser for him to download.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;what i would like to do is: eliminate step number 3, which is saving to the server&lt;/p&gt;
&lt;p&gt;I want that file to be loaded (stream) in the memory then sent directly to the users browser.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mo9a7i" When="19/07/2010 06:41:57">
          <Html>
        
&lt;p&gt;this is my current code:&lt;/p&gt;
&lt;p&gt;==================================&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;protected&lt;/span&gt; &lt;span style="color: blue;"&gt;void&lt;/span&gt; Button1_Click(&lt;span style="color: blue;"&gt;object&lt;/span&gt; sender, EventArgs e)
{
	&lt;span style="color: blue;"&gt;string&lt;/span&gt; dtnow = DateTime.Now.ToString(&lt;span style="color: rgb(163, 21, 21);"&gt;"yy-mm-dd-_hh-mm-ss"&lt;/span&gt;);
	&lt;span style="color: blue;"&gt;string&lt;/span&gt; fnamenow = dtnow + &lt;span style="color: rgb(163, 21, 21);"&gt;".xlsx"&lt;/span&gt;;
	&lt;span style="color: blue;"&gt;string&lt;/span&gt; filename = Request.PhysicalApplicationPath + &lt;span style="color: rgb(163, 21, 21);"&gt;@"finalReport\ExportedExcels\"&lt;/span&gt; + fnamenow;
	&lt;span style="color: blue;"&gt;string&lt;/span&gt; templatename = Request.PhysicalApplicationPath + &lt;span style="color: rgb(163, 21, 21);"&gt;@"includes\ExcelTemplate\Book1.xlsx"&lt;/span&gt;;

	newFile = &lt;span style="color: blue;"&gt;new&lt;/span&gt; FileInfo(filename);
	template = &lt;span style="color: blue;"&gt;new&lt;/span&gt; FileInfo(templatename);

	&lt;span style="color: green;"&gt;// ExcelPackage excel = new ExcelPackage(newFile, template);&lt;/span&gt;
	&lt;span style="color: blue;"&gt;using&lt;/span&gt; (excely = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(newFile, template))
	{
		&lt;span style="color: blue;"&gt;#region&lt;/span&gt; WorkStation
		worksheet = excely.Workbook.Worksheets[3];
		grid = (GridView)GridView6;
		startRow = 6;
		row = startRow;
		&lt;span style="color: blue;"&gt;if&lt;/span&gt; (worksheet != &lt;span style="color: blue;"&gt;null&lt;/span&gt;)
		{
			&lt;span style="color: blue;"&gt;foreach&lt;/span&gt; (GridViewRow y &lt;span style="color: blue;"&gt;in&lt;/span&gt; grid.Rows)
			{
				worksheet.Cells[row, 1].Value = y.Cells[1].Text.ToString().Trim();&lt;span style="color: green;"&gt;//Business Line&lt;/span&gt;
				worksheet.Cells[row, 2].Value = Convert.ToInt32(y.Cells[2].Text.ToString().Trim());&lt;span style="color: green;"&gt;//Year End Actual&lt;/span&gt;
				worksheet.Cells[row, 3].Value = Convert.ToInt32(y.Cells[3].Text.ToString().Trim());&lt;span style="color: green;"&gt;//Additions&lt;/span&gt;
				worksheet.Cells[row, 4].Value = Convert.ToInt32(y.Cells[4].Text.ToString().Trim());&lt;span style="color: green;"&gt;//Returns&lt;/span&gt;
				worksheet.Cells[row, 6].Value = Convert.ToInt32(y.Cells[5].Text.ToString().Trim());&lt;span style="color: green;"&gt;//Additions&lt;/span&gt;
				row++;
			}
		}
		&lt;span style="color: blue;"&gt;#endregion&lt;/span&gt;
		excely.Save();
	}

	&lt;span style="color: green;"&gt;//Set the appropriate ContentType.&lt;/span&gt;
	Response.ContentType = &lt;span style="color: rgb(163, 21, 21);"&gt;"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"&lt;/span&gt;;
	Response.AppendHeader(&lt;span style="color: rgb(163, 21, 21);"&gt;"Content-Disposition"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"attachment; filename="&lt;/span&gt; + fnamenow);

	&lt;span style="color: green;"&gt;//Write the file directly to the HTTP content output stream.&lt;/span&gt;
	Response.WriteFile(filename);
	Response.End();
}

&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="19/07/2010 08:26:15">
          <Html>
        Hi, Have a look at the web samples project ... Use the constructor like this... using (excely = new ExcelPackage(template, true)) { ... } Jan
        
    </Html>
        </Post>
        <Post From="mo9a7i" When="19/07/2010 12:39:08">
          <Html>
        
&lt;p&gt;Hello Jan&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I have used this method&lt;/p&gt;
&lt;p&gt;and for saving i'm using:&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: green;"&gt;//  Response.BinaryWrite(excely.GetAsByteArray());&lt;/span&gt;
excely.SaveAs(Response.OutputStream);
Response.ContentType = &lt;span style="color: rgb(163, 21, 21);"&gt;"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"&lt;/span&gt;;
Response.AddHeader(&lt;span style="color: rgb(163, 21, 21);"&gt;"content-disposition"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"attachment;  filename=Sample3.xlsx"&lt;/span&gt;);
&amp;nbsp;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;unfortunately, both the output stream and binary write produce an error while opening the file.&lt;/p&gt;
&lt;p&gt;"Excel found unreadable content...." &amp;lt;&amp;lt;&amp;nbsp;because&amp;nbsp;of the styling.&lt;/p&gt;
&lt;p&gt;is there anything extra i can do ?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="19/07/2010 12:44:09">
          <Html>
        
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Call response.clear before send stream back to client.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Response.Clear();&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Response.AddHeader(&lt;span style="color: rgb(163, 21, 21);"&gt;"content-disposition"&lt;/span&gt;,
&lt;span style="color: rgb(163, 21, 21);"&gt;"attachment;&amp;nbsp; filename=file&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;.xlsx"&lt;/span&gt;);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Response.ContentType =
&lt;span style="color: rgb(163, 21, 21);"&gt;"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"&lt;/span&gt;;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Response.BinaryWrite(pck.GetAsByteArray());&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Response.End();&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="MrBlueSky" When="19/07/2010 14:51:02">
          <Html>
        
&lt;p&gt;If you are using &lt;strong&gt;&lt;a title="ASP.NET MVC 2.0" href="http://www.asp.net/mvc" rel="nofollow"&gt;MVC 2.0&lt;/a&gt;
&lt;/strong&gt;it's simply as that:&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;        &lt;span style="color: blue;"&gt;public&lt;/span&gt; ActionResult Export()
        {
            &lt;span style="color: blue;"&gt;var&lt;/span&gt; template = &lt;span style="color: blue;"&gt;new&lt;/span&gt; FileInfo(Path.Combine(Request.PhysicalApplicationPath, &lt;span style="color: rgb(163, 21, 21);"&gt;@"Content\template.xlsx"&lt;/span&gt;));
            &lt;span style="color: blue;"&gt;using&lt;/span&gt; (ExcelPackage package = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(template, &lt;span style="color: blue;"&gt;true&lt;/span&gt;))
            {
                &lt;span style="color: green;"&gt;// fill cells&lt;/span&gt;
                &lt;span style="color: green;"&gt;//...&lt;/span&gt;

                &lt;span style="color: blue;"&gt;return&lt;/span&gt; File(package.GetAsByteArray(), &lt;span style="color: rgb(163, 21, 21);"&gt;"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"Data.xlsx"&lt;/span&gt;);
            }
        }
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mo9a7i" When="20/07/2010 05:02:15">
          <Html>
        
&lt;blockquote style="margin: 0.25em 1em 0px; padding: 0px 0.25em; border: 0.1em solid rgb(204, 204, 204); border-image: none; font-style: italic;"&gt;
&lt;strong&gt;mrxrsd wrote:&lt;/strong&gt;&lt;br&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Call response.clear before send stream back to client.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Response.Clear();&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Response.AddHeader(&lt;span style="color: rgb(163, 21, 21);"&gt;"content-disposition"&lt;/span&gt;,
&lt;span style="color: rgb(163, 21, 21);"&gt;"attachment;&amp;nbsp; filename=file&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;.xlsx"&lt;/span&gt;);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Response.ContentType =
&lt;span style="color: rgb(163, 21, 21);"&gt;"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"&lt;/span&gt;;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Response.BinaryWrite(pck.GetAsByteArray());&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Response.End();&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Thanks mrxrsd&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;that worked with me.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;and thanks MrBlueSky,&lt;/p&gt;
&lt;p&gt;I hope that someone can use this someday, I'm using the traditional way of doing things.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="phoxware" When="09/09/2010 15:02:53">
          <Html>
        
&lt;blockquote style="margin: 0.25em 1em 0px; padding: 0px 0.25em; border: 0.1em solid rgb(204, 204, 204); border-image: none; font-style: italic;"&gt;
&lt;strong&gt;mo9a7i wrote:&lt;/strong&gt;&lt;br&gt;
&lt;blockquote style="margin: 0.25em 1em 0px; padding: 0px 0.25em; border: 0.1em solid rgb(204, 204, 204); border-image: none; font-style: italic;"&gt;
&lt;strong&gt;mrxrsd wrote:&lt;/strong&gt;&lt;br&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Call response.clear before send stream back to client.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Response.Clear();&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Response.AddHeader(&lt;span style="color: rgb(163, 21, 21);"&gt;"content-disposition"&lt;/span&gt;,
&lt;span style="color: rgb(163, 21, 21);"&gt;"attachment;&amp;nbsp; filename=file&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;.xlsx"&lt;/span&gt;);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Response.ContentType =
&lt;span style="color: rgb(163, 21, 21);"&gt;"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"&lt;/span&gt;;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Response.BinaryWrite(pck.GetAsByteArray());&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Response.End();&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Thanks mrxrsd&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;that worked with me.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;and thanks MrBlueSky,&lt;/p&gt;
&lt;p&gt;I hope that someone can use this someday, I'm using the traditional way of doing things.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;am using the same code to stream&amp;nbsp;an excel file to my browser. Its working fine on my development machine (windows 7, visual studio 2008 prof &amp;amp; IE 8) but is giving&amp;nbsp; error on&amp;nbsp;the downloading client machine is windows vista with IE7 (error
 :excel found unreadable content in....Do you want to recover the contents of this workbook?If you trust the source of this workbook....&lt;/p&gt;
&lt;p&gt;please, what is the better coding way to fix this?&lt;/p&gt;
&lt;p&gt;thank you&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="09/09/2010 21:11:20">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;That should work fine.&lt;/p&gt;
&lt;p&gt;Try to save the file to disk (on the client) and then open it in notepad (or any other editor)&amp;nbsp;to see if the server returns some kind of error.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Insert Column into Existing Spreadsheet">
      <Posts>
        <Post From="NDebt4Ever" When="18/08/2010 18:06:34">
          <Html>
        
&lt;p&gt;Is there a method (or other solution) to insert a new column into an existing spreadsheet? I see the methods to delete a row and insert a row but nothing for a column.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="19/08/2010 07:43:29">
          <Html>
        
&lt;p&gt;No, but i guess I should add that. There is no good solution for it right now.&lt;/p&gt;
&lt;p&gt;You have to move the cells yourself, copying values, formulas, styles...&lt;/p&gt;
&lt;p&gt;I have added a copy method to the ExcelRange class that could be used (In changeset 62343), but it's not in the released version and it's not fully tested.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="NDebt4Ever" When="23/08/2010 00:30:00">
          <Html>
        
&lt;p&gt;Thanks Jan.... I'll wait a while for that to be added. I appreciate the quick resonse.&lt;/p&gt;
&lt;p&gt;Jon&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Hidden/Collapsed Column Width Value Lost">
      <Posts>
        <Post From="todorpenev" When="20/08/2010 04:08:43">
          <Html>
        
&lt;p&gt;Hello! Thank you for your wonderful work on EPPlus -- it works great and took very little time to get started!&lt;/p&gt;
&lt;p&gt;A minor issue that I've noticed: When loading a&amp;nbsp;worksheet&amp;nbsp;from an existing template that includes hidden/collapsed columns, then outputting the resulting worksheet drops the original custom width values of the hidden columns. When you unhide/uncollapse
 in the newly generated EPPlus spreadsheet the columns have the default width instead of the custom width saved with the template file.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="20/08/2010 06:26:36">
          <Html>
        
&lt;p&gt;Thanks,&lt;/p&gt;
&lt;p&gt;I'll have a look at that&lt;/p&gt;
&lt;p&gt;/Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Insert Bitmap">
      <Posts>
        <Post From="JustBeFREE" When="12/08/2010 23:29:48">
          <Html>
        Hello. I guess this is a simple question. I'm trying to place a picture in my worksheet. With this code I think I have the picture: Bitmap bitmap1 = ConsoleApplication1.Properties.Resources.logo; Now, how do I insert it using epplus? Thank you.
        
    </Html>
        </Post>
        <Post From="jankallman" When="16/08/2010 06:55:03">
          <Html>
        
&lt;p&gt;Use the AddPicture method...&lt;/p&gt;
&lt;p&gt;ExcelPicture pic = ws.Drawings.AddPicture(&lt;span style="color: rgb(163, 21, 21);"&gt;"Bitmap1"&lt;/span&gt;, bitmap1);&lt;/p&gt;
&lt;p&gt;Have a look at sample 6 to see how it works.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="justbefree" When="16/08/2010 11:11:32">
          <Html>
        I knew it, it was easy... Thanks for your help.
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Remove formula?">
      <Posts>
        <Post From="juxtaposed" When="09/08/2010 20:28:54">
          <Html>
        
&lt;p&gt;Is there a way to unset or remove a formula currently in place for a range of cells? I tried this, but when Excel opens it, it throws a bad formatting error. "Excel found unreadable content in filename. Do you wish to recover the contents of this workbook?
 If you trust the source of this workbook, click yes."&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;using&lt;/span&gt; (&lt;span style="color: blue;"&gt;var&lt;/span&gt; r = ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"L29:M32"&lt;/span&gt;])
{
	r.Value = &lt;span style="color: rgb(163, 21, 21);"&gt;@"n/a"&lt;/span&gt;;
	r.Formula = &lt;span style="color: rgb(163, 21, 21);"&gt;""&lt;/span&gt;;
}
&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="10/08/2010 20:42:38">
          <Html>
        
&lt;p&gt;That should work. I'll have a look at it.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Saving to XLS format">
      <Posts>
        <Post From="jminker" When="09/08/2010 21:50:23">
          <Html>
        Is there a way that I can open an Excel XML file and then save it in the XLS format similar to what I would with this code? Private Function ConvertXMLtoXLS(ByVal FileFullName As String) As String Dim OutputFileName As String Dim wb As Workbook Dim exc
 As New Microsoft.Office.Interop.Excel.Application Dim Ran As New System.Random Try OutputFileName = FileFullName.ToLower.Replace(".xml", Ran.Next(10000, 99999).ToString + ".xls") wb = exc.Workbooks.Open(FileFullName, ReadOnly:=False) wb.SaveAs(OutputFileName,
 Microsoft.Office.Interop.Excel.XlFileFormat.xlWorkbookNormal) Return OutputFileName Catch ex As Exception Throw Finally If wb IsNot Nothing Then wb.Close() End If exc.Workbooks.Close() exc.Quit() End Try End Function

        
    </Html>
        </Post>
        <Post From="jankallman" When="10/08/2010 20:40:46">
          <Html>
        
&lt;p&gt;No, this component is OOXML (xlsx)&amp;nbsp;only at this time. If you need xls you can use&amp;nbsp; the NPOI project here on codeplex.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Get count of rows in worksheet">
      <Posts>
        <Post From="DTwined" When="02/08/2010 20:34:25">
          <Html>
        Is it possible to do this through OfficeOpenXml? I can't seem to find a method that will provide this info. thanks, DT
        
    </Html>
        </Post>
        <Post From="jankallman" When="03/08/2010 10:48:44">
          <Html>
        
&lt;p&gt;Sure, you can use the WorkSheet.Dimension property&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="DTwined" When="09/08/2010 17:42:11">
          <Html>
        Thanks Jan. Sam 
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Pivot Tables">
      <Posts>
        <Post From="MeikeTalbach" When="03/08/2010 21:08:55">
          <Html>
        
&lt;p&gt;Hi all !&lt;/p&gt;
&lt;p&gt;I've several excel workbooks that all have a common structure:&lt;br&gt;
-&amp;nbsp;normal worksheets with plain data (no formatting, comments, etc)&lt;br&gt;
- seperate pivot table worksheets that reference the normal worksheets&lt;/p&gt;
&lt;p&gt;As far as I understand, EPPlus does not support modifying pivot tables. I don't believe that this is even required to solve my problem, because Excel recalculates them if required.&lt;br&gt;
However is it guaranteed that the pivot tables are not corrupted if I *only* modify the data of normal worksheets ?&lt;/p&gt;
&lt;p&gt;Thanks for your help&lt;/p&gt;
&lt;p&gt;Meike&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="09/08/2010 07:26:59">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Pivot table data are stored in a separate file inside the package, so writing data to a worksheet should not corrupt the pivit table. You can check it out by renaming your template *.zip and extract the xml files.&lt;/p&gt;
&lt;p&gt;I have not tested this, so I can't be 100% sure, but if you dont experiance any trouble it should be fine&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="MeikeTalbach" When="09/08/2010 10:26:44">
          <Html>
        
&lt;p&gt;Thanks Jan !&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to propagate named ranges from a template">
      <Posts>
        <Post From="boy_phil" When="12/07/2010 14:42:31">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Is it possible to propagate the named ranges from a template to the saved workbook?&lt;/p&gt;
&lt;p&gt;I have a simple .xlsx file, which is empty apart from a couple of numbers and a named range. When I call:&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;using( ExcelPackage p = new ExcelPackage("myTemplate.xlsx", true)){&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ExcelWorksheet ws = p.Workbook.Worksheets[1];&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ws.Cells[1,1].value = "hello";&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Byte [] bin = p.GetAsByteArray();&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; File.WriteAllBytes("myOutput.xlsx", bin);&lt;/p&gt;
&lt;p&gt;&amp;nbsp;}&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I notice that all is well, apart from the template's named ranges are missing.&lt;/p&gt;
&lt;p&gt;Do you know how I would preserve the named ranges from the template in the saved workbook? I also tried adding a name in code and that didn't get saved either.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks,&lt;/p&gt;
&lt;p&gt;Phil&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="19/07/2010 08:18:15">
          <Html>
        Hi, Sorry for my delayed answer, i'm on vaccation for a few weeks now. Named ranges are supposed to work. You can use the Workbook.Names for global names and Worksheet.Names for worksheet local names. I know there was a bug in version 2.6, so make sure
 you use version 2.7. If you still dont get it to work, create an issue and upload your template, so I can have a look at it. Jan
        
    </Html>
        </Post>
        <Post From="SoniaMarkova" When="05/08/2010 18:30:02">
          <Html>
        
&lt;p&gt;Hi Jan,&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I'm using myself a template with a workbook named range but i have the same issue.&lt;/p&gt;
&lt;p&gt;Despite all my effort i was unable to keep this named range in the new file created.&lt;/p&gt;
&lt;p&gt;EPPlus version is 2.7.0.1 and here is the code i'm using&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;using&lt;/span&gt; OfficeOpenXml;
&lt;span style="color: blue;"&gt;using&lt;/span&gt; System.IO;

&lt;span style="color: blue;"&gt;namespace&lt;/span&gt; ConsoleApplication1
{
    &lt;span style="color: blue;"&gt;class&lt;/span&gt; Program
    {
        &lt;span style="color: blue;"&gt;static&lt;/span&gt; &lt;span style="color: blue;"&gt;void&lt;/span&gt; Main(&lt;span style="color: blue;"&gt;string&lt;/span&gt;[] args)
        {
            FileInfo existingFile = &lt;span style="color: blue;"&gt;new&lt;/span&gt; FileInfo(&lt;span style="color: rgb(163, 21, 21);"&gt;@".\Test.xlsx"&lt;/span&gt;);
            FileInfo template = &lt;span style="color: blue;"&gt;new&lt;/span&gt; FileInfo(&lt;span style="color: rgb(163, 21, 21);"&gt;@".\Template.xlsx"&lt;/span&gt;);
            &lt;span style="color: blue;"&gt;using&lt;/span&gt; (ExcelPackage p = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(existingFile, template))
            {
                &lt;span style="color: green;"&gt;// Planning to do some stuff here&lt;/span&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;span style="color: green;"&gt;&amp;nbsp;&lt;/span&gt;                p.Save();&lt;/pre&gt;
&lt;pre&gt;            }
        }
    }
}
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;if i'm trying to create my named range before the p.save() it occurs an exception because the named range already exist&lt;/p&gt;
&lt;p&gt;Best regards&lt;/p&gt;
&lt;p&gt;Sonia&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="09/08/2010 07:36:34">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;There is a bug when loading named ranged if you have a named ranged set to a #REF address. Check out names inside the template and set them to a valid address or remove them.&lt;/p&gt;
&lt;p&gt;I'll try to check in a fix for this problem later on.&lt;/p&gt;
&lt;p&gt;If this don't solve you problem, please upload your template and&amp;nbsp;I will have a look at it. (There is an issue on this problem in the issuetracker, so upload your file there).&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="PageLayout -&amp;gt; Sheet Right-to-Left ?">
      <Posts>
        <Post From="houssam_hamdan" When="22/07/2010 06:59:29">
          <Html>
        
&lt;p&gt;Greetings,&lt;/p&gt;
&lt;p&gt;I would like to know if it is possible to generate an excel document having the right to left layout set using EPPlus library.&lt;/p&gt;
&lt;p&gt;FYI: You may go to Page Layout menu then click on Sheet Right-to-Left button to simulate what i am asking for using your library.&lt;/p&gt;
&lt;p&gt;Thank you in advance for your cooperation.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="houssam_hamdan" When="22/07/2010 11:18:57">
          <Html>
        
&lt;p&gt;Solution:&lt;/p&gt;
&lt;p&gt;The following property appended to ExcelWorksheetView class:&lt;/p&gt;
&lt;p&gt;&amp;nbsp;public bool RightToLeft&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; get&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; return GetXmlNodeBool("@rightToLeft");&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; set&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; SetXmlNode("@rightToLeft", value == true?"1":"0");&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;/p&gt;
&lt;p&gt;Cheers )&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="25/07/2010 14:19:55">
          <Html>
        
&lt;p&gt;Thanks, i'll add that :)&lt;/p&gt;
&lt;p&gt;/Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Format Cell as currency">
      <Posts>
        <Post From="reddy506" When="22/07/2010 07:35:13">
          <Html>
        
&lt;p&gt;Hi All,&lt;/p&gt;
&lt;p&gt;First of all I want to Say Thanks for your support.&lt;/p&gt;
&lt;p&gt;I am creating a excel sheet from scratch, am writing values directly to the excel.&lt;br&gt;
all are fine. but my values represents in dollars.&lt;br&gt;
for example if i want to write 200 , before writing 200 i will append $ to the value and write it in excel.
&lt;br&gt;
and am changing the style into number first and than into currency By using Below Statements
&lt;br&gt;
worksheet.Cells[startRow, 2, row, 13].Style.Numberformat.Format = "#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00";&lt;br&gt;
worksheet.Cells[startRow, 2, row, 13].Style.Numberformat.Format = "\"$\"#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00_);(\"$\"#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00)";
&lt;br&gt;
but it is changing into currency but am facing a problem.&lt;br&gt;
if we open an excel 2007&amp;nbsp; and write 100 value than it will automatically aligns to right side. and if we write negative value when it is in currency format it will display in red colour.&lt;br&gt;
but here am facing a problem is values are not aliging right, so am aligning them to right by using&amp;nbsp;
&lt;br&gt;
worksheet.Cells[startRow, 2, row, 13].Style.HorizontalAlignment = ExcelHorizontalAlignment.Right;&lt;br&gt;
my problem is values should be formatted to currency and if any negative value is there it should display in redcolor to the user.&lt;br&gt;
Any suggestions or Example will be useful for me.&lt;br&gt;
&lt;br&gt;
Please do the needful.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="22/07/2010 11:35:07">
          <Html>
        
&lt;p&gt;I think we dont have conditional color feature&amp;nbsp;yet....but you can code by yourself, when you set your cell value, check if it is a negative number and&amp;nbsp;do what you want.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="reddy506" When="22/07/2010 14:56:17">
          <Html>
        
&lt;p&gt;Thank u.&lt;/p&gt;
&lt;p&gt;for color it is ok.&lt;/p&gt;
&lt;p&gt;but is there any idea to convert it to currency.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="25/07/2010 13:58:03">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;If you used Excelpackage you properbly convert your numbers to&amp;nbsp;strings using the ToString metod?&lt;/p&gt;
&lt;p&gt;If you do that it will be treated as a string instread of a number and&amp;nbsp;will not&amp;nbsp;be formatted.&lt;/p&gt;
&lt;p&gt;Use numeric datatypes&amp;nbsp;for numbers and the DateTime datattype for Date/Time instead of strings.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="modify worksheet header">
      <Posts>
        <Post From="raptor909" When="22/07/2010 03:06:06">
          <Html>
        
&lt;p&gt;I have several worksheet templates that I use to generate reports with EPPlus.&amp;nbsp; When I was using the original ExcelPackage library my title areas worked as long as I did not attempt to modify any text.&amp;nbsp; I switched to EPPlus and my titles all disappeared.&amp;nbsp;
 My main reason for switching is that I needed to be able to modify the title areas in some reports but if I did that in excelpackage the resulting file could not be opened.&amp;nbsp; Is there a known issue with titles in worksheets, and if so how do I work around
 it?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="25/07/2010 13:43:03">
          <Html>
        
&lt;p&gt;No, not what I know of. Create an issue and Upload&amp;nbsp;the template and I'll have a look at it when i get back.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Length cannot be less than zero. ArgumentOutOfRangeException">
      <Posts>
        <Post From="mo9a7i" When="24/07/2010 08:48:52">
          <Html>
        
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div&gt;
&lt;div id="DescriptionPanel"&gt;I'm receving this error when I call:&lt;br&gt;
excely.Workbook.Worksheets[1]&lt;br&gt;
then it calls:&lt;br&gt;
string sheet = fullAddress.Substring(0, splitPos); from ExcelWorkbook.cs&lt;br&gt;
&lt;br&gt;
and this causes the error,&lt;br&gt;
&lt;br&gt;
could you please help me on this one?&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;screen shots are provided here:&lt;/p&gt;
&lt;p&gt;http://epplus.codeplex.com/Project/Download/AttachmentDownload.ashx?ProjectName=EPPlus&amp;amp;WorkItemId=11588&amp;amp;FileAttachmentId=3316&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Extra backslashes added to Numberformat AND HorizontalAlignment not working?">
      <Posts>
        <Post From="juxtaposed" When="12/05/2010 00:04:09">
          <Html>
        
&lt;p&gt;I have two problems while trying to use the library.&lt;/p&gt;
&lt;p&gt;1) I declared a cell style that contains a dollar sign ( $ ). When the file is saved, either EPPlus or Excel, I'm not sure which, adds an extra backslash in front of my format.&lt;/p&gt;
&lt;p&gt;Example:&lt;/p&gt;
&lt;pre&gt;ExcelRange.Style.Numberformat.Format = @"$#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00_);($#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00)";&lt;/pre&gt;
&lt;p&gt;That's a literal/verbatim string. But if you open up the Excel spreadsheet generated, and look at the format used on the cell, it's listed as:&lt;/p&gt;
&lt;pre&gt;\$#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00_);($#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00)&lt;/pre&gt;
&lt;p&gt;2) This style is applied to the same cell mentioned above:&lt;/p&gt;
&lt;pre&gt;range.Style.HorizontalAlignment = ExcelHorizontalAlignment.Left;&lt;/pre&gt;
&lt;p&gt;But when you open the file, it cell is not left aligned. Since it's a number, Excel automatically tries to right align it. Help?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="12/05/2010 07:59:35">
          <Html>
        
&lt;p&gt;Hi &lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;I had a look at your problems and I could not replicate your first problem (at least not with the latest source).
&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;2) This is a bug. I have missed to add the General alignment to the Horizontal alignment enum and set the Left enum as default. That means left will be formated as general.&lt;/p&gt;
&lt;p&gt;I have fixed it, but I cant check it in right now since I have a few unfinished things im working on. I'll try to check it in next week.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;If you are in a hurry you can fix it your self. Add&amp;nbsp;General to the&amp;nbsp;ExcelHorizontalAlignment enum and change the default values from ExcelHorizontalAlignment.Left to ExcelHorizontalAlignment.General (a few&amp;nbsp;places in&amp;nbsp;the ExcelXfsXml class)&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="juxtaposed" When="12/05/2010 16:54:58">
          <Html>
        
&lt;p&gt;Jan, thanks for the quick response. I'll put in&amp;nbsp;your quick fix just for development purposes, and update the lib accordingly when you release a new revision.&lt;/p&gt;
&lt;p&gt;I know the first problem is a little obscure.&amp;nbsp;The Numberformat that I specified above is the same thing as the predefined format for Currency in Excel 2007. But when viewing the output cell, the format drop down lists it as "Custom." It should
 show up as Currency.&lt;/p&gt;
&lt;p&gt;I found the extra backslash by right clicking on the cell &amp;gt; Format Cells. It will show the the format string in the "Type" input box. "\$#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00_);(\$#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00)"&lt;/p&gt;
&lt;p&gt;If you remove the backslash and hit OK, the drop down changes to Currency, It looks like something is escaping the dollar sign symbols prior to output into the XML file.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="17/05/2010 20:51:05">
          <Html>
        
&lt;p&gt;I'm not sure what's the wrong here, but try extract the EPPlus generated package and then create one in Excel with the format you want and do the same (just rename them xxx.xlsx.zip).&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Compare the formats in the&amp;nbsp;xl\Styles.xml files.&lt;/p&gt;
&lt;p&gt;My file started like this (with the lates source). So i dont know where the backslashes comes from.&lt;/p&gt;
&lt;p&gt;&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;styleSheet&lt;/span&gt;
&lt;span style="color: red;"&gt;xmlns:d&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;http://schemas.openxmlformats.org/spreadsheetml/2006/main&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;
&lt;span style="color: red;"&gt;xmlns&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;http://schemas.openxmlformats.org/spreadsheetml/2006/main&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;
&amp;nbsp; &lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;d&lt;/span&gt;&lt;span style="color: blue;"&gt;:&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;numFmts&lt;/span&gt;
&lt;span style="color: red;"&gt;count&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;4&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;numFmt&lt;/span&gt;
&lt;span style="color: red;"&gt;numFmtId&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;164&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;
&lt;span style="color: red;"&gt;formatCode&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;yyyy-mm-dd&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;
&lt;span style="color: blue;"&gt;/&amp;gt;&lt;/span&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;numFmt&lt;/span&gt;
&lt;span style="color: red;"&gt;numFmtId&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;165&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;
&lt;span style="color: red;"&gt;formatCode&lt;/span&gt;&lt;span style="color: blue;"&gt;=&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;&lt;span style="color: blue;"&gt;$#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00_);($#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00)&lt;/span&gt;&lt;span style="color: black;"&gt;"&lt;/span&gt;
&lt;span style="color: blue;"&gt;/&amp;gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;if you cant get it to work, please send me some sample code and what regional settings you are using&lt;br&gt;
&lt;br&gt;
&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="juxtaposed" When="17/05/2010 23:53:19">
          <Html>
        
&lt;p&gt;Jan, thanks. I did what you described, and it turns out it was a conflict with Excel's use of the dollar symbol. So if you want to display the dollar sign in a cell, it needs to be escaped. Either by a backslash, or as the "Currency" format uses,
 by encasing the dollar symbol in double quotes. So basically, it should be like this:&lt;/p&gt;
&lt;pre&gt;ExcelRange.Style.Numberformat.Format = &lt;span style="color: rgb(163, 21, 21);"&gt;"\"$\"#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00_);(\"$\"#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00)"&lt;/span&gt;;&lt;/pre&gt;
&lt;p&gt;Thanks for all of the help and patience.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="reddy506" When="22/07/2010 12:12:52">
          <Html>
        
&lt;p&gt;Hi &lt;a id="ctl00_ctl00_MasterContent_Content_PostRepeater_ctl08_UserNameLink" href="http://www.codeplex.com/site/users/view/juxtaposed" rel="nofollow"&gt;
juxtaposed&lt;/a&gt;,&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;i have a doubt i am using as&lt;/p&gt;
&lt;p&gt;&lt;span style="font-size: x-small;"&gt;&lt;span style="font-size: x-small;"&gt;&lt;span style="font-size: x-small;"&gt;&amp;lt;font size="2"&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;worksheet.Cells[row, col].Style.Numberformat.Format =&lt;/p&gt;
&amp;lt;/font&amp;gt;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;"\"$\"#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00_);(\"$\"#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00)"&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: x-small;"&gt;;
&lt;/span&gt;
&lt;p&gt;it is converting in to currency. if we click on a cell it is giving that it as an error if i click on it , it is showing&lt;/p&gt;
&lt;p&gt;as Number stored as text.&lt;/p&gt;
&lt;p&gt;For Example if we open an new excel and write an integer value than it will automatically aligns right side. and in excel 2007&lt;/p&gt;
&lt;p&gt;there is a currency format which shows in red color if any value as negative.&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;
&lt;p&gt;and one more doubt is &lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;"\"$\"#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00_);(\"$\"#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00)"
&lt;span style="color: rgb(0, 0, 0);"&gt;whether we have to write in any EPPlus class(Such as excelnumberformat,format classes or)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(0, 0, 0); font-size: x-small;"&gt;&lt;span style="font-size: x-small;"&gt;&amp;nbsp;file or directly in the code page we can use it.&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(0, 0, 0); font-size: x-small;"&gt;&lt;span style="font-size: x-small;"&gt;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(0, 0, 0); font-size: x-small;"&gt;&lt;span style="font-size: x-small;"&gt;i hope some suggestions.&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Format cell as currency">
      <Posts>
        <Post From="reddy506" When="21/07/2010 14:38:27">
          <Html>
        
&lt;p&gt;Hi all,&lt;/p&gt;
&lt;p&gt;I am not using any excel template.&lt;/p&gt;
&lt;p&gt;am creating a excel from scratch.&lt;/p&gt;
&lt;p&gt;but i want format a cell to currency.&lt;/p&gt;
&lt;p&gt;i can convert it in to number but i cant convert it into currency.&lt;/p&gt;
&lt;p&gt;please i need solution to implement it.&lt;/p&gt;
&lt;p&gt;its very urgent please.&lt;/p&gt;
&lt;p&gt;Thanks in advance.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="carlescs" When="21/07/2010 16:16:09">
          <Html>
        
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;cell.Style.Numberformat.Format = &lt;span style="color: rgb(163, 21, 21);"&gt;"#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00 €;-#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00 €"&lt;/span&gt;;
&lt;/pre&gt;
&lt;pre&gt;I suppose you'll have to change the € for your currency sign or something...&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="reddy506" When="22/07/2010 05:44:18">
          <Html>
        
&lt;p&gt;no its not changing to currency but its changing to custom.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;please help me in it.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Column width in ExcelRange.">
      <Posts>
        <Post From="reddy506" When="21/07/2010 13:03:00">
          <Html>
        
&lt;p&gt;hi i have a excel range and i have to set column width to it.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;am not able to do it.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;could any body sugget it how to do it.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Password protected Excel file">
      <Posts>
        <Post From="wwwnlc111" When="08/07/2010 13:20:00">
          <Html>
        All, How we can make password protected Excel file using EPPlus. If you have any idea please share here. Thanks, -------------- Nagen
        
    </Html>
        </Post>
        <Post From="jankallman" When="08/07/2010 14:20:50">
          <Html>
        
&lt;p&gt;You can't create encrypted workbooks, if that is what you want to do.&lt;/p&gt;
&lt;p&gt;The component uses the System.IO.Packaging API and I don't think it supports encrypted xlsx files.&lt;/p&gt;
&lt;p&gt;You can protect a worksheet using a password (Worksheet.Protection.SetPassword method), but that only locks cells, hide formulas etc, for locked cells.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Web Export to Excel 2010">
      <Posts>
        <Post From="buda56" When="24/06/2010 13:14:32">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp; I am trying to export data from my SQL server through a Web page to Excel 2010, I have setup my project similar to that described on the CodePlex web page. The data collection seems to work correctly an it exports directly to excel. The issue
 I have is that as Excel opens the file I get an error message "Excel found unreadable content in 'Sample2-12.xlsx. Do you want to recover the contents of the WorkBook?"&lt;/p&gt;
&lt;p&gt;By selecting Yes the file continues to load in excel then a popup window shows stating that Excel was able to open the file by either repairing or deleting the unreadable content.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Any assistance would be greatly appreciated.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;
&lt;p&gt;Peter&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="27/06/2010 20:06:23">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I'm not sure whats wrong here, but have a closer look at any formula or number format you have. There is no validation of formulas or numberformats, so if you get&amp;nbsp;it wrong you will get this error message. Try to find the row causing the error by comment
 code out until you dont get any error message. If you cant see any obvious error, report it here and i will have a look.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="buda56" When="27/06/2010 22:28:43">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp; The issue has been resolved, Still do not know what was causing the issue (Googling I found similar issues with Windows7 and office 2007), I am running it on Windows 7 with Office 2010. Once I deployed the site and tried the download it worked
 perfectly and since that time my local copy has been working correctly as well.&lt;/p&gt;
&lt;p&gt;I have one additional question though is it possible to save the excel download as Excel 2003?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;
&lt;p&gt;Peter.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="29/06/2010 11:24:58">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;No, this component is for ooxml--&amp;gt;xlsx only. You have to install the &lt;span style="color: rgb(0, 0, 0);"&gt;
Microsoft Office Compatibility Pack to use it in Excel 2003.&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(0, 0, 0);"&gt;If you need xls, have a look at the NPOI project&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(0, 0, 0);"&gt;Jan&lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="buda56" When="29/06/2010 22:45:31">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;&amp;nbsp; Thanks for the update. That will be fine using Office 2007 format.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;
&lt;p&gt;Peter.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Richtech cell">
      <Posts>
        <Post From="mrxrsd" When="17/06/2010 20:19:20">
          <Html>
        
&lt;p&gt;Jan,&lt;/p&gt;
&lt;p&gt;now can I have two different font color in the same cell ?&lt;/p&gt;
&lt;p&gt;tks&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="17/06/2010 22:04:28">
          <Html>
        
&lt;p&gt;Yes, use the RichText.Add collection. Should work on Cells, Comment, Shapes and Chart Titles.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Line Chart">
      <Posts>
        <Post From="Mardon" When="29/04/2010 13:38:07">
          <Html>
        
&lt;p&gt;Hello I am using EPPlus to populate an excel spreadsheet with two columns of data. I now want to take that data, and populate it into a line chart. I have tried different ways of populating the line chart but so far nothing is working. Is there any chance
 that this functionality is not working? If it is working could you post or e-mail me some sample code, it is possible i am just missing a minor detail. Thanks&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="29/04/2010 14:28:21">
          <Html>
        
&lt;p&gt;Sample 4 has a line chart or have a look at sample 6 (not a line chart but you add the series the same way).&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Mardon" When="30/04/2010 02:46:26">
          <Html>
        
&lt;p&gt;Here is my code. I am populating two columns with 32k records each. I then format the data to a number format. I took the sample from sample6 trying to implement a LineChart. Below is the code I implemented using the exampl in sample6 as you suggested. Could
 you take a look and see if you can see why the LineChart is not being created.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ws.Cells.Style.ShrinkToFit = true;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; var chart = ws.Drawings.AddChart("LineChart", eChartType.Line);&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; chart.SetPosition(160, 30, 800, 600);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; chart.SetSize(400, 400);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; chart.Series.Add(ExcelRange.GetAddress(1, 1, row, columns), ExcelRange.GetAddress(1, 1, row, columns));&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; chart.Title.Text = "Equity Curve";&lt;/p&gt;
&lt;p&gt;If you need the full code please let me know.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="30/04/2010 07:50:46">
          <Html>
        
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;You set the X and Y serie to the same range. Try something like...&lt;/pre&gt;
&lt;pre&gt;&lt;div style="color: black; background-color: white;"&gt;&lt;pre&gt;chart.Series.Add(ExcelRange.GetAddress(1, 2, row, 2), ExcelRange.GetAddress(1, 1, row, 1));&lt;/pre&gt;
&lt;pre&gt;... depending on your columns&lt;/pre&gt;
&lt;/div&gt;
&amp;nbsp;&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="Mardon" When="13/06/2010 01:33:02">
          <Html>
        
&lt;p&gt;It has been a while since i posted.&lt;/p&gt;
&lt;p&gt;Here is what i ended up implementing.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;ExcelPackage excelPackage = new ExcelPackage(new FileInfo(@"C:\Projects\TestingEPPlus\TestingEPPlus\TestingEPPlus\Report.xlsx"));&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;ExcelWorksheet worksheet = excelPackage.Workbook.Worksheets[1];&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;ExcelChart chart = worksheet.Drawings.AddChart("LineChart", eChartType.Line);&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;chart.Series.Add(ExcelRange.GetAddress(1, 2, worksheet.Dimension.End.Row, 2),&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ExcelRange.GetAddress(1, 1, worksheet.Dimension.End.Row, 1));&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;var Series = chart.Series[0];&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;chart.Series[0].Header = "Blah";&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;excelPackage.SaveAs(new FileInfo(@"C:\Projects\TestingEPPlus\TestingEPPlus\TestingEPPlus\ReportTest.xlsx"));&lt;/p&gt;
&lt;p&gt;&amp;nbsp;Input of the report.xlsx was in the following format.&lt;/p&gt;
&lt;table width="135" border="0" cellspacing="0" cellpadding="0"&gt;
&lt;colgroup span="1"&gt;&lt;col width="64" span="1"&gt;&lt;col width="71" span="1"&gt;&lt;/colgroup&gt;
&lt;tbody&gt;
&lt;tr height="20"&gt;
&lt;td width="64" height="20" align="right"&gt;1&lt;/td&gt;
&lt;td width="71" align="right"&gt;$10,000.00&lt;/td&gt;
&lt;/tr&gt;
&lt;tr height="20"&gt;
&lt;td height="20" align="right"&gt;2&lt;/td&gt;
&lt;td align="right"&gt;$10,100.00&lt;/td&gt;
&lt;/tr&gt;
&lt;tr height="20"&gt;
&lt;td height="20" align="right"&gt;3&lt;/td&gt;
&lt;td align="right"&gt;$10,200.00&lt;/td&gt;
&lt;/tr&gt;
&lt;tr height="20"&gt;
&lt;td height="20" align="right"&gt;4&lt;/td&gt;
&lt;td align="right"&gt;$10,150.00&lt;/td&gt;
&lt;/tr&gt;
&lt;tr height="20"&gt;
&lt;td height="20" align="right"&gt;5&lt;/td&gt;
&lt;td align="right"&gt;$10,250.00&lt;/td&gt;
&lt;/tr&gt;
&lt;tr height="20"&gt;
&lt;td height="20" align="right"&gt;6&lt;/td&gt;
&lt;td align="right"&gt;$10,200.00&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;For some reason instead of having just series one we saw that each number on the left was in the legend. This feels wrong from the way that excel works. Can you check into this for line graphs.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="13/06/2010 20:09:31">
          <Html>
        
&lt;p&gt;Hi&lt;/p&gt;
&lt;p&gt;Im not sure I understand&amp;nbsp;the problem?&lt;/p&gt;
&lt;p&gt;I tried this code (with the lates source) and I only got one serie and one label in the legend...&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;           ExcelWorksheet worksheet = _pck.Workbook.Worksheets.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"LineIssue"&lt;/span&gt;);

           ExcelChart chart = worksheet.Drawings.AddChart(&lt;span style="color: rgb(163, 21, 21);"&gt;"LineChart"&lt;/span&gt;, eChartType.Line);
           
           worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;].Value=1;
           worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A2"&lt;/span&gt;].Value=2;
           worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A3"&lt;/span&gt;].Value=3;
           worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A4"&lt;/span&gt;].Value=4;
           worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A5"&lt;/span&gt;].Value=5;
           worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A6"&lt;/span&gt;].Value=6;

           worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"B1"&lt;/span&gt;].Value=10000;
           worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"B2"&lt;/span&gt;].Value=10100;
           worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"B3"&lt;/span&gt;].Value=10200;
           worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"B4"&lt;/span&gt;].Value=10150;
           worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"B5"&lt;/span&gt;].Value=10250;
           worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"B6"&lt;/span&gt;].Value=10200;

            chart.Series.Add(ExcelRange.GetAddress(1, 2, worksheet.Dimension.End.Row, 2),
                            ExcelRange.GetAddress(1, 1, worksheet.Dimension.End.Row, 1));

           &lt;span style="color: blue;"&gt;var&lt;/span&gt; Series = chart.Series[0];
           
           chart.Series[0].Header = &lt;span style="color: rgb(163, 21, 21);"&gt;"Blah"&lt;/span&gt;;

Jan&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="Mardon" When="17/06/2010 02:30:48">
          <Html>
        
&lt;p&gt;Jan&lt;/p&gt;
&lt;p&gt;I just pulled down the latest source code compiled it and am running it in a test application.&lt;/p&gt;
&lt;p&gt;I pulled in your sample code into my test application. When i generate the chart i still get the values for A1:A6 as the legend. I am not sure what i might be doing wrong i am using 59508.&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;
&lt;p&gt;Chris&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Importing from xlsx doesnt import all rows">
      <Posts>
        <Post From="Svein" When="16/06/2010 11:18:45">
          <Html>
        
&lt;p&gt;Hi - Im experiencing trouble when importing cells from an excel 2007 file to a datatable.&lt;/p&gt;
&lt;p&gt;Prosedure: The xlsx file is generated with Epplus, some cells are edited in excel2007, file is saved in excel 2007, file is imported via Epplus to datatable.&lt;/p&gt;
&lt;p&gt;When NOT editing the cells in Excel, the import reads whole worksheet.&lt;/p&gt;
&lt;p&gt;When editing some of the cells the import stops at&amp;nbsp;random, on one of&amp;nbsp;the edited rows.&lt;/p&gt;
&lt;p&gt;So my question is: do anybody experience the same problems?&lt;/p&gt;
&lt;p&gt;The code seems allright because all rows are imported when the xlsx file is not edited. So my guess is that the problems occurs because of user activity when editing the xlsx file. Corrupting the cells content with hidden characters like Tab/Enter etc...?
 I have tried to trim and remove tabs and linefeeds but nothing helps.&lt;/p&gt;
&lt;p&gt;Im I missing something out?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="16/06/2010 11:25:20">
          <Html>
        
&lt;p&gt;When you say stops, d&lt;span id="_mce_start" style="line-height: 0;"&gt;﻿&lt;/span&gt;o you get an Exception&lt;span id="_mce_start" style="line-height: 0;"&gt;﻿&lt;/span&gt;&lt;span id="_mce_start" style="line-height: 0;"&gt;﻿&lt;/span&gt;&lt;span id="_mce_start" style="line-height: 0;"&gt;﻿&lt;/span&gt;?&lt;span id="_mce_start" style="line-height: 0;"&gt;﻿&lt;/span&gt;&lt;span id="_mce_start" style="line-height: 0;"&gt;﻿&lt;/span&gt;&lt;span id="_mce_start" style="line-height: 0;"&gt;&lt;span id="_mce_start" style="line-height: 0;"&gt;&lt;span id="_mce_end" style="line-height: 0;"&gt;﻿&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Svein" When="16/06/2010 11:57:59">
          <Html>
        
&lt;p&gt;no...&amp;nbsp; the function proseeds with no error messages...&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="16/06/2010 12:51:20">
          <Html>
        
&lt;p&gt;ok..hard to tell what the problem is. Post your code here so I can have look.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Svein" When="16/06/2010 17:18:32">
          <Html>
        
&lt;p&gt;have found the problem - and Yes Im missing something out - my own code was the cause ;)&lt;/p&gt;
&lt;p&gt;Svein&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Problem with creating Worksheets">
      <Posts>
        <Post From="pankajlohani" When="15/06/2010 07:37:00">
          <Html>
        
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;&lt;em&gt;&lt;br&gt;
&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;&lt;em&gt;&lt;br&gt;
&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="15/06/2010 07:57:32">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Excel do not allowed you to have : / \ ? [ ] in the sheet name.&lt;/p&gt;
&lt;p&gt;The error message is a bug in the validation. I'll fix that.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="created excel document has xml inside of cells">
      <Posts>
        <Post From="tfsmag" When="12/06/2010 16:38:42">
          <Html>
        
&lt;p&gt;The header rows appear to be coming in correctly, but the content in the cells is coming in with the open xml formatting appearing in the cells. any suggestions?&lt;/p&gt;
&lt;p&gt;Here's the code I'm using.&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;    &lt;span style="color: blue;"&gt;Sub&lt;/span&gt; DumpExcel(&lt;span style="color: blue;"&gt;ByVal&lt;/span&gt; tbl &lt;span style="color: blue;"&gt;As&lt;/span&gt; DataTable)
        &lt;span style="color: blue;"&gt;Using&lt;/span&gt; pck &lt;span style="color: blue;"&gt;As&lt;/span&gt; &lt;span style="color: blue;"&gt;New&lt;/span&gt; ExcelPackage()
            &lt;span style="color: green;"&gt;'Create the worksheet&lt;/span&gt;
            &lt;span style="color: blue;"&gt;Dim&lt;/span&gt; ws &lt;span style="color: blue;"&gt;As&lt;/span&gt; ExcelWorksheet = pck.Workbook.Worksheets.Add(&lt;span style="color: rgb(163, 21, 21);"&gt;"Demo"&lt;/span&gt;)

            &lt;span style="color: green;"&gt;'Load the datatable into the sheet, starting from cell A1. Print the column names on row 1&lt;/span&gt;
            ws.Cells(&lt;span style="color: rgb(163, 21, 21);"&gt;"A1"&lt;/span&gt;).LoadFromDataTable(tbl, &lt;span style="color: blue;"&gt;True&lt;/span&gt;)

            &lt;span style="color: green;"&gt;'Format the header for column 1-3&lt;/span&gt;
            &lt;span style="color: blue;"&gt;Using&lt;/span&gt; rng &lt;span style="color: blue;"&gt;As&lt;/span&gt; ExcelRange = ws.Cells(&lt;span style="color: rgb(163, 21, 21);"&gt;"A1:Z1"&lt;/span&gt;)
                rng.Style.Font.Bold = &lt;span style="color: blue;"&gt;True&lt;/span&gt;
                rng.Style.Fill.PatternType = ExcelFillStyle.Solid
                &lt;span style="color: green;"&gt;'Set Pattern for the background to Solid&lt;/span&gt;
                rng.Style.Fill.BackgroundColor.SetColor(System.Drawing.Color.FromArgb(79, 129, 189))
                &lt;span style="color: green;"&gt;'Set color to dark blue&lt;/span&gt;
                rng.Style.Font.Color.SetColor(System.Drawing.Color.White)
            &lt;span style="color: blue;"&gt;End&lt;/span&gt; &lt;span style="color: blue;"&gt;Using&lt;/span&gt;

            &lt;span style="color: green;"&gt;'Example how to Format Column 1 as numeric &lt;/span&gt;
            &lt;span style="color: blue;"&gt;Using&lt;/span&gt; col &lt;span style="color: blue;"&gt;As&lt;/span&gt; ExcelRange = ws.Cells(2, 1, 2 + tbl.Rows.&lt;span style="color: blue;"&gt;Count&lt;/span&gt;, 1)
                col.Style.Numberformat.Format = &lt;span style="color: rgb(163, 21, 21);"&gt;"#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;.00"&lt;/span&gt;
                col.Style.HorizontalAlignment = ExcelHorizontalAlignment.Right
            &lt;span style="color: blue;"&gt;End&lt;/span&gt; &lt;span style="color: blue;"&gt;Using&lt;/span&gt;

            &lt;span style="color: green;"&gt;'Write it back to the client&lt;/span&gt;

            Response.Clear()
            Response.AddHeader(&lt;span style="color: rgb(163, 21, 21);"&gt;"content-disposition"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"attachment;  filename="&lt;/span&gt; &amp;amp; tbl.TableName &amp;amp; &lt;span style="color: rgb(163, 21, 21);"&gt;".xlsx"&lt;/span&gt;)
            Response.ContentType = &lt;span style="color: rgb(163, 21, 21);"&gt;"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"&lt;/span&gt;
            Response.BinaryWrite(pck.GetAsByteArray())
            Response.&lt;span style="color: blue;"&gt;End&lt;/span&gt;()

        &lt;span style="color: blue;"&gt;End&lt;/span&gt; &lt;span style="color: blue;"&gt;Using&lt;/span&gt;
    &lt;span style="color: blue;"&gt;End&lt;/span&gt; &lt;span style="color: blue;"&gt;Sub&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="tfsmag" When="12/06/2010 16:39:56">
          <Html>
        
&lt;p&gt;btw, here's a sample of the cell content&lt;/p&gt;
&lt;p&gt;&lt;br&gt;
&amp;lt;Cell ss:StyleID="s65"&amp;gt;&amp;lt;Data ss:Type="String"&amp;gt;May / 7&amp;lt;/Data&amp;gt;&amp;lt;/Cell&amp;gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="13/06/2010 19:52:31">
          <Html>
        
&lt;p&gt;Sounds strange.&lt;/p&gt;
&lt;p&gt;The LoadFromDataset only sets the values from the datatable.&lt;/p&gt;
&lt;p&gt;What kind of data do you have in the datatable?&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="tfsmag" When="14/06/2010 14:11:20">
          <Html>
        Nevermind... I figured it out. The data was being run through a filter that someone had used to attempt to write excel xml. Once I removed that filter it came out fine.
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Autorefresh of formulabased content">
      <Posts>
        <Post From="Svein" When="04/06/2010 09:33:18">
          <Html>
        
&lt;p&gt;Hi&lt;/p&gt;
&lt;p&gt;Im having trouble with "refreshing" the content in formulabased cells.&lt;/p&gt;
&lt;p&gt;The program flow is as following:&lt;/p&gt;
&lt;p&gt;1 - import csv to Datatable&lt;/p&gt;
&lt;p&gt;2 - Update content and set formulaes &amp;gt; save to excel with Epplus&lt;/p&gt;
&lt;p&gt;3 - Import Excel file&amp;nbsp;to datatable&lt;/p&gt;
&lt;p&gt;My flow may seem inlogical, but before importing the&amp;nbsp;excel again to my application I usally have split the excelfiles manually an done som QA, sorting etc :)&lt;/p&gt;
&lt;p&gt;In other words I usually - Save the excel file&amp;nbsp;IN MS-EXCEL - before importing it again. The formula values is then correctly updated.&lt;/p&gt;
&lt;p&gt;But: in some cases I have to&amp;nbsp;import the ORIGNAL xlsx file, generated with Epplus, without opening it manually&amp;nbsp;and re-saving it with MS-Excel.&amp;nbsp; The problem occures in theese instances. When imorting, none of the formulas show the correct values.&lt;/p&gt;
&lt;p&gt;Any suggestions?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="04/06/2010 14:10:04">
          <Html>
        
&lt;p&gt;Hi again.&lt;/p&gt;
&lt;p&gt;The component has no calculation engine, so all formulas&amp;nbsp;are calculated in Excel.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="Svein" When="04/06/2010 16:02:03">
          <Html>
        
&lt;p&gt;Ok - have to use a com interface to open and resave the xlsx file silently,&amp;nbsp;right after generating it then.&lt;/p&gt;
&lt;p&gt;Thought it was possible to assign a&amp;nbsp;"refresh formula on opening" option to formulaes. Ive seen it 'somwhere' in docs from one of the several&amp;nbsp;packages ive been testing lately.&amp;nbsp;But havent the slightest clue from where.....&amp;nbsp; :)&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Regards :)&lt;/p&gt;
&lt;p&gt;Svein&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="06/06/2010 13:40:20">
          <Html>
        
&lt;p&gt;I dont know if you mean the CalcMode property in the workbook class, but you still need to open it in Excel to have the formulas calculated&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Next version">
      <Posts>
        <Post From="jankallman" When="01/06/2010 22:28:04">
          <Html>
        
&lt;p&gt;Hi all!&lt;/p&gt;
&lt;p&gt;I plan to do a new release soon and would really appreciate if some of you could test&amp;nbsp;your&amp;nbsp;projects with the latest source.&lt;/p&gt;
&lt;p&gt;Report any bugs, misspellings&amp;nbsp;or&amp;nbsp;other strange&amp;nbsp;behaviour&amp;nbsp;you find in this thread.&lt;/p&gt;
&lt;p&gt;Feel free to try out the new features, if you like.&lt;/p&gt;
&lt;p&gt;I have added Comments and Cell-Richtext. Ranges can now use more advanced addresses like multi (a1:a2,c1:c2), full row (1:1) or full column (A:A). A lot of new properties to Printersettings.&lt;/p&gt;
&lt;p&gt;A lot of bugs has also been fixed (more than I have added&amp;nbsp;I hope :) )&lt;/p&gt;
&lt;p&gt;Thnx Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="02/06/2010 02:52:11">
          <Html>
        
&lt;p&gt;u can count with me. =)&lt;/p&gt;
&lt;p&gt;Jan, do u have plans to fully rewrite excel package code and make epplus LGPL ?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="02/06/2010 13:49:43">
          <Html>
        
&lt;p&gt;Great!&lt;/p&gt;
&lt;p&gt;Actually almost all code is rewritten already, but i think there&amp;nbsp;are a few fragments left.&lt;/p&gt;
&lt;p&gt;Still, a lot of the interface are shared (and i cant change that), so I dont know if rewriting the code allows me to change the license? I'm really no expert in GPL.&lt;/p&gt;
&lt;p&gt;I send a mail to John&amp;nbsp;(creator of Excelpackage) a few months ago to ask if I could change the license, but I hav'nt gotten any replay. So at the moment I really dont know.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="juxtaposed" When="02/06/2010 19:22:09">
          <Html>
        
&lt;p&gt;Jan, I will test it too. Did you get a chance to add the Copy worksheet method to the lib?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="juxtaposed" When="02/06/2010 22:03:24">
          <Html>
        
&lt;p&gt;I'm actually getting an exception when using&amp;nbsp;&amp;nbsp;public ExcelWorksheet Add(string Name, ExcelWorksheet Copy)&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;pre&gt;PackageRelationship with specified ID does not exist for the source part.
&lt;/pre&gt;
&lt;pre&gt;&lt;br&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;br&gt;&lt;/pre&gt;
&lt;pre&gt;Sample code:&lt;/pre&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;var xlPackage = LoadTemplateFile(ModelViewFilename);&lt;br&gt;
&amp;nbsp;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;var templateWs = xlPackage.Workbook.Worksheets["Template"];&lt;br&gt;
&amp;nbsp;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;ExcelWorksheet worksheet = xlPackage.Workbook.Worksheets.Add("test", templateWs);&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="02/06/2010 22:08:26">
          <Html>
        
&lt;p&gt;Ok, i'll have a look at it&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="juxtaposed" When="02/06/2010 22:14:06">
          <Html>
        
&lt;p&gt;If it's of any help, the exception is thrown in ExcelWorksheet.cs, line 1549, code:&lt;/p&gt;
&lt;p&gt;PackageRelationship relPrinterSettings = Part.GetRelationship(relID);&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="03/06/2010 08:59:04">
          <Html>
        
&lt;p&gt;That's helpfull, I think the problem was the relationship to the printersettings.bin file. I have checked in a fix. Try it and see if it works.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="sglantz" When="03/06/2010 14:36:57">
          <Html>
        I am getting an error similar to what was reported &lt;a href="http://epplus.codeplex.com/Thread/View.aspx?ThreadId=213606" rel="nofollow"&gt;
here&lt;/a&gt; when trying to open a template. I am receiving a NullReferenceException on line 159 of ExcelWorkbook.cs. I was able to get the file to load properly by saving the template in a different format then resaving it as an xlsx file. If you want I can email
 you the two different templates so you can troubleshoot the error.
        
    </Html>
        </Post>
        <Post From="juxtaposed" When="03/06/2010 17:37:01">
          <Html>
        
&lt;p&gt;Jan, I tried version 59488 and the problem is fixed. Thank you so much.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to set page size">
      <Posts>
        <Post From="pongthorn" When="03/06/2010 05:29:09">
          <Html>
        
&lt;p&gt;How to set page size such as A3 0r A4&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="pongthorn" When="03/06/2010 07:16:23">
          <Html>
        
&lt;p&gt;Now I download lastert version&lt;/p&gt;
&lt;p&gt;thanks a lot&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Line charts: Specify placement of headers?">
      <Posts>
        <Post From="juxtaposed" When="24/05/2010 22:58:52">
          <Html>
        
&lt;p&gt;Does anyone know if it's possible to specify the placement of the headers when dealing with line charts?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="25/05/2010 20:48:47">
          <Html>
        
&lt;p&gt;You can't do&amp;nbsp;that in the component in the current release, but i'll add that to my TODO-list (or feel free to have a look at it, if you want to).&lt;/p&gt;
&lt;p&gt;You can always set it using the the ChartXML.&lt;/p&gt;
&lt;p&gt;/Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="List of questions - regarding charts!">
      <Posts>
        <Post From="afeuer" When="20/05/2010 09:44:07">
          <Html>
        
&lt;p&gt;Hi Jan&lt;/p&gt;
&lt;p&gt;Also, sorry for the list of questions. Here are they&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(255, 0, 0);"&gt;&lt;strong&gt;1&lt;/strong&gt;&lt;/span&gt;. Is it possible to specify custom colors for an entire series of a chart like series.backcolor = color.red...&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;span style="color: rgb(255, 0, 0);"&gt;2&lt;/span&gt;&lt;/strong&gt;. Is it possible to specify colors for&amp;nbsp;individual datapoints&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;span style="color: rgb(255, 0, 0);"&gt;3&lt;/span&gt;&lt;/strong&gt;.&amp;nbsp;I declare a linechart as&amp;nbsp;&lt;span style="font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-size: x-small;"&gt;var&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: x-small;"&gt;
 lineChart = (worksheet.Drawings.AddChart(&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;"Chart1"&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: x-small;"&gt;,
&lt;/span&gt;&lt;span style="color: rgb(43, 145, 175); font-size: x-small;"&gt;&lt;span style="color: rgb(43, 145, 175); font-size: x-small;"&gt;eChartType&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: x-small;"&gt;.LineMarkers)
&lt;/span&gt;&lt;span style="color: rgb(0, 0, 255); font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-size: x-small;"&gt;as&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: x-small;"&gt;
&lt;/span&gt;&lt;span style="color: rgb(43, 145, 175); font-size: x-small;"&gt;&lt;span style="color: rgb(43, 145, 175); font-size: x-small;"&gt;ExcelChart&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: x-small;"&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;I am not able to set the datalabels visible.&lt;/p&gt;
&lt;p&gt;Whereas I could do that for a barchart like&lt;/p&gt;
&lt;p&gt;&lt;span style="font-size: x-small;"&gt;&lt;span style="font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-size: x-small;"&gt;var&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: x-small;"&gt; barChart = (worksheet.Drawings.AddChart(&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;"Chart1"&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: x-small;"&gt;,
&lt;/span&gt;&lt;span style="color: rgb(43, 145, 175); font-size: x-small;"&gt;&lt;span style="color: rgb(43, 145, 175); font-size: x-small;"&gt;eChartType&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: x-small;"&gt;.BarClustered)
&lt;/span&gt;&lt;span style="color: rgb(0, 0, 255); font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-size: x-small;"&gt;as&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: x-small;"&gt;
&lt;/span&gt;&lt;span style="color: rgb(43, 145, 175); font-size: x-small;"&gt;&lt;span style="color: rgb(43, 145, 175); font-size: x-small;"&gt;ExcelBarChart&lt;br&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(0, 128, 0); font-size: x-small;"&gt;&lt;span style="color: rgb(0, 128, 0); font-size: x-small;"&gt;barChart.DataLabel.ShowValue = true;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(0, 0, 0);"&gt;How&amp;nbsp;do&amp;nbsp;I access the datalabel for linecharts and columnclustered charts?&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(0, 0, 0);"&gt;&lt;span style="color: rgb(255, 0, 0);"&gt;&lt;strong&gt;4&lt;/strong&gt;&lt;/span&gt;. Is it possible to alter or choose the marker for line charts?&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Best regards&lt;br&gt;
Kit&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="20/05/2010 15:34:00">
          <Html>
        
&lt;p&gt;Hi again,&lt;/p&gt;
&lt;p&gt;1. No&lt;/p&gt;
&lt;p&gt;2. No&lt;/p&gt;
&lt;p&gt;3. No, I really should add a separate ExcelLineChart class here, but there is non today. The&amp;nbsp;ColumnClustered is an ExcelBarChart.&lt;/p&gt;
&lt;p&gt;4. No, again I should add a a separate class here.&lt;/p&gt;
&lt;p&gt;Alot of no here, but there are tons of properties on the different charts and I have simplified a little here. if its possible for you, use a template and set the properties you want.&lt;/p&gt;
&lt;p&gt;If you want to struggle with the XML you can always use the ChartXML property to alter the the chart-Xml the way you want.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="afeuer" When="20/05/2010 19:02:11">
          <Html>
        
&lt;p&gt;Alright. thanks for the reply Jan. May I ask you whether you already have any of the above points in mind for next release?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="21/05/2010 13:53:09">
          <Html>
        
&lt;p&gt;I added the ExcelLineChart-class to the source this morning so that will be included, you can check it out if you want to.&lt;/p&gt;
&lt;p&gt;I only added a Datalabel property to it, so it's still some way to go.&lt;/p&gt;
&lt;p&gt;Im not going to add any of the other points to the next release (I hope to do one in the coming weeks).&lt;/p&gt;
&lt;p&gt;I'll put it on my TODO list for a future release&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;If you&amp;nbsp;want to, have a look at the ExcelLinechart class and add the properties you need yourself (it would be great with some help :) ).&amp;nbsp;&lt;/p&gt;
&lt;p&gt;It should not be that hard if you are familiar with Xml and XPath. Have a look at the chart-Xml files by extracting&amp;nbsp;your formated&amp;nbsp;xlsx file (just rename it *.zip).&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="afeuer" When="24/05/2010 21:44:24">
          <Html>
        
&lt;p&gt;Hi Jan&lt;/p&gt;
&lt;p&gt;Will check out the ExcelLinechart class first thing tomorrow morning. If I managed to include additional properties,&amp;nbsp; I will update you :)&lt;/p&gt;
&lt;p&gt;I need your guidance on another thing. My scenario is that I have to create a chart in Excel and export it to powerpoint (both the chart and the data). The powerpoint export works perfect incase if I create the excel chart manually in Excel 2007. When I
 try to export the chart created using EPPlus, I face a strange situation&lt;/p&gt;
&lt;p&gt;1. First of all the powerpoint slide appears blank. When I click on the supposed area of chart location I could see the outline box or shape of the chart box.&lt;/p&gt;
&lt;p&gt;2. when I double click on the empty box, the corresponding datasheet opens and now I can see the chart picture in the powerpoint too. (Do you get it? At the first instance the chart is not seen. when I double click on the chartpart (guessing the location)
 the excel sheet opens and the chart pic is seen)&lt;/p&gt;
&lt;p&gt;3. Intrestingly, If I open the excelsheet created by EPPlus in Excel2007 and save it without making anychanges, the export works perfectly.&lt;/p&gt;
&lt;p&gt;4. I compared the excelsheet from EPPlus before(say EPPlus.xlsx)&amp;nbsp;and after opening/saving via Excel2007(say copy.xlsx)&amp;nbsp;and found that the cache details in chart.xml is missing in the EPPlus.xlsx. When I edited the chart.xml and copied in the cache
 data ( taken from the copy.xlsx) the export worked the way I expected.&lt;/p&gt;
&lt;p&gt;5. The question is that Is there a simple / direct way to add the cache data to the chart.xml???? or should I have to edit (or rather struggle) ChartXML and include the cache from the code for each series and each datapoint????????????&lt;/p&gt;
&lt;p&gt;cheers&lt;br&gt;
Kit&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="25/05/2010 19:41:24">
          <Html>
        
&lt;p&gt;Hi Kit&lt;/p&gt;
&lt;p&gt;There is no simple way to add the cache data for the chart. The main reason the chart cache is not updated(apart from that&amp;nbsp;Excel do it for you)&amp;nbsp;is because EPPlus relays on Excel to calculate all forumla values. So if a chart-serie has an underlaying&amp;nbsp;formula
 , the formula values are calculated by Excel. There is no calculation engine in the component.&lt;/p&gt;
&lt;p&gt;I guess you can update the chart.xml the way you descibe or if you can force powerpoint to recalculate the cache in some way.&lt;/p&gt;
&lt;p&gt;Cheers Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="afeuer" When="25/05/2010 20:24:24">
          <Html>
        
&lt;p&gt;Hi Jan&lt;/p&gt;
&lt;p&gt;Good, I will chk that out.&lt;/p&gt;
&lt;p&gt;Meanwhile I have figured out how to set the "&lt;strong&gt;Vary colors by point".
&lt;/strong&gt;Heres the corresponding code. May be useful to somebodyelse&lt;/p&gt;
&lt;p&gt;&lt;span style="font-size: x-small;"&gt;&lt;span style="font-size: x-small;"&gt;&amp;nbsp;&lt;span style="color: rgb(43, 145, 175); font-size: x-small;"&gt;&lt;span style="color: rgb(43, 145, 175); font-size: x-small;"&gt;XmlElement&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: x-small;"&gt; varyColors = barChart.ChartXml.CreateElement(&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;"c"&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: x-small;"&gt;,
&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;"varyColors"&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: x-small;"&gt;,
&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;&lt;a href="http://schemas.openxmlformats.org/drawingml/2006/chart" rel="nofollow"&gt;http://schemas.openxmlformats.org/drawingml/2006/chart&lt;/a&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: x-small;"&gt;);&lt;br&gt;
&lt;/span&gt;&lt;span style="font-size: x-small;"&gt;&lt;span style="font-size: x-small;"&gt;varyColors.SetAttribute(&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;"val"&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: x-small;"&gt;,
&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;"1"&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: x-small;"&gt;);&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: x-small;"&gt;&lt;span style="font-size: x-small;"&gt;&amp;nbsp;&lt;br&gt;
&amp;nbsp;&lt;/span&gt;&lt;span style="color: rgb(43, 145, 175); font-size: x-small;"&gt;&lt;span style="color: rgb(43, 145, 175); font-size: x-small;"&gt;XmlNamespaceManager&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: x-small;"&gt; nsmgr;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: x-small;"&gt;&lt;span style="font-size: x-small;"&gt;
&lt;br&gt;
nsmgr =&lt;/span&gt;&lt;span style="color: rgb(0, 0, 255); font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-size: x-small;"&gt;new&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: x-small;"&gt;
&lt;/span&gt;&lt;span style="color: rgb(43, 145, 175); font-size: x-small;"&gt;&lt;span style="color: rgb(43, 145, 175); font-size: x-small;"&gt;XmlNamespaceManager&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: x-small;"&gt;(barChart.ChartXml.NameTable);&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: x-small;"&gt;&lt;span style="font-size: x-small;"&gt;
&lt;br&gt;
nsmgr.AddNamespace(&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;"c"&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: x-small;"&gt;,
&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;&lt;a href="http://schemas.openxmlformats.org/drawingml/2006/chart" rel="nofollow"&gt;http://schemas.openxmlformats.org/drawingml/2006/chart&lt;/a&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: x-small;"&gt;);&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: x-small;"&gt;&lt;span style="font-size: x-small;"&gt;&amp;nbsp;&lt;br&gt;
&amp;nbsp;&lt;/span&gt;&lt;span style="color: rgb(43, 145, 175); font-size: x-small;"&gt;&lt;span style="color: rgb(43, 145, 175); font-size: x-small;"&gt;XmlNode&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: x-small;"&gt; barC = barChart.ChartXml.SelectSingleNode(&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;"//c:barChart"&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: x-small;"&gt;,
 nsmgr);&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: x-small;"&gt; &lt;br&gt;
barC.PrependChild(varyColors);&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; &lt;/p&gt;
&lt;p&gt;Kit&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Error opening Excel Template">
      <Posts>
        <Post From="shaby" When="24/05/2010 09:21:38">
          <Html>
        I am trying to open an existing xlsx file as a template using ASP and get this error when loading a worksheet from the Excelpackage. On exploring the worksheets[] i can see theres a count of 7 (which is correct) but I cant get to it because of the error.
 I'd appreciate some help. public static void test() { FileInfo fsave = new FileInfo(@"C:\Inetpub\wwwroot\Download\MCAF.xlsx"); FileInfo fi = new FileInfo(@"C:\Inetpub\wwwroot\Templates\MC_Invoice_Service.xls"); ExcelPackage p = new ExcelPackage(fi);
 var ws = p.Workbook.Worksheets[0]; // &amp;lt;---- EXCEPTION: Object reference not set to an instance of an object. ws.Cells[1, 2].Value = "Bob"; p.SaveAs(fsave); } EDIT: Loading it as a FileStream worked. I am still trying to figure out why the error
 above occurs.
        
    </Html>
        </Post>
        <Post From="cdc5205" When="24/05/2010 13:36:30">
          <Html>
        Try something like this: &lt;br&gt;
&lt;br&gt;
FileInfo newFile = new FileInfo(newFilePath);&lt;br&gt;
FileInfo template = new FileInfo(tempPath);&lt;br&gt;
&lt;br&gt;
using (ExcelPackage xlPackage = new ExcelPackage(newFile, template))&lt;br&gt;
{&lt;br&gt;
worksheet = xlPackage.Workbook.Worksheets["Sheet1"];&lt;br&gt;
worksheet .Cells[1, 2].Value = "Test Text";&lt;br&gt;
xlPackage.Save();&lt;br&gt;
}&lt;br&gt;
&lt;br&gt;
Also, your template may have to be .xlsx. 
        
    </Html>
        </Post>
        <Post From="jankallman" When="24/05/2010 20:10:44">
          <Html>
        
&lt;p&gt;Try to download the latest source and see if it works. I fixed an issue on namesstyles that could give this error. I'm not sure this is the problem, but start with that.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="shaby" When="24/05/2010 20:58:32">
          <Html>
        Thanks for the response guys. jankallman may be right it has something to do with existing styles on the sheet, my original xlsx template had alot of style formatting going on. So I saved it as an .xls file (for Office 97) which stripped off all the styles
 then I saved it back to .xlsx and it worked! I have 2 versions of the files now I could email them to you if you want to experiment further. For now I am going back to COM since this is for an intranet application I don't mind the load on the server plus we
 haven't fully shifted to office 2007 so we still get alot of xls files too bad EPPlus dosent support that. Any plans for supporting office 2003? You guys have done a great job with EPPlus Ive been experimenting with excel libraries for days and EPPlus is the
 best in my opinion. Keep up the great work. 
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Problem opening the sample.xlsx">
      <Posts>
        <Post From="afeuer" When="18/05/2010 15:22:13">
          <Html>
        
&lt;p&gt;Hello there&lt;/p&gt;
&lt;p&gt;I just downloaded the latest version and unzipped the websamples. I could generate sample1.xlsx, But could not open the same. It says some&amp;nbsp;of the contents of the files are unreadable :( and asks whether It should search&amp;nbsp;for a converter and ends
 up in &lt;a href="http://support.microsoft.com/kb/967950" rel="nofollow"&gt;http://support.microsoft.com/kb/967950&lt;/a&gt;&amp;nbsp;I am running Microsoft Excel 2007. Any help?&lt;/p&gt;
&lt;p&gt;Kit&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="18/05/2010 20:02:07">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Im not sure why you get this error message. The samples should work fine with Excel 2007.&lt;/p&gt;
&lt;p&gt;The sample requires that Visual studio 2008 and Excel 2007 is installed on your computer.&lt;/p&gt;
&lt;p&gt;Try the other samples&amp;nbsp;(the command line) and see if you can open them.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="afeuer" When="18/05/2010 20:24:59">
          <Html>
        
&lt;p&gt;Hi Jan&lt;/p&gt;
&lt;p&gt;I dont understand what do you mean by commandline samples. I am talking about the websamples. I created 3 sample files - 1,2, and 3 and the same problem exists in all the three. I run VWD Express. Could that be the problem?&lt;/p&gt;
&lt;p&gt;Kit.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="18/05/2010 21:01:16">
          <Html>
        
&lt;p&gt;Ah,&amp;nbsp;I guess you cant run the command-line sample project then (it's included in the solution-file). I just wanted to see if you could get&amp;nbsp;it to work at all.&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I havn't tried the express version, so I really dont know if that is the problem.&lt;/p&gt;
&lt;p&gt;Any one else has?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="afeuer" When="19/05/2010 09:57:38">
          <Html>
        
&lt;p&gt;Jan, I tried to run the windows application sample and could create sample 1,5,6 and 7 (okay I didnt have the adventureworks installed so 3 and 4 were not generated). and to my surpise I could open all the four documents (I should tell you that I am so impressed).
 Again I am running visual C# 2008 &lt;strong&gt;express&lt;/strong&gt; edition.&lt;/p&gt;
&lt;p&gt;I will now try to create a new website and try to implement your samples and get back to you.&lt;/p&gt;
&lt;p&gt;Meanwhile any tips would be appreciated.&lt;/p&gt;
&lt;p&gt;Kit&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="afeuer" When="19/05/2010 14:53:09">
          <Html>
        
&lt;p&gt;Yahoooooooooooooo! It works!!! When I created a new project and reproduced your code, it runs perfect :)&lt;/p&gt;
&lt;p&gt;I&amp;nbsp; have a two quick questions.&lt;/p&gt;
&lt;p&gt;1.&amp;nbsp;If I write&amp;nbsp;&lt;span style="font-size: x-small;"&gt;&lt;span style="font-size: x-small;"&gt;worksheet.Cells[&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;"A2"&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: x-small;"&gt;].Value
 = &lt;/span&gt;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;"12001&lt;span style="color: rgb(136, 136, 136);"&gt;&lt;span style="color: rgb(0, 0, 0);"&gt;" (Your&amp;nbsp;ID Column) In&amp;nbsp;the Excel sheet I see an Error message against this
 value&amp;nbsp;something like "The number in this cell is formatted as Text..." (I have an German version of Excel and&amp;nbsp;the translatation I had given is not exact, but am sure you will understand&amp;nbsp;what I mean). whats the work around?&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-size: x-small;"&gt;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;&lt;span style="color: rgb(136, 136, 136);"&gt;&lt;span style="color: rgb(0, 0, 0);"&gt;2. The documnetation (EPPlus2.6.chm) poses some problem. Am not able to
 navigate through the listings. It says something like "The navigation to his website is broken..." (Needless to say, German OS and I've tried my best to translate)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-size: x-small;"&gt;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;&lt;span style="color: rgb(136, 136, 136);"&gt;&lt;span style="color: rgb(0, 0, 0);"&gt;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&amp;nbsp;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;&lt;span style="color: rgb(136, 136, 136);"&gt;&lt;span style="color: rgb(0, 0, 0);"&gt;Anyways
 thanks a&amp;nbsp;million for such a wonderful utility. I am now all set to explore it. Pls dont mind If I bump often with questions.&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-size: x-small;"&gt;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;&lt;span style="color: rgb(136, 136, 136);"&gt;&lt;span style="color: rgb(0, 0, 0);"&gt;Cheers&lt;br&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: x-small;"&gt;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;&lt;span style="color: rgb(136, 136, 136);"&gt;&lt;span style="color: rgb(0, 0, 0);"&gt;Kit&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="19/05/2010 18:44:48">
          <Html>
        
&lt;p&gt;Great! :)&lt;/p&gt;
&lt;p&gt;Your questions...&lt;/p&gt;
&lt;p&gt;1. Change it to a numeric datatype,&amp;nbsp;like &lt;span style="font-size: x-small;"&gt;
&lt;span style="font-size: x-small;"&gt;worksheet.Cells[&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;"A2"&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: x-small;"&gt;].Value =
&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;12001&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;2. Windows blocks it. Make sure you run it from a local drive. If you run Windows 7, right-click the chm file--&amp;gt; Properties. You should find the unblock button on one of the tabs. Look at issue 10578 for more info.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="afeuer" When="19/05/2010 21:32:58">
          <Html>
        
&lt;p&gt;Perfect :)&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="I need suggestions on how to get rid of web page navigation">
      <Posts>
        <Post From="bucketofsquid" When="14/05/2010 15:21:03">
          <Html>
        I am generation an Excel workbook from an aspx page that uses a master page. When I generate the workbook the stream is including the entire master page and other html code. Any ideas on how to get rid of this? It is causing the following set of errors:
 Excel found unreadable content in 'Filename.xlsx'. Do you want to recover the contents of this workbook? If you trust the source of this workbook, click yes. &amp;lt;Yes&amp;gt; This file cannot be opened by using Microsoft Excel. Do you want to search the Microsoft
 Office Online Web site for a converter that can open the file? &amp;lt;No&amp;gt; Excel was able to open the file by repairing or removing the unreadable content. Excel completed file level validation and repair. Some parts of this workbook may have been repaired
 or discarded. 
        
    </Html>
        </Post>
        <Post From="mrxrsd" When="14/05/2010 15:37:42">
          <Html>
        
&lt;p&gt;Execute a Response.clear() before send your stream back to client.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;       Response.Clear();
                    Response.AddHeader(&lt;span style="color: rgb(163, 21, 21);"&gt;"content-disposition"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"attachment;  filename=file.xlsx"&lt;/span&gt;);
                    Response.ContentType = &lt;span style="color: rgb(163, 21, 21);"&gt;"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"&lt;/span&gt;;                    
                    Response.BinaryWrite(epplus.GetAsByteArray());
                    Response.End();

&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="bucketofsquid" When="14/05/2010 17:36:36">
          <Html>
        Thanks but that didn't work. My code is VB so it may need a little translation. I'm posting it so you can see what I'm doing to give ideas as to what else to try.&lt;br&gt;
&lt;br&gt;
Protected Sub btnExport_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles btnExport.Click&lt;br&gt;
'dtBalanceSheet should have the needed balancesheet data by now because it was filled on Page_Load&lt;br&gt;
Dim drBalanceSheet As DataRow&lt;br&gt;
' Dim dcBalanceSheet As DataColumn&lt;br&gt;
Dim iRowNumber As Integer = 0&lt;br&gt;
Dim iColumnNumber As Integer = 0&lt;br&gt;
Dim pck As New ExcelPackage()&lt;br&gt;
Dim ws = pck.Workbook.Worksheets.Add("BalanceSheet")&lt;br&gt;
Dim iRemainder As Integer = 0&lt;br&gt;
' Response.Clear() 'added here to see if it would get rid of html from master page&lt;br&gt;
'Add data to cells&lt;br&gt;
'Build header of worksheet&lt;br&gt;
If ddlYears.Text = "10" Then&lt;br&gt;
ws.Cells(1, 1, 1, 12).Merge = True&lt;br&gt;
ws.Cells(1, 1, 1, 12).Style.HorizontalAlignment = OfficeOpenXml.Style.ExcelHorizontalAlignment.Center&lt;br&gt;
ws.Cells(1, 1, 1, 12).Value = "Balance Sheet"&lt;br&gt;
ws.Cells(1, 1, 1, 12).Style.Font.Bold = True&lt;br&gt;
ws.Cells(1, 1, 1, 12).Style.Font.Name = "Times New Roman"&lt;br&gt;
'Can't set color when patterntype is not set.&lt;br&gt;
ws.Cells(1, 1, 1, 12).Style.Fill.PatternType = ExcelFillStyle.Solid&lt;br&gt;
ws.Cells(2, 1, 2, 12).Style.Fill.PatternType = ExcelFillStyle.Solid&lt;br&gt;
ws.Cells(1, 1, 1, 12).Style.Fill.BackgroundColor.SetColor(Color.LightBlue)&lt;br&gt;
ws.Cells(2, 1, 2, 12).Style.Fill.BackgroundColor.SetColor(Color.LightCyan)&lt;br&gt;
ws.Cells(2, 3).Value = iStartYear&lt;br&gt;
ws.Cells(2, 4).Value = iStartYear + 1&lt;br&gt;
ws.Cells(2, 5).Value = iStartYear + 2&lt;br&gt;
ws.Cells(2, 6).Value = iStartYear + 3&lt;br&gt;
ws.Cells(2, 7).Value = iStartYear + 4&lt;br&gt;
ws.Cells(2, 8).Value = iStartYear + 5&lt;br&gt;
ws.Cells(2, 9).Value = iStartYear + 6&lt;br&gt;
ws.Cells(2, 10).Value = iStartYear + 7&lt;br&gt;
ws.Cells(2, 11).Value = iStartYear + 8&lt;br&gt;
ws.Cells(2, 12).Value = iStartYear + 9&lt;br&gt;
Else&lt;br&gt;
ws.Cells(1, 1, 1, 8).Merge = True&lt;br&gt;
ws.Cells(1, 1, 1, 8).Style.HorizontalAlignment = OfficeOpenXml.Style.ExcelHorizontalAlignment.Center&lt;br&gt;
ws.Cells(1, 1, 1, 8).Value = "Balance Sheet"&lt;br&gt;
ws.Cells(1, 1, 1, 8).Style.Font.Bold = True&lt;br&gt;
ws.Cells(1, 1, 1, 8).Style.Font.Name = "Times New Roman"&lt;br&gt;
ws.Cells(1, 1, 1, 8).Style.Fill.PatternType = ExcelFillStyle.Solid&lt;br&gt;
ws.Cells(2, 1, 2, 8).Style.Fill.PatternType = ExcelFillStyle.Solid&lt;br&gt;
ws.Cells(1, 1, 1, 8).Style.Fill.BackgroundColor.SetColor(Color.LightBlue)&lt;br&gt;
ws.Cells(2, 1, 2, 8).Style.Fill.BackgroundColor.SetColor(Color.LightCyan)&lt;br&gt;
ws.Cells(2, 3).Value = iStartYear&lt;br&gt;
ws.Cells(2, 4).Value = iStartYear + 1&lt;br&gt;
ws.Cells(2, 5).Value = iStartYear + 2&lt;br&gt;
ws.Cells(2, 6).Value = iStartYear + 3&lt;br&gt;
ws.Cells(2, 7).Value = iStartYear + 4&lt;br&gt;
ws.Cells(2, 8).Value = iStartYear + 5&lt;br&gt;
End If&lt;br&gt;
'If ddlYears.Text = "10" Then&lt;br&gt;
iRowNumber = 3&lt;br&gt;
For Each drBalanceSheet In dtBalanceSheet.Rows 'Loop through rows&lt;br&gt;
'Add the row to the worksheet&lt;br&gt;
If Not (iRowNumber Mod 2 = 0) Then&lt;br&gt;
If ddlYears.Text = "10" Then&lt;br&gt;
ws.Cells(iRowNumber, 1, iRowNumber, 12).Style.Fill.PatternType = ExcelFillStyle.Solid&lt;br&gt;
ws.Cells(iRowNumber, 1, iRowNumber, 12).Style.Fill.BackgroundColor.SetColor(Color.White)&lt;br&gt;
Else&lt;br&gt;
ws.Cells(iRowNumber, 1, iRowNumber, 8).Style.Fill.PatternType = ExcelFillStyle.Solid&lt;br&gt;
ws.Cells(iRowNumber, 1, iRowNumber, 8).Style.Fill.BackgroundColor.SetColor(Color.White)&lt;br&gt;
End If&lt;br&gt;
Else&lt;br&gt;
If ddlYears.Text = "10" Then&lt;br&gt;
ws.Cells(iRowNumber, 1, iRowNumber, 12).Style.Fill.PatternType = ExcelFillStyle.Solid&lt;br&gt;
ws.Cells(iRowNumber, 1, iRowNumber, 12).Style.Fill.BackgroundColor.SetColor(Color.AliceBlue)&lt;br&gt;
Else&lt;br&gt;
ws.Cells(iRowNumber, 1, iRowNumber, 8).Style.Fill.PatternType = ExcelFillStyle.Solid&lt;br&gt;
ws.Cells(iRowNumber, 1, iRowNumber, 8).Style.Fill.BackgroundColor.SetColor(Color.AliceBlue)&lt;br&gt;
End If&lt;br&gt;
End If&lt;br&gt;
' For Each dcBalanceSheet In drBalanceSheet.Table.Columns 'Loop through columns&lt;br&gt;
For iColumnNumber = 2 To drBalanceSheet.ItemArray.Count - 1&lt;br&gt;
'Add the field to the worksheet&lt;br&gt;
' Name,ID,Text,Year1,Year2,Year3,Year4,Year5,Year6,Year7,Year8,Year9,Year10,Calculation&lt;br&gt;
If iColumnNumber &amp;gt; 3 Then&lt;br&gt;
If Not IsDBNull(drBalanceSheet.Item(iColumnNumber - 1)) Then&lt;br&gt;
ws.Cells(iRowNumber, iColumnNumber - 1).Value = CInt(drBalanceSheet.Item(iColumnNumber - 1))&lt;br&gt;
ws.Cells(iRowNumber, iColumnNumber - 1).Style.HorizontalAlignment = ExcelHorizontalAlignment.Right&lt;br&gt;
ws.Cells(iRowNumber, iColumnNumber - 1).Style.Numberformat.Format = "#,#&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0"&gt;#0&lt;/a&gt;"&lt;br&gt;
Else&lt;br&gt;
ws.Cells(iRowNumber, iColumnNumber - 1).Value = " "&lt;br&gt;
End If&lt;br&gt;
Else&lt;br&gt;
If iColumnNumber = 2 Then&lt;br&gt;
If Not IsDBNull(drBalanceSheet.Item(iColumnNumber - 1)) And drBalanceSheet.Item(iColumnNumber - 1) &amp;lt;&amp;gt; "" Then&lt;br&gt;
ws.Cells(iRowNumber, iColumnNumber - 1).Value = CInt(drBalanceSheet.Item(iColumnNumber - 1))&lt;br&gt;
End If&lt;br&gt;
Else&lt;br&gt;
ws.Cells(iRowNumber, iColumnNumber - 1).Value = drBalanceSheet.Item(iColumnNumber - 1)&lt;br&gt;
End If&lt;br&gt;
End If&lt;br&gt;
Next&lt;br&gt;
'Add formatting to cells&lt;br&gt;
'Rows to underline 2nd column 3,21&lt;br&gt;
'Rows to bold 2nd column = 3,4,9,10,11,12,19,20,21,22,30,35,36,37,38&lt;br&gt;
Select Case iRowNumber&lt;br&gt;
Case 3&lt;br&gt;
ws.Cells(3, 2).Style.Font.Bold = True&lt;br&gt;
ws.Cells(3, 2).Style.Font.UnderLine = True&lt;br&gt;
Case 4&lt;br&gt;
ws.Cells(iRowNumber, 2).Style.Font.Bold = True&lt;br&gt;
Case 9&lt;br&gt;
ws.Cells(iRowNumber, 2).Style.Font.Bold = True&lt;br&gt;
Case 10&lt;br&gt;
ws.Cells(iRowNumber, 2).Style.Font.Bold = True&lt;br&gt;
Case 11&lt;br&gt;
ws.Cells(iRowNumber, 2).Style.Font.Bold = True&lt;br&gt;
Case 12&lt;br&gt;
ws.Cells(iRowNumber, 2).Style.Font.Bold = True&lt;br&gt;
Case 19&lt;br&gt;
ws.Cells(iRowNumber, 2).Style.Font.Bold = True&lt;br&gt;
Case 20&lt;br&gt;
ws.Cells(iRowNumber, 2).Style.Font.Bold = True&lt;br&gt;
Case 21&lt;br&gt;
ws.Cells(iRowNumber, 2).Style.Font.Bold = True&lt;br&gt;
ws.Cells(iRowNumber, 2).Style.Font.UnderLine = True&lt;br&gt;
Case 22&lt;br&gt;
ws.Cells(iRowNumber, 2).Style.Font.Bold = True&lt;br&gt;
Case 30&lt;br&gt;
ws.Cells(iRowNumber, 2).Style.Font.Bold = True&lt;br&gt;
Case 35&lt;br&gt;
ws.Cells(iRowNumber, 2).Style.Font.Bold = True&lt;br&gt;
Case 36&lt;br&gt;
ws.Cells(iRowNumber, 2).Style.Font.Bold = True&lt;br&gt;
Case 37&lt;br&gt;
ws.Cells(iRowNumber, 2).Style.Font.Bold = True&lt;br&gt;
Case 38&lt;br&gt;
ws.Cells(iRowNumber, 2).Style.Font.Bold = True&lt;br&gt;
Case Else&lt;br&gt;
End Select&lt;br&gt;
iRowNumber = iRowNumber + 1&lt;br&gt;
Next&lt;br&gt;
'Add borders to cells&lt;br&gt;
If ddlYears.Text = "10" Then&lt;br&gt;
ws.Cells("A1:L38").Style.Border.Top.Style = ExcelBorderStyle.Thin&lt;br&gt;
ws.Cells("A1:L38").Style.Border.Right.Style = ExcelBorderStyle.Thin&lt;br&gt;
ws.Cells("A1:L38").Style.Border.Left.Style = ExcelBorderStyle.Thin&lt;br&gt;
ws.Cells("A1:L38").Style.Border.Bottom.Style = ExcelBorderStyle.Thin&lt;br&gt;
Else&lt;br&gt;
ws.Cells("A1:H38").Style.Border.Top.Style = ExcelBorderStyle.Thin&lt;br&gt;
ws.Cells("A1:H38").Style.Border.Right.Style = ExcelBorderStyle.Thin&lt;br&gt;
ws.Cells("A1:H38").Style.Border.Left.Style = ExcelBorderStyle.Thin&lt;br&gt;
ws.Cells("A1:H38").Style.Border.Bottom.Style = ExcelBorderStyle.Thin&lt;br&gt;
End If&lt;br&gt;
'Output the new Excel Workbook to the client&lt;br&gt;
Response.Clear() 'Just added but it did nothing&lt;br&gt;
pck.SaveAs(Response.OutputStream)&lt;br&gt;
Response.ContentType = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"&lt;br&gt;
Response.AddHeader("content-disposition", "attachment; filename=BalanceSheet" &amp;amp; iCase &amp;amp; ".xlsx")&lt;br&gt;
End Sub 
        
    </Html>
        </Post>
        <Post From="bucketofsquid" When="14/05/2010 19:34:21">
          <Html>
        Ok! It did work after all. I just had to re-arrange a little. I went from this: Response.Clear() pck.SaveAs(Response.OutputStream) Response.ContentType = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" Response.AddHeader("content-disposition",
 "attachment; filename=BalanceSheet" &amp;amp; iCase &amp;amp; ".xlsx") To this: Response.Clear() Response.BinaryWrite(pck.GetAsByteArray()) Response.ContentType = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" Response.AddHeader("content-disposition",
 "attachment; filename=BalanceSheet" &amp;amp; iCase &amp;amp; ".xlsx") Response.End() Thank you very much!! My clients will be very happy that the old way we did this with the error message and no formatting is being replaced with formatted workbooks and
 no error messages!
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Styles from templates are reset">
      <Posts>
        <Post From="juxtaposed" When="11/05/2010 19:43:27">
          <Html>
        
&lt;p&gt;I have a custom style defined in a template file that I load in from an existing Excel file. The custom style is called "MyCustomStyle," and it has formatting that includes: Left Justify, middle vertical alignment.&lt;/p&gt;
&lt;p&gt;Cell G9 has MyCustomStyle applied to it in the template. After the template is processed through EPPlus, the MyCustomStyle is still in the file, but the formatting for that style has been reset to the defaults. This happens regardless of whether I change
 the values in any cells or not. Help?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;pre&gt;var templateFile = new FileInfo(@"C:\template.xlsx");

var pckTemplate = new ExcelPackage(templateFile);

var xlPackage = new ExcelPackage(new MemoryStream(), pckTemplate.Stream);
var worksheet = xlPackage.Workbook.Worksheets["Sheet1"];

worksheet.Name = "Yay New Name!";

worksheet.Cells["G9"].Value = 423.82;

Response.ContentType = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";
Response.AddHeader("content-disposition", "attachment;  filename=" + filename);
Response.BinaryWrite(xlPackage.GetAsByteArray());&lt;/pre&gt;
&lt;p&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="juxtaposed" When="12/05/2010 00:09:57">
          <Html>
        
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;I guess I'll answer my own question. It doesn't look like EPPlus retains custom styles defined in a template. I just implemented a helper class that applies the desired styles to a range of cells.&lt;/pre&gt;
&lt;/div&gt;
&lt;pre&gt;&lt;div style="color: black; background-color: white;"&gt;&lt;pre&gt;&lt;span style="color: blue;"&gt;using&lt;/span&gt; OfficeOpenXml;
&lt;span style="color: blue;"&gt;using&lt;/span&gt; OfficeOpenXml.Style;

&lt;span style="color: blue;"&gt;namespace&lt;/span&gt; MyNamespace
{
    &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;static&lt;/span&gt; &lt;span style="color: blue;"&gt;class&lt;/span&gt; EpplusHelper
    {
        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;static&lt;/span&gt; &lt;span style="color: blue;"&gt;void&lt;/span&gt; setCellStyle1 (ExcelRange range)
        {
            range.Style.Font.Color... &lt;span style="color: green;"&gt;// blah blah.&lt;/span&gt;
        }

    }
}
&lt;/pre&gt;
&lt;/div&gt;
&lt;/pre&gt;
&lt;p&gt;&amp;nbsp;The helper class is used as such:&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;var&lt;/span&gt; xlPackage = &lt;span style="color: blue;"&gt;new&lt;/span&gt; ExcelPackage(&lt;span style="color: blue;"&gt;new&lt;/span&gt; MemoryStream(), pckTemplate.Stream);
&lt;span style="color: blue;"&gt;var&lt;/span&gt; worksheet = xlPackage.Workbook.Worksheets[&lt;span style="color: rgb(163, 21, 21);"&gt;"Sheet1"&lt;/span&gt;];

&lt;span style="color: green;"&gt;// you can send it an individual cell or a range, like A1-E9&lt;/span&gt;
EpplusHelper.setCellStyle1(worksheet.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"G9"&lt;/span&gt;]);
&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="12/05/2010 08:03:29">
          <Html>
        
&lt;p&gt;I fixed a problem with namedstyles in templates&amp;nbsp;some time&amp;nbsp;ago, so try the new source and see it that helps. I'll have a closer look to this when I have the time.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="New to CodePlex and EPPlus and need starting help">
      <Posts>
        <Post From="bucketofsquid" When="10/05/2010 15:57:03">
          <Html>
        I'm new to CodePlex so I'm not sure how to use everything here. I downloaded the .chm file and with help have it working. Now I need to know what to do next. I downloaded the EPPlus 2.6.0.1 binary and the 58544 source. What I need to know now is where
 does the binary need to be located? I assume I'll need a simple reference to the binary in order to use it in a project but does it need to be in the GAC? If my project has copy local selected does this mean the library doesn't need to be installed on the
 server? I downloaded the source mainly as a learning project so that can wait.
        
    </Html>
        </Post>
        <Post From="cdc5205" When="10/05/2010 18:23:58">
          <Html>
        
&lt;p&gt;I added the reference to the .dll (binary) to the bin folder. But you can just right click on your project name and click add reference, then on the browse tab go to the .dll file.&amp;nbsp; In C# add the following statement to the top of your code behind:&lt;/p&gt;
&lt;p&gt;using OfficeOpenXml;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I would also recommend downloading the sample. Just extract and open the solution (.sln) with visual studio.&lt;/p&gt;
&lt;p&gt;&lt;a href="http://epplus.codeplex.com/releases/view/42439#DownloadId=112318" rel="nofollow"&gt;http://epplus.codeplex.com/releases/view/42439#DownloadId=112318&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="bucketofsquid" When="10/05/2010 20:18:43">
          <Html>
        I downloaded the sample and looked at it. I was able to easily figure out adding the references to my project based on what I saw in the sample project. I'm supposed to use VB.Net but translation is really easy so I'm pretty excited about this. Thanks!
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Data Validation List">
      <Posts>
        <Post From="Pharmakon" When="07/05/2010 21:37:41">
          <Html>
        
&lt;p&gt;Is it possible to make a data validation list using EPPlus?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="09/05/2010 19:30:15">
          <Html>
        
&lt;p&gt;Sorry&lt;span id="_mce_start" style="line-height: 0;"&gt;﻿&lt;/span&gt; &lt;span id="_mce_start" style="line-height: 0;"&gt;
&lt;span id="_mce_start" style="line-height: 0;"&gt;&lt;span id="_mce_start" style="line-height: 0;"&gt;﻿&lt;/span&gt;n&lt;/span&gt;&lt;span id="_mce_end" style="line-height: 0;"&gt;﻿&lt;/span&gt;&lt;span id="_mce_start" style="line-height: 0;"&gt;&lt;span id="_mce_start" style="line-height: 0;"&gt;﻿&lt;/span&gt;﻿&lt;span id="_mce_end" style="line-height: 0;"&gt;﻿&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span id="_mce_end" style="line-height: 0;"&gt;﻿&lt;/span&gt;&lt;span id="_mce_end" style="line-height: 0;"&gt;﻿&lt;/span&gt;&lt;span id="_mce_start" style="line-height: 0;"&gt;&lt;span id="_mce_start" style="line-height: 0;"&gt;﻿&lt;/span&gt;﻿&lt;span id="_mce_end" style="line-height: 0;"&gt;﻿&lt;/span&gt;&lt;/span&gt;&lt;span id="_mce_start" style="line-height: 0;"&gt;﻿&lt;/span&gt;&lt;span id="_mce_start" style="line-height: 0;"&gt;﻿&lt;/span&gt;&lt;span id="_mce_start" style="line-height: 0;"&gt;﻿&lt;/span&gt;&lt;span id="_mce_start" style="line-height: 0;"&gt;﻿&lt;span id="_mce_start" style="line-height: 0;"&gt;﻿&lt;span id="_mce_start" style="line-height: 0;"&gt;﻿&lt;/span&gt;&lt;span id="_mce_start" style="line-height: 0;"&gt;﻿&lt;/span&gt;&lt;span id="_mce_start" style="line-height: 0;"&gt;﻿&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span id="_mce_start" style="line-height: 0;"&gt;﻿&lt;/span&gt;o,
 t&lt;span id="_mce_start" style="line-height: 0;"&gt;﻿&lt;/span&gt;hat's on the TODO list for a future release.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Dates">
      <Posts>
        <Post From="ksf" When="06/05/2010 11:21:53">
          <Html>
        
&lt;p&gt;Hey. I'm hoping to use EPPlus to read and write Xlsx files. However, I'm having problems figuring out how to handles dates.&amp;nbsp;If I set a cell value to a DateTime, the file looks to convert the date into a number (which I know Excel stores dates as), but
 when the file is opened in either Excel or EPPlus the DateTime is returned as a number.&lt;/p&gt;
&lt;p&gt;Do you have an example on how to set a cell value to a Date?&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="06/05/2010 11:26:30">
          <Html>
        
&lt;p&gt;You must set the numberformat to a date format (ex worksheet.cells["a1:a5"].Style.NumberFormat.Format="yyyy-MM-dd"). Have a look at the sample project.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Log chart">
      <Posts>
        <Post From="nitharsanr" When="29/04/2010 21:11:03">
          <Html>
        
&lt;p&gt;Hai&lt;/p&gt;
&lt;p&gt;is it possible to create log chart using this library?&lt;/p&gt;
&lt;p&gt;and how to hide the worksheet.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Nitharsan&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="30/04/2010 07:45:06">
          <Html>
        
&lt;p&gt;Yes, if you mean charttype&amp;nbsp;Column3D or BarClustered3D. The worksheet has a Hidden property.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="nitharsanr" When="30/04/2010 16:10:20">
          <Html>
        
&lt;p&gt;hi&lt;/p&gt;
&lt;p&gt;I want to draw xy scatter chart with log axis. That is what i meant.&lt;/p&gt;
&lt;p&gt;can i save this file to .xls format?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;nitharsan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="03/05/2010 07:54:54">
          <Html>
        
&lt;p&gt;Sorry, no support for log axis in the component today, but try to use a template and format the graph the way you want (if that is an option for you).&lt;/p&gt;
&lt;p&gt;You can not save in the xls format, this component uses ooxml only.&amp;nbsp;&lt;/p&gt;
&lt;p&gt;By the way,&amp;nbsp;it's a bug in the hidden property,&amp;nbsp;so it wont work in the current release. I'll check&amp;nbsp;in the&amp;nbsp;fix later this week.&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="nitharsanr" When="03/05/2010 08:15:38">
          <Html>
        Thanks As you said , I will try to create chart from template. Nitharsan
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="page breaks">
      <Posts>
        <Post From="cdc5205" When="28/04/2010 21:12:53">
          <Html>
        Is there a way to add horizontal page breaks and detect the number of breaks? Or a different way control the page flow. My spreadsheet is split into small sections with a one row padding between them. If it flows to the next page then I want to push the
 entire section to the next page. with the interop library I could use HPageBreaks.Count to get num of page breaks, and if the count is greater then in the beginning of the section i could use HPageBreaks.Add and add the break above the section. Any ideas?
 Thanks
        
    </Html>
        </Post>
        <Post From="jankallman" When="29/04/2010 07:58:36">
          <Html>
        
&lt;p&gt;Next version, but you can download the latest source and try it. You have a&amp;nbsp;Pagebreak property on the row and column object. No count at the moment, so you have to check the rows/columns to get the pagebreak value (boolean). You can use the dimension
 property to get the&amp;nbsp;min/max row/column&amp;nbsp;of the worksheet.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Set border on a range">
      <Posts>
        <Post From="frodeM" When="28/04/2010 11:39:55">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Great job on the EPPlus library Jan.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I've been trying to set border on an ExcelRange, but I'm probably doing something wrong.&lt;/p&gt;
&lt;p&gt;Should this work? If not, how could this be done?&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;using&lt;/span&gt; (ExcelRange range = ws.Cells[rowIndex, 1, rowCount, 57])
{
    range.Style.Border.Top.Color.SetColor(System.Drawing.Color.Black);
    range.Style.Border.Top.Style = ExcelBorderStyle.Thin;&lt;/pre&gt;
&lt;pre&gt;}
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Any help appreciated.&lt;/p&gt;
&lt;p&gt;Frode&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="frodeM" When="28/04/2010 12:06:21">
          <Html>
        
&lt;p&gt;After a little more testing this works fine:&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;ws.Cells["A1:A10"].Style.Border.Top.Style = ExcelBorderStyle.Thin;
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&amp;nbsp;Frode&lt;/p&gt;
&lt;div id="_mcePaste" style="left: -10000px; top: 0px; width: 1px; height: 1px; overflow: hidden;"&gt;
﻿&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="28/04/2010 12:10:43">
          <Html>
        
&lt;p&gt;Have a look at&amp;nbsp;sample 6.&lt;/p&gt;
&lt;p&gt;Something like this...&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;            &lt;span style="color: green;"&gt;//Set a border around&lt;/span&gt;
            ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A1:A43"&lt;/span&gt;].Style.Border.Left.Style = ExcelBorderStyle.Thin;
            ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A1:O1"&lt;/span&gt;].Style.Border.Top.Style = ExcelBorderStyle.Thin;
            ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"O1:O43"&lt;/span&gt;].Style.Border.Right.Style = ExcelBorderStyle.Thin;
            ws.Cells[&lt;span style="color: rgb(163, 21, 21);"&gt;"A43:O43"&lt;/span&gt;].Style.Border.Bottom.Style = ExcelBorderStyle.Thin;

&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="frodeM" When="28/04/2010 12:16:11">
          <Html>
        
&lt;p&gt;Thanks Jan. Found sample 6 :)&lt;/p&gt;
&lt;p&gt;Frode&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Freeze top 2 rows">
      <Posts>
        <Post From="ojm37a" When="26/04/2010 18:05:52">
          <Html>
        
&lt;p&gt;How do I freeze the top 2 rows of a spreadsheet? The View.FreezePanes() method only accepts a single row and column. Do I have to iterate through all the columns?&lt;/p&gt;
&lt;p&gt;Thanks,&lt;br&gt;
Owen&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="26/04/2010 19:45:40">
          <Html>
        
&lt;p&gt;It's the top left cell where you freeze. View.FreezePanes(3,1) to freeze the two first rows&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Reading the EPPlusXmlDocumentation.xml file">
      <Posts>
        <Post From="ojm37a" When="23/04/2010 17:51:02">
          <Html>
        
&lt;p&gt;Is there a standard method of reading the documentation xml file that is included in the binary download? (Some kind of "documentation xml reader")....&lt;/p&gt;
&lt;p&gt;Thanks,&lt;br&gt;
Owen&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="26/04/2010 07:49:17">
          <Html>
        
&lt;p&gt;Not to my knowledge, but I have created a helpfile from it using Sandcastle.&lt;/p&gt;
&lt;p&gt;You can download it from the download page, it that helps you.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="ojm37a" When="26/04/2010 17:51:13">
          <Html>
        
&lt;p&gt;Hmmm, all I got was an index when I opened the chm file....&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="26/04/2010 19:41:27">
          <Html>
        Windows unblocks it. If you use Windows 7 Right-click it and select properties --&amp;gt; unblock
        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="DeleteRow() causing error">
      <Posts>
        <Post From="travispuk" When="14/04/2010 17:10:52">
          <Html>
        
&lt;p&gt;When using worksheet.DeleteRow(11, 1, True) it fails saying that the Key does not exist. There are definitely rows in the worksheet as it works fine if you delete the one above this row. I have also tried to delete it backwards, ie delete from the bottom
 up.&lt;/p&gt;
&lt;p&gt;Any ideas what can be going wrong here?&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;
&lt;p&gt;Travis&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="14/04/2010 20:28:00">
          <Html>
        
&lt;p&gt;It's a bug in the DeleteRow method. I'll try to fix it to the next check-in&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="travispuk" When="15/04/2010 09:18:05">
          <Html>
        
&lt;p&gt;Jan,&lt;/p&gt;
&lt;p&gt;Thanks. For now I will need to revert back to the old ExcelPackage project.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="15/04/2010 17:31:27">
          <Html>
        
&lt;p&gt;Try the new source and see if it solves your problem.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="travispuk" When="15/04/2010 17:32:59">
          <Html>
        
&lt;p&gt;Jan,&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Will do thanks.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="travispuk" When="19/04/2010 12:20:56">
          <Html>
        
&lt;p&gt;Jan,&lt;/p&gt;
&lt;p&gt;Unfortunately it still fails.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="19/04/2010 14:56:17">
          <Html>
        
&lt;p&gt;ok, create an issue and upload the code / sheet that fails, so i can have a look at it.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="pivot tables">
      <Posts>
        <Post From="frankgunsbarco" When="13/04/2010 16:35:37">
          <Html>
        
&lt;p&gt;In the future, will pivot functionality be included in the package?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="13/04/2010 21:07:58">
          <Html>
        
&lt;p&gt;I hope so. I have not looked at it, so I don't know how much work it is.&lt;/p&gt;
&lt;p&gt;At the moment im working on comments and richtext, but when I have finished that i'll have a look at it.&lt;/p&gt;
&lt;p&gt;I'm&amp;nbsp;currently working alone on this project and mostly on my spare time so don't expect it to happended to fast though.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Set Page Hight=Automatic for Printing">
      <Posts>
        <Post From="pankajlohani" When="08/04/2010 12:19:28">
          <Html>
        
&lt;p&gt;Hello All&lt;/p&gt;
&lt;p&gt;I am facing a problem, when i am trying to print my excel then everything is comes on one page.Page width is fine for me(Should come in one page) To fix this problem i need to set PrinterSettings.FitToHeight property to Automatic.&lt;/p&gt;
&lt;p&gt;Fow width i am setting&amp;nbsp; PrinterSettings.FitToWidth = 1;&lt;/p&gt;
&lt;p&gt;How can i set this property.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="pankajlohani" When="08/04/2010 12:37:59">
          <Html>
        
&lt;p&gt;Thanks All EPPlus developer&lt;/p&gt;
&lt;p&gt;Really gr8888 library. I got my solution.&lt;/p&gt;
&lt;p&gt;PrinterSettings.FitToWidth=0 for Automatic&lt;/p&gt;
&lt;p&gt;PrinterSettings.FitToHeight=0 for Automatic&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="show RTF data in cell">
      <Posts>
        <Post From="pankajlohani" When="30/03/2010 12:26:07">
          <Html>
        
&lt;p&gt;Hello&lt;/p&gt;
&lt;p&gt;I want to show RTF data in cell, I had also posted this problem on yesterday. I got 2 solution for this&lt;/p&gt;
&lt;p&gt;1. use the OOXML format here&lt;/p&gt;
&lt;p&gt;2. format an excel file the way you want, rename it *.zip and have a look at the sheet1.xml to see how it's formatted&lt;/p&gt;
&lt;p&gt;Please give me some sample code for any one implementation between these 2.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Set page size for print">
      <Posts>
        <Post From="pankajlohani" When="30/03/2010 11:02:21">
          <Html>
        
&lt;p&gt;Hello&lt;/p&gt;
&lt;p&gt;I am creating a excel.which page size&amp;nbsp; is increase. When i am doing 'View &amp;gt; Page Layout' then it show me 4 pages. Due to to this i am getting problem in printing my excel.&lt;/p&gt;
&lt;p&gt;How can i fix that?&lt;/p&gt;
&lt;p&gt;I mean i want to set following property through this dll&lt;/p&gt;
&lt;p&gt;Page Layout &amp;gt; Width &amp;gt;1page&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="pankajlohani" When="30/03/2010 11:41:09">
          <Html>
        
&lt;p&gt;I got this setting&lt;/p&gt;
&lt;p&gt;PrinterSettings.FitToWidth = 1;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Insert image and multiple line text in footer">
      <Posts>
        <Post From="pankajlohani" When="30/03/2010 09:26:56">
          <Html>
        
&lt;p&gt;Hello&lt;br&gt;
I want to insert image and multiple line text with formatting in footer. Please give me some sample code.&lt;/p&gt;
&lt;p&gt;I am working on web application and this is not possible for me to use template because of my business logic.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="30/03/2010 09:34:06">
          <Html>
        
&lt;p&gt;OK, You cant insert images with the component. I haven't tried multiple lines (did you try carrige return/linefeed ? \r\n in c#).&amp;nbsp;If you cant get it to work, i'll have a look at it.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="pankajlohani" When="30/03/2010 10:49:22">
          <Html>
        
&lt;p&gt;Thanks &lt;span style="color: rgb(0, 0, 0);"&gt;jankallman&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(0, 0, 0);"&gt;This is fine with that but one more thing that i need to format that footer also(set font color).How can i do this?&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(0, 0, 0);"&gt;Thanks for your help&lt;br&gt;
&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(0, 0, 0);"&gt;&lt;br&gt;
&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="30/03/2010 11:01:29">
          <Html>
        
&lt;p&gt;Sorry, no support for richtext in current version (templates only, and then you cant change it). I plan to add that to cells styling and other objects in the next version, but&amp;nbsp;I have no schedule for that (I do most of the work on my spare time, so its
 not going to happend that fast). Feel free to have a look at the source&amp;nbsp;and see if you can fix it yourself.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Lock a cell in a worksheet">
      <Posts>
        <Post From="manuelkuok" When="10/03/2010 09:38:24">
          <Html>
        
&lt;p&gt;Can I lock &amp;nbsp;a cell (or &amp;nbsp;make a cell readable only)&amp;nbsp;in a worksheet by using EPPlus? &amp;nbsp;THX!&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="10/03/2010 09:52:27">
          <Html>
        
&lt;p&gt;No, at least not today. There is no support for password protected workbooks/sheets, and for that reason i have not implemented the lock/hidden attribute for the styles.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="10/03/2010 11:24:14">
          <Html>
        
&lt;p&gt;Your could try to use a template where you have protected&amp;nbsp;the sheet (I have not tried it myself). You cant change the lock property of the cells from within the component, but if that's ok&amp;nbsp;with you its worth a try.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="manuelkuok" When="11/03/2010 01:41:54">
          <Html>
        
&lt;p&gt;Thank for your quick reply! It&amp;nbsp;can read&amp;nbsp; a&amp;nbsp;protected worksheet! How can I change the lock property of the cells within the component? THX!&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="11/03/2010 11:41:32">
          <Html>
        
&lt;p&gt;You can&amp;nbsp;NOT change the lock property in the current version, so setting sheet protection in a template will proberbly make the whole sheet readonly (if it works at all, I have not tried it).&lt;/p&gt;
&lt;p&gt;I think it should be quite easy to implement&amp;nbsp;a lock property&amp;nbsp;(to the ExcelStyle &amp;amp; ExcelXfs&amp;nbsp;class), so&amp;nbsp;I can have a look at it to the next version.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="16/03/2010 08:34:00">
          <Html>
        
&lt;p&gt;I have added sheetprotection in the new source, so try it out. You can lock/unlock cells with the Style.Locked property.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="manuelkuok" When="25/03/2010 02:21:18">
          <Html>
        
&lt;p&gt;THANK YOU VERY MUCH!!! I have struggled&amp;nbsp;with the mud pit of the open XML SDK 2.0 .&amp;nbsp;Thank you for saving me!!&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="How to add page breaks in generated worksheet">
      <Posts>
        <Post From="benedict_kmu" When="19/03/2010 06:19:49">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Could you please help me to add page breaks in Worksheet by using EPPlus?&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks,&lt;/p&gt;
&lt;p&gt;Benedict A.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="JanKallman" When="19/03/2010 09:08:09">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I'll add that to my TODO list. I plan to do a new release next week, so I'll not add it until the version after that.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="XLSX or XLSM">
      <Posts>
        <Post From="FabriceSAGE" When="05/03/2010 10:08:00">
          <Html>
        
&lt;p&gt;Hello,&lt;/p&gt;
&lt;p&gt;I use XLSM file in template, make modifications (add values)&amp;nbsp;and save the new file&lt;/p&gt;
&lt;p&gt;When i open then new file i have warning but the file it's OK&amp;nbsp; (text and macro)&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;PS&amp;nbsp; : &amp;nbsp;It's possible to make XLSM file whith macro directly (not use template) ?&lt;/p&gt;
&lt;p&gt;Thanks.&lt;/p&gt;
&lt;p&gt;Fabrice.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="08/03/2010 07:40:02">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I hav'nt tried macro enabled sheets, so there is no real support for it in the component. Maybe somthing for the future.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="FabriceSAGE" When="08/03/2010 08:13:05">
          <Html>
        
&lt;p&gt;Ok,&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks,&lt;/p&gt;
&lt;p&gt;Fabrice.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="OutlineLevel and Collapsed">
      <Posts>
        <Post From="FabriceSAGE" When="02/03/2010 11:08:05">
          <Html>
        
&lt;p&gt;Hello&lt;/p&gt;
&lt;p&gt;I test then version 56142 and i have a problem with the code below&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Dim NewFichier As String = "Excel.xlsx"&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Dim newFile As FileInfo = New FileInfo(NewFichier)&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Using pck As New ExcelPackage(newFile)&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Dim Ws_CatProjet As ExcelWorksheet = pck.Workbook.Worksheets.Add("Sheet1")&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Ws_CatProjet.OutLineSummaryBelow = False&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Ws_CatProjet.Cells(8, 1).Value = "Line 8"&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Ws_CatProjet.Row(8).OutlineLevel = 0&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Ws_CatProjet.Row(8).Collapsed = False&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Ws_CatProjet.Cells(9, 1).Value = "Line 9"&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Ws_CatProjet.Row(9).OutlineLevel = 1&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Ws_CatProjet.Row(9).Collapsed = False&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Ws_CatProjet.Cells(10, 1).Value = "Line 10"&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Ws_CatProjet.Row(10).OutlineLevel = 2&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Ws_CatProjet.Row(10).Collapsed = True&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Ws_CatProjet.Cells(11, 1).Value = "Line 11"&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Ws_CatProjet.Row(11).OutlineLevel = 3&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Ws_CatProjet.Row(11).Collapsed = True&lt;/p&gt;
&lt;p&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; pck.Save()&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; End Using&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(0, 0, 255); font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-size: x-small;"&gt;When open with Excel, it's not possible to expand the line 9 ( and
 the lines 10,&amp;nbsp;11)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(0, 0, 255); font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-size: x-small;"&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(0, 0, 255); font-size: x-small;"&gt;&amp;nbsp;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(0, 0, 255); font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-size: x-small;"&gt;If replace&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Ws_CatProjet.Row(xx).Collapsed =
&lt;span style="color: rgb(0, 0, 255); font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-size: x-small;"&gt;True&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(0, 0, 255); font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-size: x-small;"&gt;by&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Ws_CatProjet.Row(xx).Collapsed
 = &lt;span style="color: rgb(0, 0, 255); font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-size: x-small;"&gt;false&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;It's OK...&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(0, 0, 255); font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-size: x-small;"&gt;Thanks&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(0, 0, 255); font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-size: x-small;"&gt;Fabrice.&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="FabriceSAGE" When="02/03/2010 11:09:12">
          <Html>
        
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Dim NewFichier As String = "Excel.xlsx"&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Dim newFile As FileInfo = New FileInfo(NewFichier)&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Using pck As New ExcelPackage(newFile)&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Dim Ws_CatProjet As ExcelWorksheet = pck.Workbook.Worksheets.Add("Sheet1")&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Ws_CatProjet.OutLineSummaryBelow = False&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Ws_CatProjet.Cells(8, 1).Value = "Line 8"&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Ws_CatProjet.Row(8).OutlineLevel = 0&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Ws_CatProjet.Row(8).Collapsed = False&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Ws_CatProjet.Cells(9, 1).Value = "Line 9"&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Ws_CatProjet.Row(9).OutlineLevel = 1&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Ws_CatProjet.Row(9).Collapsed = False&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Ws_CatProjet.Cells(10, 1).Value = "Line 10"&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Ws_CatProjet.Row(10).OutlineLevel = 2&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Ws_CatProjet.Row(10).Collapsed = True&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Ws_CatProjet.Cells(11, 1).Value = "Line 11"&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Ws_CatProjet.Row(11).OutlineLevel = 3&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Ws_CatProjet.Row(11).Collapsed = True&lt;/p&gt;
&lt;p&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; pck.Save()&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; End Using&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="FabriceSAGE" When="02/03/2010 11:53:15">
          <Html>
        
&lt;p&gt;I&amp;nbsp;use "Open XML SDK 2.0 CTP" for compare two files&lt;/p&gt;
&lt;p&gt;I show&lt;/p&gt;
&lt;p&gt;Sheet OK : --&amp;gt;Row row3 = new Row(){ RowIndex = (UInt32Value)10U, Hidden = true, OutlineLevel = 2, Collapsed = true };&lt;/p&gt;
&lt;p&gt;Sheet KO : --&amp;gt; Row row3 = new Row(){ RowIndex = (UInt32Value)10U, &lt;span style="color: rgb(255, 0, 0);"&gt;
Height = 0D,&lt;/span&gt; Hidden = true, &lt;span style="color: rgb(255, 0, 0);"&gt;CustomHeight = true,&lt;/span&gt; OutlineLevel = 2, Collapsed = true };&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks...&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="02/03/2010 12:27:20">
          <Html>
        
&lt;p&gt;Hi&lt;/p&gt;
&lt;p&gt;It's a bug, as you proberbly guessed. The Height is set to 0 if collapsed, and that didn't work to well.&lt;/p&gt;
&lt;p&gt;Remove all code from the ExcelRow.Height get property except&amp;nbsp;&lt;span style="font-size: x-small;"&gt;&amp;lt;font size="2"&amp;gt;
&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&amp;lt;/font&amp;gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(0, 0, 255); font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-size: x-small;"&gt;return&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: x-small;"&gt; _height;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;I haven't testet it fully, so please tell me if you have any futher problems. I'll have a more close look at it before my next checkin&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="FabriceSAGE" When="02/03/2010 14:51:27">
          <Html>
        
&lt;p&gt;Hello,&lt;/p&gt;
&lt;p&gt;It's OK&lt;/p&gt;
&lt;p&gt;Thanks for your help.&lt;/p&gt;
&lt;p&gt;Fabrice.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="protect the worksheet with password">
      <Posts>
        <Post From="manuelkuok" When="02/03/2010 02:53:52">
          <Html>
        
&lt;p&gt;Can I protect the worksheet with password&amp;nbsp;by using EPPlus? THX!&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="02/03/2010 11:30:12">
          <Html>
        
&lt;p&gt;No, not in this version. The component&amp;nbsp;use the&amp;nbsp;&lt;span style="font-size: x-small;"&gt;System.IO.Packaging classes to extract the package.
&lt;/span&gt;&lt;span style="font-size: x-small;"&gt;I'm not sure if it supports encrypted workbooks the way Excel does.&lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Cell Coments">
      <Posts>
        <Post From="jamesShell" When="12/02/2010 13:03:19">
          <Html>
        
&lt;p&gt;Is it possible to add cell coments?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="12/02/2010 13:18:43">
          <Html>
        
&lt;p&gt;Not yet, maybe in a future release... a few days ago I was looking for this too. I did some research and I find out that to add cell coments it isnt something "dificult" but&amp;nbsp;cell coments are stored in a separate xml file ( like styles ) so
 it isnt only add a property in a cell.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="22/02/2010 12:26:25">
          <Html>
        
&lt;p&gt;any progress james? remember to share with us if so.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Chart with row hidden">
      <Posts>
        <Post From="FabriceSAGE" When="17/02/2010 09:50:26">
          <Html>
        
&lt;p&gt;Hello&lt;/p&gt;
&lt;p&gt;I use rows with&amp;nbsp; &lt;span style="font-size: x-small;"&gt;OutlineLevel=&amp;nbsp;(0 or 1)&amp;nbsp;and&amp;nbsp;collapsed=false&amp;nbsp; and rows with
&lt;span style="font-size: x-small;"&gt;OutlineLevel=&amp;nbsp;(2 or 3)&amp;nbsp;and&amp;nbsp;collapsed=true&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(0, 0, 255); font-size: x-small;"&gt;&lt;/span&gt;&lt;span style="font-size: x-small;"&gt;My chart don't show rows hidden&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;How make to show this rows&lt;/p&gt;
&lt;p&gt;Thanks Fabrice.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="17/02/2010 12:56:48">
          <Html>
        
&lt;p&gt;I didnt look at the collapsed property when positioning the drawings. you can download the latest source and try. I dont have the time to test it fully today.&amp;nbsp;I hope I fixed the hyperlink problem as well.&lt;/p&gt;
&lt;p&gt;Be awared of the the SetPosition and Setsize methods only sets the From and To properties of the drawing, so if you resize/hide or collapse rows and columns after you&amp;nbsp;position/resize the drawing the From and To properties will be left unchanged.&lt;/p&gt;
&lt;p&gt;You can also position the chart with the from and to properties if you dont get it to work as expected.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="ExcelLink">
      <Posts>
        <Post From="FabriceSAGE" When="16/02/2010 15:22:15">
          <Html>
        
&lt;p&gt;Hello&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;When i made un new file XLSX and i use ExcelLink to make&amp;nbsp;a HyperLink, it's OK&lt;/p&gt;
&lt;p&gt;When I use a template XLSX and i use ExcelLink To make a HyperLink, i have an error at open XLSX file.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Thanks.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="16/02/2010 17:55:51">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Nice testing :)&lt;/p&gt;
&lt;p&gt;I'm not sure&amp;nbsp;I have fixed your problem, but try the latest source. I found that if you used headers/footers with hyperlinks, the nodes got in the wrong order.&lt;/p&gt;
&lt;p&gt;I have made some big changes to the project lately, so i hope it's stable. Try it and tell me if it worked for you.&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="FabriceSAGE" When="17/02/2010 07:33:59">
          <Html>
        
&lt;p&gt;Hello,&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;When i use one hyperlink it's ok, but when i add&amp;nbsp;a second huperlink it's not ok.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Fabrice.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="17/02/2010 07:38:01">
          <Html>
        
&lt;p&gt;ok, i'll have a look at it later today.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="FabriceSAGE" When="17/02/2010 07:57:35">
          <Html>
        
&lt;p&gt;Hello,&lt;/p&gt;
&lt;p&gt;The Hyperlinks in the template are disappeared (the text is present but not link)&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;
&lt;p&gt;Fabrice.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Bug if delete worksheet">
      <Posts>
        <Post From="FabriceSAGE" When="15/02/2010 09:39:45">
          <Html>
        
&lt;p&gt;Hello,&lt;/p&gt;
&lt;p&gt;I found a bug when delete a worksheet&lt;/p&gt;
&lt;p&gt;In the line : &lt;span style="font-size: x-small;"&gt;_xlPackage.Workbook.Part.DeleteRelationship(worksheet.RelationshipID);&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-size: x-small;"&gt;worksheet.RelationshipID is NULL&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-size: x-small;"&gt;Thanks.&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-size: x-small;"&gt;Fabrice.&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="FabriceSAGE" When="15/02/2010 09:40:25">
          <Html>
        
&lt;p&gt;Hello,&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;I delete the last sheet&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Fabrice.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="15/02/2010 10:56:53">
          <Html>
        
&lt;p&gt;Ok, thanks for reporting it. I'll have a look.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Problem generating Excel">
      <Posts>
        <Post From="spikenc" When="10/02/2010 10:57:10">
          <Html>
        
&lt;p&gt;What happens is that i cannot open excel with other code readers until i open and save the excel again.&lt;/p&gt;
&lt;p&gt;The file increases few KB after save it with excel and everything works fine, so i thing must be a problem.&lt;/p&gt;
&lt;p&gt;I used ExcelPackage Project DLL and the excel works fine but i need to generate files without saving on disk.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="10/02/2010 11:08:03">
          <Html>
        
&lt;p&gt;Try to open the file with a text processor like notepad++, if u see any&amp;nbsp;html code inside&amp;nbsp;your generate excel file....try to save&amp;nbsp;it with code below:&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;                    Response.Clear();
                    Response.AddHeader(&lt;span style="color: rgb(163, 21, 21);"&gt;"content-disposition"&lt;/span&gt;, &lt;span style="color: rgb(163, 21, 21);"&gt;"attachment;  filename=file&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21);"&gt;.xlsx"&lt;/span&gt;);
                    Response.ContentType = &lt;span style="color: rgb(163, 21, 21);"&gt;"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"&lt;/span&gt;;                    
                    Response.BinaryWrite(pck.GetAsByteArray());
                    Response.End();
&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="spikenc" When="10/02/2010 11:44:19">
          <Html>
        
&lt;p&gt;Not working.&lt;/p&gt;
&lt;p&gt;My previous code was similar but i had &amp;nbsp;at the end.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;Response.Flush();

Responde.Close();
&lt;/pre&gt;
&lt;pre&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;p&gt;I opened the file with notepad++ and i don't have html inside, so it outputs well.&lt;/p&gt;&lt;p&gt;For example, the excel file i generate have 68KB, when i open with MS Excel 2007 and just click on save button it increases to 71KB.&lt;/p&gt;&lt;p&gt;After save with excel i can import correctly the excel file generated to my application.&lt;/p&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="10/02/2010 12:17:38">
          <Html>
        
&lt;p&gt;When u open with excel, did u see any warning about recover or something like that?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="spikenc" When="10/02/2010 12:20:13">
          <Html>
        
&lt;p&gt;No warning.&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="spikenc" When="10/02/2010 13:04:02">
          <Html>
        
&lt;p&gt;I was testing and i can read excel with oledb, so perhaps there is no problem.&lt;/p&gt;
&lt;p&gt;But it's strange that i only can import files ( i am using &lt;a href="http://exceldatareader.codeplex.com/" rel="nofollow"&gt;
http://exceldatareader.codeplex.com/&lt;/a&gt;) &amp;nbsp;that are saved in MS Excel 2007 or original ExcelPackage, with epplus are failing.&lt;/p&gt;
&lt;p&gt;Thanks for helping.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="10/02/2010 13:56:04">
          <Html>
        
&lt;p&gt;I had a quick&amp;nbsp;look at it and exceldatareader reads the dimension-tag from sheet xml files inside the package.&amp;nbsp; (looks somthing like this... &amp;lt;dimension ref="A1:U85"/&amp;gt;)&lt;/p&gt;
&lt;p&gt;I don't update it since Excel figure out the dimensions without this tag, but&amp;nbsp;I guess&amp;nbsp;I should add it to a future release.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Bar Chart">
      <Posts>
        <Post From="FabriceSAGE" When="09/02/2010 15:30:22">
          <Html>
        
&lt;p&gt;Hello,&lt;/p&gt;
&lt;p&gt;I'm sorry for my english.&lt;/p&gt;
&lt;p&gt;Great work.&lt;/p&gt;
&lt;p&gt;It's possible to make a horizontal bar chart but&amp;nbsp; I would like to make a vertical bar chart.&lt;/p&gt;
&lt;p&gt;It's possible ?&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="09/02/2010 17:32:42">
          <Html>
        
&lt;p&gt;Sure, use the AddChart method with Charttype Columnxxx, like this...&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;span style="color: blue;"&gt;var&lt;/span&gt; chart = ws.Drawings.AddChart(&lt;span style="color: rgb(163, 21, 21);"&gt;"columnChart"&lt;/span&gt;, eChartType.ColumnClustered);&lt;/p&gt;
&lt;p&gt;or&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;&lt;span style="color: blue;"&gt;var&lt;/span&gt; chart = ws.Drawings.AddChart(&lt;span style="color: rgb(163, 21, 21);"&gt;"columnChart3D"&lt;/span&gt;, eChartType.ColumnClustered3D);

&lt;/pre&gt;
&lt;/div&gt;

        
    </Html>
        </Post>
        <Post From="FabriceSAGE" When="10/02/2010 09:08:53">
          <Html>
        
&lt;p&gt;Thanks for your help, but whit this code :&lt;/p&gt;
&lt;p&gt;&lt;span style="color: rgb(0, 0, 255); font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-size: x-small;"&gt;&amp;lt;font size="2" color="&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0000"&gt;#0000&lt;/a&gt;ff"&amp;gt;&amp;lt;font size="2" color="&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0000"&gt;#0000&lt;/a&gt;ff"&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Dim&amp;nbsp;Chart&lt;/p&gt;
&amp;lt;/font&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;font size="2" color="&lt;a class="workItemLink" href="https://epplus.codeplex.com/workitem/0000"&gt;#0000&lt;/a&gt;ff"&amp;gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&amp;lt;/font&amp;gt;
&lt;p&gt;&lt;span style="font-size: x-small;"&gt;&lt;/span&gt;&lt;span style="color: rgb(0, 0, 255); font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-size: x-small;"&gt;As&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: x-small;"&gt;
&lt;/span&gt;&lt;span style="color: rgb(0, 0, 255); font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-size: x-small;"&gt;Object&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: x-small;"&gt; = Ws_CatProjet.Drawings.AddChart(&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;"JourProjet"&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: x-small;"&gt;&amp;nbsp;,
 eChartType.ColumnClustered)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; I&amp;nbsp;have a NotImplementedException "Chart type not implemented"&lt;/p&gt;
&lt;p&gt;And with&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Dim&amp;nbsp;Chart&lt;span style="font-size: x-small;"&gt; &lt;/span&gt;
&lt;span style="color: rgb(0, 0, 255); font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-size: x-small;"&gt;As&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: x-small;"&gt;
&lt;/span&gt;&lt;span style="color: rgb(0, 0, 255); font-size: x-small;"&gt;&lt;span style="color: rgb(0, 0, 255); font-size: x-small;"&gt;Object&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: x-small;"&gt; = Ws_CatProjet.Drawings.AddChart(&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;"JourProjet"&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: x-small;"&gt;&amp;nbsp;,
 eChartType.ColumnClustered3D)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-size: x-small;"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Chart.View3D.Perspective = 0&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Chart.View3D.RotX=360&lt;/p&gt;
&amp;lt;font size="2"&amp;gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; It's not possible to open then file.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&amp;lt;/font&amp;gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="10/02/2010 09:44:36">
          <Html>
        
&lt;p&gt;You are right, ColumnClustered&amp;nbsp;don't work in this release, but i have fixed it. I'll try to check in the fix when i'm finished with the stuff i'm working on.&lt;/p&gt;
&lt;p&gt;If you really need it now, just add the ColumnClustered to the&amp;nbsp;&lt;span style="font-size: x-small;"&gt;GetChartNodeText-method in the ExcelChart class in the source.&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-size: x-small;"&gt;Your second problem is that RotX is out of range. It spans from 0-90 max. I don't validate all values, so if you put them out of range Excel will give you an error when&amp;nbsp;the workbook is&amp;nbsp;opened.&lt;/span&gt;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Delete single row">
      <Posts>
        <Post From="mrxrsd" When="02/02/2010 17:13:02">
          <Html>
        
&lt;p&gt;I know&amp;nbsp;apparently epplus has a problem with delete row when using shared formula, but it isn´t my case, so i did a small piece of code to delete a single row, i´ll post here, maybe can help someone. =)&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;        &lt;span style="color: blue;"&gt;public&lt;/span&gt; &lt;span style="color: blue;"&gt;void&lt;/span&gt; DeleteRow(&lt;span style="color: blue;"&gt;int&lt;/span&gt; row, &lt;span style="color: blue;"&gt;bool&lt;/span&gt; shiftOtherRowsUp)
        {
            &lt;span style="color: green;"&gt;//throw (new Exception("Insert and delete of rows has been removed for now."));&lt;/span&gt;

            &lt;span style="color: green;"&gt;//We have a problem here with shared formulas update to be fixed&lt;/span&gt;
            &lt;span style="color: blue;"&gt;var&lt;/span&gt; cpy = &lt;span style="color: blue;"&gt;new&lt;/span&gt; SortedDictionary&amp;lt;&lt;span style="color: blue;"&gt;ulong&lt;/span&gt;, ExcelCell&amp;gt;();            
            
            &lt;span style="color: blue;"&gt;foreach&lt;/span&gt; (ExcelCell cell &lt;span style="color: blue;"&gt;in&lt;/span&gt; _cells.Values)
            {
                &lt;span style="color: blue;"&gt;if&lt;/span&gt; (cell.Row != row)
                {
                    &lt;span style="color: blue;"&gt;if&lt;/span&gt; (cell.Row &amp;gt; row &amp;amp;&amp;amp; shiftOtherRowsUp)
                    {
                        cell.Row -= 1;
                        &lt;span style="color: blue;"&gt;if&lt;/span&gt; (shiftOtherRowsUp &amp;amp;&amp;amp; cell.Formula != &lt;span style="color: rgb(163, 21, 21);"&gt;""&lt;/span&gt;)
                        {
                            cell.Formula = ExcelCell.UpdateFormulaReferences(cell.Formula, -1, 0, row, 0);
                        }
                    }

                    cpy.Add(cell.CellID, cell);
                }  
            }
            _cells = cpy;
        }
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="02/02/2010 17:21:09">
          <Html>
        
&lt;p&gt;Remember if you´ll be calling this method in a loop, everytime that you delete a row, all your worksheet will be "update", so you´ll lost your index reference. If you want to test a bunch of rows with a clasule, you need something like
 this:&lt;/p&gt;
&lt;div style="color: black; background-color: white;"&gt;
&lt;pre&gt;        &lt;span style="color: blue;"&gt;private&lt;/span&gt; &lt;span style="color: blue;"&gt;void&lt;/span&gt; removeLines(ExcelWorksheet ws, &lt;span style="color: blue;"&gt;int&lt;/span&gt; column, &lt;span style="color: blue;"&gt;int&lt;/span&gt; rowStart, &lt;span style="color: blue;"&gt;int&lt;/span&gt; rowEnd, List&amp;lt;&lt;span style="color: blue;"&gt;string&lt;/span&gt;&amp;gt; allowedValues)
        {            
            &lt;span style="color: blue;"&gt;int&lt;/span&gt; i = rowStart;
            &lt;span style="color: blue;"&gt;int&lt;/span&gt; t = rowEnd - rowStart;
            &lt;span style="color: blue;"&gt;do&lt;/span&gt;
            {
                &lt;span style="color: blue;"&gt;if&lt;/span&gt; (!allowedValues.Exists(a =&amp;gt; a.Equals(ws.Cells[i, column].Value)))
                {
                    ws.DeleteRow(i, &lt;span style="color: blue;"&gt;true&lt;/span&gt;);                                        
                }
                &lt;span style="color: blue;"&gt;else&lt;/span&gt;
                {
                    i++;
                }

                t--;

            }&lt;span style="color: blue;"&gt;while&lt;/span&gt;( t &amp;gt;= 0 );            
        }
&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;It isnt a beautifull code, but works....I need to study more about epplus architeture =)&lt;/p&gt;
&lt;p&gt;maybe Jan can do something better.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;sorry for my english&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="03/02/2010 19:06:02">
          <Html>
        
&lt;p&gt;Nice with some code here :)&lt;/p&gt;
&lt;p&gt;The main reason i removed the insert and&amp;nbsp;delete methods was that I wasn't to happy with the design. Cells are stored in a SortedDictionary and accessed by the CellID (a composite of SheetID, column and row).&amp;nbsp; When inserting&amp;nbsp;or deleting, the
 CellID changes for all rows/columns after. Since the SortedDictionary-class don't allow the key(the cellID)&amp;nbsp;to be changed the only way to do this is to create a new dictionary and reload it or delete and reinsert the cells, and that is not so good for
 the performance.&lt;/p&gt;
&lt;p&gt;I'll guess the best way to fix this is to create your own dictionary-class where you can change the key. I'll try to have a&amp;nbsp;look at it when&amp;nbsp;I have time&amp;nbsp;and see what I can do. The shared formula method also need to be fixed and properbly&amp;nbsp;some
 other things as well, so if you come up with something, please send me a message or post it here.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="03/02/2010 19:32:35">
          <Html>
        
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;i need to go home now, i´ll think more about our problem =)&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="04/02/2010 12:46:45">
          <Html>
        
&lt;p&gt;Hi Jan,&lt;/p&gt;
&lt;p&gt;Why are u using SortedDictionary instead Dictionary ? I´ve made some benchmarkings using dictionary and&amp;nbsp;results&amp;nbsp;was always better in my scenarios. For example, I´ve inserted 10000 rows with numbers ( 1-10000) and in the next step I
 delete all even numbers, when I was using SortedDictionarty I obtain 30s and with Dictionary 16s elapdsed.&lt;/p&gt;
&lt;p&gt;btw, I only change cell´s dictionary, row and columns still using sorteddictionary.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="04/02/2010 13:49:30">
          <Html>
        
&lt;p&gt;The cells/rows/columns&amp;nbsp;must be in order when saving the sheet. If you use a Dictionary the ID's are added in the order you access the cells.&amp;nbsp;So it will work if you add all cells from A1-, but if you change the order the sheet will properbly be
 unreadable.&lt;/p&gt;
&lt;p&gt;I am currently working on&amp;nbsp;my own implementation of a&amp;nbsp;SortedDictionary&amp;nbsp;where you can change the keys. I hope&amp;nbsp;I can check it in tonight or&amp;nbsp;tomorow, then you can have a look at it.&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="05/02/2010 07:47:34">
          <Html>
        
&lt;p&gt;Ok, so I have checked in the new code. Have a look at it if you have time, and try your code. I hope things go faster now (at least inserts and deletes), so i didn't mess things up : )&lt;/p&gt;
&lt;p&gt;Still some work to do on this code though (fix formulas, merged cells and hyperlinks).&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="05/02/2010 12:01:24">
          <Html>
        
&lt;p&gt;I´ve updated in my project and seems everything is fine, I will do more tests. Nice work Jan =)&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Save As">
      <Posts>
        <Post From="jsimunac" When="02/02/2010 20:47:33">
          <Html>
        
&lt;p&gt;One more question.&amp;nbsp; Is there a Save As option for saving a spreadsheet?&amp;nbsp; I would like to open a template, populate with data and then save as a different name.&amp;nbsp; The ideal would be to bring up the Save As dialog box and allow the user to select
 the name and location.&amp;nbsp; There may be something already, but if so, I can't find it.&amp;nbsp; Thanks again for your help.&lt;/p&gt;
&lt;p&gt;-Joe&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="02/02/2010 23:24:27">
          <Html>
        
&lt;p&gt;You can create a new file and open a template from your new file, you dont need to write directly, i think this is your problem. I see two options for u:&lt;/p&gt;
&lt;p&gt;1) ask user a filename before process start and open a template file from your new one. ( easy )&lt;/p&gt;
&lt;p&gt;2) create a temp file, when finished it, start a event on client side to ask a new filename and fires a serverside event to return that temp file&lt;/p&gt;
&lt;p&gt;take a look at sample4 (epplus) or sample3(original excellpackage)&lt;/p&gt;
&lt;p&gt;sorry for my english ;p&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jsimunac" When="03/02/2010 13:58:59">
          <Html>
        
&lt;p&gt;Thanks.&amp;nbsp; Sample4 is exactly what I needed.&amp;nbsp; I even looked at it yesterday, but I was obviously too tired to recognize what I was looking at.&amp;nbsp; I shouldn't do anything that requires thinking at the end of the day.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Text Orientation">
      <Posts>
        <Post From="mrxrsd" When="27/01/2010 18:43:18">
          <Html>
        
&lt;p&gt;Is it possible to change text orientation? like example here: &lt;a href="http://www.lytebyte.com/2008/06/18/how-to-change-text-orientation-in-excel-cells/" rel="nofollow"&gt;
http://www.lytebyte.com/2008/06/18/how-to-change-text-orientation-in-excel-cells/&lt;/a&gt;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="28/01/2010 08:26:23">
          <Html>
        
&lt;p&gt;No, not at this moment. But i think it is easy to implement, so&amp;nbsp;I'll try to add this feature.&amp;nbsp;&amp;nbsp;&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="mrxrsd" When="28/01/2010 16:29:57">
          <Html>
        
&lt;p&gt;tks man =)&lt;/p&gt;
&lt;p&gt;btw, u´re doing a good job here.&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
    <Discussion Title="Bug in file ExcelPicture.cs">
      <Posts>
        <Post From="oazevedo" When="22/01/2010 17:40:29">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Great work you've done here man.&lt;/p&gt;
&lt;p&gt;I've found a bug in file ExcelPicture.cs on line 112.&lt;/p&gt;
&lt;p&gt;This code&lt;/p&gt;
&lt;p&gt;&lt;span style="font-size: x-small;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; UriPic = GetNewUri(package, String.Format(&lt;/span&gt;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;"/xl/media/image{0}.{0}"&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: x-small;"&gt;,
 imageFile.Extension));&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;should be replaced with this code&lt;/p&gt;
&lt;p&gt;&lt;span style="font-size: x-small;"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; UriPic = GetNewUri(package,&lt;/p&gt;
&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;&lt;span style="color: rgb(163, 21, 21); font-size: x-small;"&gt;"/xl/media/image{0}."&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: x-small;"&gt; + imageFile.Extension);&lt;/span&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;This is causing an infinite loop in function GetNewUri() when adding a new picture from a FileInfo object.&lt;/p&gt;
&lt;p&gt;Best Regards,&lt;/p&gt;
&lt;p&gt;Orlando Azevedo&lt;/p&gt;

        
    </Html>
        </Post>
        <Post From="jankallman" When="24/01/2010 08:03:17">
          <Html>
        
&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Thanks for the feedback!&lt;/p&gt;
&lt;p&gt;I have been working on this code lately so i think I've fixed the bug. I'll have a look at it when I get back home.&lt;/p&gt;
&lt;p&gt;I'll try to check it in tonight. By the way, I hope I can do a new release this week, so if you have time, please test your project with the new source.&lt;/p&gt;
&lt;p&gt;I've added a new sample 6, that shows a little bit more of the stuff you can do :)&lt;/p&gt;
&lt;p&gt;Jan&lt;/p&gt;

        
    </Html>
        </Post>
      </Posts>
    </Discussion>
  </Discussions>
</DiscussionSet>